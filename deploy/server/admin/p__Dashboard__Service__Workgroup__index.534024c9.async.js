"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9828],{58087:function(e,t,n){var r=n(83910),o=n(44194),i=n(15323),s=n(54183),a=function(e,t){return o.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:i.Z}))},u=o.forwardRef(a);t.Z=u},49906:function(e,t,n){var r=n(94433),o=n(38956),i=n(51997),s=n(79369),a=n(44194),u=n(88116),l=n(35074),d=n(31549),c=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],g=a.forwardRef((function(e,t){var n=e.fieldProps,s=e.options,a=e.radioType,u=e.layout,g=e.proFieldProps,f=e.valueEnum,v=(0,o.Z)(e,c);return(0,d.jsx)(l.Z,(0,r.Z)((0,r.Z)({valueType:"button"===a?"radioButton":"radio",ref:t,valueEnum:(0,i.h)(f,void 0)},v),{},{fieldProps:(0,r.Z)({options:s,layout:u},n),proFieldProps:g,filedConfig:{customLightMode:!0}}))})),f=a.forwardRef((function(e,t){var n=e.fieldProps,o=e.children;return(0,d.jsx)(s.ZP,(0,r.Z)((0,r.Z)({},n),{},{ref:t,children:o}))})),v=(0,u.G)(f,{valuePropName:"checked",ignoreWidth:!0});v.Group=g,v.Button=s.ZP.Button,v.displayName="ProFormComponent",t.Z=v},86675:function(e,t,n){n.r(t),n.d(t,{default:function(){return we}});var r=n(44194),o=n(67738),i=n(14906),s=n(76711),a=n.n(s),u=n(90819),l=n.n(u),d=n(89933),c=n.n(d),g=n(73193),f=n.n(g),v=n(45332),p=n.n(v),m=n(77033),h=n(82770),x=n(39487),b=n(32525),k=n(50716),S=n(92354),w=n(81739),M=n(66431),j=n(63649),y=n(29337),Z=n(68779),R=n(12322),C=n(58087),F=n(31806),P=n(56482),T=n(83910),W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M740 161c-61.8 0-112 50.2-112 112 0 50.1 33.1 92.6 78.5 106.9v95.9L320 602.4V318.1c44.2-15 76-56.9 76-106.1 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 49.2 31.8 91 76 106.1V706c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-27.8l423.5-138.7a50.52 50.52 0 0034.9-48.2V378.2c42.9-15.8 73.6-57 73.6-105.2 0-61.8-50.2-112-112-112zm-504 51a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm96 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm408-491a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"branches",theme:"outlined"},q=n(54183),L=function(e,t){return r.createElement(q.Z,(0,T.Z)({},e,{ref:t,icon:W}))};var U=r.forwardRef(L),E=n(10162),I=n(90727),z=n(59304),N=n(54881),A=n(47944),D=n(80556),Q=n(55785),O=n(49764),B=n(19433),H=n(43167),V=n(98830),J=n(75112),G=n(14597),K=n(39497),X=n(99665),Y=n(66547),$=(n(84262),n(94212),n(24479),n(90631)),_=n(1460),ee=n(417),te=n(14195),ne=n(27153),re=n(10154),oe=n.n(re),ie=n(75580),se=n(91361),ae=n(25784),ue=n(10434),le=n(87544),de=n(2250),ce=n(23753),ge=n(31549),fe=function(e){var t=e.variant,n=e.robotRoutingSettings,o=e.onRobotRoutingSettingsChange,i=ae.A.useForm(),s=p()(i,1)[0],a=(0,r.useRef)(!1),u=(0,r.useState)([]),d=p()(u,2),g=d[0],f=d[1],v=(0,V.u)((function(e){return e.currentOrg})),m=(0,se.Z)().translateString,h=(0,r.useMemo)((function(){var e;return null!==(e=null==n?void 0:n.draft)&&void 0!==e?e:null==n?void 0:n.live}),[n]);(0,r.useEffect)((function(){var e,n;if("workgroup"===t){var r=null!==(e=null==h?void 0:h.robotUid)&&void 0!==e?e:null==h||null===(n=h.robot)||void 0===n?void 0:n.uid;s.setFieldsValue({defaultRobot:null==h?void 0:h.defaultRobot,offlineRobot:null==h?void 0:h.offlineRobot,nonWorktimeRobot:null==h?void 0:h.nonWorktimeRobot,robotUid:r})}}),[t,h,s]);var x=function(){var e=c()(l()().mark((function e(){var t,n,r;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=3;break}return ce.Z.debug("isLoading: 1",a.current),e.abrupt("return");case 3:return a.current=!0,B.yw.loading("loading"),t={pageNumber:0,pageSize:50,type:K.f4h,orgUid:null==v?void 0:v.uid},e.next=8,(0,ie.p0)(t);case 8:n=e.sent,ce.Z.debug("queryRobotsByOrg: ",n),200===n.code?f(null===(r=n.data)||void 0===r?void 0:r.content):B.yw.error(n.message),a.current=!1,B.yw.destroy();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){x()}),[]);var b=function(){var e;null===(e=s.validateFields)||void 0===e||e.call(s,["robotUid"]).catch((function(){return null}))},k=function(e){return function(t){var n,r=!(null==t||null===(n=t.target)||void 0===n||!n.checked);null==o||o(oe()({},e,r)),b()}};return(0,ge.jsx)(ae.A,{form:s,style:{marginLeft:"20px"},submitter:!1,children:"workgroup"===t&&(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)(ue.Z,{name:"defaultRobot",width:"md",label:"默认启用机器人",fieldProps:{onChange:k("defaultRobot")}}),(0,ge.jsx)(ue.Z,{name:"offlineRobot",width:"md",label:"无客服在线时启用机器人",fieldProps:{onChange:k("offlineRobot")}}),(0,ge.jsx)(ue.Z,{name:"nonWorktimeRobot",width:"md",label:"非工作时间启用机器人",fieldProps:{onChange:k("nonWorktimeRobot")}}),(0,ge.jsx)(le.Z,{name:["defaultRobot","offlineRobot","nonWorktimeRobot"],children:function(e){var t=e.defaultRobot,n=e.offlineRobot,r=e.nonWorktimeRobot,i=!!(t||n||r);return(0,ge.jsx)(de.Z,{name:"robotUid",label:"客服机器人",width:"md",options:g.map((function(e){return{value:e.uid,label:m(e.nickname)}})),rules:[{validator:function(e,t){return i&&!t?Promise.reject(new Error("请选择客服机器人")):Promise.resolve()}}],fieldProps:{allowClear:!0,placeholder:"请选择客服机器人",onChange:function(e){null==o||o({robotUid:null!=e?e:void 0}),b()}}})}})]})})},ve=(n(52260),n(24476)),pe=n(49906),me=n(41196),he=function(){var e=me.Z.useForm(),t=p()(e,1)[0],n=(0,i.useIntl)(),o=(0,X.z)((function(e){return{currentWorkgroupSettings:e.currentWorkgroupSettings,setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings}})),s=o.currentWorkgroupSettings,a=o.setCurrentWorkgroupSettings,u=(0,r.useState)(K.vXk),l=p()(u,2),d=l[0],c=l[1];(0,r.useEffect)((function(){if(s){var e=s;c(e.routingMode),t.setFieldValue("routingMode",e.routingMode)}}),[s]);return(0,ge.jsx)("div",{children:(0,ge.jsxs)(ae.A,{form:t,submitter:!1,children:[(0,ge.jsx)(pe.Z.Group,{name:"routingMode",label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.type",defaultMessage:"Route Type"}),options:[{label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.roundRobin",defaultMessage:"Round Robin"}),value:K.vXk},{label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.leastActive",defaultMessage:"Least Active"}),value:K.ZD$},{label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.random",defaultMessage:"Random"}),value:K.owQ},{label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.weightedRandom",defaultMessage:"Weighted Random"}),value:K.e2F},{label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.consistentHash",defaultMessage:"Consistent Hash"}),value:K.zWk},{label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.fastestResponse",defaultMessage:"Fastest Response"}),value:K.HQF},{label:(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.route.recent",defaultMessage:"Recent"}),value:K.WDq}],fieldProps:{value:d,onChange:function(e){var t;!function(e){console.log("radio checked",e.target.value),c(e.target.value)}(e),t=e.target.value,s&&a(f()(f()({},s),{},{routingMode:t}))}}}),(0,ge.jsxs)(ae.A.Item,{children:[d===K.vXk&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.roundRobin.desc"})}),d===K.ZD$&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.leastActive.desc"})}),d===K.owQ&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.random.desc"})}),d===K.e2F&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.weightedRandom.desc"})}),d===K.zWk&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.consistentHash.desc"})}),d===K.HQF&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.fastestResponse.desc"})}),d===K.JEC&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.broadcast.desc"})}),d===K.WDq&&(0,ge.jsx)("p",{children:n.formatMessage({id:"workgroup.route.recent.desc"})})]})]})})},xe=n(58791),be="tips",ke=function(){var e=(0,i.useIntl)(),t=(0,V.u)((function(e){return e.currentOrg})),n=(0,J.Z)().leftSiderStyle,s=(0,G.Z)().isDarkMode,u=(0,r.useState)(!1),d=p()(u,2),g=d[0],v=d[1],T=(0,r.useState)([]),W=p()(T,2),q=W[0],L=W[1],K=(0,r.useState)(),re=p()(K,2),oe=re[0],ie=re[1],se=(0,r.useState)(""),ae=p()(se,2),ue=ae[0],le=ae[1],de=(0,r.useState)(be),ce=p()(de,2),pe=ce[0],me=ce[1],ke=(0,r.useState)(!1),Se=p()(ke,2),we=Se[0],Me=Se[1],je=(0,r.useState)(null),ye=p()(je,2),Ze=ye[0],Re=ye[1],Ce=(0,r.useMemo)((function(){return q.find((function(e){return e.uid===oe}))||null}),[q,oe]),Fe=(0,r.useState)(!1),Pe=p()(Fe,2),Te=Pe[0],We=Pe[1],qe=(0,r.useState)(!1),Le=p()(qe,2),Ue=Le[0],Ee=Le[1],Ie=(0,r.useState)(!1),ze=p()(Ie,2),Ne=ze[0],Ae=ze[1],De=(0,r.useRef)(""),Qe=(0,X.z)((function(e){return{setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings,currentWorkgroupSettings:e.currentWorkgroupSettings}})),Oe=Qe.setCurrentWorkgroupSettings,Be=Qe.currentWorkgroupSettings,He=(0,r.useMemo)((function(){var e;return null!==(e=null!=Be?Be:Ce)&&void 0!==e?e:null}),[Be,Ce]),Ve=(0,r.useCallback)((function(e){if(Be){var t=Be.draftServiceSettings||Be.serviceSettings||{};Oe(f()(f()({},Be),{},{draftServiceSettings:f()(f()({},t),e)}))}}),[Be,Oe]),Je=(0,r.useCallback)((function(e){if(Be){var t=Be.draftInviteSettings||Be.inviteSettings||{};Oe(f()(f()({},Be),{},{draftInviteSettings:f()(f()({},t),e)}))}}),[Be,Oe]),Ge=(0,r.useCallback)((function(e){if(Be){var t=Be.draftMessageLeaveSettings||Be.messageLeaveSettings||{};Oe(f()(f()({},Be),{},{draftMessageLeaveSettings:f()(f()({},t),e)}))}}),[Be,Oe]),Ke=(0,r.useCallback)((function(e){if(Be){var t=Be.draftWorktimeSettings||Be.worktimeSettings||{};Oe(f()(f()({},Be),{},{draftWorktimeSettings:f()(f()({},t),e)}))}}),[Be,Oe]),Xe=(0,r.useCallback)((function(e){if(Be){var t=Be.draftRobotRoutingSettings||Be.robotRoutingSettings||{};Oe(f()(f()({},Be),{},{draftRobotRoutingSettings:f()(f()({},t),e)}))}}),[Be,Oe]),Ye=(0,r.useCallback)((function(e){if(Be){var t=Be.draftQueueSettings||Be.queueSettings||{};Oe(f()(f()({},Be),{},{draftQueueSettings:f()(f()({},t),e)}))}}),[Be,Oe]),$e=(0,r.useMemo)((function(){if(!ue)return q;var e=ue.toLowerCase();return q.filter((function(t){var n=(t.name||t.uid||"").toLowerCase(),r=(t.description||"").toLowerCase();return n.includes(e)||r.includes(e)}))}),[q,ue]),_e=(0,r.useCallback)(function(){var e=c()(l()().mark((function e(n,r){var o,i,s,a,u;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.uid){e.next=2;break}return e.abrupt("return");case 2:return v(!0),e.prev=3,i=(null!=n?n:"").trim(),s={orgUid:t.uid,pageNumber:0,pageSize:100,searchText:i||void 0},e.next=8,(0,H.zc)(s);case 8:a=e.sent,console.log("加载工作组配置模板列表: ",a,s),u=(null==a||null===(o=a.data)||void 0===o?void 0:o.content)||[],L(u),!(u.length>0)||oe&&u.some((function(e){return e.uid===oe}))||(ie(u[0].uid),null!=r&&r.keepActive||me(be));case 13:return e.prev=13,v(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,,13,16]])})));return function(t,n){return e.apply(this,arguments)}}(),[null==t?void 0:t.uid,oe]),et=(0,r.useCallback)((function(e){_e(null!=e?e:ue)}),[_e,ue]);(0,r.useEffect)((function(){_e(ue)}),[null==t?void 0:t.uid]),(0,r.useEffect)((function(){Ce?(Oe(Ce),De.current=JSON.stringify(null!=Ce?Ce:{}),Ae(!1)):(Oe(null),De.current=JSON.stringify({}),Ae(!1))}),[null==Ce?void 0:Ce.uid]),(0,r.useEffect)((function(){if(Ce)try{var e=JSON.stringify(null!=Be?Be:{});Ae(e!==De.current)}catch(e){Ae(!0)}}),[Be,null==Ce?void 0:Ce.uid]);var tt=function(){var n=c()(l()().mark((function n(r){var o,i,s;return l()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=(o=null!=r?r:Ce)&&o.uid){n.next=3;break}return n.abrupt("return");case 3:return i={uid:o.uid,orgUid:null==t?void 0:t.uid,pageNumber:0,pageSize:100},n.next=6,(0,H.zN)(i);case 6:(s=n.sent)&&200===s.code?(B.yw.success(e.formatMessage({id:"common.deleted",defaultMessage:"删除成功"})),_e(ue)):B.yw.error((null==s?void 0:s.message)||"删除失败");case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),nt=function(){var n=c()(l()().mark((function n(r,o){var i;return l()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,H.Y2)({uid:r,orgUid:null==t?void 0:t.uid,enabled:o});case 3:(i=n.sent)&&200===i.code?(B.yw.success(e.formatMessage({id:o?"common.enabled":"common.disabled",defaultMessage:o?"已启用":"已停用"})),_e(ue)):B.yw.error((null==i?void 0:i.message)||"操作失败"),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("切换启用状态失败:",n.t0),B.yw.error("操作失败");case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e,t){return n.apply(this,arguments)}}(),rt=function(e,t){if(e){var n={};return t.forEach((function(t){void 0!==e[t]&&(n[t]=e[t])})),n}},ot=function(e){if(e){var t=rt(e,["language","autoPopup","showTopTip","topTip","topTipStart","topTipEnd","showRateBtn","autoInviteRate","inviteRateTip","rateMsgCount","showPreForm","preFormRequired","preForm","showPreSearch","showHistory","showInputAssociation","showCaptcha","welcomeTip","welcomeFaqUids","welcomeKbUid","enableWorkflow","workflowUid","autoCloseMin","autoCloseTip","agentCloseTip","queueTip","leavemsgTip","showRightIframe","rightIframeUrl","showFaqs","faqUids","faqKbUid","showQuickFaqs","quickFaqUids","quickFaqKbUid","showGuessFaqs","guessFaqUids","showHotFaqs","hotFaqUids","showShortcutFaqs","shortcutFaqUids","relatedQuestionGuide","enableProactiveTrigger","noResponseTimeout","proactiveMessage","maxProactiveCount","proactiveInterval","triggerConditions","proactiveFaqUids","showLogo","validateUntil"]),n=function(e){if(e)return rt(e,["smile","image","file","rate","leavemsg","orderSelector","ticket","audio","video","tel","order"])}(e.toolbar);return f()(f()({},t),n?{toolbar:n}:{})}},it=function(e){if(e)return rt(e,["name","description","defaultTemplate","show","text","icon","delay","loop","loopDelay","loopCount","messageList","targetedInvite","targetedInviteUrls","smartTrigger","pageStayTriggerSeconds","scrollTrigger","scrollTriggerPerceninviteSettinge","exitIntentTrigger","referrerTrigger","referrerPatterns","deviceTypes","visitorSegmentation","newVisitorMessage","returningVisitorMessage","vipVisitorMessage","inviteStyle","inviteAnimation","abTesting"])},st=function(e){if(e)return rt(e,["name","description","color","order"])},at=function(e){if(e)return rt(e,["messageLeaveEnabled","messageLeaveTip","messageLeaveAgentUid","messageLeaveNotify","messageLeaveNotifyType","messageLeaveNotifyEmail","messageLeaveNotifyMobile","messageLeaveForm"])},ut=function(e){if(e)return rt(e,["queueRobot","showQueuePosition","showEstimatedWaitTime","avgWaitTimePerPerson","maxWaiting","maxWaitTime","queueTip","queueNoticeBatchWindowMs"])},lt=function(e){var t,n;if(e){var r=rt(e,["defaultRobot","offlineRobot","nonWorktimeRobot"]),o=null!==(t=e.robotUid)&&void 0!==t?t:null===(n=e.robot)||void 0===n?void 0:n.uid;return f()(f()({},r),o?{robotUid:o}:{})}},dt=function(e){if(e)return rt(e,["enabled","regularWorktimes","specialWorktimes","holidays"])},ct=function(){var n=c()(l()().mark((function n(){var r,o,i,s,a,u;return l()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=Ce&&Ce.uid){n.next=3;break}return B.yw.warning(e.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})),n.abrupt("return");case 3:return We(!0),n.prev=4,r=Be&&Be.uid===Ce.uid?Be:Ce,o=function(e,t){return f()(f()({},e||{}),t||{})},i={uid:Ce.uid,orgUid:null==t?void 0:t.uid,name:null==r?void 0:r.name,description:null==r?void 0:r.description,isDefault:null==r?void 0:r.isDefault,enabled:null==r?void 0:r.enabled,routingMode:null==r?void 0:r.routingMode,serviceSettings:ot(o(null==r?void 0:r.serviceSettings,null==r?void 0:r.draftServiceSettings)),inviteSettings:it(o(null==r?void 0:r.inviteSettings,null==r?void 0:r.draftInviteSettings)),intentionSettings:st(o(null==r?void 0:r.intentionSettings,null==r?void 0:r.draftIntentionSettings)),messageLeaveSettings:at(o(null==r?void 0:r.messageLeaveSettings,null==r?void 0:r.draftMessageLeaveSettings)),worktimeSettings:dt(o(null==r?void 0:r.worktimeSettings,null==r?void 0:r.draftWorktimeSettings)),robotRoutingSettings:lt(o(null==r?void 0:r.robotRoutingSettings,null==r?void 0:r.draftRobotRoutingSettings)),queueSettings:ut(o(null==r?void 0:r.queueSettings,null==r?void 0:r.draftQueueSettings))},n.next=10,(0,H.Y2)(i);case 10:s=n.sent,console.log("保存工作组配置模板: ",s,i),s&&200===s.code?(B.yw.success(e.formatMessage({id:"common.saved",defaultMessage:"保存成功"})),De.current=JSON.stringify(null!==(a=null!==(u=s.data)&&void 0!==u?u:r)&&void 0!==a?a:{}),Ae(!1),_e(ue,{keepActive:!0})):B.yw.error((null==s?void 0:s.message)||"保存失败"),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(4),console.error("保存失败:",n.t0),B.yw.error("保存失败");case 19:return n.prev=19,We(!1),n.finish(19);case 22:case"end":return n.stop()}}),n,null,[[4,15,19,22]])})));return function(){return n.apply(this,arguments)}}(),gt=function(){var n=c()(l()().mark((function n(){var r,o,i;return l()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=Ce&&Ce.uid){n.next=3;break}return B.yw.warning(e.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})),n.abrupt("return");case 3:if(Ee(!0),n.prev=4,!Ne){n.next=8;break}return n.next=8,ct();case 8:return r={uid:Ce.uid,orgUid:null==t?void 0:t.uid},n.next=11,(0,H.Dm)(r);case 11:(o=n.sent)&&200===o.code?(B.yw.success(e.formatMessage({id:"common.published",defaultMessage:"发布成功"})),De.current=JSON.stringify(null!==(i=o.data)&&void 0!==i?i:{}),Ae(!1),_e(ue)):B.yw.error((null==o?void 0:o.message)||"发布失败"),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(4),console.error("发布失败:",n.t0),B.yw.error("发布失败");case 19:return n.prev=19,Ee(!1),n.finish(19);case 22:case"end":return n.stop()}}),n,null,[[4,15,19,22]])})));return function(){return n.apply(this,arguments)}}(),ft=(0,r.useMemo)((function(){return null!=Ce&&Ce.uid?[{key:"tips",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(y.Z,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.settings.service.tips",defaultMessage:"提示信息"})]}),children:(0,ge.jsx)(_.Z,{variant:"workgroup",serviceSettings:{live:null==He?void 0:He.serviceSettings,draft:null==He?void 0:He.draftServiceSettings},onServiceSettingsChange:Ve})},{key:"service",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(Z.Z,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.settings.service",defaultMessage:"服务设置"})]}),children:(0,ge.jsx)($.Z,{variant:"workgroup",serviceSettings:{live:null==He?void 0:He.serviceSettings,draft:null==He?void 0:He.draftServiceSettings},onServiceSettingsChange:Ve})},{key:"rate",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(R.Z,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"rate",defaultMessage:"Rate"})]}),children:(0,ge.jsx)(ne.Z,{variant:"workgroup",serviceSettings:{live:null==He?void 0:He.serviceSettings,draft:null==He?void 0:He.draftServiceSettings},onServiceSettingsChange:Ve})},{key:"robot",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(C.Z,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"robot",defaultMessage:"Robot"})]}),children:(0,ge.jsx)(fe,{variant:"workgroup",robotRoutingSettings:{live:null==He?void 0:He.robotRoutingSettings,draft:null==He?void 0:He.draftRobotRoutingSettings},onRobotRoutingSettingsChange:Xe})},{key:"messageLeave",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(F.Z,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.settings.message.leave",defaultMessage:"Leave Message"})]}),children:(0,ge.jsx)(ee.Z,{variant:"workgroup",messageLeaveSettings:{live:null==He?void 0:He.messageLeaveSettings,draft:null==He?void 0:He.draftMessageLeaveSettings},onMessageLeaveSettingsChange:Ge})},{key:"queue",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(xe.Z,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"workgroup.settings.queue",defaultMessage:"排队设置"})]}),children:(0,ge.jsx)(ve.Z,{variant:"workgroup",queueSettings:{live:null==He?void 0:He.queueSettings,draft:null==He?void 0:He.draftQueueSettings},onQueueSettingsChange:Ye})}].concat(a()([]),a()([]),[{key:"right",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(P.Z,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"right",defaultMessage:"Right"})]}),children:(0,ge.jsx)(Y.Z,{variant:"workgroup",serviceSettings:{live:null==He?void 0:He.serviceSettings,draft:null==He?void 0:He.draftServiceSettings},onServiceSettingsChange:Ve,settingsUid:Ce.uid,isActive:"right"===pe})}],a()([]),a()([]),[{key:"route",label:(0,ge.jsxs)("span",{children:[(0,ge.jsx)(U,{})," ",(0,ge.jsx)(i.FormattedMessage,{id:"pages.workgroup.tab.route",defaultMessage:"Route"})]}),children:(0,ge.jsx)(he,{})}]):[]}),[null==Ce?void 0:Ce.uid,He,e,Ve,Je,Ge,Xe,Ke,Ye,pe]);return(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsxs)(m.Z,{style:{minHeight:"calc(100vh - 160px)"},children:[(0,ge.jsx)(m.Z.Panel,{defaultSize:"20%",min:"14%",max:"40%",style:n,children:(0,ge.jsxs)(O.Z,{title:e.formatMessage({id:"workgroup.settings.templates",defaultMessage:"模板列表"}),extra:(0,ge.jsx)(h.ZP,{size:"small",icon:(0,ge.jsx)(E.Z,{}),type:"primary",onClick:function(){Re(null),Me(!0)},children:(0,ge.jsx)(i.FormattedMessage,{id:"common.new",defaultMessage:"新建"})}),bodyStyle:{padding:8},loading:g,children:[(0,ge.jsx)("div",{style:{margin:"0 0 8px 0"},children:(0,ge.jsxs)(x.Z.Compact,{style:{width:"100%"},children:[(0,ge.jsx)(b.Z,{placeholder:e.formatMessage({id:"workgroup.settings.template.search",defaultMessage:"搜索模板名称"}),value:ue,onChange:function(e){return le(e.target.value)},onPressEnter:function(e){e.preventDefault();var t=e.currentTarget.value;le(t),et(t)},allowClear:!0,size:"middle"}),(0,ge.jsx)(h.ZP,{type:"primary",icon:(0,ge.jsx)(I.Z,{}),"aria-label":e.formatMessage({id:"common.search",defaultMessage:"搜索"}),onClick:function(){return et()}})]})}),(0,ge.jsx)("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 280px)"},children:(0,ge.jsx)(k.Z,{dataSource:$e,locale:{emptyText:(0,ge.jsx)(S.Z,{description:e.formatMessage({id:"empty",defaultMessage:"暂无数据"}),image:S.Z.PRESENTED_IMAGE_SIMPLE})},renderItem:function(e){return(0,ge.jsx)(k.Z.Item,{style:oe===e.uid?{backgroundColor:s?"#333333":"#dddddd",cursor:"pointer",borderRadius:6,marginBottom:8,padding:10}:{cursor:"pointer",borderRadius:6,marginBottom:8,padding:10},onClick:function(){return ie(e.uid)},children:(0,ge.jsx)(k.Z.Item.Meta,{title:(0,ge.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ge.jsx)("div",{style:{fontWeight:500,flex:1},children:e.name||e.uid}),(0,ge.jsx)(x.Z,{size:4,children:e.isDefault?(0,ge.jsx)(w.Z,{color:"blue",children:"默认"}):null})]}),description:e.description?(0,ge.jsx)("div",{style:{color:s?"#aaa":"#999",fontSize:12},children:e.description}):null})},e.uid)}})})]})}),(0,ge.jsx)(m.Z.Panel,{children:Ce?(0,ge.jsx)(O.Z,{title:(0,ge.jsxs)(x.Z,{children:[(0,ge.jsxs)("span",{children:[e.formatMessage({id:"workgroup.settings.editing",defaultMessage:"编辑模板"}),": ",Ce.name||Ce.uid]}),(0,ge.jsx)(M.Z,{checked:!!Ce.enabled,onChange:function(e){return nt(Ce.uid,e)},checkedChildren:e.formatMessage({id:"common.enabled",defaultMessage:"启用"}),unCheckedChildren:e.formatMessage({id:"common.disabled",defaultMessage:"停用"})}),(0,ge.jsx)(h.ZP,{size:"small",icon:(0,ge.jsx)(z.Z,{}),onClick:function(e){var t;e.stopPropagation(),Re(null!=(t=Ce)?t:Ce),Me(!0)},children:"编辑"}),(0,ge.jsx)(j.Z,{title:e.formatMessage({id:"common.delete.confirm",defaultMessage:"确定要删除吗?"}),onConfirm:function(e){null==e||e.stopPropagation(),tt(Ce)},onCancel:function(e){return null==e?void 0:e.stopPropagation()},okText:e.formatMessage({id:"common.confirm",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"common.cancel",defaultMessage:"取消"}),children:(0,ge.jsx)(h.ZP,{size:"small",danger:!0,icon:(0,ge.jsx)(N.Z,{}),onClick:function(e){e.stopPropagation()},children:"删除"})}),Ce.isDefault?(0,ge.jsx)(w.Z,{color:"blue",children:"默认"}):null]}),extra:(0,ge.jsxs)(x.Z,{children:[(0,ge.jsx)(j.Z,{title:"发布到线上环境",description:"只有发布之后，才会应用到线上环境",okText:"继续发布",cancelText:"取消",onConfirm:function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),gt()},onCancel:function(e){var t;return null==e||null===(t=e.stopPropagation)||void 0===t?void 0:t.call(e)},children:(0,ge.jsx)(h.ZP,{onClick:function(e){return e.stopPropagation()},loading:Ue,type:"default",icon:(0,ge.jsx)(A.Z,{}),children:(0,ge.jsx)(i.FormattedMessage,{id:"common.publish",defaultMessage:"发布"})})}),(0,ge.jsx)(h.ZP,{onClick:function(){Ce&&(Oe(Ce),De.current=JSON.stringify(null!=Ce?Ce:{}),Ae(!1))},disabled:!Ne,icon:(0,ge.jsx)(D.Z,{}),children:(0,ge.jsx)(i.FormattedMessage,{id:"common.reset",defaultMessage:"重置"})}),(0,ge.jsx)(h.ZP,{type:"primary",loading:Te,onClick:ct,disabled:!Ne,icon:(0,ge.jsx)(Q.Z,{}),children:(0,ge.jsx)(i.FormattedMessage,{id:"common.save",defaultMessage:"保存"})})]}),children:(0,ge.jsx)(o.Z,{activeKey:pe,onChange:me,items:ft})}):(0,ge.jsx)(O.Z,{children:(0,ge.jsx)(S.Z,{description:e.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})})})})]}),(0,ge.jsx)(te.Z,{open:we,onOpenChange:Me,orgUid:(null==t?void 0:t.uid)||"",record:Ze,onSuccess:function(){Me(!1),_e(ue)}})]})},Se=n(872),we=function(){return(0,ge.jsx)(o.Z,{defaultActiveKey:"table",style:{padding:"10px"},items:[{key:"table",label:(0,ge.jsx)(i.FormattedMessage,{id:"menu.workgroup.table",defaultMessage:"Workgroup"}),children:(0,ge.jsx)(Se.Z,{})},{key:"settings",label:(0,ge.jsx)(i.FormattedMessage,{id:"menu.workgroup.settings",defaultMessage:"Workgroup Settings"}),children:(0,ge.jsx)(ke,{})}]})}}}]);