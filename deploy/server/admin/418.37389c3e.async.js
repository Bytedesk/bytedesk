"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[418],{31806:function(e,t,a){a.d(t,{Z:function(){return r}});var i=a(83910),n=a(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},u=a(54183),l=function(e,t){return n.createElement(u.Z,(0,i.Z)({},e,{ref:t,icon:s}))};var r=n.forwardRef(l)},58791:function(e,t,a){var i=a(83910),n=a(44194),s=a(85333),u=a(54183),l=function(e,t){return n.createElement(u.Z,(0,i.Z)({},e,{ref:t,icon:s.Z}))},r=n.forwardRef(l);t.Z=r},7704:function(e,t,a){a.d(t,{AP:function(){return f},_J:function(){return h},t5:function(){return v},v_:function(){return c}});var i=a(90819),n=a.n(i),s=a(73193),u=a.n(s),l=a(89933),r=a.n(l),o=a(39497),d=a(14906);function f(e){return m.apply(this,arguments)}function m(){return(m=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/query/org",{method:"GET",params:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return g.apply(this,arguments)}function g(){return(g=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/create",{method:"POST",data:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return p.apply(this,arguments)}function p(){return(p=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/update",{method:"POST",data:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/delete",{method:"POST",data:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},417:function(e,t,a){var i=a(90819),n=a.n(i),s=a(89933),u=a.n(s),l=a(45332),r=a.n(l),o=a(73614),d=a(91361),f=a(71256),m=a(11329),c=a(25784),g=(a(2250),a(89965),a(41196)),v=a(14906),p=a(44194),h=a(33019),x=a(98830),M=(a(39497),a(31549));t.Z=function(e){var t,a,i=e.messageLeaveSettings,s=e.onMessageLeaveSettingsChange,l=(0,v.useIntl)(),y=(0,d.Z)().translateString,w=c.A.useForm(),b=r()(w,1)[0],T=(null===(t=g.Z.useWatch)||void 0===t||t.call(g.Z,"messageLeaveNotify",b),null===(a=g.Z.useWatch)||void 0===a?void 0:a.call(g.Z,"messageLeaveNotifyType",b)),q=(0,x.u)((function(e){return e.currentOrg})),k=(0,p.useMemo)((function(){return null!=i?i:{}}),[i]),L=(0,p.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==k?void 0:k.draft)&&void 0!==t?t:null==k?void 0:k.live)&&void 0!==e?e:void 0}),[k]),S=((0,p.useMemo)((function(){return[{label:l.formatMessage({id:"leavemsg.notify.email",defaultMessage:"Email"}),value:"EMAIL"},{label:l.formatMessage({id:"leavemsg.notify.sms",defaultMessage:"SMS"}),value:"SMS"},{label:l.formatMessage({id:"leavemsg.notify.email_sms",defaultMessage:"Email + SMS"}),value:"EMAIL_SMS"}]}),[l]),(0,p.useRef)("")),Z=(0,p.useState)(""),j=r()(Z,2),W=j[0],E=j[1],P=(0,p.useCallback)((function(e){e&&0!==Object.keys(e).length&&(null==s||s(e))}),[s]);(0,p.useEffect)((function(){var e,t,a;b.setFieldsValue({messageLeaveEnabled:null===(e=null==L?void 0:L.messageLeaveEnabled)||void 0===e||e,messageLeaveAgentUid:null==L?void 0:L.messageLeaveAgentUid,messageLeaveNotify:null!==(t=null==L?void 0:L.messageLeaveNotify)&&void 0!==t&&t,messageLeaveNotifyType:null!==(a=null==L?void 0:L.messageLeaveNotifyType)&&void 0!==a?a:"EMAIL",messageLeaveNotifyEmail:null==L?void 0:L.messageLeaveNotifyEmail,messageLeaveNotifyMobile:null==L?void 0:L.messageLeaveNotifyMobile,messageLeaveForm:null==L?void 0:L.messageLeaveForm});var i=y(null==L?void 0:L.messageLeaveTip)||"";S.current!==i&&(S.current=i,E(i),b.setFieldValue("messageLeaveTip",i))}),[L,b,y]);var C=(0,p.useCallback)((function(e){P(e)}),[P]),F=(0,p.useCallback)((function(e){S.current=e,E(e),b.setFieldValue("messageLeaveTip",e),P({messageLeaveTip:e})}),[P,b]),V=((0,p.useCallback)(function(){var e=u()(n()().mark((function e(t){var a,i,s;return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=q&&q.uid){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,(0,h._t)({pageNumber:0,pageSize:100,orgUid:q.uid,searchText:null!=t?t:""});case 5:if(200!==(null==(a=e.sent)?void 0:a.code)){e.next=8;break}return e.abrupt("return",(null!==(i=null==a||null===(s=a.data)||void 0===s?void 0:s.content)&&void 0!==i?i:[]).map((function(e){return{label:(null==e?void 0:e.nickname)||(null==e?void 0:e.uid),value:null==e?void 0:e.uid}})).filter((function(e){return Boolean(e.value)})));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),[null==q?void 0:q.uid]),!1);null!=T||null==L||L.messageLeaveNotifyType;return(0,M.jsxs)(c.A,{form:b,submitter:!1,style:{marginLeft:"20px"},onValuesChange:function(e){return C(e)},children:[!1,(0,M.jsx)(c.A.Item,{name:"messageLeaveTip",label:(0,M.jsxs)("span",{children:[l.formatMessage({id:"agent.settings.leave.msg"}),(0,M.jsx)(o.Z,{type:"messageLeave",keys:["messageLeaveTip"],live:null==k?void 0:k.live,draft:null==k?void 0:k.draft})]}),rules:[{required:!0,message:l.formatMessage({id:"agent.settings.leave.msg.required"})}],children:(0,M.jsx)(m.Z,{placeholder:l.formatMessage({id:"agent.settings.leave.msg.placeholder"}),value:W,toolbarKeys:(0,f.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:F},"messageLeaveTipEditor")}),!1,V,V,false,false]})}},24476:function(e,t,a){var i=a(45332),n=a.n(i),s=a(73614),u=a(25784),l=a(60796),r=a(80953),o=a(14906),d=a(44194),f=a(31549);t.Z=function(e){e.variant;var t,a,i=e.queueSettings,m=e.onQueueSettingsChange,c=(0,o.useIntl)(),g=u.A.useForm(),v=n()(g,1)[0],p=(0,d.useRef)(!1),h=u.A.useWatch("showEstimatedWaitTime",v),x=(0,d.useMemo)((function(){return{position:"{position}",waitTime:"{waitTime}"}}),[]),M=(0,d.useMemo)((function(){return null!=i?i:{}}),[i]),y=(0,d.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==M?void 0:M.draft)&&void 0!==t?t:null==M?void 0:M.live)&&void 0!==e?e:void 0}),[null==M?void 0:M.draft,null==M?void 0:M.live]),w=(0,d.useCallback)((function(e){e&&0!==Object.keys(e).length&&(null==m||m(e))}),[m]),b=(0,d.useCallback)((function(e,t){var a=!1!==t,i=[];return!1!==e&&i.push(c.formatMessage({id:"queue.settings.tip.fragment.position",defaultMessage:"您前面还有 {position} 人排队"},x)),a&&i.push(c.formatMessage({id:"queue.settings.tip.fragment.wait",defaultMessage:"预计等待 {waitTime}"},x)),i.push(c.formatMessage({id:"queue.settings.tip.fragment.suffix",defaultMessage:"请耐心等候。"})),i.filter(Boolean).join("，")}),[c,x]),T=(0,d.useCallback)((function(e){var t=e&&"showQueuePosition"in e?e.showQueuePosition:v.getFieldValue("showQueuePosition"),a=e&&"showEstimatedWaitTime"in e?e.showEstimatedWaitTime:v.getFieldValue("showEstimatedWaitTime"),i=b(t,a);v.getFieldValue("queueTip")!==i&&(p.current=!0,v.setFieldsValue({queueTip:i}),p.current=!1,w({queueTip:i}))}),[b,w,v]);(0,d.useEffect)((function(){var e,t,a,i,n,s,u,l;p.current=!0,v.setFieldsValue({queueRobot:null!==(e=null==y?void 0:y.queueRobot)&&void 0!==e&&e,showQueuePosition:null===(t=null==y?void 0:y.showQueuePosition)||void 0===t||t,showEstimatedWaitTime:null===(a=null==y?void 0:y.showEstimatedWaitTime)||void 0===a||a,avgWaitTimePerPerson:null!==(i=null==y?void 0:y.avgWaitTimePerPerson)&&void 0!==i?i:60,maxWaiting:null!==(n=null==y?void 0:y.maxWaiting)&&void 0!==n?n:1e4,maxWaitTime:null!==(s=null==y?void 0:y.maxWaitTime)&&void 0!==s?s:86400,queueTip:null!==(u=null==y?void 0:y.queueTip)&&void 0!==u?u:"",queueReadyTip:null!==(l=null==y?void 0:y.queueReadyTip)&&void 0!==l?l:""}),p.current=!1}),[y,v]);var q=(0,d.useCallback)((function(e){p.current||(w(e),("showQueuePosition"in e||"showEstimatedWaitTime"in e)&&T(e))}),[w,T]);t=null!=h?h:null==y?void 0:y.showEstimatedWaitTime;return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(u.A,{layout:"vertical",form:v,submitter:!1,style:{marginLeft:"20px"},onValuesChange:q,children:[(0,f.jsx)(l.Z,{width:"md",name:"maxWaiting",label:(0,f.jsxs)("span",{children:[c.formatMessage({id:"queue.settings.max.waiting",defaultMessage:"最大等待人数"}),(0,f.jsx)(s.Z,{type:"generic",keys:["maxWaiting"],live:null==M?void 0:M.live,draft:null==M?void 0:M.draft})]}),min:1,max:1e5,fieldProps:{precision:0},tooltip:c.formatMessage({id:"queue.settings.max.waiting.tooltip",defaultMessage:"设置允许同时排队等待的最大访客数量，超过则进入留言流程"})}),(0,f.jsx)(l.Z,{width:"md",name:"maxWaitTime",label:(0,f.jsxs)("span",{children:[c.formatMessage({id:"queue.settings.max.wait.time",defaultMessage:"最大等待时间(秒)"}),(0,f.jsx)(s.Z,{type:"generic",keys:["maxWaitTime"],live:null==M?void 0:M.live,draft:null==M?void 0:M.draft})]}),min:1,max:604800,fieldProps:{precision:0},tooltip:c.formatMessage({id:"queue.settings.max.wait.time.tooltip",defaultMessage:"设置访客最长排队等待时间（秒），超时后将进入留言流程"}),extra:c.formatMessage({id:"queue.settings.max.wait.time.extra",defaultMessage:"当前设置：约 {hours} 小时"},{hours:Math.round((null!==(a=null==y?void 0:y.maxWaitTime)&&void 0!==a?a:86400)/3600)})}),(0,f.jsx)(l.Z,{width:"md",name:"avgWaitTimePerPerson",label:(0,f.jsxs)("span",{children:[c.formatMessage({id:"queue.settings.avg.wait.time.per.person",defaultMessage:"每人平均等待时长(秒)"}),(0,f.jsx)(s.Z,{type:"generic",keys:["avgWaitTimePerPerson"],live:null==M?void 0:M.live,draft:null==M?void 0:M.draft})]}),min:1,max:600,fieldProps:{precision:0},tooltip:c.formatMessage({id:"queue.settings.avg.wait.time.per.person.tooltip",defaultMessage:"用于计算预计等待时间，预计等待时间 = 前面排队人数 × 每人平均等待时长"}),extra:c.formatMessage({id:"queue.settings.avg.wait.time.per.person.extra",defaultMessage:"默认值：60 秒（1 分钟）"})}),(0,f.jsx)(r.Z,{width:"lg",name:"queueTip",label:(0,f.jsxs)("span",{children:[c.formatMessage({id:"queue.settings.tip",defaultMessage:"排队提示语模板"}),(0,f.jsx)(s.Z,{type:"generic",keys:["queueTip"],live:null==M?void 0:M.live,draft:null==M?void 0:M.draft})]}),fieldProps:{rows:3,maxLength:500},placeholder:c.formatMessage({id:"queue.settings.tip.placeholder",defaultMessage:"您前面还有 {position} 人排队，预计等待 {waitTime}，请耐心等候。"},{position:x.position,waitTime:x.waitTime}),tooltip:c.formatMessage({id:"queue.settings.tip.tooltip",defaultMessage:"访客排队时显示的提示信息，支持模板变量自动替换"}),extra:(0,f.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:c.formatMessage({id:"queue.settings.tip.variables",defaultMessage:"支持的模板变量：\n• '{'position'}' - 当前排队位置（前面的排队人数）\n• '{'queueSize'}' - 当前队列总人数\n• '{'waitSeconds'}' - 预计等待秒数\n• '{'waitMinutes'}' - 预计等待分钟数\n• '{'waitTime'}' - 格式化的等待时间（如\"约5分钟\"）"})})}),(0,f.jsx)(r.Z,{width:"lg",name:"queueReadyTip",label:(0,f.jsxs)("span",{children:[c.formatMessage({id:"queue.settings.ready.tip",defaultMessage:"即将接入提示语"}),(0,f.jsx)(s.Z,{type:"generic",keys:["queueReadyTip"],live:null==M?void 0:M.live,draft:null==M?void 0:M.draft})]}),fieldProps:{rows:2,maxLength:200},placeholder:c.formatMessage({id:"queue.settings.ready.tip.placeholder",defaultMessage:"客服即将为您服务，请稍候..."}),tooltip:c.formatMessage({id:"queue.settings.ready.tip.tooltip",defaultMessage:"当访客排队位置为0（即前面没有人排队，下一个就是该访客）时显示的提示信息"}),extra:c.formatMessage({id:"queue.settings.ready.tip.extra",defaultMessage:"此提示语用于替代排队位置为0时的默认提示，提升用户体验"})})]})})}},52260:function(e,t,a){a(73193),a(84176),a(45332),a(14906),a(44194),a(31549)},75112:function(e,t,a){var i=a(14597);t.Z=function(){var e=(0,i.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}}}]);