"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9359],{18877:function(e,t,n){n.d(t,{Bv:function(){return T},L0:function(){return C},QB:function(){return x},RF:function(){return M},YO:function(){return S},YQ:function(){return A},Yg:function(){return m},kh:function(){return p},kv:function(){return y},pf:function(){return c},y:function(){return v}});var r=n(90819),a=n.n(r),o=n(73193),i=n.n(o),s=n(89933),u=n.n(s),l=n(36265),d=n(5861);function c(e){return f.apply(this,arguments)}function f(){return(f=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/query/org",{method:"GET",params:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/create",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/update",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/delete",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/enable",{method:"POST",data:{uid:t.uid,enabled:t.enabled,channel:l.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/deleteAll",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return q.apply(this,arguments)}function q(){return(q=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return j.apply(this,arguments)}function j(){return(j=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateVectorIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return R.apply(this,arguments)}function R(){return(R=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateAllIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return U.apply(this,arguments)}function U(){return(U=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateAllVectorIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return P.apply(this,arguments)}function P(){return(P=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/agent/text/faq-similar-questions",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},87561:function(e,t,n){n.d(t,{Ck:function(){return m},dv:function(){return x},pw:function(){return y},qL:function(){return p},z4:function(){return v}});var r=n(90819),a=n.n(r),o=n(89933),i=n.n(o),s=n(73193),u=n.n(s),l=n(36265),d=n(5861),c="/api/v1/quickbutton";function f(e){var t;return u()(u()({},e),{},{channel:null!==(t=null==e?void 0:e.channel)&&void 0!==t?t:l.XtJ})}function p(e){return g.apply(this,arguments)}function g(){return(g=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/query/org"),{method:"GET",params:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/create"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/update"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/delete"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/enable"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},93458:function(e,t,n){var r=n(90819),a=n.n(r),o=n(89933),i=n.n(o),s=n(45332),u=n.n(s),l=n(74491),d=n(5286),c=n(3771),f=n(71865),p=n(36265),g=n(40845),v=n(13437),h=n(2685),m=n(5861),b=n(44194),y=n(31549);t.Z=function(e){var t=g.A.useForm(),n=u()(t,1)[0],r=(0,m.useIntl)(),o=(0,f.u)((function(e){return e.currentOrg})),s=(0,b.useState)([]),w=u()(s,2),x=w[0],k=w[1],M=(0,b.useRef)(!1),q=(0,b.useMemo)((function(){var t;return null!==(t=e.serviceSettings)&&void 0!==t?t:{}}),[e.serviceSettings]),S=(0,b.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==q?void 0:q.draft)&&void 0!==t?t:null==q?void 0:q.live)&&void 0!==e?e:void 0}),[q]);return(0,b.useEffect)((function(){null!=o&&o.uid&&!M.current&&(M.current=!0,i()(a()().mark((function e(){var t,n,r,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pageNumber:0,pageSize:100,type:p.QPQ,orgUid:o.uid},e.next=3,(0,c.AP)(t);case 3:200===(n=e.sent).code?(i=((null===(r=n.data)||void 0===r?void 0:r.content)||[]).map((function(e){return{label:e.name||e.uid||"",value:e.uid}})),k(i)):d.yw.error(n.message);case 5:case"end":return e.stop()}}),e)})))())}),[null==o?void 0:o.uid]),(0,b.useEffect)((function(){var e,t;n.setFieldsValue({inputAssociationEnabled:null!==(e=null==S?void 0:S.inputAssociationEnabled)&&void 0!==e&&e,inputPreviewEnabled:null!==(t=null==S?void 0:S.inputPreviewEnabled)&&void 0!==t&&t,inputAssociationKbUid:null==S?void 0:S.inputAssociationKbUid})}),[n,null==S?void 0:S.inputAssociationEnabled,null==S?void 0:S.inputPreviewEnabled,null==S?void 0:S.inputAssociationKbUid]),(0,y.jsxs)(g.A,{form:n,submitter:!1,style:{marginLeft:20},children:["robot"!==e.variant&&(0,y.jsx)(v.Z,{name:"inputPreviewEnabled",width:"md",label:(0,y.jsxs)("span",{children:[(0,y.jsx)(m.FormattedMessage,{id:"settings.inputPreview.enable",defaultMessage:"启用访客输入预览"}),(0,y.jsx)(l.Z,{type:"service",keys:["inputPreviewEnabled"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),fieldProps:{onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputPreviewEnabled:t})}}}),(0,y.jsx)(v.Z,{name:"inputAssociationEnabled",width:"md",label:(0,y.jsxs)("span",{children:[(0,y.jsx)(m.FormattedMessage,{id:"settings.inputAssociation.enable",defaultMessage:"启用访客输入联想"}),(0,y.jsx)(l.Z,{type:"service",keys:["inputAssociationEnabled"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),fieldProps:{onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputAssociationEnabled:t})}}}),(0,y.jsx)(h.Z,{name:"inputAssociationKbUid",width:"md",label:(0,y.jsxs)("span",{children:[(0,y.jsx)(m.FormattedMessage,{id:"settings.inputAssociation.kb",defaultMessage:"联想关联知识库"}),(0,y.jsx)(l.Z,{type:"service",keys:["inputAssociationKbUid"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),options:x,fieldProps:{allowClear:!0,onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputAssociationKbUid:t})}},placeholder:r.formatMessage({id:"choose",defaultMessage:"Choose"})})]})}},14368:function(e,t,n){n(90819),n(89933),n(73193),n(45332),n(87666),n(77394),n(39122),n(36265),n(5861),n(44194),n(36100),n(74491),n(31549)},98896:function(e,t,n){var r=n(90819),a=n.n(r),o=n(89933),i=n.n(o),s=n(45332),u=n.n(s),l=(n(14267),n(40845)),d=n(13437),c=n(5861),f=n(44194),p=(n(73001),n(31661)),g=n(31549);t.Z=function(e){e.variant;var t=e.serviceSettings,n=e.onServiceSettingsChange,r=(0,c.useIntl)(),o=l.A.useForm(),s=u()(o,1)[0],v=(0,p.Z)().translateString,h=(0,f.useState)(!1),m=u()(h,2),b=(m[0],m[1]),y=(0,f.useState)(""),w=u()(y,2),x=(w[0],w[1]),k=(0,f.useMemo)((function(){var e,n;return null!==(e=null!==(n=null==t?void 0:t.draft)&&void 0!==n?n:null==t?void 0:t.live)&&void 0!==e?e:void 0}),[null==t?void 0:t.draft,null==t?void 0:t.live]);(0,f.useEffect)((function(){var e=!(null==k||!k.showRateBtn),t=v(null==k?void 0:k.inviteRateTip)||"";s.setFieldsValue({showRateBtn:null==k?void 0:k.showRateBtn,autoInviteRate:null==k?void 0:k.autoInviteRate}),b(e),x(t)}),[k,s,v]);var M=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onFinish:",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRating handleChange autoInviteRate",t),s.setFieldValue("autoInviteRate",t),null==n||n({autoInviteRate:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(l.A,{form:s,onFinish:M,submitter:!1,style:{marginLeft:"20px"},children:[(0,g.jsx)(d.Z,{width:"md",name:"autoInviteRate",label:r.formatMessage({id:"rate.auto.invite.rate"}),tooltip:r.formatMessage({id:"rate.auto.invite.rate.tooltip"}),fieldProps:{onChange:q}}),!1]})})}},61401:function(e,t,n){var r=n(76711),a=n.n(r),o=n(90819),i=n.n(o),s=n(89933),u=n.n(s),l=n(45332),d=n.n(l),c=n(5286),f=n(18877),p=n(3771),g=n(71865),v=n(31661),h=n(36265),m=n(74491),b=n(40845),y=n(13437),w=n(44565),x=n(2685),k=n(9989),M=n(5861),q=n(44194),S=n(73120),j=n(42539),C=n(31549);t.Z=function(e){var t,n,r,o,s=e.variant,l=e.serviceSettings,R=e.onServiceSettingsChange,T=e.agentRightPanelTabs,U=e.onAgentRightPanelTabsChange,A=(e.settingsUid,e.isActive,(0,M.useIntl)()),P=b.A.useForm(),F=d()(P,1)[0],I=(0,g.u)((function(e){return e.currentOrg})),Z=(0,v.Z)().translateString,O=null==l?void 0:l.live,E=null==l?void 0:l.draft,B=(0,q.useMemo)((function(){var e;return null!==(e=null!=E?E:O)&&void 0!==e?e:{}}),[E,O]),K=(0,q.useState)(),W=d()(K,2),V=W[0],L=W[1],Q=(0,q.useState)(),J=d()(Q,2),D=J[0],Y=J[1],N=(0,q.useState)(),X=d()(N,2),H=X[0],z=X[1],$=(0,q.useState)("iframe"),_=d()($,2),G=_[0],ee=_[1],te=null!==(t=null==T?void 0:T.live)&&void 0!==t?t:[],ne=null!==(n=null==T?void 0:T.draft)&&void 0!==n?n:void 0,re=(0,q.useMemo)((function(){var e;return null!==(e=null!=ne?ne:te)&&void 0!==e?e:[]}),[ne,te]),ae=(0,q.useCallback)(function(){var e=u()(i()().mark((function e(t){var n,r,a,o,s,u,l,d;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||H){e.next=4;break}return console.log("TabRight: 没有选择知识库，无法获取FAQ"),L(void 0),e.abrupt("return");case 4:return c.yw.loading(A.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:100,orgUid:null==I?void 0:I.uid,kbUid:t||H},e.prev=6,e.next=9,(0,f.pf)(n);case 9:r=e.sent,j.Z.debug("TabRight.getFaqs response:",n,r),c.yw.destroy(),200===r.code?(a={code:r.code,message:r.message,data:{content:null==r?void 0:r.data.content.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer,kbUid:e.kbUid,orgUid:e.orgUid}})),totalElements:null==r?void 0:r.data.totalElements,totalPages:null==r?void 0:r.data.totalPages,number:null==r?void 0:r.data.number}},L(a),o=t||H,s=F.getFieldValue("faqUids")||[],o&&s.length>0&&(l=(null==a||null===(u=a.data.content)||void 0===u?void 0:u.map((function(e){return e.uid})))||[],(d=s.filter((function(e){return l.includes(e)}))).length!==s.length&&F.setFieldValue("faqUids",d))):c.yw.error(r.message),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(6),c.yw.destroy(),console.error("TabRight 获取FAQ失败:",e.t0),c.yw.error("获取FAQ失败");case 20:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}(),[null==I?void 0:I.uid,F,A,H]),oe=(0,q.useCallback)(u()(i()().mark((function e(){var t,n,r,a,o;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(A.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:h.QPQ,orgUid:null==I?void 0:I.uid},e.prev=2,e.next=5,(0,p.AP)(t);case 5:n=e.sent,j.Z.debug("TabRight.getKbases response:",t,n),c.yw.destroy(),200===n.code?(a={code:n.code,message:n.message,data:{content:null==n?void 0:n.data.content.map((function(e){return{uid:e.uid,name:e.name,type:e.type,orgUid:e.orgUid}})),totalElements:null==n?void 0:n.data.totalElements,totalPages:null==n?void 0:n.data.totalPages,number:null==n?void 0:n.data.number}},Y(a),null!=E&&E.faqKbUid?o=E.faqKbUid:null!=O&&O.faqKbUid?o=O.faqKbUid:(null==a||null===(r=a.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&(o=null==a?void 0:a.data.content[0].uid),o&&(z(o),F.setFieldValue("faqKbUid",o),ae(o))):c.yw.error(n.message),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),c.yw.destroy(),console.error("TabRight 获取知识库失败:",e.t0),c.yw.error("获取知识库失败");case 16:case"end":return e.stop()}}),e,null,[[2,11]])}))),[null==I?void 0:I.uid,F,ae,A,null==E?void 0:E.faqKbUid,null==O?void 0:O.faqKbUid]);(0,q.useEffect)((function(){var e=Array.isArray(null==B?void 0:B.faqs)?(null==B?void 0:B.faqs).map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[];F.setFieldsValue({showRightIframe:null==B?void 0:B.showRightIframe,rightIframeUrl:null==B?void 0:B.rightIframeUrl,showFaqs:null==B?void 0:B.showFaqs,faqKbUid:null==B?void 0:B.faqKbUid,faqUids:Array.isArray(null==B?void 0:B.faqUids)?null==B?void 0:B.faqUids:e,agentRightPanelTabs:re}),null!=B&&B.faqKbUid&&B.faqKbUid!==H&&(z(B.faqKbUid),ae(B.faqKbUid))}),[F,ae,B,re,H]),(0,q.useEffect)((function(){null!=I&&I.uid&&oe()}),[null==I?void 0:I.uid,oe]);var ie=function(){var e=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showRightIframe",t),F.setFieldValue("showRightIframe",t),null==R||R({showRightIframe:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showFaqs",t),F.setFieldValue("showFaqs",t),null==R||R({showFaqs:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(y.Z,{width:"md",name:"showRightIframe",label:(0,C.jsxs)("span",{children:[A.formatMessage({id:"showRightIframe"}),(0,C.jsx)(m.Z,{type:"service",keys:["showRightIframe"],live:O,draft:E})]}),fieldProps:{onChange:ie}}),(0,C.jsx)(w.Z,{width:"md",name:"rightIframeUrl",label:(0,C.jsxs)("span",{children:[A.formatMessage({id:"rightIframeUrl"}),(0,C.jsx)(m.Z,{type:"service",keys:["rightIframeUrl"],live:O,draft:E})]}),placeholder:A.formatMessage({id:"rightIframeUrl.placeholder",defaultMessage:"请输入以 http:// 或 https:// 开头的URL"}),rules:[{type:"url",message:A.formatMessage({id:"rightIframeUrl.invalid",defaultMessage:"请输入有效的URL地址"})},{pattern:/^https?:\/\/[^\s]+$/i,message:A.formatMessage({id:"rightIframeUrl.scheme.required",defaultMessage:"必须以 http:// 或 https:// 开头"})}],fieldProps:{type:"url",inputMode:"url",allowClear:!0}})]}),le=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(y.Z,{width:"md",name:"showFaqs",label:(0,C.jsxs)("span",{children:[A.formatMessage({id:"faq.show.faqs"}),(0,C.jsx)(m.Z,{type:"service",keys:["showFaqs"],live:O,draft:E})]}),fieldProps:{onChange:se}}),(0,C.jsx)(x.Z,{name:"faqKbUid",width:"md",label:(0,C.jsxs)("span",{children:[A.formatMessage({id:"faq.kbase.select",defaultMessage:"选择侧边栏常见问题知识库"}),(0,C.jsx)(m.Z,{type:"service",keys:["faqKbUid"],live:O,draft:E})]}),options:null==D||null===(r=D.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.map((function(e){return{label:Z(e.name),value:e.uid}})),fieldProps:{onChange:function(e){console.log("TabRight selected kbase:",e),z(e),F.setFieldValue("faqUids",[]),ae(e),null==R||R({faqKbUid:e,faqUids:[]})},allowClear:!0,placeholder:A.formatMessage({id:"choose",defaultMessage:"Choose"})}}),(0,C.jsx)(x.Z,{name:"faqUids",width:"md",label:(0,C.jsxs)("span",{children:[A.formatMessage({id:"menu.kbase.faq"}),(0,C.jsx)(m.Z,{type:"service",keys:["faqUids"],live:O,draft:E})]}),tooltip:A.formatMessage({id:"faq.uids.dependency.tooltip",defaultMessage:"FAQ options depend on the knowledge base selected above."}),extra:A.formatMessage({id:"faq.uids.dependency.note",defaultMessage:"Choose a knowledge base first; switching it refreshes the FAQ list and clears current selections."}),options:null==V||null===(o=V.data)||void 0===o||null===(o=o.content)||void 0===o?void 0:o.map((function(e){return{label:Z(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:A.formatMessage({id:"choose",defaultMessage:"Choose"})}})]}),de=(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(k.u,{name:"agentRightPanelTabs",creatorButtonProps:{creatorButtonText:A.formatMessage({id:"agent.rightpanel.tab.add",defaultMessage:"添加 Tab"})},deleteIconProps:{tooltipText:A.formatMessage({id:"delete",defaultMessage:"删除"})},copyIconProps:!1,children:function(){return(0,C.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,C.jsx)(w.Z,{name:"title",width:"md",label:A.formatMessage({id:"agent.rightpanel.tab.title",defaultMessage:"Tab 标题"}),placeholder:A.formatMessage({id:"agent.rightpanel.tab.title.placeholder",defaultMessage:"请输入标题"}),rules:[{required:!0,message:A.formatMessage({id:"required",defaultMessage:"必填"})}]}),(0,C.jsx)(w.Z,{name:"url",width:"xl",label:A.formatMessage({id:"agent.rightpanel.tab.url",defaultMessage:"内嵌 URL"}),placeholder:A.formatMessage({id:"agent.rightpanel.tab.url.placeholder",defaultMessage:"请输入以 http:// 或 https:// 开头的URL"}),rules:[{required:!0,message:A.formatMessage({id:"required",defaultMessage:"必填"})},{type:"url",message:A.formatMessage({id:"rightIframeUrl.invalid",defaultMessage:"请输入有效的URL地址"})},{pattern:/^https?:\/\/[^\s]+$/i,message:A.formatMessage({id:"rightIframeUrl.scheme.required",defaultMessage:"必须以 http:// 或 https:// 开头"})}],fieldProps:{type:"url",inputMode:"url",allowClear:!0}})]})}})});return(0,C.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,C.jsx)(b.A,{form:F,onValuesChange:function(e,t){var n={};Object.prototype.hasOwnProperty.call(e,"rightIframeUrl")&&(n.rightIframeUrl=t.rightIframeUrl),Object.prototype.hasOwnProperty.call(e,"faqUids")&&(n.faqUids=t.faqUids),Object.prototype.hasOwnProperty.call(e,"faqKbUid")&&(n.faqKbUid=t.faqKbUid),Object.keys(n).length>0&&(null==R||R(n)),Object.prototype.hasOwnProperty.call(e,"agentRightPanelTabs")&&(null==U||U(t.agentRightPanelTabs||[]))},submitter:!1,children:(0,C.jsx)(S.Z,{activeKey:G,onChange:ee,items:[{key:"iframe",label:A.formatMessage({id:"showRightIframe",defaultMessage:"右侧iframe"}),children:ue},{key:"faq",label:A.formatMessage({id:"faq.show.faqs",defaultMessage:"常见问题"}),children:le}].concat(a()("agent"===s?[{key:"agent-right-panel-tabs",label:A.formatMessage({id:"agent.rightpanel.tabs",defaultMessage:"客服端右侧栏自定义tab"}),children:de}]:[]))})})})}},20427:function(e,t,n){var r=n(73193),a=n.n(r),o=n(45332),i=n.n(o),s=n(74491),u=n(28902),l=n(36265),d=n(40845),c=n(89767),f=n(5861),p=n(76185),g=n(33122),v=n(44194),h=n(31549);t.Z=function(e){var t,n=d.A.useForm(),r=i()(n,1)[0],o=(0,f.useIntl)(),m={width:320},b=(0,u.z)((function(e){return{currentRobotSettings:e.currentRobotSettings,currentAgentSettings:e.currentAgentSettings,currentWorkgroupSettings:e.currentWorkgroupSettings,setCurrentRobotSettings:e.setCurrentRobotSettings,setCurrentAgentSettings:e.setCurrentAgentSettings,setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings}})),y=b.currentRobotSettings,w=b.currentAgentSettings,x=b.currentWorkgroupSettings,k=b.setCurrentRobotSettings,M=b.setCurrentAgentSettings,q=b.setCurrentWorkgroupSettings,S=void 0!==e.variant,j=S?e:null,C=S?j.variant:(t=e.type)===l.Njn?"agent":t===l._X4?"robot":"workgroup",R=(0,v.useMemo)((function(){var e;return S?null!==(e=null==j?void 0:j.serviceSettings)&&void 0!==e?e:{}:"agent"===C?{live:null==w?void 0:w.serviceSettings,draft:null==w?void 0:w.draftServiceSettings}:"robot"===C?{live:null==y?void 0:y.serviceSettings,draft:null==y?void 0:y.draftServiceSettings}:{live:null==x?void 0:x.serviceSettings,draft:null==x?void 0:x.draftServiceSettings}}),[S,j,C,w,y,x]),T=(0,v.useMemo)((function(){return"agent"!==C?null:S?null!==(e=null==j?void 0:j.agentMeta)&&void 0!==e?e:null:{maxThreadCount:null==w?void 0:w.maxThreadCount,timeoutRemindTime:null==w?void 0:w.timeoutRemindTime};var e}),[C,S,j,w]),U=(0,v.useCallback)((function(e){"agent"===C&&w?M(a()(a()({},w),{},{serviceSettings:a()(a()({},w.serviceSettings),e),draftServiceSettings:a()(a()({},w.draftServiceSettings||{}),e)})):"robot"===C&&y?k(a()(a()({},y),{},{serviceSettings:a()(a()({},y.serviceSettings),e),draftServiceSettings:a()(a()({},y.draftServiceSettings||{}),e)})):"workgroup"===C&&x&&q(a()(a()({},x),{},{serviceSettings:a()(a()({},x.serviceSettings),e),draftServiceSettings:a()(a()({},x.draftServiceSettings||{}),e)}))}),[C,w,y,x,M,k,q]),A=(0,v.useCallback)((function(e){"agent"===C&&w&&M(a()(a()({},w),e))}),[C,w,M]),P=(0,v.useCallback)((function(e){var t;S?null==j||null===(t=j.onServiceSettingsChange)||void 0===t||t.call(j,e):U(e)}),[S,j,U]),F=(0,v.useCallback)((function(e){var t;"agent"===C&&(S?null==j||null===(t=j.onAgentMetaChange)||void 0===t||t.call(j,e):A(e))}),[C,S,j,A]),I=(0,v.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==R?void 0:R.draft)&&void 0!==t?t:null==R?void 0:R.live)&&void 0!==e?e:void 0}),[R]);return(0,v.useEffect)((function(){r.setFieldsValue({autoCloseMin:null==I?void 0:I.autoCloseMin,showLogo:null==I?void 0:I.showLogo})}),[r,I]),(0,v.useEffect)((function(){"agent"===C&&r.setFieldsValue({maxThreadCount:null==T?void 0:T.maxThreadCount,timeoutRemindTime:null==T?void 0:T.timeoutRemindTime})}),[r,C,null==T?void 0:T.maxThreadCount,null==T?void 0:T.timeoutRemindTime]),(0,h.jsxs)(d.A,{form:r,submitter:!1,style:{marginLeft:"20px"},children:["agent"===C&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.Z,{width:"md",name:"maxThreadCount",label:o.formatMessage({id:"agent.settings.max.thread"}),tooltip:o.formatMessage({id:"agent.settings.max.thread.tooltip",defaultMessage:"超出此设置数量会自动进入排队队列，需要手动接入"}),min:0,formItemProps:{style:m},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&F({maxThreadCount:e})}}}),(0,h.jsx)(d.A.Item,{label:o.formatMessage({id:"agent.settings.timeout.remind",defaultMessage:"超时提醒时间"}),tooltip:o.formatMessage({id:"agent.settings.timeout.remind.tooltip",defaultMessage:"超过设定时间未回复客户将收到提醒"}),style:m,children:(0,h.jsxs)(p.Z.Compact,{block:!0,children:[(0,h.jsx)(c.Z,{formItemProps:{noStyle:!0},width:"md",name:"timeoutRemindTime",min:1,fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&F({timeoutRemindTime:e})}}}),(0,h.jsx)(g.Z,{disabled:!0,value:o.formatMessage({id:"time.minute",defaultMessage:"分钟"}),style:{width:72,textAlign:"center"},readOnly:!0,tabIndex:-1})]})})]}),(0,h.jsx)(c.Z,{width:"md",name:"autoCloseMin",label:(0,h.jsxs)("span",{children:[o.formatMessage({id:"agent.settings.auto.close.time"}),(0,h.jsx)(s.Z,{type:"service",keys:["autoCloseMin"],live:null==R?void 0:R.live,draft:null==R?void 0:R.draft})]}),tooltip:o.formatMessage({id:"agent.settings.auto.close.time.tooltip"}),min:1,formItemProps:{style:m},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&P({autoCloseMin:e})}}})]})}},62742:function(e,t,n){var r=n(45332),a=n.n(r),o=n(74491),i=n(31661),s=n(14267),u=n(40845),l=n(53380),d=n(5861),c=n(44194),f=n(73001),p=n(31549);t.Z=function(e){var t=u.A.useForm(),n=a()(t,1)[0],r=(0,d.useIntl)(),g=(0,i.Z)().translateString,v=e.variant,h=e.serviceSettings,m=e.onServiceSettingsChange,b=(0,c.useState)(!1),y=a()(b,2),w=y[0],x=y[1],k=(0,c.useState)(""),M=a()(k,2),q=M[0],S=M[1],j=(0,c.useState)(""),C=a()(j,2),R=C[0],T=C[1],U=(0,c.useState)(""),A=a()(U,2),P=A[0],F=A[1],I=(0,c.useRef)({topTip:"",agentCloseTip:"",autoCloseTip:""}),Z=(0,c.useMemo)((function(){return null!=h?h:{}}),[h]),O=(0,c.useCallback)((function(e){null==m||m(e)}),[m]),E=(0,c.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==Z?void 0:Z.draft)&&void 0!==t?t:null==Z?void 0:Z.live)&&void 0!==e?e:void 0}),[Z]);(0,c.useEffect)((function(){var e=!(null==E||!E.showTopTip);w!==e&&(x(e),n.setFieldValue("showTopTip",e));var t=function(e,t){var r=g(t)||"";I.current[e]!==r&&(I.current[e]=r,"topTip"===e?S(r):"agentCloseTip"===e?T(r):"autoCloseTip"===e&&F(r),n.setFieldValue(e,r))};E?(t("topTip",E.topTip),t("agentCloseTip",E.agentCloseTip),t("autoCloseTip",E.autoCloseTip)):(t("topTip",""),t("agentCloseTip",""),t("autoCloseTip",""))}),[E,n,w,g,v]);var B=(0,c.useCallback)((function(e){I.current.topTip=e,S(e),n.setFieldValue("topTip",e),O({topTip:e})}),[n,O]),K=(0,c.useCallback)((function(e){I.current.agentCloseTip=e,T(e),n.setFieldValue("agentCloseTip",e),O({agentCloseTip:e})}),[n,O]),W=(0,c.useCallback)((function(e){I.current.autoCloseTip=e,F(e),n.setFieldValue("autoCloseTip",e),O({autoCloseTip:e})}),[n,O]);return(0,p.jsxs)(u.A,{form:n,submitter:!1,style:{marginLeft:"20px"},children:[(0,p.jsx)(l.Z,{name:"showTopTip",width:"md",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.show.top.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["showTopTip"],live:null==Z?void 0:Z.live,draft:null==Z?void 0:Z.draft})]}),fieldProps:{onChange:function(e){x(e.target.checked),e.target.checked&&S(g(null==E?void 0:E.topTip)),O({showTopTip:e.target.checked})}}}),w&&(0,p.jsx)(u.A.Item,{name:"topTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.top.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["topTip"],live:null==Z?void 0:Z.live,draft:null==Z?void 0:Z.draft})]}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.top.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.top.tip.placeholder"}),value:q,toolbarKeys:(0,s.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return B(e)}},"topTipEditor")}),"agent"===v&&(0,p.jsx)(u.A.Item,{name:"agentCloseTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.agent.close.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["agentCloseTip"],live:null==Z?void 0:Z.live,draft:null==Z?void 0:Z.draft})]}),tooltip:r.formatMessage({id:"agent.settings.agent.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.agent.close.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.agent.close.tip.placeholder"}),value:R,toolbarKeys:(0,s.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return K(e)}},"agentCloseTipEditor")}),(0,p.jsx)(u.A.Item,{name:"autoCloseTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.auto.close.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["autoCloseTip"],live:null==Z?void 0:Z.live,draft:null==Z?void 0:Z.draft})]}),tooltip:r.formatMessage({id:"agent.settings.auto.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.auto.close.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.auto.close.tip.placeholder"}),value:P,toolbarKeys:(0,s.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return W(e)}},"autoCloseTipEditor")})]})}},74008:function(e,t,n){var r=n(73193),a=n.n(r),o=n(90819),i=n.n(o),s=n(89933),u=n.n(s),l=n(45332),d=n.n(l),c=n(5286),f=n(87561),p=n(71865),g=n(40845),v=n(13437),h=n(2685),m=n(5861),b=n(44194),y=n(46435),w=n(63889),x=n(73120),k=n(31661),M=n(74491),q=n(31549),S=["smile","image","file","rate","leavemsg"];t.Z=function(e){var t=e.serviceSettings,n=e.onServiceSettingsChange,r=(0,m.useIntl)(),o=g.A.useForm(),s=d()(o,1)[0],l=(0,k.Z)().translateString,j=(0,p.u)((function(e){return e.currentOrg})),C=(0,b.useState)("toolbar"),R=d()(C,2),T=R[0],U=R[1],A=(0,b.useState)([]),P=d()(A,2),F=P[0],I=P[1],Z=(0,b.useState)(!1),O=d()(Z,2),E=O[0],B=O[1],K=null==t?void 0:t.live,W=null==t?void 0:t.draft,V=(0,b.useMemo)((function(){return null!=W?W:K}),[W,K]),L=(0,b.useCallback)(u()(i()().mark((function e(){var t,n,a,o,u,l,d,p;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=j&&j.uid){e.next=3;break}return I([]),e.abrupt("return");case 3:return B(!0),t=c.yw.loading(r.formatMessage({id:"loading",defaultMessage:"Loading"})),e.prev=5,e.next=8,(0,f.qL)({pageNumber:0,pageSize:200,orgUid:j.uid});case 8:200===(n=e.sent).code?(o=((null==n||null===(a=n.data)||void 0===a?void 0:a.content)||[]).filter((function(e){return Boolean(null==e?void 0:e.uid)})),u=o.sort((function(e,t){var n,r;return(null!==(n=null==e?void 0:e.orderIndex)&&void 0!==n?n:0)-(null!==(r=null==t?void 0:t.orderIndex)&&void 0!==r?r:0)})),I(u),l=new Set(u.map((function(e){return e.uid}))),d=s.getFieldValue("quickButtonUids")||[],(p=d.filter((function(e){return l.has(e)}))).length!==d.length&&s.setFieldValue("quickButtonUids",p)):c.yw.error(n.message||r.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),c.yw.error(r.formatMessage({id:"request.failed",defaultMessage:"Request failed"}));case 15:return e.prev=15,null==t||t(),B(!1),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[5,12,15,19]])}))),[null==j?void 0:j.uid,s,r]);(0,b.useEffect)((function(){L()}),[L]),(0,b.useEffect)((function(){var e,t,n,r,a,o,i,u,l,d;if(V){var c=V.toolbar||{},f=null==V?void 0:V.quickButtons;s.setFieldsValue({smile:null===(e=c.smile)||void 0===e||e,image:null===(t=c.image)||void 0===t||t,file:null===(n=c.file)||void 0===n||n,rate:null===(r=c.rate)||void 0===r||r,leavemsg:null===(a=c.leavemsg)||void 0===a||a,orderSelector:null===(o=c.orderSelector)||void 0===o||o,ticket:null===(i=c.ticket)||void 0===i||i,audio:null===(u=c.audio)||void 0===u||u,video:null===(l=c.video)||void 0===l||l,tel:null===(d=c.tel)||void 0===d||d,toolbarOrder:Array.isArray(c.order)&&c.order.length>0?c.order:[].concat(S),showQuickButtons:V.showQuickButtons,quickButtonUids:Array.isArray(null==V?void 0:V.quickButtonUids)?V.quickButtonUids:Array.isArray(f)?f.map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[]})}}),[V,s]);var Q=(0,b.useCallback)((function(e){s.setFieldValue("showQuickButtons",e),null==n||n({showQuickButtons:e})}),[s,n]),J=(0,b.useMemo)((function(){return null!=F&&F.length?F.filter((function(e){return Boolean(null==e?void 0:e.uid)})).map((function(e){return{label:l(e.title)||e.title||e.uid,value:e.uid}})):[]}),[F,l]),D=(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)(y.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"smile",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.emoji",defaultMessage:"Emoji"}),(0,q.jsx)(M.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"image",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.image",defaultMessage:"Image"}),(0,q.jsx)(M.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"file",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.file",defaultMessage:"File"}),(0,q.jsx)(M.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"rate",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.rate",defaultMessage:"Rate"}),(0,q.jsx)(M.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"leavemsg",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.leaveMsg",defaultMessage:"Leave Msg"}),(0,q.jsx)(M.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})})]})}),Y=(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(v.Z,{label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"faq.show.quick.buttons"}),(0,q.jsx)(M.Z,{type:"service",keys:["showQuickButtons"],live:K,draft:W})]}),name:"showQuickButtons",width:"md",fieldProps:{onChange:Q}}),(0,q.jsx)(h.Z,{name:"quickButtonUids",width:"lg",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"menu.kbase.quickbutton"}),(0,q.jsx)(M.Z,{type:"service",keys:["quickButtonUids","quickButtons"],live:K,draft:W})]}),options:J,fieldProps:{mode:"multiple",allowClear:!0,showSearch:!0,optionFilterProp:"label",placeholder:(0,q.jsx)(m.FormattedMessage,{id:"choose",defaultMessage:"Choose"}),loading:E}})]});return(0,q.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,q.jsx)(g.A,{form:s,onValuesChange:function(e,t){var r={};["smile","image","file","rate","leavemsg"].forEach((function(n){Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=t[n])}));var o=Object.prototype.hasOwnProperty.call(e,"toolbarOrder"),i={},s=a()(a()({},(null==K?void 0:K.toolbar)||{}),(null==W?void 0:W.toolbar)||{});Object.keys(r).length>0&&(i.toolbar=a()(a()({},s),r)),o&&(i.toolbar=a()(a()({},i.toolbar||s),{},{order:t.toolbarOrder||[]})),["showQuickButtons","quickButtonUids"].forEach((function(n){Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=t[n])})),0!==Object.keys(i).length&&(null==n||n(i))},submitter:!1,children:(0,q.jsx)(x.Z,{activeKey:T,onChange:U,items:[{key:"toolbar",label:r.formatMessage({id:"chat.toolbar.settings",defaultMessage:"工具栏设置"}),children:D},{key:"quickButton",label:r.formatMessage({id:"quick.faq.settings",defaultMessage:"快捷按钮设置"}),children:Y}]})})})}},43769:function(e,t,n){n(73193),n(45332),n(89957),n(74491),n(5861),n(44194),n(31549)},73001:function(e,t,n){var r=n(73193),a=n.n(r),o=n(5286),i=n(74494),s=n(87523),u=n(36265),l=n(5861),d=n(68922),c=(n(48725),n(96596)),f=n.n(c),p=n(44194),g=n(31549);t.Z=function(e){var t=e.placeholder,n=e.defaultValue,r=e.value,c=e.style,v=e.toolbarKeys,h=e.maxLength,m=e.onChange,b=e.options,y=(0,l.useIntl)(),w=(0,i.Z)().isDarkMode,x=(0,p.useRef)(null),k=(0,p.useRef)(null),M=(0,p.useRef)(!1),q=(0,p.useRef)(m);(0,p.useEffect)((function(){q.current=m}),[m]);var S=function(e,t,n){"function"!=typeof q.current||M.current||q.current(e,t,n)};return(0,p.useEffect)((function(){if(x.current){if(!k.current){var e=new d.cW(a()(a()({element:x.current,theme:w?"dark":"light",placeholder:t,content:n,toolbarKeys:v},b||{}),{},{image:{uploadUrl:(0,s.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(u.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var i=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,s=new FormData;return s.append("file",e),s.append("fileName",i),s.append("fileType",e.type),s.append("isAvatar","false"),s.append("kbType",u.QPQ),s.append("categoryUid",""),s.append("kbUid",""),s.append("orgUid",""),s.append("client",u.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:a()({Accept:"application/json"},n),body:s}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){o.yw.destroy(),o.yw.success("".concat(i," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,alt:i}};e(n)}else o.yw.destroy(),o.yw.error("".concat(i," 上传失败"))})).catch((function(e){r(e)}))}))}},video:{uploadUrl:(0,s.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(u.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var i=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,s=new FormData;return s.append("file",e),s.append("fileName",i),s.append("fileType",e.type),s.append("isAvatar","false"),s.append("kbType",u.QPQ),s.append("categoryUid",""),s.append("kbUid",""),s.append("client",u.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:a()({Accept:"application/json"},n),body:s}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){o.yw.destroy(),o.yw.success("".concat(i," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,poster:"https://www.weiyuai.cn/avatars/video_poster.png"}};e(n)}else o.yw.destroy(),o.yw.error("".concat(i," 上传失败"))})).catch((function(e){r(e)}))}))}},attachment:{uploadUrl:(0,s.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(u.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var i=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,s=new FormData;return s.append("file",e),s.append("fileName",i),s.append("fileType",e.type),s.append("isAvatar","false"),s.append("kbType",u.QPQ),s.append("categoryUid",""),s.append("kbUid",""),s.append("client",u.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:a()({Accept:"application/json"},n),body:s}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){o.yw.destroy(),o.yw.success("".concat(i," 上传成功"));var n={errorCode:0,data:{href:t.data.fileUrl,fileName:i}};e(n)}else o.yw.destroy(),o.yw.error("".concat(i," 上传失败"))})).catch((function(e){r(e)}))}))}},onChange:function(e){var t=e.getText(),n=t.length,r="number"==typeof h?h:Number.POSITIVE_INFINITY;if(n>r){var a,i;o.yw.warning(y.formatMessage({id:"character.limit.reached"},{limit:r})||"已达到 ".concat(r," 字符限制"));var s=t.substring(0,r);M.current=!0,setTimeout((function(){k.current&&k.current.setContent(s),M.current=!1}),0),S((null===(a=k.current)||void 0===a?void 0:a.getHtml())||"",(null===(i=k.current)||void 0===i?void 0:i.getMarkdown())||"",s)}else S(e.getHtml(),e.getMarkdown(),e.getText())}}));k.current=e}return function(){k.current&&(k.current.destroy(),k.current=null)}}}),[]),(0,p.useEffect)((function(){k.current&&void 0!==r&&r!==k.current.getHtml()&&(M.current=!0,k.current.setContent(r||"",!1),requestAnimationFrame((function(){M.current=!1})))}),[r]),(0,g.jsx)("div",{ref:x,style:a()({height:"100%"},c)})}},74491:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(73193),a=n.n(r),o=n(44194),i=n(20921),s=n(96082),u=n(86222),l=n.n(u),d=n(89957),c=n.n(d),f=["welcomeFaqUids","faqUids","quickButtonUids","guessFaqUids","hotFaqUids","shortcutFaqUids","proactiveFaqUids"],p=["welcomeFaqs","faqs","quickButtons","guessFaqs","hotFaqs","shortcutFaqs","proactiveFaqs"];function g(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e,t){if(!e)return e;if(!t||0===t.length)return e;var n={};return t.forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})),n}function h(e){var t=e&&g(e)?a()({},e):{};return p.forEach((function(e){t[e]&&(t[e.replace(/s$/,"Uids")]=function(e){if(Array.isArray(e))return e.map((function(e){return null==e?void 0:e.uid})).filter(Boolean).map(String)}(t[e]),delete t[e])})),f.forEach((function(e){t[e]&&(t[e]=function(e){if(!Array.isArray(e))return e;var t=e.slice();return t.every((function(e){return["string","number","boolean"].includes(c()(e))}))?t.map((function(e){return"string"==typeof e?e:String(e)})).sort():t}(t[e]))})),t}function m(e){return e&&g(e)?a()({},e):{}}function b(e){var t=new WeakSet;return JSON.stringify(function e(n){if(null===n||"object"!==c()(n))return n;if(!t.has(n)){if(t.add(n),Array.isArray(n))return n.map((function(t){return e(t)}));var r,a=Object.keys(n).sort(),o={},i=l()(a);try{for(i.s();!(r=i.n()).done;){var s=r.value;o[s]=e(n[s])}}catch(e){i.e(e)}finally{i.f()}return o}}(e))}function y(e,t){return b(e)===b(t)}var w=n(31549),x=function(e){var t=e.hasDiff,n=e.type,r=void 0===n?"service":n,u=e.live,l=e.draft,d=e.keys,c=e.text,f=void 0===c?"草稿未发布":c,p=e.style;return(0,o.useMemo)((function(){if("boolean"==typeof t)return t;if(!u&&!l)return!1;switch(r){case"service":return function(e,t,n){return!y(v(h(e),n),v(h(t),n))}(u,l,d);case"messageLeave":return function(e,t,n){return!y(v(m(e),n),v(m(t),n))}(u,l,d);default:return function(e,t,n){return!y(v(e||{},n),v(t||{},n))}(u,l,d)}}),[t,r,u,l,d])?(0,w.jsx)(i.Z,{title:"string"==typeof f?f:"草稿与线上不一致",children:(0,w.jsx)(s.Z,{color:"orange",style:a()({marginLeft:8,height:20,lineHeight:"18px"},p),children:"Draft"})}):null}},77394:function(e,t,n){n.d(t,{V:function(){return c}});var r=n(73193),a=n.n(r),o=n(76711),i=n.n(o),s=n(36265),u=n(74543),l=n(21152),d=n(72083),c=(0,u.Ue)()((0,l.mW)((0,l.tJ)((0,d.n)((function(e,t){return{robotResult:{data:{content:[]}},currentRobot:{uid:"",nickname:""},insertRobot:function(t){e((function(e){e.robotResult.data.content.unshift(t)}))},setRobotResult:function(n){e({robotResult:n});var r,a=t().currentRobot;""!==a.uid&&void 0!==a||(null===(r=n.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentRobot:n.data.content[0]})},setCurrentRobot:function(n){var r=t().robotResult.data.content,o=r.findIndex((function(e){return e.uid===n.uid}));if(-1!==o){var s=[].concat(i()(r.slice(0,o)),[n],i()(r.slice(o+1))),u=a()(a()({},t().robotResult),{},{data:{content:s}});e({robotResult:u,currentRobot:n})}else console.warn("Robot with the specified uid not found."),e({currentRobot:n})},deleteCurrentRobot:function(n){var r=t().robotResult.data.content,o=r.findIndex((function(e){return e.uid===n}));-1!==o?e({robotResult:a()(a()({},t().robotResult),{},{data:{content:[].concat(i()(r.slice(0,o)),i()(r.slice(o+1)))}})}):console.warn("Robot not found in cache:",n),t().currentRobot.uid===n&&e({currentRobot:{uid:""}})},deleteRobotCache:function(){return e({},!0)}}})),{name:s.Eis})))},87666:function(e,t,n){n.d(t,{E:function(){return c}});var r=n(73193),a=n.n(r),o=n(76711),i=n.n(o),s=n(36265),u=n(74543),l=n(21152),d=n(72083),c=(0,u.Ue)()((0,l.mW)((0,l.tJ)((0,d.n)((function(e,t){return{agentResult:{data:{content:[]}},currentAgent:{uid:"",orgUid:""},insertAgent:function(t){e((function(e){e.agentResult.data.content.unshift(t)}))},updateAgent:function(t){e((function(e){var n=e.agentResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n[r]=t:console.warn("Agent with uid ".concat(t.uid," not found."))}))},setAgentResult:function(n){var r;(e({agentResult:n}),""===t().currentAgent.uid)&&((null===(r=n.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentAgent:n.data.content[0]}))},setCurrentAgent:function(n){var r=t().agentResult.data.content,o=r.findIndex((function(e){return e.uid===n.uid}));if(-1!==o){var s=[].concat(i()(r.slice(0,o)),[n],i()(r.slice(o+1))),u=a()(a()({},t().agentResult),{},{data:{content:s}});e({agentResult:u,currentAgent:n})}else console.warn("Agent with the specified uid not found."),e({currentAgent:n})},deleteCurrentAgent:function(n){var r=t().agentResult.data.content,o=r.findIndex((function(e){return e.uid===n}));-1!==o?e({agentResult:a()(a()({},t().agentResult),{},{data:{content:[].concat(i()(r.slice(0,o)),i()(r.slice(o+1)))}})}):console.warn("Agent not found in cache:",n),t().currentAgent.uid===n&&e({currentAgent:{uid:"",orgUid:""}})},deleteAgentCache:function(){return e({},!0)}}})),{name:s.zzK})))},28902:function(e,t,n){n.d(t,{z:function(){return s}});var r=n(36265),a=n(74543),o=n(21152),i=n(72083),s=(0,a.Ue)()((0,o.mW)((0,o.tJ)((0,i.n)((function(e){return{currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null,setCurrentAgentSettings:function(t){return e({currentAgentSettings:t})},setCurrentRobotSettings:function(t){return e({currentRobotSettings:t})},setCurrentWorkgroupSettings:function(t){return e({currentWorkgroupSettings:t})},clear:function(){return e({currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null})}}})),{name:r.rpR})))},39122:function(e,t,n){n.d(t,{$:function(){return c}});var r=n(73193),a=n.n(r),o=n(76711),i=n.n(o),s=n(36265),u=n(74543),l=n(21152),d=n(72083),c=(0,u.Ue)()((0,l.mW)((0,l.tJ)((0,d.n)((function(e,t){return{workgroupResult:{data:{content:[]}},currentWorkgroup:{uid:"",nickname:"",avatar:"",description:"",orgUid:""},insertWorkgroup:function(t){e((function(e){e.workgroupResult.data.content.unshift(t)}))},updateWorkgroup:function(t){e((function(e){var n=e.workgroupResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n[r]=t:console.warn("Workgroup with uid ".concat(t.uid," not found."))}))},deleteWorkgroup:function(t){e((function(e){var n=e.workgroupResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n.splice(r,1):console.warn("Workgroup with uid ".concat(t.uid," not found."))}))},setWorkgroupResult:function(n){var r;(e({workgroupResult:n}),""===t().currentWorkgroup.uid)&&((null===(r=n.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentWorkgroup:n.data.content[0]}))},setCurrentWorkgroup:function(n){var r=t().workgroupResult.data.content,o=r.findIndex((function(e){return e.uid===n.uid}));if(-1!==o){var s=[].concat(i()(r.slice(0,o)),[n],i()(r.slice(o+1))),u=a()(a()({},t().workgroupResult),{},{data:{content:s}});e({workgroupResult:u,currentWorkgroup:n})}else console.warn("Workgroup with the specified uid not found."),e({currentWorkgroup:n})},deleteCurrentWorkgroup:function(n){var r=t().workgroupResult.data.content,o=r.findIndex((function(e){return e.uid===n}));-1!==o?e({workgroupResult:a()(a()({},t().workgroupResult),{},{data:{content:[].concat(i()(r.slice(0,o)),i()(r.slice(o+1)))}})}):console.warn("Workgroup not found in cache:",n),t().currentWorkgroup.uid===n&&e({currentWorkgroup:{uid:"",orgUid:""}})},deleteWorkgroupCache:function(){return e({},!0)}}})),{name:s.b6l})))}}]);