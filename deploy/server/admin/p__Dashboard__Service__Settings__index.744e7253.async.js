"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1654,2180],{3995:function(e,s,a){a.r(s),a.d(s,{default:function(){return ee}});var n=a(90819),l=a.n(n),t=a(89933),i=a.n(t),r=a(45332),o=a.n(r),c=a(44194),d=a(85817),m=a(20903),u=a(49616),h=a(5780),x=a(37963),b=a(68779),j=a(68455),p=a(58368),Z=a(58087),g=a(36693),f=a(98385),v=a(12322),w=a(80556),y=a(55785),k=a(88354),I=a(14870),M=a(5025),C=a(34599),P=a(8340),N=a(27259),F=a(31549),T=function(){return(0,F.jsxs)("div",{children:[(0,F.jsx)(m.Z.Item,{name:["basic","showLogo"],label:"显示 Logo",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["basic","showChatWindow"],label:"显示聊天窗口",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["basic","welcomeTip"],label:"欢迎语",rules:[{required:!0,message:"请输入欢迎语"}],children:(0,F.jsx)(N.Z.TextArea,{rows:3,placeholder:"请输入欢迎语",allowClear:!0})}),(0,F.jsx)(m.Z.Item,{name:["basic","topTip"],label:"置顶公告",children:(0,F.jsx)(N.Z.TextArea,{rows:3,placeholder:"请输入置顶公告（可选）",allowClear:!0})})]})},H=a(27904),q=function(){return(0,F.jsxs)("div",{children:[(0,F.jsx)(m.Z.Item,{name:["channels","web","enabled"],label:"启用 Web 渠道",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["channels","web","rightPosition"],label:"右侧悬浮位置",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["channels","web","showBubble"],label:"显示气泡",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["channels","web","enableTheme"],label:"启用主题设置",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["channels","web","theme"],label:"主题",children:(0,F.jsx)(H.Z,{options:[{value:"system",label:"跟随系统"},{value:"light",label:"亮色"},{value:"dark",label:"暗色"}]})}),(0,F.jsx)(m.Z.Item,{name:["channels","web","enableMultilang"],label:"启用多语言",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["channels","web","lang"],label:"语言",children:(0,F.jsx)(H.Z,{options:[{value:"zh_cn",label:"简体中文"},{value:"zh_tw",label:"繁體中文"},{value:"en",label:"English"}]})}),(0,F.jsx)(m.Z.Item,{name:["channels","web","primaryColor"],label:"主题主色",children:(0,F.jsx)(N.Z,{placeholder:"#1677ff"})})]})},B=a(67206),W=[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5},{label:"周六",value:6},{label:"周日",value:7}],_=function(){return(0,F.jsxs)("div",{children:[(0,F.jsx)(m.Z.Item,{name:["assignment","autoAccept"],label:"自动接待",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["assignment","maxConcurrent"],label:"最大并发会话数",rules:[{required:!0,message:"请输入最大并发数"}],children:(0,F.jsx)(B.Z,{min:0,style:{width:200}})}),(0,F.jsx)(m.Z.Item,{name:["assignment","workingHours","enabled"],label:"启用工作时段",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsxs)(m.Z.Item,{label:"工作开始/结束时间",style:{marginBottom:0},children:[(0,F.jsx)(m.Z.Item,{name:["assignment","workingHours","startTime"],style:{display:"inline-block",marginRight:8},rules:[{pattern:/^\d{2}:\d{2}$/,message:"格式为 HH:mm"}],children:(0,F.jsx)(N.Z,{placeholder:"09:00",style:{width:120}})}),(0,F.jsx)(m.Z.Item,{name:["assignment","workingHours","endTime"],style:{display:"inline-block"},rules:[{pattern:/^\d{2}:\d{2}$/,message:"格式为 HH:mm"}],children:(0,F.jsx)(N.Z,{placeholder:"18:00",style:{width:120}})})]}),(0,F.jsx)(m.Z.Item,{name:["assignment","workingHours","workingDays"],label:"工作日",children:(0,F.jsx)(H.Z,{mode:"multiple",options:W,style:{width:300}})})]})},L=a(84244),O=[{label:"命中关键词",value:"keyword"},{label:"多轮无答案",value:"no_answer"},{label:"用户主动请求",value:"user_request"},{label:"满意度过低",value:"score_low"}],R=function(){return(0,F.jsxs)("div",{children:[(0,F.jsx)(m.Z.Item,{name:["bot","enabled"],label:"启用机器人",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["bot","autoHandoff"],label:"自动转人工",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["bot","handoffWhen"],label:"转人工条件",children:(0,F.jsx)(L.Z.Group,{options:O})}),(0,F.jsx)(m.Z.Item,{name:["bot","minBotRepliesBeforeHandoff"],label:"最少机器人回复次数",tooltip:"达到次数仍未解决时触发转人工",children:(0,F.jsx)(B.Z,{min:0,style:{width:200}})})]})},A=a(73193),z=a.n(A),K=a(84176),V=a.n(K),D=a(67652),E=a(64506),S=a(10162),U=["key","name"],$=function(){return(0,F.jsxs)("div",{children:[(0,F.jsx)(m.Z.Item,{name:["preChatForm","enabled"],label:"启用会话前表单",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.List,{name:["preChatForm","fields"],children:function(e,s){var a=s.add,n=s.remove;return(0,F.jsxs)(F.Fragment,{children:[e.map((function(e){var s=e.key,a=e.name,l=V()(e,U);return(0,F.jsxs)(u.Z,{align:"baseline",style:{display:"flex",marginBottom:8},children:[(0,F.jsx)(m.Z.Item,z()(z()({},l),{},{name:[a,"key"],rules:[{required:!0,message:"字段Key"}],children:(0,F.jsx)(N.Z,{placeholder:"字段Key",style:{width:160}})})),(0,F.jsx)(m.Z.Item,z()(z()({},l),{},{name:[a,"name"],rules:[{required:!0,message:"字段名称"}],children:(0,F.jsx)(N.Z,{placeholder:"字段名称",style:{width:160}})})),(0,F.jsx)(m.Z.Item,z()(z()({},l),{},{name:[a,"type"],initialValue:"text",children:(0,F.jsx)(H.Z,{style:{width:140},options:[{label:"文本",value:"text"},{label:"邮箱",value:"email"},{label:"手机",value:"mobile"},{label:"下拉",value:"select"}]})})),(0,F.jsx)(m.Z.Item,z()(z()({},l),{},{name:[a,"required"],valuePropName:"checked",children:(0,F.jsx)(P.Z,{checkedChildren:"必填",unCheckedChildren:"可选"})})),(0,F.jsx)(m.Z.Item,z()(z()({},l),{},{name:[a,"placeholder"],children:(0,F.jsx)(N.Z,{placeholder:"占位提示（可选）",style:{width:220}})})),(0,F.jsx)(D.Z,{title:"确定删除该字段？",onConfirm:function(){return n(a)},children:(0,F.jsx)(E.Z,{style:{color:"#ff4d4f"}})})]},s)})),(0,F.jsx)(m.Z.Item,{children:(0,F.jsx)(h.ZP,{type:"dashed",onClick:function(){return a()},block:!0,icon:(0,F.jsx)(S.Z,{}),children:"新增字段"})})]})}})]})},G=[{label:"会话创建",value:"created"},{label:"分配坐席",value:"assigned"},{label:"转人工",value:"handoff"},{label:"关闭会话",value:"closed"}],J=function(){return(0,F.jsxs)("div",{children:[(0,F.jsx)(m.Z.Item,{name:["notifications","email","enabled"],label:"启用邮件通知",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["notifications","email","events"],label:"邮件通知事件",children:(0,F.jsx)(H.Z,{mode:"multiple",options:G,style:{width:480}})}),(0,F.jsx)(m.Z.Item,{name:["notifications","internal","enabled"],label:"启用站内通知",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["notifications","internal","events"],label:"站内通知事件",children:(0,F.jsx)(H.Z,{mode:"multiple",options:G,style:{width:480}})}),(0,F.jsx)(m.Z.Item,{name:["notifications","webhook","enabled"],label:"启用 Webhook",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["notifications","webhook","url"],label:"Webhook 地址",rules:[{type:"url",message:"请输入正确的 URL"}],children:(0,F.jsx)(N.Z,{placeholder:"https://example.com/webhook"})}),(0,F.jsx)(m.Z.Item,{name:["notifications","webhook","events"],label:"Webhook 事件",children:(0,F.jsx)(H.Z,{mode:"multiple",options:G,style:{width:480}})})]})},Q=function(){return(0,F.jsxs)("div",{children:[(0,F.jsx)(m.Z.Item,{name:["rating","showRateButton"],label:"显示评价按钮",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["rating","autoInviteOnLeave"],label:"离开自动邀请评价",valuePropName:"checked",children:(0,F.jsx)(P.Z,{})}),(0,F.jsx)(m.Z.Item,{name:["rating","autoInviteTip"],label:"自动邀请评价提示",children:(0,F.jsx)(N.Z.TextArea,{rows:3,placeholder:"例如：欢迎为本次服务打分，感谢您的反馈"})}),(0,F.jsx)(m.Z.Item,{name:["rating","minMessages"],label:"允许评价的最少消息数",rules:[{required:!0,message:"请输入数值"}],children:(0,F.jsx)(B.Z,{min:0,style:{width:200}})})]})},X=d.Z.Title,Y={basic:{showLogo:!0,showChatWindow:!0,welcomeTip:"您好，我是在线客服，请问有什么可以帮到您？",topTip:""},channels:{web:{enabled:!0,rightPosition:!0,showBubble:!0,enableTheme:!0,theme:"system",enableMultilang:!0,lang:"zh_cn",primaryColor:"#1677ff"}},assignment:{autoAccept:!0,maxConcurrent:10,workingHours:{enabled:!0,startTime:"09:00",endTime:"18:00",workingDays:[1,2,3,4,5]}},bot:{enabled:!0,autoHandoff:!0,handoffWhen:["no_answer","user_request"],minBotRepliesBeforeHandoff:2},preChatForm:{enabled:!1,fields:[{key:"name",name:"姓名",type:"text",required:!1,placeholder:"请输入姓名"},{key:"mobile",name:"手机号",type:"mobile",required:!1,placeholder:"请输入手机号"},{key:"email",name:"邮箱",type:"email",required:!1,placeholder:"请输入邮箱"}]},notifications:{email:{enabled:!1,events:[]},internal:{enabled:!0,events:["created","assigned","closed"]},webhook:{enabled:!1,url:"",events:[]}},rating:{showRateButton:!0,autoInviteOnLeave:!0,autoInviteTip:"欢迎为本次服务评价，感谢您的反馈",minMessages:3}},ee=function(){var e=(0,I.useIntl)(),s=m.Z.useForm(),a=o()(s,1)[0],n=(0,c.useState)(!1),t=o()(n,2),r=t[0],d=t[1],P=(0,c.useState)("basic"),N=o()(P,2),H=N[0],B=N[1],W=(0,C.u)((function(e){return e.currentOrg})),L=(0,c.useMemo)((function(){return Y}),[]),O=function(){var s=i()(l()().mark((function s(){return l()().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:d(!0);try{a.setFieldsValue(L)}catch(s){M.yw.error(e.formatMessage({id:"service.settings.load.failed",defaultMessage:"加载设置失败"}))}finally{d(!1)}case 2:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}(),A=function(){var s=i()(l()().mark((function s(){return l()().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return d(!0),s.prev=1,s.next=4,a.validateFields();case 4:s.sent,M.yw.success(e.formatMessage({id:"service.settings.save.success",defaultMessage:"保存成功"})),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(1),M.yw.error(e.formatMessage({id:"service.settings.save.failed",defaultMessage:"保存失败"}));case 11:return s.prev=11,d(!1),s.finish(11);case 14:case"end":return s.stop()}}),s,null,[[1,8,11,14]])})));return function(){return s.apply(this,arguments)}}();(0,c.useEffect)((function(){O()}),[null==W?void 0:W.uid]);var z=[{key:"basic",label:(0,F.jsxs)("span",{children:[(0,F.jsx)(b.Z,{}),(0,F.jsx)(I.FormattedMessage,{id:"service.settings.tab.basic",defaultMessage:"基础设置"})]}),children:(0,F.jsx)(T,{})},{key:"channels",label:(0,F.jsxs)("span",{children:[(0,F.jsx)(j.Z,{}),(0,F.jsx)(I.FormattedMessage,{id:"service.settings.tab.channels",defaultMessage:"渠道配置"})]}),children:(0,F.jsx)(q,{})},{key:"assignment",label:(0,F.jsxs)("span",{children:[(0,F.jsx)(p.Z,{}),(0,F.jsx)(I.FormattedMessage,{id:"service.settings.tab.assignment",defaultMessage:"接待与分配"})]}),children:(0,F.jsx)(_,{})},{key:"bot",label:(0,F.jsxs)("span",{children:[(0,F.jsx)(Z.Z,{}),(0,F.jsx)(I.FormattedMessage,{id:"service.settings.tab.bot",defaultMessage:"机器人联动"})]}),children:(0,F.jsx)(R,{})},{key:"preChat",label:(0,F.jsxs)("span",{children:[(0,F.jsx)(g.Z,{}),(0,F.jsx)(I.FormattedMessage,{id:"service.settings.tab.prechat",defaultMessage:"会话前表单"})]}),children:(0,F.jsx)($,{})},{key:"notifications",label:(0,F.jsxs)("span",{children:[(0,F.jsx)(f.Z,{}),(0,F.jsx)(I.FormattedMessage,{id:"service.settings.tab.notifications",defaultMessage:"通知设置"})]}),children:(0,F.jsx)(J,{})},{key:"rating",label:(0,F.jsxs)("span",{children:[(0,F.jsx)(v.Z,{}),(0,F.jsx)(I.FormattedMessage,{id:"service.settings.tab.rating",defaultMessage:"评价与满意度"})]}),children:(0,F.jsx)(Q,{})}];return(0,F.jsx)(k.Z,{title:(0,F.jsxs)(u.Z,{children:[(0,F.jsx)(b.Z,{}),(0,F.jsx)(X,{level:4,style:{margin:0},children:(0,F.jsx)(I.FormattedMessage,{id:"service.settings.title",defaultMessage:"在线客服设置"})})]}),extra:(0,F.jsxs)(u.Z,{children:[(0,F.jsx)(h.ZP,{icon:(0,F.jsx)(w.Z,{}),onClick:function(){a.resetFields(),O(),M.yw.info(e.formatMessage({id:"service.settings.reset.info",defaultMessage:"已重置为初始设置"}))},disabled:r,children:(0,F.jsx)(I.FormattedMessage,{id:"service.settings.reset",defaultMessage:"重置"})}),(0,F.jsx)(h.ZP,{type:"primary",icon:(0,F.jsx)(y.Z,{}),onClick:A,loading:r,children:(0,F.jsx)(I.FormattedMessage,{id:"service.settings.save",defaultMessage:"保存设置"})})]}),style:{minHeight:"100vh"},children:(0,F.jsx)(m.Z,{form:a,layout:"vertical",initialValues:L,children:(0,F.jsx)(x.Z,{activeKey:H,onChange:B,type:"card",items:z,style:{marginTop:16}})})})}},34599:function(e,s,a){a.d(s,{u:function(){return r}});var n=a(5488),l=a(16894),t=a(45034),i=a(47401),r=(0,l.Ue)()((0,t.mW)((0,t.tJ)((0,i.n)((function(e,s){return{currentOrg:{uid:"",name:"",description:""},setCurrentOrg:function(s){e({currentOrg:s})},deleteOrg:function(){return e({},!0)}}})),{name:n.IzN})))}}]);