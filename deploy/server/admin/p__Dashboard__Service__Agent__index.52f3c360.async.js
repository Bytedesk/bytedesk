"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1642],{5651:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(77260),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=a.forwardRef(i)},38197:function(e,t,n){var r=n(39328),a=n(17323),o=n(44194),s=n(64665),i=n(31549),u=["fieldProps","request","params","proFieldProps"],l=function(e,t){var n=e.fieldProps,o=e.request,l=e.params,c=e.proFieldProps,d=(0,a.Z)(e,u);return(0,i.jsx)(s.Z,(0,r.Z)({valueType:"treeSelect",fieldProps:n,ref:t,request:o,params:l,filedConfig:{customLightMode:!0},proFieldProps:c},d))},c=o.forwardRef(l);t.Z=c},39291:function(e,t,n){var r=n(32394);t.ZP=r.A},69320:function(e,t,n){n.d(t,{I2:function(){return h},dO:function(){return g},l8:function(){return p},o_:function(){return d},vD:function(){return b}});var r=n(90819),a=n.n(r),o=n(73193),s=n.n(o),i=n(89933),u=n.n(i),l=n(5488),c=n(14870);function d(e){return f.apply(this,arguments)}function f(){return(f=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/fixed/query/org",{method:"GET",params:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/fixed/create",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return v.apply(this,arguments)}function v(){return(v=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/fixed/update",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/fixed/delete",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/fixed/enable",{method:"POST",data:{uid:t.uid,enabled:t.enabled,channel:l.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},73660:function(e,t,n){n.d(t,{D$:function(){return g},EP:function(){return h},hS:function(){return p},z_:function(){return d}});var r=n(90819),a=n.n(r),o=n(73193),s=n.n(o),i=n(89933),u=n.n(i),l=n(5488),c=n(14870);function d(e){return f.apply(this,arguments)}function f(){return(f=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/query/org",{method:"GET",params:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/create",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return v.apply(this,arguments)}function v(){return(v=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/update",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=u()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/delete",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},67934:function(e,t,n){n.r(t),n.d(t,{default:function(){return qe}});var r=n(66985),a=n(44194),o=n(37963),s=n(14870),i=n(90819),u=n.n(i),l=n(73193),c=n.n(l),d=n(89933),f=n.n(d),g=n(45332),m=n.n(g),p=n(5025),v=n(94956),h=n(18751),x=n(16698),b=n(92023),y=n(59908),C=n(32394),j=n(48821),M=n(16331),k=n(45681),w=n(5780),Z=n(31549),S=function(){var e=C.A.useForm(),t=m()(e,1)[0],n=(0,s.useIntl)(),r=(0,h.Z)().translateString,o=(0,x.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),i=o.currentAgent,l=o.setCurrentAgent,d=(0,a.useState)(""),g=m()(d,2),S=g[0],R=g[1];(0,a.useEffect)((function(){var e;i&&t.setFieldsValue({nickname:r(null==i?void 0:i.nickname),email:null==i?void 0:i.email,mobile:null==i?void 0:i.mobile,description:r(null==i?void 0:i.description),memberUid:null==i||null===(e=i.member)||void 0===e?void 0:e.uid})}),[i]);var T=function(){var e=f()(u()().mark((function e(t){var r,a;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleUploadSuccess:",t),R(t),r=c()(c()({},i),{},{avatar:t}),e.next=5,(0,v.n1)(r);case 5:a=e.sent,console.log("updateAvatar response:",a),200===a.code?(p.yw.success(n.formatMessage({id:"update.success"})),l(a.data)):(p.yw.destroy(),p.yw.error(a.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=f()(u()().mark((function e(t){var r,a,o,s,d,f,g,m,h,x;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish:",t),p.yw.loading(n.formatMessage({id:"updating"})),h=c()(c()(c()({},i),t),{},{avatar:S,serviceSettings:c()(c()({},i.serviceSettings),{},{welcomeFaqUids:null==i||null===(r=i.serviceSettings)||void 0===r||null===(r=r.welcomeFaqs)||void 0===r?void 0:r.map((function(e){return e.uid})),quickFaqUids:null==i||null===(a=i.serviceSettings)||void 0===a||null===(a=a.quickFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),faqUids:null==i||null===(o=i.serviceSettings)||void 0===o||null===(o=o.faqs)||void 0===o?void 0:o.map((function(e){return e.uid})),guessFaqUids:null==i||null===(s=i.serviceSettings)||void 0===s||null===(s=s.guessFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),hotFaqUids:null==i||null===(d=i.serviceSettings)||void 0===d||null===(d=d.hotFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),shortcutFaqUids:null==i||null===(f=i.serviceSettings)||void 0===f||null===(f=f.shortcutFaqs)||void 0===f?void 0:f.map((function(e){return e.uid}))}),robotSettings:c()(c()({},i.robotSettings),{},{robotUid:null===(g=i.robotSettings)||void 0===g||null===(g=g.robot)||void 0===g?void 0:g.uid}),messageLeaveSettings:c()(c()({},i.messageLeaveSettings),{},{worktimeUids:null==i||null===(m=i.messageLeaveSettings)||void 0===m||null===(m=m.worktimes)||void 0===m?void 0:m.map((function(e){return e.uid}))})}),console.log("agentObject:",h),e.next=6,(0,v.sE)(h);case 6:x=e.sent,console.log("updateAgent response:",x),200===x.code?(p.yw.destroy(),p.yw.success(n.formatMessage({id:"update.success"})),l(x.data)):(p.yw.destroy(),p.yw.error(x.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){var e;i&&(R(i.avatar),t.setFieldsValue({member:null==i||null===(e=i.member)||void 0===e?void 0:e.nickname}))}),[i]),(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)(C.A,{form:t,style:{marginLeft:"20px"},onFinish:A,children:[(0,Z.jsx)(C.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:n.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,Z.jsxs)(b.G,{onSuccess:T,onError:function(e){console.log("handleUploadError:",e),p.yw.error(e)},children:[(0,Z.jsx)(k.Z,{src:S}),(0,Z.jsx)(w.ZP,{icon:(0,Z.jsx)(y.Z,{}),children:n.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,Z.jsx)(j.Z,{width:"md",name:"nickname",label:n.formatMessage({id:"agent.info.nickname"}),rules:[{required:!0,message:n.formatMessage({id:"agent.info.nickname.required"})}]}),(0,Z.jsx)(j.Z,{width:"md",name:"email",label:n.formatMessage({id:"agent.info.email"}),rules:[{required:!0,message:n.formatMessage({id:"agent.info.email.required"})}]}),(0,Z.jsx)(j.Z,{width:"md",name:"mobile",label:n.formatMessage({id:"agent.info.mobile"}),rules:[{required:!0,message:n.formatMessage({id:"agent.info.mobile.required"})}]}),(0,Z.jsx)(M.Z,{width:"md",name:"description",label:n.formatMessage({id:"agent.info.description"}),rules:[{required:!0,message:n.formatMessage({id:"agent.info.description.required"})}]}),(0,Z.jsx)(j.Z,{width:"md",name:"member",label:n.formatMessage({id:"agent.info.member"}),disabled:!0})]})})},R=n(5488),T=n(72054),A=n(94146),q=n(10826),F=(n(57057),n(74790),n(50027),n(59956)),P=n(3642),U=n(69320),E=n(90486),z=n(34599),I=n(5651),L=n(11137),N=n(47783),O=n(93892),V=n(82373),D=function(e){var t,n,r=e.type,o=(0,s.useIntl)(),i=(0,s.useNavigate)(),l=C.A.useForm(),c=m()(l,1)[0],d=(0,h.Z)().translateString,g=(0,a.useState)(),b=m()(g,2),y=b[0],j=b[1],M=(0,a.useState)(),k=m()(M,2),S=k[0],T=k[1],A=(0,z.u)((function(e){return e.currentOrg})),q=(0,x.E)((function(e){return e.currentAgent})),F=(0,x.E)((function(e){return e.setCurrentAgent})),P=(0,a.useMemo)((function(){var e;return(null==q||null===(e=q.autoReplySettings)||void 0===e?void 0:e.autoReplyType)||R.DST}),[null==q||null===(t=q.autoReplySettings)||void 0===t?void 0:t.autoReplyType]),D=(0,a.useState)(P),B=m()(D,2),W=B[0],J=B[1],X=(0,a.useCallback)(f()(u()().mark((function e(){var t,n;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,p.yw.loading(o.formatMessage({id:"loading"})),t={pageNumber:0,pageSize:50,orgUid:null==A?void 0:A.uid},e.next=5,(0,U.o_)(t);case 5:n=e.sent,console.log("getAutoReplyFixed response:",n),200===n.code?j(n):p.yw.error(n.message),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error fetching auto replies:",e.t0),p.yw.error(o.formatMessage({id:"error.fetch.failed"}));case 14:return e.prev=14,p.yw.destroy(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,10,14,17]])}))),[null==A?void 0:A.uid]),_=(0,a.useCallback)(function(){var e=f()(u()().mark((function e(t){var n,r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,p.yw.loading(o.formatMessage({id:"loading"})),n={pageNumber:0,pageSize:50,type:t,orgUid:null==A?void 0:A.uid},e.next=5,(0,E.AP)(n);case 5:r=e.sent,console.log("getKeywordBase response:",r),200===r.code?T(r):p.yw.error(r.message),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error fetching knowledge base:",e.t0),p.yw.error(o.formatMessage({id:"error.fetch.failed"}));case 14:return e.prev=14,p.yw.destroy(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,10,14,17]])})));return function(t){return e.apply(this,arguments)}}(),[W,null==A?void 0:A.uid]);(0,a.useEffect)((function(){X(),_(R.WvL)}),[]),(0,a.useEffect)((function(){W===R.PZ1?_(R.WvL):W===R.PcP&&_(R.QPQ)}),[W]),(0,a.useEffect)((function(){var e,t,n,a,o,s;r===R.Njn&&null!=q&&q.autoReplySettings&&c.setFieldsValue({kbUid:null==q||null===(e=q.autoReplySettings)||void 0===e?void 0:e.kbUid,autoReplyEnabled:null==q||null===(t=q.autoReplySettings)||void 0===t?void 0:t.autoReplyEnabled,autoReplyType:null==q||null===(n=q.autoReplySettings)||void 0===n?void 0:n.autoReplyType,autoReplyUid:null==q||null===(a=q.autoReplySettings)||void 0===a?void 0:a.autoReplyUid,autoReplyContent:null==q||null===(o=q.autoReplySettings)||void 0===o?void 0:o.autoReplyContent,autoReplyContentType:null==q||null===(s=q.autoReplySettings)||void 0===s?void 0:s.autoReplyContentType})}),[q,c,r]);var Q=function(){var e=f()(u()().mark((function e(){var t,n;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleAutoReplySubmit:"),p.yw.loading(o.formatMessage({id:"autoreply.save.loading",defaultMessage:"Ê≠£Âú®‰øùÂ≠òÔºåËØ∑Á®çÂêé..."})),t={uid:null==q?void 0:q.uid,autoReplySettings:{autoReplyEnabled:c.getFieldValue("autoReplyEnabled"),autoReplyType:c.getFieldValue("autoReplyType"),autoReplyUid:c.getFieldValue("autoReplyUid"),autoReplyContent:c.getFieldValue("autoReplyContent"),autoReplyContentType:c.getFieldValue("autoReplyContentType"),kbUid:c.getFieldValue("kbUid")}},e.next=5,(0,v.i8)(t);case 5:n=e.sent,console.log("handleUpdateAutoReply:",n),200===n.code?(p.yw.destroy(),F(n.data)):(p.yw.destroy(),p.yw.error(o.formatMessage({id:"autoreply.save.error",defaultMessage:"‰øùÂ≠òÂ§±Ë¥•"})));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(O.Z,{message:"Ëá™Âä®ÂõûÂ§ç",description:"Â∑≤ÁªèÊé•ÂÖ•‰∫∫Â∑•ÁöÑÊÉÖÂÜµ‰∏ãÔºåËá™Âä®ÂõûÂ§çÂèØ‰ª•‰Ωú‰∏∫ËæÖÂä©ÂõûÂ§çÔºåÊèêÈ´òÂõûÂ§çÊïàÁéá„ÄÇ",type:"info"}),(0,Z.jsx)(V.Z,{}),(0,Z.jsxs)(C.A,{form:c,onFinish:Q,children:[(0,Z.jsx)(L.Z,{width:"md",name:"autoReplyEnabled",label:"ÊòØÂê¶ÂêØÁî®Ëá™Âä®ÂõûÂ§ç",fieldProps:{onChange:Q}}),(0,Z.jsx)(N.Z,{width:"md",name:"autoReplyType",label:"Ëá™Âä®ÂõûÂ§çÁ±ªÂûã",options:[{label:"Âõ∫ÂÆöÂõûÂ§ç",value:R.DST},{label:"ÂÖ≥ÈîÆÂ≠óÂåπÈÖç",value:R.PZ1},{label:"Â§ßÊ®°ÂûãÂõûÂ§ç",value:R.PcP,disabled:!0}],fieldProps:{onChange:function(e,t){!function(e,t){console.log("handleAutoReplyTypeChange:",e),J(e)}(e)}}}),W===R.DST&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(C.A.Item,{children:(0,Z.jsx)(w.ZP,{icon:(0,Z.jsx)(I.Z,{}),onClick:function(){i("/kb/autoreply/data")},children:"Ê∑ªÂä†Âõ∫ÂÆöÂõûÂ§çÂÜÖÂÆπ"},"github")}),(0,Z.jsx)(N.Z,{width:"md",name:"autoReplyContent",label:"ÈÄâÊã©Âõ∫ÂÆöÂõûÂ§çÂÜÖÂÆπ",options:null==y||null===(n=y.data)||void 0===n?void 0:n.content.map((function(e){return{label:d(null==e?void 0:e.content),value:null==e?void 0:e.content}})),fieldProps:{onChange:function(e,t){!function(e,t){var n;console.log("handleAutoReplySelectChange:",e),null==y||null===(n=y.data.content)||void 0===n||n.forEach((function(t){t.uid===e&&c.setFieldsValue({autoReplyContentType:t.type,autoReplyContent:t.content})}))}(e)}}})]}),W===R.PZ1&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(C.A.Item,{children:(0,Z.jsx)(w.ZP,{icon:(0,Z.jsx)(I.Z,{}),onClick:function(){i("/kb/autoreply/data")},children:"Ê∑ªÂä†ÂÖ≥ÈîÆËØçÁü•ËØÜÂ∫ì"},"github")}),(0,Z.jsx)(N.Z,{width:"md",name:"kbUid",label:"ÈÄâÊã©ÂÖ≥ÈîÆËØçÁü•ËØÜÂ∫ì",options:null==S?void 0:S.data.content.map((function(e){return{label:d(e.name),value:e.uid}}))})]}),W===R.PcP&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(C.A.Item,{children:(0,Z.jsx)(w.ZP,{icon:(0,Z.jsx)(I.Z,{}),onClick:function(){i("/kb/llm")},children:"Ê∑ªÂä†Â§ßÊ®°ÂûãÁü•ËØÜÂ∫ì"},"github")}),(0,Z.jsx)(N.Z,{width:"md",name:"kbUid",label:"ÈÄâÊã©Â§ßÊ®°ÂûãÁü•ËØÜÂ∫ì",options:null==S?void 0:S.data.content.map((function(e){return{label:d(e.name),value:e.uid}}))})]})]})]})},B=n(67072),W=(n(65398),n(39120),n(33232),n(40629),n(68100),n(87663),function(){var e=(0,s.useIntl)(),t=(0,x.E)((function(e){return e.setCurrentAgent})),n=(0,z.u)((function(e){return e.currentOrg})),r=(0,x.E)((function(e){return e.currentAgent})),i=(0,a.useMemo)((function(){return[{key:"faq",label:(0,Z.jsx)(s.FormattedMessage,{id:"menu.kbase.faq",defaultMessage:"FAQ"}),children:(0,Z.jsx)(T.Z,{type:R.Njn})},{key:"quickFaqs",label:(0,Z.jsx)(s.FormattedMessage,{id:"menu.kbase.quickbutton",defaultMessage:"QuickButton"}),children:(0,Z.jsx)(A.Z,{type:R.Njn})},{key:"rate",label:(0,Z.jsx)(s.FormattedMessage,{id:"rate",defaultMessage:"Rate"}),children:(0,Z.jsx)(q.Z,{type:R.Njn})},{key:"right",label:(0,Z.jsx)(s.FormattedMessage,{id:"right",defaultMessage:"Right"}),children:(0,Z.jsx)(P.Z,{type:R.Njn})},{key:"popup",label:(0,Z.jsx)(s.FormattedMessage,{id:"popup",defaultMessage:"Popup"}),children:(0,Z.jsx)(F.Z,{type:R.Njn})},{key:"trigger",label:(0,Z.jsx)(s.FormattedMessage,{id:"trigger",defaultMessage:"Trigger"}),children:(0,Z.jsx)(B.Z,{type:R.Njn})},{key:"autoreply",label:(0,Z.jsx)(s.FormattedMessage,{id:"autoreply",defaultMessage:"AutoReply"}),children:(0,Z.jsx)(D,{type:R.Njn})}]}),[e]),l=function(){var a=f()(u()().mark((function a(){var o,s;return u()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,p.yw.loading(e.formatMessage({id:"loading"})),o={orgUid:null==n?void 0:n.uid,uid:null==r?void 0:r.uid},a.next=5,(0,v.AT)(o);case 5:s=a.sent,console.log("queryAgentByUid response:",s),200===s.code?t(s.data):p.yw.error(s.message),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(0),console.error("Error fetching agent detail:",a.t0),p.yw.error(e.formatMessage({id:"error.fetch.failed"}));case 14:return a.prev=14,p.yw.destroy(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[0,10,14,17]])})));return function(){return a.apply(this,arguments)}}();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(o.Z,{tabPosition:"left",items:i,onChange:function(e){console.log("key:",e),l()}})})}),J=n(29787),X=n(1155),_=n(92634),Q=n(27473),H=n(53504),G=n(78875),K=n(20228),$=n(79401),Y=n(65532),ee=n(80556),te=n(40074),ne=n(58791),re=n(61353),ae=n(16852),oe=n(40439),se=n(86994),ie=n(58087),ue=n(75831),le=function(){var e=(0,s.useIntl)(),t=(0,a.useContext)(ue.I).isDarkMode,n=(0,x.E)((function(e){return e.currentAgent})),r=(0,z.u)((function(e){return e.currentOrg})),o=(0,a.useState)(!1),i=m()(o,2),l=i[0],d=i[1],g=(0,a.useState)({totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0}),v=m()(g,2),h=v[0],b=v[1],y=function(){var t=f()(u()().mark((function t(){var a,o,s,i,l,c,f,g,m,v,h,x,y;return u()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("requestQueue"),d(!0),p.yw.info(e.formatMessage({id:"refresh",defaultMessage:"Ê≠£Âú®Âà∑Êñ∞ÈòüÂàóÊï∞ÊçÆ..."})),t.prev=3,a={pageNumber:0,pageSize:100,agentUid:null==n?void 0:n.uid,orgUid:null==r?void 0:r.uid},t.next=7,(0,_.Wq)(a);case 7:o=t.sent,console.log("queryQueuesByOrg response:",o.data),200===(null==o?void 0:o.code)?(p.yw.destroy(),null!=o&&null!==(s=o.data)&&void 0!==s&&s.content&&o.data.content.length>0?(y=o.data.content.reduce((function(e,t){return e.totalCount+=t.totalCount||0,e.queuingCount+=t.queuingCount||0,e.chattingCount+=t.chattingCount||0,e.offlineCount+=t.offlineCount||0,e.closedCount+=t.closedCount||0,e.leaveMsgCount+=t.leaveMsgCount||0,e.robotToAgentCount+=t.robotToAgentCount||0,e.avgWaitTime=t.avgWaitTime,e.avgResolveTime=t.avgResolveTime,e}),{totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0}),b({totalCount:null!==(i=y.totalCount)&&void 0!==i?i:0,queuingCount:null!==(l=y.queuingCount)&&void 0!==l?l:0,chattingCount:null!==(c=y.chattingCount)&&void 0!==c?c:0,offlineCount:null!==(f=y.offlineCount)&&void 0!==f?f:0,closedCount:null!==(g=y.closedCount)&&void 0!==g?g:0,leaveMsgCount:null!==(m=y.leaveMsgCount)&&void 0!==m?m:0,robotToAgentCount:null!==(v=y.robotToAgentCount)&&void 0!==v?v:0,avgWaitTime:null!==(h=y.avgWaitTime)&&void 0!==h?h:0,avgResolveTime:null!==(x=y.avgResolveTime)&&void 0!==x?x:0})):b({totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0})):p.yw.error(null==o?void 0:o.message);case 10:return t.prev=10,d(!1),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[3,,10,13]])})));return function(){return t.apply(this,arguments)}}();(0,a.useEffect)((function(){y()}),[n]);var C={boxShadow:t?"0 4px 8px rgba(255,255,255,0.05)":"0 4px 8px rgba(0,0,0,0.1)",borderRadius:"8px",height:"100%",transition:"transform 0.3s",cursor:"pointer"},j={totalCount:{bg:t?"#0a2642":"#e6f7ff",valueColor:"#1890ff"},queuingCount:{bg:t?"#3b2500":"#fff7e6",valueColor:"#fa8c16"},chattingCount:{bg:t?"#162312":"#f6ffed",valueColor:"#52c41a"},offlineCount:{bg:t?"#1f1f1f":"#fcfcfc",valueColor:t?"#d9d9d9":"#8c8c8c"},closedCount:{bg:t?"#2a0e0d":"#fff1f0",valueColor:"#ff4d4f"},leaveMsgCount:{bg:t?"#230e2c":"#f9f0ff",valueColor:"#722ed1"},robotToAgentCount:{bg:t?"#102039":"#e6fffb",valueColor:"#13c2c2"},avgWaitTime:{bg:t?"#273010":"#fcffe6",valueColor:"#a0d911"},avgResolveTime:{bg:t?"#172b4d":"#f0f5ff",valueColor:"#2f54eb"}};return(0,Z.jsxs)("div",{style:{padding:"4px"},children:[(0,Z.jsx)("div",{style:{marginBottom:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,Z.jsx)(Q.Z,{title:e.formatMessage({id:"refresh",defaultMessage:"Âà∑Êñ∞Êï∞ÊçÆ"}),children:(0,Z.jsx)(w.ZP,{type:"primary",icon:(0,Z.jsx)(ee.Z,{}),loading:l,onClick:y,size:"small",children:e.formatMessage({id:"refresh",defaultMessage:"Âà∑Êñ∞"})})})}),(0,Z.jsxs)(H.Z,{spinning:l,children:[(0,Z.jsxs)(G.Z,{gutter:[16,16],children:[(0,Z.jsx)(K.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,Z.jsx)($.Z,{style:c()(c()({},C),{},{backgroundColor:j.totalCount.bg}),hoverable:!0,children:(0,Z.jsx)(Y.Z,{title:e.formatMessage({id:"queue.totalCount",defaultMessage:"ÊÄª‰ºöËØù"}),value:h.totalCount,prefix:(0,Z.jsx)(te.Z,{}),valueStyle:{color:j.totalCount.valueColor}})})}),(0,Z.jsx)(K.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,Z.jsx)($.Z,{style:c()(c()({},C),{},{backgroundColor:j.queuingCount.bg}),hoverable:!0,children:(0,Z.jsx)(Y.Z,{title:e.formatMessage({id:"queue.queuingCount",defaultMessage:"ÊéíÈòü‰∏≠"}),value:h.queuingCount,prefix:(0,Z.jsx)(ne.Z,{}),valueStyle:{color:j.queuingCount.valueColor}})})}),(0,Z.jsx)(K.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,Z.jsx)($.Z,{style:c()(c()({},C),{},{backgroundColor:j.chattingCount.bg}),hoverable:!0,children:(0,Z.jsx)(Y.Z,{title:e.formatMessage({id:"queue.chattingCount",defaultMessage:"‰ºöËØù‰∏≠"}),value:h.chattingCount,prefix:(0,Z.jsx)(re.Z,{}),valueStyle:{color:j.chattingCount.valueColor}})})}),(0,Z.jsx)(K.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,Z.jsx)($.Z,{style:c()(c()({},C),{},{backgroundColor:j.offlineCount.bg}),hoverable:!0,children:(0,Z.jsx)(Y.Z,{title:e.formatMessage({id:"queue.offlineCount",defaultMessage:"Á¶ªÁ∫øÁïôË®Ä"}),value:h.offlineCount,prefix:(0,Z.jsx)(ae.Z,{}),valueStyle:{color:j.offlineCount.valueColor}})})}),(0,Z.jsx)(K.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,Z.jsx)($.Z,{style:c()(c()({},C),{},{backgroundColor:j.closedCount.bg}),hoverable:!0,children:(0,Z.jsx)(Y.Z,{title:e.formatMessage({id:"queue.closedCount",defaultMessage:"Â∑≤ÂÖ≥Èó≠"}),value:h.closedCount,prefix:(0,Z.jsx)(oe.Z,{}),valueStyle:{color:j.closedCount.valueColor}})})}),(0,Z.jsx)(K.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,Z.jsx)($.Z,{style:c()(c()({},C),{},{backgroundColor:j.leaveMsgCount.bg}),hoverable:!0,children:(0,Z.jsx)(Y.Z,{title:e.formatMessage({id:"queue.leaveMsgCount",defaultMessage:"ÁïôË®ÄÊï∞"}),value:h.leaveMsgCount,prefix:(0,Z.jsx)(se.Z,{}),valueStyle:{color:j.leaveMsgCount.valueColor}})})})]}),(0,Z.jsx)(V.Z,{style:{margin:"16px 0",fontSize:"14px"},children:e.formatMessage({id:"queue.additionalStats",defaultMessage:"Êõ¥Â§öÁªüËÆ°"})}),(0,Z.jsx)(G.Z,{gutter:[16,16],children:(0,Z.jsx)(K.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,Z.jsx)($.Z,{style:c()(c()({},C),{},{backgroundColor:j.robotToAgentCount.bg}),hoverable:!0,children:(0,Z.jsx)(Y.Z,{title:e.formatMessage({id:"queue.robotToAgentCount",defaultMessage:"ËΩ¨‰∫∫Â∑•Êï∞"}),value:h.robotToAgentCount,prefix:(0,Z.jsx)(ie.Z,{}),valueStyle:{color:j.robotToAgentCount.valueColor}})})})})]})]})},ce=n(18580),de=function(){var e=(0,s.useIntl)(),t=(0,a.useMemo)((function(){return[{key:"basic",label:e.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,Z.jsx)(S,{})},{key:"serviceSettings",label:e.formatMessage({id:"pages.agent.service.settings",defaultMessage:"Service Settings"}),children:(0,Z.jsx)(X.Z,{type:R.Njn})},{key:"advanced",label:e.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,Z.jsx)(W,{})},{key:"monitor",label:e.formatMessage({id:"queue.dashboard.title",defaultMessage:"Monitor"}),children:(0,Z.jsx)(le,{}),disabled:!(0,ce.OJ)()},{key:"channel",label:e.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,Z.jsx)(J.Z,{type:R.Njn})}]}),[e]);return(0,Z.jsx)(o.Z,{defaultActiveKey:"basic",items:t})},fe=n(86222),ge=n.n(fe),me=n(76711),pe=n.n(me),ve=n(24522),he=n(15722),xe=n(82669),be=n(90727),ye=n(68349),Ce=n(90317),je=n(27259),Me=n(96501),ke=n(67828),we=n(73660),Ze=n(39291),Se=n(38197),Re=function(e){var t=e.open,n=e.onClose,r=e.onSubmit,o=Ze.ZP.useForm(),s=m()(o,1)[0],i=(0,z.u)((function(e){return e.currentOrg})),l=(0,ke.Z)((function(e){return e.memberResult})),d=(0,ke.Z)((function(e){return e.setMemberResult})),g=(0,x.E)((function(e){return e.agentResult})),p=(0,a.useState)(0),v=m()(p,2),h=v[0],b=v[1],y=(0,a.useState)(""),C=m()(y,2),M=C[0],k=C[1],S=(0,a.useState)(!1),R=m()(S,2),T=R[0],A=R[1],q=(0,a.useState)([]),F=m()(q,2),P=F[0],U=F[1],E=(0,a.useRef)(null),I=(0,a.useState)(0),L=m()(I,2),N=L[0],O=L[1],V=(0,a.useState)(!0),D=m()(V,2),B=D[0],W=D[1],J=(0,a.useState)(!1),X=m()(J,2),_=X[0],Q=X[1],H=(0,a.useState)(0),G=m()(H,2),K=G[0],$=G[1],Y=(0,a.useState)(!0),ee=m()(Y,2),te=ee[0],ne=ee[1],re=(0,a.useState)(!1),ae=m()(re,2),oe=ae[0],se=ae[1];(0,a.useEffect)((function(){t&&(console.log("Modal opened, current agent data:",g),console.log("Current member data:",l))}),[t,g,l]),(0,a.useEffect)((function(){return function(){E.current&&clearTimeout(E.current)}}),[]);var ie=(0,a.useMemo)((function(){var e=g.data.content.map((function(e){var t;return(null===(t=e.member)||void 0===t?void 0:t.uid)||e.memberUid})).filter((function(e){return e}));return console.log("Existing agent member UIDs:",e),console.log("Agent result data:",g.data.content),e}),[g]),ue=(0,a.useMemo)((function(){var e,t,n=[],r=M.trim()?P:l.data.content;console.log("Total members:",r.length),console.log("Existing agent member UIDs:",ie),console.log("Using search results:",!!M.trim());for(var a=0;a<r.length;a++){var o=r[a];if(ie.includes(o.uid))console.log("Filtering out member:",o.nickname,o.uid);else{var s={title:"",value:"",children:[]};(t=s).title=(e=o).nickname,t.value=e.uid,n.push(s)}}return console.log("Filtered tree data:",n),n}),[l,P,M,ie]),le=function(){var e=f()(u()().mark((function e(t){var n,r,a,o,s=arguments;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],console.log("handleSearch:",t,"isLoadMore:",n),t.trim()||n){e.next=7;break}return U([]),O(0),W(!0),e.abrupt("return");case 7:return n?Q(!0):A(!0),e.prev=8,r={pageNumber:n?N+1:0,pageSize:20,orgUid:null==i?void 0:i.uid,searchText:t.trim()},e.next=12,(0,we.z_)(r);case 12:a=e.sent,console.log("handleSearch Search members response:",a,r),200===a.code?(o=a.data.content||[],n?(U((function(e){return[].concat(pe()(e),pe()(o))})),O(N+1)):(U(o),O(0)),W(!a.data.last)):(console.error("handleSearch Search failed:",a.message),n||U([])),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(8),console.error("Search error:",e.t0),n||U([]);case 21:return e.prev=21,n?Q(!1):A(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[8,17,21,24]])})));return function(t){return e.apply(this,arguments)}}(),ce=function(e){var t=e.target.value;k(t),E.current&&clearTimeout(E.current),t.trim()?E.current=setTimeout((function(){le(t)}),300):(U([]),O(0),W(!0))},de=function(){le(M)},fe=function(){!_&&B&&M.trim()&&le(M,!0)},ge=function(){var e=f()(u()().mark((function e(){var t,n,r,a;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe||!te){e.next=17;break}return se(!0),e.prev=2,t={pageNumber:K+1,pageSize:20,orgUid:null==i?void 0:i.uid},e.next=6,(0,we.z_)(t);case 6:n=e.sent,console.log("Load more all members response:",n),200===n.code&&(r=n.data.content||[],a=[].concat(pe()(l.data.content),pe()(r)),d(c()(c()({},l),{},{data:c()(c()({},l.data),{},{content:a})})),$(K+1),ne(!n.data.last)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("Load more all members error:",e.t0);case 14:return e.prev=14,se(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsx)("div",{children:(0,Z.jsx)(ye.Z,{title:"ÂàõÂª∫ÂÆ¢Êúç",open:t,forceRender:!0,onOk:function(){console.log("handleOk"),s.validateFields().then((function(e){console.log("form values:",e);var t=s.getFieldValue("memberUids"),n=s.getFieldValue("nickname"),a=s.getFieldValue("email"),o=s.getFieldValue("mobile"),u=M.trim()?P:l.data.content,c=[];if(1===t.length){var d={nickname:n,email:a,mobile:o,memberUid:t[0],orgUid:null==i?void 0:i.uid};c.push(d)}else t.forEach((function(e){var t=u.find((function(t){return t.uid===e}));if(t){var n={nickname:t.nickname,email:t.email,mobile:t.mobile,memberUid:e,orgUid:null==i?void 0:i.uid};c.push(n)}}));console.log("agents:",c),r(c)})).catch((function(e){console.log("Form errors:",e)}))},onCancel:function(){console.log("handleCancel"),n()},children:(0,Z.jsxs)(Ze.ZP,{form:s,name:"agentForm",style:{maxWidth:400},submitter:!1,children:[(0,Z.jsx)(Se.Z,{label:"ÁªëÂÆöÊàêÂëò",name:"memberUids",tooltip:"ËØ∑ÂÖàÂà∞ÁªÑÁªá-„ÄãÊàêÂëò-„ÄãÂàõÂª∫ÊàêÂëòÔºåÂ∑≤ÂàõÂª∫ËøáÂÆ¢ÊúçÁöÑÊàêÂëòÂ∞ÜË¢´ËøáÊª§",rules:[{required:!0,message:"ËØ∑ÈÄâÊã©ÊàêÂëò!"}],fieldProps:{multiple:!0,treeDefaultExpandAll:!0,placeholder:"ËØ∑ÈÄâÊã©ÊàêÂëòÔºàÂèØÂ§öÈÄâÔºâ",onChange:function(e){console.log("onTreeSelectChange:",e),b(e.length);var t=M.trim()?P:l.data.content;if(0===e.length)s.setFieldsValue({nickname:"",email:"",mobile:""});else if(1===e.length){var n=t.find((function(t){return t.uid===e[0]}));n&&s.setFieldsValue({nickname:n.nickname||"",email:n.email||"",mobile:n.mobile||""})}else{var r=t.filter((function(t){return e.includes(t.uid)})),a=r.map((function(e){return e.nickname})).filter(Boolean).join(", "),o=r.map((function(e){return e.email})).filter(Boolean).join(", "),i=r.map((function(e){return e.mobile})).filter(Boolean).join(", ");s.setFieldsValue({nickname:a,email:o,mobile:i})}},treeData:ue,variant:"outlined",dropdownRender:function(e){return(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{style:{padding:"8px",borderBottom:"1px solid #f0f0f0"},children:(0,Z.jsx)(je.Z,{placeholder:"ÊêúÁ¥¢ÊàêÂëò",value:M,onChange:ce,onPressEnter:function(){return de()},suffix:(0,Z.jsx)(be.Z,{onClick:de,style:{cursor:"pointer",color:T?"#1890ff":void 0},spin:T}),allowClear:!0,size:"small"})}),e,(M.trim()?B:te)&&(0,Z.jsx)("div",{style:{padding:"8px",textAlign:"center",borderTop:"1px solid #f0f0f0"},children:(0,Z.jsx)(w.ZP,{type:"link",size:"small",loading:M.trim()?_:oe,onClick:M.trim()?fe:ge,disabled:M.trim()?_:oe,children:(M.trim()?_:oe)?"Âä†ËΩΩ‰∏≠...":"Âä†ËΩΩÊõ¥Â§ö"})})]})}}}),(0,Z.jsx)(j.Z,{label:"ÊòµÁß∞",name:"nickname",disabled:h>1,tooltip:h>1?"Â§öÈÄâÊ®°Âºè‰∏ãÊòµÁß∞Â∞ÜËá™Âä®‰ªéÈÄâ‰∏≠ÁöÑÊàêÂëò‰ø°ÊÅØ‰∏≠Ëé∑Âèñ":"ÊòµÁß∞Â∞ÜËá™Âä®‰ªéÈÄâ‰∏≠ÁöÑÊàêÂëò‰ø°ÊÅØ‰∏≠Ëé∑Âèñ"}),(0,Z.jsx)(j.Z,{label:"ÈÇÆÁÆ±",name:"email",disabled:h>1,tooltip:h>1?"Â§öÈÄâÊ®°Âºè‰∏ãÈÇÆÁÆ±Â∞ÜËá™Âä®‰ªéÈÄâ‰∏≠ÁöÑÊàêÂëò‰ø°ÊÅØ‰∏≠Ëé∑Âèñ":"ÈÇÆÁÆ±Â∞ÜËá™Âä®‰ªéÈÄâ‰∏≠ÁöÑÊàêÂëò‰ø°ÊÅØ‰∏≠Ëé∑Âèñ"}),(0,Z.jsx)(j.Z,{label:"ÊâãÊú∫Âè∑",name:"mobile",disabled:h>1,tooltip:h>1?"Â§öÈÄâÊ®°Âºè‰∏ãÊâãÊú∫Âè∑Â∞ÜËá™Âä®‰ªéÈÄâ‰∏≠ÁöÑÊàêÂëò‰ø°ÊÅØ‰∏≠Ëé∑Âèñ":"ÊâãÊú∫Âè∑Â∞ÜËá™Âä®‰ªéÈÄâ‰∏≠ÁöÑÊàêÂëò‰ø°ÊÅØ‰∏≠Ëé∑Âèñ"})]})})})},Te=function(){var e=(0,s.useIntl)(),t=(0,a.useRef)(!1),n=(0,h.Z)(),r=n.translateString,o=n.translateStringTranct,i=(0,ve.Z)().isDarkMode,l=(0,a.useState)(!1),d=m()(l,2),g=d[0],b=d[1],y=(0,a.useState)(""),C=m()(y,2),j=C[0],M=C[1],S=(0,a.useState)(!1),T=m()(S,2),A=T[0],q=T[1],F=(0,a.useState)(!0),P=m()(F,2),U=P[0],E=P[1],I=(0,a.useState)(0),L=m()(I,2),N=L[0],O=L[1],V=(0,z.u)((function(e){return e.currentOrg})),D=(0,ke.Z)((function(e){return e.setMemberResult})),B=(0,x.E)((function(e){return{agentResult:e.agentResult,currentAgent:e.currentAgent,insertAgent:e.insertAgent,setAgentResult:e.setAgentResult,setCurrentAgent:e.setCurrentAgent,deleteCurrentAgent:e.deleteCurrentAgent}})),W=B.agentResult,J=B.currentAgent,X=B.insertAgent,_=B.setAgentResult,Q=B.setCurrentAgent,H=B.deleteCurrentAgent,G=ye.Z.useModal(),K=m()(G,2),$=K[0],Y=K[1],ee=function(){var t=f()(u()().mark((function t(n){var r;return u()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("delete agent",n),p.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),t.next=4,(0,v.Lr)(n);case 4:r=t.sent,console.log("delete agent response",r),200===r.code?(p.yw.destroy(),p.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),H(n.uid)):(p.yw.destroy(),p.yw.error(r.message));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),te=(0,a.useCallback)(f()(u()().mark((function e(){var n,r,a,s,i,l,d,f,g,m,h,x,b=arguments;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=b.length>0&&void 0!==b[0]?b[0]:0,r=b.length>1&&void 0!==b[1]&&b[1],!A&&!t.current){e.next=4;break}return e.abrupt("return");case 4:return t.current=!0,q(!0),a={pageNumber:n,pageSize:20,sortDirection:"ascend",orgUid:null==V?void 0:V.uid,searchText:j},e.prev=7,e.next=10,(0,v._t)(a);case 10:s=e.sent,console.log("queryAgentsByOrg: ",s,a),200===s.code?(f=(null==s||null===(i=s.data)||void 0===i?void 0:i.content)||[],g=null!==(l=null==s||null===(d=s.data)||void 0===d?void 0:d.last)&&void 0!==l?l:0===f.length,E(!g),O(n),r?(h=(null==W||null===(m=W.data)||void 0===m?void 0:m.content)||[],x=c()(c()({},s),{},{data:c()(c()({},s.data),{},{content:[].concat(pe()(h),pe()(f))})}),_(x)):(_(s),f.length>0&&(J?-1===f.findIndex((function(e){return e.uid===(null==J?void 0:J.uid)}))&&Q(f[0]):Q(f[0])))):p.yw.error(o(s.message));case 13:return e.prev=13,t.current=!1,q(!1),e.finish(13);case 17:case"end":return e.stop()}}),e,null,[[7,,13,17]])}))),[A,j,null==V?void 0:V.uid,W,J,o,_,Q]),ne=function(){var e=f()(u()().mark((function e(){var t,n;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pageNumber:0,pageSize:50,orgUid:null==V?void 0:V.uid},e.next=3,(0,we.z_)(t);case 3:n=e.sent,console.log("queryAllMembers:",t,n),200===n.code?D(n):p.yw.error(o(n.message));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){O(0),E(!0),te(0,!1),""===j&&ne()}),[j,null==V?void 0:V.uid]);var re=function(){var t=f()(u()().mark((function t(n){var r,a,o,s,i,l;return u()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("save agents",n),p.yw.loading(e.formatMessage({id:"creating",defaultMessage:"Creating"})),r=0,a=0,o=ge()(n),t.prev=5,o.s();case 7:if((s=o.n()).done){t.next=23;break}return i=s.value,t.prev=9,t.next=12,(0,v.x_)(i);case 12:l=t.sent,console.log("create agent:",l),200===l.code?(X(l.data),r++):(a++,console.error("Failed to create agent:",l.message)),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(9),a++,console.error("Error creating agent:",t.t0);case 21:t.next=7;break;case 23:t.next=28;break;case 25:t.prev=25,t.t1=t.catch(5),o.e(t.t1);case 28:return t.prev=28,o.f(),t.finish(28);case 31:p.yw.destroy(),r>0&&p.yw.success("".concat(e.formatMessage({id:"create.success"})," ").concat(r," ‰∏™ÂÆ¢Êúç")),a>0&&p.yw.error("ÂàõÂª∫Â§±Ë¥• ".concat(a," ‰∏™ÂÆ¢Êúç")),r>0&&b(!1);case 35:case"end":return t.stop()}}),t,null,[[5,25,28,31],[9,17]])})));return function(e){return t.apply(this,arguments)}}();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(Ce.Z,{style:{margin:10},gap:"small",align:"flex-start",children:[(0,Z.jsx)(w.ZP,{size:"small",type:"primary",icon:(0,Z.jsx)(xe.Z,{}),onClick:function(){b(!0)},children:e.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,Z.jsx)(w.ZP,{size:"small",onClick:function(){O(0),E(!0),te(0,!1)},children:e.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,Z.jsx)(w.ZP,{onClick:function(){return function(t){$.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,Z.jsx)(he.Z,{}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"„Äê").concat(r(t.nickname),"„ÄëÔºü"),onOk:function(){ee(t)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})}(J)},size:"small",danger:!0,disabled:""===(null==J?void 0:J.uid),children:e.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,Z.jsx)("div",{style:{margin:10,marginTop:16},children:(0,Z.jsx)(je.Z.Search,{placeholder:e.formatMessage({id:"agent.search.placeholder",defaultMessage:"ÊêúÁ¥¢ÂÆ¢ÊúçÂêçÁß∞"}),value:j,onChange:function(e){return M(e.target.value)},onSearch:function(e){console.log("ÊêúÁ¥¢ÂÜÖÂÆπ:",e)},enterButton:(0,Z.jsx)(be.Z,{}),allowClear:!0,style:{width:"100%"}})}),(0,Z.jsx)("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 200px)"},onScroll:function(e){var t=e.currentTarget,n=t.scrollTop;t.scrollHeight-n-t.clientHeight<50&&U&&!A&&!A&&U&&te(N+1,!0)},children:(0,Z.jsx)(Me.Z,{itemLayout:"horizontal",dataSource:W.data.content,renderItem:function(t,n){return(0,Z.jsx)(Me.Z.Item,{style:J.uid===t.uid?{backgroundColor:i?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){Q(t)},children:(0,Z.jsx)(Me.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,Z.jsx)(k.Z,{src:t.avatar}),title:(0,Z.jsx)(Z.Fragment,{children:o(t.nickname)}),description:(r=t,(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)("span",{style:{color:"#999999",fontSize:12},children:[r.status===R.Ra4&&"[üòÄ-".concat(e.formatMessage({id:"agent.status.online"}),"]"),r.status===R.LZ1&&"[üîª-".concat(e.formatMessage({id:"agent.status.offline"}),"]"),r.status===R.tU$&&"[üèÉ‚Äç‚ôÄÔ∏è-".concat(e.formatMessage({id:"agent.status.busy"}),"]"),r.connected?" ‚úÖ".concat(e.formatMessage({id:"agent.connection.success"})):" ‚ùå".concat(e.formatMessage({id:"agent.connection.failed"}))]})}))})},t.uid);var r}})}),g&&(0,Z.jsx)(Re,{open:g,onClose:function(){b(!1)},onSubmit:re}),Y]})},Ae=n(74424),qe=function(){var e=(0,Ae.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,a.useEffect)((function(){}),[]),(0,Z.jsxs)(r.Z,{style:{height:"100%"},children:[(0,Z.jsx)(r.Z.Panel,{defaultSize:"20%",min:"10%",max:"40%",style:t,children:(0,Z.jsx)(Te,{})}),(0,Z.jsx)(r.Z.Panel,{style:n,children:(0,Z.jsx)(de,{})})]})}},67828:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(5488),a=n(16894),o=n(45034),s=n(47401),i=(0,a.Ue)()((0,o.mW)((0,o.tJ)((0,s.n)((function(e,t){return{memberResult:{data:{content:[],totalElements:0}},insertMember:function(t){e((function(e){e.memberResult.data.content.unshift(t)}))},updateMember:function(t){e((function(e){var n=e.memberResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n[r]=t:console.warn("Member with uid ".concat(t.uid," not found."))}))},deleteMember:function(t){e((function(e){var n=e.memberResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n.splice(r,1):console.warn("Member with uid ".concat(t.uid," not found."))}))},setMemberResult:function(t){e({memberResult:t})},deleteMemberCache:function(){return e({},!0)}}})),{name:r.PQL})))}}]);