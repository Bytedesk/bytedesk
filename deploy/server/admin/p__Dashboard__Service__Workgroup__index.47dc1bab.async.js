"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9828],{38778:function(e,t,n){n.r(t),n.d(t,{default:function(){return Se}});var r=n(44194),i=n(31167),o=n(19736),s=n(76711),a=n.n(s),u=n(89957),l=n.n(u),d=n(90819),c=n.n(d),g=n(89933),f=n.n(g),v=n(73193),p=n.n(v),m=n(45332),h=n.n(m),x=n(85255),b=n(3925),S=n(9428),k=n(48769),w=n(71876),M=n(12792),j=n(66810),y=n(65513),R=n(77359),C=n(29337),Z=n(68779),T=n(12322),F=n(58087),W=n(31806),P=n(56482),L=n(12781),q=n(10162),U=n(90727),A=n(59304),I=n(54881),E=n(47944),z=n(80556),N=n(55785),D=n(79866),Q=n(93527),O=n(64484),H=n(14888),K=n(88449),J=n(26710),B=n(6844),V=n(61952),G=n(2061),X=(n(47460),n(15012),n(42670),n(23312)),Y=n(1725),$=n(20585),_=n(83281),ee=n(21914),te=n(10154),ne=n.n(te),re=n(35912),ie=n(44679),oe=n(30064),se=n(22576),ae=n(31928),ue=n(68263),le=n(36125),de=n(31549),ce=function(e){var t=e.variant,n=e.robotRoutingSettings,i=e.onRobotRoutingSettingsChange,o=oe.A.useForm(),s=h()(o,1)[0],a=(0,r.useRef)(!1),u=(0,r.useState)([]),l=h()(u,2),d=l[0],g=l[1],v=(0,H.u)((function(e){return e.currentOrg})),p=(0,ie.Z)().translateString,m=(0,r.useMemo)((function(){var e;return null!==(e=null==n?void 0:n.draft)&&void 0!==e?e:null==n?void 0:n.live}),[n]);(0,r.useEffect)((function(){var e,n;if("workgroup"===t){var r=null!==(e=null==m?void 0:m.robotUid)&&void 0!==e?e:null==m||null===(n=m.robot)||void 0===n?void 0:n.uid;s.setFieldsValue({defaultRobot:null==m?void 0:m.defaultRobot,offlineRobot:null==m?void 0:m.offlineRobot,nonWorktimeRobot:null==m?void 0:m.nonWorktimeRobot,robotUid:r})}}),[t,m,s]);var x=function(){var e=f()(c()().mark((function e(){var t,n,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=3;break}return le.Z.debug("isLoading: 1",a.current),e.abrupt("return");case 3:return a.current=!0,Q.yw.loading("loading"),t={pageNumber:0,pageSize:50,type:B.f4h,orgUid:null==v?void 0:v.uid},e.next=8,(0,re.p0)(t);case 8:n=e.sent,le.Z.debug("queryRobotsByOrg: ",n),200===n.code?g(null==n||null===(r=n.data)||void 0===r?void 0:r.content):Q.yw.error(n.message),a.current=!1,Q.yw.destroy();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){x()}),[]);var b=function(){var e;null===(e=s.validateFields)||void 0===e||e.call(s,["robotUid"]).catch((function(){return null}))},S=function(e){return function(t){var n,r=!(null==t||null===(n=t.target)||void 0===n||!n.checked);null==i||i(ne()({},e,r)),b()}};return(0,de.jsx)(oe.A,{form:s,style:{marginLeft:"20px"},submitter:!1,children:"workgroup"===t&&(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(se.Z,{name:"defaultRobot",width:"md",label:"默认启用机器人",fieldProps:{onChange:S("defaultRobot")}}),(0,de.jsx)(se.Z,{name:"offlineRobot",width:"md",label:"无客服在线时启用机器人",fieldProps:{onChange:S("offlineRobot")}}),(0,de.jsx)(se.Z,{name:"nonWorktimeRobot",width:"md",label:"非工作时间启用机器人",fieldProps:{onChange:S("nonWorktimeRobot")}}),(0,de.jsx)(ae.Z,{name:["defaultRobot","offlineRobot","nonWorktimeRobot"],children:function(e){var t=e.defaultRobot,n=e.offlineRobot,r=e.nonWorktimeRobot,o=!!(t||n||r);return(0,de.jsx)(ue.Z,{name:"robotUid",label:"客服机器人",width:"md",options:d.map((function(e){return{value:e.uid,label:p(e.nickname)}})),rules:[{validator:function(e,t){return o&&!t?Promise.reject(new Error("请选择客服机器人")):Promise.resolve()}}],fieldProps:{allowClear:!0,placeholder:"请选择客服机器人",onChange:function(e){null==i||i({robotUid:null!=e?e:void 0}),b()}}})}})]})})},ge=(n(81005),n(35165)),fe=n(30813),ve=n(58867),pe=function(){var e=ve.Z.useForm(),t=h()(e,1)[0],n=(0,o.useIntl)(),i=(0,V.z)((function(e){return{currentWorkgroupSettings:e.currentWorkgroupSettings,setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings}})),s=i.currentWorkgroupSettings,a=i.setCurrentWorkgroupSettings,u=(0,r.useState)(B.vXk),l=h()(u,2),d=l[0],c=l[1];(0,r.useEffect)((function(){if(s){var e=s;c(e.routingMode),t.setFieldValue("routingMode",e.routingMode)}}),[s]);return(0,de.jsx)("div",{children:(0,de.jsxs)(oe.A,{form:t,submitter:!1,children:[(0,de.jsx)(fe.Z.Group,{name:"routingMode",label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.type",defaultMessage:"Route Type"}),options:[{label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.roundRobin",defaultMessage:"Round Robin"}),value:B.vXk},{label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.leastActive",defaultMessage:"Least Active"}),value:B.ZD$},{label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.random",defaultMessage:"Random"}),value:B.owQ},{label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.weightedRandom",defaultMessage:"Weighted Random"}),value:B.e2F},{label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.consistentHash",defaultMessage:"Consistent Hash"}),value:B.zWk},{label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.fastestResponse",defaultMessage:"Fastest Response"}),value:B.HQF},{label:(0,de.jsx)(o.FormattedMessage,{id:"workgroup.route.recent",defaultMessage:"Recent"}),value:B.WDq}],fieldProps:{value:d,onChange:function(e){var t;!function(e){console.log("radio checked",e.target.value),c(e.target.value)}(e),t=e.target.value,s&&a(p()(p()({},s),{},{routingMode:t}))}}}),(0,de.jsxs)(oe.A.Item,{children:[d===B.vXk&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.roundRobin.desc"})}),d===B.ZD$&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.leastActive.desc"})}),d===B.owQ&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.random.desc"})}),d===B.e2F&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.weightedRandom.desc"})}),d===B.zWk&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.consistentHash.desc"})}),d===B.HQF&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.fastestResponse.desc"})}),d===B.JEC&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.broadcast.desc"})}),d===B.WDq&&(0,de.jsx)("p",{children:n.formatMessage({id:"workgroup.route.recent.desc"})})]})]})})},me=n(58791),he=(n(74341),"tips"),xe=function(){var e=(0,o.useIntl)(),t=(0,H.u)((function(e){return e.currentOrg})),n=(0,K.Z)().leftSiderStyle,s=(0,J.Z)().isDarkMode,u=(0,r.useState)(!1),d=h()(u,2),g=d[0],v=d[1],m=(0,r.useState)([]),B=h()(m,2),te=B[0],ne=B[1],re=(0,r.useState)(),ie=h()(re,2),oe=ie[0],se=ie[1],ae=(0,r.useState)(""),ue=h()(ae,2),le=ue[0],fe=ue[1],ve=(0,r.useState)(he),xe=h()(ve,2),be=xe[0],Se=xe[1],ke=(0,r.useState)(!1),we=h()(ke,2),Me=we[0],je=we[1],ye=(0,r.useState)(null),Re=h()(ye,2),Ce=Re[0],Ze=Re[1],Te=(0,r.useMemo)((function(){return te.find((function(e){return e.uid===oe}))||null}),[te,oe]),Fe=(0,r.useState)(!1),We=h()(Fe,2),Pe=We[0],Le=We[1],qe=(0,r.useState)(!1),Ue=h()(qe,2),Ae=Ue[0],Ie=Ue[1],Ee=(0,r.useState)(!1),ze=h()(Ee,2),Ne=ze[0],De=ze[1],Qe=(0,r.useRef)(""),Oe=(0,V.z)((function(e){return{setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings,currentWorkgroupSettings:e.currentWorkgroupSettings}})),He=Oe.setCurrentWorkgroupSettings,Ke=Oe.currentWorkgroupSettings,Je=(0,r.useMemo)((function(){var e;return null!==(e=null!=Ke?Ke:Te)&&void 0!==e?e:null}),[Ke,Te]),Be=(0,r.useCallback)((function(e){if(Ke){var t=Ke.draftServiceSettings||Ke.serviceSettings||{};He(p()(p()({},Ke),{},{draftServiceSettings:p()(p()({},t),e)}))}}),[Ke,He]),Ve=(0,r.useCallback)((function(e){if(Ke){var t=Ke.draftInviteSettings||Ke.inviteSettings||{};He(p()(p()({},Ke),{},{draftInviteSettings:p()(p()({},t),e)}))}}),[Ke,He]),Ge=(0,r.useCallback)((function(e){if(Ke){var t=Ke.draftMessageLeaveSettings||Ke.messageLeaveSettings||{};He(p()(p()({},Ke),{},{draftMessageLeaveSettings:p()(p()({},t),e)}))}}),[Ke,He]),Xe=(0,r.useCallback)((function(e){if(Ke){var t=Ke.draftWorktimeSettings||Ke.worktimeSettings||{};He(p()(p()({},Ke),{},{draftWorktimeSettings:p()(p()({},t),e)}))}}),[Ke,He]),Ye=(0,r.useCallback)((function(e){if(Ke){var t=Ke.draftRobotRoutingSettings||Ke.robotRoutingSettings||{};He(p()(p()({},Ke),{},{draftRobotRoutingSettings:p()(p()({},t),e)}))}}),[Ke,He]),$e=(0,r.useCallback)((function(e){if(Ke){var t=Ke.draftQueueSettings||Ke.queueSettings||{};He(p()(p()({},Ke),{},{draftQueueSettings:p()(p()({},t),e)}))}}),[Ke,He]),_e=(0,r.useCallback)((function(e){if(Ke){var t=Ke.draftRobotToAgentSettings||Ke.robotToAgentSettings||{};He(p()(p()({},Ke),{},{draftRobotToAgentSettings:p()(p()({},t),e)}))}}),[Ke,He]),et=(0,r.useMemo)((function(){if(!le)return te;var e=le.toLowerCase();return te.filter((function(t){var n=(t.name||t.uid||"").toLowerCase(),r=(t.description||"").toLowerCase();return n.includes(e)||r.includes(e)}))}),[te,le]),tt=(0,r.useCallback)(function(){var e=f()(c()().mark((function e(n,r){var i,o,s,a,u;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.uid){e.next=2;break}return e.abrupt("return");case 2:return v(!0),e.prev=3,o=(null!=n?n:"").trim(),s={orgUid:t.uid,pageNumber:0,pageSize:100,searchText:o||void 0},e.next=8,(0,O.zc)(s);case 8:a=e.sent,console.log("加载工作组配置模板列表: ",a,s),u=(null==a||null===(i=a.data)||void 0===i?void 0:i.content)||[],ne(u),!(u.length>0)||oe&&u.some((function(e){return e.uid===oe}))||(se(u[0].uid),null!=r&&r.keepActive||Se(he));case 13:return e.prev=13,v(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,,13,16]])})));return function(t,n){return e.apply(this,arguments)}}(),[null==t?void 0:t.uid,oe]),nt=(0,r.useCallback)((function(e){tt(null!=e?e:le)}),[tt,le]);(0,r.useEffect)((function(){tt(le)}),[null==t?void 0:t.uid]),(0,r.useEffect)((function(){Te?(He(Te),Qe.current=JSON.stringify(null!=Te?Te:{}),De(!1)):(He(null),Qe.current=JSON.stringify({}),De(!1))}),[null==Te?void 0:Te.uid]),(0,r.useEffect)((function(){if(Te)try{var e=JSON.stringify(null!=Ke?Ke:{});De(e!==Qe.current)}catch(e){De(!0)}}),[Ke,null==Te?void 0:Te.uid]);var rt=function(){var n=f()(c()().mark((function n(r){var i,o,s;return c()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=(i=null!=r?r:Te)&&i.uid){n.next=3;break}return n.abrupt("return");case 3:return o={uid:i.uid,orgUid:null==t?void 0:t.uid,pageNumber:0,pageSize:100},n.next=6,(0,O.zN)(o);case 6:(s=n.sent)&&200===s.code?(Q.yw.success(e.formatMessage({id:"common.deleted",defaultMessage:"删除成功"})),tt(le)):Q.yw.error((null==s?void 0:s.message)||"删除失败");case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),it=function(){var n=f()(c()().mark((function n(r,i){var o;return c()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,O.Y2)({uid:r,orgUid:null==t?void 0:t.uid,enabled:i});case 3:(o=n.sent)&&200===o.code?(Q.yw.success(e.formatMessage({id:i?"common.enabled":"common.disabled",defaultMessage:i?"已启用":"已停用"})),tt(le)):Q.yw.error((null==o?void 0:o.message)||"操作失败"),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("切换启用状态失败:",n.t0),Q.yw.error("操作失败");case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e,t){return n.apply(this,arguments)}}(),ot=function(e,t){if(e){var n={};return t.forEach((function(t){void 0!==e[t]&&(n[t]=e[t])})),n}},st=function(e){return!e||"object"!==l()(e)||0===Object.keys(e).length},at=function(e){if(e){var t=ot(e,["language","autoPopup","showTopTip","topTip","topTipStart","topTipEnd","showRateBtn","autoInviteRate","inviteRateTip","rateMsgCount","showPreForm","preFormRequired","preForm","showPreSearch","showHistory","showInputAssociation","showCaptcha","welcomeTip","welcomeFaqUids","welcomeKbUid","enableWorkflow","workflowUid","autoCloseMin","autoCloseTip","agentCloseTip","queueTip","leavemsgTip","showRightIframe","rightIframeUrl","showFaqs","faqUids","faqKbUid","showQuickFaqs","quickFaqUids","quickFaqKbUid","showGuessFaqs","guessFaqUids","showHotFaqs","hotFaqUids","showShortcutFaqs","shortcutFaqUids","relatedQuestionGuide","enableProactiveTrigger","noResponseTimeout","proactiveMessage","maxProactiveCount","proactiveInterval","triggerConditions","proactiveFaqUids","showLogo","validateUntil"]),n=function(e){if(e)return ot(e,["smile","image","file","rate","leavemsg","orderSelector","ticket","audio","video","tel","order"])}(e.toolbar);return p()(p()({},t),n?{toolbar:n}:{})}},ut=function(e){if(e)return ot(e,["name","description","defaultTemplate","show","text","icon","delay","loop","loopDelay","loopCount","messageList","targetedInvite","targetedInviteUrls","smartTrigger","pageStayTriggerSeconds","scrollTrigger","scrollTriggerPerceninviteSettinge","exitIntentTrigger","referrerTrigger","referrerPatterns","deviceTypes","visitorSegmentation","newVisitorMessage","returningVisitorMessage","vipVisitorMessage","inviteStyle","inviteAnimation","abTesting"])},lt=function(e){if(e)return ot(e,["name","description","color","order"])},dt=function(e){if(e)return ot(e,["messageLeaveEnabled","messageLeaveTip","messageLeaveAgentUid","messageLeaveNotify","messageLeaveNotifyType","messageLeaveNotifyEmail","messageLeaveNotifyMobile","messageLeaveForm"])},ct=function(e){if(e)return ot(e,["queueRobot","showQueuePosition","showEstimatedWaitTime","avgWaitTimePerPerson","maxWaiting","maxWaitTime","queueTip","queueReadyTip","queueNoticeBatchWindowMs"])},gt=function(e){if(e){var t=ot(e,["enabled","keywordTriggerEnabled","triggerKeywords","minConfidence","maxRobotRepliesBeforeTransfer","autoTransferDelaySeconds","cooldownSeconds","allowVisitorManualTransfer","manualTransferLabel"]),n=p()({},t);return Array.isArray(n.triggerKeywords)&&(n.triggerKeywords=Array.from(new Set(n.triggerKeywords.map((function(e){return(e||"").trim()})).filter((function(e){return e.length>0}))))),"string"==typeof n.manualTransferLabel&&(n.manualTransferLabel=n.manualTransferLabel.trim()),n}},ft=function(e){var t,n;if(e){var r=ot(e,["defaultRobot","offlineRobot","nonWorktimeRobot"]),i=null!==(t=e.robotUid)&&void 0!==t?t:null===(n=e.robot)||void 0===n?void 0:n.uid;return p()(p()({},r),i?{robotUid:i}:{})}},vt=function(e){if(e)return ot(e,["enabled","regularWorktimes","specialWorktimes","holidays"])},pt=function(){var n=f()(c()().mark((function n(){var r,i,o,s,a,u,l,d,g,f,v,m,h,x;return c()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=Te&&Te.uid){n.next=3;break}return Q.yw.warning(e.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})),n.abrupt("return");case 3:return Le(!0),n.prev=4,r=Ke&&Ke.uid===Te.uid?Ke:Te,o=at((i=function(e,t){return p()(p()({},e||{}),t||{})})(null==r?void 0:r.serviceSettings,null==r?void 0:r.draftServiceSettings)),s=ut(i(null==r?void 0:r.inviteSettings,null==r?void 0:r.draftInviteSettings)),a=lt(i(null==r?void 0:r.intentionSettings,null==r?void 0:r.draftIntentionSettings)),u=dt(i(null==r?void 0:r.messageLeaveSettings,null==r?void 0:r.draftMessageLeaveSettings)),l=vt(i(null==r?void 0:r.worktimeSettings,null==r?void 0:r.draftWorktimeSettings)),d=ft(i(null==r?void 0:r.robotRoutingSettings,null==r?void 0:r.draftRobotRoutingSettings)),g=ct(i(null==r?void 0:r.queueSettings,null==r?void 0:r.draftQueueSettings)),f=gt(i(null==r?void 0:r.robotToAgentSettings,null==r?void 0:r.draftRobotToAgentSettings)),v=p()(p()(p()(p()(p()(p()(p()(p()({uid:Te.uid,orgUid:null==t?void 0:t.uid,name:null==r?void 0:r.name,description:null==r?void 0:r.description,isDefault:null==r?void 0:r.isDefault,enabled:null==r?void 0:r.enabled,routingMode:null==r?void 0:r.routingMode},st(o)?{}:{serviceSettings:o}),st(s)?{}:{inviteSettings:s}),st(a)?{}:{intentionSettings:a}),st(u)?{}:{messageLeaveSettings:u}),st(l)?{}:{worktimeSettings:l}),st(d)?{}:{robotRoutingSettings:d}),st(g)?{}:{queueSettings:g}),st(f)?{}:{robotToAgentSettings:f}),n.next=18,(0,O.Y2)(v);case 18:m=n.sent,console.log("保存工作组配置模板: ",m,v),m&&200===m.code?(Q.yw.success(e.formatMessage({id:"common.saved",defaultMessage:"保存成功"})),Qe.current=JSON.stringify(null!==(h=null!==(x=null==m?void 0:m.data)&&void 0!==x?x:r)&&void 0!==h?h:{}),De(!1),tt(le,{keepActive:!0})):Q.yw.error((null==m?void 0:m.message)||"保存失败"),n.next=27;break;case 23:n.prev=23,n.t0=n.catch(4),console.error("保存失败:",n.t0),Q.yw.error("保存失败");case 27:return n.prev=27,Le(!1),n.finish(27);case 30:case"end":return n.stop()}}),n,null,[[4,23,27,30]])})));return function(){return n.apply(this,arguments)}}(),mt=function(){var n=f()(c()().mark((function n(){var r,i,o;return c()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=Te&&Te.uid){n.next=3;break}return Q.yw.warning(e.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})),n.abrupt("return");case 3:if(Ie(!0),n.prev=4,!Ne){n.next=8;break}return n.next=8,pt();case 8:return r={uid:Te.uid,orgUid:null==t?void 0:t.uid},n.next=11,(0,O.Dm)(r);case 11:(i=n.sent)&&200===i.code?(Q.yw.success(e.formatMessage({id:"common.published",defaultMessage:"发布成功"})),Qe.current=JSON.stringify(null!==(o=null==i?void 0:i.data)&&void 0!==o?o:{}),De(!1),tt(le)):Q.yw.error((null==i?void 0:i.message)||"发布失败"),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(4),console.error("发布失败:",n.t0),Q.yw.error("发布失败");case 19:return n.prev=19,Ie(!1),n.finish(19);case 22:case"end":return n.stop()}}),n,null,[[4,15,19,22]])})));return function(){return n.apply(this,arguments)}}(),ht=(0,r.useMemo)((function(){return null!=Te&&Te.uid?[{key:"tips",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(C.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"workgroup.settings.service.tips",defaultMessage:"提示信息"})]}),children:(0,de.jsx)(Y.Z,{variant:"workgroup",serviceSettings:{live:null==Je?void 0:Je.serviceSettings,draft:null==Je?void 0:Je.draftServiceSettings},onServiceSettingsChange:Be})},{key:"service",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(Z.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"workgroup.settings.service",defaultMessage:"服务设置"})]}),children:(0,de.jsx)(X.Z,{variant:"workgroup",serviceSettings:{live:null==Je?void 0:Je.serviceSettings,draft:null==Je?void 0:Je.draftServiceSettings},onServiceSettingsChange:Be})},{key:"rate",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(T.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"rate",defaultMessage:"Rate"})]}),children:(0,de.jsx)(ee.Z,{variant:"workgroup",serviceSettings:{live:null==Je?void 0:Je.serviceSettings,draft:null==Je?void 0:Je.draftServiceSettings},onServiceSettingsChange:Be})},{key:"robot",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(F.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"robot",defaultMessage:"Robot"})]}),children:(0,de.jsx)(ce,{variant:"workgroup",robotRoutingSettings:{live:null==Je?void 0:Je.robotRoutingSettings,draft:null==Je?void 0:Je.draftRobotRoutingSettings},onRobotRoutingSettingsChange:Ye})}].concat(a()([]),[{key:"messageLeave",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(W.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"workgroup.settings.message.leave",defaultMessage:"Leave Message"})]}),children:(0,de.jsx)($.Z,{variant:"workgroup",messageLeaveSettings:{live:null==Je?void 0:Je.messageLeaveSettings,draft:null==Je?void 0:Je.draftMessageLeaveSettings},onMessageLeaveSettingsChange:Ge})},{key:"queue",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(me.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"workgroup.settings.queue",defaultMessage:"排队设置"})]}),children:(0,de.jsx)(ge.Z,{variant:"workgroup",queueSettings:{live:null==Je?void 0:Je.queueSettings,draft:null==Je?void 0:Je.draftQueueSettings},onQueueSettingsChange:$e})}],a()([]),a()([]),[{key:"right",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(P.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"right",defaultMessage:"Right"})]}),children:(0,de.jsx)(G.Z,{variant:"workgroup",serviceSettings:{live:null==Je?void 0:Je.serviceSettings,draft:null==Je?void 0:Je.draftServiceSettings},onServiceSettingsChange:Be,settingsUid:Te.uid,isActive:"right"===be})}],a()([]),a()([]),[{key:"route",label:(0,de.jsxs)("span",{children:[(0,de.jsx)(L.Z,{})," ",(0,de.jsx)(o.FormattedMessage,{id:"pages.workgroup.tab.route",defaultMessage:"Route"})]}),children:(0,de.jsx)(pe,{})}]):[]}),[null==Te?void 0:Te.uid,Je,e,Be,Ve,Ge,Ye,_e,Xe,$e,be]);return(0,de.jsxs)(de.Fragment,{children:[(0,de.jsxs)(x.Z,{style:{minHeight:"calc(100vh - 160px)"},children:[(0,de.jsx)(x.Z.Panel,{defaultSize:"20%",min:"14%",max:"40%",style:n,children:(0,de.jsxs)(D.Z,{title:e.formatMessage({id:"workgroup.settings.templates",defaultMessage:"模板列表"}),extra:(0,de.jsx)(b.ZP,{size:"small",icon:(0,de.jsx)(q.Z,{}),type:"primary",onClick:function(){Ze(null),je(!0)},children:(0,de.jsx)(o.FormattedMessage,{id:"common.new",defaultMessage:"新建"})}),bodyStyle:{padding:8},loading:g,children:[(0,de.jsx)("div",{style:{margin:"0 0 8px 0"},children:(0,de.jsxs)(S.Z.Compact,{style:{width:"100%"},children:[(0,de.jsx)(k.Z,{placeholder:e.formatMessage({id:"workgroup.settings.template.search",defaultMessage:"搜索模板名称"}),value:le,onChange:function(e){return fe(e.target.value)},onPressEnter:function(e){e.preventDefault();var t=e.currentTarget.value;fe(t),nt(t)},allowClear:!0,size:"middle"}),(0,de.jsx)(b.ZP,{type:"primary",icon:(0,de.jsx)(U.Z,{}),"aria-label":e.formatMessage({id:"common.search",defaultMessage:"搜索"}),onClick:function(){return nt()}})]})}),(0,de.jsx)("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 280px)"},children:(0,de.jsx)(w.Z,{dataSource:et,locale:{emptyText:(0,de.jsx)(M.Z,{description:e.formatMessage({id:"empty",defaultMessage:"暂无数据"}),image:M.Z.PRESENTED_IMAGE_SIMPLE})},renderItem:function(e){return(0,de.jsx)(w.Z.Item,{style:oe===e.uid?{backgroundColor:s?"#333333":"#dddddd",cursor:"pointer",borderRadius:6,marginBottom:8,padding:10}:{cursor:"pointer",borderRadius:6,marginBottom:8,padding:10},onClick:function(){return se(e.uid)},children:(0,de.jsx)(w.Z.Item.Meta,{title:(0,de.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,de.jsx)("div",{style:{fontWeight:500,flex:1},children:e.name||e.uid}),(0,de.jsx)(S.Z,{size:4,children:e.isDefault?(0,de.jsx)(j.Z,{color:"blue",children:"默认"}):null})]}),description:e.description?(0,de.jsx)("div",{style:{color:s?"#aaa":"#999",fontSize:12},children:e.description}):null})},e.uid)}})})]})}),(0,de.jsx)(x.Z.Panel,{children:Te?(0,de.jsx)(D.Z,{title:(0,de.jsxs)(S.Z,{children:[(0,de.jsxs)("span",{children:[e.formatMessage({id:"workgroup.settings.editing",defaultMessage:"编辑模板"}),": ",Te.name||Te.uid]}),(0,de.jsx)(y.Z,{checked:!!Te.enabled,onChange:function(e){return it(Te.uid,e)},checkedChildren:e.formatMessage({id:"common.enabled",defaultMessage:"启用"}),unCheckedChildren:e.formatMessage({id:"common.disabled",defaultMessage:"停用"})}),(0,de.jsx)(b.ZP,{size:"small",icon:(0,de.jsx)(A.Z,{}),onClick:function(e){var t;e.stopPropagation(),Ze(null!=(t=Te)?t:Te),je(!0)},children:"编辑"}),(0,de.jsx)(R.Z,{title:e.formatMessage({id:"common.delete.confirm",defaultMessage:"确定要删除吗?"}),onConfirm:function(e){null==e||e.stopPropagation(),rt(Te)},onCancel:function(e){return null==e?void 0:e.stopPropagation()},okText:e.formatMessage({id:"common.confirm",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"common.cancel",defaultMessage:"取消"}),children:(0,de.jsx)(b.ZP,{size:"small",danger:!0,icon:(0,de.jsx)(I.Z,{}),onClick:function(e){e.stopPropagation()},children:"删除"})}),Te.isDefault?(0,de.jsx)(j.Z,{color:"blue",children:"默认"}):null]}),extra:(0,de.jsxs)(S.Z,{children:[(0,de.jsx)(R.Z,{title:"发布到线上环境",description:"只有发布之后，才会应用到线上环境",okText:"继续发布",cancelText:"取消",onConfirm:function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),mt()},onCancel:function(e){var t;return null==e||null===(t=e.stopPropagation)||void 0===t?void 0:t.call(e)},children:(0,de.jsx)(b.ZP,{onClick:function(e){return e.stopPropagation()},loading:Ae,type:"default",icon:(0,de.jsx)(E.Z,{}),children:(0,de.jsx)(o.FormattedMessage,{id:"common.publish",defaultMessage:"发布"})})}),(0,de.jsx)(b.ZP,{onClick:function(){Te&&(He(Te),Qe.current=JSON.stringify(null!=Te?Te:{}),De(!1))},disabled:!Ne,icon:(0,de.jsx)(z.Z,{}),children:(0,de.jsx)(o.FormattedMessage,{id:"common.reset",defaultMessage:"重置"})}),(0,de.jsx)(b.ZP,{type:"primary",loading:Pe,onClick:pt,disabled:!Ne,icon:(0,de.jsx)(N.Z,{}),children:(0,de.jsx)(o.FormattedMessage,{id:"common.save",defaultMessage:"保存"})})]}),children:(0,de.jsx)(i.Z,{activeKey:be,onChange:Se,items:ht})}):(0,de.jsx)(D.Z,{children:(0,de.jsx)(M.Z,{description:e.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})})})})]}),(0,de.jsx)(_.Z,{open:Me,onOpenChange:je,orgUid:(null==t?void 0:t.uid)||"",record:Ce,onSuccess:function(){je(!1),tt(le)}})]})},be=n(55141),Se=function(){return(0,de.jsx)(i.Z,{defaultActiveKey:"table",style:{padding:"10px"},items:[{key:"table",label:(0,de.jsx)(o.FormattedMessage,{id:"menu.workgroup.table",defaultMessage:"Workgroup"}),children:(0,de.jsx)(be.Z,{})},{key:"settings",label:(0,de.jsx)(o.FormattedMessage,{id:"menu.workgroup.settings",defaultMessage:"Workgroup Settings"}),children:(0,de.jsx)(xe,{})}]})}}}]);