"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9368],{35911:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(83910),r=a(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},o=a(5901),i=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var c=r.forwardRef(i)},26762:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(83910),r=a(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690.1 377.4c5.9 0 11.8.2 17.6.5-24.4-128.7-158.3-227.1-319.9-227.1C209 150.8 64 271.4 64 420.2c0 81.1 43.6 154.2 111.9 203.6a21.5 21.5 0 019.1 17.6c0 2.4-.5 4.6-1.1 6.9-5.5 20.3-14.2 52.8-14.6 54.3-.7 2.6-1.7 5.2-1.7 7.9 0 5.9 4.8 10.8 10.8 10.8 2.3 0 4.2-.9 6.2-2l70.9-40.9c5.3-3.1 11-5 17.2-5 3.2 0 6.4.5 9.5 1.4 33.1 9.5 68.8 14.8 105.7 14.8 6 0 11.9-.1 17.8-.4-7.1-21-10.9-43.1-10.9-66 0-135.8 132.2-245.8 295.3-245.8zm-194.3-86.5c23.8 0 43.2 19.3 43.2 43.1s-19.3 43.1-43.2 43.1c-23.8 0-43.2-19.3-43.2-43.1s19.4-43.1 43.2-43.1zm-215.9 86.2c-23.8 0-43.2-19.3-43.2-43.1s19.3-43.1 43.2-43.1 43.2 19.3 43.2 43.1-19.4 43.1-43.2 43.1zm586.8 415.6c56.9-41.2 93.2-102 93.2-169.7 0-124-120.8-224.5-269.9-224.5-149 0-269.9 100.5-269.9 224.5S540.9 847.5 690 847.5c30.8 0 60.6-4.4 88.1-12.3 2.6-.8 5.2-1.2 7.9-1.2 5.2 0 9.9 1.6 14.3 4.1l59.1 34c1.7 1 3.3 1.7 5.2 1.7a9 9 0 006.4-2.6 9 9 0 002.6-6.4c0-2.2-.9-4.4-1.4-6.6-.3-1.2-7.6-28.3-12.2-45.3-.5-1.9-.9-3.8-.9-5.7.1-5.9 3.1-11.2 7.6-14.5zM600.2 587.2c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9c0 19.8-16.2 35.9-36 35.9zm179.9 0c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9a36.08 36.08 0 01-36 35.9z"}}]},name:"wechat",theme:"outlined"},o=a(5901),i=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var c=r.forwardRef(i)},86772:function(e,t,a){var n=a(94433),r=a(38956),s=a(75477),o=a(941),i=a(44194),c=a(99066),l=a(46659),u=a(31549),d=["options","fieldProps","proFieldProps","valueEnum"],g=i.forwardRef((function(e,t){var a=e.options,o=e.fieldProps,i=e.proFieldProps,c=e.valueEnum,g=(0,r.Z)(e,d);return(0,u.jsx)(l.Z,(0,n.Z)({ref:t,valueType:"checkbox",valueEnum:(0,s.h)(c,void 0),fieldProps:(0,n.Z)({options:a},o),lightProps:(0,n.Z)({labelFormatter:function(){return(0,u.jsx)(l.Z,(0,n.Z)({ref:t,valueType:"checkbox",mode:"read",valueEnum:(0,s.h)(c,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:a},o),proFieldProps:i},g))}},g.lightProps),proFieldProps:i},g))})),f=i.forwardRef((function(e,t){var a=e.fieldProps,r=e.children;return(0,u.jsx)(o.Z,(0,n.Z)((0,n.Z)({ref:t},a),{},{children:r}))})),p=(0,c.G)(f,{valuePropName:"checked"});p.Group=g,t.Z=p},50447:function(e,t,a){var n=a(94433),r=a(38956),s=a(75477),o=a(44194),i=a(18758),c=a(46659),l=a(31549),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],g=function(e,t){var a=e.fieldProps,d=e.children,g=e.params,f=e.proFieldProps,p=e.mode,h=e.valueEnum,m=e.request,v=e.showSearch,w=e.options,x=(0,r.Z)(e,u),y=(0,o.useContext)(i.Z);return(0,l.jsx)(c.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:m,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:w,mode:p,showSearch:v,getPopupContainer:y.getPopupContainer},a),ref:t,proFieldProps:f},x),{},{children:d}))},f=o.forwardRef((function(e,t){var a=e.fieldProps,u=e.children,g=e.params,f=e.proFieldProps,p=e.mode,h=e.valueEnum,m=e.request,v=e.options,w=(0,r.Z)(e,d),x=(0,n.Z)({options:v,mode:p||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},a),y=(0,o.useContext)(i.Z);return(0,l.jsx)(c.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:m,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:y.getPopupContainer},x),ref:t,proFieldProps:f},w),{},{children:u}))})),p=o.forwardRef(g);p.SearchSelect=f,p.displayName="ProFormComponent",t.Z=p},28016:function(e,t,a){a.d(t,{Z:function(){return y}});var n=a(90819),r=a.n(n),s=a(89933),o=a.n(s),i=a(45332),c=a.n(i),l=a(61489),u=a(68992),d=a(62395);function g(){return f.apply(this,arguments)}function f(){return(f=o()(r()().mark((function e(){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/kaptcha/api/v1/get",{method:"GET",params:{channel:u.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){return h.apply(this,arguments)}function h(){return(h=o()(r()().mark((function e(t,a){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/kaptcha/api/v1/check",{method:"POST",data:{captchaUid:t,captchaCode:a,channel:u.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=a(80597),v=a(13243),w=a(44194),x=a(31549),y=function(e){var t=e.onKaptchaChange,a=e.onKaptchaCheck,n=(0,d.useIntl)(),s=(0,w.useState)(),i=c()(s,2),u=i[0],f=i[1],h=(0,w.useState)(),y=c()(h,2),M=y[0],k=y[1],b=(0,w.useState)(!1),S=c()(b,2),C=S[0],j=S[1],Z=function(){var e=o()(r()().mark((function e(){var t;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=2;break}return e.abrupt("return");case 2:return j(!0),e.prev=3,e.next=6,g();case 6:200===(t=e.sent).code?(f(t.data.captchaUid),k(t.data.captchaImage)):l.yw.error(n.formatMessage({id:"kaptcha.get.error",defaultMessage:"获取验证码失败"})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),l.yw.error(n.formatMessage({id:"kaptcha.get.error",defaultMessage:"获取验证码失败"}));case 13:return e.prev=13,j(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=o()(r()().mark((function e(t,n){var s;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t,n);case 2:s=e.sent,console.log("checkCaptcha response",s),200===s.code?a&&a(!0):a&&a(!1);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();(0,w.useEffect)((function(){Z()}),[]);return(0,x.jsx)(x.Fragment,{children:M&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(v.Z,{onChange:function(e){t&&(t(u,e.target.value),e.target.value&&""!==e.target.value&&4===e.target.value.trim().length?P(u,e.target.value):a&&a(!1))},prefix:(0,x.jsx)(m.Z,{}),placeholder:n.formatMessage({id:"captcha",defaultMessage:"captcha"}),style:{width:"65%",float:"left",height:40},allowClear:!0}),(0,x.jsx)("img",{src:M,alt:"captcha",onClick:Z})]})})}},71004:function(e,t,a){a.r(t),a.d(t,{default:function(){return Se}});var n=a(10154),r=a.n(n),s=a(73193),o=a.n(s),i=a(90819),c=a.n(i),l=a(89933),u=a.n(l),d=a(45332),g=a.n(d),f=a(15331),p=a(89007),h=a(23163),m=a(55502),v=a(82204),w=a(87790),x=a(62395),y=a(48586),M=a(23854),k=a(72264),b=a(89654),S=a(44528),C=a(83363),j=a(44194),Z=a(56321),P=a(42358),U=a(61489),I=a(55738),R=a(70097),L=a(68992),T=a(28016),E=a(57039),F=a(76630),A=a(47268),z=a(75686),_=a(69650),B=a(67194),H=a(31549),G=function(e){var t=e.loginType,a=e.onKaptchaChange,n=e.onKaptchaCheck,r=(0,x.useIntl)(),s=(0,j.useState)(0),o=g()(s,2),i=o[0],l=o[1],d=(0,j.useState)(""),f=g()(d,2),h=f[0],m=f[1],v=function(){var e=u()(c()().mark((function e(t,n){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&a(t,n);case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),w=function(){var e=u()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&n(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){return e>=80?"#52c41a":e>=60?"#faad14":e>=40?"#fa8c16":"#ff4d4f"};return(0,H.jsx)(H.Fragment,{children:"account"===t&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(A.Z,{name:"username",fieldProps:{size:"large",prefix:(0,H.jsx)(E.Z,{})},placeholder:r.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"用户名/邮箱"}),rules:[{required:!0,message:(0,H.jsx)(x.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"请输入用户名/邮箱!"})}]}),(0,H.jsx)(A.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,H.jsx)(F.Z,{}),onChange:function(e){var t=e.target.value,a=(0,z.Qc)(t),n=(0,z.$g)(a);l(a),m(n)}},placeholder:r.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"密码"}),rules:[{required:!0,message:(0,H.jsx)(x.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"请输入密码！"})}]}),i>0&&(0,H.jsx)("div",{style:{marginBottom:16},children:(0,H.jsxs)(b.Z,{direction:"vertical",style:{width:"100%"},children:[(0,H.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,H.jsx)(_.Z.Text,{type:"secondary",children:r.formatMessage({id:"pages.login.password.strength",defaultMessage:"密码强度："})}),(0,H.jsx)(_.Z.Text,{strong:!0,style:{color:y(i)},children:h})]}),(0,H.jsx)(B.Z,{percent:i,strokeColor:y(i),showInfo:!1,size:"small"}),(0,H.jsx)(_.Z.Text,{type:"secondary",style:{fontSize:"12px"},children:r.formatMessage({id:"pages.login.password.suggestion",defaultMessage:"建议：包含大小写字母、数字和特殊字符，长度至少8位"})})]})}),(0,H.jsx)(p.A.Item,{name:"captchaCode",rules:[{required:!0,message:r.formatMessage({id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],children:(0,H.jsx)(T.Z,{onKaptchaChange:v,onKaptchaCheck:w})})]})})},N=a(99754),D=a(62134),V=a(82325),q=a(50447),K=a(77957),O=a(21478),J=a(22888),Q=a(56206),W=function(e){var t=e.loginType,a=e.onKaptchaChange,n=e.onKaptchaCheck,r=(0,x.useIntl)(),s=(0,N.Z)().translateString,i=(0,j.useRef)(),l=(0,j.useState)(""),d=g()(l,2),h=d[0],m=d[1],v=(0,j.useState)(""),w=g()(v,2),y=w[0],M=w[1],k=(0,j.useState)(!1),b=g()(k,2),S=b[0],C=b[1],Z=(0,j.useState)("86"),I=g()(Z,2),R=I[0],E=I[1],z=(0,P.L)((function(e){return{deviceUid:e.deviceUid,setDeviceUid:e.setDeviceUid}})),_=z.deviceUid,B=z.setDeviceUid,G=function(){var e=u()(c()().mark((function e(t,n){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m(t),M(n),a&&a(t,n);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=function(){var e=u()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(t),n&&n(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,j.useEffect)((function(){void 0!==_&&""!==_||B((0,D.Zx)())}),[]);var X=[{label:r.formatMessage({id:"pages.login.country.china",defaultMessage:"中国"}),value:"86",icon:"🇨🇳",code:"CN"},{label:r.formatMessage({id:"pages.login.country.usa",defaultMessage:"美国"}),value:"1",icon:"🇺🇸",code:"US"},{label:r.formatMessage({id:"pages.login.country.japan",defaultMessage:"日本"}),value:"81",icon:"🇯🇵",code:"JP"},{label:r.formatMessage({id:"pages.login.country.hongkong",defaultMessage:"香港"}),value:"852",icon:"🇭🇰",code:"HK"},{label:r.formatMessage({id:"pages.login.country.taiwan",defaultMessage:"台湾"}),value:"886",icon:"🇹🇼",code:"TW"},{label:r.formatMessage({id:"pages.login.country.macao",defaultMessage:"澳门"}),value:"853",icon:"🇲🇴",code:"MO"},{label:r.formatMessage({id:"pages.login.country.korea",defaultMessage:"韩国"}),value:"82",icon:"🇰🇷",code:"KR"},{label:r.formatMessage({id:"pages.login.country.canada",defaultMessage:"加拿大"}),value:"1-ca",icon:"🇨🇦",code:"CA"},{label:r.formatMessage({id:"pages.login.country.singapore",defaultMessage:"新加坡"}),value:"65",icon:"🇸🇬",code:"SG"},{label:r.formatMessage({id:"pages.login.country.malaysia",defaultMessage:"马来西亚"}),value:"60",icon:"🇲🇾",code:"MY"},{label:r.formatMessage({id:"pages.login.country.thailand",defaultMessage:"泰国"}),value:"66",icon:"🇹🇭",code:"TH"},{label:r.formatMessage({id:"pages.login.country.vietnam",defaultMessage:"越南"}),value:"84",icon:"🇻🇳",code:"VN"},{label:r.formatMessage({id:"pages.login.country.philippines",defaultMessage:"菲律宾"}),value:"63",icon:"🇵🇭",code:"PH"},{label:r.formatMessage({id:"pages.login.country.indonesia",defaultMessage:"印度尼西亚"}),value:"62",icon:"🇮🇩",code:"ID"},{label:r.formatMessage({id:"pages.login.country.uk",defaultMessage:"英国"}),value:"44",icon:"🇬🇧",code:"GB"},{label:r.formatMessage({id:"pages.login.country.germany",defaultMessage:"德国"}),value:"49",icon:"🇩🇪",code:"DE"},{label:r.formatMessage({id:"pages.login.country.france",defaultMessage:"法国"}),value:"33",icon:"🇫🇷",code:"FR"},{label:r.formatMessage({id:"pages.login.country.italy",defaultMessage:"意大利"}),value:"39",icon:"🇮🇹",code:"IT"},{label:r.formatMessage({id:"pages.login.country.spain",defaultMessage:"西班牙"}),value:"34",icon:"🇪🇸",code:"ES"},{label:r.formatMessage({id:"pages.login.country.russia",defaultMessage:"俄罗斯"}),value:"7",icon:"🇷🇺",code:"RU"},{label:r.formatMessage({id:"pages.login.country.australia",defaultMessage:"澳大利亚"}),value:"61",icon:"🇦🇺",code:"AU"},{label:r.formatMessage({id:"pages.login.country.newzealand",defaultMessage:"新西兰"}),value:"64",icon:"🇳🇿",code:"NZ"}];return(0,H.jsx)(H.Fragment,{children:"mobile"===t&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(O.Z,{gutter:16,children:[(0,H.jsx)(J.Z,{span:10,children:(0,H.jsx)(q.Z,{name:"country",options:X.map((function(e){return o()(o()({},e),{},{label:"".concat(e.icon," ").concat(e.label," (+").concat(e.value.includes("-")?e.value.split("-")[0]:e.value,")")})})),fieldProps:{size:"large",placeholder:r.formatMessage({id:"pages.login.country.placeholder",defaultMessage:"选择国家/地区"}),onChange:function(e){return E(e)}},initialValue:"86"})}),(0,H.jsx)(J.Z,{span:14,children:(0,H.jsx)(A.Z,{fieldProps:{size:"large",prefix:(0,H.jsx)(V.Z,{})},name:"mobile",placeholder:r.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"手机号"}),rules:[{required:!0,message:(0,H.jsx)(x.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"请输入手机号！"})}]})})]}),(0,H.jsx)(p.A.Item,{name:"captchaCode",rules:[{required:!0,message:r.formatMessage({id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],children:(0,H.jsx)(T.Z,{onKaptchaChange:G,onKaptchaCheck:W})}),(0,H.jsx)(K.Z,{fieldProps:{size:"large",prefix:(0,H.jsx)(F.Z,{})},captchaProps:{size:"large",disabled:!S},placeholder:r.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"请输入验证码"}),captchaTextRender:function(e,t){return e?"".concat(t," ").concat(r.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"获取验证码"})):r.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"获取验证码"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,H.jsx)(x.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],fieldRef:i,onGetCaptcha:function(){var e=u()(c()().mark((function e(t){var a,n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=13;break}return a={mobile:t,country:R,type:L.UUF,captchaUid:h,captchaCode:y,deviceUid:_,platform:L.iw8},e.next=4,(0,f.Y7)(a);case 4:if(n=e.sent,console.debug("sendMobileCode:",n,a),200===n.code){e.next=10;break}return U.yw.error(s(n.message)),setTimeout((function(){var e;console.log("endCaptchaTiming"),null===(e=i.current)||void 0===e||e.endTiming()}),2),e.abrupt("return");case 10:U.yw.success(s(n.message)),e.next=14;break;case 13:U.yw.error(r.formatMessage({id:"pages.login.phoneNumber.invalid",defaultMessage:"手机号不能为空"}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),(0,H.jsx)(Q.Z,{message:(0,H.jsx)(x.FormattedMessage,{id:"pages.login.auto.register",defaultMessage:"Mobile will auto register"}),type:"info"})]})})},X=a(26603),Y=function(e){var t=e.loginType,a=(0,x.useIntl)(),n=(0,I.t)((function(e){return e.setAccessToken})),r=(0,P.L)((function(e){return e.setUserInfo})),s=(0,x.useModel)("@@initialState").setInitialState,i=(0,P.L)((function(e){return{deviceUid:e.deviceUid,setDeviceUid:e.setDeviceUid}})),l=i.deviceUid,d=i.setDeviceUid,p=(0,j.useState)("login"),h=g()(p,2),m=h[0],v=h[1],w=(0,j.useState)("loading"),y=g()(w,2),M=y[0],k=y[1],b=function(){var e=u()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(0,Z.flushSync)((function(){s((function(e){return o()(o()({},e),{},{userInfo:t})}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=u()(c()().mark((function e(t){var s,i,l;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleScanLogin values: ",t),U.yw.loading(a.formatMessage({id:"logging",defaultMessage:"logging..."})),e.next=4,(0,f.kZ)(o()({},t));case 4:s=e.sent,console.log("LoginMobileResult scanLogin:",s.data),200===s.code?(U.yw.destroy(),U.yw.success(a.formatMessage({id:"login.success",defaultMessage:"login success"})),n(null==s?void 0:s.data.accessToken),b(null==s||null===(i=s.data)||void 0===i?void 0:i.user),r(null==s||null===(l=s.data)||void 0===l?void 0:l.user),x.history.push("/")):(U.yw.destroy(),U.yw.error(s.message));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=u()(c()().mark((function e(a){var n,r,s;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("scan"===t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,f.Tm)(l,a);case 4:if(200!==(n=e.sent).code){e.next=30;break}if(r=n.data,console.log("handleScanQuery status: ",r.status),r.status!==L.C20){e.next=13;break}k("active"),v("deviceUid="+r.deviceUid+"&code="+r.content),e.next=28;break;case 13:if(r.status!==L.FM$){e.next=17;break}k("scanned"),e.next=28;break;case 17:if(r.status!==L.PhI){e.next=21;break}k("expired"),e.next=28;break;case 21:if(r.status!==L.Cml){e.next=28;break}if(void 0!==r.receiver&&""!==r.receiver){e.next=24;break}return e.abrupt("return");case 24:return s={mobile:r.receiver,code:r.content,platform:L.iw8},console.log("login scan info:",s),e.next=28,S(s);case 28:e.next=31;break;case 30:U.yw.error(n.message);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,j.useEffect)((function(){console.log("scan deviceUid:",l),void 0!==l&&""!==l||d((0,D.Zx)()),C(!1);var e=setInterval((function(){C(!1)}),3e3);return function(){clearInterval(e)}}),[t,l]),(0,H.jsx)(H.Fragment,{children:"scan"===t&&(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(X.Z,{style:{margin:"auto"},value:m,status:M,onRefresh:function(){console.log("onRefresh"),C(!0)}})})})},$=a(29368),ee=a(35762),te=a(83910),ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M881 442.4H519.7v148.5h206.4c-8.9 48-35.9 88.6-76.6 115.8-34.4 23-78.3 36.6-129.9 36.6-99.9 0-184.4-67.5-214.6-158.2-7.6-23-12-47.6-12-72.9s4.4-49.9 12-72.9c30.3-90.6 114.8-158.1 214.7-158.1 56.3 0 106.8 19.4 146.6 57.4l110-110.1c-66.5-62-153.2-100-256.6-100-149.9 0-279.6 86-342.7 211.4-26 51.8-40.8 110.4-40.8 172.4S151 632.8 177 684.6C240.1 810 369.8 896 519.7 896c103.6 0 190.4-34.4 253.8-93 72.5-66.8 114.4-165.2 114.4-282.1 0-27.2-2.4-53.3-6.9-78.5z"}}]},name:"google",theme:"outlined"},ne=a(5901),re=function(e,t){return j.createElement(ne.Z,(0,te.Z)({},e,{ref:t,icon:ae}))};var se=j.forwardRef(re),oe=a(26762),ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-92.4 233.5h-63.9c-50.1 0-59.8 23.8-59.8 58.8v77.1h119.6l-15.6 120.7h-104V912H539.2V602.2H434.9V481.4h104.3v-89c0-103.3 63.1-159.6 155.3-159.6 44.2 0 82.1 3.3 93.2 4.8v107.9z"}}]},name:"facebook",theme:"filled"},ce=function(e,t){return j.createElement(ne.Z,(0,te.Z)({},e,{ref:t,icon:ie}))};var le=j.forwardRef(ce),ue=a(87005),de=a(941),ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},fe=function(e,t){return j.createElement(ne.Z,(0,te.Z)({},e,{ref:t,icon:ge}))};var pe=j.forwardRef(fe),he=a(86772),me=function(){var e=y.Z.useToken().token,t=(0,j.useContext)($.I),a=t.isCustomServer,n=t.setIsCustomServer,r=p.A.useForm(),s=g()(r,1)[0],o=(0,j.useState)(!1),i=g()(o,2),c=i[0],l=i[1],u=(0,j.useState)(""),d=g()(u,2),f=d[0],h=d[1],m=(0,j.useState)(""),v=g()(m,2),w=(v[0],v[1]);(0,j.useEffect)((function(){f&&f.length>0&&(s.setFieldsValue({apiUrl:f}),console.log("apiUrl:",f))}),[f]),(0,j.useEffect)((function(){if(a){var e=localStorage.getItem(L.Ss2);"true"===e&&(l(!0),s.setFieldsValue({isCustomServerEnabled:!0})),console.log("isCustomServer customEnabled:",e);var t=localStorage.getItem(L.DuM);t&&s.setFieldsValue({apiUrl:(0,D.Qj)(t)});var n=localStorage.getItem(L.sZT);n&&s.setFieldsValue({websocketUrl:(0,D.Qj)(n)})}}),[a]);return(0,H.jsx)("div",{className:"ant-pro-form-server-container",style:{backgroundColor:e.colorBgContainer,display:"flex",justifyContent:"center",flexDirection:"column",height:"100%",width:"80%",marginLeft:"10%"},children:(0,H.jsxs)(p.A,{className:"ant-pro-form-server-main",form:s,submitter:{render:function(e,t){return console.log("props:",e,t),(0,H.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"8px"},children:[(0,H.jsx)(k.ZP,{icon:(0,H.jsx)(pe,{}),onClick:function(){console.log("switch server"),n((function(e){return!e}))},children:"返回"},"back"),(0,H.jsx)(k.ZP,{type:"primary",onClick:function(){var t=e.form.getFieldValue("apiUrl");t=(0,D.Qj)(t.trim());var a=e.form.getFieldValue("websocketUrl");a=(0,D.Qj)(a.trim()),t&&t.trim().length>0&&a&&a.trim().length>0?(localStorage.setItem(L.DuM,t),localStorage.setItem(L.sZT,a),localStorage.setItem(L.Ss2,"true"),U.yw.success("保存成功")):U.yw.error("请输入正确的服务器地址")},children:"保存"},"submit"),(0,H.jsx)(k.ZP,{onClick:function(){var t;null===(t=e.form)||void 0===t||t.resetFields(),h(""),localStorage.setItem(L.Ss2,"false"),localStorage.setItem(L.DuM,""),localStorage.setItem(L.sZT,""),U.yw.success("重置成功，已恢复默认云服务器")},children:"重置"},"reset"),(0,H.jsx)(k.ZP,{onClick:function(){window.open("https://www.weiyuai.cn/docs/zh-CN/docs/manual/agent/auth/login")},children:"帮助"},"help")]})}},children:[(0,H.jsx)(he.Z,{name:"isCustomServerEnabled",fieldProps:{onChange:function(e){console.log("e:",e),function(e){if(console.log("handleCustomServerChange e:",e),l(e.target.checked),e.target.checked){var t=localStorage.getItem(L.DuM);t&&s.setFieldsValue({apiUrl:(0,D.Qj)(t)});var a=localStorage.getItem(L.sZT);a&&s.setFieldsValue({websocketUrl:(0,D.Qj)(a)}),console.log("initData apiUrl:",t,"websocketUrl:",a)}else localStorage.setItem(L.Ss2,"false")}(e)}},children:"是否启用自定义服务器"}),c&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(A.Z,{name:"apiUrl",label:"API 服务器地址（例如：http://127.0.0.1:9003 或 https://api.bytedesk.com）",fieldProps:{disabled:!c,placeholder:"http://127.0.0.1:9003",onChange:function(e){return h(e.target.value)}}}),(0,H.jsx)(A.Z,{name:"websocketUrl",label:"WebSocket 服务器地址（例如：ws://127.0.0.1:9885/websocket 或 wss://api.bytedesk.com/websocket）",fieldProps:{disabled:!c,placeholder:"ws://127.0.0.1:9885/websocket",onChange:function(e){return w(e.target.value)}}})]})]})})},ve=a(85684),we=a(46205),xe=a(46130),ye=y.Z.defaultAlgorithm,Me=y.Z.darkAlgorithm,ke=function(){var e=(0,w.l)((function(e){var t=e.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:t.borderRadius,":hover":{backgroundColor:t.colorBgTextHover}}}));return(0,H.jsx)("div",{className:e,"data-lang":!0,children:x.SelectLang&&(0,H.jsx)(x.SelectLang,{})})},be=function(){var e,t=M.Z.useApp(),a=t.modal,n=t.message,s=(0,x.useIntl)(),i=(0,N.Z)().translateString,l=p.A.useForm(),d=g()(l,1)[0],w=y.Z.useToken().token,C=(0,R.Z)().isDarkMode,U=(0,ve.M)(),T=U.config,E=U.updateConfig,F=(0,j.useState)("https://www.weiyuai.cn/logo.png"),A=g()(F,2),_=A[0],B=A[1],V=(0,j.useState)(""),q=g()(V,2),K=q[0],O=q[1],J=(0,j.useState)(""),Q=g()(J,2),X=Q[0],te=Q[1],ae=(0,I.t)((function(e){return e.setAccessToken})),ne=(0,j.useContext)($.I),re=ne.isCustomServer,ie=(ne.setIsCustomServer,(0,j.useState)("mobile")),ce=g()(ie,2),ge=ce[0],fe=ce[1],pe=(0,x.useModel)("@@initialState").setInitialState,he=(0,P.L)((function(e){return{deviceUid:e.deviceUid,setDeviceUid:e.setDeviceUid,setUserInfo:e.setUserInfo}})),ye=he.deviceUid,Me=he.setDeviceUid,be=he.setUserInfo,Se=(0,j.useState)(!1),Ce=g()(Se,2),je=Ce[0],Ze=Ce[1],Pe=(0,j.useState)(),Ue=g()(Pe,2),Ie=Ue[0],Re=Ue[1],Le=(0,j.useState)("https://www.weiyuai.cn/privacy.html"),Te=g()(Le,2),Ee=Te[0],Fe=Te[1],Ae=(0,j.useState)("https://www.weiyuai.cn/terms.html"),ze=g()(Ae,2),_e=ze[0],Be=ze[1],He=function(){window.open(Ee)},Ge=function(){window.open(_e)},Ne=(0,j.useState)(""),De=g()(Ne,2),Ve=De[0],qe=De[1],Ke=function(){var e=u()(c()().mark((function e(t,a){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:qe(t),d.setFieldValue("captchaCode",a);case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Oe=function(){var e=u()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleKaptchaCheck:",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Je=function(e){a.confirm({title:s.formatMessage({id:"pages.login.privacyModal.title",defaultMessage:"隐私协议确认"}),content:(0,H.jsxs)("div",{children:[(0,H.jsx)("p",{children:s.formatMessage({id:"pages.login.privacyModal.description",defaultMessage:"为了保护您的个人信息安全，请您阅读并同意以下协议："})}),(0,H.jsxs)("p",{children:[(0,H.jsx)(k.ZP,{size:"small",type:"link",onClick:He,style:{padding:0,height:"auto"},children:s.formatMessage({id:"pages.login.privacyModal.privacyPolicy",defaultMessage:"《用户隐私协议》"})}),s.formatMessage({id:"pages.login.privacyModal.and",defaultMessage:"和"}),(0,H.jsx)(k.ZP,{size:"small",type:"link",onClick:Ge,style:{padding:0,height:"auto"},children:s.formatMessage({id:"pages.login.privacyModal.termsOfService",defaultMessage:"《服务条款》"})})]}),(0,H.jsx)("p",{children:s.formatMessage({id:"pages.login.privacyModal.confirmText",defaultMessage:"是否同意以上协议并继续登录？"})})]}),okText:s.formatMessage({id:"pages.login.privacyModal.agreeAndLogin",defaultMessage:"同意并登录"}),cancelText:s.formatMessage({id:"pages.login.privacyModal.cancel",defaultMessage:"取消"}),onOk:function(){Ze(!0),e()}})},Qe=function(){var e,t,a,n=[];return!1!==(null==Ie||null===(e=Ie.custom)||void 0===e?void 0:e.loginUsernameEnable)&&n.push({key:"account",label:s.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"账户密码登录"}),children:(0,H.jsx)(G,{loginType:ge,onKaptchaChange:Ke,onKaptchaCheck:Oe})}),!1!==(null==Ie||null===(t=Ie.custom)||void 0===t?void 0:t.loginMobileEnable)&&n.push({key:"mobile",label:s.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"手机号登录"}),children:(0,H.jsx)(W,{loginType:ge,onKaptchaChange:Ke,onKaptchaCheck:Oe})}),!1!==(null==Ie||null===(a=Ie.custom)||void 0===a?void 0:a.loginScanEnable)&&n.push({key:"scan",label:s.formatMessage({id:"pages.login.scanLogin.tab",defaultMessage:"扫码登录"}),children:(0,H.jsx)(Y,{loginType:ge})}),0===n.length&&n.push({key:"account",label:s.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"账户密码登录"}),children:(0,H.jsx)(G,{loginType:ge,onKaptchaChange:Ke,onKaptchaCheck:Oe})}),n},We={marginInlineStart:"16px",color:(0,h.uK)(w.colorTextBase,.2),fontSize:"24px",verticalAlign:"middle",cursor:"pointer"},Xe=function(e){var t=document.querySelector("link[rel*='icon']");t||((t=document.createElement("link")).type="image/x-icon",t.rel="shortcut icon",document.getElementsByTagName("head")[0].appendChild(t)),t.href=e},Ye=function(e){document.title=e||s.formatMessage({id:"app.title"})},$e=function(e){var t;if(!e)return B("https://www.weiyuai.cn/logo.png"),Xe("https://www.weiyuai.cn/logo.png"),O(s.formatMessage({id:"app.title"})),te(s.formatMessage({id:"pages.layouts.userLayout.title"})),void Ye(s.formatMessage({id:"app.title"}));if(Re(e),null!=e&&null!==(t=e.custom)&&void 0!==t&&t.enabled&&!(0,ue._p)()){var a,n,r,o,i,c,l,u,d;if(null!=e&&null!==(a=e.custom)&&void 0!==a&&a.logo){var g,f=null==e||null===(g=e.custom)||void 0===g?void 0:g.logo;B(f),Xe(f)}else B("https://www.weiyuai.cn/logo.png"),Xe("https://www.weiyuai.cn/logo.png");if(null!=e&&null!==(n=e.custom)&&void 0!==n&&n.name)O(null==e||null===(l=e.custom)||void 0===l?void 0:l.name),Ye(null==e||null===(u=e.custom)||void 0===u?void 0:u.name);else O(s.formatMessage({id:"app.title"})),Ye(s.formatMessage({id:"app.title"}));if(null!=e&&null!==(r=e.custom)&&void 0!==r&&r.description)te(null==e||null===(d=e.custom)||void 0===d?void 0:d.description);else te(s.formatMessage({id:"pages.layouts.userLayout.title"}));null!=e&&null!==(o=e.custom)&&void 0!==o&&o.showRightCornerChat||E({bubbleConfig:{show:!1},buttonConfig:{show:!1}}),null!=e&&null!==(i=e.custom)&&void 0!==i&&i.privacyPolicyUrl&&Fe(e.custom.privacyPolicyUrl),null!=e&&null!==(c=e.custom)&&void 0!==c&&c.termsOfServiceUrl&&Be(e.custom.termsOfServiceUrl)}else B("https://www.weiyuai.cn/logo.png"),Xe("https://www.weiyuai.cn/logo.png"),O(s.formatMessage({id:"app.title"})),te(s.formatMessage({id:"pages.layouts.userLayout.title"})),Ye(s.formatMessage({id:"app.title"}))},et=function(e){var t=e.detail.config;console.log("Config updated from server, updating login UI:",t),$e(t)},tt=function(){var e=u()(c()().mark((function e(){var t;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0!==ye&&""!==ye||Me((0,D.Zx)()),e.prev=1,console.log("执行 loadConfig..."),e.next=5,(0,ue.ME)();case 5:return console.log("loadConfig 执行完毕"),console.log("执行 getConfigProperties..."),e.next=9,(0,ue.Xs)();case 9:t=e.sent,console.log("getConfig login config (after loadConfig): ",t),$e(t),window.addEventListener("config-updated",et),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("Error loading config:",e.t0),$e(null);case 19:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(){return e.apply(this,arguments)}}();(0,j.useEffect)((function(){var e=function(){var e=u()(c()().mark((function e(){var t,a;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,D.pr)(),e.next=3,tt();case 3:return e.next=5,ut();case 5:if(!e.sent){e.next=8;break}return e.abrupt("return");case 8:if(t=new URLSearchParams(window.location.search),a=sessionStorage.getItem(L.AvB),!t.get(L.Hox)||!a){e.next=23;break}if(a!==L.zlV){e.next=14;break}return e.next=14,st();case 14:if(a!==L.gXG){e.next=17;break}return e.next=17,ot();case 17:if(a!==L.d9o){e.next=20;break}return e.next=20,it();case 20:if(a!==L.T7R){e.next=23;break}return e.next=23,ct();case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){window.removeEventListener("config-updated",et)}}),[]),(0,j.useEffect)((function(){if(Ie){var e=Qe();if(e.length>0){var t=e[0].key;t&&t!==ge&&fe(t)}}}),[Ie]);var at=function(){var e=u()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(0,Z.flushSync)((function(){pe((function(e){return o()(o()({},e),{},{userInfo:t})}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nt=function(){var e=u()(c()().mark((function e(t){var a,r,l,u,d,g,p,h=arguments;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h.length>1&&void 0!==h[1]&&h[1],r=h.length>2&&void 0!==h[2]&&h[2],e.prev=2,a||je){e.next=6;break}return Je((function(){nt(t,!0,r)})),e.abrupt("return");case 6:return l="loginLoading",n.loading({content:s.formatMessage({id:"logging",defaultMessage:"logging..."}),key:l}),u=new URLSearchParams(window.location.search),d=u.get(L.S__),e.next=12,(0,f.x4)(o()({},t));case 12:g=e.sent,console.log("LoginResult:",g),200===g.code?(n.success({content:s.formatMessage({id:"login.success",defaultMessage:"login success"}),key:l}),ae(g.data.accessToken),at(g.data.user),be(g.data.user),r?x.history.push("/setting/profile?showChangePassword=true"):d?(p=decodeURIComponent(d),console.log("Account login - Redirecting to:",p),x.history.push(p)):x.history.push("/")):n.error({content:i(g.message),key:l}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),console.log(e.t0),n.error(s.formatMessage({id:"login.error",defaultMessage:"login failed"}));case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}(),rt=function(){var e=u()(c()().mark((function e(t){var a,r,i,l,u,d,g,p,h=arguments;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h.length>1&&void 0!==h[1]&&h[1],e.prev=1,a||je){e.next=5;break}return Je((function(){rt(t,!0)})),e.abrupt("return");case 5:return r="mobileLoginLoading",n.loading({content:s.formatMessage({id:"logging",defaultMessage:"logging..."}),key:r}),i=new URLSearchParams(window.location.search),l=i.get(L.S__),e.next=11,(0,f.N9)(o()({},t));case 11:u=e.sent,console.log("LoginMobileResult:",u),200===u.code?(n.success({content:s.formatMessage({id:"login.success",defaultMessage:"login success"}),key:r}),ae(null==u?void 0:u.data.accessToken),at(null==u||null===(d=u.data)||void 0===d?void 0:d.user),be(null==u||null===(g=u.data)||void 0===g?void 0:g.user),l?(p=decodeURIComponent(l),console.log("Mobile login - Redirecting to:",p),x.history.push(p)):x.history.push("/")):n.error({content:s.formatMessage({id:u.message,defaultMessage:u.message}),key:r}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0),n.error(s.formatMessage({id:"login.error",defaultMessage:"login failed"}));case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),st=function(){var e=u()(c()().mark((function e(){var t,a,o,i,l,u,d,g,p,h,m,v,w,y,M;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=new URL(window.location.href),a=t.searchParams.get(L.Hox),o=t.searchParams.get(L.EIi),i=sessionStorage.getItem(L.AvB),!a||i!==L.zlV){e.next=16;break}if(l=null,o)try{(u=JSON.parse(decodeURIComponent(o)))&&"string"==typeof u.redirect&&(l=u.redirect)}catch(e){}return d="githubLoginLoading",n.loading({content:s.formatMessage({id:"logging",defaultMessage:"logging..."}),key:d}),e.next=12,(0,f.eC)({code:a,platform:L.iw8,device:ye});case 12:return g=e.sent,console.log("GitHubLoginResult:",g),200===g.code?(n.success({content:s.formatMessage({id:"login.success",defaultMessage:"login success"}),key:d}),ae(g.data.accessToken),at(g.data.user),be(g.data.user),t.searchParams.delete(L.Hox),t.searchParams.delete(L.EIi),p=t.pathname+(t.searchParams.toString()?"?".concat(t.searchParams.toString()):""),window.history.replaceState({},"",p),sessionStorage.removeItem(L.AvB),l?x.history.push(decodeURIComponent(l)):(h=new URLSearchParams(window.location.search).get(L.S__))?x.history.push(decodeURIComponent(h)):x.history.push("/")):n.error(g.message||"GitHub 登录失败"),e.abrupt("return");case 16:return m=new URLSearchParams(window.location.search),v=m.get(L.S__)||"",w=encodeURIComponent(JSON.stringify(r()(r()(r()({},L.kHe,L.zlV),L.Y1e,Date.now()),L.Gx_,v))),e.next=21,(0,f.Tr)({state:w});case 21:y=e.sent,console.log("GitHub authorize resp:",y,w),200===y.code&&y.data?(sessionStorage.setItem(L.AvB,L.zlV),M=y.data,window.location.href=M):n.error(y.message||"获取 GitHub 授权地址失败"),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(0),console.error("GitHub login error",e.t0),n.error(s.formatMessage({id:"pages.login.oauth.github.error",defaultMessage:"GitHub 登录出错"}));case 30:case"end":return e.stop()}}),e,null,[[0,26]])})));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=u()(c()().mark((function e(){var t,a,o,i,l,u,d,g,p,h,m,v,w,y,M;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=new URL(window.location.href),a=t.searchParams.get(L.Hox),o=t.searchParams.get(L.EIi),i=sessionStorage.getItem(L.AvB),!a||i!==L.gXG){e.next=15;break}if(l=null,o)try{(u=JSON.parse(decodeURIComponent(o)))&&"string"==typeof u.redirect&&(l=u.redirect)}catch(e){}return d="googleLoginLoading",n.loading({content:s.formatMessage({id:"logging",defaultMessage:"logging..."}),key:d}),e.next=12,(0,f.BJ)({code:a,platform:L.iw8,device:ye});case 12:return 200===(g=e.sent).code?(n.success({content:s.formatMessage({id:"login.success",defaultMessage:"login success"}),key:d}),ae(g.data.accessToken),at(g.data.user),be(g.data.user),t.searchParams.delete(L.Hox),t.searchParams.delete(L.EIi),p=t.pathname+(t.searchParams.toString()?"?".concat(t.searchParams.toString()):""),window.history.replaceState({},"",p),sessionStorage.removeItem(L.AvB),l?x.history.push(decodeURIComponent(l)):(h=new URLSearchParams(window.location.search).get(L.S__),x.history.push(h?decodeURIComponent(h):"/"))):n.error(g.message||"Google 登录失败"),e.abrupt("return");case 15:return m=new URLSearchParams(window.location.search),v=m.get(L.S__)||"",w=encodeURIComponent(JSON.stringify(r()(r()(r()({},L.kHe,L.gXG),L.Y1e,Date.now()),L.Gx_,v))),e.next=20,(0,f.mC)({state:w});case 20:200===(y=e.sent).code&&y.data?(sessionStorage.setItem(L.AvB,L.gXG),M=y.data,window.location.href=M):n.error(y.message||"获取 Google 授权地址失败"),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),console.error("Google login error",e.t0),n.error(s.formatMessage({id:"pages.login.oauth.google.error",defaultMessage:"Google 登录出错"}));case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}(),it=function(){var e=u()(c()().mark((function e(){var t,a,o,i,l,u,d,g,p,h,m,v,w,y,M;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=new URL(window.location.href),a=t.searchParams.get("code"),o=t.searchParams.get("state"),i=sessionStorage.getItem(L.AvB),!a||i!==L.d9o){e.next=15;break}if(l=null,o)try{(u=JSON.parse(decodeURIComponent(o)))&&"string"==typeof u.redirect&&(l=u.redirect)}catch(e){}return d="wechatLoginLoading",n.loading({content:s.formatMessage({id:"logging",defaultMessage:"logging..."}),key:d}),e.next=12,(0,f.Ek)({code:a,platform:L.iw8,device:ye});case 12:return 200===(g=e.sent).code?(n.success({content:s.formatMessage({id:"login.success",defaultMessage:"login success"}),key:d}),ae(g.data.accessToken),at(g.data.user),be(g.data.user),t.searchParams.delete("code"),t.searchParams.delete("state"),p=t.pathname+(t.searchParams.toString()?"?".concat(t.searchParams.toString()):""),window.history.replaceState({},"",p),sessionStorage.removeItem(L.AvB),l?x.history.push(decodeURIComponent(l)):(h=new URLSearchParams(window.location.search).get(L.S__),x.history.push(h?decodeURIComponent(h):"/"))):n.error(g.message||"微信登录失败"),e.abrupt("return");case 15:return m=new URLSearchParams(window.location.search),v=m.get(L.S__)||"",w=encodeURIComponent(JSON.stringify(r()(r()(r()({},L.kHe,L.d9o),L.Y1e,Date.now()),L.Gx_,v))),e.next=20,(0,f.aW)({state:w});case 20:200===(y=e.sent).code&&y.data?(sessionStorage.setItem(L.AvB,L.d9o),M=y.data,window.location.href=M):n.error(y.message||"获取微信授权地址失败"),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),console.error("WeChat login error",e.t0),n.error(s.formatMessage({id:"pages.login.oauth.wechat.error",defaultMessage:"微信登录出错"}));case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}(),ct=function(){var e=u()(c()().mark((function e(){var t,a,o,i,l,u,d,g,p,h,m,v,w,y,M;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=new URL(window.location.href),a=t.searchParams.get("code"),o=t.searchParams.get("state"),i=sessionStorage.getItem(L.AvB),!a||i!==L.T7R){e.next=15;break}if(l=null,o)try{(u=JSON.parse(decodeURIComponent(o)))&&"string"==typeof u.redirect&&(l=u.redirect)}catch(e){}return d="facebookLoginLoading",n.loading({content:s.formatMessage({id:"logging",defaultMessage:"logging..."}),key:d}),e.next=12,(0,f.bW)({code:a,platform:L.iw8,device:ye,state:o||void 0});case 12:return 200===(g=e.sent).code?(n.success({content:s.formatMessage({id:"login.success",defaultMessage:"login success"}),key:d}),ae(g.data.accessToken),at(g.data.user),be(g.data.user),t.searchParams.delete("code"),t.searchParams.delete("state"),p=t.pathname+(t.searchParams.toString()?"?".concat(t.searchParams.toString()):""),window.history.replaceState({},"",p),sessionStorage.removeItem(L.AvB),l?x.history.push(decodeURIComponent(l)):(h=new URLSearchParams(window.location.search).get(L.S__),x.history.push(h?decodeURIComponent(h):"/"))):n.error(g.message||"Facebook 登录失败"),e.abrupt("return");case 15:return m=new URLSearchParams(window.location.search),v=m.get(L.S__)||"",w=encodeURIComponent(JSON.stringify(r()(r()(r()({},L.kHe,L.T7R),L.Y1e,Date.now()),L.Gx_,v))),e.next=20,(0,f.Q9)({state:w});case 20:200===(y=e.sent).code&&y.data?(sessionStorage.setItem(L.AvB,L.T7R),M=y.data,window.location.href=M):n.error(y.message||"获取 Facebook 授权地址失败"),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),console.error("Facebook login error",e.t0),n.error(s.formatMessage({id:"pages.login.oauth.facebook.error",defaultMessage:"Facebook 登录出错"}));case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}(),lt=function(){var e=u()(c()().mark((function e(t,a,n){var r,s,i,l,u=arguments;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>3&&void 0!==u[3]&&u[3],s=(0,z.N9)(),i=(0,z.vC)(t.password,s),l={username:t.username,passwordHash:i,passwordSalt:s,captchaUid:a,captchaCode:t.captchaCode,deviceUid:n,platform:L.iw8},xe.Z.debug("login info:",o()({},l)),e.next=7,nt(l,!1,r);case 7:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),ut=function(){var e=u()(c()().mark((function e(){var t,a,r,o,l,u,d;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=new URLSearchParams(window.location.search),a=t.get(L.Cc_),r=t.get(L.S__),console.log("Login page - accessToken:",a),console.log("Login page - redirectPath:",r),!a){e.next=27;break}return console.log("Login page - Found accessToken in URL, validating..."),o="accessTokenValidation",n.loading({content:s.formatMessage({id:"validating",defaultMessage:"验证中..."}),key:o}),e.next=12,(0,f.bf)(a);case 12:if(l=e.sent,console.log("Login page - LoginAccessTokenResult:",l),200!==l.code){e.next=26;break}return n.success({content:s.formatMessage({id:"login.success",defaultMessage:"login success"}),key:o}),ae(l.data.accessToken),at(l.data.user),be(l.data.user),t.delete(L.Cc_),u=window.location.pathname+(t.toString()?"?".concat(t.toString()):""),window.history.replaceState({},"",u),r?(d=decodeURIComponent(r),console.log("Login page - Redirecting to:",d),x.history.push(d)):x.history.push("/"),e.abrupt("return",!0);case 26:n.error({content:i(l.message),key:o});case 27:return e.abrupt("return",!1);case 30:return e.prev=30,e.t0=e.catch(0),console.error("Login page - Error validating accessToken:",e.t0),n.error(s.formatMessage({id:"pages.login.validationError",defaultMessage:"验证访问令牌时出错"})),e.abrupt("return",!1);case 35:case"end":return e.stop()}}),e,null,[[0,30]])})));return function(){return e.apply(this,arguments)}}();return(0,H.jsxs)(m._Y,{hashed:!1,dark:C,children:[(0,H.jsx)(ke,{}),(0,H.jsxs)("div",{style:{backgroundColor:w.colorBgContainer,textAlign:"center",height:"100%",backgroundImage:"url('/admin/assets/images/bg-wide.png')"},children:[!re&&(0,H.jsxs)(v.U,{form:d,contentStyle:{minWidth:400,maxWidth:"75vw"},logo:(0,H.jsx)("img",{alt:"logo",src:_}),title:K,subTitle:X,actions:function(e,t,a,n){var r=!0===(null==Ie||null===(e=Ie.custom)||void 0===e?void 0:e.loginGithubEnable),s=!0===(null==Ie||null===(t=Ie.custom)||void 0===t?void 0:t.loginGoogleEnable),o=!0===(null==Ie||null===(a=Ie.custom)||void 0===a?void 0:a.loginWechatEnable),i=!0===(null==Ie||null===(n=Ie.custom)||void 0===n?void 0:n.loginFacebookEnable);if(r||s||o||i)return(0,H.jsxs)(b.Z,{children:[(0,H.jsx)(x.FormattedMessage,{id:"pages.login.loginWith",defaultMessage:"other loginType"}),r&&(0,H.jsx)(ee.Z,{style:We,onClick:st}),s&&(0,H.jsx)(se,{style:We,onClick:ot}),o&&(0,H.jsx)(oe.Z,{style:We,onClick:it}),i&&(0,H.jsx)(le,{style:We,onClick:ct})]})}(),onFinish:function(){var e=u()(c()().mark((function e(t){var n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(xe.Z.debug("login values:",t),"account"!==ge){e.next=9;break}if(!((0,z.Qc)(t.password)<40)){e.next=6;break}return a.confirm({title:s.formatMessage({id:"pages.login.password.weak.title",defaultMessage:"密码强度提醒"}),content:(0,H.jsxs)("div",{children:[(0,H.jsx)("p",{children:s.formatMessage({id:"pages.login.password.weak.description",defaultMessage:"您当前使用的密码强度较低，存在安全风险。"})}),(0,H.jsx)("p",{children:s.formatMessage({id:"pages.login.password.weak.suggestion",defaultMessage:"建议：包含大小写字母、数字和特殊字符，长度至少8位"})}),(0,H.jsx)("p",{children:s.formatMessage({id:"pages.login.password.weak.confirm",defaultMessage:"是否仍要使用当前密码继续登录？"})})]}),okText:s.formatMessage({id:"pages.login.password.weak.continue",defaultMessage:"继续登录"}),cancelText:s.formatMessage({id:"pages.login.password.weak.modify",defaultMessage:"修改密码"}),onOk:function(){lt(t,Ve,ye)},onCancel:function(){lt(t,Ve,ye,!0)}}),e.abrupt("return");case 6:lt(t,Ve,ye),e.next=13;break;case 9:return n={mobile:t.mobile,country:t.country,code:t.code,captchaUid:Ve,captchaCode:t.captchaCode,deviceUid:ye,platform:L.iw8},console.debug("login mobile info:",n),e.next=13,rt(n);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,H.jsx)(S.Z,{activeKey:ge,onChange:fe,centered:!0,items:Qe()}),(0,H.jsx)("div",{style:{marginTop:14,marginBottom:14},children:(0,H.jsxs)("div",{style:{float:"right",marginBottom:24},children:[(0,H.jsx)(de.Z,{checked:je,onChange:function(e){console.log("checked = ".concat(e.target.checked)),Ze(e.target.checked)},children:(0,H.jsxs)("span",{children:[s.formatMessage({id:"pages.login.privacy.agree",defaultMessage:"同意"}),(0,H.jsx)(k.ZP,{size:"small",type:"link",onClick:He,style:{padding:0,height:"auto"},children:s.formatMessage({id:"pages.login.privacy.privacyPolicy",defaultMessage:"《用户隐私协议》"})}),s.formatMessage({id:"pages.login.privacy.and",defaultMessage:"和"}),(0,H.jsx)(k.ZP,{size:"small",type:"link",onClick:Ge,style:{padding:0,height:"auto"},children:s.formatMessage({id:"pages.login.privacy.termsOfService",defaultMessage:"《服务条款》"})})]})}),!0===(null==Ie||null===(e=Ie.custom)||void 0===e?void 0:e.allowRegister)&&(0,H.jsx)(x.Link,{to:"/auth/register",children:(0,H.jsx)(x.FormattedMessage,{id:"pages.login.registerAccount",defaultMessage:"注册 "})})]})})]}),re&&(0,H.jsx)(me,{}),(0,H.jsx)(we.Q,o()(o()({},T),{},{onInit:function(){console.log("ByteDesk initialized admin")}}))]})]})},Se=function(){var e=(0,R.Z)().isDarkMode;return(0,H.jsx)($.w,{children:(0,H.jsx)(C.ZP,{theme:{algorithm:e?Me:ye},children:(0,H.jsxs)(M.Z,{style:{height:"100%"},children:[(0,H.jsx)(U.ZP,{}),(0,H.jsx)(be,{})]})})})}},75686:function(e,t,a){a.d(t,{$g:function(){return u},N9:function(){return c},Qc:function(){return l},vC:function(){return i}});var n=a(46803),r=a.n(n),s=a(46130);function o(e){return"bytedesk_salt"!==e&&e?r().SHA256(e).toString().substring(0,16):"bytedesk_license"}function i(e,t){if(!e)throw new Error("密码不能为空");if(!t)throw new Error("盐值不能为空");try{var a=o(t),n=r().enc.Utf8.parse(a);return r().AES.encrypt(e,n,{mode:r().mode.ECB,padding:r().pad.Pkcs7}).toString()}catch(e){throw s.Z.error("密码加密失败:",e),new Error("密码加密失败: "+e.message)}}function c(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a="",n=0;n<e;n++)a+=t.charAt(Math.floor(Math.random()*t.length));return a}function l(e){var t=0;return e?(e.length>=8&&(t+=20),e.length>=12&&(t+=10),/\d/.test(e)&&(t+=20),/[a-z]/.test(e)&&(t+=20),/[A-Z]/.test(e)&&(t+=20),/[!@#$%^&*(),.?":{}|<>]/.test(e)&&(t+=10),Math.min(t,100)):0}function u(e){return e>=80?"强":e>=60?"中":e>=40?"弱":"很弱"}}}]);