"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[5159],{2250:function(e,t,a){var r=a(94433),s=a(38956),n=a(51997),o=a(44194),u=a(80228),i=a(35074),l=a(31549),d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var a=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,g=e.mode,h=e.valueEnum,m=e.request,M=e.showSearch,v=e.options,y=(0,s.Z)(e,d),E=(0,o.useContext)(u.Z);return(0,l.jsx)(i.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,n.h)(h),request:m,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({options:v,mode:g,showSearch:M,getPopupContainer:E.getPopupContainer},a),ref:t,proFieldProps:f},y),{},{children:c}))},f=o.forwardRef((function(e,t){var a=e.fieldProps,d=e.children,p=e.params,f=e.proFieldProps,g=e.mode,h=e.valueEnum,m=e.request,M=e.options,v=(0,s.Z)(e,c),y=(0,r.Z)({options:M,mode:g||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},a),E=(0,o.useContext)(u.Z);return(0,l.jsx)(i.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,n.h)(h),request:m,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({getPopupContainer:E.getPopupContainer},y),ref:t,proFieldProps:f},v),{},{children:d}))})),g=o.forwardRef(p);g.SearchSelect=f,g.displayName="ProFormComponent",t.Z=g},89965:function(e,t,a){var r=a(32906),s=a(94433),n=a(38956),o=a(81424),u=a(41196),i=a(63924),l=a(34573),d=a(44194),c=a(35074),p=a(31549),f=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],h="text",m=function(e){var t=(0,o.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),a=(0,r.Z)(t,2),n=a[0],l=a[1];return(0,p.jsx)(u.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var a,r=t.getFieldValue(e.name||[]);return(0,p.jsx)(i.Z,(0,s.Z)((0,s.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return l(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(a=e.statusRender)||void 0===a?void 0:a.call(e,r),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:n,children:e.children}))}})},M=function(e){var t=e.fieldProps,a=e.proFieldProps,r=(0,n.Z)(e,f);return(0,p.jsx)(c.Z,(0,s.Z)({valueType:h,fieldProps:t,filedConfig:{valueType:h},proFieldProps:a},r))};M.Password=function(e){var t=e.fieldProps,a=e.proFieldProps,o=(0,n.Z)(e,g),u=(0,d.useState)(!1),i=(0,r.Z)(u,2),f=i[0],M=i[1];return null!=t&&t.statusRender&&o.name?(0,p.jsx)(m,{name:o.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:M,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:(0,s.Z)((0,s.Z)({},(0,l.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var a;null==t||null===(a=t.onBlur)||void 0===a||a.call(t,e),M(!1)},onClick:function(e){var a;null==t||null===(a=t.onClick)||void 0===a||a.call(t,e),M(!0)}}),proFieldProps:a,filedConfig:{valueType:h}},o))})}):(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:t,proFieldProps:a,filedConfig:{valueType:h}},o))},M.displayName="ProFormComponent",t.Z=M},80953:function(e,t,a){var r=a(94433),s=a(38956),n=a(44194),o=a(35074),u=a(31549),i=["fieldProps","proFieldProps"],l=function(e,t){var a=e.fieldProps,n=e.proFieldProps,l=(0,s.Z)(e,i);return(0,u.jsx)(o.Z,(0,r.Z)({ref:t,valueType:"textarea",fieldProps:a,proFieldProps:n},l))};t.Z=n.forwardRef(l)},75112:function(e,t,a){var r=a(14597);t.Z=function(){var e=(0,r.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},5405:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var r=a(44194),s=a(73193),n=a.n(s),o=a(84176),u=a.n(o),i=a(90819),l=a.n(i),d=a(89933),c=a.n(d),p=a(45332),f=a.n(p),g=a(19433),h=a(14906);function m(e){return M.apply(this,arguments)}function M(){return(M=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/query/org",{method:"GET",params:n()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return y.apply(this,arguments)}function y(){return(y=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/create",{method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return x.apply(this,arguments)}function x(){return(x=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/update",{method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return I.apply(this,arguments)}function I(){return(I=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/delete",{method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=a(10162),C=a(89246),P=a(82770),b=a(98830),Z=a(25784),w=a(2250),L=a(89965),T=a(80953),A=a(41196),O=a(82864),_=a(39487),F=a(31549),N=function(e){var t=e.isEdit,a=e.push,s=e.open,o=e.onClose,u=e.onSubmit,i=A.Z.useForm(),l=f()(i,1)[0],d=(0,b.u)((function(e){return e.currentOrg})),c=(0,h.useIntl)();(0,r.useEffect)((function(){t&&a?l.setFieldsValue({type:a.type,receiver:a.receiver,content:a.content}):l.resetFields()}),[s]);return(0,F.jsx)(F.Fragment,{children:(0,F.jsx)(O.Z,{title:t?c.formatMessage({id:"pages.push.edit",defaultMessage:"Edit Push"}):c.formatMessage({id:"pages.push.create",defaultMessage:"Create Push"}),onClose:o,open:s,extra:(0,F.jsxs)(_.Z,{children:[(0,F.jsx)(P.ZP,{onClick:o,children:c.formatMessage({id:"pages.push.cancel",defaultMessage:"Cancel"})}),(0,F.jsx)(P.ZP,{onClick:function(){console.log("handleSubmit"),l.validateFields().then((function(e){console.log(e),u(n()(n()({},e),{},{uid:null==a?void 0:a.uid,orgUid:null==d?void 0:d.uid}))})).catch((function(e){console.log("Form errors:",e),g.yw.error(c.formatMessage({id:"pages.form.error",defaultMessage:"Please check the form inputs"}))}))},type:"primary",children:c.formatMessage({id:"pages.push.submit",defaultMessage:"Submit"})})]}),children:(0,F.jsxs)(Z.A,{form:l,initialValues:n()({},a),submitter:{render:function(){return null}},children:[(0,F.jsx)(w.Z,{label:c.formatMessage({id:"pages.push.type",defaultMessage:"Type"}),name:"type",rules:[{required:!0,message:c.formatMessage({id:"pages.push.type",defaultMessage:"Type"})}],options:[{label:"MOBILE_REGISTER",value:"MOBILE_REGISTER"},{label:"MOBILE_LOGIN",value:"MOBILE_LOGIN"},{label:"MOBILE_RESET",value:"MOBILE_RESET"},{label:"MOBILE_VERIFY",value:"MOBILE_VERIFY"},{label:"EMAIL_REGISTER",value:"EMAIL_REGISTER"},{label:"EMAIL_LOGIN",value:"EMAIL_LOGIN"},{label:"EMAIL_RESET",value:"EMAIL_RESET"},{label:"EMAIL_VERIFY",value:"EMAIL_VERIFY"},{label:"USERNAME_REGISTER",value:"USERNAME_REGISTER"},{label:"USERNAME_LOGIN",value:"USERNAME_LOGIN"},{label:"USERNAME_RESET",value:"USERNAME_RESET"},{label:"USERNAME_VERIFY",value:"USERNAME_VERIFY"},{label:"SCAN_LOGIN",value:"SCAN_LOGIN"}],fieldProps:{allowClear:!0,placeholder:c.formatMessage({id:"pages.push.type",defaultMessage:"Type"})}}),(0,F.jsx)(L.Z,{label:c.formatMessage({id:"pages.push.receiver",defaultMessage:"Receiver"}),name:"receiver",rules:[{required:!0,message:c.formatMessage({id:"pages.push.receiver",defaultMessage:"Receiver"})}]}),(0,F.jsx)(T.Z,{label:c.formatMessage({id:"pages.push.content",defaultMessage:"Content"}),name:"content",rules:[{required:!0,message:c.formatMessage({id:"pages.push.content",defaultMessage:"Content"})}]})]})})})},B=a(26138),j=a(96596),k=a.n(j),G=a(55722),U=["current"],z=function(){var e=(0,h.useIntl)(),t=(0,r.useRef)(),a=(0,r.useState)(!0),s=f()(a,2),o=s[0],i=s[1],d=(0,r.useState)(),p=f()(d,2),M=p[0],y=p[1],x=(0,r.useState)(!1),I=f()(x,2),Z=I[0],w=I[1],L=(0,b.u)((function(e){return e.currentOrg})),T=(0,G.L)((function(e){return e.userInfo})),A=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:e.formatMessage({id:"pages.push.sender",defaultMessage:"Sender"}),dataIndex:"sender",copyable:!0,hideInSearch:!0},{title:e.formatMessage({id:"pages.push.content",defaultMessage:"Content"}),dataIndex:"content",copyable:!0},{title:e.formatMessage({id:"pages.push.receiver",defaultMessage:"Receiver"}),dataIndex:"receiver",copyable:!0},{title:e.formatMessage({id:"pages.push.type",defaultMessage:"Type"}),dataIndex:"type",valueType:"select",initialValue:"MOBILE_LOGIN",valueEnum:{MOBILE_REGISTER:{text:e.formatMessage({id:"pages.push.type.mobileRegister",defaultMessage:"手机号注册"})},MOBILE_LOGIN:{text:e.formatMessage({id:"pages.push.type.mobileLogin",defaultMessage:"手机号登录"})},MOBILE_RESET:{text:e.formatMessage({id:"pages.push.type.mobileReset",defaultMessage:"手机号重置"})},MOBILE_VERIFY:{text:e.formatMessage({id:"pages.push.type.mobileVerify",defaultMessage:"手机号验证"})},EMAIL_REGISTER:{text:e.formatMessage({id:"pages.push.type.emailRegister",defaultMessage:"邮箱注册"})},EMAIL_LOGIN:{text:e.formatMessage({id:"pages.push.type.emailLogin",defaultMessage:"邮箱登录"})},EMAIL_RESET:{text:e.formatMessage({id:"pages.push.type.emailReset",defaultMessage:"邮箱重置"})},EMAIL_VERIFY:{text:e.formatMessage({id:"pages.push.type.emailVerify",defaultMessage:"邮箱验证"})},USERNAME_REGISTER:{text:e.formatMessage({id:"pages.push.type.usernameRegister",defaultMessage:"用户名注册"})},USERNAME_LOGIN:{text:e.formatMessage({id:"pages.push.type.usernameLogin",defaultMessage:"用户名登录"})},USERNAME_RESET:{text:e.formatMessage({id:"pages.push.type.usernameReset",defaultMessage:"用户名重置"})},USERNAME_VERIFY:{text:e.formatMessage({id:"pages.push.type.usernameVerify",defaultMessage:"用户名验证"})},SCAN_LOGIN:{text:e.formatMessage({id:"pages.push.type.scanLogin",defaultMessage:"扫码登录"})}}},{title:e.formatMessage({id:"pages.push.status",defaultMessage:"Status"}),dataIndex:"status",valueType:"select",valueEnum:{PENDING:{text:e.formatMessage({id:"pages.push.status.pending",defaultMessage:"待处理"}),status:"Processing"},SCANNED:{text:e.formatMessage({id:"pages.push.status.scanned",defaultMessage:"已扫描"}),status:"Warning"},CONFIRMED:{text:e.formatMessage({id:"pages.push.status.confirmed",defaultMessage:"已确认"}),status:"Success"},EXPIRED:{text:e.formatMessage({id:"pages.push.status.expired",defaultMessage:"已过期"}),status:"Default"},SUCCESS:{text:e.formatMessage({id:"pages.push.status.success",defaultMessage:"成功"}),status:"Success"},FAILURE:{text:e.formatMessage({id:"pages.push.status.failure",defaultMessage:"失败"}),status:"Error"}}},{title:e.formatMessage({id:"pages.push.createdAt",defaultMessage:"Created At"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.createdAt?k()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):""}},{title:e.formatMessage({id:"actions"}),valueType:"option",key:"option",width:100,render:function(a,r,s,n){return[(0,F.jsx)("a",{onClick:function(){j(r)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,F.jsx)("a",{style:{color:"#ff4d4f",marginLeft:8},onClick:c()(l()().mark((function a(){var s,n,o;return l()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.uid){a.next=2;break}return a.abrupt("return");case 2:return g.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),a.next=5,R({uid:r.uid});case 5:s=a.sent,g.yw.destroy(),200===s.code?(g.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete successful"})),null===(n=t.current)||void 0===n||null===(o=n.reloadAndRest)||void 0===o||o.call(n)):g.yw.error(s.message||e.formatMessage({id:"delete.error",defaultMessage:"Delete failed"}));case 8:case"end":return a.stop()}}),a)}))),children:e.formatMessage({id:"delete",defaultMessage:"Delete"})},"delete")]}}],O=(0,B.v)((function(e){return e.currentCategory})),_=function(){y(void 0),i(!1),w(!0)},j=function(e){y(e),i(!0),w(!0)},z=function(){var a=c()(l()().mark((function a(r){var s,n,u;return l()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o?g.yw.loading(e.formatMessage({id:"updating",defaultMessage:"Updating..."})):g.yw.loading(e.formatMessage({id:"creating",defaultMessage:"Creating..."})),!o){a.next=7;break}return a.next=4,E(r);case 4:a.t0=a.sent,a.next=10;break;case 7:return a.next=9,v(r);case 9:a.t0=a.sent;case 10:s=a.t0,g.yw.destroy(),200===s.code?(g.yw.success(e.formatMessage({id:o?"update.success":"create.success",defaultMessage:o?"Update successful":"Create successful"})),w(!1),null===(n=t.current)||void 0===n||null===(u=n.reloadAndRest)||void 0===u||u.call(n)):g.yw.error(s.message||e.formatMessage({id:o?"update.error":"create.error",defaultMessage:o?"Update failed":"Create failed"}));case 13:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return(0,r.useEffect)((function(){var e;console.log("currentCategory:",O),null===(e=t.current)||void 0===e||e.reloadAndRest()}),[O]),(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(C.Z,{columns:A,actionRef:t,cardBordered:!0,request:function(){var t=c()(l()().mark((function t(a,r,s){var o,i,d;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",a,r,s),g.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),a.current,o=u()(a,U),i=n()({pageNumber:(a.current||1)-1,pageSize:a.pageSize,orgUid:null==L?void 0:L.uid,superUser:null==T?void 0:T.superUser},o),t.next=6,m(i);case 6:return d=t.sent,console.log("getAllPushs response:",i,d),g.yw.destroy(),200===d.code||g.yw.error(d.message),t.abrupt("return",{data:d.data.content,success:!0,total:d.data.totalElements});case 11:case"end":return t.stop()}}),t)})));return function(e,a,r){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"pages.push.list",defaultMessage:"Push Records"}),toolBarRender:function(){return[(0,F.jsx)(P.ZP,{icon:(0,F.jsx)(S.Z,{}),type:"primary",onClick:_,children:e.formatMessage({id:"create",defaultMessage:"Create"})},"button")]}}),(0,F.jsx)(N,{isEdit:o,open:Z,push:M,onClose:function(){w(!1)},onSubmit:z})]})},V=a(21563),q=a(75112),D=V.Z.Content,Y=function(){var e=(0,q.Z)().contentStyle;return(0,F.jsx)(V.Z,{children:(0,F.jsx)(D,{style:e,children:(0,F.jsx)(z,{})})})}},26138:function(e,t,a){a.d(t,{v:function(){return g}});var r=a(86222),s=a.n(r),n=a(73193),o=a.n(n),u=a(76711),i=a.n(u),l=a(39497),d=a(58063),c=a(66266),p=a(31403),f=a(23753);var g=(0,d.Ue)()((0,c.mW)((0,c.tJ)((0,p.n)((function(e,t){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:l.zBg,name:l.zBg},setCategoryResult:function(t){var a=function(e){var t=[];return e.data.content.forEach((function(e){var a={label:e.name,value:e.uid};t.push(a)})),t}(t),r=function(e){var t,a=(null==e||null===(t=e.data)||void 0===t?void 0:t.content)||[],r=function e(t){var a={title:t.name||"",key:t.uid||""};return t.children&&t.children.length>0&&(a.children=t.children.map((function(t){return e(t)}))),a};return a.filter((function(e){return e&&e.uid&&e.uid!==l.zBg})).map((function(e){return r(e)}))}(t),s=[{title:l.zBg,key:l.zBg}].concat(i()(r)),n={uid:l.zBg,name:l.zBg},u=o()(o()({},t),{},{data:o()(o()({},t.data),{},{content:[n].concat(i()(t.data.content))})});e({categoryResult:u,categoryTreeOptions:s,categorySelectOptions:a}),0===t.data.content.length&&e({currentCategory:{uid:l.zBg,name:l.zBg}})},insertCategory:function(t){e((function(e){e.categoryResult.data.content.unshift(t)}))},upgradeCategory:function(t){e((function(e){var a=e.categoryResult.data.content,r=a.findIndex((function(e){return e.uid===t.uid}));-1!==r?a[r]=t:console.warn("Category with uid ".concat(t.uid," not found."))}))},setCurrentCategory:function(t){e({currentCategory:t})},resetDefaultCategory:function(){f.Z.log("resetDefaultCategory"),e({currentCategory:{uid:l.zBg,name:l.zBg}})},setCurrentCategoryUid:function(a){if(a!==l.zBg){var r=function e(t,a){if(t&&0!==t.length){var r,n=s()(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;if((null==o?void 0:o.uid)===a)return o;var u=e(null==o?void 0:o.children,a);if(u)return u}}catch(e){n.e(e)}finally{n.f()}}}(t().categoryResult.data.content,a);e({currentCategory:null!=r?r:{uid:l.zBg,name:l.zBg}})}else e({currentCategory:{uid:l.zBg,name:l.zBg}})},deleteCategoryCache:function(){return e({},!0)}}})),{name:l.OMm})))}}]);