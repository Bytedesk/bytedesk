"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[7444],{6203:function(e,r,t){t.d(r,{D$:function(){return h},ZQ:function(){return M},eg:function(){return d},nd:function(){return b},s:function(){return v},zM:function(){return m}});var n=t(90819),a=t.n(n),s=t(73193),i=t.n(s),o=t(89933),u=t.n(o),c=t(39497),l=t(14906);function d(e){return p.apply(this,arguments)}function p(){return(p=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/email/query/org",{method:"GET",params:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return(f=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/email/query/uid",{method:"GET",params:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return g.apply(this,arguments)}function g(){return(g=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/email/create",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return(x=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/email/update",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return Z.apply(this,arguments)}function Z(){return(Z=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/email/delete",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return y.apply(this,arguments)}function y(){return(y=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/email/sync/start",{method:"POST",params:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},77098:function(e,r,t){t.d(r,{JP:function(){return v},Nf:function(){return h},PA:function(){return b},Z_:function(){return d},cG:function(){return m},k2:function(){return w},kO:function(){return M},sc:function(){return j}});var n=t(90819),a=t.n(n),s=t(73193),i=t.n(s),o=t(89933),u=t.n(o),c=t(39497),l=t(14906);function d(){return p.apply(this,arguments)}function p(){return(p=u()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/email",{method:"GET",params:{channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return(f=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/email",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return g.apply(this,arguments)}function g(){return(g=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/email/test",{method:"POST",params:{testEmail:r,channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return x.apply(this,arguments)}function x(){return(x=u()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/sms",{method:"GET",params:{channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return Z.apply(this,arguments)}function Z(){return(Z=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/sms",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return y.apply(this,arguments)}function y(){return(y=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/sms/test",{method:"POST",params:{testMobile:r,channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return k.apply(this,arguments)}function k(){return(k=u()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/ticket-center",{method:"GET",params:{channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return S.apply(this,arguments)}function S(){return(S=u()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/ticket-center",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},75112:function(e,r,t){var n=t(14597);r.Z=function(){var e=(0,n.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},74595:function(e,r,t){t.r(r);var n=t(90819),a=t.n(n),s=t(89933),i=t.n(s),o=t(45332),u=t.n(o),c=t(44194),l=t(13847),d=t(41196),p=t(59533),m=t(65207),f=t(40110),h=t(39487),g=t(82770),v=t(70635),x=t(66431),b=t(62640),Z=t(81739),M=t(40122),y=t(86895),j=t(32525),k=t(80556),w=t(77647),S=t(55785),P=t(77098),q=t(6203),T=t(75112),E=t(14906),C=t(31549),J=l.Z.Option;r.default=function(){var e=d.Z.useForm(),r=u()(e,1)[0],t=(0,c.useState)(!1),n=u()(t,2),s=n[0],o=n[1],X=(0,c.useState)(!1),I=u()(X,2),O=I[0],F=I[1],U=(0,c.useState)(!1),G=u()(U,2),z=G[0],L=G[1],N=(0,c.useState)(!1),_=u()(N,2),A=_[0],H=_[1],B=(0,c.useState)(""),D=u()(B,2),R=D[0],V=D[1],Q=(0,c.useState)([]),W=u()(Q,2),$=W[0],K=W[1],Y=(0,c.useState)(!1),ee=u()(Y,2),re=ee[0],te=ee[1],ne=(0,c.useState)(null),ae=u()(ne,2),se=ae[0],ie=ae[1],oe=(0,T.Z)().contentStyle,ue=(0,E.useIntl)(),ce=function(){var e=i()(a()().mark((function e(){var t,n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,(0,P.Z_)();case 4:200===(null==(t=e.sent)?void 0:t.code)&&t.data&&(r.setFieldsValue({emailUid:t.data.emailUid,emailEnabled:null!==(n=t.data.emailEnabled)&&void 0!==n&&n,description:t.data.description}),t.data.emailUid&&le(t.data.emailUid)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("加载邮件配置失败:",e.t0),p.ZP.error(ue.formatMessage({id:"super.email.message.loadSettingsFailed"}));case 12:return e.prev=12,o(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=i()(a()().mark((function e(r){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,q.zM)({uid:r});case 3:200===(null==(t=e.sent)?void 0:t.code)&&t.data&&ie(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("加载邮箱详情失败:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r){return e.apply(this,arguments)}}(),de=function(){var e=i()(a()().mark((function e(){var r,t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(!0),e.prev=1,e.next=4,(0,q.eg)({orgUid:"df_org_uid",pageNumber:0,pageSize:100});case 4:200===(null==(t=e.sent)?void 0:t.code)&&null!==(r=t.data)&&void 0!==r&&r.content&&K(t.data.content),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("加载邮箱列表失败:",e.t0),p.ZP.error(ue.formatMessage({id:"super.email.message.loadEmailsFailed"}));case 12:return e.prev=12,te(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){ce(),de()}),[]);var pe=function(){var e=i()(a()().mark((function e(){var t,n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.validateFields();case 3:return t=e.sent,F(!0),e.next=7,(0,P.cG)({emailUid:t.emailUid,emailEnabled:t.emailEnabled,description:t.description});case 7:200===(null==(n=e.sent)?void 0:n.code)?(p.ZP.success(ue.formatMessage({id:"super.email.message.saveSuccess"})),ce()):p.ZP.error((null==n?void 0:n.message)||ue.formatMessage({id:"super.email.message.saveFailed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("保存邮件配置失败:",e.t0),p.ZP.error(ue.formatMessage({id:"super.email.message.saveFailed"}));case 15:return e.prev=15,F(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=i()(a()().mark((function e(){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(R){e.next=3;break}return p.ZP.warning(ue.formatMessage({id:"super.email.message.testEmailRequired"})),e.abrupt("return");case 3:return L(!0),e.prev=4,e.next=7,(0,P.Nf)(R);case 7:200===(null==(r=e.sent)?void 0:r.code)?(p.ZP.success((null==r?void 0:r.data)||ue.formatMessage({id:"super.email.message.testSuccess"})),H(!1),V("")):p.ZP.error((null==r?void 0:r.message)||ue.formatMessage({id:"super.email.message.testFailed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("测试邮件发送失败:",e.t0),p.ZP.error(ue.formatMessage({id:"super.email.message.testFailed"}));case 15:return e.prev=15,L(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,11,15,18]])})));return function(){return e.apply(this,arguments)}}();return(0,C.jsxs)("div",{style:oe,children:[(0,C.jsx)(m.Z,{spinning:s,children:(0,C.jsxs)(f.Z,{title:ue.formatMessage({id:"super.email.title"}),extra:(0,C.jsxs)(h.Z,{children:[(0,C.jsx)(g.ZP,{icon:(0,C.jsx)(k.Z,{}),onClick:function(){ce(),de()},children:ue.formatMessage({id:"super.common.refresh"})}),(0,C.jsx)(g.ZP,{icon:(0,C.jsx)(w.Z,{}),onClick:function(){return H(!0)},disabled:!se,children:ue.formatMessage({id:"super.common.test"})}),(0,C.jsx)(g.ZP,{type:"primary",icon:(0,C.jsx)(S.Z,{}),loading:O,onClick:pe,children:ue.formatMessage({id:"super.common.save"})})]}),children:[(0,C.jsx)(v.Z,{message:ue.formatMessage({id:"super.common.alert.title"}),description:(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{children:ue.formatMessage({id:"super.email.alert.desc1"})}),(0,C.jsx)("p",{children:ue.formatMessage({id:"super.email.alert.desc2"})})]}),type:"info",showIcon:!0,style:{marginBottom:24}}),(0,C.jsxs)(d.Z,{form:r,layout:"vertical",initialValues:{emailEnabled:!1},children:[(0,C.jsx)(d.Z.Item,{name:"emailEnabled",label:ue.formatMessage({id:"super.common.enableConfig"}),valuePropName:"checked",children:(0,C.jsx)(x.Z,{checkedChildren:ue.formatMessage({id:"super.common.enabled"}),unCheckedChildren:ue.formatMessage({id:"super.common.disabled"})})}),(0,C.jsx)(b.Z,{orientation:"left",children:ue.formatMessage({id:"super.email.divider.account"})}),(0,C.jsx)(d.Z.Item,{name:"emailUid",label:ue.formatMessage({id:"super.email.form.account.label"}),rules:[{required:!0,message:ue.formatMessage({id:"super.email.form.account.required"})}],tooltip:ue.formatMessage({id:"super.email.form.account.tooltip"}),extra:(0,C.jsxs)(h.Z,{style:{marginTop:8},children:[(0,C.jsx)("span",{children:ue.formatMessage({id:"super.email.account.count"},{count:$.length})}),(0,C.jsx)(g.ZP,{type:"link",size:"small",onClick:de,loading:re,children:ue.formatMessage({id:"super.common.refreshList"})})]}),children:(0,C.jsx)(l.Z,{placeholder:ue.formatMessage({id:"super.email.form.account.placeholder"}),loading:re,showSearch:!0,optionFilterProp:"children",onChange:function(e){var r=$.find((function(r){return r.uid===e}));ie(r||null)},filterOption:function(e,r){var t;return null==r||null===(t=r.children)||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase())},children:$.map((function(e){return(0,C.jsx)(J,{value:e.uid,children:(0,C.jsxs)(h.Z,{children:[(0,C.jsx)("span",{children:e.name||e.emailAddress}),e.enabled?(0,C.jsx)(Z.Z,{color:"green",children:ue.formatMessage({id:"super.common.enabled"})}):(0,C.jsx)(Z.Z,{color:"default",children:ue.formatMessage({id:"super.common.disabled"})}),(0,C.jsx)(Z.Z,{color:"blue",children:e.provider})]})},e.uid)}))})}),se&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.Z,{orientation:"left",children:ue.formatMessage({id:"super.email.detail.title"})}),(0,C.jsx)(f.Z,{size:"small",style:{marginBottom:24},children:(0,C.jsxs)(M.Z,{column:2,size:"small",children:[(0,C.jsx)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.name"}),children:se.name}),(0,C.jsx)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.address"}),children:se.emailAddress}),(0,C.jsx)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.provider"}),children:se.provider}),(0,C.jsx)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.protocol"}),children:se.protocol}),(0,C.jsxs)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.smtp"}),children:[se.smtpHost,":",se.smtpPort]}),(0,C.jsx)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.senderName"}),children:se.senderName}),(0,C.jsx)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.ssl"}),children:se.smtpSslEnabled?(0,C.jsx)(Z.Z,{color:"green",children:ue.formatMessage({id:"super.common.enabled"})}):(0,C.jsx)(Z.Z,{color:"default",children:ue.formatMessage({id:"super.common.disabled"})})}),(0,C.jsx)(M.Z.Item,{label:ue.formatMessage({id:"super.email.detail.status"}),children:se.enabled?(0,C.jsx)(Z.Z,{color:"green",children:ue.formatMessage({id:"super.common.enabled"})}):(0,C.jsx)(Z.Z,{color:"red",children:ue.formatMessage({id:"super.common.disabled"})})})]})})]})]})]})}),(0,C.jsx)(y.Z,{title:ue.formatMessage({id:"super.email.testModal.title"}),open:A,onOk:me,onCancel:function(){H(!1),V("")},confirmLoading:z,okText:ue.formatMessage({id:"super.common.modal.send"}),cancelText:ue.formatMessage({id:"cancel"}),children:(0,C.jsx)(d.Z,{layout:"vertical",children:(0,C.jsx)(d.Z.Item,{label:ue.formatMessage({id:"super.email.testModal.emailLabel"}),required:!0,help:ue.formatMessage({id:"super.email.testModal.emailHelp"}),children:(0,C.jsx)(j.Z,{value:R,onChange:function(e){return V(e.target.value)},placeholder:ue.formatMessage({id:"super.email.testModal.placeholder"})})})})})]})}}}]);