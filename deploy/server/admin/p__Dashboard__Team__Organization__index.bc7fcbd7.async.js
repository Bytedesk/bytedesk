"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4822],{10577:function(e,r,n){n.d(r,{Z:function(){return l}});var o=n(83910),t=n(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M894 462c30.9 0 43.8-39.7 18.7-58L530.8 126.2a31.81 31.81 0 00-37.6 0L111.3 404c-25.1 18.2-12.2 58 18.8 58H192v374h-72c-4.4 0-8 3.6-8 8v52c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-52c0-4.4-3.6-8-8-8h-72V462h62zM512 196.7l271.1 197.2H240.9L512 196.7zM264 462h117v374H264V462zm189 0h117v374H453V462zm307 374H642V462h118v374z"}}]},name:"bank",theme:"outlined"},i=n(5901),s=function(e,r){return t.createElement(i.Z,(0,o.Z)({},e,{ref:r,icon:a}))};var l=t.forwardRef(s)},11575:function(e,r,n){var o=n(83910),t=n(44194),a=n(85333),i=n(5901),s=function(e,r){return t.createElement(i.Z,(0,o.Z)({},e,{ref:r,icon:a.Z}))},l=t.forwardRef(s);r.Z=l},22014:function(e,r,n){n.d(r,{Z:function(){return l}});var o=n(83910),t=n(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},i=n(5901),s=function(e,r){return t.createElement(i.Z,(0,o.Z)({},e,{ref:r,icon:a}))};var l=t.forwardRef(s)},47268:function(e,r,n){var o=n(32906),t=n(94433),a=n(38956),i=n(92032),s=n(70878),l=n(35068),d=n(21762),c=n(44194),u=n(46659),f=n(31549),p=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],h="text",x=function(e){var r=(0,i.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),n=(0,o.Z)(r,2),a=n[0],d=n[1];return(0,f.jsx)(s.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(r){var n,o=r.getFieldValue(e.name||[]);return(0,f.jsx)(l.Z,(0,t.Z)((0,t.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return d(e)},content:(0,f.jsxs)("div",{style:{padding:"4px 0"},children:[null===(n=e.statusRender)||void 0===n?void 0:n.call(e,o),e.strengthText?(0,f.jsx)("div",{style:{marginTop:10},children:(0,f.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:a,children:e.children}))}})},m=function(e){var r=e.fieldProps,n=e.proFieldProps,o=(0,a.Z)(e,p);return(0,f.jsx)(u.Z,(0,t.Z)({valueType:h,fieldProps:r,filedConfig:{valueType:h},proFieldProps:n},o))};m.Password=function(e){var r=e.fieldProps,n=e.proFieldProps,i=(0,a.Z)(e,g),s=(0,c.useState)(!1),l=(0,o.Z)(s,2),p=l[0],m=l[1];return null!=r&&r.statusRender&&i.name?(0,f.jsx)(x,{name:i.name,statusRender:null==r?void 0:r.statusRender,popoverProps:null==r?void 0:r.popoverProps,strengthText:null==r?void 0:r.strengthText,open:p,onOpenChange:m,children:(0,f.jsx)("div",{children:(0,f.jsx)(u.Z,(0,t.Z)({valueType:"password",fieldProps:(0,t.Z)((0,t.Z)({},(0,d.Z)(r,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var n;null==r||null===(n=r.onBlur)||void 0===n||n.call(r,e),m(!1)},onClick:function(e){var n;null==r||null===(n=r.onClick)||void 0===n||n.call(r,e),m(!0)}}),proFieldProps:n,filedConfig:{valueType:h}},i))})}):(0,f.jsx)(u.Z,(0,t.Z)({valueType:"password",fieldProps:r,proFieldProps:n,filedConfig:{valueType:h}},i))},m.displayName="ProFormComponent",r.Z=m},26608:function(e,r,n){var o=n(94433),t=n(38956),a=n(44194),i=n(46659),s=n(31549),l=["fieldProps","proFieldProps"],d=function(e,r){var n=e.fieldProps,a=e.proFieldProps,d=(0,t.Z)(e,l);return(0,s.jsx)(i.Z,(0,o.Z)({ref:r,valueType:"textarea",fieldProps:n,proFieldProps:a},d))};r.Z=a.forwardRef(d)},65041:function(e,r,n){n.d(r,{G:function(){return p}});var o=n(73193),t=n.n(o),a=(n(44194),n(2348)),i=n(68992),s=n(45634),l=n.n(s),d=n(46130),c=n(61489),u=n(87005),f=n(31549),p=function(e){var r=e.children,n=e.onSuccess,o=e.onError,s={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:i.IrL,categoryUid:"",kbUid:"",channel:i.XtJ},p={name:"file",accept:"image/*",action:(0,u.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(i.LA8)},data:s,showUploadList:!1,beforeUpload:function(e){d.Z.log("beforeUpload",e);var r=l()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return s.file=e,s.fileName=r,s.fileType=e.type,d.Z.log("beforeUpload",s),!0},onChange:function(e){if("uploading"!==e.file.status&&d.Z.log("not uploading:",e.file),"done"===e.file.status)if(d.Z.log("response: ",e.file.response),200===e.file.response.code){var r=e.file.response.data.fileUrl;n(r),c.yw.success("".concat(e.file.name," 上传成功"))}else o(e.file),c.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(c.yw.error("".concat(e.file.name," 上传失败")),o(e.file))}};return(0,f.jsx)(a.Z,t()(t()({},p),{},{children:r}))}},63297:function(e,r,n){n.r(r);var o=n(90819),t=n.n(o),a=n(73193),i=n.n(a),s=n(89933),l=n.n(s),d=n(45332),c=n.n(d),u=n(61489),f=n(23712),p=n(77686),g=n(65041),h=n(10577),x=n(22014),m=n(11575),v=n(89007),Z=n(47268),y=n(26608),b=n(62395),j=n(69650),w=n(70878),z=n(63052),P=n(21478),M=n(22888),C=n(89654),k=n(27401),T=n(72264),R=n(44194),S=n(25130),F=n(70097),O=n(31549),H=j.Z.Title,V=j.Z.Text;r.default=function(){var e=w.Z.useForm(),r=c()(e,1)[0],n=(0,b.useIntl)(),o=(0,F.Z)().isDarkMode,a=((0,b.useModel)("@@initialState").initialState||{}).userInfo,s=(0,p.u)((function(e){return{currentOrg:e.currentOrg,setCurrentOrg:e.setCurrentOrg}})),d=s.currentOrg,j=s.setCurrentOrg,B=(0,R.useState)(""),U=c()(B,2),E=U[0],L=U[1],q=(0,R.useState)(!1),A=c()(q,2),I=A[0],N=A[1],D=function(){var e=l()(t()().mark((function e(r){var o,a,s,l,c,p=arguments;return t()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=p.length>1&&void 0!==p[1]?p[1]:"save",a=p.length>2?p[2]:void 0,u.yw.loading({content:n.formatMessage({id:"saving"}),key:o,duration:0}),e.prev=3,s=i()(i()({},d),r),console.log("saveOrganization orgObject:",s),e.next=8,(0,f.RL)(s);case 8:if(l=e.sent,console.log("saveOrganization response:",l),200!==l.code){e.next=19;break}return u.yw.destroy(),c=a||n.formatMessage({id:"update.success"}),u.yw.success(c),j(l.data),r.logo&&L(l.data.logo||r.logo),e.abrupt("return",!0);case 19:return u.yw.destroy(),u.yw.error(l.message),e.abrupt("return",!1);case 22:e.next=30;break;case 24:return e.prev=24,e.t0=e.catch(3),u.yw.destroy(),u.yw.error(n.formatMessage({id:"save.failed"})),console.error("saveOrganization error:",e.t0),e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,null,[[3,24]])})));return function(r){return e.apply(this,arguments)}}(),W=function(){var e=l()(t()().mark((function e(o){var a,s;return t()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleUploadSuccess:",o),L(o),a=r.getFieldsValue(),s=i()(i()({},a),{},{logo:o}),e.next=6,D(s,"save-logo",n.formatMessage({id:"organization.logo.upload.success"}));case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Y=function(){var e=l()(t()().mark((function e(r){var n;return t()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i()(i()({},r),{},{logo:E}),e.next=3,D(n);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();(0,R.useEffect)((function(){a&&(a.currentOrganization?j(a.currentOrganization):N(!0))}),[a,j]),(0,R.useEffect)((function(){d&&(L(d.logo),r.setFieldsValue({name:d.name,code:d.code,description:d.description}))}),[d,r]);var G=function(e){j(e),window.location.reload()};return d?(0,O.jsx)("div",{style:{padding:"24px",backgroundColor:o?"#141414":"#f0f2f5",minHeight:"100vh"},children:(0,O.jsxs)(z.Z,{variant:"borderless",style:{maxWidth:800,margin:"0 auto",borderRadius:"12px",boxShadow:o?"0 2px 8px rgba(255, 255, 255, 0.08)":"0 2px 8px rgba(0, 0, 0, 0.1)",backgroundColor:o?"#1f1f1f":"#ffffff"},children:[(0,O.jsxs)(H,{level:2,style:{marginBottom:"24px",textAlign:"center"},children:[(0,O.jsx)(h.Z,{style:{marginRight:"8px",color:"#1890ff"}}),n.formatMessage({id:"organization.title"})]}),(0,O.jsx)(z.Z,{size:"small",style:{marginBottom:"24px",backgroundColor:o?"#262626":"#fafafa",borderRadius:"8px"},children:(0,O.jsx)(P.Z,{justify:"center",align:"middle",style:{padding:"20px 0"},children:(0,O.jsx)(M.Z,{children:(0,O.jsxs)(C.Z,{direction:"vertical",align:"center",size:"large",children:[(0,O.jsx)(k.Z,{src:E,size:100,style:{border:"4px solid #fff",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}}),(0,O.jsx)(g.G,{onSuccess:W,onError:function(e){console.log("handleUploadError:",e)},children:(0,O.jsx)(T.ZP,{type:"primary",icon:(0,O.jsx)(x.Z,{}),style:{borderRadius:"20px"},children:n.formatMessage({id:"organization.upload.logo"})})},"avatar")]})})})}),(0,O.jsx)(v.A,{form:r,onFinish:Y,submitter:{render:function(e,r){return(0,O.jsx)(P.Z,{justify:"center",style:{marginTop:"32px"},children:(0,O.jsx)(M.Z,{children:(0,O.jsx)(C.Z,{size:"middle",children:r})})})},submitButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}},resetButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}}},children:(0,O.jsxs)(z.Z,{title:(0,O.jsxs)(V,{strong:!0,style:{fontSize:"16px"},children:[(0,O.jsx)(m.Z,{style:{marginRight:"8px",color:"#1890ff"}}),n.formatMessage({id:"organization.info"})]}),size:"small",style:{marginBottom:"24px"},children:[(0,O.jsx)(Z.Z,{rules:[{required:!0,message:n.formatMessage({id:"organization.name.required"})}],label:n.formatMessage({id:"organization.name.label"}),name:"name",width:"md",fieldProps:{prefix:(0,O.jsx)(m.Z,{style:{color:"#1890ff"}})}}),(0,O.jsx)(Z.Z,{rules:[{required:!0,message:n.formatMessage({id:"organization.code.required"})}],label:n.formatMessage({id:"organization.code.label"}),name:"code",width:"md",fieldProps:{placeholder:n.formatMessage({id:"organization.code.placeholder"})}}),(0,O.jsx)(y.Z,{rules:[{required:!0,message:n.formatMessage({id:"organization.description.required"})}],label:n.formatMessage({id:"organization.description.label"}),name:"description",width:"md",fieldProps:{rows:4,placeholder:n.formatMessage({id:"organization.description.placeholder"})}})]})}),(0,O.jsx)(S.Z,{open:I,onClose:function(){return N(!1)},onSuccess:G})]})}):(0,O.jsx)("div",{style:{padding:"24px",backgroundColor:o?"#141414":"#f0f2f5",minHeight:"100vh"},children:(0,O.jsxs)(z.Z,{variant:"borderless",style:{maxWidth:800,margin:"0 auto",borderRadius:"12px",boxShadow:o?"0 2px 8px rgba(255, 255, 255, 0.08)":"0 2px 8px rgba(0, 0, 0, 0.1)",textAlign:"center",padding:"100px 0",backgroundColor:o?"#1f1f1f":"#ffffff"},children:[(0,O.jsx)("div",{children:n.formatMessage({id:"loading"})}),(0,O.jsx)(S.Z,{open:I,onClose:function(){return N(!1)},onSuccess:G})]})})}}}]);