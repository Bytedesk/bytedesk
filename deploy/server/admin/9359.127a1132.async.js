"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9359],{18877:function(e,t,n){n.d(t,{Bv:function(){return T},L0:function(){return C},QB:function(){return x},RF:function(){return S},YO:function(){return j},YQ:function(){return A},Yg:function(){return m},kh:function(){return p},kv:function(){return y},pf:function(){return d},y:function(){return v}});var r=n(90819),a=n.n(r),o=n(73193),i=n.n(o),u=n(89933),s=n.n(u),l=n(36265),c=n(5861);function d(e){return f.apply(this,arguments)}function f(){return(f=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/query/org",{method:"GET",params:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/create",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/update",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/delete",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/enable",{method:"POST",data:{uid:t.uid,enabled:t.enabled,channel:l.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/deleteAll",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return q.apply(this,arguments)}function q(){return(q=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/updateIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return M.apply(this,arguments)}function M(){return(M=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/updateVectorIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return R.apply(this,arguments)}function R(){return(R=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/updateAllIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return U.apply(this,arguments)}function U(){return(U=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/faq/updateAllVectorIndex",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return F.apply(this,arguments)}function F(){return(F=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/agent/text/faq-similar-questions",{method:"POST",data:i()(i()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},87561:function(e,t,n){n.d(t,{Ck:function(){return m},dv:function(){return x},pw:function(){return y},qL:function(){return p},z4:function(){return v}});var r=n(90819),a=n.n(r),o=n(89933),i=n.n(o),u=n(73193),s=n.n(u),l=n(36265),c=n(5861),d="/api/v1/quickbutton";function f(e){var t;return s()(s()({},e),{},{channel:null!==(t=null==e?void 0:e.channel)&&void 0!==t?t:l.XtJ})}function p(e){return g.apply(this,arguments)}function g(){return(g=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("".concat(d,"/query/org"),{method:"GET",params:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("".concat(d,"/create"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("".concat(d,"/update"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("".concat(d,"/delete"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("".concat(d,"/enable"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},93458:function(e,t,n){var r=n(90819),a=n.n(r),o=n(89933),i=n.n(o),u=n(45332),s=n.n(u),l=n(74491),c=n(5286),d=n(3771),f=n(71865),p=n(36265),g=n(40845),v=n(13437),h=n(2685),m=n(5861),b=n(44194),y=n(31549);t.Z=function(e){var t=g.A.useForm(),n=s()(t,1)[0],r=(0,m.useIntl)(),o=(0,f.u)((function(e){return e.currentOrg})),u=(0,b.useState)([]),w=s()(u,2),x=w[0],k=w[1],S=(0,b.useRef)(!1),q=(0,b.useMemo)((function(){var t;return null!==(t=e.serviceSettings)&&void 0!==t?t:{}}),[e.serviceSettings]),j=(0,b.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==q?void 0:q.draft)&&void 0!==t?t:null==q?void 0:q.live)&&void 0!==e?e:void 0}),[q]);return(0,b.useEffect)((function(){null!=o&&o.uid&&!S.current&&(S.current=!0,i()(a()().mark((function e(){var t,n,r,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pageNumber:0,pageSize:100,type:p.QPQ,orgUid:o.uid},e.next=3,(0,d.AP)(t);case 3:200===(n=e.sent).code?(i=((null===(r=n.data)||void 0===r?void 0:r.content)||[]).map((function(e){return{label:e.name||e.uid||"",value:e.uid}})),k(i)):c.yw.error(n.message);case 5:case"end":return e.stop()}}),e)})))())}),[null==o?void 0:o.uid]),(0,b.useEffect)((function(){var e;n.setFieldsValue({inputAssociationEnabled:null!==(e=null==j?void 0:j.inputAssociationEnabled)&&void 0!==e&&e,inputAssociationKbUid:null==j?void 0:j.inputAssociationKbUid})}),[n,null==j?void 0:j.inputAssociationEnabled,null==j?void 0:j.inputAssociationKbUid]),(0,y.jsxs)(g.A,{form:n,submitter:!1,style:{marginLeft:20},children:[(0,y.jsx)(v.Z,{name:"inputAssociationEnabled",width:"md",label:(0,y.jsxs)("span",{children:[(0,y.jsx)(m.FormattedMessage,{id:"settings.inputAssociation.enable",defaultMessage:"启用输入联想"}),(0,y.jsx)(l.Z,{type:"service",keys:["inputAssociationEnabled"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),fieldProps:{onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputAssociationEnabled:t})}}}),(0,y.jsx)(h.Z,{name:"inputAssociationKbUid",width:"md",label:(0,y.jsxs)("span",{children:[(0,y.jsx)(m.FormattedMessage,{id:"settings.inputAssociation.kb",defaultMessage:"联想关联知识库"}),(0,y.jsx)(l.Z,{type:"service",keys:["inputAssociationKbUid"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),options:x,fieldProps:{allowClear:!0,onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputAssociationKbUid:t})}},placeholder:r.formatMessage({id:"choose",defaultMessage:"Choose"})})]})}},14368:function(e,t,n){n(90819),n(89933),n(73193),n(45332),n(87666),n(77394),n(39122),n(36265),n(5861),n(44194),n(36100),n(74491),n(31549)},98896:function(e,t,n){var r=n(90819),a=n.n(r),o=n(89933),i=n.n(o),u=n(45332),s=n.n(u),l=(n(14267),n(40845)),c=n(13437),d=n(5861),f=n(44194),p=(n(73001),n(31661)),g=n(31549);t.Z=function(e){e.variant;var t=e.serviceSettings,n=e.onServiceSettingsChange,r=(0,d.useIntl)(),o=l.A.useForm(),u=s()(o,1)[0],v=(0,p.Z)().translateString,h=(0,f.useState)(!1),m=s()(h,2),b=(m[0],m[1]),y=(0,f.useState)(""),w=s()(y,2),x=(w[0],w[1]),k=(0,f.useMemo)((function(){var e,n;return null!==(e=null!==(n=null==t?void 0:t.draft)&&void 0!==n?n:null==t?void 0:t.live)&&void 0!==e?e:void 0}),[null==t?void 0:t.draft,null==t?void 0:t.live]);(0,f.useEffect)((function(){var e=!(null==k||!k.showRateBtn),t=v(null==k?void 0:k.inviteRateTip)||"";u.setFieldsValue({showRateBtn:null==k?void 0:k.showRateBtn,autoInviteRate:null==k?void 0:k.autoInviteRate}),b(e),x(t)}),[k,u,v]);var S=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onFinish:",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRating handleChange autoInviteRate",t),u.setFieldValue("autoInviteRate",t),null==n||n({autoInviteRate:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(l.A,{form:u,onFinish:S,submitter:!1,style:{marginLeft:"20px"},children:[(0,g.jsx)(c.Z,{width:"md",name:"autoInviteRate",label:r.formatMessage({id:"rate.auto.invite.rate"}),tooltip:r.formatMessage({id:"rate.auto.invite.rate.tooltip"}),fieldProps:{onChange:q}}),!1]})})}},61401:function(e,t,n){var r=n(90819),a=n.n(r),o=n(89933),i=n.n(o),u=n(45332),s=n.n(u),l=n(5286),c=n(18877),d=n(3771),f=n(71865),p=n(31661),g=n(36265),v=n(74491),h=n(40845),m=n(13437),b=n(44565),y=n(2685),w=n(5861),x=n(44194),k=n(73120),S=n(42539),q=n(31549);t.Z=function(e){e.variant;var t,n,r=e.serviceSettings,o=e.onServiceSettingsChange,u=(e.settingsUid,e.isActive,(0,w.useIntl)()),j=h.A.useForm(),M=s()(j,1)[0],C=(0,f.u)((function(e){return e.currentOrg})),R=(0,p.Z)().translateString,T=null==r?void 0:r.live,U=null==r?void 0:r.draft,A=(0,x.useMemo)((function(){var e;return null!==(e=null!=U?U:T)&&void 0!==e?e:{}}),[U,T]),F=(0,x.useState)(),I=s()(F,2),Z=I[0],P=I[1],O=(0,x.useState)(),B=s()(O,2),E=B[0],K=B[1],W=(0,x.useState)(),V=s()(W,2),L=V[0],Q=V[1],J=(0,x.useState)("iframe"),D=s()(J,2),Y=D[0],N=D[1],X=(0,x.useCallback)(function(){var e=i()(a()().mark((function e(t){var n,r,o,i,s,d,f,p;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||L){e.next=4;break}return console.log("TabRight: 没有选择知识库，无法获取FAQ"),P(void 0),e.abrupt("return");case 4:return l.yw.loading(u.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:100,orgUid:null==C?void 0:C.uid,kbUid:t||L},e.prev=6,e.next=9,(0,c.pf)(n);case 9:r=e.sent,S.Z.debug("TabRight.getFaqs response:",n,r),l.yw.destroy(),200===r.code?(o={code:r.code,message:r.message,data:{content:null==r?void 0:r.data.content.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer,kbUid:e.kbUid,orgUid:e.orgUid}})),totalElements:null==r?void 0:r.data.totalElements,totalPages:null==r?void 0:r.data.totalPages,number:null==r?void 0:r.data.number}},P(o),i=t||L,s=M.getFieldValue("faqUids")||[],i&&s.length>0&&(f=(null==o||null===(d=o.data.content)||void 0===d?void 0:d.map((function(e){return e.uid})))||[],(p=s.filter((function(e){return f.includes(e)}))).length!==s.length&&M.setFieldValue("faqUids",p))):l.yw.error(r.message),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(6),l.yw.destroy(),console.error("TabRight 获取FAQ失败:",e.t0),l.yw.error("获取FAQ失败");case 20:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}(),[null==C?void 0:C.uid,M,u,L]),H=(0,x.useCallback)(i()(a()().mark((function e(){var t,n,r,o,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.yw.loading(u.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:g.QPQ,orgUid:null==C?void 0:C.uid},e.prev=2,e.next=5,(0,d.AP)(t);case 5:n=e.sent,S.Z.debug("TabRight.getKbases response:",t,n),l.yw.destroy(),200===n.code?(o={code:n.code,message:n.message,data:{content:null==n?void 0:n.data.content.map((function(e){return{uid:e.uid,name:e.name,type:e.type,orgUid:e.orgUid}})),totalElements:null==n?void 0:n.data.totalElements,totalPages:null==n?void 0:n.data.totalPages,number:null==n?void 0:n.data.number}},K(o),null!=U&&U.faqKbUid?i=U.faqKbUid:null!=T&&T.faqKbUid?i=T.faqKbUid:(null==o||null===(r=o.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&(i=null==o?void 0:o.data.content[0].uid),i&&(Q(i),M.setFieldValue("faqKbUid",i),X(i))):l.yw.error(n.message),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),l.yw.destroy(),console.error("TabRight 获取知识库失败:",e.t0),l.yw.error("获取知识库失败");case 16:case"end":return e.stop()}}),e,null,[[2,11]])}))),[null==C?void 0:C.uid,M,X,u,null==U?void 0:U.faqKbUid,null==T?void 0:T.faqKbUid]);(0,x.useEffect)((function(){var e=Array.isArray(null==A?void 0:A.faqs)?(null==A?void 0:A.faqs).map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[];M.setFieldsValue({showRightIframe:null==A?void 0:A.showRightIframe,rightIframeUrl:null==A?void 0:A.rightIframeUrl,showFaqs:null==A?void 0:A.showFaqs,faqKbUid:null==A?void 0:A.faqKbUid,faqUids:Array.isArray(null==A?void 0:A.faqUids)?null==A?void 0:A.faqUids:e}),null!=A&&A.faqKbUid&&A.faqKbUid!==L&&(Q(A.faqKbUid),X(A.faqKbUid))}),[M,X,A,L]),(0,x.useEffect)((function(){null!=C&&C.uid&&H()}),[null==C?void 0:C.uid,H]);var z=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showRightIframe",t),M.setFieldValue("showRightIframe",t),null==o||o({showRightIframe:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showFaqs",t),M.setFieldValue("showFaqs",t),null==o||o({showFaqs:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(m.Z,{width:"md",name:"showRightIframe",label:(0,q.jsxs)("span",{children:[u.formatMessage({id:"showRightIframe"}),(0,q.jsx)(v.Z,{type:"service",keys:["showRightIframe"],live:T,draft:U})]}),fieldProps:{onChange:z}}),(0,q.jsx)(b.Z,{width:"md",name:"rightIframeUrl",label:(0,q.jsxs)("span",{children:[u.formatMessage({id:"rightIframeUrl"}),(0,q.jsx)(v.Z,{type:"service",keys:["rightIframeUrl"],live:T,draft:U})]}),placeholder:u.formatMessage({id:"rightIframeUrl.placeholder",defaultMessage:"请输入以 http:// 或 https:// 开头的URL"}),rules:[{type:"url",message:u.formatMessage({id:"rightIframeUrl.invalid",defaultMessage:"请输入有效的URL地址"})},{pattern:/^https?:\/\/[^\s]+$/i,message:u.formatMessage({id:"rightIframeUrl.scheme.required",defaultMessage:"必须以 http:// 或 https:// 开头"})}],fieldProps:{type:"url",inputMode:"url",allowClear:!0}})]}),G=(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(m.Z,{width:"md",name:"showFaqs",label:(0,q.jsxs)("span",{children:[u.formatMessage({id:"faq.show.faqs"}),(0,q.jsx)(v.Z,{type:"service",keys:["showFaqs"],live:T,draft:U})]}),fieldProps:{onChange:$}}),(0,q.jsx)(y.Z,{name:"faqKbUid",width:"md",label:(0,q.jsxs)("span",{children:[u.formatMessage({id:"faq.kbase.select",defaultMessage:"选择侧边栏常见问题知识库"}),(0,q.jsx)(v.Z,{type:"service",keys:["faqKbUid"],live:T,draft:U})]}),options:null==E||null===(t=E.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return{label:R(e.name),value:e.uid}})),fieldProps:{onChange:function(e){console.log("TabRight selected kbase:",e),Q(e),M.setFieldValue("faqUids",[]),X(e),null==o||o({faqKbUid:e,faqUids:[]})},allowClear:!0,placeholder:u.formatMessage({id:"choose",defaultMessage:"Choose"})}}),(0,q.jsx)(y.Z,{name:"faqUids",width:"md",label:(0,q.jsxs)("span",{children:[u.formatMessage({id:"menu.kbase.faq"}),(0,q.jsx)(v.Z,{type:"service",keys:["faqUids"],live:T,draft:U})]}),tooltip:u.formatMessage({id:"faq.uids.dependency.tooltip",defaultMessage:"FAQ options depend on the knowledge base selected above."}),extra:u.formatMessage({id:"faq.uids.dependency.note",defaultMessage:"Choose a knowledge base first; switching it refreshes the FAQ list and clears current selections."}),options:null==Z||null===(n=Z.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.map((function(e){return{label:R(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:u.formatMessage({id:"choose",defaultMessage:"Choose"})}})]});return(0,q.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,q.jsx)(h.A,{form:M,onValuesChange:function(e,t){var n={};Object.prototype.hasOwnProperty.call(e,"rightIframeUrl")&&(n.rightIframeUrl=t.rightIframeUrl),Object.prototype.hasOwnProperty.call(e,"faqUids")&&(n.faqUids=t.faqUids),Object.prototype.hasOwnProperty.call(e,"faqKbUid")&&(n.faqKbUid=t.faqKbUid),Object.keys(n).length>0&&(null==o||o(n))},submitter:!1,children:(0,q.jsx)(k.Z,{activeKey:Y,onChange:N,items:[{key:"iframe",label:u.formatMessage({id:"showRightIframe",defaultMessage:"右侧iframe"}),children:_},{key:"faq",label:u.formatMessage({id:"faq.show.faqs",defaultMessage:"常见问题"}),children:G}]})})})}},20427:function(e,t,n){var r=n(73193),a=n.n(r),o=n(45332),i=n.n(o),u=n(74491),s=n(28902),l=n(36265),c=n(40845),d=n(89767),f=n(5861),p=n(76185),g=n(33122),v=n(44194),h=n(31549);t.Z=function(e){var t,n=c.A.useForm(),r=i()(n,1)[0],o=(0,f.useIntl)(),m={width:320},b=(0,s.z)((function(e){return{currentRobotSettings:e.currentRobotSettings,currentAgentSettings:e.currentAgentSettings,currentWorkgroupSettings:e.currentWorkgroupSettings,setCurrentRobotSettings:e.setCurrentRobotSettings,setCurrentAgentSettings:e.setCurrentAgentSettings,setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings}})),y=b.currentRobotSettings,w=b.currentAgentSettings,x=b.currentWorkgroupSettings,k=b.setCurrentRobotSettings,S=b.setCurrentAgentSettings,q=b.setCurrentWorkgroupSettings,j=void 0!==e.variant,M=j?e:null,C=j?M.variant:(t=e.type)===l.Njn?"agent":t===l._X4?"robot":"workgroup",R=(0,v.useMemo)((function(){var e;return j?null!==(e=null==M?void 0:M.serviceSettings)&&void 0!==e?e:{}:"agent"===C?{live:null==w?void 0:w.serviceSettings,draft:null==w?void 0:w.draftServiceSettings}:"robot"===C?{live:null==y?void 0:y.serviceSettings,draft:null==y?void 0:y.draftServiceSettings}:{live:null==x?void 0:x.serviceSettings,draft:null==x?void 0:x.draftServiceSettings}}),[j,M,C,w,y,x]),T=(0,v.useMemo)((function(){return"agent"!==C?null:j?null!==(e=null==M?void 0:M.agentMeta)&&void 0!==e?e:null:{maxThreadCount:null==w?void 0:w.maxThreadCount,timeoutRemindTime:null==w?void 0:w.timeoutRemindTime};var e}),[C,j,M,w]),U=(0,v.useCallback)((function(e){"agent"===C&&w?S(a()(a()({},w),{},{serviceSettings:a()(a()({},w.serviceSettings),e),draftServiceSettings:a()(a()({},w.draftServiceSettings||{}),e)})):"robot"===C&&y?k(a()(a()({},y),{},{serviceSettings:a()(a()({},y.serviceSettings),e),draftServiceSettings:a()(a()({},y.draftServiceSettings||{}),e)})):"workgroup"===C&&x&&q(a()(a()({},x),{},{serviceSettings:a()(a()({},x.serviceSettings),e),draftServiceSettings:a()(a()({},x.draftServiceSettings||{}),e)}))}),[C,w,y,x,S,k,q]),A=(0,v.useCallback)((function(e){"agent"===C&&w&&S(a()(a()({},w),e))}),[C,w,S]),F=(0,v.useCallback)((function(e){var t;j?null==M||null===(t=M.onServiceSettingsChange)||void 0===t||t.call(M,e):U(e)}),[j,M,U]),I=(0,v.useCallback)((function(e){var t;"agent"===C&&(j?null==M||null===(t=M.onAgentMetaChange)||void 0===t||t.call(M,e):A(e))}),[C,j,M,A]),Z=(0,v.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==R?void 0:R.draft)&&void 0!==t?t:null==R?void 0:R.live)&&void 0!==e?e:void 0}),[R]);return(0,v.useEffect)((function(){r.setFieldsValue({autoCloseMin:null==Z?void 0:Z.autoCloseMin,showLogo:null==Z?void 0:Z.showLogo})}),[r,Z]),(0,v.useEffect)((function(){"agent"===C&&r.setFieldsValue({maxThreadCount:null==T?void 0:T.maxThreadCount,timeoutRemindTime:null==T?void 0:T.timeoutRemindTime})}),[r,C,null==T?void 0:T.maxThreadCount,null==T?void 0:T.timeoutRemindTime]),(0,h.jsxs)(c.A,{form:r,submitter:!1,style:{marginLeft:"20px"},children:["agent"===C&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.Z,{width:"md",name:"maxThreadCount",label:o.formatMessage({id:"agent.settings.max.thread"}),tooltip:o.formatMessage({id:"agent.settings.max.thread.tooltip",defaultMessage:"超出此设置数量会自动进入排队队列，需要手动接入"}),min:0,formItemProps:{style:m},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&I({maxThreadCount:e})}}}),(0,h.jsx)(c.A.Item,{label:o.formatMessage({id:"agent.settings.timeout.remind",defaultMessage:"超时提醒时间"}),tooltip:o.formatMessage({id:"agent.settings.timeout.remind.tooltip",defaultMessage:"超过设定时间未回复客户将收到提醒"}),style:m,children:(0,h.jsxs)(p.Z.Compact,{block:!0,children:[(0,h.jsx)(d.Z,{formItemProps:{noStyle:!0},width:"md",name:"timeoutRemindTime",min:1,fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&I({timeoutRemindTime:e})}}}),(0,h.jsx)(g.Z,{disabled:!0,value:o.formatMessage({id:"time.minute",defaultMessage:"分钟"}),style:{width:72,textAlign:"center"},readOnly:!0,tabIndex:-1})]})})]}),(0,h.jsx)(d.Z,{width:"md",name:"autoCloseMin",label:(0,h.jsxs)("span",{children:[o.formatMessage({id:"agent.settings.auto.close.time"}),(0,h.jsx)(u.Z,{type:"service",keys:["autoCloseMin"],live:null==R?void 0:R.live,draft:null==R?void 0:R.draft})]}),tooltip:o.formatMessage({id:"agent.settings.auto.close.time.tooltip"}),min:1,formItemProps:{style:m},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&F({autoCloseMin:e})}}})]})}},62742:function(e,t,n){var r=n(45332),a=n.n(r),o=n(74491),i=n(31661),u=n(14267),s=n(40845),l=n(53380),c=n(5861),d=n(44194),f=n(73001),p=n(31549);t.Z=function(e){var t=s.A.useForm(),n=a()(t,1)[0],r=(0,c.useIntl)(),g=(0,i.Z)().translateString,v=e.variant,h=e.serviceSettings,m=e.onServiceSettingsChange,b=(0,d.useState)(!1),y=a()(b,2),w=y[0],x=y[1],k=(0,d.useState)(""),S=a()(k,2),q=S[0],j=S[1],M=(0,d.useState)(""),C=a()(M,2),R=C[0],T=C[1],U=(0,d.useState)(""),A=a()(U,2),F=A[0],I=A[1],Z=(0,d.useRef)({topTip:"",agentCloseTip:"",autoCloseTip:""}),P=(0,d.useMemo)((function(){return null!=h?h:{}}),[h]),O=(0,d.useCallback)((function(e){null==m||m(e)}),[m]),B=(0,d.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==P?void 0:P.draft)&&void 0!==t?t:null==P?void 0:P.live)&&void 0!==e?e:void 0}),[P]);(0,d.useEffect)((function(){var e=!(null==B||!B.showTopTip);w!==e&&(x(e),n.setFieldValue("showTopTip",e));var t=function(e,t){var r=g(t)||"";Z.current[e]!==r&&(Z.current[e]=r,"topTip"===e?j(r):"agentCloseTip"===e?T(r):"autoCloseTip"===e&&I(r),n.setFieldValue(e,r))};B?(t("topTip",B.topTip),t("agentCloseTip",B.agentCloseTip),t("autoCloseTip",B.autoCloseTip)):(t("topTip",""),t("agentCloseTip",""),t("autoCloseTip",""))}),[B,n,w,g,v]);var E=(0,d.useCallback)((function(e){Z.current.topTip=e,j(e),n.setFieldValue("topTip",e),O({topTip:e})}),[n,O]),K=(0,d.useCallback)((function(e){Z.current.agentCloseTip=e,T(e),n.setFieldValue("agentCloseTip",e),O({agentCloseTip:e})}),[n,O]),W=(0,d.useCallback)((function(e){Z.current.autoCloseTip=e,I(e),n.setFieldValue("autoCloseTip",e),O({autoCloseTip:e})}),[n,O]);return(0,p.jsxs)(s.A,{form:n,submitter:!1,style:{marginLeft:"20px"},children:[(0,p.jsx)(l.Z,{name:"showTopTip",width:"md",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.show.top.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["showTopTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),fieldProps:{onChange:function(e){x(e.target.checked),e.target.checked&&j(g(null==B?void 0:B.topTip)),O({showTopTip:e.target.checked})}}}),w&&(0,p.jsx)(s.A.Item,{name:"topTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.top.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["topTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.top.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.top.tip.placeholder"}),value:q,toolbarKeys:(0,u.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return E(e)}},"topTipEditor")}),"agent"===v&&(0,p.jsx)(s.A.Item,{name:"agentCloseTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.agent.close.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["agentCloseTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),tooltip:r.formatMessage({id:"agent.settings.agent.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.agent.close.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.agent.close.tip.placeholder"}),value:R,toolbarKeys:(0,u.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return K(e)}},"agentCloseTipEditor")}),(0,p.jsx)(s.A.Item,{name:"autoCloseTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.auto.close.tip"}),(0,p.jsx)(o.Z,{type:"service",keys:["autoCloseTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),tooltip:r.formatMessage({id:"agent.settings.auto.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.auto.close.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.auto.close.tip.placeholder"}),value:F,toolbarKeys:(0,u.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return W(e)}},"autoCloseTipEditor")})]})}},74008:function(e,t,n){var r=n(73193),a=n.n(r),o=n(90819),i=n.n(o),u=n(89933),s=n.n(u),l=n(45332),c=n.n(l),d=n(5286),f=n(87561),p=n(71865),g=n(40845),v=n(13437),h=n(2685),m=n(5861),b=n(44194),y=n(46435),w=n(63889),x=n(73120),k=n(31661),S=n(74491),q=n(31549),j=["smile","image","file","rate","leavemsg"];t.Z=function(e){var t=e.serviceSettings,n=e.onServiceSettingsChange,r=(0,m.useIntl)(),o=g.A.useForm(),u=c()(o,1)[0],l=(0,k.Z)().translateString,M=(0,p.u)((function(e){return e.currentOrg})),C=(0,b.useState)("toolbar"),R=c()(C,2),T=R[0],U=R[1],A=(0,b.useState)([]),F=c()(A,2),I=F[0],Z=F[1],P=(0,b.useState)(!1),O=c()(P,2),B=O[0],E=O[1],K=null==t?void 0:t.live,W=null==t?void 0:t.draft,V=(0,b.useMemo)((function(){return null!=W?W:K}),[W,K]),L=(0,b.useCallback)(s()(i()().mark((function e(){var t,n,a,o,s,l,c,p;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=M&&M.uid){e.next=3;break}return Z([]),e.abrupt("return");case 3:return E(!0),t=d.yw.loading(r.formatMessage({id:"loading",defaultMessage:"Loading"})),e.prev=5,e.next=8,(0,f.qL)({pageNumber:0,pageSize:200,orgUid:M.uid});case 8:200===(n=e.sent).code?(o=((null==n||null===(a=n.data)||void 0===a?void 0:a.content)||[]).filter((function(e){return Boolean(null==e?void 0:e.uid)})),s=o.sort((function(e,t){var n,r;return(null!==(n=null==e?void 0:e.orderIndex)&&void 0!==n?n:0)-(null!==(r=null==t?void 0:t.orderIndex)&&void 0!==r?r:0)})),Z(s),l=new Set(s.map((function(e){return e.uid}))),c=u.getFieldValue("quickButtonUids")||[],(p=c.filter((function(e){return l.has(e)}))).length!==c.length&&u.setFieldValue("quickButtonUids",p)):d.yw.error(n.message||r.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),d.yw.error(r.formatMessage({id:"request.failed",defaultMessage:"Request failed"}));case 15:return e.prev=15,null==t||t(),E(!1),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[5,12,15,19]])}))),[null==M?void 0:M.uid,u,r]);(0,b.useEffect)((function(){L()}),[L]),(0,b.useEffect)((function(){var e,t,n,r,a,o,i,s,l,c;if(V){var d=V.toolbar||{},f=null==V?void 0:V.quickButtons;u.setFieldsValue({smile:null===(e=d.smile)||void 0===e||e,image:null===(t=d.image)||void 0===t||t,file:null===(n=d.file)||void 0===n||n,rate:null===(r=d.rate)||void 0===r||r,leavemsg:null===(a=d.leavemsg)||void 0===a||a,orderSelector:null===(o=d.orderSelector)||void 0===o||o,ticket:null===(i=d.ticket)||void 0===i||i,audio:null===(s=d.audio)||void 0===s||s,video:null===(l=d.video)||void 0===l||l,tel:null===(c=d.tel)||void 0===c||c,toolbarOrder:Array.isArray(d.order)&&d.order.length>0?d.order:[].concat(j),showQuickButtons:V.showQuickButtons,quickButtonUids:Array.isArray(null==V?void 0:V.quickButtonUids)?V.quickButtonUids:Array.isArray(f)?f.map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[]})}}),[V,u]);var Q=(0,b.useCallback)((function(e){u.setFieldValue("showQuickButtons",e),null==n||n({showQuickButtons:e})}),[u,n]),J=(0,b.useMemo)((function(){return null!=I&&I.length?I.filter((function(e){return Boolean(null==e?void 0:e.uid)})).map((function(e){return{label:l(e.title)||e.title||e.uid,value:e.uid}})):[]}),[I,l]),D=(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)(y.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"smile",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.emoji",defaultMessage:"Emoji"}),(0,q.jsx)(S.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"image",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.image",defaultMessage:"Image"}),(0,q.jsx)(S.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"file",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.file",defaultMessage:"File"}),(0,q.jsx)(S.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"rate",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.rate",defaultMessage:"Rate"}),(0,q.jsx)(S.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})}),(0,q.jsx)(w.Z,{span:12,children:(0,q.jsx)(v.Z,{name:"leavemsg",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"chat.toolbar.leaveMsg",defaultMessage:"Leave Msg"}),(0,q.jsx)(S.Z,{type:"service",keys:["toolbar"],live:K,draft:W})]}),formItemProps:{style:{marginBottom:8}}})})]})}),Y=(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(v.Z,{label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"faq.show.quick.buttons"}),(0,q.jsx)(S.Z,{type:"service",keys:["showQuickButtons"],live:K,draft:W})]}),name:"showQuickButtons",width:"md",fieldProps:{onChange:Q}}),(0,q.jsx)(h.Z,{name:"quickButtonUids",width:"lg",label:(0,q.jsxs)("span",{children:[r.formatMessage({id:"menu.kbase.quickbutton"}),(0,q.jsx)(S.Z,{type:"service",keys:["quickButtonUids","quickButtons"],live:K,draft:W})]}),options:J,fieldProps:{mode:"multiple",allowClear:!0,showSearch:!0,optionFilterProp:"label",placeholder:(0,q.jsx)(m.FormattedMessage,{id:"choose",defaultMessage:"Choose"}),loading:B}})]});return(0,q.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,q.jsx)(g.A,{form:u,onValuesChange:function(e,t){var r={};["smile","image","file","rate","leavemsg"].forEach((function(n){Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=t[n])}));var o=Object.prototype.hasOwnProperty.call(e,"toolbarOrder"),i={},u=a()(a()({},(null==K?void 0:K.toolbar)||{}),(null==W?void 0:W.toolbar)||{});Object.keys(r).length>0&&(i.toolbar=a()(a()({},u),r)),o&&(i.toolbar=a()(a()({},i.toolbar||u),{},{order:t.toolbarOrder||[]})),["showQuickButtons","quickButtonUids"].forEach((function(n){Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=t[n])})),0!==Object.keys(i).length&&(null==n||n(i))},submitter:!1,children:(0,q.jsx)(x.Z,{activeKey:T,onChange:U,items:[{key:"toolbar",label:r.formatMessage({id:"chat.toolbar.settings",defaultMessage:"工具栏设置"}),children:D},{key:"quickButton",label:r.formatMessage({id:"quick.faq.settings",defaultMessage:"快捷按钮设置"}),children:Y}]})})})}},43769:function(e,t,n){n(73193),n(45332),n(89957),n(74491),n(5861),n(44194),n(31549)},73001:function(e,t,n){var r=n(73193),a=n.n(r),o=n(5286),i=n(74494),u=n(87523),s=n(36265),l=n(5861),c=n(68922),d=(n(48725),n(96596)),f=n.n(d),p=n(44194),g=n(31549);t.Z=function(e){var t=e.placeholder,n=e.defaultValue,r=e.value,d=e.style,v=e.toolbarKeys,h=e.maxLength,m=e.onChange,b=e.options,y=(0,l.useIntl)(),w=(0,i.Z)().isDarkMode,x=(0,p.useRef)(null),k=(0,p.useRef)(null),S=(0,p.useRef)(!1),q=(0,p.useRef)(m);(0,p.useEffect)((function(){q.current=m}),[m]);var j=function(e,t,n){"function"!=typeof q.current||S.current||q.current(e,t,n)};return(0,p.useEffect)((function(){if(x.current){if(!k.current){var e=new c.cW(a()(a()({element:x.current,theme:w?"dark":"light",placeholder:t,content:n,toolbarKeys:v},b||{}),{},{image:{uploadUrl:(0,u.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(s.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var i=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,u=new FormData;return u.append("file",e),u.append("fileName",i),u.append("fileType",e.type),u.append("isAvatar","false"),u.append("kbType",s.QPQ),u.append("categoryUid",""),u.append("kbUid",""),u.append("orgUid",""),u.append("client",s.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:a()({Accept:"application/json"},n),body:u}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){o.yw.destroy(),o.yw.success("".concat(i," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,alt:i}};e(n)}else o.yw.destroy(),o.yw.error("".concat(i," 上传失败"))})).catch((function(e){r(e)}))}))}},video:{uploadUrl:(0,u.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(s.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var i=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,u=new FormData;return u.append("file",e),u.append("fileName",i),u.append("fileType",e.type),u.append("isAvatar","false"),u.append("kbType",s.QPQ),u.append("categoryUid",""),u.append("kbUid",""),u.append("client",s.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:a()({Accept:"application/json"},n),body:u}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){o.yw.destroy(),o.yw.success("".concat(i," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,poster:"https://www.weiyuai.cn/avatars/video_poster.png"}};e(n)}else o.yw.destroy(),o.yw.error("".concat(i," 上传失败"))})).catch((function(e){r(e)}))}))}},attachment:{uploadUrl:(0,u.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(s.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var i=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,u=new FormData;return u.append("file",e),u.append("fileName",i),u.append("fileType",e.type),u.append("isAvatar","false"),u.append("kbType",s.QPQ),u.append("categoryUid",""),u.append("kbUid",""),u.append("client",s.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:a()({Accept:"application/json"},n),body:u}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){o.yw.destroy(),o.yw.success("".concat(i," 上传成功"));var n={errorCode:0,data:{href:t.data.fileUrl,fileName:i}};e(n)}else o.yw.destroy(),o.yw.error("".concat(i," 上传失败"))})).catch((function(e){r(e)}))}))}},onChange:function(e){var t=e.getText(),n=t.length,r="number"==typeof h?h:Number.POSITIVE_INFINITY;if(n>r){var a,i;o.yw.warning(y.formatMessage({id:"character.limit.reached"},{limit:r})||"已达到 ".concat(r," 字符限制"));var u=t.substring(0,r);S.current=!0,setTimeout((function(){k.current&&k.current.setContent(u),S.current=!1}),0),j((null===(a=k.current)||void 0===a?void 0:a.getHtml())||"",(null===(i=k.current)||void 0===i?void 0:i.getMarkdown())||"",u)}else j(e.getHtml(),e.getMarkdown(),e.getText())}}));k.current=e}return function(){k.current&&(k.current.destroy(),k.current=null)}}}),[]),(0,p.useEffect)((function(){k.current&&void 0!==r&&r!==k.current.getHtml()&&(S.current=!0,k.current.setContent(r||"",!1),requestAnimationFrame((function(){S.current=!1})))}),[r]),(0,g.jsx)("div",{ref:x,style:a()({height:"100%"},d)})}},74491:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(73193),a=n.n(r),o=n(44194),i=n(20921),u=n(96082),s=n(86222),l=n.n(s),c=n(89957),d=n.n(c),f=["welcomeFaqUids","faqUids","quickButtonUids","guessFaqUids","hotFaqUids","shortcutFaqUids","proactiveFaqUids"],p=["welcomeFaqs","faqs","quickButtons","guessFaqs","hotFaqs","shortcutFaqs","proactiveFaqs"];function g(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e,t){if(!e)return e;if(!t||0===t.length)return e;var n={};return t.forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})),n}function h(e){var t=e&&g(e)?a()({},e):{};return p.forEach((function(e){t[e]&&(t[e.replace(/s$/,"Uids")]=function(e){if(Array.isArray(e))return e.map((function(e){return null==e?void 0:e.uid})).filter(Boolean).map(String)}(t[e]),delete t[e])})),f.forEach((function(e){t[e]&&(t[e]=function(e){if(!Array.isArray(e))return e;var t=e.slice();return t.every((function(e){return["string","number","boolean"].includes(d()(e))}))?t.map((function(e){return"string"==typeof e?e:String(e)})).sort():t}(t[e]))})),t}function m(e){return e&&g(e)?a()({},e):{}}function b(e){var t=new WeakSet;return JSON.stringify(function e(n){if(null===n||"object"!==d()(n))return n;if(!t.has(n)){if(t.add(n),Array.isArray(n))return n.map((function(t){return e(t)}));var r,a=Object.keys(n).sort(),o={},i=l()(a);try{for(i.s();!(r=i.n()).done;){var u=r.value;o[u]=e(n[u])}}catch(e){i.e(e)}finally{i.f()}return o}}(e))}function y(e,t){return b(e)===b(t)}var w=n(31549),x=function(e){var t=e.hasDiff,n=e.type,r=void 0===n?"service":n,s=e.live,l=e.draft,c=e.keys,d=e.text,f=void 0===d?"草稿未发布":d,p=e.style;return(0,o.useMemo)((function(){if("boolean"==typeof t)return t;if(!s&&!l)return!1;switch(r){case"service":return function(e,t,n){return!y(v(h(e),n),v(h(t),n))}(s,l,c);case"messageLeave":return function(e,t,n){return!y(v(m(e),n),v(m(t),n))}(s,l,c);default:return function(e,t,n){return!y(v(e||{},n),v(t||{},n))}(s,l,c)}}),[t,r,s,l,c])?(0,w.jsx)(i.Z,{title:"string"==typeof f?f:"草稿与线上不一致",children:(0,w.jsx)(u.Z,{color:"orange",style:a()({marginLeft:8,height:20,lineHeight:"18px"},p),children:"Draft"})}):null}},77394:function(e,t,n){n.d(t,{V:function(){return d}});var r=n(73193),a=n.n(r),o=n(76711),i=n.n(o),u=n(36265),s=n(74543),l=n(21152),c=n(72083),d=(0,s.Ue)()((0,l.mW)((0,l.tJ)((0,c.n)((function(e,t){return{robotResult:{data:{content:[]}},currentRobot:{uid:"",nickname:""},insertRobot:function(t){e((function(e){e.robotResult.data.content.unshift(t)}))},setRobotResult:function(n){e({robotResult:n});var r,a=t().currentRobot;""!==a.uid&&void 0!==a||(null===(r=n.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentRobot:n.data.content[0]})},setCurrentRobot:function(n){var r=t().robotResult.data.content,o=r.findIndex((function(e){return e.uid===n.uid}));if(-1!==o){var u=[].concat(i()(r.slice(0,o)),[n],i()(r.slice(o+1))),s=a()(a()({},t().robotResult),{},{data:{content:u}});e({robotResult:s,currentRobot:n})}else console.warn("Robot with the specified uid not found."),e({currentRobot:n})},deleteCurrentRobot:function(n){var r=t().robotResult.data.content,o=r.findIndex((function(e){return e.uid===n}));-1!==o?e({robotResult:a()(a()({},t().robotResult),{},{data:{content:[].concat(i()(r.slice(0,o)),i()(r.slice(o+1)))}})}):console.warn("Robot not found in cache:",n),t().currentRobot.uid===n&&e({currentRobot:{uid:""}})},deleteRobotCache:function(){return e({},!0)}}})),{name:u.Eis})))},87666:function(e,t,n){n.d(t,{E:function(){return d}});var r=n(73193),a=n.n(r),o=n(76711),i=n.n(o),u=n(36265),s=n(74543),l=n(21152),c=n(72083),d=(0,s.Ue)()((0,l.mW)((0,l.tJ)((0,c.n)((function(e,t){return{agentResult:{data:{content:[]}},currentAgent:{uid:"",orgUid:""},insertAgent:function(t){e((function(e){e.agentResult.data.content.unshift(t)}))},updateAgent:function(t){e((function(e){var n=e.agentResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n[r]=t:console.warn("Agent with uid ".concat(t.uid," not found."))}))},setAgentResult:function(n){var r;(e({agentResult:n}),""===t().currentAgent.uid)&&((null===(r=n.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentAgent:n.data.content[0]}))},setCurrentAgent:function(n){var r=t().agentResult.data.content,o=r.findIndex((function(e){return e.uid===n.uid}));if(-1!==o){var u=[].concat(i()(r.slice(0,o)),[n],i()(r.slice(o+1))),s=a()(a()({},t().agentResult),{},{data:{content:u}});e({agentResult:s,currentAgent:n})}else console.warn("Agent with the specified uid not found."),e({currentAgent:n})},deleteCurrentAgent:function(n){var r=t().agentResult.data.content,o=r.findIndex((function(e){return e.uid===n}));-1!==o?e({agentResult:a()(a()({},t().agentResult),{},{data:{content:[].concat(i()(r.slice(0,o)),i()(r.slice(o+1)))}})}):console.warn("Agent not found in cache:",n),t().currentAgent.uid===n&&e({currentAgent:{uid:"",orgUid:""}})},deleteAgentCache:function(){return e({},!0)}}})),{name:u.zzK})))},28902:function(e,t,n){n.d(t,{z:function(){return u}});var r=n(36265),a=n(74543),o=n(21152),i=n(72083),u=(0,a.Ue)()((0,o.mW)((0,o.tJ)((0,i.n)((function(e){return{currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null,setCurrentAgentSettings:function(t){return e({currentAgentSettings:t})},setCurrentRobotSettings:function(t){return e({currentRobotSettings:t})},setCurrentWorkgroupSettings:function(t){return e({currentWorkgroupSettings:t})},clear:function(){return e({currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null})}}})),{name:r.rpR})))},39122:function(e,t,n){n.d(t,{$:function(){return d}});var r=n(73193),a=n.n(r),o=n(76711),i=n.n(o),u=n(36265),s=n(74543),l=n(21152),c=n(72083),d=(0,s.Ue)()((0,l.mW)((0,l.tJ)((0,c.n)((function(e,t){return{workgroupResult:{data:{content:[]}},currentWorkgroup:{uid:"",nickname:"",avatar:"",description:"",orgUid:""},insertWorkgroup:function(t){e((function(e){e.workgroupResult.data.content.unshift(t)}))},updateWorkgroup:function(t){e((function(e){var n=e.workgroupResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n[r]=t:console.warn("Workgroup with uid ".concat(t.uid," not found."))}))},deleteWorkgroup:function(t){e((function(e){var n=e.workgroupResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n.splice(r,1):console.warn("Workgroup with uid ".concat(t.uid," not found."))}))},setWorkgroupResult:function(n){var r;(e({workgroupResult:n}),""===t().currentWorkgroup.uid)&&((null===(r=n.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentWorkgroup:n.data.content[0]}))},setCurrentWorkgroup:function(n){var r=t().workgroupResult.data.content,o=r.findIndex((function(e){return e.uid===n.uid}));if(-1!==o){var u=[].concat(i()(r.slice(0,o)),[n],i()(r.slice(o+1))),s=a()(a()({},t().workgroupResult),{},{data:{content:u}});e({workgroupResult:s,currentWorkgroup:n})}else console.warn("Workgroup with the specified uid not found."),e({currentWorkgroup:n})},deleteCurrentWorkgroup:function(n){var r=t().workgroupResult.data.content,o=r.findIndex((function(e){return e.uid===n}));-1!==o?e({workgroupResult:a()(a()({},t().workgroupResult),{},{data:{content:[].concat(i()(r.slice(0,o)),i()(r.slice(o+1)))}})}):console.warn("Workgroup not found in cache:",n),t().currentWorkgroup.uid===n&&e({currentWorkgroup:{uid:"",orgUid:""}})},deleteWorkgroupCache:function(){return e({},!0)}}})),{name:u.b6l})))}}]);