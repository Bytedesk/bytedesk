# 在线客服统计系统

## 数据存储策略

- 实时数据写入Redis
- 定时同步至MySQL
- 支持按小时、按天统计
- 支持四个维度统计：组织、工作组、客服、机器人

## 统计指标体系

### 1. 基础会话指标

- 当前在线客服数：处于可接待状态的客服数量
- 当前离线客服数：处于离线状态的客服数量
- 当前排队人数：处于排队状态的访客数量
- 当前会话数量：正在进行中的会话数量
- 当前最长等待时间：排队访客的最长等待时间

### 2. 会话流转指标

- 总流入会话量：包含访客来访和主动发起的会话
- 已接入会话量：成功分配给客服的会话数量
- 未接入会话量：放弃排队的会话数量
- 转接会话量：转接给其他客服的会话数量
- 邀请会话量：主动邀请产生的会话数量
- 超时转接量：因响应超时自动转接的数量

### 3. 时间指标

- 平均等待时间：从开始排队到接入的平均时长
- 平均首次响应时间：客服首次回复的平均时长
- 平均会话时长：单个会话的平均持续时间
- 最长响应时间：客服响应访客消息的最长时间
- 最短响应时间：客服响应访客消息的最短时间

### 4. 质量指标

- 接通率：已接入会话量/总流入会话量
- 放弃率：放弃排队会话量/总流入会话量
- 转接率：转接会话量/已接入会话量
- 满意度：满意评价数/评价总数
- 参评率：评价总数/已接入会话量
- 首次解决率：首次咨询即解决的比率

### 5. 消息指标

- 客服消息数：客服发送的消息总数
- 访客消息数：访客发送的消息总数
- 平均会话消息数：每个会话的平均消息量
- 会话回合数：客服与访客的对话往返次数

### 6. 机器人指标

- 机器人会话量：机器人处理的会话数量
- 机器人转人工量：转交人工客服的会话数量
- 机器人解决率：机器人成功解决的会话比率

### 7. 工作量指标

- 在线时长：客服在线状态的累计时间
- 忙碌时长：客服忙碌状态的累计时间
- 离线时长：客服离线状态的累计时间
- 累计会话量：客服完成的会话总量

## 技能组监控

- 工作组基本信息：名称、描述等
- 在线客服数：当前在线的客服数量
- 对话中用户数：正在服务的访客数量
- 排队情况：当前排队访客数及等待时间
- 会话指标：接通率、转接率、满意度等
- 工作量分布：各客服的工作量分配情况

## 客服监控

- 基本信息：工号、姓名、工位等
- 在线状态：在线、离线、忙碌等
- 会话数据：当前会话数、累计会话量
- 响应指标：平均响应时间、超时次数
- 服务质量：满意度、解决率、转接率
- 工作时长：上线时间、在线时长等

## 注意事项

1. 统计数据需要考虑时区因素
2. 历史数据的存储和清理策略
3. 实时统计与定时统计的数据一致性
4. 多维度统计时的性能优化
5. 统计数据的展示和导出功能
