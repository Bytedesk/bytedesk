"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4693],{15722:function(e,t,r){r.d(t,{Z:function(){return u}});var a=r(83910),s=r(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},o=r(54183),i=function(e,t){return s.createElement(o.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var u=s.forwardRef(i)},11090:function(e,t,r){r.d(t,{Z:function(){return u}});var a=r(83910),s=r(44194),n={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},o=r(54183),i=function(e,t){return s.createElement(o.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var u=s.forwardRef(i)},2484:function(e,t,r){r.d(t,{Z:function(){return u}});var a=r(83910),s=r(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},o=r(54183),i=function(e,t){return s.createElement(o.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var u=s.forwardRef(i)},93312:function(e,t,r){var a=r(94433),s=r(38956),n=r(44194),o=r(35865),i=r(31549),u=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],d=n.forwardRef((function(e,t){var r=e.fieldProps,n=e.unCheckedChildren,d=e.checkedChildren,l=e.proFieldProps,c=(0,s.Z)(e,u);return(0,i.jsx)(o.Z,(0,a.Z)({valueType:"switch",fieldProps:(0,a.Z)({unCheckedChildren:n,checkedChildren:d},r),ref:t,valuePropName:"checked",proFieldProps:l,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},c))}));t.Z=d},86684:function(e,t,r){var a=r(32906),s=r(94433),n=r(38956),o=r(81424),i=r(58867),u=r(31543),d=r(34573),l=r(44194),c=r(35865),f=r(31549),p=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],m="text",h=function(e){var t=(0,o.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,a.Z)(t,2),n=r[0],d=r[1];return(0,f.jsx)(i.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var r,a=t.getFieldValue(e.name||[]);return(0,f.jsx)(u.Z,(0,s.Z)((0,s.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return d(e)},content:(0,f.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,a),e.strengthText?(0,f.jsx)("div",{style:{marginTop:10},children:(0,f.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:n,children:e.children}))}})},x=function(e){var t=e.fieldProps,r=e.proFieldProps,a=(0,n.Z)(e,p);return(0,f.jsx)(c.Z,(0,s.Z)({valueType:m,fieldProps:t,filedConfig:{valueType:m},proFieldProps:r},a))};x.Password=function(e){var t=e.fieldProps,r=e.proFieldProps,o=(0,n.Z)(e,g),i=(0,l.useState)(!1),u=(0,a.Z)(i,2),p=u[0],x=u[1];return null!=t&&t.statusRender&&o.name?(0,f.jsx)(h,{name:o.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:p,onOpenChange:x,children:(0,f.jsx)("div",{children:(0,f.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:(0,s.Z)((0,s.Z)({},(0,d.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==t||null===(r=t.onBlur)||void 0===r||r.call(t,e),x(!1)},onClick:function(e){var r;null==t||null===(r=t.onClick)||void 0===r||r.call(t,e),x(!0)}}),proFieldProps:r,filedConfig:{valueType:m}},o))})}):(0,f.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:m}},o))},x.displayName="ProFormComponent",t.Z=x},13847:function(e,t,r){var a=r(94433),s=r(38956),n=r(44194),o=r(35865),i=r(31549),u=["fieldProps","proFieldProps"],d=function(e,t){var r=e.fieldProps,n=e.proFieldProps,d=(0,s.Z)(e,u);return(0,i.jsx)(o.Z,(0,a.Z)({ref:t,valueType:"textarea",fieldProps:r,proFieldProps:n},d))};t.Z=n.forwardRef(d)},48337:function(e,t,r){r.d(t,{Cd:function(){return M},E9:function(){return c},Rd:function(){return x},fA:function(){return p},ul:function(){return m}});var a=r(90819),s=r.n(a),n=r(73193),o=r.n(n),i=r(89933),u=r.n(i),d=r(6844),l=r(19736);function c(e){return f.apply(this,arguments)}function f(){return(f=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/role/query/org",{method:"GET",params:o()(o()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/role/create",{method:"POST",data:o()(o()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/role/update",{method:"POST",data:o()(o()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return v.apply(this,arguments)}function v(){return(v=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/role/delete",{method:"POST",data:o()(o()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return y.apply(this,arguments)}function y(){return(y=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/role/reset/level",{method:"POST",data:o()(o()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},8597:function(e,t,r){r.r(t),r.d(t,{default:function(){return pe}});var a=r(32540),s=r(5553),n=r(61266),o=r(31167),i=r(73193),u=r.n(i),d=r(84176),l=r.n(d),c=r(90819),f=r.n(c),p=r(89933),g=r.n(p),m=r(45332),h=r.n(m),x=r(93527),v=r(24008),M=r(48337),y=r(10162),w=r(11090),b=r(86307),k=r(5089),j=r(9428),Z=r(66810),S=r(48907),R=r(77359),I=r(3925),C=r(44194),P=r(14888),T=r(30064),F=r(86684),A=r(93312),z=r(58867),U=r(61689),E=r(19736),O=r(31549),D=function(e){var t=e.isEdit,r=e.user,a=e.open,s=e.onClose,n=e.onSubmit,o=z.Z.useForm(),i=h()(o,1)[0],d=(0,E.useIntl)(),l=(0,P.u)((function(e){return e.currentOrg}));(0,C.useEffect)((function(){t?i.setFieldsValue({username:null==r?void 0:r.username,nickname:null==r?void 0:r.nickname,email:null==r?void 0:r.email,emailVerified:null==r?void 0:r.emailVerified,mobile:null==r?void 0:r.mobile,mobileVerified:null==r?void 0:r.mobileVerified,enabled:null==r?void 0:r.enabled}):(i.resetFields(),i.setFieldsValue({enabled:!0}))}),[a]);return(0,O.jsx)(U.Z,{title:t?(0,O.jsx)(E.FormattedMessage,{id:"pages.user.edit",defaultMessage:"Edit User"}):(0,O.jsx)(E.FormattedMessage,{id:"pages.user.create",defaultMessage:"Create User"}),onClose:s,open:a,width:600,extra:(0,O.jsxs)(j.Z,{children:[(0,O.jsx)(I.ZP,{onClick:s,children:(0,O.jsx)(E.FormattedMessage,{id:"pages.common.cancel"})}),(0,O.jsx)(I.ZP,{onClick:function(){i.validateFields().then((function(e){null==r||!r.superUser||!1!==e.enabled&&!1!==e.mobileVerified&&!1!==e.emailVerified?n(u()(u()(u()({},r),e),{},{orgUid:null==l?void 0:l.uid})):x.yw.error(d.formatMessage({id:"pages.user.superUser.notAllow"}))})).catch((function(e){console.log("Form errors:",e),x.yw.error(d.formatMessage({id:"pages.form.error"}))}))},type:"primary",children:(0,O.jsx)(E.FormattedMessage,{id:"pages.common.save"})})]}),children:(0,O.jsxs)(T.A,{form:i,submitter:!1,children:[(0,O.jsx)(F.Z,{name:"username",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.username"}),rules:[{required:!0,message:d.formatMessage({id:"pages.user.username.required"})}]}),(0,O.jsx)(F.Z,{name:"nickname",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.nickname"}),rules:[{required:!0,message:d.formatMessage({id:"pages.user.nickname.required"})}]}),(0,O.jsx)(F.Z,{name:"email",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.email"}),rules:[{required:!0,message:d.formatMessage({id:"pages.user.email.required"})},{type:"email",message:d.formatMessage({id:"pages.user.email.invalid"})}]}),(0,O.jsx)(A.Z,{name:"emailVerified",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.email.verified"})}),(0,O.jsx)(F.Z,{name:"mobile",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.mobile"}),rules:[{required:!0,message:d.formatMessage({id:"pages.user.mobile.required"})},{pattern:/^1[3-9]\d{9}$/,message:d.formatMessage({id:"pages.user.mobile.invalid"})}]}),(0,O.jsx)(A.Z,{name:"mobileVerified",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.mobile.verified"})}),(0,O.jsx)(A.Z,{name:"enabled",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.enabled",defaultMessage:"Status"}),checkedChildren:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.status.enabled",defaultMessage:"启用"}),unCheckedChildren:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.status.disabled",defaultMessage:"禁用"})}),(0,O.jsx)(F.Z.Password,{name:"password",label:(0,O.jsx)(E.FormattedMessage,{id:"pages.user.password"}),rules:[{required:!t,message:d.formatMessage({id:"pages.user.password.required"})}]})]})})},B=r(47598),q=r(4441),N=r(44679),L=r(96596),Y=r.n(L),V=r(6844),H=r(65819),J=r(36125),G=["current","pageSize"],K=function(){var e=(0,E.useIntl)(),t=(0,C.useRef)(),r=(0,N.Z)().translateString,a=(0,C.useState)(!0),s=h()(a,2),n=s[0],o=s[1],i=(0,C.useState)(),d=h()(i,2),c=d[0],p=d[1],m=(0,C.useState)(!1),T=h()(m,2),F=T[0],A=T[1],z=(0,C.useState)(1),U=h()(z,2),L=U[0],K=U[1],W=(0,C.useState)(10),X=h()(W,2),Q=X[0],$=X[1],_=(0,P.u)((function(e){return e.currentOrg})),ee=(0,q.Z)((function(e){return{setRoleResult:e.setRoleResult,setRoleResultPlatform:e.setRoleResultPlatform}})),te=ee.setRoleResult,re=ee.setRoleResultPlatform,ae=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:e.formatMessage({id:"pages.common.search",defaultMessage:"搜索"}),dataIndex:"searchText",hideInTable:!0,fieldProps:{placeholder:e.formatMessage({id:"pages.user.searchPlaceholder",defaultMessage:"搜索用户名/昵称/邮箱/手机号/组织"})}},{title:e.formatMessage({id:"uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:e.formatMessage({id:"pages.user.username"}),dataIndex:"username",copyable:!0},{title:e.formatMessage({id:"pages.user.nickname"}),dataIndex:"nickname",render:function(e,t){var a=r(t.nickname);return a?(0,O.jsx)(k.Z.Text,{copyable:{text:a},children:a}):"-"}},{title:e.formatMessage({id:"pages.user.email"}),dataIndex:"email",width:300,render:function(t,r){return(0,O.jsxs)(j.Z,{size:4,children:[r.email?(0,O.jsx)(k.Z.Text,{copyable:{text:r.email},children:r.email}):(0,O.jsx)("span",{children:"-"}),(0,O.jsx)(Z.Z,{color:r.emailVerified?"success":"default",children:r.emailVerified?e.formatMessage({id:"pages.user.email.verified.yes"}):e.formatMessage({id:"pages.user.email.verified.no"})})]})}},{title:e.formatMessage({id:"pages.user.mobile"}),dataIndex:"mobile",width:250,render:function(t,r){return(0,O.jsxs)(j.Z,{size:4,children:[r.mobile?(0,O.jsx)(k.Z.Text,{copyable:{text:r.mobile},children:r.mobile}):(0,O.jsx)("span",{children:"-"}),(0,O.jsx)(Z.Z,{color:r.mobileVerified?"success":"default",children:r.mobileVerified?e.formatMessage({id:"pages.user.mobile.verified.yes"}):e.formatMessage({id:"pages.user.mobile.verified.no"})})]})}},{title:e.formatMessage({id:"pages.user.organization"}),dataIndex:"currentOrganization",render:function(e,t){var r,a=null===(r=t.currentOrganization)||void 0===r?void 0:r.name;return a?(0,O.jsx)(k.Z.Text,{copyable:{text:a},children:(0,O.jsx)(Z.Z,{color:"blue",children:a})}):"-"},fieldProps:{placeholder:e.formatMessage({id:"pages.user.organization.searchPlaceholder",defaultMessage:"搜索组织名称"})}},{title:e.formatMessage({id:"pages.user.roles"}),dataIndex:"currentRoles",hideInSearch:!0,width:250,render:function(e,t){return t.currentRoles&&t.currentRoles.length>0?(0,O.jsx)(j.Z,{wrap:!0,children:t.currentRoles.map((function(e,t){return(0,O.jsx)(Z.Z,{color:"green",children:r(e.name)},t)}))}):null}},{title:e.formatMessage({id:"pages.user.description"}),dataIndex:"description",hideInSearch:!0,hideInTable:!0},{title:e.formatMessage({id:"pages.user.enabled"}),dataIndex:"enabled",hideInSearch:!0,width:100,render:function(t,r){return r.enabled?e.formatMessage({id:"pages.user.status.enabled",defaultMessage:"启用"}):e.formatMessage({id:"pages.user.status.disabled",defaultMessage:"禁用"})},valueEnum:{true:{text:e.formatMessage({id:"pages.user.status.enabled",defaultMessage:"启用"}),status:"Success"},false:{text:e.formatMessage({id:"pages.user.status.disabled",defaultMessage:"禁用"}),status:"Error"}}},{title:e.formatMessage({id:"pages.user.superUser"}),dataIndex:"superUser",hideInSearch:!0,width:100,render:function(t,r){return r.superUser?e.formatMessage({id:"pages.user.superUser.yes",defaultMessage:"是"}):e.formatMessage({id:"pages.user.superUser.no",defaultMessage:"否"})},valueEnum:{true:{text:e.formatMessage({id:"pages.user.superUser.yes",defaultMessage:"是"}),status:"Success"},false:{text:e.formatMessage({id:"pages.user.superUser.no",defaultMessage:"否"}),status:"Default"}}},{title:e.formatMessage({id:"pages.user.sex",defaultMessage:"性别"}),dataIndex:"sex",hideInSearch:!0,width:80,render:function(t,r){var a={MALE:e.formatMessage({id:"pages.user.sex.male",defaultMessage:"男"}),FEMALE:e.formatMessage({id:"pages.user.sex.female",defaultMessage:"女"}),UNKNOWN:e.formatMessage({id:"pages.user.sex.unknown",defaultMessage:"未知"})};return r.sex?a[r.sex]||r.sex:"-"}},{title:e.formatMessage({id:"pages.user.registerSource",defaultMessage:"注册来源"}),dataIndex:"registerSource",hideInSearch:!0,width:120,render:function(t,r){var a={USERNAME:e.formatMessage({id:"pages.user.registerSource.username",defaultMessage:"用户名"}),EMAIL:e.formatMessage({id:"pages.user.registerSource.email",defaultMessage:"邮箱"}),MOBILE:e.formatMessage({id:"pages.user.registerSource.mobile",defaultMessage:"手机"}),GITHUB:"GitHub",WECHAT:e.formatMessage({id:"pages.user.registerSource.wechat",defaultMessage:"微信"}),GOOGLE:"Google",DINGTALK:e.formatMessage({id:"pages.user.registerSource.dingtalk",defaultMessage:"钉钉"}),FEISHU:e.formatMessage({id:"pages.user.registerSource.feishu",defaultMessage:"飞书"}),FACEBOOK:"Facebook",DOUYIN:e.formatMessage({id:"pages.user.registerSource.douyin",defaultMessage:"抖音"}),APPLE:"Apple",LDAP:"LDAP",OIDC:"OIDC",OPENID:"OpenID",CAS:"CAS",ADMIN:e.formatMessage({id:"pages.user.registerSource.admin",defaultMessage:"管理员创建"}),IMPORT:e.formatMessage({id:"pages.user.registerSource.import",defaultMessage:"导入"}),UNKNOWN:e.formatMessage({id:"pages.user.registerSource.unknown",defaultMessage:"未知"})};return r.registerSource?a[r.registerSource]||r.registerSource:"-"}},{title:e.formatMessage({id:"pages.user.createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.createdAt?Y()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):""}},{title:e.formatMessage({id:"pages.user.updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.updatedAt?Y()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):""}}],se=[].concat(ae,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:120,fixed:"right",render:function(t,r,a,s){return[(0,O.jsx)("a",{onClick:function(){ie(r)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),!r.superUser&&(0,O.jsxs)(C.Fragment,{children:[(0,O.jsx)(S.Z,{type:"vertical"},"divider"),(0,O.jsx)(R.Z,{title:e.formatMessage({id:"pages.common.deleteConfirm",defaultMessage:"Are you sure to delete {name}?"},{name:r.nickname||r.username}),onConfirm:function(){return ue(r)},okText:e.formatMessage({id:"pages.common.ok",defaultMessage:"OK"}),cancelText:e.formatMessage({id:"pages.common.cancel",defaultMessage:"Cancel"}),children:(0,O.jsx)("a",{children:e.formatMessage({id:"pages.common.delete",defaultMessage:"Delete"})},"delete")},"delete")]},"delete-fragment")]}}]),ne=(0,B.v)((function(e){return e.currentCategory})),oe=function(){p(void 0),o(!1),A(!0)},ie=function(e){p(e),o(!0),A(!0)},ue=function(){var a=g()(f()().mark((function a(s){var n,o;return f()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!s.superUser){a.next=3;break}return x.yw.error(e.formatMessage({id:"pages.user.superUser.notDelete"})),a.abrupt("return");case 3:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),a.prev=4,a.next=7,(0,v.h8)({uid:s.uid});case 7:n=a.sent,x.yw.destroy(),200===n.code?(x.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete successful"})),null===(o=t.current)||void 0===o||o.reloadAndRest()):x.yw.error(r(n.message)||e.formatMessage({id:"delete.error",defaultMessage:"Delete failed"})),a.next=17;break;case 12:a.prev=12,a.t0=a.catch(4),x.yw.destroy(),x.yw.error(e.formatMessage({id:"delete.error",defaultMessage:"Delete failed"})),console.error("Delete user error:",a.t0);case 17:case"end":return a.stop()}}),a,null,[[4,12]])})));return function(e){return a.apply(this,arguments)}}(),de=function(){var r=g()(f()().mark((function r(a){var s,o;return f()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(J.Z.debug("handleSubmitDrawer",a),n?x.yw.loading(e.formatMessage({id:"updating"})):x.yw.loading(e.formatMessage({id:"creating"})),!n){r.next=8;break}return r.next=5,(0,v.Nq)(a);case 5:r.t0=r.sent,r.next=11;break;case 8:return r.next=10,(0,v.r4)(a);case 10:r.t0=r.sent;case 11:s=r.t0,J.Z.debug("createUser response:",a,s),200===s.code?(x.yw.destroy(),x.yw.loading(e.formatMessage({id:"create.success"})),A(!1),null===(o=t.current)||void 0===o||o.reloadAndRest()):(x.yw.destroy(),x.yw.error(s.message));case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),le=function(){var t=g()(f()().mark((function t(){var r,a;return f()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading..."})),r={pageNumber:0,pageSize:100,orgUid:null==_?void 0:_.uid},t.next=4,(0,M.E9)(r);case 4:a=t.sent,J.Z.debug("queryRolesByOrg response ",a),200===a.code?(x.yw.destroy(),te(a)):(x.yw.destroy(),x.yw.error(a.message));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ce=function(){var t=g()(f()().mark((function t(){var r,a;return f()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading..."})),r={pageNumber:0,pageSize:100,level:V.Hxq},t.next=4,(0,M.E9)(r);case 4:a=t.sent,J.Z.debug("queryRolesBySuper response ",a),200===a.code?(x.yw.destroy(),re(a)):(x.yw.destroy(),x.yw.error(a.message));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,C.useEffect)((function(){le(),ce()}),[]),(0,C.useEffect)((function(){var e;J.Z.debug("currentCategory:",ne),null===(e=t.current)||void 0===e||e.reloadAndRest()}),[ne]);var fe=function(){var e=g()(f()().mark((function e(){var t;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J.Z.debug("handleExportExcel",L,Q),t=localStorage.getItem(V.LA8),window.open((0,H.kG)()+"/api/v1/user/export?"+new URLSearchParams({pageNumber:String(L-1),pageSize:String(Q),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(b.Z,{columns:se,actionRef:t,cardBordered:!0,scroll:{x:2500},request:function(){var t=g()(f()().mark((function t(a,s,n){var o,i,d,c,p;return f()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return J.Z.debug("request:",a,s,n),x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),o=a.current,i=a.pageSize,d=l()(a,G),K(o),$(i),c=u()({pageNumber:o-1,pageSize:i,superUser:!0},d),t.next=8,(0,v._9)(c);case 8:return p=t.sent,J.Z.debug("getAllUsers response:",c,p),x.yw.destroy(),200===p.code||x.yw.error(r(p.message)),t.abrupt("return",{data:null==p?void 0:p.data.content,success:!0,total:null==p?void 0:p.data.totalElements});case 13:case"end":return t.stop()}}),t)})));return function(e,r,a){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:Q,showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){J.Z.debug("pagination onChange:",e,t),K(e),$(t)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"pages.user.list",defaultMessage:"用户列表"}),toolBarRender:function(){return[(0,O.jsx)(I.ZP,{icon:(0,O.jsx)(y.Z,{}),type:"primary",onClick:oe,children:e.formatMessage({id:"pages.common.create",defaultMessage:"Create"})},"button"),(0,O.jsx)(I.ZP,{icon:(0,O.jsx)(w.Z,{}),type:"primary",onClick:fe,children:e.formatMessage({id:"export",defaultMessage:"Export"})},"button")]}}),F&&(0,O.jsx)(D,{isEdit:n,open:F,user:c,onClose:function(){A(!1)},onSubmit:de})]})},W=r(91806),X=r(86222),Q=r.n(X),$=r(66467),_=r(59304),ee=r(54881),te=r(2484),re=r(46141),ae=r(71277),se=r(15057),ne=["current","pageSize"],oe=function(e){var t=e.superUser,r=(0,E.useIntl)(),a=(0,C.useRef)(),s=(0,P.u)((function(e){return e.currentOrg})),n=(0,C.useState)(1),o=h()(n,2),i=o[0],d=o[1],c=(0,C.useState)(10),p=h()(c,2),m=p[0],v=p[1],M=(0,C.useState)({}),k=h()(M,2),j=k[0],Z=k[1],S=(0,C.useState)(0),T=h()(S,2),F=T[0],A=T[1],z=(0,C.useState)([]),U=h()(z,2),D=U[0],B=U[1],q=(0,C.useState)([]),N=h()(q,2),L=N[0],Y=N[1],J=(0,C.useState)(!1),G=h()(J,2),K=G[0],W=G[1],X=(0,C.useState)(),oe=h()(X,2),ie=oe[0],ue=oe[1],de=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,O.jsx)(E.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.whiteIp.ip"}),dataIndex:"ip",copyable:!0,width:150,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.whiteIp.ip.tooltip"})},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.white.description"}),dataIndex:"description",copyable:!0,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.white.description.tooltip"})},{title:(0,O.jsx)(E.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:180,sorter:!0,hideInSearch:!0,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"message.createdAt.tooltip"})}],le=[].concat(de,[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:120,fixed:"right",render:function(e,t,a,s){return[(0,O.jsx)(I.ZP,{size:"small",type:"link",icon:(0,O.jsx)(_.Z,{}),onClick:function(){return pe(t)},children:r.formatMessage({id:"edit",defaultMessage:"编辑"})},"edit"),(0,O.jsx)(R.Z,{title:r.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==t?void 0:t.ip,"】？"),onConfirm:function(){return fe(t)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),children:(0,O.jsx)(I.ZP,{size:"small",type:"link",danger:!0,children:r.formatMessage({id:"visitor.whiteIp.delete",defaultMessage:"Delete"})})},"delete")]}}]),ce=function(){var e=g()(f()().mark((function e(r,a,n){var o,d;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",r,a,n),o=localStorage.getItem(V.LA8),d=u()({orgUid:t?"":null==s?void 0:s.uid,accessToken:o||"",exportType:r},j),"current"===r?(d.pageNumber=String(i-1),d.pageSize=String(m)):"all"===r?(d.pageNumber="0",d.pageSize="1000"):"range"===r&&void 0!==a&&void 0!==n&&(d.pageNumber=String(a),d.pageSize=String(n)),window.open((0,H.kG)()+"/api/v1/ip/white/export?"+new URLSearchParams(d).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),fe=function(){var e=g()(f()().mark((function e(t){var s,n;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.prev=1,e.next=4,(0,$.QE)(t.uid);case 4:s=e.sent,console.log("delete response:",s),200===s.code?(null==a||null===(n=a.current)||void 0===n||n.reload(),x.yw.success(r.formatMessage({id:"delete.success"}))):x.yw.error(r.formatMessage({id:"delete.error"})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),x.yw.error(r.formatMessage({id:"delete.error"}));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),pe=function(e){ue(e),W(!0)},ge=function(){ue(void 0),W(!0)},me=function(){var e=g()(f()().mark((function e(){var t,s,n,o,i,u;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==L.length){e.next=3;break}return x.yw.warning(r.formatMessage({id:"batch.noselection",defaultMessage:"请选择需要处理的项目"})),e.abrupt("return");case 3:x.yw.loading(r.formatMessage({id:"processing",defaultMessage:"处理中..."})),s=0,n=0,o=Q()(L),e.prev=7,o.s();case 9:if((i=o.n()).done){e.next=23;break}return u=i.value,e.prev=11,e.next=14,(0,$.QE)(u.uid);case 14:200===e.sent.code?s++:n++,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),n++;case 21:e.next=9;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(7),o.e(e.t1);case 28:return e.prev=28,o.f(),e.finish(28);case 31:x.yw.destroy(),0===n?x.yw.success(r.formatMessage({id:"batch.delete.success",defaultMessage:"成功删除 {count} 条白名单"},{count:s})):x.yw.warning(r.formatMessage({id:"batch.delete.partial",defaultMessage:"成功删除 {success} 条白名单，失败 {fail} 条"},{success:s,fail:n})),B([]),Y([]),null===(t=a.current)||void 0===t||t.reloadAndRest();case 36:case"end":return e.stop()}}),e,null,[[7,25,28,31],[11,18]])})));return function(){return e.apply(this,arguments)}}(),he=function(e){for(var t=[],r=1e3,a=Math.ceil(e/r),s=function(){var a=n,s=n*r+1,o=Math.min((n+1)*r,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return ce("range",a,r)}})},n=0;n<a;n++)s();return t},xe={selectedRowKeys:D,onChange:function(e,t){B(e),Y(t)}};return(0,O.jsxs)(C.Fragment,{children:[(0,O.jsx)(b.Z,{columns:le,actionRef:a,cardBordered:!0,rowSelection:xe,scroll:{x:800},request:function(){var e=g()(f()().mark((function e(r,a,n){var o,i,c,p,g,m,h,M;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.current,i=r.pageSize,c=l()(r,ne),d(o),v(i),Z(c),p=void 0,g=void 0,a&&Object.keys(a).length>0&&(m=Object.keys(a)[0],p=m,g="ascend"===a[m]?"ascend":"descend"),h=u()(u()({pageNumber:r.current-1,pageSize:i,orgUid:null==s?void 0:s.uid},c),{},{sortBy:p,sortDirection:g,superUser:t}),e.next=10,(0,$.Fx)(h);case 10:return M=e.sent,console.log("queryIpWhites response:",M,h),200===M.code?A(null==M?void 0:M.data.totalElements):x.yw.error(M.message),e.abrupt("return",{data:null==M?void 0:M.data.content,success:!0,total:null==M?void 0:M.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e,t){d(e),v(t),console.log("page:",e,"size:",t)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"visitor.whiteIp.list"}),toolBarRender:function(){return function(){var e=[];e.push((0,O.jsx)(I.ZP,{type:"primary",icon:(0,O.jsx)(y.Z,{}),onClick:ge,children:r.formatMessage({id:"visitor.whiteIp.add",defaultMessage:"添加白名单IP"})},"add"));var t=[];D.length>0&&(t.push({key:"batchDelete",icon:(0,O.jsx)(ee.Z,{}),danger:!0,label:r.formatMessage({id:"batch.delete",defaultMessage:"批量删除白名单"})+" (".concat(D.length,")"),onClick:function(){re.Z.confirm({title:r.formatMessage({id:"batch.deleteTip",defaultMessage:"删除白名单确认"}),content:"".concat(r.formatMessage({id:"batch.deleteAffirm",defaultMessage:"确定要删除"})," ").concat(D.length," ").concat(r.formatMessage({id:"items",defaultMessage:"项"}),"?"),onOk:me,okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"})})}}),e.push((0,O.jsx)(ae.Z,{menu:{items:t},placement:"bottom",children:(0,O.jsxs)(I.ZP,{type:"primary",danger:!0,children:[r.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})," (",D.length,")",(0,O.jsx)(te.Z,{})]})},"batchOperations")));var a=[{key:"export-current",icon:(0,O.jsx)(w.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return ce("current")}}];return F>0&&(F<=1e3?a.push({key:"export-all",icon:(0,O.jsx)(w.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(F,"条)"),onClick:function(){return ce("all")}}):a.push({key:"export-range",icon:(0,O.jsx)(w.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(F,"条)"),children:he(F)})),e.push((0,O.jsx)(ae.Z,{menu:{items:a},placement:"bottom",children:(0,O.jsxs)(I.ZP,{type:"primary",icon:(0,O.jsx)(w.Z,{}),children:[r.formatMessage({id:"export",defaultMessage:"导出"}),(0,O.jsx)(te.Z,{})]})},"exportOperations")),e}()}}),(0,O.jsx)(se.Z,{visible:K,onClose:function(){return W(!1)},onSuccess:function(){var e;null===(e=a.current)||void 0===e||e.reload()},type:"white",editData:ie,superUser:t})]})};function ie(e){return ue.apply(this,arguments)}function ue(){return(ue=g()(f()().mark((function e(t){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,E.request)("/api/v1/ip/access/query/org",{method:"GET",params:u()(u()({},t),{},{channel:V.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return le.apply(this,arguments)}function le(){return(le=g()(f()().mark((function e(t){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,E.request)("/api/v1/ip/access/delete",{method:"POST",data:{uid:t,channel:V.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ce=["current","pageSize"],fe=function(e){var t=e.superUser,r=(0,E.useIntl)(),a=(0,C.useRef)(),s=(0,P.u)((function(e){return e.currentOrg})),n=(0,C.useState)(1),o=h()(n,2),i=o[0],d=o[1],c=(0,C.useState)(10),p=h()(c,2),m=p[0],v=p[1],M=(0,C.useState)({}),y=h()(M,2),k=y[0],j=y[1],Z=(0,C.useState)(0),S=h()(Z,2),T=S[0],F=S[1],A=(0,C.useState)([]),z=h()(A,2),U=z[0],D=z[1],B=(0,C.useState)([]),q=h()(B,2),N=q[0],L=q[1],J=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,O.jsx)(E.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.ip"}),dataIndex:"ip",copyable:!0,width:150,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.ip.tooltip"})},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.ipLocation"}),dataIndex:"ipLocation",width:200,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.ipLocation.tooltip"})},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.endpoint"}),dataIndex:"endpoint",tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.endpoint.tooltip"})},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.params"}),dataIndex:"params",tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.params.tooltip"}),ellipsis:!0},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.accessCount"}),dataIndex:"accessCount",width:100,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.accessCount.tooltip"})},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.accessTime"}),dataIndex:"accessTime",width:180,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.accessTime.tooltip"}),render:function(e){return e?Y()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.lastAccessTime"}),dataIndex:"lastAccessTime",width:180,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"visitor.accessIp.lastAccessTime.tooltip"}),render:function(e){return e?Y()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,O.jsx)(E.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:180,sorter:!0,hideInSearch:!0,tooltip:(0,O.jsx)(E.FormattedMessage,{id:"message.createdAt.tooltip"}),render:function(e){return e?Y()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"-"}}],G=[].concat(J,[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:120,fixed:"right",render:function(e,t,a,s){return[(0,O.jsx)(R.Z,{title:r.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==t?void 0:t.ip,"】？"),onConfirm:function(){return W(t)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),children:(0,O.jsx)(I.ZP,{size:"small",type:"link",danger:!0,children:r.formatMessage({id:"visitor.accessIp.delete",defaultMessage:"Delete"})})},"delete")]}}]),K=function(){var e=g()(f()().mark((function e(r,a,n){var o,d;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",r,a,n),o=localStorage.getItem(V.LA8),d=u()({orgUid:t?"":null==s?void 0:s.uid,accessToken:o||"",exportType:r},k),"current"===r?(d.pageNumber=String(i-1),d.pageSize=String(m)):"all"===r?(d.pageNumber="0",d.pageSize="1000"):"range"===r&&void 0!==a&&void 0!==n&&(d.pageNumber=String(a),d.pageSize=String(n)),window.open((0,H.kG)()+"/api/v1/ip/access/export?"+new URLSearchParams(d).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),W=function(){var e=g()(f()().mark((function e(t){var s,n;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.prev=1,e.next=4,de(t.uid);case 4:s=e.sent,console.log("delete response:",s),200===s.code?(null==a||null===(n=a.current)||void 0===n||n.reload(),x.yw.success(r.formatMessage({id:"delete.success"}))):x.yw.error(r.formatMessage({id:"delete.error"})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),x.yw.error(r.formatMessage({id:"delete.error"}));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=g()(f()().mark((function e(){var t,s,n,o,i,u;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==N.length){e.next=3;break}return x.yw.warning(r.formatMessage({id:"batch.noselection",defaultMessage:"请选择需要处理的项目"})),e.abrupt("return");case 3:x.yw.loading(r.formatMessage({id:"processing",defaultMessage:"处理中..."})),s=0,n=0,o=Q()(N),e.prev=7,o.s();case 9:if((i=o.n()).done){e.next=23;break}return u=i.value,e.prev=11,e.next=14,de(u.uid);case 14:200===e.sent.code?s++:n++,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),n++;case 21:e.next=9;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(7),o.e(e.t1);case 28:return e.prev=28,o.f(),e.finish(28);case 31:x.yw.destroy(),0===n?x.yw.success(r.formatMessage({id:"batch.delete.success",defaultMessage:"成功删除 {count} 条访问记录"},{count:s})):x.yw.warning(r.formatMessage({id:"batch.delete.partial",defaultMessage:"成功删除 {success} 条访问记录，失败 {fail} 条"},{success:s,fail:n})),D([]),L([]),null===(t=a.current)||void 0===t||t.reloadAndRest();case 36:case"end":return e.stop()}}),e,null,[[7,25,28,31],[11,18]])})));return function(){return e.apply(this,arguments)}}(),$=function(e){for(var t=[],r=1e3,a=Math.ceil(e/r),s=function(){var a=n,s=n*r+1,o=Math.min((n+1)*r,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return K("range",a,r)}})},n=0;n<a;n++)s();return t},_={selectedRowKeys:U,onChange:function(e,t){D(e),L(t)}};return(0,O.jsx)(b.Z,{columns:G,actionRef:a,cardBordered:!0,rowSelection:_,scroll:{x:2e3},request:function(){var e=g()(f()().mark((function e(r,a,n){var o,i,c,p,g,m,h,M;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.current,i=r.pageSize,c=l()(r,ce),d(o),v(i),j(c),p=void 0,g=void 0,a&&Object.keys(a).length>0&&(m=Object.keys(a)[0],p=m,g="ascend"===a[m]?"ascend":"descend"),h=u()(u()({pageNumber:r.current-1,pageSize:i,orgUid:null==s?void 0:s.uid},c),{},{sortBy:p,sortDirection:g,superUser:t}),e.next=10,ie(h);case 10:return M=e.sent,console.log("queryIpAccesses response:",M,h),200===M.code?F(null==M?void 0:M.data.totalElements):x.yw.error(M.message),e.abrupt("return",{data:null==M?void 0:M.data.content,success:!0,total:null==M?void 0:M.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e,t){d(e),v(t),console.log("page:",e,"size:",t)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"visitor.accessIp.list"}),toolBarRender:function(){return function(){var e=[],t=[];U.length>0&&(t.push({key:"batchDelete",icon:(0,O.jsx)(ee.Z,{}),danger:!0,label:r.formatMessage({id:"batch.delete",defaultMessage:"批量删除访问记录"})+" (".concat(U.length,")"),onClick:function(){re.Z.confirm({title:r.formatMessage({id:"batch.deleteTip",defaultMessage:"删除访问记录确认"}),content:"".concat(r.formatMessage({id:"batch.deleteAffirm",defaultMessage:"确定要删除"})," ").concat(U.length," ").concat(r.formatMessage({id:"items",defaultMessage:"项"}),"?"),onOk:X,okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"})})}}),e.push((0,O.jsx)(ae.Z,{menu:{items:t},placement:"bottom",children:(0,O.jsxs)(I.ZP,{type:"primary",danger:!0,children:[r.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})," (",U.length,")",(0,O.jsx)(te.Z,{})]})},"batchOperations")));var a=[{key:"export-current",icon:(0,O.jsx)(w.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return K("current")}}];return T>0&&(T<=1e3?a.push({key:"export-all",icon:(0,O.jsx)(w.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(T,"条)"),onClick:function(){return K("all")}}):a.push({key:"export-range",icon:(0,O.jsx)(w.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(T,"条)"),children:$(T)})),e.push((0,O.jsx)(ae.Z,{menu:{items:a},placement:"bottom",children:(0,O.jsxs)(I.ZP,{type:"primary",icon:(0,O.jsx)(w.Z,{}),children:[r.formatMessage({id:"export",defaultMessage:"导出"}),(0,O.jsx)(te.Z,{})]})},"exportOperations")),e}()}})},pe=function(){var e=(0,E.useIntl)(),t=[{key:"user",label:e.formatMessage({id:"user"}),children:(0,O.jsx)(K,{})},{key:"visitor",label:e.formatMessage({id:"visitor.tab.all"}),children:(0,O.jsx)(n.Z,{superUser:!0})},{key:"browse",label:e.formatMessage({id:"browse.tab.all"}),children:(0,O.jsx)(W.Z,{superUser:!0})}];return!(0,H.Ox)()&&(0,H.OJ)()&&t.splice(2,0,{key:"black",label:e.formatMessage({id:"visitor.tab.black"}),children:(0,O.jsx)(a.Z,{superUser:!0})},{key:"blackIp",label:e.formatMessage({id:"visitor.tab.blackIp"}),children:(0,O.jsx)(s.Z,{superUser:!0})},{key:"whiteIp",label:e.formatMessage({id:"visitor.tab.whiteIp"}),children:(0,O.jsx)(oe,{superUser:!0})},{key:"accessIp",label:e.formatMessage({id:"visitor.tab.accessIp"}),children:(0,O.jsx)(fe,{superUser:!0})}),(0,O.jsx)(o.Z,{defaultActiveKey:"user",items:t,style:{padding:"10px"}})}},47598:function(e,t,r){r.d(t,{v:function(){return g}});var a=r(86222),s=r.n(a),n=r(73193),o=r.n(n),i=r(76711),u=r.n(i),d=r(6844),l=r(26557),c=r(26407),f=r(20744),p=r(36125);var g=(0,l.Ue)()((0,c.mW)((0,c.tJ)((0,f.n)((function(e,t){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:d.zBg,name:d.zBg},setCategoryResult:function(t){var r=function(e){var t=[];return e.data.content.forEach((function(e){var r={label:e.name,value:e.uid};t.push(r)})),t}(t),a=function(e){var t,r=(null==e||null===(t=e.data)||void 0===t?void 0:t.content)||[],a=function e(t){var r={title:t.name||"",key:t.uid||""};return t.children&&t.children.length>0&&(r.children=t.children.map((function(t){return e(t)}))),r};return r.filter((function(e){return e&&e.uid&&e.uid!==d.zBg})).map((function(e){return a(e)}))}(t),s=[{title:d.zBg,key:d.zBg}].concat(u()(a)),n={uid:d.zBg,name:d.zBg},i=o()(o()({},t),{},{data:o()(o()({},t.data),{},{content:[n].concat(u()(t.data.content))})});e({categoryResult:i,categoryTreeOptions:s,categorySelectOptions:r}),0===t.data.content.length&&e({currentCategory:{uid:d.zBg,name:d.zBg}})},insertCategory:function(t){e((function(e){e.categoryResult.data.content.unshift(t)}))},upgradeCategory:function(t){e((function(e){var r=e.categoryResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));-1!==a?r[a]=t:console.warn("Category with uid ".concat(t.uid," not found."))}))},setCurrentCategory:function(t){e({currentCategory:t})},resetDefaultCategory:function(){p.Z.log("resetDefaultCategory"),e({currentCategory:{uid:d.zBg,name:d.zBg}})},setCurrentCategoryUid:function(r){if(r!==d.zBg){var a=function e(t,r){if(t&&0!==t.length){var a,n=s()(t);try{for(n.s();!(a=n.n()).done;){var o=a.value;if((null==o?void 0:o.uid)===r)return o;var i=e(null==o?void 0:o.children,r);if(i)return i}}catch(e){n.e(e)}finally{n.f()}}}(t().categoryResult.data.content,r);e({currentCategory:null!=a?a:{uid:d.zBg,name:d.zBg}})}else e({currentCategory:{uid:d.zBg,name:d.zBg}})},deleteCategoryCache:function(){return e({},!0)}}})),{name:d.OMm})))},4441:function(e,t,r){r.d(t,{Z:function(){return c}});var a=r(73193),s=r.n(a),n=r(76711),o=r.n(n),i=r(6844),u=r(26557),d=r(26407),l=r(20744),c=(0,u.Ue)()((0,d.mW)((0,d.tJ)((0,l.n)((function(e,t){return{currentRole:{uid:"",orgUid:"",authorities:[]},currentRolePlatform:{uid:"",orgUid:"",authorities:[]},roleResult:{data:{content:[]}},roleResultPlatform:{data:{content:[]}},insertRole:function(t){e((function(e){e.roleResult.data.content.unshift(t)}))},insertRolePlatform:function(t){e((function(e){e.roleResultPlatform.data.content.unshift(t)}))},upgradeRole:function(t){e((function(e){var r=e.roleResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));-1!==a?r[a]=t:console.warn("Role with uid ".concat(t.uid," not found."))}))},upgradeRolePlatform:function(t){e((function(e){var r=e.roleResultPlatform.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));-1!==a?r[a]=t:console.warn("Role with uid ".concat(t.uid," not found."))}))},setRoleResult:function(r){var a;(e({roleResult:r}),""===t().currentRole.uid)&&((null===(a=r.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.length)>0&&e({currentRole:r.data.content[0]}))},setRoleResultPlatform:function(r){var a;(e({roleResultPlatform:r}),""===t().currentRolePlatform.uid)&&((null===(a=r.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.length)>0&&e({currentRolePlatform:r.data.content[0]}))},setCurrentRole:function(r){var a=t().roleResult.data.content,n=a.findIndex((function(e){return e.uid===r.uid}));if(-1!==n){var i=[].concat(o()(a.slice(0,n)),[r],o()(a.slice(n+1))),u=s()(s()({},t().roleResult),{},{data:{content:i}});e({roleResult:u,currentRole:r})}else console.warn("Role with the specified uid not found."),e({currentRole:r})},setCurrentRolePlatform:function(r){var a=t().roleResultPlatform.data.content,n=a.findIndex((function(e){return e.uid===r.uid}));if(-1!==n){var i=[].concat(o()(a.slice(0,n)),[r],o()(a.slice(n+1))),u=s()(s()({},t().roleResultPlatform),{},{data:{content:i}});e({roleResultPlatform:u,currentRolePlatform:r})}else console.warn("Role with the specified uid not found."),e({currentRolePlatform:r})},removeRole:function(r){var a=t().roleResult.data.content,n=a.findIndex((function(e){return e.uid===r}));-1!==n?e({roleResult:s()(s()({},t().roleResult),{},{data:{content:[].concat(o()(a.slice(0,n)),o()(a.slice(n+1)))}})}):console.warn("Role not found in cache:",r),t().currentRole.uid===r&&e({currentRole:{uid:"",orgUid:"",authorities:[]}})},removeRolePlatform:function(r){var a=t().roleResultPlatform.data.content,n=a.findIndex((function(e){return e.uid===r}));-1!==n?e({roleResult:s()(s()({},t().roleResult),{},{data:{content:[].concat(o()(a.slice(0,n)),o()(a.slice(n+1)))}})}):console.warn("Role not found in cache:",r),t().currentRolePlatform.uid===r&&e({currentRolePlatform:{uid:"",orgUid:"",authorities:[]}})},deleteRoleCache:function(){return e({},!0)}}})),{name:i.uaR})))}}]);