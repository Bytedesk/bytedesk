"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2206],{11090:function(e,t,a){a.d(t,{Z:function(){return o}});var r=a(83910),i=a(44194),s={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},l=a(54183),n=function(e,t){return i.createElement(l.Z,(0,r.Z)({},e,{ref:t,icon:s}))};var o=i.forwardRef(n)},2484:function(e,t,a){a.d(t,{Z:function(){return o}});var r=a(83910),i=a(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},l=a(54183),n=function(e,t){return i.createElement(l.Z,(0,r.Z)({},e,{ref:t,icon:s}))};var o=i.forwardRef(n)},46601:function(e,t,a){a.d(t,{GF:function(){return y},Nf:function(){return u},TM:function(){return f},XX:function(){return M},w_:function(){return h}});var r=a(90819),i=a.n(r),s=a(73193),l=a.n(s),n=a(89933),o=a.n(n),d=a(6844),c=a(19736);function u(e){return p.apply(this,arguments)}function p(){return(p=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/quality/appeal/query/org",{method:"GET",params:l()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/quality/appeal/create",{method:"POST",data:l()(l()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return g.apply(this,arguments)}function g(){return(g=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/quality/appeal/delete",{method:"POST",data:l()(l()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return v.apply(this,arguments)}function v(){return(v=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/quality/appeal/approve",{method:"POST",data:l()(l()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return x.apply(this,arguments)}function x(){return(x=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/quality/appeal/reject",{method:"POST",data:l()(l()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},73221:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var r=a(73193),i=a.n(r),s=a(84176),l=a.n(s),n=a(10154),o=a.n(n),d=a(86222),c=a.n(d),u=a(90819),p=a.n(u),f=a(89933),m=a.n(f),h=a(45332),g=a.n(h),y=a(44194),v=a(66810),M=a(1691),x=a(77359),q=a(3925),k=a(71277),j=a(80556),b=a(11090),w=a(54881),C=a(2484),Z=a(86307),I=a(19736),S=a(46601),E=a(96596),A=a.n(E),D=a(93527),P=a(14888),z=a(6844),N=a(48769),T=a(58867),R=a(61689),F=a(51891),B=a(83103),Y=a(98986),O=a(96123),H=a(60115),L=a(90297),G=a(31549),J=N.Z.TextArea,X=function(e){var t,a,r,i,s,l,n,o,d,c,u,f=e.visible,h=e.onClose,M=e.record,x=e.onSuccess,k=(0,I.useIntl)(),j=T.Z.useForm(),b=g()(j,1)[0],w=(0,y.useState)(!1),C=g()(w,2),Z=C[0],E=C[1],N=(0,y.useState)(null),X=g()(N,2),U=X[0],V=X[1],_=(0,P.u)((function(e){return e.currentOrg})),W=function(){var e=m()(p()().mark((function e(t){var a,r,i,s,l;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,V(t),e.next=4,b.validateFields();case 4:if(a=e.sent,E(!0),null!=M&&M.uid){e.next=9;break}return D.yw.error(k.formatMessage({id:"quality.appeal.uid.required",defaultMessage:"申诉ID不能为空"})),e.abrupt("return");case 9:if(r={uid:M.uid,orgUid:null==_?void 0:_.uid},"approve"!==t){e.next=17;break}return e.next=13,(0,S.GF)(r);case 13:i=e.sent,console.log("approveQualityAppeal response",null===(s=i)||void 0===s?void 0:s.data,r),e.next=22;break;case 17:return r.reviewComment=a.reviewComment,e.next=20,(0,S.XX)(r);case 20:i=e.sent,console.log("rejectQualityAppeal response",null===(l=i)||void 0===l?void 0:l.data,r);case 22:200===i.code?(D.yw.success(k.formatMessage({id:"approve"===t?"quality.appeal.approve.success":"quality.appeal.reject.success",defaultMessage:"approve"===t?"申诉通过成功":"申诉驳回成功"})),h(),b.resetFields(),null==x||x()):D.yw.error(i.message||k.formatMessage({id:"approve"===t?"quality.appeal.approve.error":"quality.appeal.reject.error",defaultMessage:"approve"===t?"申诉通过失败":"申诉驳回失败"})),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(0),console.error("Review error:",e.t0),D.yw.error(k.formatMessage({id:"approve"===t?"quality.appeal.approve.error":"quality.appeal.reject.error",defaultMessage:"approve"===t?"申诉通过失败":"申诉驳回失败"}));case 29:return e.prev=29,E(!1),V(null),e.finish(29);case 33:case"end":return e.stop()}}),e,null,[[0,25,29,33]])})));return function(t){return e.apply(this,arguments)}}();return(0,G.jsx)(R.Z,{title:k.formatMessage({id:"quality.appeal.review",defaultMessage:"申诉审核"}),width:600,open:f,onClose:function(){b.resetFields(),V(null),h()},extra:(0,G.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,G.jsx)(q.ZP,{type:"primary",danger:!0,loading:Z,disabled:(null==M?void 0:M.status)!==z.oIc.PENDING,onClick:function(){return W("reject")},children:k.formatMessage({id:"quality.appeal.reject",defaultMessage:"驳回"})}),(0,G.jsx)(q.ZP,{type:"primary",loading:Z,disabled:(null==M?void 0:M.status)!==z.oIc.PENDING,onClick:function(){return W("approve")},children:k.formatMessage({id:"quality.appeal.approve",defaultMessage:"通过"})})]}),children:M&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.appeal.basic.info",defaultMessage:"申诉基本信息"}),size:"small",style:{marginBottom:16},children:(0,G.jsxs)(B.Z,{column:2,size:"small",children:[(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.appeal.uid",defaultMessage:"申诉ID"}),children:M.uid}),(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.appeal.qualityCheckUid",defaultMessage:"质检ID"}),children:null===(t=M.qualityCheck)||void 0===t?void 0:t.uid}),(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.appeal.status",defaultMessage:"申诉状态"}),children:function(){var e=M.status||z.oIc.PENDING,t=z.IHi[e]||"orange",a=e;switch(e){case z.oIc.PENDING:a=k.formatMessage({id:"quality.appeal.status.pending"});break;case z.oIc.APPROVED:a=k.formatMessage({id:"quality.appeal.status.approved"});break;case z.oIc.REJECTED:a=k.formatMessage({id:"quality.appeal.status.rejected"});break;default:a=e||k.formatMessage({id:"quality.appeal.status.pending"})}return(0,G.jsx)(v.Z,{color:t,children:a})}()}),(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.appeal.createdAt",defaultMessage:"申诉时间"}),children:M.createdAt?A()(M.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"})]})}),(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.appeal.comment",defaultMessage:"申诉理由"}),size:"small",style:{marginBottom:16},children:(0,G.jsx)("div",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px"},children:M.comment})}),M.reviewComment&&(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.appeal.rejectReason",defaultMessage:"驳回原因"}),size:"small",style:{marginBottom:16},children:(0,G.jsx)("div",{style:{background:"#fff2f0",padding:"12px",borderRadius:"4px",border:"1px solid #ffccc7"},children:(0,G.jsx)("div",{style:{color:"#ff4d4f"},children:M.reviewComment})})}),(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.check.basic.info"}),size:"small",style:{marginBottom:16},children:(0,G.jsxs)(B.Z,{column:2,size:"small",children:[(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.check.uid"}),children:null===(a=M.qualityCheck)||void 0===a?void 0:a.uid}),(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.check.type"}),children:function(e,t,a,r){var i=z.DMM[null===(e=M.qualityCheck)||void 0===e?void 0:e.type]||"blue",s=null===(t=M.qualityCheck)||void 0===t?void 0:t.type;switch(null===(a=M.qualityCheck)||void 0===a?void 0:a.type){case z.fmk.ONLINE_SERVICE:s=k.formatMessage({id:"quality.check.type.onlineService"});break;case z.fmk.BOT:s=k.formatMessage({id:"quality.check.type.bot"});break;case z.fmk.CALL_CENTER:s=k.formatMessage({id:"quality.check.type.callCenter"});break;default:s=(null===(r=M.qualityCheck)||void 0===r?void 0:r.type)||k.formatMessage({id:"quality.check.type.onlineService"})}return(0,G.jsx)(v.Z,{color:i,children:s})}()}),(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.check.status"}),children:function(e){var t=null===(e=M.qualityCheck)||void 0===e?void 0:e.status,a=z.EtT[t]||"default",r=t;switch(t){case z.izL.COMPLETED:r=k.formatMessage({id:"quality.check.status.completed"});break;case z.izL.APPEALING:r=k.formatMessage({id:"quality.check.status.appealing"});break;case z.izL.APPEAL_APPROVED:r=k.formatMessage({id:"quality.check.status.appealApproved"});break;case z.izL.APPEAL_REJECTED:r=k.formatMessage({id:"quality.check.status.appealRejected"});break;case z.izL.CLOSED:r=k.formatMessage({id:"quality.check.status.closed"});break;default:r=t||k.formatMessage({id:"quality.check.status.completed"})}return(0,G.jsx)(v.Z,{color:a,children:r})}()}),(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.check.createdAt"}),children:null!==(r=M.qualityCheck)&&void 0!==r&&r.createdAt?A()(M.qualityCheck.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}),(0,G.jsx)(B.Z.Item,{label:k.formatMessage({id:"quality.check.updatedAt"}),children:null!==(i=M.qualityCheck)&&void 0!==i&&i.updatedAt?A()(M.qualityCheck.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"})]})}),(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.check.score.statistics"}),size:"small",style:{marginBottom:16},children:(0,G.jsxs)(Y.Z,{gutter:16,children:[(0,G.jsx)(O.Z,{span:8,children:(0,G.jsx)(H.Z,{title:k.formatMessage({id:"quality.check.totalScore"}),value:(null===(s=M.qualityCheck)||void 0===s?void 0:s.totalScore)||0,valueStyle:{color:((null===(l=M.qualityCheck)||void 0===l?void 0:l.totalScore)||0)>=90?"#52c41a":((null===(n=M.qualityCheck)||void 0===n?void 0:n.totalScore)||0)>=80?"#1890ff":"#faad14",fontWeight:"bold"}})}),(0,G.jsx)(O.Z,{span:8,children:(0,G.jsx)(H.Z,{title:k.formatMessage({id:"quality.check.bonusScore"}),value:(null===(o=M.qualityCheck)||void 0===o?void 0:o.bonusScore)||0,valueStyle:{color:"#52c41a"}})}),(0,G.jsx)(O.Z,{span:8,children:(0,G.jsx)(H.Z,{title:k.formatMessage({id:"quality.check.deductionScore"}),value:(null===(d=M.qualityCheck)||void 0===d?void 0:d.deductionScore)||0,valueStyle:{color:"#ff4d4f"}})})]})}),(null===(c=M.qualityCheck)||void 0===c?void 0:c.indicators)&&M.qualityCheck.indicators.length>0&&(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.check.indicators.details",defaultMessage:"质检指标详情"}),size:"small",style:{marginBottom:16},children:(0,G.jsx)("div",{children:M.qualityCheck.indicators.map((function(e,t){return(0,G.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:t<M.qualityCheck.indicators.length-1?"1px solid #f0f0f0":"none"},children:[(0,G.jsxs)("div",{style:{flex:1},children:[(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[(0,G.jsx)("span",{style:{fontWeight:"bold",marginRight:"8px"},children:e.indicatorName}),e.mandatory&&(0,G.jsx)(v.Z,{color:"red",style:{fontSize:"12px"},children:k.formatMessage({id:"quality.indicator.mandatory",defaultMessage:"必检"})}),e.deduction?(0,G.jsx)(v.Z,{color:"red",style:{fontSize:"12px"},children:k.formatMessage({id:"quality.indicator.deduction",defaultMessage:"减分项"})}):(0,G.jsx)(v.Z,{color:"green",style:{fontSize:"12px"},children:k.formatMessage({id:"quality.indicator.bonus",defaultMessage:"加分项"})})]}),e.description&&(0,G.jsx)("div",{style:{color:"#666",fontSize:"12px"},children:e.description})]}),(0,G.jsx)("div",{style:{textAlign:"right",minWidth:"80px"},children:(0,G.jsxs)("span",{style:{fontSize:"16px",fontWeight:"bold",color:e.deduction?"#ff4d4f":"#52c41a"},children:[e.deduction?"-":"+",e.indicatorScore||0,k.formatMessage({id:"quality.score.unit"})]})})]},t)}))})}),(null===(u=M.qualityCheck)||void 0===u?void 0:u.comment)&&(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.check.comment"}),size:"small",style:{marginBottom:16},children:(0,G.jsx)("div",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px"},children:M.qualityCheck.comment})}),(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.chat.history",defaultMessage:"聊天记录"}),size:"small",style:{marginBottom:16},children:(0,G.jsx)(q.ZP,{type:"primary",icon:(0,G.jsx)(L.Z,{}),onClick:function(){var e,t,a;if(null!=M&&null!==(e=M.qualityCheck)&&void 0!==e&&null!==(e=e.queueMember)&&void 0!==e&&null!==(e=e.thread)&&void 0!==e&&e.uid){var r={chatConfig:{org:null===(t=M.qualityCheck.queueMember.thread)||void 0===t?void 0:t.orgUid,t:z.CCt,sid:M.qualityCheck.queueMember.thread.uid}};null===(a=window.bytedesk)||void 0===a||a.showChat(r)}else D.yw.warning(k.formatMessage({id:"quality.chat.history.no.thread",defaultMessage:"会话信息不存在"}))},children:k.formatMessage({id:"quality.view.chat.history",defaultMessage:"查看聊天记录"})})}),(0,G.jsx)(F.Z,{title:k.formatMessage({id:"quality.appeal.review.form",defaultMessage:"审核意见"}),size:"small",children:(0,G.jsx)(T.Z,{form:b,layout:"vertical",children:(0,G.jsx)(T.Z.Item,{name:"reviewComment",label:k.formatMessage({id:"quality.appeal.reviewComment",defaultMessage:"审核意见"}),rules:[{required:"reject"===U,message:k.formatMessage({id:"quality.appeal.reviewComment.required",defaultMessage:"请输入审核意见"})}],children:(0,G.jsx)(J,{rows:4,placeholder:"reject"===U?k.formatMessage({id:"quality.appeal.reviewComment.reject.placeholder",defaultMessage:"请输入驳回原因（必填）..."}):k.formatMessage({id:"quality.appeal.reviewComment.approve.placeholder",defaultMessage:"请输入审核意见（可选）..."})})})})})]})})},U=a(36125),V=["current","pageSize"],_=function(){var e=(0,I.useIntl)(),t=(0,y.useRef)(),a=(0,y.useState)(!1),r=g()(a,2),s=r[0],n=r[1],d=(0,y.useState)(null),u=g()(d,2),f=u[0],h=u[1],E=(0,y.useState)([]),N=g()(E,2),T=N[0],R=N[1],F=(0,y.useState)([]),B=g()(F,2),Y=B[0],O=B[1],H=(0,y.useState)(!1),L=g()(H,2),J=L[0],_=L[1],W=(0,P.u)((function(e){return e.currentOrg})),Q=function(){var a=m()(p()().mark((function a(r){var i;return p()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,S.w_)({uid:r.uid});case 3:200===a.sent.code?(null==t||null===(i=t.current)||void 0===i||i.reload(),D.yw.success(e.formatMessage({id:"quality.appeal.delete.success",defaultMessage:"申诉删除成功"}))):D.yw.error(e.formatMessage({id:"quality.appeal.delete.error",defaultMessage:"申诉删除失败"})),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),D.yw.error(e.formatMessage({id:"quality.appeal.delete.error",defaultMessage:"申诉删除失败"})),console.error("Delete quality appeal error:",a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}(),K=function(){var a=m()(p()().mark((function a(){var r,i,s,l,n,o;return p()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==Y.length){a.next=3;break}return D.yw.warning(e.formatMessage({id:"quality.appeal.batch.delete.noselection",defaultMessage:"请选择要删除的申诉"})),a.abrupt("return");case 3:D.yw.loading(e.formatMessage({id:"quality.appeal.deleting",defaultMessage:"正在删除..."})),i=0,s=0,l=c()(Y),a.prev=7,l.s();case 9:if((n=l.n()).done){a.next=23;break}return o=n.value,a.prev=11,a.next=14,(0,S.w_)({uid:o.uid});case 14:200===a.sent.code?i++:s++,a.next=21;break;case 18:a.prev=18,a.t0=a.catch(11),s++;case 21:a.next=9;break;case 23:a.next=28;break;case 25:a.prev=25,a.t1=a.catch(7),l.e(a.t1);case 28:return a.prev=28,l.f(),a.finish(28);case 31:D.yw.destroy(),0===s?D.yw.success(e.formatMessage({id:"quality.appeal.batch.delete.success",defaultMessage:"批量删除成功，共删除 {count} 条记录"},{count:i})):D.yw.warning(e.formatMessage({id:"quality.appeal.batch.delete.partial",defaultMessage:"部分删除成功，成功 {success} 条，失败 {fail} 条"},{success:i,fail:s})),R([]),O([]),null===(r=t.current)||void 0===r||r.reloadAndRest();case 36:case"end":return a.stop()}}),a,null,[[7,25,28,31],[11,18]])})));return function(){return a.apply(this,arguments)}}(),$=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.appeal.uid",defaultMessage:"申诉ID"}),dataIndex:"uid",key:"uid",copyable:!0,fixed:"left",width:180,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"quality.appeal.uid.tooltip",defaultMessage:"申诉的唯一标识"})},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.appeal.qualityCheckUid",defaultMessage:"质检ID"}),dataIndex:["qualityCheck","uid"],key:"qualityCheckUid",width:180,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"quality.appeal.qualityCheckUid.tooltip",defaultMessage:"关联的质检记录ID"})},{title:(0,G.jsx)(I.FormattedMessage,{id:"queue.member.agent"}),dataIndex:"agentNickname",key:"agentNickname",width:180,ellipsis:!0,hideInSearch:!0,tooltip:(0,G.jsx)(I.FormattedMessage,{id:"queue.member.agent.tooltip"}),render:function(e,t){var a,r,i=null===(a=t.qualityCheck)||void 0===a||null===(a=a.queueMember)||void 0===a||null===(a=a.thread)||void 0===a||null===(a=a.robotProtobuf)||void 0===a?void 0:a.nickname,s=null===(r=t.qualityCheck)||void 0===r||null===(r=r.queueMember)||void 0===r||null===(r=r.thread)||void 0===r||null===(r=r.agentProtobuf)||void 0===r?void 0:r.nickname;return i&&s?"".concat(i," / ").concat(s):i||(s||"-")}},{title:(0,G.jsx)(I.FormattedMessage,{id:"queue.member.nickname"}),dataIndex:"visitorNickname",key:"visitorNickname",width:180,ellipsis:!0,search:!0,tooltip:(0,G.jsx)(I.FormattedMessage,{id:"queue.member.nickname.tooltip"}),render:function(e,t){var a;return(null===(a=t.qualityCheck)||void 0===a||null===(a=a.queueMember)||void 0===a||null===(a=a.thread)||void 0===a||null===(a=a.robotProtobuf)||void 0===a?void 0:a.nickname)||"-"}},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.appeal.status",defaultMessage:"申诉状态"}),dataIndex:"status",key:"appealStatus",width:120,search:!0,tooltip:e.formatMessage({id:"quality.appeal.status.tooltip",defaultMessage:"申诉的当前状态"}),valueEnum:o()(o()(o()({},z.oIc.PENDING,{text:e.formatMessage({id:"quality.appeal.status.pending"}),status:"Processing"}),z.oIc.APPROVED,{text:e.formatMessage({id:"quality.appeal.status.approved"}),status:"Success"}),z.oIc.REJECTED,{text:e.formatMessage({id:"quality.appeal.status.rejected"}),status:"Error"}),render:function(t,a){var r=a.status||z.oIc.PENDING,i=z.IHi[r]||"orange",s=r;switch(r){case z.oIc.PENDING:s=e.formatMessage({id:"quality.appeal.status.pending"});break;case z.oIc.APPROVED:s=e.formatMessage({id:"quality.appeal.status.approved"});break;case z.oIc.REJECTED:s=e.formatMessage({id:"quality.appeal.status.rejected"});break;default:s=r||e.formatMessage({id:"quality.appeal.status.pending"})}return(0,G.jsx)(v.Z,{color:i,children:s})}},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.appeal.comment",defaultMessage:"申诉理由"}),dataIndex:"comment",key:"appealComment",width:200,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"quality.appeal.comment.tooltip",defaultMessage:"申诉的具体理由"})},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.appeal.reviewComment",defaultMessage:"审核意见"}),dataIndex:"reviewComment",key:"reviewComment",width:200,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"quality.appeal.reviewComment.tooltip",defaultMessage:"申诉审核意见"})},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.check.totalScore"}),dataIndex:["qualityCheck","totalScore"],key:"totalScore",width:80,hideInSearch:!0,tooltip:e.formatMessage({id:"quality.check.totalScore.tooltip"}),render:function(e){return(0,G.jsx)("span",{style:{fontWeight:"bold",color:e>=90?"#52c41a":e>=80?"#1890ff":"#faad14"},children:e||0})}},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.check.bonusScore"}),dataIndex:["qualityCheck","bonusScore"],key:"bonusScore",width:80,hideInSearch:!0,tooltip:e.formatMessage({id:"quality.check.bonusScore.tooltip"}),render:function(e){return(0,G.jsx)("span",{style:{color:"#52c41a"},children:e||0})}},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.check.deductionScore"}),dataIndex:["qualityCheck","deductionScore"],key:"deductionScore",width:80,hideInSearch:!0,tooltip:e.formatMessage({id:"quality.check.deductionScore.tooltip"}),render:function(e){return(0,G.jsx)("span",{style:{color:"#ff4d4f"},children:e||0})}},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.check.indicators"}),dataIndex:["qualityCheck","indicators"],key:"indicators",width:380,hideInSearch:!0,tooltip:e.formatMessage({id:"quality.check.indicators.tooltip"}),render:function(t,a){var r,i=(null===(r=a.qualityCheck)||void 0===r?void 0:r.indicators)||[],s=i.length>3;return(0,G.jsx)(M.Z,{title:(0,G.jsx)("div",{children:i.map((function(t,a){return(0,G.jsx)("div",{style:{marginBottom:"4px"},children:(0,G.jsxs)(v.Z,{color:t.deduction?"red":"green",style:{marginRight:"4px"},children:[t.indicatorName,t.indicatorScore&&"(".concat(t.deduction?"-":"+").concat(t.indicatorScore).concat(e.formatMessage({id:"quality.score.unit"}),")")]})},a)}))}),placement:"topLeft",children:(0,G.jsxs)("div",{style:{cursor:"pointer"},children:[i.slice(0,3).map((function(t,a){return(0,G.jsxs)(v.Z,{color:t.deduction?"red":"green",style:{marginBottom:"2px",marginRight:"4px"},children:[t.indicatorName,t.indicatorScore&&"(".concat(t.deduction?"-":"+").concat(t.indicatorScore).concat(e.formatMessage({id:"quality.score.unit"}),")")]},a)})),s&&(0,G.jsxs)(v.Z,{color:"default",style:{marginBottom:"2px"},children:["+",i.length-3]})]})})}},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.appeal.createdAt",defaultMessage:"申诉时间"}),dataIndex:"createdAt",key:"createdAt",width:180,valueType:"dateTime",hideInSearch:!0,tooltip:e.formatMessage({id:"quality.appeal.createdAt.tooltip",defaultMessage:"申诉创建时间"}),render:function(e,t){return t.createdAt?A()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,G.jsx)(I.FormattedMessage,{id:"quality.appeal.updatedAt",defaultMessage:"申诉更新时间"}),dataIndex:"updatedAt",key:"updatedAt",width:180,valueType:"dateTime",hideInSearch:!0,tooltip:e.formatMessage({id:"quality.appeal.updatedAt.tooltip",defaultMessage:"申诉最后更新时间"}),render:function(e,t){return t.updatedAt?A()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:e.formatMessage({id:"actions"}),valueType:"option",key:"option",width:200,fixed:"right",render:function(t,a,r,i){return[(0,G.jsx)("a",{onClick:function(){return function(e){h(e),n(!0)}(a)},children:e.formatMessage({id:"view",defaultMessage:"查看"})},"view"),(0,G.jsx)(x.Z,{title:e.formatMessage({id:"deleteTip"}),description:e.formatMessage({id:"quality.appeal.delete.confirm",defaultMessage:"确定要删除这条申诉记录吗？"}),onConfirm:function(){return Q(a)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"}),children:(0,G.jsx)(q.ZP,{size:"small",type:"link",danger:!0,children:e.formatMessage({id:"delete"})})},"delete")].filter(Boolean)}}],ee={selectedRowKeys:T,onChange:function(e,t){R(e),O(t)}},te=function(){var t=m()(p()().mark((function t(a,r,s){var n,o,d,c,u,f,m,h;return p()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return U.Z.debug("request:",a,r,s),D.yw.loading(e.formatMessage({id:"quality.appeal.loading",defaultMessage:"正在加载..."})),n=a.current,o=a.pageSize,d=l()(a,V),c=void 0,u=void 0,r&&Object.keys(r).length>0&&(f=Object.keys(r)[0],c=f,u="ascend"===r[f]?"ascend":"descend"),m=i()(i()({pageNumber:n-1,pageSize:o},d),{},{sortBy:c,sortDirection:u,orgUid:null==W?void 0:W.uid}),t.prev=7,t.next=10,(0,S.Nf)(m);case 10:if(h=t.sent,U.Z.debug("queryQualityAppealsByOrg response:",null==h?void 0:h.data,m),D.yw.destroy(),200!==h.code||null==h||!h.data){t.next=17;break}return t.abrupt("return",{data:(null==h?void 0:h.data.content)||[],success:!0,total:(null==h?void 0:h.data.totalElements)||0});case 17:return D.yw.error(h.message||e.formatMessage({id:"quality.appeal.fetch.error",defaultMessage:"获取申诉数据失败"})),t.abrupt("return",{data:[],success:!1,total:0});case 19:t.next=27;break;case 21:return t.prev=21,t.t0=t.catch(7),D.yw.destroy(),D.yw.error(e.formatMessage({id:"quality.appeal.fetch.error",defaultMessage:"获取申诉数据失败"})),console.error("Fetch quality appeals error:",t.t0),t.abrupt("return",{data:[],success:!1,total:0});case 27:case"end":return t.stop()}}),t,null,[[7,21]])})));return function(e,a,r){return t.apply(this,arguments)}}();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Z.Z,{columns:$,actionRef:t,cardBordered:!0,rowSelection:ee,request:te,scroll:{x:3e3},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:10},dateFormatter:"string",headerTitle:e.formatMessage({id:"quality.appeal.management",defaultMessage:"会话质检申诉审核"}),toolBarRender:function(){return function(){var a=[];a.push((0,G.jsx)(q.ZP,{icon:(0,G.jsx)(j.Z,{}),onClick:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.reload()},children:e.formatMessage({id:"refresh",defaultMessage:"刷新"})},"refresh")),a.push((0,G.jsx)(q.ZP,{icon:(0,G.jsx)(b.Z,{}),type:"primary",onClick:function(){D.yw.info(e.formatMessage({id:"quality.appeal.export.info",defaultMessage:"导出功能开发中..."}))},children:e.formatMessage({id:"export",defaultMessage:"导出"})},"export"));var r=[];return T.length>0&&r.push({key:"batchDelete",icon:(0,G.jsx)(w.Z,{}),danger:!0,label:e.formatMessage({id:"quality.appeal.batch.delete",defaultMessage:"批量删除"})+" (".concat(T.length,")"),onClick:function(){_(!0)}}),r.length>0&&a.push((0,G.jsx)(k.Z,{menu:{items:r},placement:"bottom",children:(0,G.jsxs)(q.ZP,{type:T.length>0?"primary":"default",danger:T.length>0,children:[T.length>0?e.formatMessage({id:"quality.appeal.batch.operations",defaultMessage:"批量操作"})+" (".concat(T.length,")"):e.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,G.jsx)(C.Z,{})]})},"batchOperations")),a}()}}),(0,G.jsx)(X,{visible:s,onClose:function(){return n(!1)},record:f,onSuccess:function(){var e;null===(e=t.current)||void 0===e||e.reload()}}),(0,G.jsx)(x.Z,{title:e.formatMessage({id:"deleteTip"}),description:e.formatMessage({id:"quality.appeal.batch.delete.confirm",defaultMessage:"确定要删除选中的 {count} 条申诉记录吗？"},{count:T.length}),open:J,onConfirm:function(){K(),_(!1)},onCancel:function(){return _(!1)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})]})}}}]);