"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[7131],{15722:function(e,t,r){r.d(t,{Z:function(){return l}});var a=r(83910),s=r(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},i=r(54183),o=function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var l=s.forwardRef(o)},64210:function(e,t,r){r.d(t,{Z:function(){return w}});var a=r(94433),s=r(38956),n=r(44194),i=r(85618),o=r(35865),l=r(31549),d=["proFieldProps","fieldProps"],u="date",c=n.forwardRef((function(e,t){var r=e.proFieldProps,c=e.fieldProps,p=(0,s.Z)(e,d),f=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:u,fieldProps:(0,a.Z)({getPopupContainer:f.getPopupContainer},c),proFieldProps:r,filedConfig:{valueType:u,customLightMode:!0}},p))})),p=["proFieldProps","fieldProps"],f="dateMonth",m=n.forwardRef((function(e,t){var r=e.proFieldProps,d=e.fieldProps,u=(0,s.Z)(e,p),c=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:f,fieldProps:(0,a.Z)({getPopupContainer:c.getPopupContainer},d),proFieldProps:r,filedConfig:{valueType:f,customLightMode:!0}},u))})),g=["fieldProps"],h="dateQuarter",v=n.forwardRef((function(e,t){var r=e.fieldProps,d=(0,s.Z)(e,g),u=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:h,fieldProps:(0,a.Z)({getPopupContainer:u.getPopupContainer},r),filedConfig:{valueType:h,customLightMode:!0}},d))})),x=["proFieldProps","fieldProps"],M="dateWeek",y=n.forwardRef((function(e,t){var r=e.proFieldProps,d=e.fieldProps,u=(0,s.Z)(e,x),c=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:M,fieldProps:(0,a.Z)({getPopupContainer:c.getPopupContainer},d),proFieldProps:r,filedConfig:{valueType:M,customLightMode:!0}},u))})),P=["proFieldProps","fieldProps"],Z="dateYear",C=n.forwardRef((function(e,t){var r=e.proFieldProps,d=e.fieldProps,u=(0,s.Z)(e,P),c=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:Z,fieldProps:(0,a.Z)({getPopupContainer:c.getPopupContainer},d),proFieldProps:r,filedConfig:{valueType:Z,customLightMode:!0}},u))})),b=c;b.Week=y,b.Month=m,b.Quarter=v,b.Year=C,b.displayName="ProFormComponent";var w=b},68263:function(e,t,r){var a=r(94433),s=r(38956),n=r(37150),i=r(44194),o=r(85618),l=r(35865),d=r(31549),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var r=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,h=e.request,v=e.showSearch,x=e.options,M=(0,s.Z)(e,u),y=(0,i.useContext)(o.Z);return(0,d.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(g),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:x,mode:m,showSearch:v,getPopupContainer:y.getPopupContainer},r),ref:t,proFieldProps:f},M),{},{children:c}))},f=i.forwardRef((function(e,t){var r=e.fieldProps,u=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,h=e.request,v=e.options,x=(0,s.Z)(e,c),M=(0,a.Z)({options:v,mode:m||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),y=(0,i.useContext)(o.Z);return(0,d.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(g),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:y.getPopupContainer},M),ref:t,proFieldProps:f},x),{},{children:u}))})),m=i.forwardRef(p);m.SearchSelect=f,m.displayName="ProFormComponent",t.Z=m},93312:function(e,t,r){var a=r(94433),s=r(38956),n=r(44194),i=r(35865),o=r(31549),l=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],d=n.forwardRef((function(e,t){var r=e.fieldProps,n=e.unCheckedChildren,d=e.checkedChildren,u=e.proFieldProps,c=(0,s.Z)(e,l);return(0,o.jsx)(i.Z,(0,a.Z)({valueType:"switch",fieldProps:(0,a.Z)({unCheckedChildren:n,checkedChildren:d},r),ref:t,valuePropName:"checked",proFieldProps:u,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},c))}));t.Z=d},86684:function(e,t,r){var a=r(32906),s=r(94433),n=r(38956),i=r(81424),o=r(58867),l=r(31543),d=r(34573),u=r(44194),c=r(35865),p=r(31549),f=["fieldProps","proFieldProps"],m=["fieldProps","proFieldProps"],g="text",h=function(e){var t=(0,i.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,a.Z)(t,2),n=r[0],d=r[1];return(0,p.jsx)(o.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var r,a=t.getFieldValue(e.name||[]);return(0,p.jsx)(l.Z,(0,s.Z)((0,s.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return d(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,a),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:n,children:e.children}))}})},v=function(e){var t=e.fieldProps,r=e.proFieldProps,a=(0,n.Z)(e,f);return(0,p.jsx)(c.Z,(0,s.Z)({valueType:g,fieldProps:t,filedConfig:{valueType:g},proFieldProps:r},a))};v.Password=function(e){var t=e.fieldProps,r=e.proFieldProps,i=(0,n.Z)(e,m),o=(0,u.useState)(!1),l=(0,a.Z)(o,2),f=l[0],v=l[1];return null!=t&&t.statusRender&&i.name?(0,p.jsx)(h,{name:i.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:v,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:(0,s.Z)((0,s.Z)({},(0,d.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==t||null===(r=t.onBlur)||void 0===r||r.call(t,e),v(!1)},onClick:function(e){var r;null==t||null===(r=t.onClick)||void 0===r||r.call(t,e),v(!0)}}),proFieldProps:r,filedConfig:{valueType:g}},i))})}):(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:g}},i))},v.displayName="ProFormComponent",t.Z=v},13847:function(e,t,r){var a=r(94433),s=r(38956),n=r(44194),i=r(35865),o=r(31549),l=["fieldProps","proFieldProps"],d=function(e,t){var r=e.fieldProps,n=e.proFieldProps,d=(0,s.Z)(e,l);return(0,o.jsx)(i.Z,(0,a.Z)({ref:t,valueType:"textarea",fieldProps:r,proFieldProps:n},d))};t.Z=n.forwardRef(d)},27131:function(e,t,r){r.d(t,{Z:function(){return ee}});var a=r(73193),s=r.n(a),n=r(84176),i=r.n(n),o=r(90819),l=r.n(o),d=r(89933),u=r.n(d),c=r(76711),p=r.n(c),f=r(45332),m=r.n(f),g=r(93527),h=r(6844),v=r(19736);function x(e){return M.apply(this,arguments)}function M(){return(M=u()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/v1/license/query/org",{method:"GET",params:s()(s()({},t),{},{channel:h.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return P.apply(this,arguments)}function P(){return(P=u()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/v1/license/create",{method:"POST",data:s()(s()({},t),{},{channel:h.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return C.apply(this,arguments)}function C(){return(C=u()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/v1/license/update",{method:"POST",data:s()(s()({},t),{},{channel:h.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=u()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/v1/license/delete",{method:"POST",data:s()(s()({},t),{},{channel:h.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=r(14888),j=r(15722),T=r(10162),S=r(86307),E=r(46141),I=r(77359),k=r(3925),D=r(53229),L=r(44194),R=r(86222),A=r.n(R),Y=r(30064),q=r(86684),B=r(13847),N=r(68263),z=r(64210),K=r(93312),O=r(93189),U=r(61689),V=r(9428),J=r(28506),_=r(96596),H=r.n(_),W=r(31549),X=function(e){var t=e.isEdit,r=e.license,a=e.open,n=e.superUser,i=e.onClose,o=e.onSubmit,l=(0,v.useIntl)(),d=Y.A.useForm(),u=m()(d,1)[0],c=(0,J.L)((function(e){return e.userInfo})),p=(0,F.u)((function(e){return e.currentOrg})),f=(0,L.useState)(""),g=m()(f,2),x=(g[0],g[1],(0,L.useState)(h.dbF)),M=m()(x,2),y=M[0],P=M[1];return(0,L.useEffect)((function(){if(t)u.setFieldsValue({uid:null==r?void 0:r.uid,name:null==r?void 0:r.name,description:null==r?void 0:r.description,mobile:null==r?void 0:r.mobile,email:null==r?void 0:r.email,userType:null==r?void 0:r.userType,expiryDate:null==r?void 0:r.expiryDate,edition:null==r?void 0:r.edition,serverIps:null==r?void 0:r.serverIps,serverDomains:null==r?void 0:r.serverDomains,enabled:null==r?void 0:r.enabled,activatedAt:null==r?void 0:r.activatedAt,lastCheckedAt:null==r?void 0:r.lastCheckedAt}),P((null==r?void 0:r.edition)||h.dbF);else{var e=H()().add(30,"day").format("YYYY-MM-DD HH:mm:ss");u.setFieldsValue({mobile:null==c?void 0:c.mobile,email:null==c?void 0:c.email,userType:h.Bv_,edition:h.dbF,expiryDate:e}),P(h.dbF)}}),[t,r,u,c]),(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(U.Z,{title:l.formatMessage({id:"license.title",defaultMessage:"License"}),width:600,onClose:i,open:a,extra:(0,W.jsxs)(V.Z,{children:[(0,W.jsx)(k.ZP,{onClick:i,children:l.formatMessage({id:"cancel",defaultMessage:"Cancel"})}),(0,W.jsx)(k.ZP,{type:"primary",onClick:function(){return u.submit()},children:l.formatMessage({id:"submit",defaultMessage:"Submit"})})]}),children:(0,W.jsxs)(Y.A,{form:u,name:"licenseForm",onFinish:function(){console.log("handleSubmit"),null!=c&&c.mobileVerified||null!=c&&c.emailVerified?u.validateFields().then((function(e){var t=s()({},e),r=s()(s()({},t),{},{orgUid:null==p?void 0:p.uid});console.log("submit",r),o(r)})):O.ZP.error(l.formatMessage({id:"license.verification.required",defaultMessage:"请先完成手机或邮箱验证后再创建License"}))},submitter:!1,children:[(0,W.jsx)(q.Z,{label:l.formatMessage({id:"name",defaultMessage:"Name"}),name:"name",rules:[{required:!0},{validator:function(e,t){return"string"==typeof t&&t.toLowerCase().includes("weiyu")?Promise.reject(new Error(l.formatMessage({id:"license.name.weiyu.forbidden",defaultMessage:"名称不能包含 weiyu"}))):Promise.resolve()}}]}),(0,W.jsx)(B.Z,{label:l.formatMessage({id:"description",defaultMessage:"Description"}),name:"description",placeholder:l.formatMessage({id:"license.description.placeholder",defaultMessage:"Optional, license usage description"})}),(0,W.jsx)(q.Z,{label:l.formatMessage({id:"mobile",defaultMessage:"Mobile"}),name:"mobile",disabled:!n}),(0,W.jsx)(q.Z,{label:l.formatMessage({id:"email",defaultMessage:"Email"}),name:"email",disabled:!n}),(0,W.jsx)(N.Z,{label:l.formatMessage({id:"userType",defaultMessage:"User Type"}),name:"userType",options:[{label:l.formatMessage({id:"license.user.type.free",defaultMessage:"Free"}),value:h.Bv_},{label:l.formatMessage({id:"license.user.type.paid",defaultMessage:"Paid"}),value:h.u0z,disabled:!n}],extra:(0,W.jsx)("a",{href:"https://www.weiyuai.cn/docs/zh-CN/docs/payment#%E8%81%94%E7%B3%BB%E6%96%B9%E5%BC%8F",target:"_blank",rel:"noopener noreferrer",style:{color:"#1677ff"},children:l.formatMessage({id:"license.userType.paid.tip",defaultMessage:"购买付费版请访问微语官网-版本与价格"})})}),(0,W.jsx)(z.Z,{label:l.formatMessage({id:"expiryDate",defaultMessage:"Expiry Date"}),name:"expiryDate",fieldProps:{format:"YYYY-MM-DD"},rules:[{required:!0,message:l.formatMessage({id:"license.expiryDate.required",defaultMessage:"Please select expiry date"})}],disabled:!n&&y!==h.dbF}),(0,W.jsx)(N.Z,{label:l.formatMessage({id:"edition",defaultMessage:"Edition"}),name:"edition",options:[{label:l.formatMessage({id:"license.edition.community",defaultMessage:"Community Edition"}),value:h.dbF},{label:l.formatMessage({id:"license.edition.enterprise",defaultMessage:"Enterprise Edition"}),value:h.hj_},{label:l.formatMessage({id:"license.edition.platform",defaultMessage:"Platform Edition"}),value:h.tmZ}],fieldProps:{onChange:function(e){if(P(e),!n&&(e===h.hj_||e===h.tmZ)){var t=H()().add(30,"day").format("YYYY-MM-DD HH:mm:ss");u.setFieldValue("expiryDate",t)}}}}),(0,W.jsx)(q.Z,{label:l.formatMessage({id:"serverIps",defaultMessage:"Authorized IPs"}),name:"serverIps",placeholder:l.formatMessage({id:"license.comma.separated",defaultMessage:"Comma separated"}),extra:l.formatMessage({id:"license.serverIps.format",defaultMessage:"Format: 192.168.1.1, 10.0.0.1, 2001:db8::1"}),rules:[{validator:function(e,t){if(!t)return Promise.resolve();var r,a=t.split(",").map((function(e){return e.trim()})).filter(Boolean),s=/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/,n=/^([\da-fA-F]{1,4}:){7}[\da-fA-F]{1,4}$/,i=A()(a);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!s.test(o)&&!n.test(o))return Promise.reject(new Error(l.formatMessage({id:"license.serverIps.error",defaultMessage:"Please enter valid IP addresses, separated by commas"})))}}catch(e){i.e(e)}finally{i.f()}return Promise.resolve()}}]}),(0,W.jsx)(q.Z,{label:l.formatMessage({id:"serverDomains",defaultMessage:"Authorized Domains"}),name:"serverDomains",placeholder:l.formatMessage({id:"license.comma.separated",defaultMessage:"Comma separated"}),extra:l.formatMessage({id:"license.serverDomains.format",defaultMessage:"Format: example.com, sub.example.com:8080, *.example.com"}),rules:[{validator:function(e,t){if(!t)return Promise.resolve();var r,a=t.split(",").map((function(e){return e.trim()})).filter(Boolean),s=A()(a);try{for(s.s();!(r=s.n()).done;){var n=r.value;if(!/^([A-Za-z0-9-]{1,63}\.)+[A-Za-z]{2,}(:\d{1,5})?$/.test(n))return Promise.reject(new Error(l.formatMessage({id:"license.serverDomains.error",defaultMessage:"Please enter valid domains, separated by commas"})))}}catch(e){s.e(e)}finally{s.f()}return Promise.resolve()}}]}),(0,W.jsx)(K.Z,{label:l.formatMessage({id:"enabled",defaultMessage:"Enabled"}),name:"enabled",fieldProps:{checkedChildren:l.formatMessage({id:"license.enabled",defaultMessage:"Enabled"}),unCheckedChildren:l.formatMessage({id:"license.disabled",defaultMessage:"Disabled"})}})]})})})},Q=r(44679),$=r(27789),G=["current","pageSize"],ee=function(e){var t=e.superUser,r=(0,v.useIntl)(),a=(0,L.useRef)(),n=(0,Q.Z)().translateString,o=(0,L.useState)(1),d=m()(o,2),c=(d[0],d[1]),f=(0,L.useState)(10),h=m()(f,2),M=(h[0],h[1]),P=(0,F.u)((function(e){return e.currentOrg})),C=(0,L.useState)(!1),w=m()(C,2),R=w[0],A=w[1],Y=(0,L.useState)({}),q=m()(Y,2),B=q[0],N=q[1],z=(0,L.useState)(!1),K=m()(z,2),O=K[0],U=K[1],V=E.Z.useModal(),J=m()(V,2),_=J[0],ee=J[1],te=(0,L.useState)([]),re=m()(te,2),ae=re[0],se=re[1],ne=(0,L.useState)([]),ie=m()(ne,2),oe=(ie[0],ie[1]),le=(0,L.useState)(0),de=m()(le,2),ue=(de[0],de[1]),ce=(0,L.useState)({}),pe=m()(ce,2),fe=(pe[0],pe[1]),me=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,W.jsx)(v.FormattedMessage,{id:"name",defaultMessage:"Name"}),dataIndex:"name",copyable:!0,fixed:"left",width:150},{title:(0,W.jsx)(v.FormattedMessage,{id:"description",defaultMessage:"Description"}),dataIndex:"description",width:150,ellipsis:!0},{title:(0,W.jsx)(v.FormattedMessage,{id:"mobile",defaultMessage:"Mobile"}),dataIndex:"mobile",width:120},{title:(0,W.jsx)(v.FormattedMessage,{id:"email",defaultMessage:"Email"}),dataIndex:"email",width:180},{title:(0,W.jsx)(v.FormattedMessage,{id:"userType",defaultMessage:"User Type"}),dataIndex:"userType",hideInSearch:!0,width:120,valueEnum:{FREE:{text:(0,W.jsx)(v.FormattedMessage,{id:"license.user.type.free",defaultMessage:"Free"})},PAID:{text:(0,W.jsx)(v.FormattedMessage,{id:"license.user.type.paid",defaultMessage:"Paid"})}}},{title:(0,W.jsx)(v.FormattedMessage,{id:"expiryDate",defaultMessage:"Expiry Date"}),dataIndex:"expiryDate",hideInSearch:!0,width:120,render:function(e){return e?H()(e).format("YYYY-MM-DD"):""}},{title:(0,W.jsx)(v.FormattedMessage,{id:"edition",defaultMessage:"Edition"}),dataIndex:"edition",hideInSearch:!0,width:120,valueEnum:{COMMUNITY:{text:(0,W.jsx)(v.FormattedMessage,{id:"license.edition.community",defaultMessage:"Community Edition"})},ENTERPRISE:{text:(0,W.jsx)(v.FormattedMessage,{id:"license.edition.enterprise",defaultMessage:"Enterprise Edition"})},PLATFORM:{text:(0,W.jsx)(v.FormattedMessage,{id:"license.edition.platform",defaultMessage:"Platform Edition"})}}},{title:(0,W.jsx)(v.FormattedMessage,{id:"serverIps",defaultMessage:"Server IPs"}),dataIndex:"serverIps",hideInSearch:!0,width:180,ellipsis:!0},{title:(0,W.jsx)(v.FormattedMessage,{id:"serverDomains",defaultMessage:"Server Domains"}),dataIndex:"serverDomains",hideInSearch:!0,width:180,ellipsis:!0},{title:(0,W.jsx)(v.FormattedMessage,{id:"licenseKey",defaultMessage:"License Key"}),dataIndex:"licenseKey",width:200,copyable:!0,ellipsis:!0}].concat(p()(t?[{title:(0,W.jsx)(v.FormattedMessage,{id:"encryptedLicenseKey",defaultMessage:"Encrypted License Key"}),dataIndex:"encryptedLicenseKey",width:200,copyable:!0,ellipsis:!0}]:[]),[{title:(0,W.jsx)(v.FormattedMessage,{id:"enabled",defaultMessage:"Enabled"}),dataIndex:"enabled",hideInSearch:!0,width:100,valueType:"select",valueEnum:{true:{text:"启用",status:"Success"},false:{text:"禁用",status:"Error"}}},{title:(0,W.jsx)(v.FormattedMessage,{id:"createdAt",defaultMessage:"Created At"}),dataIndex:"createdAt",hideInSearch:!0,width:180,valueType:"dateTime"},{title:(0,W.jsx)(v.FormattedMessage,{id:"updatedAt",defaultMessage:"Updated At"}),dataIndex:"updatedAt",hideInSearch:!0,width:180,valueType:"dateTime"}]),ge=[].concat(p()(me),[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",fixed:"right",width:220,render:function(e,a,s,i){return[(0,W.jsx)("a",{onClick:function(){N(a),U(!0),A(!0)},children:r.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,W.jsx)(I.Z,{title:r.formatMessage({id:"deleteTip"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(n(a.name),"】？"),onConfirm:function(){return he(a)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),icon:(0,W.jsx)(j.Z,{style:{color:"red"}}),children:(0,W.jsx)(k.ZP,{type:"link",danger:!0,children:r.formatMessage({id:"delete",defaultMessage:"Delete"})})},"delete")].concat(p()(t?[(0,W.jsx)(k.ZP,{type:"link",onClick:function(){return ye(a.encryptedLicenseKey)},children:"测试"},"test-decrypt")]:[]))}}]),he=function(){var e=u()(l()().mark((function e(t){var s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleteLicense:",t),e.next=3,b(t);case 3:s=e.sent,console.log("deleteLicense:",s),200===s.code?(g.yw.success(r.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),a.current.reload()):g.yw.error(s.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=u()(l()().mark((function e(t){var r,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:r=e.sent,console.log("handleCreateLicense response:",r),200===r.code?(null===(s=a.current)||void 0===s||s.reload(),A(!1)):g.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=u()(l()().mark((function e(t){var r,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.uid=null==B?void 0:B.uid,e.next=3,Z(t);case 3:r=e.sent,console.log("handleUpdateLicense response:",r),200===r.code?(null===(s=a.current)||void 0===s||s.reload(),A(!1)):g.yw.error(r.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){A(!0),U(!1),N({})},ye=function(e){try{var t=(0,$.K_)(e);_.info({title:"解密结果",content:(0,W.jsx)("div",{style:{wordBreak:"break-all"},children:(0,W.jsx)("pre",{children:JSON.stringify(t,null,2)})}),width:600})}catch(e){_.error({title:"解密失败",content:String(e)})}},Pe={selectedRowKeys:ae,onChange:function(e,t){se(e),oe(t)}},Ze=function(){var e=u()(l()().mark((function e(r,a,n){var o,d,u,p,f;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.current,d=r.pageSize,u=i()(r,G),c(o),M(d),fe(u),p=s()({pageNumber:o-1,pageSize:d,orgUid:null==P?void 0:P.uid,superUser:t},u),e.next=7,x(p);case 7:return f=e.sent,console.log("queryLicensesByOrg response:",f,p),200===f.code?ue(null==f?void 0:f.data.totalElements):g.yw.error(f.message),e.abrupt("return",{data:null==f?void 0:f.data.content,success:!0,total:null==f?void 0:f.data.totalElements});case 11:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}();return(0,W.jsxs)(W.Fragment,{children:[R&&(0,W.jsx)(X,{isEdit:O,open:R,license:B,superUser:t,onClose:function(){A(!1)},onSubmit:function(e){console.log("onDrawerSubmit:",e),O?xe(e):ve(e)}}),(0,W.jsx)(S.Z,{columns:ge,actionRef:a,cardBordered:!0,rowSelection:Pe,request:Ze,scroll:{x:1e3},rowKey:function(e){return e.uid||e.licenseKey||e.email||e.name},search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e,t){c(e),M(t)}},dateFormatter:"string",headerTitle:"License列表",toolBarRender:function(){return[(0,W.jsx)(k.ZP,{type:"primary",icon:(0,W.jsx)(T.Z,{}),onClick:Me,children:r.formatMessage({id:"create",defaultMessage:"Create"})},"create")]}}),(0,W.jsx)(D.Z,{message:"重要说明",description:"为防止微语系统被用于含有木马、病毒、色情、赌博、诈骗等违法违规业务，系统采用licenseKey机制进行授权管理。请妥善保管您的licenseKey，避免泄露或被盗用，确保系统安全使用。",type:"info",showIcon:!0,style:{marginTop:16}}),ee]})}}}]);