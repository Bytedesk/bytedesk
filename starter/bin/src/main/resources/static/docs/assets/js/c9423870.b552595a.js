"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7465],{14024:(e,t,n)=>{n.d(t,{A:()=>i});var o;"undefined"!=typeof window&&(o={githubRepo:"bytedesk/bytedesk"},"undefined"!=typeof window&&(window.__FORMSPREE_ID__=o.formspreeId,window.__GITHUB_TOKEN__=o.githubToken,window.__GITHUB_REPO__=o.githubRepo,window.__FEEDBACK_API__=o.feedbackApi));class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async submitFeedback(e){console.log("\u63d0\u4ea4\u53cd\u9988:",e);const t=[];t.push(this.submitToGoogleAnalytics(e)),t.push(this.submitToFormspree(e)),t.push(this.saveToLocalStorage(e)),"undefined"!=typeof window&&"localhost"!==window.location.hostname&&t.push(this.submitToCustomAPI(e));("undefined"!=typeof window?window.__GITHUB_TOKEN__:void 0)&&t.push(this.submitToGitHub(e));try{await Promise.allSettled(t),console.log("\u53cd\u9988\u63d0\u4ea4\u6210\u529f")}catch(n){console.error("\u53cd\u9988\u63d0\u4ea4\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u9519\u8bef:",n)}}async submitToGoogleAnalytics(e){return new Promise(t=>{try{"undefined"!=typeof window&&window.gtag&&window.gtag("event","feedback_submit",{event_category:"documentation",event_label:e.type,value:"positive"===e.type?1:0,custom_parameters:{page_url:e.url,feedback_comment:e.comment,doc_title:e.docTitle}}),t()}catch(n){console.warn("Google Analytics \u63d0\u4ea4\u5931\u8d25:",n),t()}})}async submitToFormspree(e){const t="undefined"!=typeof window?window.__FORMSPREE_ID__:void 0;if(t)try{const n=await fetch(`https://formspree.io/f/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:`\u6587\u6863\u53cd\u9988 - ${e.type}`,message:e.comment,url:e.url,type:e.type,timestamp:e.timestamp,docTitle:e.docTitle})});if(!n.ok)throw new Error(`Formspree \u63d0\u4ea4\u5931\u8d25: ${n.status}`)}catch(n){console.warn("Formspree \u63d0\u4ea4\u5931\u8d25:",n)}else console.warn("Formspree ID \u672a\u914d\u7f6e")}async saveToLocalStorage(e){try{if("undefined"==typeof window)return;const t=JSON.parse(localStorage.getItem("doc_feedbacks")||"[]");t.push(e),t.length>100&&t.splice(0,t.length-100),localStorage.setItem("doc_feedbacks",JSON.stringify(t))}catch(t){console.warn("\u672c\u5730\u5b58\u50a8\u4fdd\u5b58\u5931\u8d25:",t)}}async submitToCustomAPI(e){const t="undefined"!=typeof window?window.__FEEDBACK_API__:void 0;if(t)try{const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw new Error(`API \u63d0\u4ea4\u5931\u8d25: ${n.status}`)}catch(n){console.warn("\u81ea\u5b9a\u4e49API\u63d0\u4ea4\u5931\u8d25:",n)}}async submitToGitHub(e){const t="undefined"!=typeof window?window.__GITHUB_TOKEN__:void 0,n="undefined"!=typeof window&&window.__GITHUB_REPO__||"bytedesk/bytedesk";if(t)try{const o=`[\u6587\u6863\u53cd\u9988] ${"positive"===e.type?"\ud83d\udc4d \u6b63\u9762":"\ud83d\udc4e \u6539\u8fdb"} - ${e.docTitle||"\u6587\u6863\u9875\u9762"}`,r=`\n## \u53cd\u9988\u4fe1\u606f\n\n**\u53cd\u9988\u7c7b\u578b**: ${"positive"===e.type?"\ud83d\udc4d \u6709\u5e2e\u52a9":"\ud83d\udc4e \u9700\u6539\u8fdb"}\n**\u9875\u9762URL**: ${e.url}\n**\u53cd\u9988\u65f6\u95f4**: ${e.timestamp}\n\n## \u7528\u6237\u8bc4\u8bba\n\n${e.comment||"\u65e0\u5177\u4f53\u8bc4\u8bba"}\n\n## \u6280\u672f\u4fe1\u606f\n\n- User Agent: ${e.userAgent}\n- \u6587\u6863\u6807\u9898: ${e.docTitle||"N/A"}\n\n---\n*\u6b64Issue\u7531\u6587\u6863\u53cd\u9988\u7cfb\u7edf\u81ea\u52a8\u521b\u5efa*\n      `,i=await fetch(`https://api.github.com/repos/${n}/issues`,{method:"POST",headers:{Authorization:`token ${t}`,"Content-Type":"application/json"},body:JSON.stringify({title:o,body:r,labels:["documentation","feedback","positive"===e.type?"positive":"improvement"]})});if(!i.ok)throw new Error(`GitHub API \u9519\u8bef: ${i.status}`);console.log("GitHub Issue \u521b\u5efa\u6210\u529f")}catch(o){console.warn("GitHub Issue \u521b\u5efa\u5931\u8d25:",o)}else console.warn("GitHub Token \u672a\u914d\u7f6e")}getLocalFeedbacks(){try{return"undefined"==typeof window?[]:JSON.parse(localStorage.getItem("doc_feedbacks")||"[]")}catch{return[]}}clearLocalFeedbacks(){"undefined"!=typeof window&&localStorage.removeItem("doc_feedbacks")}exportFeedbacksAsJSON(){const e=this.getLocalFeedbacks();return JSON.stringify(e,null,2)}exportFeedbacksAsCSV(){const e=this.getLocalFeedbacks();if(0===e.length)return"";const t=[["\u7c7b\u578b","\u8bc4\u8bba","URL","\u65f6\u95f4","\u7528\u6237\u4ee3\u7406","\u6587\u6863\u6807\u9898"].join(",")];return e.forEach(e=>{const n=[e.type,`"${e.comment.replace(/"/g,'""')}"`,e.url,e.timestamp,`"${e.userAgent.replace(/"/g,'""')}"`,e.docTitle||""];t.push(n.join(","))}),t.join("\n")}}const i=r.getInstance()},27683:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var o=n(30758),r=n(49511),i=n(14024),s=n(86070);function d(){const[e,t]=(0,o.useState)([]),[n,d]=(0,o.useState)("all");(0,o.useEffect)(()=>{(()=>{const e=i.A.getLocalFeedbacks();t(e)})()},[]);const c=e.filter(e=>"all"===n||e.type===n),a=e.filter(e=>"positive"===e.type).length,l=e.filter(e=>"negative"===e.type).length;return(0,s.jsx)(r.A,{title:"\u53cd\u9988\u6570\u636e\u7ba1\u7406",description:"\u67e5\u770b\u548c\u7ba1\u7406\u7528\u6237\u53cd\u9988\u6570\u636e",children:(0,s.jsxs)("div",{style:{padding:"2rem"},children:[(0,s.jsx)("h1",{children:"\u53cd\u9988\u6570\u636e\u7ba1\u7406"}),(0,s.jsxs)("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem"},children:[(0,s.jsxs)("div",{style:{background:"#f0f9ff",padding:"1rem",borderRadius:"8px",flex:1},children:[(0,s.jsx)("h3",{children:"\u603b\u53cd\u9988\u6570"}),(0,s.jsx)("p",{style:{fontSize:"2rem",margin:0},children:e.length})]}),(0,s.jsxs)("div",{style:{background:"#f0fdf4",padding:"1rem",borderRadius:"8px",flex:1},children:[(0,s.jsx)("h3",{children:"\u6b63\u9762\u53cd\u9988"}),(0,s.jsxs)("p",{style:{fontSize:"2rem",margin:0,color:"#16a34a"},children:[a," (",e.length>0?Math.round(a/e.length*100):0,"%)"]})]}),(0,s.jsxs)("div",{style:{background:"#fef2f2",padding:"1rem",borderRadius:"8px",flex:1},children:[(0,s.jsx)("h3",{children:"\u6539\u8fdb\u5efa\u8bae"}),(0,s.jsxs)("p",{style:{fontSize:"2rem",margin:0,color:"#dc2626"},children:[l," (",e.length>0?Math.round(l/e.length*100):0,"%)"]})]})]}),(0,s.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,s.jsx)("button",{onClick:()=>d("all"),style:{background:"all"===n?"#3b82f6":"#e5e7eb",color:"all"===n?"white":"#374151",padding:"0.5rem 1rem",border:"none",borderRadius:"6px",cursor:"pointer"},children:"\u5168\u90e8"}),(0,s.jsx)("button",{onClick:()=>d("positive"),style:{background:"positive"===n?"#16a34a":"#e5e7eb",color:"positive"===n?"white":"#374151",padding:"0.5rem 1rem",border:"none",borderRadius:"6px",cursor:"pointer"},children:"\u6b63\u9762\u53cd\u9988"}),(0,s.jsx)("button",{onClick:()=>d("negative"),style:{background:"negative"===n?"#dc2626":"#e5e7eb",color:"negative"===n?"white":"#374151",padding:"0.5rem 1rem",border:"none",borderRadius:"6px",cursor:"pointer"},children:"\u6539\u8fdb\u5efa\u8bae"}),(0,s.jsx)("button",{onClick:()=>{const t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download=`feedback-data-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(o)},style:{background:"#059669",color:"white",padding:"0.5rem 1rem",border:"none",borderRadius:"6px",cursor:"pointer"},children:"\u5bfc\u51fa\u6570\u636e"}),(0,s.jsx)("button",{onClick:()=>{confirm("\u786e\u5b9a\u8981\u6e05\u9664\u6240\u6709\u672c\u5730\u53cd\u9988\u6570\u636e\u5417\uff1f")&&(i.A.clearLocalFeedbacks(),t([]))},style:{background:"#dc2626",color:"white",padding:"0.5rem 1rem",border:"none",borderRadius:"6px",cursor:"pointer"},children:"\u6e05\u9664\u6570\u636e"})]}),(0,s.jsx)("div",{children:0===c.length?(0,s.jsx)("p",{children:"\u6682\u65e0\u53cd\u9988\u6570\u636e"}):c.map((e,t)=>(0,s.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",background:"positive"===e.type?"#f0fdf4":"#fef2f2"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,s.jsx)("span",{style:{background:"positive"===e.type?"#16a34a":"#dc2626",color:"white",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.875rem"},children:"positive"===e.type?"\ud83d\udc4d \u6709\u5e2e\u52a9":"\ud83d\udc4e \u9700\u6539\u8fdb"}),(0,s.jsx)("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:new Date(e.timestamp).toLocaleString("zh-CN")})]}),(0,s.jsxs)("p",{style:{margin:"0.5rem 0",fontWeight:"bold"},children:["\u9875\u9762: ",(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.docTitle||e.url})]}),e.comment&&(0,s.jsxs)("div",{style:{background:"white",padding:"0.75rem",borderRadius:"4px",margin:"0.5rem 0"},children:[(0,s.jsx)("strong",{children:"\u7528\u6237\u8bc4\u8bba:"}),(0,s.jsx)("p",{style:{margin:"0.5rem 0 0 0"},children:e.comment})]}),(0,s.jsxs)("details",{style:{marginTop:"0.5rem"},children:[(0,s.jsx)("summary",{style:{cursor:"pointer",color:"#6b7280"},children:"\u6280\u672f\u4fe1\u606f"}),(0,s.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:[(0,s.jsxs)("p",{children:["URL: ",e.url]}),(0,s.jsxs)("p",{children:["User Agent: ",e.userAgent]}),(0,s.jsxs)("p",{children:["\u65f6\u95f4\u6233: ",e.timestamp]})]})]})]},t))})]})})}}}]);