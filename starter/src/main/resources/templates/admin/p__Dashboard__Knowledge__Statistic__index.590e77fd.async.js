"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[5922],{36533:function(e,t,s){s.r(t);var i=s(90819),a=s.n(i),n=s(89933),r=s.n(n),l=s(45332),d=s.n(l),o=s(44194),c=s(98123),u=s(44781),x=s(62673),g=s(3849),m=s(67402),j=s(88996),h=s(75365),p=s(88201),f=s(5602),v=s(59485),y=s(29266),k=s(95454),Z=s(7875),w=s(10737),F=s(21499),M=s(89717),b=s(24562),O=s(5939),S=s(61107),Y=s(80556),R=s(90151),A=s(90297),T=s(90727),C=s(429),D=s(30921),z=s(24170),E=s(72614),U=s(76750),W=s(40612),P=s(1902),q=s(95490),I=s(55735),B=s(28977),H=s.n(B),N=s(86803),G=s(31549),$=c.default.RangePicker,_=u.default.Option;t.default=function(){var e,t,s=(0,D.useIntl)(),i=(0,U.Z)().translateStringTranct,n=(0,o.useState)(H()().startOf("day")),l=d()(n,2),c=l[0],B=l[1],J=(0,o.useState)(H()().endOf("day")),K=d()(J,2),L=K[0],Q=K[1],V=(0,o.useState)("today"),X=d()(V,2),ee=X[0],te=X[1],se=(0,o.useState)(I.AOk),ie=d()(se,2),ae=ie[0],ne=ie[1],re=(0,o.useState)(),le=d()(re,2),de=le[0],oe=le[1],ce=(0,o.useState)(),ue=d()(ce,2),xe=ue[0],ge=ue[1],me=(0,W.u)((function(e){return e.currentOrg})),je=(0,P.E)((function(e){return e})),he=je.agentResult,pe=je.setAgentResult,fe=(0,q.$)((function(e){return e})),ve=fe.workgroupResult,ye=fe.setWorkgroupResult,ke=(0,o.useState)(),Ze=d()(ke,2),we=(Ze[0],Ze[1],(0,o.useState)(I.OwA)),Fe=d()(we,2),Me=Fe[0],be=Fe[1],Oe=(0,o.useState)(!1),Se=d()(Oe,2),Ye=(Se[0],Se[1]),Re=[{label:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.timeRange.today"}),value:"today"},{label:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.timeRange.yesterday"}),value:"yesterday"},{label:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.timeRange.week"}),value:"week"},{label:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.timeRange.lastWeek"}),value:"lastWeek"},{label:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.timeRange.month"}),value:"month"},{label:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.timeRange.custom"}),value:"custom"}],Ae={total:1580,newToday:12,updatedMonth:156,coverage:85.6},Te={total:25600,avgClicks:35,searchCount:8900,hitRate:92.5},Ce={helpful:2360,unhelpful:180,feedbackRate:15.8,comments:560},De=(D.FormattedMessage,D.FormattedMessage,D.FormattedMessage,D.FormattedMessage,D.FormattedMessage,{newArticles:85,updates:156,visits:12580,searches:4560}),ze=[{date:"2024-01",articles:1200,updates:580,visits:25600},{date:"2024-02",articles:1280,updates:620,visits:28900}];(0,o.useEffect)((function(){if("custom"===ee)B(c),Q(L),be(I.dd4);else{var e=H()();"today"===ee?(B(e),Q(e),be(I.OwA)):"yesterday"===ee?(B(e.subtract(1,"day")),Q(e.subtract(1,"day")),be(I.OwA)):"week"===ee?(B(e.startOf("week")),Q(e.endOf("week")),be(I.dd4)):"lastWeek"===ee?(B(e.subtract(1,"week").startOf("week")),Q(e.subtract(1,"week").endOf("week")),be(I.dd4)):"month"===ee&&(B(e.startOf("month")),Q(e.endOf("month")),be(I.dd4))}}),[ee]);var Ee=function(){var e=r()(a()().mark((function e(){var t,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N.yw.loading("loading"),t={pageNumber:0,pageSize:50,orgUid:null==me?void 0:me.uid},e.next=4,(0,E.u7)(t);case 4:s=e.sent,console.log("fetchAllWorkgroups: ",s),200===s.code?(N.yw.destroy(),ye(s),s.data.content.length>0&&ge(s.data.content[0].uid)):(N.yw.destroy(),N.yw.error(s.message));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=r()(a()().mark((function e(){var t,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N.yw.loading("loading"),t={pageNumber:0,pageSize:50,orgUid:null==me?void 0:me.uid},e.next=4,(0,z._t)(t);case 4:s=e.sent,console.log("fetchAllAgents: ",s),200===s.code?(N.yw.destroy(),pe(s),s.data.content.length>0&&oe(s.data.content[0].uid)):(N.yw.destroy(),N.yw.error(i(s.message))),console.log("queryAllAgents response",s);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),We=function(){var e=r()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ye(!0);try{N.yw.loading("loading"),{type:ae,statisticStartTime:null==c?void 0:c.format("YYYY-MM-DD 00:00:00"),statisticEndTime:null==L?void 0:L.format("YYYY-MM-DD 23:59:59"),workgroupUid:xe,assigneeUid:de,orgUid:null==me?void 0:me.uid}}catch(e){N.yw.error(s.formatMessage({id:"ticket.message.operation.failed"}))}finally{Ye(!1)}case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=r()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.yw.loading("loading"),{type:ae,statisticStartTime:null==c?void 0:c.format("YYYY-MM-DD 00:00:00"),statisticEndTime:null==L?void 0:L.format("YYYY-MM-DD 23:59:59"),workgroupUid:xe,assigneeUid:de,orgUid:null==me?void 0:me.uid};case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){Ee(),Ue()}),[]),(0,o.useEffect)((function(){We()}),[ae,de,xe]),(0,o.useEffect)((function(){Pe()}),[Me,ae,de,xe]),(0,o.useEffect)((function(){We()}),[c,L]),(0,G.jsxs)("div",{style:{padding:16},children:[(0,G.jsx)(x.Z,{style:{marginBottom:16},children:(0,G.jsxs)(g.Z,{direction:"vertical",style:{width:"100%"},children:[(0,G.jsxs)(g.Z,{wrap:!0,children:[(0,G.jsx)(m.ZP.Group,{value:ee,onChange:function(e){return te(e.target.value)},children:Re.map((function(e){return(0,G.jsx)(m.ZP.Button,{value:e.value,children:e.label},e.value)}))}),"custom"===ee&&(0,G.jsx)($,{value:[c,L],onChange:function(e){B(e[0]),Q(e[1])}})]}),(0,G.jsxs)(g.Z,{wrap:!0,children:[(0,G.jsxs)(u.default,{placeholder:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.type"}),style:{width:200},value:ae,onChange:function(e){return ne(e)},children:[(0,G.jsx)(_,{value:I.AOk,children:(0,G.jsx)(D.FormattedMessage,{id:"i18n.all"})}),(0,G.jsx)(_,{value:I.pHh,children:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.agent"})}),(0,G.jsx)(_,{value:I.ti4,children:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.workgroup"})})]}),ae===I.pHh&&(0,G.jsx)(u.default,{placeholder:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.agent"}),style:{width:200},value:de,onChange:function(e){return oe(e)},children:null===(e=he.data)||void 0===e||null===(e=e.content)||void 0===e?void 0:e.map((function(e){return(0,G.jsx)(_,{value:null==e?void 0:e.uid,children:i(null==e?void 0:e.nickname)},null==e?void 0:e.uid)}))}),ae===I.ti4&&(0,G.jsx)(u.default,{placeholder:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.department"}),style:{width:200},value:xe,onChange:function(e){return ge(e)},children:null===(t=ve.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return(0,G.jsx)(_,{value:null==e?void 0:e.uid,children:i(null==e?void 0:e.nickname)},null==e?void 0:e.uid)}))}),(0,G.jsx)(j.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.export"}),children:(0,G.jsx)(h.ZP,{icon:(0,G.jsx)(S.Z,{}),onClick:function(){N.yw.warning("TODO: 待实现")},children:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.export"})})}),(0,G.jsx)(j.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.refresh"}),children:(0,G.jsx)(h.ZP,{icon:(0,G.jsx)(Y.Z,{}),onClick:function(){return We()},children:(0,G.jsx)(D.FormattedMessage,{id:"ticket.statistic.filter.refresh"})})}),!1]})]})}),(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.analysis"}),children:(0,G.jsxs)(p.Z,{gutter:[16,16],children:[(0,G.jsx)(f.Z,{span:6,children:(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.newArticles"}),value:De.newArticles,suffix:(0,G.jsx)(j.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.compare"}),children:(0,G.jsx)(y.Z,{color:"green",children:"+15%"})})})}),(0,G.jsx)(f.Z,{span:6,children:(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.updates"}),value:De.updates,suffix:(0,G.jsx)(j.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.compare"}),children:(0,G.jsx)(y.Z,{color:"blue",children:"+8%"})})})}),(0,G.jsx)(f.Z,{span:6,children:(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.visits"}),value:De.visits,suffix:(0,G.jsx)(j.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.compare"}),children:(0,G.jsx)(y.Z,{color:"green",children:"+23%"})})})}),(0,G.jsx)(f.Z,{span:6,children:(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.searches"}),value:De.searches,suffix:(0,G.jsx)(j.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.compare"}),children:(0,G.jsx)(y.Z,{color:"blue",children:"+12%"})})})})]})}),(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.growth.trend"}),style:{marginTop:16},children:(0,G.jsx)(w.Z,{data:[ze,ze],xField:"date",yField:["articles","visits"],geometryOptions:[{geometry:"column",columnStyle:{radius:[4,4,0,0]}},{geometry:"line",lineStyle:{lineWidth:2}}]})}),(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.heatmap"}),style:{marginTop:16},children:(0,G.jsx)(F.Z,{data:[{hour:"00:00",day:"周一",value:10},{hour:"01:00",day:"周一",value:5}],xField:"hour",yField:"day",colorField:"value",shape:"square"})}),(0,G.jsxs)(p.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,G.jsx)(f.Z,{span:12,children:(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.comparison"}),children:(0,G.jsx)(M.Z,{data:[{type:"上周",value:890},{type:"本周",value:1080},{type:"环比",value:980},{type:"同比",value:850}],xField:"type",yField:"value",label:{position:"top"}})})}),(0,G.jsx)(f.Z,{span:12,children:(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.time.distribution"}),children:(0,G.jsx)(b.Z,{data:[{time:"工作时间",value:68},{time:"非工作时间",value:32}],angleField:"value",colorField:"time",radius:.8})})})]}),(0,G.jsxs)(p.Z,{gutter:[16,16],children:[(0,G.jsx)(f.Z,{span:6,children:(0,G.jsxs)(x.Z,{children:[(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.articles.total"}),value:Ae.total,prefix:(0,G.jsx)(R.Z,{}),suffix:(0,G.jsxs)("small",{style:{fontSize:14},children:["(+",Ae.newToday,")"]})}),(0,G.jsx)(k.Z,{percent:Ae.coverage,size:"small",status:"active"})]})}),(0,G.jsx)(f.Z,{span:6,children:(0,G.jsxs)(x.Z,{children:[(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.visits.total"}),value:Te.total,prefix:(0,G.jsx)(A.Z,{})}),(0,G.jsx)(k.Z,{percent:Te.avgClicks/50*100,size:"small"})]})}),(0,G.jsx)(f.Z,{span:6,children:(0,G.jsxs)(x.Z,{children:[(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.search.count"}),value:Te.searchCount,prefix:(0,G.jsx)(T.Z,{})}),(0,G.jsx)(k.Z,{percent:Te.hitRate,size:"small",status:"active"})]})}),(0,G.jsx)(f.Z,{span:6,children:(0,G.jsxs)(x.Z,{children:[(0,G.jsx)(v.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.feedback.helpful"}),value:Ce.helpful,prefix:(0,G.jsx)(C.Z,{})}),(0,G.jsx)(k.Z,{percent:Ce.feedbackRate,size:"small"})]})})]}),(0,G.jsxs)(p.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,G.jsx)(f.Z,{span:12,children:(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.article.status"}),children:(0,G.jsx)(b.Z,{data:[{status:"已发布",value:1200},{status:"待审核",value:85},{status:"草稿",value:156},{status:"已归档",value:89},{status:"待更新",value:50}],angleField:"value",colorField:"status",radius:.8})})}),(0,G.jsx)(f.Z,{span:12,children:(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.visit.trend"}),children:(0,G.jsx)(O.Z,{data:[{date:"2024-01-01",visits:580,searches:256},{date:"2024-01-02",visits:680,searches:312}],xField:"date",yField:"visits",seriesField:"type"})})})]}),(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.search.hot"}),style:{marginTop:16},children:(0,G.jsx)(M.Z,{data:[{word:"登录问题",count:256},{word:"密码重置",count:198},{word:"账号注册",count:156}],xField:"word",yField:"count",label:{position:"top"}})}),(0,G.jsxs)(p.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,G.jsx)(f.Z,{span:8,children:(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.quality.score"})})}),(0,G.jsx)(f.Z,{span:16,children:(0,G.jsx)(x.Z,{title:(0,G.jsx)(D.FormattedMessage,{id:"knowledge.statistic.quality.detail"}),children:(0,G.jsx)(Z.Z,{columns:[{key:"metric",title:"指标",dataIndex:"metric"},{key:"score",title:"得分",dataIndex:"score"},{key:"trend",title:"趋势",dataIndex:"trend"}],dataSource:[{key:"metric",metric:"内容完整度",score:85,trend:"上升"},{key:"score",metric:"更新及时性",score:78,trend:"稳定"},{key:"trend",metric:"用户满意度",score:92,trend:"上升"}],size:"small"})})})]})]})}}}]);