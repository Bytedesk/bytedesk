"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6693],{9465:function(ye,oe,t){t.d(oe,{Ck:function(){return z},qL:function(){return x},z4:function(){return ue}});var Y=t(15009),a=t.n(Y),fe=t(97857),c=t.n(fe),ae=t(99289),O=t.n(ae),te=t(85615),b=t(86745);function x(R){return J.apply(this,arguments)}function J(){return J=O()(a()().mark(function R(X){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,b.request)("/api/v1/quickbutton/query/org",{method:"GET",params:c()(c()({},X),{},{client:te.bV})}));case 1:case"end":return d.stop()}},R)})),J.apply(this,arguments)}function ue(R){return h.apply(this,arguments)}function h(){return h=O()(a()().mark(function R(X){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,b.request)("/api/v1/quickbutton/create",{method:"POST",data:c()(c()({},X),{},{client:te.bV})}));case 1:case"end":return d.stop()}},R)})),h.apply(this,arguments)}function z(R){return $.apply(this,arguments)}function $(){return $=O()(a()().mark(function R(X){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,b.request)("/api/v1/quickbutton/update",{method:"POST",data:c()(c()({},X),{},{client:te.bV})}));case 1:case"end":return d.stop()}},R)})),$.apply(this,arguments)}function H(R){return ne.apply(this,arguments)}function ne(){return ne=_asyncToGenerator(_regeneratorRuntime().mark(function R(X){return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/api/v1/quickbutton/delete",{method:"POST",data:_objectSpread(_objectSpread({},X),{},{client:HTTP_CLIENT})}));case 1:case"end":return d.stop()}},R)})),ne.apply(this,arguments)}},76545:function(ye,oe,t){t.d(oe,{$l:function(){return z},gf:function(){return H},lg:function(){return ue},p0:function(){return x}});var Y=t(15009),a=t.n(Y),fe=t(97857),c=t.n(fe),ae=t(99289),O=t.n(ae),te=t(85615),b=t(86745);function x(R){return J.apply(this,arguments)}function J(){return J=O()(a()().mark(function R(X){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,b.request)("/api/v1/robot/query/org",{method:"GET",params:c()(c()({},X),{},{client:te.bV})}));case 1:case"end":return d.stop()}},R)})),J.apply(this,arguments)}function ue(R){return h.apply(this,arguments)}function h(){return h=O()(a()().mark(function R(X){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,b.request)("/api/v1/robot/create",{method:"POST",data:c()(c()({},X),{},{client:te.bV})}));case 1:case"end":return d.stop()}},R)})),h.apply(this,arguments)}function z(R){return $.apply(this,arguments)}function $(){return $=O()(a()().mark(function R(X){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,b.request)("/api/v1/robot/update",{method:"POST",data:c()(c()({},X),{},{client:te.bV})}));case 1:case"end":return d.stop()}},R)})),$.apply(this,arguments)}function H(R){return ne.apply(this,arguments)}function ne(){return ne=O()(a()().mark(function R(X){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,b.request)("/api/v1/robot/delete",{method:"POST",data:c()(c()({},X),{},{client:te.bV})}));case 1:case"end":return d.stop()}},R)})),ne.apply(this,arguments)}},77154:function(ye,oe,t){var Y=t(39825);function a(){var fe=(0,Y.Z)(),c=fe.isDarkMode,ae={borderRight:c?"1px solid #333":"1px solid #ccc",background:c?"#141414":"#f5f5f5",width:260},O={background:c?"#141414":"#fff"},te={borderLeft:c?"1px solid #333":"1px solid #ccc",background:c?"#141414":"#f5f5f5"},b={minHeight:120,background:c?"#141414":"#f5f5f5"};return{leftSiderStyle:ae,headerStyle:O,rightSiderStyle:te,contentStyle:b}}oe.Z=a},73803:function(ye,oe,t){var Y=t(85615),a=t(66419),fe=t(86745);function c(){var ae=(0,fe.useIntl)(),O=function(x){return x&&x.startsWith(Y.Vo)?ae.formatMessage({id:x,defaultMessage:x}):x},te=function(x){return x!=null&&x.startsWith(Y.Vo)?(0,a.aS)(ae.formatMessage({id:x}),10):(0,a.aS)(x,10)};return{translateString:O,translateStringTranct:te}}oe.Z=c},76086:function(ye,oe,t){t.r(oe),t.d(oe,{default:function(){return en}});var Y=t(21612),a=t(67294),fe=t(15009),c=t.n(fe),ae=t(99289),O=t.n(ae),te=t(5574),b=t.n(te),x=t(37326),J=t(85576),ue=t(86250),h=t(14726),z=t(2487),$=t(7134),H=t(11475),ne=t(64789),R=t(86745),X=t(39825),L=t(87676),d=t(85615),N=t(8232),Se=t(96365),Je=t(64631),e=t(85893),Xe=function(n){var s=n.open,r=n.onClose,o=n.onSubmit,u=N.Z.useForm(),m=b()(u,1),v=m[0],p=(0,L.u)(function(F){return F.orgCurrent}),i=function(){console.log("handleSaveRobot"),v.validateFields().then(function(f){console.log("handleSaveRobot values:",f);var Q={nickname:f.nickname,type:f.type,orgUid:p.uid};console.log("robotObject:",Q),o(Q)}).catch(function(f){console.log("Form errors:",f)})},D=function(){r()},B=[{title:"\u5BA2\u670D\u673A\u5668\u4EBA",value:d.f4},{title:"\u8425\u9500\u673A\u5668\u4EBA(\u5F00\u53D1\u4E2D...)",value:d.wG}],w=function(f){console.log("onTreeSelectChange:",f)};return(0,e.jsx)("div",{children:(0,e.jsx)(J.Z,{title:"\u65B0\u5EFA\u673A\u5668\u4EBA",open:s,okText:"\u4FDD\u5B58",onOk:i,onCancel:D,children:(0,e.jsxs)(N.Z,{form:v,name:"basic",style:{maxWidth:400},children:[(0,e.jsx)(N.Z.Item,{label:"\u6635\u79F0",name:"nickname",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6635\u79F0!"}],children:(0,e.jsx)(Se.Z,{})}),(0,e.jsx)(N.Z.Item,{label:"\u7C7B\u578B",name:"type",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B!"}],children:(0,e.jsx)(Je.Z,{style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"\u9009\u62E9\u7C7B\u578B",allowClear:!0,treeDefaultExpandAll:!0,onChange:w,treeData:B})})]})})})},qe=Xe,Fe=t(76545),V=t(80049),We=t(73803),et=function(){var n=(0,X.Z)(),s=n.isDarkMode,r=(0,R.useIntl)(),o=(0,a.useRef)(!1),u=(0,We.Z)(),m=u.translateString,v=u.translateStringTranct,p=(0,x.V)(function(K){return{robotResult:K.robotResult,currentRobot:K.currentRobot,insertRobot:K.insertRobot,deleteCurrentRobot:K.deleteCurrentRobot,setRobotResult:K.setRobotResult,setCurrentRobot:K.setCurrentRobot}}),i=p.robotResult,D=p.currentRobot,B=p.insertRobot,w=p.deleteCurrentRobot,F=p.setRobotResult,f=p.setCurrentRobot,Q=(0,L.u)(function(K){return K.orgCurrent}),y=J.Z.useModal(),T=b()(y,2),P=T[0],E=T[1],S=function(k){P.confirm({title:"\u5220\u9664\u63D0\u793A",icon:(0,e.jsx)(H.Z,{}),content:"\u786E\u8BA4\u8981\u5220\u9664\u673A\u5668\u4EBA\u3010".concat(m(k.nickname),"\u3011\u5417\uFF1F"),onOk:function(){console.log("\u786E\u8BA4\u5220\u9664"),C(k)},onCancel:function(){console.log("\u53D6\u6D88\u5220\u9664")},okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},C=function(){var K=O()(c()().mark(function k(G){var q;return c()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return console.log("delete robot",G),W.next=3,(0,Fe.gf)(G);case 3:q=W.sent,console.log("delete robot response",q),q.code===200?(V.yw.success("\u5220\u9664\u5BA2\u670D\u6210\u529F"),w(G.uid)):V.yw.error(q.message);case 6:case"end":return W.stop()}},k)}));return function(G){return K.apply(this,arguments)}}(),g=function(){var K=O()(c()().mark(function k(){var G,q;return c()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!o.current){W.next=3;break}return console.log("isLoading: 1",o.current),W.abrupt("return");case 3:return o.current=!0,V.yw.loading("loading"),G={pageNumber:0,pageSize:50,orgUid:Q.uid},W.next=8,(0,Fe.p0)(G);case 8:q=W.sent,console.log("queryRobotsByOrg: ",q),q.code===200?F(q):V.yw.error(q.message),o.current=!1,V.yw.destroy();case 13:case"end":return W.stop()}},k)}));return function(){return K.apply(this,arguments)}}();(0,a.useEffect)(function(){console.log("getRobots"),g()},[]);var M=(0,a.useState)(!1),j=b()(M,2),re=j[0],U=j[1],A=function(){U(!0)},Z=function(){var K=O()(c()().mark(function k(G){var q;return c()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return V.yw.loading("creating..."),W.next=3,(0,Fe.lg)(G);case 3:q=W.sent,console.log("handleSaveRobot response:",q),q.code===200?(V.yw.success("\u521B\u5EFA\u6210\u529F"),B(q.data),U(!1)):V.yw.error(q.message),V.yw.destroy();case 7:case"end":return W.stop()}},k)}));return function(G){return K.apply(this,arguments)}}(),de=function(){U(!1)},se=function(){A()},pe=function(k,G){f(k)},ve=function(k){return(k==null?void 0:k.type)===d.f4?"\u5BA2\u670D\u673A\u5668\u4EBA":(k==null?void 0:k.type)===d.wG?"\u8425\u9500\u673A\u5668\u4EBA":k==null?void 0:k.type};return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{margin:10},children:(0,e.jsxs)(ue.Z,{gap:"small",align:"flex-start",children:[(0,e.jsx)(h.ZP,{size:"small",type:"primary",icon:(0,e.jsx)(ne.Z,{}),onClick:se,children:r.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,e.jsx)(h.ZP,{size:"small",onClick:g,children:"\u5237\u65B0"}),(0,e.jsx)(h.ZP,{onClick:function(){return S(D)},size:"small",style:{float:"right"},danger:!0,disabled:(D==null?void 0:D.uid)==="",children:r.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]})}),(0,e.jsx)(z.Z,{itemLayout:"horizontal",dataSource:i.data.content,renderItem:function(k,G){return(0,e.jsx)(z.Z.Item,{style:(D==null?void 0:D.uid)===k.uid?{backgroundColor:s?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){return pe(k,G)},children:(0,e.jsx)(z.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,e.jsx)($.C,{src:k.avatar}),title:(0,e.jsx)(e.Fragment,{children:v(k==null?void 0:k.nickname)}),description:ve(k)})})}}),(0,e.jsx)(qe,{open:re,onClose:de,onSubmit:Z}),E]})},tt=et,we=t(48096),ke=t(85322),nt=t(9220),rt=t(97857),le=t.n(rt),ot=t(66723),ze=t(88484),je=t(34994),at=t(5966),Ce=t(90672),lt=function(){var l,n=N.Z.useForm(),s=b()(n,1),r=s[0],o=(0,R.useIntl)(),u=(0,We.Z)(),m=u.translateString,v=(0,x.V)(function(P){return{currentRobot:P.currentRobot,setCurrentRobot:P.setCurrentRobot}}),p=v.currentRobot,i=v.setCurrentRobot,D=(0,a.useState)(""),B=b()(D,2),w=B[0],F=B[1];(0,a.useEffect)(function(){var P=x.V.subscribe(function(E,S){var C,g,M;r.setFieldValue("nickname",m((C=E.currentRobot)===null||C===void 0?void 0:C.nickname)),r.setFieldValue("welcomeTip",m((g=E.currentRobot)===null||g===void 0||(g=g.serviceSettings)===null||g===void 0?void 0:g.welcomeTip)),r.setFieldValue("description",m((M=E.currentRobot)===null||M===void 0?void 0:M.description))});return P},[p]);var f=function(){var P=O()(c()().mark(function E(S){var C,g;return c()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return console.log("onFinish:",S),V.yw.loading("\u6B63\u5728\u4FEE\u6539"),C=le()(le()(le()({},p),S),{},{avatar:w}),console.log("robotObject:",C),j.next=6,(0,Fe.$l)(C);case 6:g=j.sent,console.log("updateRobot response:",g),g.code===200?(V.yw.success("\u4FEE\u6539\u6210\u529F"),i(g.data)):V.yw.error("\u4FEE\u6539\u5931\u8D25"),V.yw.destroy();case 10:case"end":return j.stop()}},E)}));return function(S){return P.apply(this,arguments)}}(),Q=function(E){console.log("handleUploadSuccess:",E),F(E)},y=function(E){console.log("handleUploadError:",E)},T=function(E){return console.log("Upload event:",E),Array.isArray(E)?E:E==null?void 0:E.fileList};return(0,a.useEffect)(function(){F(p==null?void 0:p.avatar)},[p]),(0,e.jsxs)(je.A,{form:r,onFinish:f,initialValues:{nickname:m(p==null?void 0:p.nickname),welcomeTip:m(p==null||(l=p.serviceSettings)===null||l===void 0?void 0:l.welcomeTip),description:m(p==null?void 0:p.description)},children:[(0,e.jsx)(N.Z.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:T,label:o.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,e.jsxs)(ot.G,{onSuccess:Q,onError:y,children:[(0,e.jsx)($.C,{src:w}),(0,e.jsx)(h.ZP,{icon:(0,e.jsx)(ze.Z,{}),children:o.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,e.jsx)(at.Z,{width:"md",name:"nickname",label:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),tooltip:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),placeholder:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"})}),(0,e.jsx)(Ce.Z,{width:"md",name:"welcomeTip",label:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),tooltip:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),placeholder:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"})}),(0,e.jsx)(Ce.Z,{width:"md",name:"description",label:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),tooltip:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),placeholder:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"})})]})},st=function(){var n=(0,R.useIntl)(),s=(0,a.useState)(!1),r=b()(s,2),o=r[0],u=r[1],m=(0,x.V)(function(p){return p.currentRobot}),v=(0,a.useMemo)(function(){return"http://www.weiyuai.cn/chat?t="+d.xt+"&sid="+m.uid+"&"},[m]);return(0,e.jsx)(nt.Z,{onResize:function(i){u(i.width<596)},children:(0,e.jsxs)(ke.Z,{split:o?"horizontal":"vertical",bordered:!0,headerBordered:!0,children:[(0,e.jsx)(ke.Z,{colSpan:"50%",layout:"center",children:(0,e.jsx)(lt,{})}),(0,e.jsx)(ke.Z,{title:n.formatMessage({id:"pages.robot.tab.preview",defaultMessage:"Preview"}),bordered:!0,extra:(0,e.jsx)(e.Fragment,{}),tooltip:n.formatMessage({id:"pages.robot.tab.preview",defaultMessage:"Preview"}),layout:"center",children:(0,e.jsx)("div",{className:"chat-iframe-outer",children:(0,e.jsx)("iframe",{id:"chat-iframe",src:v,title:"demo",width:"100%",height:"100%",style:{border:0},"data-loaded":"true"})})})]})},"resize-observer")};function tn(l){return Pe.apply(this,arguments)}function Pe(){return Pe=_asyncToGenerator(_regeneratorRuntime().mark(function l(n){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/v1/kb/query",{method:"GET",params:{pageNumber:n.pageNumber,pageSize:n.pageSize,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},l)})),Pe.apply(this,arguments)}function it(l,n){return Ze.apply(this,arguments)}function Ze(){return Ze=O()(c()().mark(function l(n,s){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,R.request)("/api/v1/kb/file/query",{method:"GET",params:{kbName:n,pageNumber:s.pageNumber,pageSize:s.pageSize,client:d.bV}}));case 1:case"end":return o.stop()}},l)})),Ze.apply(this,arguments)}function ut(l,n){return Oe.apply(this,arguments)}function Oe(){return Oe=O()(c()().mark(function l(n,s){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,R.request)("/api/v1/kb/doc/query",{method:"GET",params:{kbName:n,pageNumber:s.pageNumber,pageSize:s.pageSize,client:d.bV}}));case 1:case"end":return o.stop()}},l)})),Oe.apply(this,arguments)}function nn(l,n){return Ae.apply(this,arguments)}function Ae(){return Ae=_asyncToGenerator(_regeneratorRuntime().mark(function l(n,s){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",request("/api/llm/kb/file/doc/update",{method:"POST",data:{did:n,pageContent:s,client:HTTP_CLIENT}}));case 1:case"end":return o.stop()}},l)})),Ae.apply(this,arguments)}function rn(l,n,s){return Ke.apply(this,arguments)}function Ke(){return Ke=_asyncToGenerator(_regeneratorRuntime().mark(function l(n,s,r){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",request("/update/doc",{method:"POST",data:{did:n,content:s,metadata:r,client:HTTP_CLIENT}}));case 1:case"end":return u.stop()}},l)})),Ke.apply(this,arguments)}function ct(l){return(0,R.request)("/api/v1/kb/file/delete",{method:"POST",params:{kid:l,client:d.bV}})}function dt(l){return Ie.apply(this,arguments)}function Ie(){return Ie=O()(c()().mark(function l(n){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,R.request)("/api/v1/kb/doc/delete",{method:"POST",params:{did:n,client:d.bV}}));case 1:case"end":return r.stop()}},l)})),Ie.apply(this,arguments)}function on(l){return Be.apply(this,arguments)}function Be(){return Be=_asyncToGenerator(_regeneratorRuntime().mark(function l(n){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/delete/doc",{method:"POST",data:{did:n,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},l)})),Be.apply(this,arguments)}var ft=t(64529),Ne=t(782),mt=t(71381),Re=(0,ft.Ue)()((0,Ne.mW)((0,Ne.tJ)((0,mt.n)(function(l,n){return{kbFileResult:{},kbDocResult:{items:[]},currentKbFile:{},currentKbDoc:{fileName:"",pageContent:""},fetchFiles:function(){var s=O()(c()().mark(function o(u,m){var v;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("kbName",u," pageParams",m),i.next=3,it(u,m);case 3:v=i.sent,console.log("kbName kbFiles",v);case 5:case"end":return i.stop()}},o)}));function r(o,u){return s.apply(this,arguments)}return r}(),deleteFile:function(){var s=O()(c()().mark(function o(u){var m,v,p,i,D;return c()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return console.log("delete file",u),w.next=3,ct(u);case 3:m=w.sent,v=n().kbFileResult.data.content.filter(function(F){return F.uid!==u}),l(function(F){return{kbFileResult:{items:v}}}),console.log("delete file result",m),p=n().kbDocResult.data.content,i=c()().mark(function F(){var f;return c()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:f=m.data[D],p=p.filter(function(T){return T.uid!==f});case 2:case"end":return y.stop()}},F)}),D=0;case 10:if(!(D<m.data.length)){w.next=15;break}return w.delegateYield(i(),"t0",12);case 12:D++,w.next=10;break;case 15:l(function(F){return{kbFileDocResult:{items:p}}});case 16:case"end":return w.stop()}},o)}));function r(o){return s.apply(this,arguments)}return r}(),fetchDocs:function(){var s=O()(c()().mark(function o(u,m){var v;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("fetchFileDocs kbName",u," pageParams",m),i.next=3,ut(u,m);case 3:v=i.sent,console.log("kbName kbFileDocs",v);case 5:case"end":return i.stop()}},o)}));function r(o,u){return s.apply(this,arguments)}return r}(),deleteFileDoc:function(){var s=O()(c()().mark(function o(u){var m,v;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("delete file doc",u),i.next=3,dt(u);case 3:m=i.sent,console.log("delete file doc result",m),v=n().kbDocResult.data.content.filter(function(D){return D.uid!==u}),l(function(D){return{kbFileDocResult:{items:v}}});case 7:case"end":return i.stop()}},o)}));function r(o){return s.apply(this,arguments)}return r}(),setCurrentFile:function(r){var o=n().kbFileResult.data.content.find(function(u){return u.uid===r});l({currentKbFile:o})},setCurrentFileDoc:function(r){var o=n().kbDocResult.data.content.find(function(u){return u.uid===r});console.log("setCurrentFileDoc",r,o),l({currentKbDoc:o})},updateKbFileDocPython:function(){var s=O()(c()().mark(function o(u,m,v){return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:console.log("updateKbFileDocPython",u,m,v);case 1:case"end":return i.stop()}},o)}));function r(o,u,m){return s.apply(this,arguments)}return r}(),deleteKbCache:function(){return l({},!0)}}}),{name:d.cn}))),Ee=t(1269),Me=t(86738),ce=t(45360),Ue=t(85265),De=t(42075),pt=function(){var n=(0,R.useIntl)(),s=N.Z.useForm(),r=b()(s,1),o=r[0],u=(0,x.V)(function(I){return{currentRobot:I.currentRobot}}),m=u.currentRobot,v=(0,a.useRef)(),p=(0,a.useState)(1),i=b()(p,2),D=i[0],B=i[1],w=(0,a.useState)(20),F=b()(w,2),f=F[0],Q=F[1],y=Re(function(I){return{kbFileDocResult:I.kbDocResult,currentKbFileDoc:I.currentKbDoc,fetchFileDocs:I.fetchDocs,setCurrentFileDoc:I.setCurrentFileDoc,updateKbFileDocPython:I.updateKbFileDocPython}}),T=y.kbFileDocResult,P=y.currentKbFileDoc,E=y.fetchFileDocs,S=y.setCurrentFileDoc,C=y.updateKbFileDocPython;Re.subscribe(function(I,ie){console.log("kb",I)});var g=function(){};(0,a.useEffect)(function(){g()},[]),(0,a.useEffect)(function(){g()},[D,f]),(0,a.useEffect)(function(){B(1),g()},[m]),(0,a.useEffect)(function(){v.current.reload()},[T]);var M=(0,a.useState)(!1),j=b()(M,2),re=j[0],U=j[1],A=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),Z=b()(A,2),de=Z[0],se=Z[1],pe=function(){U(!0)},ve=function(){U(!1)},K=function(){U(!1)},k=function(){console.log("handleInputText"),se("\u8F93\u5165\u6587\u672C"),pe()},G=function(){console.log("handleInputUrl"),se("\u8F93\u5165\u7F51\u5740"),pe()};function q(I){S(I.did),pe()}function me(I){console.log("handleDelete",I)}var W=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:n.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:n.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(ie,ge){return[(0,e.jsx)(h.ZP,{type:"link",size:"small",onClick:function(){return q(ge)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Me.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return me(ge)},onCancel:function(){return K()},children:(0,e.jsx)(h.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],Ve=function(ie){console.log("Success:",ie,P.uid,P.meta),C(P.uid,ie.pageContent,P.meta),ce.ZP.success("\u66F4\u65B0\u6210\u529F"),U(!1)},xe=function(ie){console.log("Failed:",ie)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ee.Z,{actionRef:v,columns:W,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(ie,ge,_e){return console.log("request:",ie,ge,_e),B(ie.current-1),Q(ie.pageSize),Promise.resolve({data:T.data.content,success:!0,total:T.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(h.ZP,{onClick:k,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Ue.Z,{title:de,size:"default",placement:"right",onClose:K,open:re,extra:(0,e.jsx)(De.Z,{children:(0,e.jsx)(h.ZP,{onClick:K,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(N.Z,{form:o,name:"basic",onFinish:Ve,onFinishFailed:xe,autoComplete:"off",children:[(0,e.jsx)(N.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(N.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Se.Z.TextArea,{rows:15})}),(0,e.jsx)(N.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(h.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},bt=function(){var n=(0,R.useIntl)(),s=N.Z.useForm(),r=b()(s,1),o=r[0],u=(0,x.V)(function(_){return{currentRobot:_.currentRobot}}),m=u.currentRobot,v=(0,a.useRef)(),p=(0,a.useState)(1),i=b()(p,2),D=i[0],B=i[1],w=(0,a.useState)(20),F=b()(w,2),f=F[0],Q=F[1],y=Re(function(_){return{kbFileDocResult:_.kbDocResult,currentKbFileDoc:_.currentKbDoc,fetchFileDocs:_.fetchDocs,setCurrentFileDoc:_.setCurrentFileDoc,updateKbFileDocPython:_.updateKbFileDocPython}}),T=y.kbFileDocResult,P=y.currentKbFileDoc,E=y.fetchFileDocs,S=y.setCurrentFileDoc,C=y.updateKbFileDocPython;Re.subscribe(function(_,ee){});var g=function(){};(0,a.useEffect)(function(){g()},[]),(0,a.useEffect)(function(){g()},[D,f]),(0,a.useEffect)(function(){B(1),g()},[m]),(0,a.useEffect)(function(){v.current.reload()},[T]);var M=(0,a.useState)(!1),j=b()(M,2),re=j[0],U=j[1],A=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),Z=b()(A,2),de=Z[0],se=Z[1],pe=(0,a.useState)(""),ve=b()(pe,2),K=ve[0],k=ve[1],G=function(){U(!0)},q=function(){U(!1)},me=function(){U(!1)},W=function(){console.log("handleInputText"),se("\u8F93\u5165\u6587\u672C"),G()},Ve=function(){console.log("handleInputUrl"),se("\u8F93\u5165\u7F51\u5740"),G()};function xe(_){S(_.did),G()}function I(_){console.log("handleDelete",_)}var ie=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:n.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:n.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(ee,be){return[(0,e.jsx)(h.ZP,{type:"link",size:"small",onClick:function(){return xe(be)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Me.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return I(be)},onCancel:function(){return me()},children:(0,e.jsx)(h.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],ge=function(ee){console.log("Success:",ee,P.uid,P.meta),C(P.uid,ee.pageContent,P.meta),ce.ZP.success("\u66F4\u65B0\u6210\u529F"),U(!1)},_e=function(ee){console.log("Failed:",ee)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ee.Z,{actionRef:v,columns:ie,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(ee,be,he){return console.log("request:",ee,be,he),B(ee.current-1),Q(ee.pageSize),Promise.resolve({data:T.data.content,success:!0,total:T.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(h.ZP,{onClick:W,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Ue.Z,{title:de,size:"default",placement:"right",onClose:me,open:re,extra:(0,e.jsx)(De.Z,{children:(0,e.jsx)(h.ZP,{onClick:me,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(N.Z,{form:o,name:"basic",onFinish:ge,onFinishFailed:_e,autoComplete:"off",children:[(0,e.jsx)(N.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(N.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Se.Z.TextArea,{rows:15})}),(0,e.jsx)(N.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(h.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},ht=function(){var n=(0,R.useIntl)(),s=N.Z.useForm(),r=b()(s,1),o=r[0],u=(0,x.V)(function(_){return{currentRobot:_.currentRobot}}),m=u.currentRobot,v=(0,a.useRef)(),p=(0,a.useState)(1),i=b()(p,2),D=i[0],B=i[1],w=(0,a.useState)(20),F=b()(w,2),f=F[0],Q=F[1],y=Re(function(_){return{kbFileDocResult:_.kbDocResult,currentKbFileDoc:_.currentKbDoc,fetchFileDocs:_.fetchDocs,setCurrentFileDoc:_.setCurrentFileDoc,updateKbFileDocPython:_.updateKbFileDocPython}}),T=y.kbFileDocResult,P=y.currentKbFileDoc,E=y.fetchFileDocs,S=y.setCurrentFileDoc,C=y.updateKbFileDocPython;Re.subscribe(function(_,ee){o.setFieldValue("pageContent",_.currentKbDoc.content)});var g=function(){};(0,a.useEffect)(function(){g()},[]),(0,a.useEffect)(function(){g()},[D,f]),(0,a.useEffect)(function(){B(1),g()},[m]),(0,a.useEffect)(function(){v.current.reload()},[T]);var M=(0,a.useState)(!1),j=b()(M,2),re=j[0],U=j[1],A=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),Z=b()(A,2),de=Z[0],se=Z[1],pe=(0,a.useState)(""),ve=b()(pe,2),K=ve[0],k=ve[1],G=function(){U(!0)},q=function(){U(!1)},me=function(){U(!1)},W=function(){console.log("handleInputText"),se("\u8F93\u5165\u6587\u672C"),G()},Ve=function(){console.log("handleInputUrl"),se("\u8F93\u5165\u7F51\u5740"),G()};function xe(_){S(_.did),G()}function I(_){console.log("handleDelete",_)}var ie=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:n.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:n.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(ee,be){return[(0,e.jsx)(h.ZP,{type:"link",size:"small",onClick:function(){return xe(be)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Me.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return I(be)},onCancel:function(){return me()},children:(0,e.jsx)(h.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],ge=function(ee){console.log("Success:",ee,P.uid,P.meta),C(P.uid,ee.pageContent,P.meta),ce.ZP.success("\u66F4\u65B0\u6210\u529F"),U(!1)},_e=function(ee){console.log("Failed:",ee)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ee.Z,{actionRef:v,columns:ie,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(ee,be,he){return console.log("request:",ee,be,he),B(ee.current-1),Q(ee.pageSize),Promise.resolve({data:T.data.content,success:!0,total:T.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(h.ZP,{onClick:W,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Ue.Z,{title:de,size:"default",placement:"right",onClose:me,open:re,extra:(0,e.jsx)(De.Z,{children:(0,e.jsx)(h.ZP,{onClick:me,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(N.Z,{form:o,name:"basic",onFinish:ge,onFinishFailed:_e,autoComplete:"off",children:[(0,e.jsx)(N.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(N.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Se.Z.TextArea,{rows:15})}),(0,e.jsx)(N.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(h.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},vt=t(66476),gt=t(27484),Ge=t.n(gt),_t=function(){var n=(0,R.useIntl)(),s=ce.ZP.useMessage(),r=b()(s,2),o=r[0],u=r[1],m=(0,x.V)(function(A){return A.currentRobot}),v=(0,a.useRef)(),p=(0,a.useState)(1),i=b()(p,2),D=i[0],B=i[1],w=(0,a.useState)(10),F=b()(w,2),f=F[0],Q=F[1],y=Re(function(A){return{kbFileResult:A.kbFileResult,fetchFiles:A.fetchFiles,fetchFileDocs:A.fetchDocs,deleteFile:A.deleteFile}}),T=y.kbFileResult,P=y.fetchFiles,E=y.fetchFileDocs,S=y.deleteFile;function C(A){console.log("handleDelete",A),S(A.uid)}function g(){console.log("handleCancel")}var M=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),dataIndex:"name"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(Z,de){return[(0,e.jsx)(Me.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return C(de)},onCancel:function(){return g()},children:(0,e.jsx)(h.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],j=function(){var Z={pageNumber:D,pageSize:f};P(m.uid,Z),E(m.uid,Z)};(0,a.useEffect)(function(){j()},[]),(0,a.useEffect)(function(){j()},[D,f]),(0,a.useEffect)(function(){B(1),j()},[m]),(0,a.useEffect)(function(){v.current.reload()},[T]);var re={file_name:"test.png",file_kid:Ge()(new Date).format("YYYYMMDDHHmmss"),rid:m.uid,client:d.bV},U={name:"file",action:"/api/v1/upload/file",headers:{Authorization:"Bearer "+localStorage.getItem(d.LA).replaceAll('"',"")},showUploadList:!1,data:re,beforeUpload:function(Z){if(Z.name.includes("_"))return ce.ZP.error(n.formatMessage({id:"pages.robot.file.name_invalid",defaultMessage:"File name should not contain _"})),!1;re.file_name=Z.name;var de=Ge()(new Date).format("YYYYMMDDHHmmss");return re.file_kid=de,re.rid=m.uid,console.log("file:",Z," uploadData:",re),o.open({type:"loading",content:n.formatMessage({id:"pages.robot.file.uploading",defaultMessage:"Uploading..."}),duration:0}),!0},onChange:function(Z){Z.file.status!=="uploading"&&console.log(Z.file,Z.fileList),Z.file.status==="done"?(console.log(Z.file.response.data),o.destroy(),ce.ZP.success("".concat(Z.file.name," file uploaded successfully")),j()):Z.file.status==="error"&&ce.ZP.error("".concat(Z.file.name," file upload failed."))}};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ee.Z,{actionRef:v,columns:M,headerTitle:m.nickname,request:function(Z,de,se){return console.log("request:",Z,de,se),B(Z.current),Q(Z.pageSize),Promise.resolve({data:T.data.content,success:!0,total:T.data.totalElements})},rowKey:"kid",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(vt.Z,le()(le()({},U),{},{children:(0,e.jsx)(h.ZP,{icon:(0,e.jsx)(ze.Z,{}),type:"primary",children:n.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})}),"upload")]}}),u]})},Rt=function(){var n=(0,R.useIntl)(),s=[{key:"file",label:n.formatMessage({id:"pages.robot.kb.file",defaultMessage:"File"}),children:(0,e.jsx)(_t,{})},{key:"text",label:n.formatMessage({id:"pages.robot.kb.text",defaultMessage:"Text"}),children:(0,e.jsx)(pt,{})},{key:"qa",label:n.formatMessage({id:"pages.robot.kb.qa",defaultMessage:"Q&A"}),children:(0,e.jsx)(bt,{})},{key:"web",label:n.formatMessage({id:"pages.robot.kb.web",defaultMessage:"Website"}),children:(0,e.jsx)(ht,{})}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(we.Z,{tabPosition:"left",items:s})})},Dt=Rt,He=t(38925),Qe=t(96074),Te=t(71230),yt=function(){var l=(0,x.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Te.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(De.Z,{children:[(0,e.jsx)(h.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(h.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Ft=function(){var l=(0,x.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Te.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(De.Z,{children:[(0,e.jsx)(h.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(h.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},jt=function(){var l=(0,x.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Te.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(De.Z,{children:[(0,e.jsx)(h.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(h.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Ct=function(){var l=(0,x.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Te.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(De.Z,{children:[(0,e.jsx)(h.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(h.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},xt=function(){var n=N.Z.useForm(),s=b()(n,1),r=s[0],o=(0,x.V)(function(i){return i.currentRobot}),u=(0,a.useMemo)(function(){return"http://www.weiyuai.cn/chat?t="+d.xt+"&sid="+o.uid+"&"},[o]);(0,a.useEffect)(function(){var i=x.V.subscribe(function(D){console.log("currentRobot code:",D.currentRobot),r.setFieldValue("code","http://www.weiyuai.cn/chat?t="+d.xt+"&sid="+D.currentRobot.uid+"&")});return i},[o]);var m=function(){window.open(u)},v=function(){navigator.clipboard.writeText(u),ce.ZP.info("code copyied into clicpboard")},p=function(D,B){return[(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){var F;(F=D.form)===null||F===void 0||F.submit(),m()},children:"\u6253\u5F00"},"submit"),(0,e.jsx)(h.ZP,{onClick:function(){v()},children:"\u590D\u5236"},"reset")]};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(je.A,{form:r,style:{marginLeft:"100px"},submitter:{render:p},initialValues:{code:u},children:(0,e.jsx)(Ce.Z,{width:"md",name:"code",label:"Web\u5BA2\u670D\u4EE3\u7801"})})})},St=xt,wt=function(){var n=N.Z.useForm(),s=b()(n,1),r=s[0],o=(0,x.V)(function(i){return i.currentRobot}),u=(0,a.useMemo)(function(){return"http://www.weiyuai.cn/chat?t="+d.xt+"&sid="+o.uid+"&"},[o]);(0,a.useEffect)(function(){var i=x.V.subscribe(function(D){console.log("currentRobot code:",D.currentRobot),r.setFieldValue("code","http://www.weiyuai.cn/chat?t="+d.xt+"&sid="+D.currentRobot.uid+"&")});return i},[o]);var m=function(){window.open(u)},v=function(){navigator.clipboard.writeText(u),ce.ZP.info("code copyied into clicpboard")},p=function(D,B){return[(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){var F;(F=D.form)===null||F===void 0||F.submit(),m()},children:"\u6253\u5F00"},"submit"),(0,e.jsx)(h.ZP,{onClick:function(){v()},children:"\u590D\u5236"},"reset")]};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(je.A,{form:r,style:{marginLeft:"100px"},submitter:{render:p},initialValues:{code:u},children:(0,e.jsx)(Ce.Z,{width:"md",name:"code",label:"H5\u5BA2\u670D\u4EE3\u7801"})})})},Et=wt,Mt=[{key:"web",label:"Web",children:(0,e.jsx)(St,{})},{key:"h5",label:"H5",children:(0,e.jsx)(Et,{})},{key:"ios",label:"iOS",children:(0,e.jsx)(yt,{})},{key:"android",label:"Android",children:(0,e.jsx)(Ct,{})},{key:"uniapp",label:"Uniapp",children:(0,e.jsx)(Ft,{})},{key:"flutter",label:"Flutter",children:(0,e.jsx)(jt,{})}],Tt=function(){var n=(0,R.useIntl)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(He.Z,{message:"\u673A\u5668\u4EBA\u5BF9\u8BDD\uFF0C\u6682\u4E0D\u652F\u6301\u8F6C\u4EBA\u5DE5",type:"success"}),(0,e.jsx)(Qe.Z,{}),(0,e.jsx)(we.Z,{tabPosition:"left",items:Mt})]})},kt=Tt,Le=t(60887),Pt=t(24285);function Zt(l){var n=(0,Le.O1)({id:"draggable"}),s=n.attributes,r=n.listeners,o=n.setNodeRef,u=n.transform,m=u?{transform:Pt.ux.Translate.toString(u)}:void 0;return(0,e.jsx)(h.ZP,le()(le()(le()({ref:o,style:m},r),s),{},{children:l.children}))}function Ot(l){var n=(0,Le.Zj)({id:"droppable"}),s=n.isOver,r=n.setNodeRef,o={color:s?"green":void 0};return(0,e.jsx)("div",{ref:r,style:o,children:l.children})}var Ye=t(77154),an=Y.Z.Header,ln=Y.Z.Footer,At=Y.Z.Sider,Kt=Y.Z.Content,It=function(){var n=(0,R.useIntl)(),s=(0,Ye.Z)(),r=s.leftSiderStyle,o=s.contentStyle,u=(0,a.useState)(!1),m=b()(u,2),v=m[0],p=m[1],i=(0,e.jsx)(Zt,{children:"Drag me"}),D=(0,R.useAccess)();D.canDebug&&console.log("TabQuickReplies canDebug");function B(y){console.log("handleDragStart",y)}function w(y){console.log("handleDragMove",y)}function F(y){console.log("handleDragOver",y)}function f(y){y.over&&y.over.id==="droppable"&&p(!0)}function Q(y){console.log("handleDragCancel",y)}return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(R.Access,{accessible:D.canDebug(),fallback:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(R.FormattedMessage,{id:d.h5})}),children:(0,e.jsx)(Le.LB,{onDragEnd:f,children:(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(At,{style:r,children:v?null:i}),(0,e.jsx)(Kt,{style:o,children:(0,e.jsx)(Ot,{children:v?i:"Drop here"})})]})})})})},Bt=It,Ut=t(52688),$e=t(64317),Lt=t(31199),$t=function(){var l,n,s,r,o,u,m,v,p,i,D=N.Z.useForm(),B=b()(D,1),w=B[0],F=(0,x.V)(function(T){return{currentRobot:T.currentRobot,setCurrentRobot:T.setCurrentRobot}}),f=F.currentRobot,Q=F.setCurrentRobot;x.V.subscribe(function(T,P){var E,S,C,g,M,j;w.setFieldValue("topK",(E=T.currentRobot)===null||E===void 0||(E=E.llm)===null||E===void 0?void 0:E.topK),w.setFieldValue("scoreThreshold",(S=T.currentRobot)===null||S===void 0||(S=S.llm)===null||S===void 0?void 0:S.scoreThreshold),w.setFieldValue("model",(C=T.currentRobot)===null||C===void 0||(C=C.llm)===null||C===void 0?void 0:C.model),w.setFieldValue("embeddings",(g=T.currentRobot)===null||g===void 0||(g=g.llm)===null||g===void 0?void 0:g.embeddings),w.setFieldValue("temperature",(M=T.currentRobot)===null||M===void 0||(M=M.llm)===null||M===void 0?void 0:M.temperature),w.setFieldValue("prompt",(j=T.currentRobot)===null||j===void 0||(j=j.llm)===null||j===void 0?void 0:j.prompt)});var y=function(){var T=O()(c()().mark(function P(E){var S,C;return c()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return console.log("handleSubmit",E),V.yw.loading("\u6B63\u5728\u4FEE\u6539"),S=le()(le()({},f),{},{llm:E}),console.log("robotObject:",S),M.next=6,(0,Fe.$l)(S);case 6:C=M.sent,console.log("updateRobot response:",C),C.code===200?(V.yw.destroy(),V.yw.success("\u4FEE\u6539\u6210\u529F"),Q(C.data)):(V.yw.destroy(),V.yw.error("\u4FEE\u6539\u5931\u8D25"));case 9:case"end":return M.stop()}},P)}));return function(E){return T.apply(this,arguments)}}();return(0,e.jsxs)(je.A,{form:w,size:"large",onFinish:y,initialValues:{enabled:f==null||(l=f.llm)===null||l===void 0?void 0:l.enabled,topK:f==null||(n=f.llm)===null||n===void 0?void 0:n.topK,scoreThreshold:f==null||(s=f.llm)===null||s===void 0?void 0:s.scoreThreshold,model:f==null||(r=f.llm)===null||r===void 0?void 0:r.model,embeddings:f==null||(o=f.llm)===null||o===void 0?void 0:o.embeddings,temperature:f==null||(u=f.llm)===null||u===void 0?void 0:u.temperature,prompt:f==null||(m=f.llm)===null||m===void 0?void 0:m.prompt,apiKey:f==null||(v=f.llm)===null||v===void 0?void 0:v.apiKey,apiSecret:f==null||(p=f.llm)===null||p===void 0?void 0:p.apiSecret,apiUrl:f==null||(i=f.llm)===null||i===void 0?void 0:i.apiUrl},children:[(0,e.jsx)(Ut.Z,{width:"lg",name:"enabled",label:"enabled",tooltip:"\u662F\u5426\u542F\u7528\u5927\u6A21\u578B"}),(0,e.jsx)(Ce.Z,{width:"lg",name:"prompt",label:"prompt",placeholder:"\u8BF7\u8F93\u5165prompt"}),(0,e.jsx)($e.Z,{width:"lg",name:"model",label:"model",allowClear:!0,options:[{value:"ZHIPUAI_GLM_3_TURBO",label:"\u667A\u8C31AI-GLM-3-Turbo"},{value:"ZHIPUAI_GLM_4",label:"\u667A\u8C31AI-GLM-4"},{value:"OLLAMA",label:"Ollama",disabled:!0},{value:"OPENAI",label:"OpenAi",disabled:!0}]}),(0,e.jsx)($e.Z,{width:"lg",name:"embeddings",label:"embeddings",allowClear:!0,options:[{value:"M3E_BASE",label:"m3e-base"}]}),(0,e.jsx)(Lt.Z,{width:"lg",label:"\u6E29\u5EA6",name:"temperature",min:0,max:1,fieldProps:{precision:1,step:.1}})]})},Vt=t(9465),Wt=function(){var n,s=je.A.useForm(),r=b()(s,1),o=r[0],u=(0,L.u)(function(S){return S.orgCurrent}),m=(0,a.useState)(),v=b()(m,2),p=v[0],i=v[1],D=(0,a.useState)([]),B=b()(D,2),w=B[0],F=B[1],f=(0,x.V)(function(S){return{currentRobot:S.currentRobot,setCurrentRobot:S.setCurrentRobot}}),Q=f.currentRobot,y=f.setCurrentRobot,T=function(){var S=O()(c()().mark(function C(){var g,M,j,re;return c()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return V.yw.loading("\u52A0\u8F7D\u4E2D"),M={pageNumber:0,pageSize:50,orgUid:u.uid},A.next=4,(0,Vt.qL)(M);case 4:j=A.sent,console.log("getAllQuickbuttons response:",M,j),V.yw.destroy(),j.code===200?i(j):V.yw.error(j.message),re=[],(g=Q.serviceSettings)===null||g===void 0||g.quickButtons.forEach(function(Z){re.push(Z.uid)}),F(re);case 11:case"end":return A.stop()}},C)}));return function(){return S.apply(this,arguments)}}();(0,a.useEffect)(function(){T()},[u]),(0,a.useEffect)(function(){var S=x.V.subscribe(function(C){var g;console.log("TabQuickButton useRobotStore:",C);var M=[];(g=C.currentRobot.serviceSettings)===null||g===void 0||g.quickButtons.forEach(function(j){M.push(j.uid)}),F(M)});return S},[Q]);var P=function(){var S=O()(c()().mark(function C(g){var M,j;return c()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return console.log("onFinish",g),M=le()(le()({},Q),{},{serviceSettings:le()(le()({},Q.serviceSettings),{},{quickButtonUids:g.quickbutton})}),console.log("robotObject:",M),U.next=5,(0,Fe.$l)(M);case 5:j=U.sent,console.log("updateRobot response:",j),j.code===200?(V.yw.destroy(),V.yw.success("\u4FEE\u6539\u6210\u529F"),y(j.data)):(V.yw.destroy(),V.yw.error("\u4FEE\u6539\u5931\u8D25"));case 8:case"end":return U.stop()}},C)}));return function(g){return S.apply(this,arguments)}}(),E=function(C){console.log("selected ".concat(C)),F(C)};return(0,e.jsxs)("div",{children:[(0,e.jsx)(He.Z,{message:"\u8BF7\u5148\u5230 \u77E5\u8BC6\u5E93 -> \u5FEB\u6377\u6309\u94AE -> \u65B0\u5EFA\uFF0C\u521B\u5EFA\u5FEB\u6377\u6309\u94AE\u4E4B\u540E\uFF0C\u518D\u6765\u6DFB\u52A0",type:"success"}),(0,e.jsx)(Qe.Z,{}),(0,e.jsx)(je.A,{form:o,layout:"vertical",initialValues:{},onFinish:P,children:(0,e.jsx)($e.Z,{name:"quickbutton",width:"md",label:"\u5FEB\u901F\u6309\u94AE",options:p==null||(n=p.data)===null||n===void 0?void 0:n.content.map(function(S){return{label:S.title,value:S.uid}}),fieldProps:{mode:"multiple",onChange:E,allowClear:!0,value:w,placeholder:"\u8BF7\u9009\u62E9"}})})]})},zt=Wt,Nt=[{key:"quickbutton",label:"\u5FEB\u6377\u6309\u94AE",children:(0,e.jsx)(zt,{})},{key:"llm",label:"\u5927\u6A21\u578B",children:(0,e.jsx)($t,{})}],Gt=function(){var n=(0,R.useIntl)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(we.Z,{tabPosition:"left",items:Nt})})},Ht=Gt,Qt=function(){var n=(0,R.useIntl)(),s=function(u){},r=[{key:"basic",label:n.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,e.jsx)(st,{})},{key:"kb",label:n.formatMessage({id:"pages.robot.tab.kb",defaultMessage:"Knowledge Base"}),children:(0,e.jsx)(Dt,{})},{key:"advanced",label:n.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,e.jsx)(Ht,{})},{key:"flow",label:n.formatMessage({id:"pages.robot.tab.flow",defaultMessage:"Flow"}),children:(0,e.jsx)(Bt,{})},{key:"channel",label:n.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,e.jsx)(kt,{})}];return(0,e.jsx)(we.Z,{defaultActiveKey:"1",items:r,onChange:s})},Yt=Qt,Jt=Y.Z.Sider,Xt=Y.Z.Content,qt=function(){var n=(0,Ye.Z)(),s=n.leftSiderStyle,r=n.contentStyle;return(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(Jt,{style:s,children:(0,e.jsx)(tt,{})}),(0,e.jsx)(Y.Z,{children:(0,e.jsx)(Xt,{style:r,children:(0,e.jsx)(Yt,{})})})]})},en=qt},37326:function(ye,oe,t){t.d(oe,{V:function(){return x}});var Y=t(97857),a=t.n(Y),fe=t(19632),c=t.n(fe),ae=t(85615),O=t(64529),te=t(782),b=t(71381),x=(0,O.Ue)()((0,te.mW)((0,te.tJ)((0,b.n)(function(J,ue){return{robotResult:{data:{content:[]}},currentRobot:{uid:"",nickname:""},insertRobot:function(z){J(function($){var H=$.robotResult.data.content;H.unshift(z)})},setRobotResult:function(z){J({robotResult:z});var $=ue().currentRobot;if($.uid===""||$===void 0){var H;((H=z.data)===null||H===void 0||(H=H.content)===null||H===void 0?void 0:H.length)>0&&J({currentRobot:z.data.content[0]})}},setCurrentRobot:function(z){var $=ue().robotResult.data.content,H=$.findIndex(function(X){return X.uid===z.uid});if(H!==-1){var ne=[].concat(c()($.slice(0,H)),[z],c()($.slice(H+1))),R=a()(a()({},ue().robotResult),{},{data:{content:ne}});J({robotResult:R,currentRobot:z})}else console.warn("Robot with the specified uid not found."),J({currentRobot:z})},deleteCurrentRobot:function(z){var $=ue().robotResult.data.content,H=$.findIndex(function(ne){return ne.uid===z});H!==-1?J({robotResult:a()(a()({},ue().robotResult),{},{data:{content:[].concat(c()($.slice(0,H)),c()($.slice(H+1)))}})}):console.warn("Robot not found in cache:",z),ue().currentRobot.uid===z&&J({currentRobot:{uid:""}})},deleteRobotCache:function(){return J({},!0)}}}),{name:ae.Ei})))},66723:function(ye,oe,t){t.d(oe,{G:function(){return J}});var Y=t(97857),a=t.n(Y),fe=t(67294),c=t(66476),ae=t(85615),O=t(27484),te=t.n(O),b=t(80049),x=t(85893),J=function(h){var z=h.children,$=h.onSuccess,H=h.onError,ne={file:null,file_name:"test.png",file_type:"image/png"},R={name:"file",action:"/api/v1/upload/file",headers:{Authorization:"Bearer "+localStorage.getItem(ae.LA)},data:ne,showUploadList:!1,beforeUpload:function(L){console.log("beforeUpload",L);var d=te()(new Date).format("YYYYMMDDHHmmss")+"_"+L.name;ne.file=L,ne.file_name=d,ne.file_type=L.type,console.log("beforeUpload",ne)},onChange:function(L){if(L.file.status!=="uploading"&&console.log(L.file,L.fileList),L.file.status==="done"){var d=L.file.response.data;console.log("url: ",d),$(d),b.yw.success("".concat(L.file.name," \u4E0A\u4F20\u6210\u529F"))}else L.file.status==="error"&&(b.yw.error("".concat(L.file.name," \u4E0A\u4F20\u5931\u8D25")),H(L.file))}};return(0,x.jsx)(c.Z,a()(a()({},R),{},{children:z}))}}}]);
