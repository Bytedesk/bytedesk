"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8455],{70150:function(B,m,e){e.d(m,{W5:function(){return L}});var y=e(15009),l=e.n(y),f=e(97857),a=e.n(f),S=e(99289),c=e.n(S),P=e(85615),p=e(88541),D=e.n(p),A=e(86745);function L(o){return C.apply(this,arguments)}function C(){return C=c()(l()().mark(function o(r){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,A.request)("/api/v1/message/query/org",{method:"GET",params:a()({},r)}));case 1:case"end":return t.stop()}},o)})),C.apply(this,arguments)}function z(o){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function o(r){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/user/robot",{method:"GET",params:{page:r.pageNumber,size:r.pageSize,client:HTTP_CLIENT}}));case 1:case"end":return t.stop()}},o)})),j.apply(this,arguments)}function G(o){return u.apply(this,arguments)}function u(){return u=_asyncToGenerator(_regeneratorRuntime().mark(function o(r){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/message/rest/send",{method:"POST",data:{json:r,client:HTTP_CLIENT}}));case 1:case"end":return t.stop()}},o)})),u.apply(this,arguments)}function N(o,r){return x.apply(this,arguments)}function x(){return x=_asyncToGenerator(_regeneratorRuntime().mark(function o(r,v){var t,i;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:console.log("sendMessageSSE: ",r),t="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(r.sid,"&content=").concat(r.content),i=new EventSource(t,{withCredentials:!1}),i.onopen=function(n){console.log("onopen:",n.target)},i.onmessage=function(n){v(n.data);var s=JSON.parse(n.data);if(s.type=="finish"){i&&i.close();return}},i.onerror=function(n){console.log("onerror:",n),alert("server error"),i.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",n),i.close()},i.addEventListener("customEventName",function(n){console.log("Message id is "+n.lastEventId)});case 7:case"end":return M.stop()}},o)})),x.apply(this,arguments)}function Z(o,r){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function o(r,v){var t,i,d;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:console.log("sendMessageSSEPolyfill: ",r),t=localStorage.ACCESS_TOKEN,i="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(r.sid,"&content=").concat(r.content),d=new EventSourcePolyfill(i,{headers:{Authorization:"Bearer ".concat(t)}}),d.onopen=function(s){console.log("onopen:",s.target)},d.onmessage=function(s){console.log("onmessage:",s.data),v(s.data);var T=JSON.parse(s.data);if(T.type=="finish"){d&&d.close();return}},d.onerror=function(s){console.log("onerror:",s),alert("server error"),d.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",s),d.close()},d.addEventListener("customEventName",function(s){console.log("Message id is "+s.lastEventId)});case 8:case"end":return n.stop()}},o)})),I.apply(this,arguments)}},77154:function(B,m,e){var y=e(39825);function l(){var f=(0,y.Z)(),a=f.isDarkMode,S=250,c={borderRight:a?"1px solid #333":"1px solid #ccc",background:a?"#141414":"#f5f5f5"},P={background:a?"#141414":"#fff"},p={borderLeft:a?"1px solid #333":"1px solid #ccc",background:a?"#141414":"#f5f5f5"},D={minHeight:120,background:a?"#141414":"#f5f5f5"};return{leftSiderStyle:c,leftSiderWidth:S,headerStyle:P,rightSiderStyle:p,contentStyle:D}}m.Z=l},16501:function(B,m,e){e.r(m),e.d(m,{default:function(){return d}});var y=e(77154),l=e(21612),f=e(50136),a=e(67294),S=e(15009),c=e.n(S),P=e(99289),p=e.n(P),D=e(5574),A=e.n(D),L=e(80049),C=e(70150),z=e(69888),j=e(87676),G=e(53719),u=e(85893),N=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,u.jsx)(FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",copyable:!0},{title:(0,u.jsx)(FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0},{title:intl.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",render:function(n,s,T,_){return[(0,u.jsx)("a",{onClick:function(){var R;_==null||(R=_.startEditable)===null||R===void 0||R.call(_,s.uid)},children:"\u4FEE\u6539"},"editable")]}}],x=function(){var n=(0,a.useRef)(),s=(0,a.useState)(1),T=A()(s,2),_=T[0],W=T[1],R=(0,a.useState)(10),$=A()(R,2),K=$[0],J=$[1],Q=(0,j.u)(function(g){return g.currentOrg}),F=(0,z.G)(function(g){return{messageResult:g.messageResult,setMemberResult:g.setMessageResult}}),U=F.messageResult,V=F.setMemberResult,H=function(){var g=p()(c()().mark(function b(){var h,E;return c()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return h={pageNumber:_-1,pageSize:K,orgUid:Q.uid},O.next=3,(0,C.W5)(h);case 3:E=O.sent,console.log("getAllMessages response:",h,E),E.code===200?V(E):L.yw.error(E.message);case 6:case"end":return O.stop()}},b)}));return function(){return g.apply(this,arguments)}}();return(0,a.useEffect)(function(){H()},[]),(0,a.useEffect)(function(){H()},[_,K]),(0,a.useEffect)(function(){console.log("messageResult:",U),n.current.reload()},[U]),(0,u.jsx)(G.Z,{columns:N,actionRef:n,cardBordered:!0,request:function(){var g=p()(c()().mark(function b(h,E,w){return c()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return console.log("request:",h,E,w),W(h.current),J(h.pageSize),k.abrupt("return",Promise.resolve({data:U.data.content,success:!0,total:U.data.totalElements}));case 4:case"end":return k.stop()}},b)}));return function(b,h,E){return g.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:K,showQuickJumper:!0,onChange:function(b){console.log("page:",b)}},dateFormatter:"string",headerTitle:"\u7EC4\u7EC7\u6D88\u606F",toolBarRender:function(){return[]}})},Z=x,I=l.Z.Header,o=l.Z.Footer,r=l.Z.Sider,v=l.Z.Content,t=[{label:"\u9AD8\u7EA7",key:"top",children:[{label:"column",key:"xinxixitongxiangmuguanlishi"}]},{label:"\u4E2D\u7EA7",key:"middle",children:[{label:"column2",key:"xitongjichengxiangmuguanligongchengshi"}]}],i=function(){var n=(0,y.Z)(),s=n.leftSiderStyle,T=n.contentStyle,_=function(R){console.log("menu click ",R)};return(0,u.jsxs)(l.Z,{children:[(0,u.jsx)(r,{style:s,children:(0,u.jsx)(f.Z,{mode:"inline",onClick:_,defaultSelectedKeys:["xinxixitongxiangmuguanlishi"],defaultOpenKeys:["top","middle"],items:t})}),(0,u.jsx)(l.Z,{children:(0,u.jsx)(v,{style:T,children:(0,u.jsx)(Z,{})})})]})},d=i},69888:function(B,m,e){e.d(m,{G:function(){return S}});var y=e(85615),l=e(73445),f=e(782),a=e(71381),S=(0,l.Ue)()((0,f.mW)((0,f.tJ)((0,a.n)(function(c,P){return{messageResult:{data:{content:[]}},setMessageResult:function(D){c({messageResult:D})},deleteMessageCache:function(){return c({},!0)}}}),{name:y.j8})))}}]);
