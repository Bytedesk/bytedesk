"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8327],{70150:function(L,m,e){e.d(m,{W5:function(){return K}});var y=e(15009),u=e.n(y),f=e(97857),s=e.n(f),S=e(99289),c=e.n(S),C=e(85615),p=e(88541),x=e.n(p),A=e(86745);function K(o){return P.apply(this,arguments)}function P(){return P=c()(u()().mark(function o(r){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,A.request)("/api/v1/message/org",{method:"GET",params:s()({},r)}));case 1:case"end":return n.stop()}},o)})),P.apply(this,arguments)}function z(o){return O.apply(this,arguments)}function O(){return O=_asyncToGenerator(_regeneratorRuntime().mark(function o(r){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/user/robot",{method:"GET",params:{page:r.pageNumber,size:r.pageSize,client:HTTP_CLIENT}}));case 1:case"end":return n.stop()}},o)})),O.apply(this,arguments)}function G(o){return i.apply(this,arguments)}function i(){return i=_asyncToGenerator(_regeneratorRuntime().mark(function o(r){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/message/rest/send",{method:"POST",data:{json:r,client:HTTP_CLIENT}}));case 1:case"end":return n.stop()}},o)})),i.apply(this,arguments)}function w(o,r){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function o(r,v){var n,l;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:console.log("sendMessageSSE: ",r),n="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(r.sid,"&content=").concat(r.content),l=new EventSource(n,{withCredentials:!1}),l.onopen=function(t){console.log("onopen:",t.target)},l.onmessage=function(t){v(t.data);var a=JSON.parse(t.data);if(a.type=="finish"){l&&l.close();return}},l.onerror=function(t){console.log("onerror:",t),alert("server error"),l.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",t),l.close()},l.addEventListener("customEventName",function(t){console.log("Message id is "+t.lastEventId)});case 7:case"end":return M.stop()}},o)})),j.apply(this,arguments)}function N(o,r){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function o(r,v){var n,l,d;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("sendMessageSSEPolyfill: ",r),n=localStorage.ACCESS_TOKEN,l="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(r.sid,"&content=").concat(r.content),d=new EventSourcePolyfill(l,{headers:{Authorization:"Bearer ".concat(n)}}),d.onopen=function(a){console.log("onopen:",a.target)},d.onmessage=function(a){console.log("onmessage:",a.data),v(a.data);var R=JSON.parse(a.data);if(R.type=="finish"){d&&d.close();return}},d.onerror=function(a){console.log("onerror:",a),alert("server error"),d.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",a),d.close()},d.addEventListener("customEventName",function(a){console.log("Message id is "+a.lastEventId)});case 8:case"end":return t.stop()}},o)})),I.apply(this,arguments)}},77154:function(L,m,e){var y=e(39825);function u(){var f=(0,y.Z)(),s=f.isDarkMode,S={borderRight:s?"1px solid #333":"1px solid #ccc",background:s?"#141414":"#f5f5f5",width:260},c={background:s?"#141414":"#fff"},C={borderLeft:s?"1px solid #333":"1px solid #ccc",background:s?"#141414":"#f5f5f5"},p={minHeight:120,background:s?"#141414":"#f5f5f5"};return{leftSiderStyle:S,headerStyle:c,rightSiderStyle:C,contentStyle:p}}m.Z=u},85778:function(L,m,e){e.r(m),e.d(m,{default:function(){return d}});var y=e(77154),u=e(21612),f=e(68508),s=e(67294),S=e(15009),c=e.n(S),C=e(99289),p=e.n(C),x=e(5574),A=e.n(x),K=e(80049),P=e(70150),z=e(69888),O=e(87676),G=e(1269),i=e(85893),w=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u7C7B\u578B",dataIndex:"type",copyable:!0},{title:"\u521B\u5EFA\u65F6\u95F4",key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0},{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(t,a,R,_){return[(0,i.jsx)("a",{onClick:function(){var T;_==null||(T=_.startEditable)===null||T===void 0||T.call(_,a.uid)},children:"\u4FEE\u6539"},"editable")]}}],j=function(){var t=(0,s.useRef)(),a=(0,s.useState)(1),R=A()(a,2),_=R[0],W=R[1],T=(0,s.useState)(10),k=A()(T,2),Z=k[0],J=k[1],Q=(0,O.u)(function(g){return g.orgCurrent}),$=(0,z.G)(function(g){return{messageResult:g.messageResult,setMemberResult:g.setMessageResult}}),U=$.messageResult,V=$.setMemberResult,F=function(){var g=p()(c()().mark(function D(){var h,E;return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return h={pageNumber:_-1,pageSize:Z,orgUid:Q.uid},b.next=3,(0,P.W5)(h);case 3:E=b.sent,console.log("getAllMessages response:",h,E),E.code===200?V(E):K.yw.error(E.message);case 6:case"end":return b.stop()}},D)}));return function(){return g.apply(this,arguments)}}();return(0,s.useEffect)(function(){F()},[]),(0,s.useEffect)(function(){F()},[_,Z]),(0,s.useEffect)(function(){console.log("messageResult:",U),t.current.reload()},[U]),(0,i.jsx)(G.Z,{columns:w,actionRef:t,cardBordered:!0,request:function(){var g=p()(c()().mark(function D(h,E,H){return c()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return console.log("request:",h,E,H),W(h.current),J(h.pageSize),B.abrupt("return",Promise.resolve({data:U.data.content,success:!0,total:U.data.totalElements}));case 4:case"end":return B.stop()}},D)}));return function(D,h,E){return g.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:Z,showQuickJumper:!0,onChange:function(D){console.log("page:",D)}},dateFormatter:"string",headerTitle:"\u7EC4\u7EC7\u6D88\u606F",toolBarRender:function(){return[]}})},N=j,I=u.Z.Header,o=u.Z.Footer,r=u.Z.Sider,v=u.Z.Content,n=[{label:"\u9AD8\u7EA7",key:"top",children:[{label:"column",key:"xinxixitongxiangmuguanlishi"}]},{label:"\u4E2D\u7EA7",key:"middle",children:[{label:"column2",key:"xitongjichengxiangmuguanligongchengshi"}]}],l=function(){var t=(0,y.Z)(),a=t.leftSiderStyle,R=t.contentStyle,_=function(T){console.log("menu click ",T)};return(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(r,{style:a,children:(0,i.jsx)(f.Z,{mode:"inline",onClick:_,defaultSelectedKeys:["xinxixitongxiangmuguanlishi"],defaultOpenKeys:["top","middle"],items:n})}),(0,i.jsx)(u.Z,{children:(0,i.jsx)(v,{style:R,children:(0,i.jsx)(N,{})})})]})},d=l},69888:function(L,m,e){e.d(m,{G:function(){return S}});var y=e(85615),u=e(64529),f=e(782),s=e(71381),S=(0,u.Ue)()((0,f.mW)((0,f.tJ)((0,s.n)(function(c,C){return{messageResult:{data:{content:[]}},setMessageResult:function(x){c({messageResult:x})},deleteMessageCache:function(){return c({},!0)}}}),{name:y.j8})))}}]);
