"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[3340],{60029:function(e,t,n){var r=n(73193),a=n.n(r),o=n(84176),s=n.n(o),l=n(89756),i=n(74145),u=n(74698),c=n(72909),d=(n(79520),n(44194)),f=n(31549),p=["placeholder","defaultValue","value","style","toolbarKeys","onChange","options"];t.Z=function(e){var t=e.placeholder,n=e.defaultValue,r=e.value,o=e.style,g=e.toolbarKeys,y=e.onChange,m=(e.options,s()(e,p)),h=(0,u.useIntl)(),v=(0,i.Z)().isDarkMode,x=(0,d.useRef)(null),w=(0,d.useRef)(null);return(0,d.useEffect)((function(){if(x.current){if(!w.current){var e=new c.cW({element:x.current,theme:v?"dark":"light",placeholder:t,content:n,toolbarKeys:g,image:{uploaderEvent:{onUploadBefore:function(e,t,n){l.yw.warning(h.formatMessage({id:"i18n.under.development",defaultMessage:"Coming Soon"}))}}},video:{uploaderEvent:{onUploadBefore:function(e,t,n){l.yw.warning(h.formatMessage({id:"i18n.under.development",defaultMessage:"Coming Soon"}))}}},attachment:{uploaderEvent:{onUploadBefore:function(e,t,n){l.yw.warning(h.formatMessage({id:"i18n.under.development",defaultMessage:"Coming Soon"}))}}},onChange:function(e){"function"==typeof y&&y(e.getHtml(),e.getMarkdown())}});w.current=e}return function(){w.current&&(w.current.destroy(),w.current=null)}}}),[]),(0,d.useEffect)((function(){w.current&&r!==w.current.getHtml()&&w.current.setContent(r||"")}),[r]),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("div",a()(a()({ref:x},m),{},{style:a()({height:"100%"},o)}))})}},47227:function(e,t,n){n.d(t,{Z:function(){return S}});var r=n(90819),a=n.n(r),o=n(89933),s=n.n(o),l=n(45332),i=n.n(l),u=n(67444),c=n(62076),d=n(12383),f=n(73702),p=n(80588),g=n(53436),y=n(56913),m=n(44194),h=n(72272),v=n(40431),x=n(89756),w=n(26305),b=n(1780),k=n(74698),j=n(57024),M=n(77667),C=n(31549),S=function(e){var t=e.type,n=(0,k.useIntl)(),r=(0,m.useState)(!0),o=i()(r,2),l=o[0],S=o[1],Z=(0,v.u)((function(e){return e.currentOrg})),T=(0,j.j)((function(e){return e.currentKbase})),U=(0,m.useState)(!1),D=i()(U,2),E=D[0],_=D[1],P=(0,w.v)((function(e){return{categoryTreeOptions:e.categoryTreeOptions,setCategoryResult:e.setCategoryResult,currentCategory:e.currentCategory,setCurrentCategoryUid:e.setCurrentCategoryUid}})),A=P.categoryTreeOptions,F=P.setCategoryResult,O=P.currentCategory,K=P.setCurrentCategoryUid,R=(0,b.Z)(),q=R.translateString,I=R.translateStringTranct,N=c.Z.useModal(),Y=i()(N,2),L=Y[0],V=Y[1],z=function(){var e=s()(a()().mark((function e(t){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleSubmit: ",t),l?x.yw.loading(n.formatMessage({id:"updating"})):x.yw.loading(n.formatMessage({id:"creating"})),!l){e.next=8;break}return e.next=5,(0,h.yr)(t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,(0,h.k4)(t);case 10:e.t0=e.sent;case 11:r=e.t0,console.log("createCategory response: ",r),200===r.code?(x.yw.destroy(),l?x.yw.success(n.formatMessage({id:"update.success"})):x.yw.success(n.formatMessage({id:"create.success"})),_(!1),B()):(x.yw.destroy(),x.yw.error(r.message));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=s()(a()().mark((function e(){var r,o;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getCategories"),x.yw.success(n.formatMessage({id:"loading"})),r={pageNumber:0,pageSize:50,type:t,orgUid:null==Z?void 0:Z.uid},t!==M.hcJ&&(r.kbUid=null==T?void 0:T.uid),e.next=6,(0,h.XS)(r);case 6:o=e.sent,console.log("queryCategories response: ",o),200===o.code?(F(o),x.yw.destroy()):(x.yw.destroy(),x.yw.error(o.message));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=s()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleEditCategory: ",O),S(!0),_(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteCategory: ",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,m.useEffect)((function(){t!==M.hcJ&&B()}),[T]),(0,m.useEffect)((function(){t===M.hcJ&&B()}),[]);return(0,C.jsxs)("div",{children:[(0,C.jsxs)(d.Z,{gap:"small",wrap:"wrap",style:{marginBottom:5},children:[(0,C.jsx)(f.ZP,{type:"primary",size:"small",onClick:function(){S(!1),_(!0)},children:n.formatMessage({id:"create"})}),(0,C.jsx)(f.ZP,{size:"small",onClick:B,children:"刷新"}),""!==(null==O?void 0:O.uid)&&"all"!==(null==O?void 0:O.uid)&&(0,C.jsx)(f.ZP,{size:"small",onClick:Q,children:n.formatMessage({id:"edit"})}),""!==(null==O?void 0:O.uid)&&"all"!==(null==O?void 0:O.uid)&&(0,C.jsx)(f.ZP,{onClick:function(){return function(e){L.confirm({title:n.formatMessage({id:"deleteTip"}),icon:(0,C.jsx)(u.Z,{}),content:"".concat(n.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(q(e.name),"】？"),onOk:function(){H(e)},onCancel:function(){},okText:n.formatMessage({id:"ok"}),cancelText:n.formatMessage({id:"cancel"})})}(O)},size:"small",style:{float:"right"},danger:!0,children:n.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,C.jsx)(p.Z,{defaultSelectedKeys:[null==O?void 0:O.uid],onSelect:function(e,t){console.log("selected",e,t),0!==e.length&&K(e[0].toString())},treeData:A,blockNode:!0,titleRender:function(e){return(0,C.jsx)(g.Z,{title:q(e.title),children:I(e.title)})}}),E&&(0,C.jsx)(y.Z,{open:E,type:t,isEdit:l,onCancel:function(){_(!1)},onSubmit:z}),V]})}},36213:function(e,t,n){var r=n(73193),a=n.n(r),o=n(45332),s=n.n(o),l=n(62076),i=n(44194),u=n(60051),c=n(81302),d=n(28977),f=n.n(d),p=n(77667),g=n(89756),y=n(57024),m=n(26305),h=n(33934),v=n(31549),x=c.Z.Dragger;t.Z=function(e){var t=e.type,n=e.acceptType,r=e.isModalOpen,o=e.handleOk,c=e.handleCancel,d=(0,y.j)((function(e){return e.currentKbase})),w=(0,i.useState)((null==d?void 0:d.uid)||""),b=s()(w,2),k=b[0],j=b[1],M=(0,m.v)((function(e){return e.currentCategory})),C=(0,i.useState)("当前支持上传pdf/txt/markdown/docx等"),S=s()(C,2),Z=S[0],T=S[1],U=(0,i.useState)({file:void 0,file_name:"test.pdf",file_type:"application/pdf",is_avatar:"false",kb_type:t,category_uid:"all"===(null==M?void 0:M.uid)?"":(null==M?void 0:M.uid)||"",kb_uid:(null==d?void 0:d.uid)||"",client:p.bVn}),D=s()(U,2),E=D[0],_=D[1],P={name:"file",accept:n,multiple:!0,action:(0,h.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(p.LA8)},data:E,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload before",e,k,d);var n=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;E.file=e,E.file_name=n,E.file_type=e.type,E.kb_type=t,E.kb_uid=k,console.log("beforeUpload after",E)},onChange:function(e){"uploading"===e.file.status&&g.yw.loading("".concat(e.file.name," 上传中")),"done"===e.file.status?(console.log("response: ",e.file.response),200===e.file.response.code?(g.yw.destroy(),g.yw.success("".concat(e.file.name," 上传成功")),o()):(g.yw.destroy(),g.yw.error("".concat(e.file.name," 上传失败")),c())):"error"===e.file.status&&(g.yw.error("".concat(e.file.name," 上传失败")),c())},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}},A=(0,i.useState)(P),F=s()(A,2),O=F[0],K=F[1];return(0,i.useEffect)((function(){y.j.subscribe((function(e,t){var n,r;console.log("useKbaseStore changed:",null==e||null===(n=e.currentKbase)||void 0===n?void 0:n.uid),j(null==e||null===(r=e.currentKbase)||void 0===r?void 0:r.uid),K(P)}))}),[d]),(0,i.useEffect)((function(){t!=p.QPQ&&(K(P),T("当前支持上传excel文件")),_(a()(a()({},E),{},{kb_type:t,category_uid:"all"===(null==M?void 0:M.uid)?"":null==M?void 0:M.uid})),K(P)}),[t,M]),(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(l.Z,{title:"上传文件",open:r,onOk:o,onCancel:c,children:(0,v.jsxs)(x,a()(a()({},O),{},{children:[(0,v.jsx)("p",{className:"ant-upload-drag-icon",children:(0,v.jsx)(u.Z,{})}),(0,v.jsx)("p",{className:"ant-upload-text",children:"点击或拖拽文件至此处实现上传"}),(0,v.jsx)("p",{className:"ant-upload-hint",children:Z})]}))})})}},4500:function(e,t,n){n.r(t),n.d(t,{default:function(){return ce}});var r=n(93139),a=n(6115),o=n(73193),s=n.n(o),l=n(84176),i=n.n(l),u=n(90819),c=n.n(u),d=n(89933),f=n.n(d),p=n(45332),g=n.n(p),y=n(89756),m=n(77667),h=n(74698);function v(e){return x.apply(this,arguments)}function x(){return(x=f()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/keyword/query/org",{method:"GET",params:s()(s()({},t),{},{client:m.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return b.apply(this,arguments)}function b(){return(b=f()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/keyword/create",{method:"POST",data:s()(s()({},t),{},{client:m.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return j.apply(this,arguments)}function j(){return(j=f()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/keyword/update",{method:"POST",data:s()(s()({},t),{},{client:m.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return C.apply(this,arguments)}function C(){return(C=f()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/keyword/delete",{method:"POST",data:s()(s()({},t),{},{client:m.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=n(40431),Z=n(31816),T=n(50648),U=n(47719),D=n(52590),E=n(62009),_=n(90484),P=n(73702),A=n(44194),F=n(26305),O=n(57024),K=n(33934),R=n(60051),q=n(19894),I=n(70827),N=n(39711),Y=n(7441),L=n(93370),V=n(111),z=n(491),B=n(28977),Q=n.n(B),H=n(60029),J=n(74828),W=n(31549),G=function(e){var t=e.isEdit,n=e.keyword,r=e.open,a=e.onClose,o=e.onSubmit,l=q.A.useForm(),i=g()(l,1)[0],u=(0,A.useState)(""),c=g()(u,2),d=c[0],f=c[1],p=(0,S.u)((function(e){return e.currentOrg})),h=(0,O.j)((function(e){return e.currentKbase})),v=(0,F.v)((function(e){return e.categorySelectOptions})),x=(0,A.useState)(),w=g()(x,2),b=w[0],k=w[1],j=(0,A.useState)(m.PYi),M=g()(j,2),C=M[0],Z=M[1],T=(0,A.useState)(".png,.jpg,.jpeg"),U=g()(T,2),D=U[0],E=U[1],_=(0,A.useState)({file:void 0,file_name:"test.pdf",file_type:"application/pdf",is_avatar:"false",kb_type:"type",category_uid:"",kb_uid:(null==h?void 0:h.uid)||"",client:m.bVn}),B=g()(_,2),G=B[0];B[1];(0,A.useEffect)((function(){t?i.setFieldsValue({keyword:null==n?void 0:n.keywordList,reply:null==n?void 0:n.replyList,matchType:null==n?void 0:n.matchType,contentType:null==n?void 0:n.contentType,categoryUid:null==n?void 0:n.categoryUid,kbUid:null==h?void 0:h.uid,enabled:null==n?void 0:n.enabled}):i.resetFields()}),[r]);var $={name:"file",accept:D,action:(0,K.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(m.LA8)},data:G,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var t=Q()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;G.file=e,G.file_name=t,G.file_type=e.type,G.kb_type=m.YjS,G.category_uid=b||"",G.kb_uid=null==h?void 0:h.uid,console.log("beforeUpload",G)},onChange:function(e){if("uploading"===e.file.status&&y.yw.loading("".concat(e.file.name," 上传中")),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data;i.setFieldValue("reply",t),y.yw.destroy(),y.yw.success("".concat(e.file.name," 上传成功"))}else y.yw.destroy(),y.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&y.yw.error("".concat(e.file.name," 上传失败"))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}};return(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(L.Z,{title:t?"修改":"新建",width:650,onClose:a,open:r,extra:(0,W.jsxs)(V.Z,{children:[(0,W.jsx)(P.ZP,{onClick:a,children:"取消"}),(0,W.jsx)(P.ZP,{onClick:function(){console.log("handleSubmit"),i.validateFields().then((function(e){console.log(e),o(s()(s()(s()({},n),e),{},{keywordList:[e.keyword],replyList:[d],kbUid:null==h?void 0:h.uid,orgUid:null==p?void 0:p.uid}))})).catch((function(e){console.log("Form errors:",e),y.yw.error("请检查表单填写")}))},type:"primary",children:"保存"})]}),children:(0,W.jsxs)(q.A,{form:i,submitter:{render:function(){return null}},children:[(0,W.jsx)(I.Z,{label:"匹配类型",name:"matchType",rules:[{required:!0,message:"请选择匹配类型"}],options:[{label:"模糊匹配",value:m.lEl},{label:"精确匹配",value:m.TAc,disabled:!0},{label:"正则匹配",value:m.c7i,disabled:!0},{label:"向量匹配",value:m.sOn,disabled:!0},{label:"搜索引擎匹配",value:m.NDq,disabled:!0}],fieldProps:{allowClear:!0,placeholder:"请选择匹配类型"}}),(0,W.jsx)(I.Z,{label:"内容分类",name:"categoryUid",rules:[{required:!0,message:"请选择分类"}],options:v,tooltip:"请先：创建分类",fieldProps:{allowClear:!0,placeholder:"请选择分类",onChange:function(e){console.log("category selected ".concat(e)),k(e)}}}),(0,W.jsx)(I.Z,{label:"类型",name:"contentType",rules:[{required:!0,message:"请选择类型"}],options:[{label:"文本",value:m.PYi},{label:"图片",value:m.Qm},{label:"视频",value:m.tVi},{label:"音频",value:m.Yu1},{label:"文件",value:m.Qn}],fieldProps:{allowClear:!0,placeholder:"请选择类型",onChange:function(e){console.log("type selected ".concat(e)),Z(e),e===m.Qm?E(".png,.jpg,.jpeg,.gif,.bmp"):e===m.tVi?E(".mp4,.avi,.mov,.wmv"):e===m.Yu1?E(".mp3,.wav,.flac"):e===m.Qn&&E(".doc,.xls,.ppt,.pdf,.docx,.txt,.csv,.xlsx,.rtf,.zip,.7z,.tar,.gz,.rar,.iso")}}}),(0,W.jsx)(N.Z,{label:"关键词",name:"keyword",tooltip:"多个关键词使用 '|' 分割",placeholder:"请输入关键词，多个关键词使用 '|' 分割",rules:[{required:!0,message:"请输入关键词，多个关键词使用 '|' 分割 "}]}),(0,W.jsx)(q.A.Item,{name:"reply",label:"回复",rules:[{required:!0,message:"请输入回复"}],children:(0,W.jsx)(H.Z,{placeholder:"reply content..",value:d,toolbarKeys:(0,J.eD)(),style:{height:"200px",width:"600px"},onChange:function(e,t){f(e)}})}),(0,W.jsx)(Y.Z,{label:"启用",name:"enabled",fieldProps:{defaultValue:!0}}),C!=m.PYi&&(0,W.jsxs)(z.Z,s()(s()({},$),{},{children:[(0,W.jsx)("p",{className:"ant-upload-drag-icon",children:(0,W.jsx)(R.Z,{})}),(0,W.jsx)("p",{className:"ant-upload-text",children:"点击或拖拽上传文件"})]}))]})})})},$=n(59774),X=n(11400),ee=n(1780),te=n(47983),ne=n(74145),re=function(e){var t=e.type,n=e.open,r=e.onClose,a=(0,ne.Z)().isDarkMode,o=(0,ee.Z)().translateString,s=(0,A.useRef)(),l=(0,O.j)((function(e){return e.currentKbase}));(0,A.useEffect)((function(){var e;null===(e=s.current)||void 0===e||e.clearMessage()}),[l]);var i=function(){var e=f()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleChatKeyword");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=f()(c()().mark((function e(t){var n,r,a,o,s,i;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleChatStream"),n=t[t.length-1],e.next=4,fetch("http://127.0.0.1:1001/visitor/api/v1/ai/ollama/chat/stream",{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify({query:null==n?void 0:n.content,kbUid:null==l?void 0:l.uid,stream:!0})});case 4:if((r=e.sent).ok&&r.body){e.next=7;break}throw new Error("HTTP error! status: ".concat(r.status));case 7:return a=r.body.getReader(),o=new TextDecoder("utf-8"),s=new TextEncoder,i=new ReadableStream({start:function(e){return f()(c()().mark((function t(){var n;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=function(){a.read().then((function(t){var r=t.done,a=t.value;if(r)e.close();else{var l=o.decode(a,{stream:!0}).replaceAll("data:","").replaceAll("\n","");e.enqueue(s.encode(l)),n()}})).catch((function(t){console.error("读取流中的数据时发生错误",t),e.error(t)}))})();case 2:case"end":return t.stop()}}),t)})))()}}),e.abrupt("return",new Response(i));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,W.jsx)("div",{children:(0,W.jsx)(L.Z,{title:o(null==l?void 0:l.name),onClose:function(){r&&r()},open:n,styles:{body:{padding:0}},children:(0,W.jsx)(X.f6,{appearance:a?"dark":"light",theme:{algorithm:a?te.Z.darkAlgorithm:te.Z.defaultAlgorithm},children:(0,W.jsx)($.j,{chatRef:s,helloMessage:"请输入你想问的问题",request:function(){var e=f()(c()().mark((function e(n){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("messages:",n),!(n.length>0)){e.next=8;break}if(t!==m.QPQ){e.next=6;break}return e.abrupt("return",u(n));case 6:if(t!==m.jNC){e.next=8;break}return e.abrupt("return",i(n));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})})})})},ae=n(36213),oe=["current"],se=function(){var e=(0,h.useIntl)(),t=(0,A.useRef)(),n=(0,A.useState)(!0),r=g()(n,2),a=r[0],o=r[1],l=(0,A.useState)(),u=g()(l,2),d=u[0],p=u[1],x=(0,A.useState)(!1),b=g()(x,2),j=b[0],C=b[1],R=(0,S.u)((function(e){return e.currentOrg})),q=(0,O.j)((function(e){return e.currentKbase})),I=(0,F.v)((function(e){return e.currentCategory})),N=(0,A.useState)(!1),Y=g()(N,2),L=Y[0],V=Y[1],z=(0,A.useState)(!1),B=g()(z,2),Q=B[0],H=B[1],J=function(){var n=f()(c()().mark((function n(r){var a;return c()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(r),n.next=3,M(r);case 3:a=n.sent,console.log("delete response:",a),200===a.code?(null==t||t.current.reload(),y.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete Success"}))):y.yw.error(e.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),$=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,W.jsx)(h.FormattedMessage,{id:"keyword",defaultMessage:"Keyword"}),dataIndex:"keywordList",copyable:!0},{title:(0,W.jsx)(h.FormattedMessage,{id:"reply",defaultMessage:"Reply"}),dataIndex:"replyList",copyable:!0},{title:(0,W.jsx)(h.FormattedMessage,{id:"matchType",defaultMessage:"MatchType"}),dataIndex:"matchType",width:80,render:function(t,n){return e.formatMessage({id:null==n?void 0:n.matchType,defaultMessage:null==n?void 0:n.matchType})}},{title:(0,W.jsx)(h.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"contentType",hideInSearch:!0,width:50,render:function(t,n){return(0,W.jsx)(W.Fragment,{children:e.formatMessage({id:null==n?void 0:n.contentType,defaultMessage:null==n?void 0:n.contentType})})}},{title:(0,W.jsx)(h.FormattedMessage,{id:"enabled",defaultMessage:"Enabled"}),dataIndex:"enabled",width:80,render:function(t,n){return(0,W.jsx)(W.Fragment,{children:null!=n&&n.enabled?e.formatMessage({id:"yes",defaultMessage:"Yes"}):e.formatMessage({id:"no",defaultMessage:"No"})})}},{title:(0,W.jsx)(h.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180},{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,render:function(t,n,r,a){return[(0,W.jsx)("a",{onClick:function(){ee(n)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,W.jsx)(_.Z,{title:e.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==n?void 0:n.keywordList,"】？"),onConfirm:function(){return J(n)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"}),children:(0,W.jsx)(P.ZP,{size:"small",type:"link",danger:!0,children:e.formatMessage({id:"delete",defaultMessage:"Delete"})})},"delete")]}}],X=function(){p(void 0),o(!1),C(!0)},ee=function(e){p(e),o(!0),C(!0)},te=function(){var n=f()(c()().mark((function n(r){var o,s;return c()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("handleSubmitDrawer",r),a?y.yw.loading(e.formatMessage({id:"updating"})):y.yw.loading(e.formatMessage({id:"creating"})),!a){n.next=8;break}return n.next=5,k(r);case 5:n.t0=n.sent,n.next=11;break;case 8:return n.next=10,w(r);case 10:n.t0=n.sent;case 11:o=n.t0,console.log("createKeyword response:",r,o),200===o.code?(y.yw.destroy(),y.yw.success(e.formatMessage({id:"create.success",defaultMessage:"create success"})),C(!1),null===(s=t.current)||void 0===s||s.reloadAndRest()):(y.yw.destroy(),y.yw.error(o.message));case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),ne=function(){var e=f()(c()().mark((function e(){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=f()(c()().mark((function e(){var t;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=localStorage.getItem(m.LA8),window.open((0,K.kG)()+"/api/v1/keyword/export?categoryUid="+(null==I?void 0:I.uid)+"&kbUid="+(null==q?void 0:q.uid)+"&orgUid="+(null==R?void 0:R.uid)+"&pageNumber=0&pageSize=20&accessToken="+t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.reloadAndRest()}),[q,I]);var le=(0,A.useMemo)((function(){return(null==q?void 0:q.type)!==m.jNC||""===(null==q?void 0:q.uid)}),[q]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(E.Z,{columns:$,actionRef:t,cardBordered:!0,request:function(){var t=f()(c()().mark((function t(n,r,a){var o,l,u;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",n,r,a),y.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),n.current,o=i()(n,oe),l=s()({pageNumber:n.current-1,categoryUid:"all"===I.uid?"":I.uid,kbUid:null==q?void 0:q.uid,orgUid:null==R?void 0:R.uid},o),t.next=6,v(l);case 6:return u=t.sent,console.log("getAllKeywords response:",l,u),y.yw.destroy(),200===u.code||y.yw.error(u.message),t.abrupt("return",{data:u.data.content,success:!0,total:u.data.totalElements});case 11:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"menu.knowledge.keyword",defaultMessage:"KEYWORD"}),toolBarRender:function(){return[(0,W.jsx)(P.ZP,{icon:(0,W.jsx)(Z.Z,{}),type:"primary",onClick:X,disabled:le,children:e.formatMessage({id:"create",defaultMessage:"Create"})},"create"),(0,W.jsx)(P.ZP,{icon:(0,W.jsx)(T.Z,{}),type:"primary",onClick:ne,disabled:le,children:e.formatMessage({id:"import",defaultMessage:"Import"})},"import"),(0,W.jsx)(P.ZP,{icon:(0,W.jsx)(U.Z,{}),type:"primary",onClick:se,disabled:le,children:e.formatMessage({id:"export",defaultMessage:"Export"})},"export"),(0,W.jsx)(P.ZP,{icon:(0,W.jsx)(D.Z,{}),type:"link",onClick:function(){window.open("https://www.weiyuai.cn/download/excel/kbase_keyword.xlsx")},children:e.formatMessage({id:"download.template",defaultMessage:"Download Template"})},"download")]}}),j&&(0,W.jsx)(G,{isEdit:a,open:j,keyword:d,onClose:function(){return C(!1)},onSubmit:te}),Q&&(0,W.jsx)(ae.Z,{type:m.jNC,acceptType:".xls,.xlsx,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",isModalOpen:Q,handleOk:function(){console.log("handleUploadDragSubmit"),H(!1),null==t||t.current.reload()},handleCancel:function(){console.log("handleUploadDragCancel"),H(!1),null==t||t.current.reload()}}),L&&(0,W.jsx)(re,{type:m.jNC,open:L,onClose:function(){return V(!1)}})]})},le=n(47227),ie=a.Z.Sider,ue=a.Z.Content,ce=function(){var e=(0,r.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,W.jsx)("div",{children:(0,W.jsxs)(a.Z,{children:[(0,W.jsx)(ie,{style:t,children:(0,W.jsx)(le.Z,{type:m.jNC})}),(0,W.jsx)(a.Z,{children:(0,W.jsx)(ue,{style:n,children:(0,W.jsx)(se,{})})})]})})}}}]);