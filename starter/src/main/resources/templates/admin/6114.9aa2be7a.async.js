"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6114],{60029:function(e,n,t){var r=t(73193),o=t.n(r),a=t(84176),s=t.n(a),i=t(89756),l=t(74145),u=t(82045),c=t(72909),d=(t(79520),t(44194)),f=t(31549),g=["placeholder","defaultValue","value","style","toolbarKeys","onChange","options"];n.Z=function(e){var n=e.placeholder,t=e.defaultValue,r=e.value,a=e.style,p=e.toolbarKeys,y=e.onChange,m=(e.options,s()(e,g)),v=(0,u.useIntl)(),h=(0,l.Z)().isDarkMode,w=(0,d.useRef)(null),C=(0,d.useRef)(null);return(0,d.useEffect)((function(){if(w.current){if(!C.current){var e=new c.cW({element:w.current,theme:h?"dark":"light",placeholder:n,content:t,toolbarKeys:p,image:{uploaderEvent:{onUploadBefore:function(e,n,t){i.yw.warning(v.formatMessage({id:"i18n.under.development",defaultMessage:"Coming Soon"}))}}},video:{uploaderEvent:{onUploadBefore:function(e,n,t){i.yw.warning(v.formatMessage({id:"i18n.under.development",defaultMessage:"Coming Soon"}))}}},attachment:{uploaderEvent:{onUploadBefore:function(e,n,t){i.yw.warning(v.formatMessage({id:"i18n.under.development",defaultMessage:"Coming Soon"}))}}},onChange:function(e){"function"==typeof y&&y(e.getHtml(),e.getMarkdown())}});C.current=e}return function(){C.current&&(C.current.destroy(),C.current=null)}}}),[]),(0,d.useEffect)((function(){C.current&&r!==C.current.getHtml()&&C.current.setContent(r||"")}),[r]),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("div",o()(o()({ref:w},m),{},{style:o()({height:"100%"},a)}))})}},47227:function(e,n,t){t.d(n,{Z:function(){return j}});var r=t(90819),o=t.n(r),a=t(89933),s=t.n(a),i=t(45332),l=t.n(i),u=t(50484),c=t(83730),d=t(80093),f=t(12265),g=t(38227),p=t(40751),y=t(56913),m=t(44194),v=t(72272),h=t(40431),w=t(89756),C=t(26305),x=t(1780),b=t(82045),k=t(57024),M=t(31549),j=function(e){var n=e.type,t=(0,b.useIntl)(),r=(0,m.useState)(!0),a=l()(r,2),i=a[0],j=a[1],S=(0,h.u)((function(e){return e.currentOrg})),Z=(0,k.j)((function(e){return e.currentKbase})),_=(0,m.useState)(!1),U=l()(_,2),D=U[0],E=U[1],K=(0,C.v)((function(e){return{categoryTreeOptions:e.categoryTreeOptions,setCategoryResult:e.setCategoryResult,currentCategory:e.currentCategory,setCurrentCategoryUid:e.setCurrentCategoryUid}})),T=K.categoryTreeOptions,O=K.setCategoryResult,R=K.currentCategory,z=K.setCurrentCategoryUid,B=(0,x.Z)(),N=B.translateString,H=B.translateStringTranct,P=c.Z.useModal(),Y=l()(P,2),A=Y[0],I=Y[1],V=function(){var e=s()(o()().mark((function e(n){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleSubmit: ",n),i?w.yw.loading(t.formatMessage({id:"updating"})):w.yw.loading(t.formatMessage({id:"creating"})),!i){e.next=8;break}return e.next=5,(0,v.yr)(n);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,(0,v.k4)(n);case 10:e.t0=e.sent;case 11:r=e.t0,console.log("createCategory response: ",r),200===r.code?(w.yw.destroy(),i?w.yw.success(t.formatMessage({id:"update.success"})):w.yw.success(t.formatMessage({id:"create.success"})),E(!1),F()):(w.yw.destroy(),w.yw.error(r.message));case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),F=function(){var e=s()(o()().mark((function e(){var r,a;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getCategories"),w.yw.success(t.formatMessage({id:"loading"})),r={pageNumber:0,pageSize:50,type:n,kbUid:null==Z?void 0:Z.uid,orgUid:null==S?void 0:S.uid},e.next=5,(0,v.XS)(r);case 5:a=e.sent,console.log("queryCategories response: ",a),200===a.code?(O(a),w.yw.destroy()):(w.yw.destroy(),w.yw.error(a.message));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=s()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleEditCategory: ",R),j(!0),E(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=s()(o()().mark((function e(n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteCategory: ",n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();(0,m.useEffect)((function(){F()}),[Z]);return(0,M.jsxs)("div",{children:[(0,M.jsxs)(d.Z,{gap:"small",wrap:"wrap",style:{marginBottom:5},children:[(0,M.jsx)(f.ZP,{type:"primary",size:"small",onClick:function(){j(!1),E(!0)},disabled:(null==Z?void 0:Z.type)!=n,children:t.formatMessage({id:"create"})}),""!==(null==R?void 0:R.uid)&&"all"!==(null==R?void 0:R.uid)&&(0,M.jsx)(f.ZP,{size:"small",onClick:L,children:t.formatMessage({id:"edit"})}),""!==(null==R?void 0:R.uid)&&"all"!==(null==R?void 0:R.uid)&&(0,M.jsx)(f.ZP,{onClick:function(){return function(e){A.confirm({title:t.formatMessage({id:"deleteTip"}),icon:(0,M.jsx)(u.Z,{}),content:"".concat(t.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(N(e.name),"】？"),onOk:function(){Q(e)},onCancel:function(){},okText:t.formatMessage({id:"ok"}),cancelText:t.formatMessage({id:"cancel"})})}(R)},size:"small",style:{float:"right"},danger:!0,children:t.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,M.jsx)(g.Z,{defaultSelectedKeys:[null==R?void 0:R.uid],onSelect:function(e,n){console.log("selected",e,n),0!==e.length&&z(e[0].toString())},treeData:T,blockNode:!0,titleRender:function(e){return(0,M.jsx)(p.Z,{title:N(e.title),children:H(e.title)})}}),D&&(0,M.jsx)(y.Z,{open:D,type:n,isEdit:i,onCancel:function(){E(!1)},onSubmit:V}),I]})}},36213:function(e,n,t){var r=t(73193),o=t.n(r),a=t(45332),s=t.n(a),i=t(83730),l=t(44194),u=t(60051),c=t(17433),d=t(28977),f=t.n(d),g=t(77667),p=t(89756),y=t(57024),m=t(26305),v=t(33934),h=t(31549),w=c.Z.Dragger;n.Z=function(e){var n=e.type,t=e.acceptType,r=e.isModalOpen,a=e.handleOk,c=e.handleCancel,d=(0,y.j)((function(e){return e.currentKbase})),C=(0,l.useState)((null==d?void 0:d.uid)||""),x=s()(C,2),b=x[0],k=x[1],M=(0,m.v)((function(e){return e.currentCategory})),j=(0,l.useState)("当前支持上传pdf/txt/markdown/docx等"),S=s()(j,2),Z=S[0],_=S[1],U=(0,l.useState)({file:void 0,file_name:"test.pdf",file_type:"application/pdf",is_avatar:"false",kb_type:n,category_uid:"all"===(null==M?void 0:M.uid)?"":(null==M?void 0:M.uid)||"",kb_uid:(null==d?void 0:d.uid)||"",client:g.bVn}),D=s()(U,2),E=D[0],K=D[1],T={name:"file",accept:t,multiple:!0,action:(0,v.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(g.LA8)},data:E,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload before",e,b,d);var t=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;E.file=e,E.file_name=t,E.file_type=e.type,E.kb_type=n,E.kb_uid=b,console.log("beforeUpload after",E)},onChange:function(e){"uploading"===e.file.status&&p.yw.loading("".concat(e.file.name," 上传中")),"done"===e.file.status?(console.log("response: ",e.file.response),200===e.file.response.code?(p.yw.destroy(),p.yw.success("".concat(e.file.name," 上传成功")),a()):(p.yw.destroy(),p.yw.error("".concat(e.file.name," 上传失败")),c())):"error"===e.file.status&&(p.yw.error("".concat(e.file.name," 上传失败")),c())},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}},O=(0,l.useState)(T),R=s()(O,2),z=R[0],B=R[1];return(0,l.useEffect)((function(){y.j.subscribe((function(e,n){var t,r;console.log("useKbaseStore changed:",null==e||null===(t=e.currentKbase)||void 0===t?void 0:t.uid),k(null==e||null===(r=e.currentKbase)||void 0===r?void 0:r.uid),B(T)}))}),[d]),(0,l.useEffect)((function(){n!=g.QPQ&&(B(T),_("当前支持上传excel文件")),K(o()(o()({},E),{},{kb_type:n,category_uid:"all"===(null==M?void 0:M.uid)?"":null==M?void 0:M.uid})),B(T)}),[n,M]),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(i.Z,{title:"上传文件",open:r,onOk:a,onCancel:c,children:(0,h.jsxs)(w,o()(o()({},z),{},{children:[(0,h.jsx)("p",{className:"ant-upload-drag-icon",children:(0,h.jsx)(u.Z,{})}),(0,h.jsx)("p",{className:"ant-upload-text",children:"点击或拖拽文件至此处实现上传"}),(0,h.jsx)("p",{className:"ant-upload-hint",children:Z})]}))})})}}}]);