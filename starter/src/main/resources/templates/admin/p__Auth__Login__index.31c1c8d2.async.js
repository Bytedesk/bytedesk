"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[368],{19345:function(D,F,a){a.r(F),a.d(F,{default:function(){return ve}});var A=a(15009),o=a.n(A),L=a(97857),p=a.n(L),T=a(99289),M=a.n(T),S=a(5574),x=a.n(S),U=a(98661),N=a(10915),$=a(68262),G=a(24556),r=a(86745),I=a(9361),H=a(48096),J=a(28459),V=a(31418),B=a(67294),Y=a(73935),Q=a(60247),u=a(80049),X=a(63998),b=a(39825),q=a(99702),_=a(87547),z=a(94149),R=a(5966),e=a(85893),ee=function(i){var g=i.loginType,c=I.Z.useToken(),E=c.token,h=(0,r.useIntl)();return(0,e.jsx)(e.Fragment,{children:g==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(_.Z,{})},placeholder:h.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u90AE\u7BB1"}),rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u90AE\u7BB1!"})}]}),(0,e.jsx)(R.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(z.Z,{})},placeholder:h.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]})})},ae=ee,se=a(85615),ne=a(24454),re=a(16434),k=a(45360),te=a(38925),oe=function(i){var g=i.loginType,c=(0,r.useIntl)();return(0,e.jsx)(e.Fragment,{children:g==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(ne.Z,{})},name:"mobile",placeholder:c.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(re.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(z.Z,{})},captchaProps:{size:"large"},placeholder:c.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(h,v){return h?"".concat(v," ").concat(c.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):c.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var E=M()(o()().mark(function h(v){var P,j;return o()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(console.log("mobile:",v),!(v&&v.length===11)){f.next=12;break}return P={mobile:v,type:se.yC},f.next=5,(0,U.Y7)(P);case 5:if(j=f.sent,j.code===200){f.next=9;break}return k.ZP.error(j.message),f.abrupt("return");case 9:k.ZP.success(j.message),f.next=13;break;case 12:k.ZP.error("\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF");case 13:case"end":return f.stop()}},h)}));return function(h){return E.apply(this,arguments)}}()}),(0,e.jsx)(te.Z,{message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.auto.register",defaultMessage:"Mobile will auto register"}),type:"info"})]})})},ie=oe,le=a(10397),ue=function(i){var g=i.loginType;return(0,e.jsx)(e.Fragment,{children:g==="scan"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(le.Z,{style:{margin:"auto"},value:"login"})})})},de=ue,ge=I.Z.defaultAlgorithm,ce=I.Z.darkAlgorithm,fe=function(){var i=(0,G.l)(function(g){var c=g.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:c.borderRadius,":hover":{backgroundColor:c.colorBgTextHover}}});return(0,e.jsx)("div",{className:i,"data-lang":!0,children:r.SelectLang&&(0,e.jsx)(r.SelectLang,{})})},me=function(){var i=(0,r.useIntl)(),g=I.Z.useToken(),c=g.token,E=(0,b.Z)(),h=E.isDarkMode,v=(0,X.t)(function(t){return t.setAccessToken}),P=(0,B.useState)("account"),j=x()(P,2),y=j[0],f=j[1],O=(0,r.useModel)("@@initialState"),Se=O.initialState,Ae=O.loading,Le=O.refresh,pe=O.setInitialState,Me=(0,B.useState)(!1),W=x()(Me,2),ye=W[0],Te=W[1],w=(0,Q.L)(function(t){return t.setUserInfo});(0,B.useEffect)(function(){var t=window.location.href;(t.indexOf("localhost")!==-1||t.indexOf("127.0.0.1")!==-1||t.indexOf("weiyu")!==-1||t.indexOf("kefux")!==-1||t.indexOf("bytedesk")!==-1)&&Te(!0)},[]);var xe=[{key:"account",label:i.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"}),children:(0,e.jsx)(ae,{loginType:y})},{key:"mobile",label:i.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"}),children:(0,e.jsx)(ie,{loginType:y})},{key:"scan",label:i.formatMessage({id:"pages.login.scanLogin.tab",defaultMessage:"\u626B\u7801\u767B\u5F55"}),children:(0,e.jsx)(de,{loginType:y})}],K=function(){var t=M()(o()().mark(function m(l){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:l&&(0,Y.flushSync)(function(){pe(function(Z){return p()(p()({},Z),{},{userInfo:l})})});case 1:case"end":return d.stop()}},m)}));return function(l){return t.apply(this,arguments)}}(),je=function(){var t=M()(o()().mark(function m(l){var n,d;return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,console.log("handleSubmit values: ",l),u.yw.loading("\u6B63\u5728\u767B\u5F55..."),s.next=5,(0,U.x4)(p()({},l));case 5:n=s.sent,console.log("LoginResult:",n),n.code===200?(u.yw.destroy(),u.yw.success("\u767B\u5F55\u6210\u529F\uFF01"),v(n.data.access_token),K(n.data.user),w(n.data.user),r.history.push("/")):(u.yw.destroy(),u.yw.error(n.message)),s.next=15;break;case 10:s.prev=10,s.t0=s.catch(0),d=i.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(s.t0),u.yw.error(d);case 15:case"end":return s.stop()}},m,null,[[0,10]])}));return function(l){return t.apply(this,arguments)}}(),Fe=function(){var t=M()(o()().mark(function m(l){var n,d;return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,console.log("handleMobileSubmit values: ",l),u.yw.loading("\u6B63\u5728\u767B\u5F55..."),s.next=5,(0,U.N9)(p()({},l));case 5:n=s.sent,console.log("LoginMobileResult:",n),n.code===200?(u.yw.destroy(),u.yw.success("\u767B\u5F55\u6210\u529F\uFF01"),v(n.data.access_token),K(n.data.user),w(n.data.user),r.history.push("/")):(u.yw.destroy(),u.yw.error(n.message)),s.next=15;break;case 10:s.prev=10,s.t0=s.catch(0),d=i.formatMessage({id:y==="account"?"pages.login.failure":"pages.login.failureCode",defaultMessage:y==="account"?"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7528\u6237\u540D\u5BC6\u7801\uFF01":"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),console.log(s.t0),u.yw.error(d);case 15:case"end":return s.stop()}},m,null,[[0,10]])}));return function(l){return t.apply(this,arguments)}}();return(0,e.jsxs)(N._Y,{hashed:!1,dark:h,children:[(0,e.jsx)(fe,{}),(0,e.jsx)("div",{style:{backgroundColor:c.colorBgContainer,textAlign:"center",height:"100vh",backgroundImage:"url('/admin/assets/images/bg-wide.png')"},children:(0,e.jsxs)($.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,e.jsx)("img",{alt:"logo",src:"/admin/icons/logo.png"}),title:(0,e.jsx)(r.FormattedMessage,{id:"app.title"}),subTitle:i.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{},actions:[],onFinish:function(){var t=M()(o()().mark(function m(l){var n,d;return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(y!=="account"){s.next=7;break}return n={username:l.username,password:l.password},console.log("login info:",n),s.next=5,je(n);case 5:s.next=11;break;case 7:return d={mobile:l.mobile,code:l.code},console.log("login mobile info:",d),s.next=11,Fe(d);case 11:case"end":return s.stop()}},m)}));return function(m){return t.apply(this,arguments)}}(),children:[(0,e.jsx)(H.Z,{activeKey:y,onChange:f,centered:!0,items:xe}),(0,e.jsx)("div",{style:{marginTop:14,marginBottom:14},children:(0,e.jsx)("div",{style:{float:"right",marginBottom:24},children:ye&&(0,e.jsx)(r.Link,{to:"/auth/register",children:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.registerAccount",defaultMessage:"\u6CE8\u518C "})})})})]})}),(0,e.jsx)(q.Z,{})]})},he=function(){var i=(0,b.Z)(),g=i.isDarkMode;return(0,e.jsx)(J.ZP,{theme:{algorithm:g?ce:ge},children:(0,e.jsxs)(V.Z,{children:[(0,e.jsx)(u.ZP,{}),(0,e.jsx)(me,{})]})})},ve=he},63998:function(D,F,a){a.d(F,{t:function(){return p}});var A=a(64529),o=a(782),L=a(71381),p=(0,A.Ue)()((0,o.mW)((0,o.tJ)((0,L.n)(function(T,M){return{accessToken:"",setAccessToken:function(x){localStorage.setItem("ACCESS_TOKEN",x),T({accessToken:x})},getAccessToken:function(){return M().accessToken},removeAccessToken:function(){localStorage.removeItem("ACCESS_TOKEN"),T({accessToken:""})}}}),{name:"AUTH_STORE"})))},60247:function(D,F,a){a.d(F,{L:function(){return p}});var A=a(64529),o=a(782),L=a(71381),p=(0,A.Ue)()((0,o.mW)((0,o.tJ)((0,L.n)(function(T,M){return{userInfo:{uid:""},setUserInfo:function(x){T({userInfo:x})},deleteUserInfo:function(){return T({},!0)}}}),{name:"USER_STORE"})))}}]);
