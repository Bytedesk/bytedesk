"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4167,1625],{11090:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),o=n(44194),a={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},s=n(54183),i=function(e,t){return o.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var l=o.forwardRef(i)},30617:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),o=n(44194),a={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"},s=n(54183),i=function(e,t){return o.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var l=o.forwardRef(i)},42085:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),o=n(44194),a={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},s=n(54183),i=function(e,t){return o.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var l=o.forwardRef(i)},32350:function(e,t,n){var r=n(17082),o=n(51190),a=n(44194),s=n(63554),i=n(31549),l=["fieldProps","proFieldProps"],c=function(e,t){var n=e.fieldProps,a=e.proFieldProps,c=(0,o.Z)(e,l);return(0,i.jsx)(s.Z,(0,r.Z)({ref:t,valueType:"textarea",fieldProps:n,proFieldProps:a},c))};t.Z=a.forwardRef(c)},99885:function(e,t,n){n.d(t,{Yg:function(){return v},kh:function(){return p},pf:function(){return d},y:function(){return m}});var r=n(90819),o=n.n(r),a=n(73193),s=n.n(a),i=n(89933),l=n.n(i),c=n(55735),u=n(30921);function d(e){return f.apply(this,arguments)}function f(){return(f=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/faq/query/org",{method:"GET",params:s()(s()({},t),{},{client:c.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/faq/create",{method:"POST",data:s()(s()({},t),{},{client:c.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/faq/update",{method:"POST",data:s()(s()({},t),{},{client:c.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return y.apply(this,arguments)}function y(){return(y=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/faq/delete",{method:"POST",data:s()(s()({},t),{},{client:c.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},51990:function(e,t,n){var r=n(73193),o=n.n(r),a=n(84176),s=n.n(a),i=n(86803),l=n(23864),c=n(44521),u=n(55735),d=n(30921),f=n(83905),p=(n(26286),n(28977)),g=n.n(p),m=n(44194),h=n(31549),v=["placeholder","defaultValue","value","style","toolbarKeys","onChange","options"];t.Z=function(e){var t=e.placeholder,n=e.defaultValue,r=e.value,a=e.style,p=e.toolbarKeys,y=e.onChange,x=(e.options,s()(e,v)),w=((0,d.useIntl)(),(0,l.Z)().isDarkMode),b=(0,m.useRef)(null),M=(0,m.useRef)(null);return(0,m.useEffect)((function(){if(b.current){if(!M.current){var e=new f.cW({element:b.current,theme:w?"dark":"light",placeholder:t,content:n,toolbarKeys:p,image:{uploadUrl:(0,c.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(u.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var a=g()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,s=new FormData;return s.append("file",e),s.append("file_name",a),s.append("file_type",e.type),s.append("is_avatar","false"),s.append("kb_type",u.bE7),s.append("category_uid",""),s.append("kb_uid",""),s.append("client",u.bVn),new Promise((function(e,r){fetch(t,{method:"POST",headers:o()({Accept:"application/json"},n),body:s}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){i.yw.destroy(),i.yw.success("".concat(a," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,alt:a}};e(n)}else i.yw.destroy(),i.yw.error("".concat(a," 上传失败"))})).catch((function(e){r(e)}))}))}},video:{uploadUrl:(0,c.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(u.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var a=g()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,s=new FormData;return s.append("file",e),s.append("file_name",a),s.append("file_type",e.type),s.append("is_avatar","false"),s.append("kb_type",u.bE7),s.append("category_uid",""),s.append("kb_uid",""),s.append("client",u.bVn),new Promise((function(e,r){fetch(t,{method:"POST",headers:o()({Accept:"application/json"},n),body:s}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){i.yw.destroy(),i.yw.success("".concat(a," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,poster:"https://www.weiyuai.cn/avatars/video_poster.png"}};e(n)}else i.yw.destroy(),i.yw.error("".concat(a," 上传失败"))})).catch((function(e){r(e)}))}))}},attachment:{uploadUrl:(0,c.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(u.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var a=g()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,s=new FormData;return s.append("file",e),s.append("file_name",a),s.append("file_type",e.type),s.append("is_avatar","false"),s.append("kb_type",u.bE7),s.append("category_uid",""),s.append("kb_uid",""),s.append("client",u.bVn),new Promise((function(e,r){fetch(t,{method:"POST",headers:o()({Accept:"application/json"},n),body:s}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){i.yw.destroy(),i.yw.success("".concat(a," 上传成功"));var n={errorCode:0,data:{href:t.data.fileUrl,fileName:a}};e(n)}else i.yw.destroy(),i.yw.error("".concat(a," 上传失败"))})).catch((function(e){r(e)}))}))}},onChange:function(e){"function"==typeof y&&y(e.getHtml(),e.getMarkdown())}});M.current=e}return function(){M.current&&(M.current.destroy(),M.current=null)}}}),[]),(0,m.useEffect)((function(){M.current&&r!==M.current.getHtml()&&M.current.setContent(r||"")}),[r]),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",o()(o()({ref:b},x),{},{style:o()({height:"100%"},a)}))})}},8377:function(e,t,n){n.d(t,{Z:function(){return S}});var r=n(90819),o=n.n(r),a=n(89933),s=n.n(a),i=n(45332),l=n.n(i),c=n(15722),u=n(53530),d=n(27487),f=n(75365),p=n(79777),g=n(88996),m=n(78996),h=n(44194),v=n(32045),y=n(40612),x=n(86803),w=n(90838),b=n(76750),M=n(30921),j=n(6397),k=n(55735),C=n(31549),S=function(e){var t=e.type,n=(0,M.useIntl)(),r=(0,h.useState)(!0),a=l()(r,2),i=a[0],S=a[1],Z=(0,y.u)((function(e){return e.currentOrg})),I=(0,j.j)((function(e){return e.currentKbase})),T=(0,h.useState)(!1),D=l()(T,2),E=D[0],F=D[1],P=(0,w.v)((function(e){return{categoryTreeOptions:e.categoryTreeOptions,setCategoryResult:e.setCategoryResult,currentCategory:e.currentCategory,setCurrentCategoryUid:e.setCurrentCategoryUid}})),O=P.categoryTreeOptions,A=P.setCategoryResult,_=P.currentCategory,U=P.setCurrentCategoryUid,$=(0,b.Z)(),N=$.translateString,H=$.translateStringTranct,Y=u.Z.useModal(),q=l()(Y,2),z=q[0],R=q[1],B=function(){var e=s()(o()().mark((function e(t){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleSubmit: ",t),i?x.yw.loading(n.formatMessage({id:"updating"})):x.yw.loading(n.formatMessage({id:"creating"})),!i){e.next=8;break}return e.next=5,(0,v.yr)(t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,(0,v.k4)(t);case 10:e.t0=e.sent;case 11:r=e.t0,console.log("createCategory response: ",r),200===r.code?(x.yw.destroy(),i?x.yw.success(n.formatMessage({id:"update.success"})):x.yw.success(n.formatMessage({id:"create.success"})),F(!1),V()):(x.yw.destroy(),x.yw.error(r.message));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=s()(o()().mark((function e(){var r,a;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getCategories"),x.yw.success(n.formatMessage({id:"loading"})),r={pageNumber:0,pageSize:50,type:t,orgUid:null==Z?void 0:Z.uid},t!==k.hcJ&&(r.kbUid=null==I?void 0:I.uid),e.next=6,(0,v.XS)(r);case 6:a=e.sent,console.log("queryCategories response: ",a,r),200===a.code?(A(a),x.yw.destroy()):(x.yw.destroy(),x.yw.error(a.message));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=s()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleEditCategory: ",_),S(!0),F(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=s()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteCategory: ",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,h.useEffect)((function(){t!==k.hcJ&&V()}),[I]),(0,h.useEffect)((function(){t===k.hcJ&&V()}),[]);return(0,C.jsxs)("div",{children:[(0,C.jsxs)(d.Z,{gap:"small",wrap:"wrap",style:{margin:5},children:[(0,C.jsx)(f.ZP,{type:"primary",size:"small",onClick:function(){S(!1),F(!0)},children:n.formatMessage({id:"create.category"})}),(0,C.jsx)(f.ZP,{size:"small",onClick:V,children:n.formatMessage({id:"refresh"})}),""!==(null==_?void 0:_.uid)&&"all"!==(null==_?void 0:_.uid)&&(0,C.jsx)(f.ZP,{size:"small",onClick:L,children:n.formatMessage({id:"edit"})}),""!==(null==_?void 0:_.uid)&&"all"!==(null==_?void 0:_.uid)&&(0,C.jsx)(f.ZP,{onClick:function(){return function(e){z.confirm({title:n.formatMessage({id:"deleteTip"}),icon:(0,C.jsx)(c.Z,{}),content:"".concat(n.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(N(e.name),"】？"),onOk:function(){Q(e)},onCancel:function(){},okText:n.formatMessage({id:"ok"}),cancelText:n.formatMessage({id:"cancel"})})}(_)},size:"small",style:{float:"right"},danger:!0,children:n.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,C.jsx)(p.Z,{defaultSelectedKeys:[null==_?void 0:_.uid],onSelect:function(e,t){console.log("selected",e,t),0!==e.length&&U(e[0].toString())},treeData:O,blockNode:!0,titleRender:function(e){return(0,C.jsx)(g.Z,{title:N(e.title),children:H(e.title)})}}),E&&(0,C.jsx)(m.Z,{open:E,type:t,isEdit:i,onCancel:function(){F(!1)},onSubmit:B}),R]})}},17220:function(e,t,n){n(44194);var r=n(75365),o=n(54881),a=n(30921),s=n(31549);t.Z=function(e){var t,n,i=e.file,l=e.onDelete,c=e.showDelete,u=void 0===c||c,d=(0,a.useIntl)();return(0,s.jsxs)("div",{style:{position:"relative",width:"50px",height:"50px",border:"1px solid #f0f0f0",borderRadius:"4px",overflow:"hidden"},title:d.formatMessage({id:null!=i&&null!==(t=i.fileType)&&void 0!==t&&t.startsWith("image/")?"upload.preview.image":"upload.preview.file"}),children:[u&&(0,s.jsx)(r.ZP,{type:"text",size:"small",icon:(0,s.jsx)(o.Z,{}),onClick:function(){return l(i.uid)},style:{position:"absolute",top:0,right:0,padding:"2px",background:"rgba(255, 255, 255, 0.8)",border:"none",borderRadius:"0 4px 0 4px",zIndex:1}}),(0,s.jsx)("div",{onClick:function(){return window.open(i.fileUrl,"_blank")},style:{width:"100%",height:"100%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:null!=i&&null!==(n=i.fileType)&&void 0!==n&&n.startsWith("image/")?(0,s.jsx)("img",{src:null==i?void 0:i.fileUrl,alt:null==i?void 0:i.fileName,style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,s.jsx)("div",{style:{fontSize:"12px",padding:"4px",textAlign:"center",wordBreak:"break-all",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:i.fileName})}),(0,s.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:"rgba(0, 0, 0, 0.5)",color:"#fff",fontSize:"10px",padding:"2px",textAlign:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i.fileName})]},i.uid)}},27650:function(e,t,n){var r=n(76711),o=n.n(r),a=n(73193),s=n.n(a),i=n(45332),l=n.n(i),c=n(44194),u=n(42085),d=n(1962),f=n(53530),p=n(28977),g=n.n(p),m=n(55735),h=n(86803),v=n(44521),y=n(17220),x=n(30921),w=n(6397),b=n(31549),M=d.Z.Dragger;t.Z=function(e){var t=e.type,n=(e.acceptType,e.isModalOpen),r=e.attachments,a=e.handleSubmit,i=e.handleCancel,d=(0,x.useIntl)(),p=(0,w.j)((function(e){return e.currentKbase})),j=(0,c.useState)([]),k=l()(j,2),C=k[0],S=k[1],Z=(0,c.useState)({file:null,file_name:"test.pdf",file_type:"application/pdf",is_avatar:"false",kb_type:t,category_uid:"",kb_uid:null==p?void 0:p.uid,client:m.bVn}),I=l()(Z,2),T=I[0],D=I[1];(0,c.useEffect)((function(){console.log("UploadDrag currentKbase",p),p&&D((function(e){return s()(s()({},e),{},{kb_uid:null==p?void 0:p.uid})}))}),[p]);var E=(0,c.useMemo)((function(){return{name:"file",multiple:!0,action:(0,v.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(m.LA8)},data:T,showUploadList:!1,beforeUpload:function(e){var t=g()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return D((function(n){return s()(s()({},n),{},{file:e,file_name:t,file_type:e.type,category_uid:""})})),!0},onChange:function(e){"uploading"===e.file.status&&h.yw.loading(d.formatMessage({id:"upload.uploading"},{filename:e.file.name})),"done"===e.file.status?200===e.file.response.code?(h.yw.destroy(),h.yw.success(d.formatMessage({id:"upload.success"},{filename:e.file.name})),S((function(t){return[].concat(o()(t),[e.file.response.data])}))):(h.yw.destroy(),h.yw.error(d.formatMessage({id:"upload.failed"},{filename:e.file.name}))):"error"===e.file.status&&h.yw.error(d.formatMessage({id:"upload.failed"},{filename:e.file.name}))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}}}),[T,d]);(0,c.useEffect)((function(){D((function(e){return s()(s()({},e),{},{kb_type:t,category_uid:""})})),r&&S(r.map((function(e){return e.upload})))}),[t]);var F=function(e){console.log("handleDelete",e),S((function(t){return t.filter((function(t){return t.uid!==e}))}))};return(0,b.jsxs)(f.Z,{title:d.formatMessage({id:"upload.modal.title"}),open:n,onOk:function(){a(C)},onCancel:i,children:[(0,b.jsxs)(M,s()(s()({},E),{},{children:[(0,b.jsx)("p",{className:"ant-upload-drag-icon",children:(0,b.jsx)(u.Z,{})}),(0,b.jsx)("p",{className:"ant-upload-text",children:d.formatMessage({id:"upload.drag.text"})}),(0,b.jsx)("p",{className:"ant-upload-hint",children:d.formatMessage({id:"upload.drag.hint"})})]})),(0,b.jsx)("div",{style:{marginTop:"16px",maxHeight:"200px",overflowY:"auto"},children:(0,b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px"},children:C.map((function(e){return(0,b.jsx)(y.Z,{file:e,onDelete:F},e.uid)}))})})]})}},66332:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ae}});var r=n(96865),o=n(75574),a=n(55735),s=n(8377),i=n(44194),l=n(8247),c=n(30921),u=n(73193),d=n.n(u),f=n(84176),p=n.n(f),g=n(90819),m=n.n(g),h=n(89933),v=n.n(h),y=n(45332),x=n.n(y),w=n(86803);function b(e){return M.apply(this,arguments)}function M(){return(M=v()(m()().mark((function e(t){return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/file/query/org",{method:"GET",params:d()(d()({},t),{},{client:a.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return k.apply(this,arguments)}function k(){return(k=v()(m()().mark((function e(t){return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/file/delete",{method:"POST",data:d()(d()({},t),{},{client:a.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C=n(76750),S=n(6397),Z=n(40612),I=n(51239),T=n(44521),D=n(73442),E=n(3849),F=n(75365),P=n(80601),O=n(31549),A=function(e){var t=e.type,n=e.open,r=e.onClose,o=(0,C.Z)().translateString,a=(0,S.j)((function(e){return e.currentKbase})),s=(0,I.L)((function(e){return e.userInfo})),l=(0,Z.u)((function(e){return e.currentOrg})),c=(0,i.useState)(""),u=x()(c,2),d=u[0],f=u[1],p=(0,i.useState)(!1),g=x()(p,2),m=g[0],h=g[1],v=function(){console.log("refresh"),h(!1);var e=(0,T.Cn)()+"?org="+encodeURIComponent(null==l?void 0:l.uid)+"&t="+encodeURIComponent(t)+"&sid="+encodeURIComponent(null==a?void 0:a.uid)+"&uid="+encodeURIComponent(null==s?void 0:s.uid)+"&nickname="+encodeURIComponent(null==s?void 0:s.nickname)+"&avatar="+encodeURIComponent(null==s?void 0:s.avatar)+"&navbar=0&"+(new Date).getTime();f(e)};(0,i.useEffect)((function(){v()}),[a]);return(0,O.jsx)(O.Fragment,{children:(0,O.jsxs)(D.Z,{title:o(null==a?void 0:a.name),onClose:function(){r&&r()},open:n,extra:(0,O.jsxs)(E.Z,{children:[(0,O.jsx)(F.ZP,{onClick:function(){window.open(d)},children:"新窗口"}),(0,O.jsx)(F.ZP,{onClick:function(){console.log("restart"),v()},type:"primary",children:"重新开始"})]}),styles:{body:{padding:0}},children:[(0,O.jsx)(P.Z,{spinning:!m,style:{position:"absolute",width:"100%",zIndex:1001},size:"large"}),(0,O.jsx)("iframe",{id:"chat-iframe",src:d,title:"demo",width:"100%",height:"100%",style:{border:0},"data-loaded":"true",onLoad:function(){h(!0),console.log("Iframe loaded successfully!")}})]})})},_=n(90838),U=n(69114),$=n(11757),N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M120 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm0 424h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm784 140H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-424H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"align-left",theme:"outlined"},H=n(54183),Y=function(e,t){return i.createElement(H.Z,(0,$.Z)({},e,{ref:t,icon:N}))};var q=i.forwardRef(Y),z=n(25482),R=n(72381),B=n(61355),V=n(28977),L=n.n(V),Q=n(27650),K=["current"],W=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,O.jsx)(c.FormattedMessage,{id:"fileName",defaultMessage:"fileName"}),dataIndex:"fileName"},{title:(0,O.jsx)(c.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0},{title:(0,O.jsx)(c.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:200,hideInSearch:!0,render:function(e,t,n,r){return L()(t.createdAt).format("YYYY-MM-DD HH:mm:ss")}}],G=function(){var e=(0,c.useIntl)(),t=(0,c.useNavigate)(),n=(0,i.useRef)(),r=(0,Z.u)((function(e){return e.currentOrg})),o=(0,S.j)((function(e){return e.currentKbase})),s=(0,_.v)((function(e){return e.currentCategory})),l=(0,i.useState)(!1),u=x()(l,2),f=u[0],g=u[1],h=(0,i.useState)(!1),y=x()(h,2),M=y[0],k=y[1],C=function(){var t=v()(m()().mark((function t(r){var o;return m()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(r),t.next=3,j(r);case 3:o=t.sent,console.log("delete response:",o),200===o.code?(null==n||n.current.reload(),w.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete Success"}))):w.yw.error(e.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=[].concat(W,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:150,render:function(t,n,r,o){return[(0,O.jsx)("a",{onClick:function(){var e=null==n?void 0:n.fileUrl,t=encodeURIComponent(e);window.open(decodeURIComponent(t))},children:e.formatMessage({id:"open",defaultMessage:"Open"})},"editable"),(0,O.jsx)("a",{onClick:function(){},children:"处理"},"status"),(0,O.jsx)(B.Z,{title:e.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==n?void 0:n.name,"】？"),onConfirm:function(){return C(n)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"}),children:(0,O.jsx)(F.ZP,{size:"small",type:"link",danger:!0,children:e.formatMessage({id:"delete",defaultMessage:"Delete"})})},"delete")]}}]);(0,i.useEffect)((function(){var e;null==n||null===(e=n.current)||void 0===e||e.reload()}),[o,s]),(0,i.useEffect)((function(){return U.Z.on(a.YwV,(function(e){var t;console.log("EVENT_BUS_MQTT_NOTICE",e),null==n||null===(t=n.current)||void 0===t||t.reload()})),function(){U.Z.off(a.YwV)}}),[]);var T=(0,i.useMemo)((function(){return(null==o?void 0:o.type)!==a.QPQ||""===(null==o?void 0:o.uid)}),[o]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(R.Z,{columns:I,actionRef:n,cardBordered:!0,request:function(){var e=v()(m()().mark((function e(t,n,o){var a,s,i;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request:",t,n,o),t.current,a=p()(t,K),s=d()({pageNumber:t.current-1,orgUid:null==r?void 0:r.uid},a),e.next=5,b(s);case 5:return i=e.sent,console.log("queryFilesByOrg response:",i,s),200===i.code||w.yw.error(i.message),e.abrupt("return",{data:i.data.content,success:!0,total:i.data.totalElements});case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"文件拆分列表",toolBarRender:function(){return[(0,O.jsx)(F.ZP,{icon:(0,O.jsx)(q,{}),type:"primary",onClick:function(){console.log("handleProcess"),t("/kb/upload/data")},disabled:T,children:"查看文件上传列表"},"uploadList"),(0,O.jsx)(F.ZP,{icon:(0,O.jsx)(z.Z,{}),type:"primary",onClick:function(){return g(!0)},disabled:T,children:e.formatMessage({id:"upload",defaultMessage:"File"})},"button")]}}),f&&(0,O.jsx)(Q.Z,{type:a.QPQ,acceptType:"*",isModalOpen:f,handleSubmit:function(e){console.log("handleFileDragSubmit",e),g(!1),null==n||n.current.reload()},handleCancel:function(){console.log("handleFileDragCancel"),g(!1),null==n||n.current.reload()}}),M&&(0,O.jsx)(A,{type:a.xtN,open:M,onClose:function(){return k(!1)}})]})};function J(e){return X.apply(this,arguments)}function X(){return(X=v()(m()().mark((function e(t){return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/text/query/org",{method:"GET",params:d()(d()({},t),{},{client:a.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=v()(m()().mark((function e(t){return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/text/create",{method:"POST",data:d()(d()({},t),{},{client:a.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e){return re.apply(this,arguments)}function re(){return(re=v()(m()().mark((function e(t){return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/text/update",{method:"POST",data:d()(d()({},t),{},{client:a.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e){return ae.apply(this,arguments)}function ae(){return(ae=v()(m()().mark((function e(t){return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/text/delete",{method:"POST",data:d()(d()({},t),{},{client:a.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var se=n(15722),ie=n(53530),le=n(69169),ce=n(4499),ue=n(32350),de=function(e){var t=e.isEdit,n=e.text,r=e.open,o=e.onClose,s=e.onSubmit,l=le.A.useForm(),c=x()(l,1)[0],u=(0,Z.u)((function(e){return e.currentOrg}));return(0,i.useEffect)((function(){t?c.setFieldsValue({uid:null==n?void 0:n.uid,name:null==n?void 0:n.name,content:null==n?void 0:n.content}):c.setFieldsValue({name:"",color:"red",type:a.IuT})}),[t,n,c]),(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(D.Z,{title:"标签",onClose:o,open:r,children:(0,O.jsxs)(le.A,{form:c,name:"tagForm",onFinish:function(){console.log("handleSubmit"),c.validateFields().then((function(e){var t=d()(d()({},e),{},{orgUid:null==u?void 0:u.uid});console.log("submit",t),s(t)}))},children:[(0,O.jsx)(ce.Z,{label:"名称",name:"name",rules:[{required:!0}]}),(0,O.jsx)(ue.Z,{label:"内容",name:"content",rules:[{required:!0}]})]})})})},fe=["current"],pe=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,O.jsx)(c.FormattedMessage,{id:"name",defaultMessage:"Name"}),dataIndex:"name",copyable:!0,render:function(e,t){return(0,O.jsx)(O.Fragment,{children:t.name})}},{title:(0,O.jsx)(c.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"content",hideInSearch:!0,render:function(e,t){return(0,O.jsx)(O.Fragment,{children:t.content})}},{title:(0,O.jsx)(c.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t,n,r){return L()(t.createdAt).format("YYYY-MM-DD HH:mm:ss")}}],ge=function(){var e=(0,c.useIntl)(),t=(0,i.useRef)(),n=(0,Z.u)((function(e){return e.currentOrg})),r=(0,i.useState)(!1),o=x()(r,2),a=o[0],s=o[1],l=(0,i.useState)({}),u=x()(l,2),f=u[0],g=u[1],h=(0,i.useState)(!1),y=x()(h,2),b=y[0],M=y[1],j=ie.Z.useModal(),k=x()(j,2),C=k[0],S=k[1],I=[].concat(pe,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:120,render:function(t,n,r,o){return[(0,O.jsx)("a",{onClick:function(){g(n),M(!0),s(!0)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,O.jsx)(F.ZP,{type:"link",onClick:function(){return t=n,void C.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,O.jsx)(se.Z,{}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(t.name,"】？"),onOk:function(){T(t)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})});var t},danger:!0,children:e.formatMessage({id:"delete",defaultMessage:"Delete"})},"delete")]}}]),T=function(){var n=v()(m()().mark((function n(r){var o;return m()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("deleteText:",r),n.next=3,oe(r);case 3:o=n.sent,console.log("deleteMember:",o),200===o.code?(w.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),t.current.reload()):w.yw.error(o.message);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),D=function(){var e=v()(m()().mark((function e(n){var r,o;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(n);case 2:r=e.sent,console.log("handleCreateText response:",r),200===r.code?(null===(o=t.current)||void 0===o||o.reload(),s(!1)):w.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=v()(m()().mark((function e(n){var r,o;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.uid=null==f?void 0:f.uid,e.next=3,ne(n);case 3:r=e.sent,console.log("handleUpdateText response:",r),200===r.code?(null===(o=t.current)||void 0===o||o.reload(),s(!1)):w.yw.error(r.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){s(!0),M(!1),g({})};return(0,O.jsxs)(O.Fragment,{children:[a&&(0,O.jsx)(de,{isEdit:b,open:a,text:f,onClose:function(){s(!1)},onSubmit:function(e){console.log("onDrawerSubmit:",e),b?E(e):D(e)}}),(0,O.jsx)(R.Z,{columns:I,actionRef:t,cardBordered:!0,request:function(){var e=v()(m()().mark((function e(t,r,o){var a,s,i;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.current,a=p()(t,fe),s=d()({pageNumber:t.current-1,orgUid:null==n?void 0:n.uid},a),e.next=4,J(s);case 4:return i=e.sent,console.log("queryTextsByOrg response:",i,s),200===i.code||w.yw.error(i.message),e.abrupt("return",{data:i.data.content,success:!0,total:i.data.totalElements});case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"文本列表",toolBarRender:function(){return[(0,O.jsx)(F.ZP,{type:"primary",icon:(0,O.jsx)(z.Z,{}),onClick:P,children:e.formatMessage({id:"create",defaultMessage:"Create"})})]}}),S]})},me=n(99885),he=n(30617),ve=n(11090),ye=n(61107),xe=n(32943),we=n(38775),be=n(42085),Me=n(84881),je=n(44867),ke=n(51990),Ce=n(65461),Se=function(e){var t=e.isEdit,n=e.faq,r=e.open,o=e.onClose,s=e.onSubmit,l=le.A.useForm(),c=x()(l,1)[0],u=(0,i.useState)(""),f=x()(u,2),p=f[0],g=f[1],m=(0,Z.u)((function(e){return e.currentOrg})),h=(0,S.j)((function(e){return e.currentKbase})),v=(0,_.v)((function(e){return e.categorySelectOptions})),y=(0,i.useState)(),b=x()(y,2),M=b[0],j=b[1],k=(0,i.useState)(a.PYi),C=x()(k,2),I=C[0],P=C[1],A=(0,i.useState)(".png,.jpg,.jpeg"),U=x()(A,2),$=(U[0],U[1]),N=(0,i.useState)({file:void 0,file_name:"test.pdf",file_type:"application/pdf",is_avatar:"false",kb_type:"type",category_uid:"",kb_uid:(null==h?void 0:h.uid)||"",client:a.bVn}),H=x()(N,2),Y=H[0];H[1];(0,i.useEffect)((function(){t?(c.setFieldsValue({type:null==n?void 0:n.type,title:null==n?void 0:n.question,answer:(null==n?void 0:n.answer)||"",categoryUid:null==n?void 0:n.categoryUid,kbUid:null==h?void 0:h.uid}),g((null==n?void 0:n.answer)||""),console.log("faq?.answer",null==n?void 0:n.answer)):c.resetFields()}),[t,r,n]);var q={name:"file",action:(0,T.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(a.LA8)},data:Y,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var t=L()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;Y.file=e,Y.file_name=t,Y.file_type=e.type,Y.kb_type=a.YjS,Y.category_uid=M||"",Y.kb_uid=null==h?void 0:h.uid,console.log("beforeUpload",Y)},onChange:function(e){if("uploading"===e.file.status&&w.yw.loading("".concat(e.file.name," 上传中")),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data.fileUrl;g(t),w.yw.destroy(),w.yw.success("".concat(e.file.name," 上传成功"))}else w.yw.destroy(),w.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&w.yw.error("".concat(e.file.name," 上传失败"))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}};return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(D.Z,{title:t?"修改":"新建",width:650,onClose:o,open:r,extra:(0,O.jsxs)(E.Z,{children:[(0,O.jsx)(F.ZP,{onClick:o,children:"取消"}),(0,O.jsx)(F.ZP,{onClick:function(){console.log("handleSubmit"),c.validateFields().then((function(e){console.log(e),s(d()(d()(d()({},n),e),{},{kbUid:null==h?void 0:h.uid,orgUid:null==m?void 0:m.uid,answer:p}))})).catch((function(e){console.log("Form errors:",e),w.yw.error("请检查表单填写")}))},type:"primary",children:"保存"})]}),children:(0,O.jsxs)(le.A,{form:c,submitter:{render:function(){return null}},children:[(0,O.jsx)(Me.Z,{label:"分类",name:"categoryUid",rules:[{required:!0,message:"请选择分类"}],options:v,fieldProps:{allowClear:!0,placeholder:"请选择分类",onChange:function(e){console.log("category selected ".concat(e)),j(e)}}}),(0,O.jsx)(Me.Z,{label:"类型",name:"type",rules:[{required:!0,message:"请选择类型"}],options:[{label:"文本",value:a.PYi},{label:"图片",value:a.Qm},{label:"视频",value:a.tVi},{label:"音频",value:a.Yu1},{label:"文件",value:a.Qn}],fieldProps:{allowClear:!0,placeholder:"请选择类型",onChange:function(e){console.log("type selected ".concat(e)),P(e),e===a.Qm?$(".png,.jpg,.jpeg,.gif,.bmp"):e===a.tVi?$(".mp4,.avi,.mov,.wmv"):e===a.Yu1?$(".mp3,.wav,.flac"):e===a.Qn&&$(".doc,.xls,.ppt,.pdf,.docx,.txt,.csv,.xlsx,.rtf,.zip,.7z,.tar,.gz,.rar,.iso")}}}),(0,O.jsx)(ce.Z,{label:"标题",name:"title",rules:[{required:!0,message:"请输入标题"}]}),(0,O.jsx)(le.A.Item,{name:"answer",label:"回复",rules:[{required:!0,message:"请输入回复"}],children:(0,O.jsx)(ke.Z,{placeholder:"answer..",value:p,toolbarKeys:(0,Ce.eD)(),style:{height:"200px",width:"600px"},onChange:function(e,t){g(e)}})}),I!=a.PYi&&(0,O.jsxs)(je.Z,d()(d()({},q),{},{children:[(0,O.jsx)("p",{className:"ant-upload-drag-icon",children:(0,O.jsx)(be.Z,{})}),(0,O.jsx)("p",{className:"ant-upload-text",children:"点击或拖拽上传文件"})]}))]})})})},Ze=["current"],Ie=function(){var e=(0,c.useIntl)(),t=(0,C.Z)().translateStringTranct,n=(0,i.useRef)(),r=(0,i.useState)(!0),o=x()(r,2),s=o[0],l=o[1],u=(0,i.useState)(),f=x()(u,2),g=f[0],h=f[1],y=(0,i.useState)(!1),b=x()(y,2),M=b[0],j=b[1],k=(0,Z.u)((function(e){return e.currentOrg})),I=(0,S.j)((function(e){return e.currentKbase})),D=(0,_.v)((function(e){return e.currentCategory})),E=(0,i.useState)(!1),P=x()(E,2),A=P[0],U=P[1],$=function(){var t=v()(m()().mark((function t(r){var o;return m()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(r),t.next=3,(0,me.Yg)(r);case 3:o=t.sent,console.log("delete response:",o),200===o.code?(null==n||n.current.reload(),w.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete Success"}))):w.yw.error(e.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,O.jsx)(c.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"title",copyable:!0,render:function(e,n){return t(null==n?void 0:n.question)}},{title:(0,O.jsx)(c.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"content",render:function(e,n){return t(null==n?void 0:n.answer)}},{title:(0,O.jsx)(c.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInSearch:!0,render:function(t,n){return(0,O.jsx)(O.Fragment,{children:e.formatMessage({id:null==n?void 0:n.type,defaultMessage:null==n?void 0:n.type})})}},{title:(0,O.jsx)(c.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t,n,r){return L()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss")}},{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,render:function(t,n,r,o){return[(0,O.jsx)("a",{onClick:function(){Y(n)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,O.jsx)(B.Z,{title:e.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==n?void 0:n.question,"】？"),onConfirm:function(){return $(n)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"}),children:(0,O.jsx)(F.ZP,{size:"small",type:"link",danger:!0,children:e.formatMessage({id:"delete",defaultMessage:"Delete"})})},"delete")]}}],H=function(){h(void 0),l(!1),j(!0)},Y=function(e){h(e),l(!0),j(!0)},q=function(){var t=v()(m()().mark((function t(r){var o,a;return m()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("handleSubmitDrawer",r),s?w.yw.loading(e.formatMessage({id:"updating"})):w.yw.loading(e.formatMessage({id:"creating"})),!s){t.next=8;break}return t.next=5,(0,me.y)(r);case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,(0,me.kh)(r);case 10:t.t0=t.sent;case 11:o=t.t0,console.log("createFaq response:",r,o),200===o.code?(w.yw.destroy(),w.yw.success(e.formatMessage({id:"create.success",defaultMessage:"create success"})),j(!1),null===(a=n.current)||void 0===a||a.reloadAndRest()):(w.yw.destroy(),w.yw.error(o.message));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),V=function(){var e=v()(m()().mark((function e(){return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleImport"),U(!0);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=v()(m()().mark((function e(){var t;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExport"),t=localStorage.getItem(a.LA8),window.open((0,T.kG)()+"/api/v1/faq/export?categoryUid="+(null==D?void 0:D.uid)+"&kbUid="+(null==I?void 0:I.uid)+"&orgUid="+(null==k?void 0:k.uid)+"&pageNumber=0&pageSize=20&accessToken="+t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.reloadAndRest()}),[I,D]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(xe.Z,{message:"用于：常见问题、快捷按钮、猜你相问、热门问题、快捷路径",type:"success"}),(0,O.jsx)(we.Z,{}),(0,O.jsx)(R.Z,{columns:N,actionRef:n,cardBordered:!0,request:function(){var t=v()(m()().mark((function t(n,r,o){var a,s,i;return m()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",n,r,o),w.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),n.current,a=p()(n,Ze),s=d()({pageNumber:n.current-1,categoryUid:"all"===D.uid?"":D.uid,kbUid:null==I?void 0:I.uid,orgUid:null==k?void 0:k.uid},a),t.next=6,(0,me.pf)(s);case 6:return i=t.sent,console.log("getAllFaqs response:",s,i),w.yw.destroy(),200===i.code||w.yw.error(i.message),t.abrupt("return",{data:i.data.content,success:!0,total:i.data.totalElements});case 11:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"问答对",toolBarRender:function(){return[(0,O.jsx)(F.ZP,{icon:(0,O.jsx)(z.Z,{}),type:"primary",onClick:H,children:e.formatMessage({id:"create",defaultMessage:"Create"})},"button"),(0,O.jsx)(F.ZP,{icon:(0,O.jsx)(he.Z,{}),type:"primary",onClick:V,children:e.formatMessage({id:"import",defaultMessage:"Import"})},"button"),(0,O.jsx)(F.ZP,{icon:(0,O.jsx)(ve.Z,{}),type:"primary",onClick:K,children:e.formatMessage({id:"export",defaultMessage:"Export"})},"button"),(0,O.jsx)(F.ZP,{icon:(0,O.jsx)(ye.Z,{}),type:"link",onClick:function(){window.open("https://www.weiyuai.cn/download/excel/kbase_faq.xlsx")},children:e.formatMessage({id:"download.template",defaultMessage:"Download Template"})},"download")]}}),(0,O.jsx)(Se,{isEdit:s,open:M,faq:g,onClose:function(){return j(!1)},onSubmit:q}),A&&(0,O.jsx)(Q.Z,{type:a.bE7,acceptType:".xls,.xlsx,.csv",isModalOpen:A,handleSubmit:function(e){console.log("handleUploadDragSubmit",e),U(!1),null==n||n.current.reload()},handleCancel:function(){console.log("handleUploadDragCancel"),U(!1),null==n||n.current.reload()}})]})};c.FormattedMessage,c.FormattedMessage,c.FormattedMessage,c.FormattedMessage,c.FormattedMessage;var Te=["current"],De=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,O.jsx)(c.FormattedMessage,{id:"fileName",defaultMessage:"fileName"}),dataIndex:"fileName"},{title:(0,O.jsx)(c.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0},{title:(0,O.jsx)(c.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:200,hideInSearch:!0,render:function(e,t,n,r){return L()(t.createdAt).format("YYYY-MM-DD HH:mm:ss")}}],Ee=function(){var e=(0,c.useIntl)(),t=((0,c.useNavigate)(),(0,i.useRef)()),n=(0,Z.u)((function(e){return e.currentOrg})),r=(0,S.j)((function(e){return e.currentKbase})),o=(0,_.v)((function(e){return e.currentCategory})),s=(0,i.useState)(!1),l=x()(s,2),u=l[0],f=l[1],g=(0,i.useState)(!1),h=x()(g,2),y=h[0],M=h[1],k=function(){var n=v()(m()().mark((function n(r){var o;return m()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(r),n.next=3,j(r);case 3:o=n.sent,console.log("delete response:",o),200===o.code?(null==t||t.current.reload(),w.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete Success"}))):w.yw.error(e.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),C=[].concat(De,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:150,render:function(t,n,r,o){return[(0,O.jsx)("a",{onClick:function(){var e=null==n?void 0:n.fileUrl,t=encodeURIComponent(e);window.open(decodeURIComponent(t))},children:e.formatMessage({id:"open",defaultMessage:"Open"})},"editable"),(0,O.jsx)("a",{onClick:function(){},children:"处理"},"status"),(0,O.jsx)(B.Z,{title:e.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==n?void 0:n.name,"】？"),onConfirm:function(){return k(n)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"}),children:(0,O.jsx)(F.ZP,{size:"small",type:"link",danger:!0,children:e.formatMessage({id:"delete",defaultMessage:"Delete"})})},"delete")]}}]);(0,i.useEffect)((function(){var e;null==t||null===(e=t.current)||void 0===e||e.reload()}),[r,o]),(0,i.useEffect)((function(){return U.Z.on(a.YwV,(function(e){var n;console.log("EVENT_BUS_MQTT_NOTICE",e),null==t||null===(n=t.current)||void 0===n||n.reload()})),function(){U.Z.off(a.YwV)}}),[]);(0,i.useMemo)((function(){return(null==r?void 0:r.type)!==a.QPQ||""===(null==r?void 0:r.uid)}),[r]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(R.Z,{columns:C,actionRef:t,cardBordered:!0,request:function(){var e=v()(m()().mark((function e(t,r,o){var a,s,i;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request:",t,r,o),t.current,a=p()(t,Te),s=d()({pageNumber:t.current-1,orgUid:null==n?void 0:n.uid},a),e.next=5,b(s);case 5:return i=e.sent,console.log("queryFilesByOrg response:",i,s),200===i.code||w.yw.error(i.message),e.abrupt("return",{data:i.data.content,success:!0,total:i.data.totalElements});case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"文件拆分列表",toolBarRender:function(){return[]}}),u&&(0,O.jsx)(Q.Z,{type:a.QPQ,acceptType:"*",isModalOpen:u,handleSubmit:function(e){console.log("handleFileDragSubmit",e),f(!1),null==t||t.current.reload()},handleCancel:function(){console.log("handleFileDragCancel"),f(!1),null==t||t.current.reload()}}),y&&(0,O.jsx)(A,{type:a.xtN,open:y,onClose:function(){return M(!1)}})]})},Fe=function(){var e=(0,c.useIntl)(),t=(0,i.useMemo)((function(){return[{key:"split",label:e.formatMessage({id:"pages.robot.kb.split",defaultMessage:"Split"}),children:(0,O.jsx)(Ee,{})},{key:"file",label:e.formatMessage({id:"pages.robot.kb.file",defaultMessage:"File"}),children:(0,O.jsx)(G,{})},{key:"qa",label:e.formatMessage({id:"pages.robot.kb.qa",defaultMessage:"Q&A"}),children:(0,O.jsx)(Ie,{})},{key:"text",label:e.formatMessage({id:"pages.robot.kb.text",defaultMessage:"Text"}),children:(0,O.jsx)(ge,{})}]}),[e]);return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(l.Z,{items:t})})},Pe=o.Z.Sider,Oe=o.Z.Content,Ae=function(){var e=(0,r.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,O.jsx)("div",{children:(0,O.jsxs)(o.Z,{children:[(0,O.jsx)(Pe,{style:t,children:(0,O.jsx)(s.Z,{type:a.QPQ})}),(0,O.jsx)(o.Z,{children:(0,O.jsx)(Oe,{style:n,children:(0,O.jsx)(Fe,{})})})]})})}},32943:function(e,t,n){n.d(t,{Z:function(){return U}});var r=n(44194),o=n(58644),a=n(92520),s=n(14377),i=n(64985),l=n(18701),c=n(51865),u=n.n(c),d=n(77588),f=n(67762),p=n(34221),g=n(79145),m=n(37167),h=n(47825),v=n(88874),y=n(65759);const x=(e,t,n,r,o)=>({background:e,border:`${(0,h.bf)(r.lineWidth)} ${r.lineType} ${t}`,[`${o}-icon`]:{color:n}}),w=e=>{const{componentCls:t,motionDurationSlow:n,marginXS:r,marginSM:o,fontSize:a,fontSizeLG:s,lineHeight:i,borderRadiusLG:l,motionEaseInOutCirc:c,withDescriptionIconSize:u,colorText:d,colorTextHeading:f,withDescriptionPadding:p,defaultPadding:g}=e;return{[t]:Object.assign(Object.assign({},(0,v.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:g,wordWrap:"break-word",borderRadius:l,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:a,lineHeight:i},"&-message":{color:f},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${c}, opacity ${n} ${c},\n        padding-top ${n} ${c}, padding-bottom ${n} ${c},\n        margin-bottom ${n} ${c}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${t}-with-description`]:{alignItems:"flex-start",padding:p,[`${t}-icon`]:{marginInlineEnd:o,fontSize:u,lineHeight:0},[`${t}-message`]:{display:"block",marginBottom:r,color:f,fontSize:s},[`${t}-description`]:{display:"block",color:d}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},b=e=>{const{componentCls:t,colorSuccess:n,colorSuccessBorder:r,colorSuccessBg:o,colorWarning:a,colorWarningBorder:s,colorWarningBg:i,colorError:l,colorErrorBorder:c,colorErrorBg:u,colorInfo:d,colorInfoBorder:f,colorInfoBg:p}=e;return{[t]:{"&-success":x(o,r,n,e,t),"&-info":x(p,f,d,e,t),"&-warning":x(i,s,a,e,t),"&-error":Object.assign(Object.assign({},x(u,c,l,e,t)),{[`${t}-description > pre`]:{margin:0,padding:0}})}}},M=e=>{const{componentCls:t,iconCls:n,motionDurationMid:r,marginXS:o,fontSizeIcon:a,colorIcon:s,colorIconHover:i}=e;return{[t]:{"&-action":{marginInlineStart:o},[`${t}-close-icon`]:{marginInlineStart:o,padding:0,overflow:"hidden",fontSize:a,lineHeight:(0,h.bf)(a),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:s,transition:`color ${r}`,"&:hover":{color:i}}},"&-close-text":{color:s,transition:`color ${r}`,"&:hover":{color:i}}}}};var j=(0,y.I$)("Alert",(e=>[w(e),b(e),M(e)]),(e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}))),k=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const C={success:o.Z,info:l.Z,error:a.Z,warning:i.Z},S=e=>{const{icon:t,prefixCls:n,type:o}=e,a=C[o]||null;return t?(0,g.wm)(t,r.createElement("span",{className:`${n}-icon`},t),(()=>({className:u()(`${n}-icon`,t.props.className)}))):r.createElement(a,{className:`${n}-icon`})},Z=e=>{const{isClosable:t,prefixCls:n,closeIcon:o,handleClose:a,ariaProps:i}=e,l=!0===o||void 0===o?r.createElement(s.Z,null):o;return t?r.createElement("button",Object.assign({type:"button",onClick:a,className:`${n}-close-icon`,tabIndex:0},i),l):null},I=r.forwardRef(((e,t)=>{const{description:n,prefixCls:o,message:a,banner:s,className:i,rootClassName:l,style:c,onMouseEnter:g,onMouseLeave:h,onClick:v,afterClose:y,showIcon:x,closable:w,closeText:b,closeIcon:M,action:C,id:I}=e,T=k(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[D,E]=r.useState(!1);const F=r.useRef(null);r.useImperativeHandle(t,(()=>({nativeElement:F.current})));const{getPrefixCls:P,direction:O,alert:A}=r.useContext(m.E_),_=P("alert",o),[U,$,N]=j(_),H=t=>{var n;E(!0),null===(n=e.onClose)||void 0===n||n.call(e,t)},Y=r.useMemo((()=>void 0!==e.type?e.type:s?"warning":"info"),[e.type,s]),q=r.useMemo((()=>!("object"!=typeof w||!w.closeIcon)||(!!b||("boolean"==typeof w?w:!1!==M&&null!=M||!!(null==A?void 0:A.closable)))),[b,M,w,null==A?void 0:A.closable]),z=!(!s||void 0!==x)||x,R=u()(_,`${_}-${Y}`,{[`${_}-with-description`]:!!n,[`${_}-no-icon`]:!z,[`${_}-banner`]:!!s,[`${_}-rtl`]:"rtl"===O},null==A?void 0:A.className,i,l,N,$),B=(0,f.Z)(T,{aria:!0,data:!0}),V=r.useMemo((()=>{var e,t;return"object"==typeof w&&w.closeIcon?w.closeIcon:b||(void 0!==M?M:"object"==typeof(null==A?void 0:A.closable)&&(null===(e=null==A?void 0:A.closable)||void 0===e?void 0:e.closeIcon)?null===(t=null==A?void 0:A.closable)||void 0===t?void 0:t.closeIcon:null==A?void 0:A.closeIcon)}),[M,w,b,null==A?void 0:A.closeIcon]),L=r.useMemo((()=>{const e=null!=w?w:null==A?void 0:A.closable;if("object"==typeof e){const{closeIcon:t}=e;return k(e,["closeIcon"])}return{}}),[w,null==A?void 0:A.closable]);return U(r.createElement(d.ZP,{visible:!D,motionName:`${_}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:y},((t,o)=>{let{className:s,style:i}=t;return r.createElement("div",Object.assign({id:I,ref:(0,p.sQ)(F,o),"data-show":!D,className:u()(R,s),style:Object.assign(Object.assign(Object.assign({},null==A?void 0:A.style),c),i),onMouseEnter:g,onMouseLeave:h,onClick:v,role:"alert"},B),z?r.createElement(S,{description:n,icon:e.icon,prefixCls:_,type:Y}):null,r.createElement("div",{className:`${_}-content`},a?r.createElement("div",{className:`${_}-message`},a):null,n?r.createElement("div",{className:`${_}-description`},n):null),C?r.createElement("div",{className:`${_}-action`},C):null,r.createElement(Z,{isClosable:q,prefixCls:_,closeIcon:V,handleClose:H,ariaProps:L}))})))}));var T=I,D=n(74592),E=n(32099),F=n(67019),P=n(14755);let O=function(e){function t(){var e;return(0,D.Z)(this,t),(e=(0,F.Z)(this,t,arguments)).state={error:void 0,info:{componentStack:""}},e}return(0,P.Z)(t,e),(0,E.Z)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){const{message:e,description:t,id:n,children:o}=this.props,{error:a,info:s}=this.state,i=(null==s?void 0:s.componentStack)||null,l=void 0===e?(a||"").toString():e,c=void 0===t?i:t;return a?r.createElement(T,{id:n,type:"error",message:l,description:r.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},c)}):o}}])}(r.Component);var A=O;const _=T;_.ErrorBoundary=A;var U=_},67019:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(42885),o=n(19567),a=n(27842);function s(e,t,n){return t=(0,r.Z)(t),(0,a.Z)(e,(0,o.Z)()?Reflect.construct(t,n||[],(0,r.Z)(e).constructor):t.apply(e,n))}}}]);