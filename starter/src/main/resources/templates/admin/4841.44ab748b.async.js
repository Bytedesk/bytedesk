"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4841],{30300:function(k,D,e){e.d(D,{FU:function(){return l},O7:function(){return F},k4:function(){return j},yr:function(){return t}});var b=e(15009),r=e.n(b),E=e(97857),a=e.n(E),O=e(99289),g=e.n(O),p=e(85615),y=e(86745);function l(s){return m.apply(this,arguments)}function m(){return m=g()(r()().mark(function s(T){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/v1/category/query/org",{method:"GET",params:a()(a()({},T),{},{client:p.bV})}));case 1:case"end":return o.stop()}},s)})),m.apply(this,arguments)}function j(s){return _.apply(this,arguments)}function _(){return _=g()(r()().mark(function s(T){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/v1/category/create",{method:"POST",data:a()(a()({},T),{},{client:p.bV})}));case 1:case"end":return o.stop()}},s)})),_.apply(this,arguments)}function t(s){return n.apply(this,arguments)}function n(){return n=g()(r()().mark(function s(T){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/v1/category/update",{method:"POST",data:a()(a()({},T),{},{client:p.bV})}));case 1:case"end":return o.stop()}},s)})),n.apply(this,arguments)}function i(s){return u.apply(this,arguments)}function u(){return u=_asyncToGenerator(_regeneratorRuntime().mark(function s(T){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",request("/api/v1/category/delete",{method:"POST",data:_objectSpread(_objectSpread({},T),{},{client:HTTP_CLIENT})}));case 1:case"end":return o.stop()}},s)})),u.apply(this,arguments)}function S(s){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function s(T){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",request("/api/v1/category/all",{method:"GET",params:_objectSpread(_objectSpread({},T),{},{client:HTTP_CLIENT})}));case 1:case"end":return o.stop()}},s)})),A.apply(this,arguments)}function F(){return R.apply(this,arguments)}function R(){return R=g()(r()().mark(function s(){return r()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.abrupt("return",(0,y.request)("/visitor/api/v1/category/query",{method:"GET",params:{client:p.bV}}));case 1:case"end":return U.stop()}},s)})),R.apply(this,arguments)}},52670:function(k,D,e){e.d(D,{Z:function(){return le}});var b=e(15009),r=e.n(b),E=e(99289),a=e.n(E),O=e(5574),g=e.n(O),p=e(11475),y=e(85576),l=e(86250),m=e(14726),j=e(14e3),_=e(83062),t=e(80049),n=e(73803),i=e(38302),u=e(87676),S=e(34994),A=e(5966),F=e(64317),R=e(67294),s=e(85893),T=function(B){var w,Y=B.open,q=B.type,z=B.isEdit,K=B.category,M=B.onCancel,te=B.onSubmit,ee=S.A.useForm(),x=g()(ee,1),I=x[0],ne=(0,n.Z)(),G=ne.translateString,V=(0,u.u)(function(P){return P.currentOrg}),Z=(0,i.j)(function(P){return P.kbaseResult}),N=(0,i.j)(function(P){return P.currentKbase});(0,R.useEffect)(function(){z?I.setFieldsValue({name:G(K==null?void 0:K.name)}):I.resetFields()},[Y,z]);var W=function(){I.validateFields().then(function(){var L=a()(r()().mark(function f(H){var J;return r()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:console.log("handleSaveDep:",H),J={uid:z?K==null?void 0:K.uid:"",name:H.name,type:q,kbUid:H.kbUid,orgUid:V==null?void 0:V.uid},te(J);case 3:case"end":return Q.stop()}},f)}));return function(f){return L.apply(this,arguments)}}()).catch(function(L){console.log("Failed:",L),t.yw.error("\u521B\u5EFA\u5206\u7C7B\u5931\u8D25")})},$=function(L){L.key==="Enter"&&W()};return(0,s.jsx)("div",{children:(0,s.jsx)(y.Z,{title:"\u65B0\u5EFA\u5206\u7C7B",open:Y,onOk:W,onCancel:M,children:(0,s.jsxs)(S.A,{form:I,name:"categoryForm",initialValues:{name:"",kbUid:N==null?void 0:N.uid},submitter:!1,children:[(0,s.jsx)(A.Z,{label:"\u5206\u7C7B\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0!"}],fieldProps:{onKeyDown:$,placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0"}}),(0,s.jsx)(F.Z,{name:"kbUid",label:"\u6240\u5C5E\u77E5\u8BC6\u5E93",allowClear:!0,options:Z==null||(w=Z.data)===null||w===void 0?void 0:w.content.map(function(P){return{label:G(P.name),value:P.uid}})})]})})})},U=T,o=e(30300),se=e(89102),ie=e(86745),oe=y.Z.confirm,ue=function(B){var w=B.type,Y=(0,R.useState)(!1),q=g()(Y,2),z=q[0],K=q[1],M=(0,ie.useIntl)(),te=(0,R.useState)(!0),ee=g()(te,2),x=ee[0],I=ee[1],ne=(0,R.useState)(),G=g()(ne,2),V=G[0],Z=G[1],N=(0,u.u)(function(d){return d.currentOrg}),W=(0,i.j)(function(d){return d.currentKbase}),$=(0,se.v)(function(d){return{categoryTreeOptions:d.categoryTreeOptions,setCategoryResult:d.setCategoryResult,currentCategory:d.currentCategory,setCurrentCategoryUid:d.setCurrentCategoryUid}}),P=$.categoryTreeOptions,L=$.setCategoryResult,f=$.currentCategory,H=$.setCurrentCategoryUid,J=(0,n.Z)(),re=J.translateString,Q=J.translateStringTranct,_e=function(c){oe({title:M.formatMessage({id:"deleteTip"}),icon:(0,s.jsx)(p.Z,{}),content:"".concat(M.formatMessage({id:"deleteAfirm",defaultMessage:"Delete"}),"\u3010").concat(re(c.name),"\u3011\uFF1F"),onOk:function(){ve(c)},onCancel:function(){},okText:M.formatMessage({id:"ok"}),cancelText:M.formatMessage({id:"cancel"})})},ce=function(){K(!1)},ge=function(){I(!1),Z(void 0),K(!0)},me=function(){var d=a()(r()().mark(function c(h){var C;return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(console.log("handleSubmit: ",h),x?t.yw.loading(M.formatMessage({id:"updating"})):t.yw.loading(M.formatMessage({id:"creating"})),!x){v.next=8;break}return v.next=5,(0,o.yr)(h);case 5:v.t0=v.sent,v.next=11;break;case 8:return v.next=10,(0,o.k4)(h);case 10:v.t0=v.sent;case 11:C=v.t0,console.log("createCategory response: ",C),C.code===200?(t.yw.destroy(),x?t.yw.success(M.formatMessage({id:"update.success"})):t.yw.success(M.formatMessage({id:"create.success"})),K(!1),ae()):(t.yw.destroy(),t.yw.error(C.message));case 14:case"end":return v.stop()}},c)}));return function(h){return d.apply(this,arguments)}}(),ae=function(){var d=a()(r()().mark(function c(){var h,C;return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return console.log("getCategories"),t.yw.success(M.formatMessage({id:"loading"})),h={pageNumber:0,pageSize:50,type:w,kbUid:W==null?void 0:W.uid,orgUid:N.uid},v.next=5,(0,o.FU)(h);case 5:C=v.sent,console.log("queryCategories response: ",C),C.code===200?(L(C),t.yw.destroy()):(t.yw.destroy(),t.yw.error(C.message));case 8:case"end":return v.stop()}},c)}));return function(){return d.apply(this,arguments)}}(),fe=function(){var d=a()(r()().mark(function c(){return r()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:console.log("handleEditCategory: ",f),I(!0),Z(f),K(!0);case 4:case"end":return C.stop()}},c)}));return function(){return d.apply(this,arguments)}}(),ve=function(){var d=a()(r()().mark(function c(h){return r()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:console.log("handleDeleteCategory: ",h);case 1:case"end":return X.stop()}},c)}));return function(h){return d.apply(this,arguments)}}();(0,R.useEffect)(function(){ae()},[W]);var pe=function(c,h){console.log("selected",c,h),c.length!==0&&H(c[0].toString())};return(0,s.jsxs)("div",{children:[(0,s.jsxs)(l.Z,{gap:"small",wrap:"wrap",style:{marginBottom:5},children:[(0,s.jsx)(m.ZP,{type:"primary",size:"small",onClick:ge,children:"\u521B\u5EFA\u5206\u7C7B"}),(f==null?void 0:f.uid)!==""&&(f==null?void 0:f.uid)!=="all"&&(0,s.jsx)(m.ZP,{size:"small",onClick:fe,children:M.formatMessage({id:"edit"})}),(f==null?void 0:f.uid)!==""&&(f==null?void 0:f.uid)!=="all"&&(0,s.jsx)(m.ZP,{onClick:function(){return _e(f)},size:"small",style:{float:"right"},danger:!0,children:M.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,s.jsx)(j.Z,{defaultSelectedKeys:[f.uid],onSelect:pe,treeData:P,blockNode:!0,titleRender:function(c){return(0,s.jsx)(_.Z,{title:re(c.title),children:Q(c.title)})}}),(0,s.jsx)(U,{open:z,type:w,isEdit:x,category:V,onCancel:ce,onSubmit:me})]})},le=ue},77154:function(k,D,e){var b=e(39825);function r(){var E=(0,b.Z)(),a=E.isDarkMode,O=250,g={borderRight:a?"1px solid #333":"1px solid #ccc",background:a?"#141414":"#f5f5f5"},p={background:a?"#141414":"#fff"},y={borderLeft:a?"1px solid #333":"1px solid #ccc",background:a?"#141414":"#f5f5f5"},l={minHeight:120,background:a?"#141414":"#f5f5f5",height:"100vh"};return{leftSiderStyle:g,leftSiderWidth:O,headerStyle:p,rightSiderStyle:y,contentStyle:l}}D.Z=r},73803:function(k,D,e){var b=e(85615),r=e(66419),E=e(86745);function a(){var O=(0,E.useIntl)(),g=function(l){return l&&l.startsWith(b.Vo)?O.formatMessage({id:l,defaultMessage:l}):l},p=function(l){return l!=null&&l.startsWith(b.Vo)?(0,r.aS)(O.formatMessage({id:l}),10):(0,r.aS)(l,10)};return{translateString:g,translateStringTranct:p}}D.Z=a},89102:function(k,D,e){e.d(D,{v:function(){return l}});var b=e(19632),r=e.n(b),E=e(97857),a=e.n(E),O=e(85615),g=e(73445),p=e(782),y=e(18753),l=(0,g.Ue)()((0,p.mW)((0,p.tJ)((0,y.n)(function(_,t){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:""},setCategoryResult:function(i){var u,S=j(i),A={uid:"all",name:"All"},F=a()(a()({},i),{},{data:{content:[A].concat(r()(i.data.content))}}),R=m(F);_({categoryResult:F,categoryTreeOptions:R,categorySelectOptions:S}),((u=i.data)===null||u===void 0||(u=u.content)===null||u===void 0?void 0:u.length)>0?_({currentCategory:i.data.content[0]}):_({currentCategory:{uid:""}})},setCurrentCategoryUid:function(i){var u=t().categoryResult.data.content.find(function(S){return S.uid===i});_({currentCategory:u})},deleteCategoryCache:function(){return _({},!0)}}}),{name:O.OM})));function m(_){var t=[];return _.data.content.forEach(function(n){var i={title:n.name,key:n.uid,children:[]};n.children&&Array.isArray(n.children)&&(i.children=n.children.map(function(u){return{title:u.name,key:u.uid,children:[]}})),t.push(i)}),t}function j(_){var t=[];return _.data.content.forEach(function(n){var i={label:n.name,value:n.uid};t.push(i)}),t}},38302:function(k,D,e){e.d(D,{j:function(){return l}});var b=e(97857),r=e.n(b),E=e(19632),a=e.n(E),O=e(85615),g=e(73445),p=e(782),y=e(18753),l=(0,g.Ue)()((0,p.mW)((0,p.tJ)((0,y.n)(function(m,j){return{currentKbase:{uid:"",orgUid:""},kbaseResult:{data:{content:[]}},insertKbase:function(t){m(function(n){var i=n.kbaseResult.data.content;i.unshift(t)})},updateKbase:function(t){m(function(n){var i=n.kbaseResult.data.content,u=i.findIndex(function(S){return S.uid===t.uid});u!==-1?i[u]=t:console.warn("Kbase with uid ".concat(t.uid," not found."))})},setKbaseResult:function(t){var n;m({kbaseResult:t}),((n=t.data)===null||n===void 0||(n=n.content)===null||n===void 0?void 0:n.length)>0&&m({currentKbase:t.data.content[0]})},setCurrentKbase:function(t){var n=j().kbaseResult.data.content,i=n.findIndex(function(A){return A.uid===t.uid});if(i!==-1){var u=[].concat(a()(n.slice(0,i)),[t],a()(n.slice(i+1))),S=r()(r()({},j().kbaseResult),{},{data:{content:u}});m({kbaseResult:S,currentKbase:t})}else console.warn("Kbase with the specified uid not found."),m({currentKbase:t})},removeKbase:function(t){var n=j().kbaseResult.data.content,i=n.findIndex(function(u){return u.uid===t});i!==-1?m({kbaseResult:r()(r()({},j().kbaseResult),{},{data:{content:[].concat(a()(n.slice(0,i)),a()(n.slice(i+1)))}})}):console.warn("Kbase not found in cache:",t),j().currentKbase.uid===t&&m({currentKbase:{uid:"",orgUid:""}})},deleteKbaseCache:function(){return m({},!0)}}}),{name:O.wK})))},87676:function(k,D,e){e.d(D,{u:function(){return O}});var b=e(85615),r=e(73445),E=e(782),a=e(18753),O=(0,r.Ue)()((0,E.mW)((0,E.tJ)((0,a.n)(function(g,p){return{currentOrg:{uid:"",name:"",description:""},setCurrentOrg:function(l){g({currentOrg:l})},deleteOrg:function(){return g({},!0)}}}),{name:b.eR})))}}]);
