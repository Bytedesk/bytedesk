"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1730],{70401:function(H,T,e){e.d(T,{$t:function(){return F},a_:function(){return L},vf:function(){return P}});var I=e(15009),g=e.n(I),y=e(97857),o=e.n(y),B=e(99289),c=e.n(B),C=e(85615),v=e(86745);function P(m){return K.apply(this,arguments)}function K(){return K=c()(g()().mark(function m(s){return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,v.request)("/api/v1/vip/crm/query/visitor/org",{method:"GET",params:o()(o()({},s),{},{client:C.bVn})}));case 1:case"end":return l.stop()}},m)})),K.apply(this,arguments)}function L(){return E.apply(this,arguments)}function E(){return E=c()(g()().mark(function m(){return g()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,v.request)("/visitor/api/v1/kaptcha",{method:"GET",params:{client:C.bVn}}));case 1:case"end":return h.stop()}},m)})),E.apply(this,arguments)}function F(m,s){return W.apply(this,arguments)}function W(){return W=c()(g()().mark(function m(s,h){return g()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",(0,v.request)("/visitor/api/v1/kaptcha/check",{method:"POST",data:{captchaUid:s,captchaCode:h,client:C.bVn}}));case 1:case"end":return A.stop()}},m)})),W.apply(this,arguments)}function w(m){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime().mark(function m(s){return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",request("/api/v1/visitor/update",{method:"POST",data:_objectSpread(_objectSpread({},s),{},{client:HTTP_CLIENT})}));case 1:case"end":return l.stop()}},m)})),R.apply(this,arguments)}function O(m){return k.apply(this,arguments)}function k(){return k=_asyncToGenerator(_regeneratorRuntime().mark(function m(s){return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",request("/api/v1/visitor/delete",{method:"POST",data:_objectSpread(_objectSpread({},s),{},{client:HTTP_CLIENT})}));case 1:case"end":return l.stop()}},m)})),k.apply(this,arguments)}},6144:function(H,T,e){var I=e(15009),g=e.n(I),y=e(99289),o=e.n(y),B=e(5574),c=e.n(B),C=e(70401),v=e(50228),P=e(86745),K=e(55102),L=e(67294),E=e(85893),F=function(w){var R=w.onKaptchaChange,O=w.onKaptchaCheck,k=(0,P.useIntl)(),m=(0,L.useState)(),s=c()(m,2),h=s[0],l=s[1],A=(0,L.useState)(),z=c()(A,2),G=z[0],Y=z[1],j=function(){var b=o()(g()().mark(function M(){var U;return g()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,C.a_)();case 2:U=D.sent,U.code===200&&(l(U.data.captchaUid),Y(U.data.captchaImage));case 4:case"end":return D.stop()}},M)}));return function(){return b.apply(this,arguments)}}(),V=function(){var b=o()(g()().mark(function M(U,Z){var D;return g()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,C.$t)(U,Z);case 2:D=a.sent,console.log("checkCaptcha response",D),D.code===200?O&&O(!0):O&&O(!1);case 5:case"end":return a.stop()}},M)}));return function(U,Z){return b.apply(this,arguments)}}();(0,L.useEffect)(function(){j()},[]);var p=function(M){R&&(R(h,M.target.value),M.target.value&&M.target.value!==""&&M.target.value.trim().length===4?V(h,M.target.value):O&&O(!1))};return(0,E.jsx)(E.Fragment,{children:G&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(K.Z,{onChange:p,prefix:(0,E.jsx)(v.Z,{}),placeholder:k.formatMessage({id:"captcha",defaultMessage:"captcha"}),style:{width:"65%",float:"left",height:40}}),(0,E.jsx)("img",{src:G,alt:"captcha",onClick:j})]})})};T.Z=F},87223:function(H,T,e){e.r(T);var I=e(97857),g=e.n(I),y=e(15009),o=e.n(y),B=e(99289),c=e.n(B),C=e(5574),v=e.n(C),P=e(98661),K=e(59203),L=e(87547),E=e(94149),F=e(24454),W=e(34994),w=e(10915),R=e(68262),O=e(5966),k=e(16434),m=e(92879),s=e(86745),h=e(9361),l=e(40056),A=e(32983),z=e(14726),G=e(28459),Y=e(31418),j=e(67294),V=e(39825),p=e(80049),b=e(85615),M=e(63998),U=e(73935),Z=e(60247),D=e(66419),X=e(6144),a=e(85893),re=h.Z.defaultAlgorithm,_e=h.Z.darkAlgorithm,ie=function(){var S=(0,m.l)(function(x){var $=x.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:$.borderRadius,":hover":{backgroundColor:$.colorBgTextHover}}});return(0,a.jsx)("div",{className:S,"data-lang":!0,children:s.SelectLang&&(0,a.jsx)(s.SelectLang,{})})},q=function(S){var x=S.content;return(0,a.jsx)(l.Z,{style:{marginBottom:24},message:x,type:"error",showIcon:!0})},oe=function(){var S=W.A.useForm(),x=v()(S,1),$=x[0],le=h.Z.useToken(),de=le.token,ge=(0,V.Z)(),ce=ge.isDarkMode,ee=(0,j.useRef)(),pe=(0,j.useState)(!1),ae=v()(pe,2),me=ae[0],he=ae[1],N=(0,s.useModel)("@@initialState"),Le=N.initialState,We=N.loading,ke=N.refresh,fe=N.setInitialState,ve=(0,j.useState)(!1),te=v()(ve,2),Ee=te[0],Me=te[1],De=(0,M.t)(function(u){return u.setAccessToken}),Pe=(0,Z.L)(function(u){return u.setUserInfo}),Oe=(0,s.getLocale)();console.log("register page locale:",Oe);var f=(0,s.useIntl)(),Ce=(0,j.useState)(""),se=v()(Ce,2),Q=se[0],je=se[1],be=(0,j.useState)(""),ne=v()(be,2),Ue=ne[0],Te=ne[1],ye=function(){var u=c()(o()().mark(function n(t,r){return o()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:je(t),Te(r),$.setFieldValue("captchaCode",r);case 3:case"end":return _.stop()}},n)}));return function(t,r){return u.apply(this,arguments)}}(),Re=function(){var u=c()(o()().mark(function n(t){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:he(t);case 1:case"end":return d.stop()}},n)}));return function(t){return u.apply(this,arguments)}}();(0,j.useEffect)(function(){(0,D.iE)(),(0,D.Bc)()&&Me(!0),(0,D.pr)()},[]);var Ae=function(){var u=c()(o()().mark(function n(t){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:t&&(0,U.flushSync)(function(){fe(function(_){return g()(g()({},_),{},{userInfo:t})})});case 1:case"end":return d.stop()}},n)}));return function(t){return u.apply(this,arguments)}}(),Ie=function(){var u=c()(o()().mark(function n(t){var r,d;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,console.log("values:",t),p.yw.loading(f.formatMessage({id:"registering",defaultMessage:"registering..."})),i.next=5,(0,P.z2)(g()({},t));case 5:if(r=i.sent,console.log("registerResult:",r),r.code!==200){i.next=15;break}return p.yw.destroy(),p.yw.success(r.message),d={username:t.email,password:t.password,captchaUid:Q,captchaCode:t.captchaCode,platform:b.iw8},Be(d),i.abrupt("return");case 15:p.yw.destroy(),p.yw.error(r.message);case 17:i.next=23;break;case 19:i.prev=19,i.t0=i.catch(0),console.log(i.t0),p.yw.error(f.formatMessage({id:"register.error",defaultMessage:"register failed"}));case 23:case"end":return i.stop()}},n,null,[[0,19]])}));return function(t){return u.apply(this,arguments)}}(),Be=function(){var u=c()(o()().mark(function n(t){var r;return o()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.prev=0,console.log("handleSubmit values: ",t),p.yw.loading(f.formatMessage({id:"logining",defaultMessage:"logining..."})),_.next=5,(0,P.x4)(g()({},t));case 5:r=_.sent,console.log("LoginResult:",r),r.code===200?(p.yw.destroy(),p.yw.success(f.formatMessage({id:"login.success",defaultMessage:"login success"})),Ae(r.data.user),Pe(r.data.user),De(r.data.accessToken),s.history.push("/")):(p.yw.destroy(),p.yw.error(r.message)),_.next=14;break;case 10:_.prev=10,_.t0=_.catch(0),console.log(_.t0),p.yw.error(f.formatMessage({id:"login.error",defaultMessage:"login failed"}));case 14:case"end":return _.stop()}},n,null,[[0,10]])}));return function(t){return u.apply(this,arguments)}}(),Ke=function(){setTimeout(function(){var n;console.log("endCaptchaTiming"),(n=ee.current)===null||n===void 0||n.endTiming()},2)};return(0,a.jsxs)(w._Y,{hashed:!1,dark:ce,children:[(0,a.jsx)(ie,{}),(0,a.jsx)("div",{style:{backgroundColor:de.colorBgContainer,textAlign:"center",height:"100vh",backgroundImage:"url('/admin/assets/images/bg-wide.png')"},children:Ee?(0,a.jsxs)(R.U,{form:$,contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,a.jsx)("img",{alt:"logo",src:"/admin/icons/logo.png"}),title:(0,a.jsx)(s.FormattedMessage,{id:"app.title"}),subTitle:f.formatMessage({id:"pages.login.registerAccount"}),initialValues:{autoLogin:!0},submitter:{searchConfig:{submitText:f.formatMessage({id:"pages.login.register"})}},onFinish:function(){var u=c()(o()().mark(function n(t){var r;return o()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return console.log("login values:",t),r={email:t.username,password:t.password,mobile:t.mobile,code:t.code,captchaUid:Q,captchaCode:t.captchaCode,platform:b.iw8},console.log("register info:",r),_.next=5,Ie(r);case 5:case"end":return _.stop()}},n)}));return function(n){return u.apply(this,arguments)}}(),children:[status==="error"&&(0,a.jsx)(q,{content:f.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),(0,a.jsx)(O.Z,{name:"username",fieldProps:{size:"large",prefix:(0,a.jsx)(L.Z,{})},placeholder:f.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u90AE\u7BB1"}),rules:[{required:!0,message:(0,a.jsx)(s.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u90AE\u7BB1!"})},{pattern:/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/,message:"\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E"},{max:50,message:"\u90AE\u7BB1\u4E0D\u5F97\u8D85\u8FC750\u5B57\u7B26"}]}),(0,a.jsx)(O.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,a.jsx)(E.Z,{})},placeholder:f.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,a.jsx)(s.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]}),(0,a.jsx)(O.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(F.Z,{})},name:"mobile",placeholder:f.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,a.jsx)(s.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,a.jsx)(s.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,a.jsx)(W.A.Item,{name:"captchaCode",rules:[{required:!0,message:f.formatMessage({id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],children:(0,a.jsx)(X.Z,{onKaptchaChange:ye,onKaptchaCheck:Re})}),(0,a.jsx)(k.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(E.Z,{})},captchaProps:{size:"large",disabled:!me},placeholder:f.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(n,t){return n?"".concat(t," ").concat(f.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):f.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,a.jsx)(s.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],fieldRef:ee,onGetCaptcha:function(){var u=c()(o()().mark(function n(t){var r,d;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t&&t.length===11)){i.next=13;break}return r={mobile:t,type:b.i_k,captchaUid:Q,captchaCode:Ue,platform:b.iw8},i.next=4,(0,P.Y7)(r);case 4:if(d=i.sent,console.log("sendMobileCodeResult:",d),d.code===200){i.next=10;break}return p.yw.error(d.message),Ke(),i.abrupt("return");case 10:p.yw.success(d.message),i.next=14;break;case 13:p.yw.error("\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF");case 14:case"end":return i.stop()}},n)}));return function(n){return u.apply(this,arguments)}}()}),status==="error"&&(0,a.jsx)(q,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),(0,a.jsx)("div",{style:{marginBottom:64},children:(0,a.jsx)("div",{style:{float:"right"},children:(0,a.jsx)(s.Link,{to:"/auth/login",children:(0,a.jsx)(s.FormattedMessage,{id:"pages.login.submit",defaultMessage:"\u767B\u5F55 "})})})})]}):(0,a.jsx)("div",{style:{textAlign:"center",margin:"0 auto"},children:(0,a.jsx)(A.Z,{description:"only for vip users, please contact: 270580156@qq.com",children:(0,a.jsx)(z.ZP,{type:"primary",onClick:function(){window.open("https://www.weiyuai.cn")},children:"open weiyuai.cn"})})})}),(0,a.jsx)(K.$_,{})]})},ue=function(){var S=(0,V.Z)(),x=S.isDarkMode;return(0,a.jsx)(G.ZP,{theme:{algorithm:x?_e:re},children:(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(p.ZP,{}),(0,a.jsx)(oe,{})]})})};T.default=ue},60247:function(H,T,e){e.d(T,{L:function(){return B}});var I=e(85615),g=e(73445),y=e(782),o=e(18753),B=(0,g.Ue)()((0,y.mW)((0,y.tJ)((0,o.n)(function(c,C){return{userInfo:{uid:""},deviceUid:"",setUserInfo:function(P){c({userInfo:P})},setDeviceUid:function(P){c({deviceUid:P})},deleteUserInfo:function(){return c({},!0)}}}),{name:I.EmD})))}}]);
