"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2647],{51042:function(ee,S,e){var d=e(1413),f=e(67294),M=e(42110),n=e(91146),B=function(s,E){return f.createElement(n.Z,(0,d.Z)((0,d.Z)({},s),{},{ref:E,icon:M.Z}))},x=f.forwardRef(B);S.Z=x},64317:function(ee,S,e){var d=e(1413),f=e(91),M=e(22270),n=e(67294),B=e(66758),x=e(32486),j=e(85893),s=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],E=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],C=function(p,F){var N=p.fieldProps,Z=p.children,Q=p.params,R=p.proFieldProps,J=p.mode,A=p.valueEnum,b=p.request,Y=p.showSearch,z=p.options,I=(0,f.Z)(p,s),O=(0,n.useContext)(B.Z);return(0,j.jsx)(x.Z,(0,d.Z)((0,d.Z)({valueEnum:(0,M.h)(A),request:b,params:Q,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,d.Z)({options:z,mode:J,showSearch:Y,getPopupContainer:O.getPopupContainer},N),ref:F,proFieldProps:R},I),{},{children:Z}))},G=n.forwardRef(function(o,p){var F=o.fieldProps,N=o.children,Z=o.params,Q=o.proFieldProps,R=o.mode,J=o.valueEnum,A=o.request,b=o.options,Y=(0,f.Z)(o,E),z=(0,d.Z)({options:b,mode:R||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},F),I=(0,n.useContext)(B.Z);return(0,j.jsx)(x.Z,(0,d.Z)((0,d.Z)({valueEnum:(0,M.h)(J),request:A,params:Z,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,d.Z)({getPopupContainer:I.getPopupContainer},z),ref:p,proFieldProps:Q},Y),{},{children:N}))}),D=n.forwardRef(C),c=G,m=D;m.SearchSelect=c,m.displayName="ProFormComponent",S.Z=m},90672:function(ee,S,e){var d=e(1413),f=e(91),M=e(67294),n=e(32486),B=e(85893),x=["fieldProps","proFieldProps"],j=function(E,C){var G=E.fieldProps,D=E.proFieldProps,c=(0,f.Z)(E,x);return(0,B.jsx)(n.Z,(0,d.Z)({ref:C,valueType:"textarea",fieldProps:G,proFieldProps:D},c))};S.Z=M.forwardRef(j)},49664:function(ee,S,e){e.r(S),e.d(S,{default:function(){return Be}});var d=e(77154),f=e(21612),M=e(97857),n=e.n(M),B=e(13769),x=e.n(B),j=e(15009),s=e.n(j),E=e(99289),C=e.n(E),G=e(5574),D=e.n(G),c=e(80049),m=e(85615),o=e(86745);function p(u){return F.apply(this,arguments)}function F(){return F=C()(s()().mark(function u(a){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,o.request)("/api/v1/blog/query/org",{method:"GET",params:n()(n()({},a),{},{client:m.bV})}));case 1:case"end":return t.stop()}},u)})),F.apply(this,arguments)}function N(u){return Z.apply(this,arguments)}function Z(){return Z=C()(s()().mark(function u(a){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,o.request)("/api/v1/blog/create",{method:"POST",data:n()(n()({},a),{},{client:m.bV})}));case 1:case"end":return t.stop()}},u)})),Z.apply(this,arguments)}function Q(u){return R.apply(this,arguments)}function R(){return R=C()(s()().mark(function u(a){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,o.request)("/api/v1/blog/update",{method:"POST",data:n()(n()({},a),{},{client:m.bV})}));case 1:case"end":return t.stop()}},u)})),R.apply(this,arguments)}function J(u){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function u(a){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/blog/delete",{method:"POST",data:_objectSpread(_objectSpread({},a),{},{client:HTTP_CLIENT})}));case 1:case"end":return t.stop()}},u)})),A.apply(this,arguments)}var b=e(87676),Y=e(51042),z=e(53719),I=e(14726),O=e(67294),le=e(89102),ue=e(34994),se=e(64317),ie=e(5966),de=e(90672),ce=e(8232),pe=e(85265),ve=e(42075),r=e(85893),me=function(a){var v=a.isEdit,t=a.blog,H=a.open,w=a.onClose,X=a.onSubmit,te=ce.Z.useForm(),k=D()(te,1),W=k[0],L=(0,b.u)(function(g){return g.currentOrg}),re=(0,le.v)(function(g){return g.categorySelectOptions});(0,O.useEffect)(function(){if(v){var g;W.setFieldsValue({type:t==null?void 0:t.type,title:t==null?void 0:t.title,content:t==null?void 0:t.content,categoryUid:t==null||(g=t.category)===null||g===void 0?void 0:g.uid})}else W.resetFields()},[H]);var q=function(P){console.log("category selected ".concat(P))},ae=function(P){console.log("type selected ".concat(P))},U=function(){console.log("handleSubmit"),W.validateFields().then(function(P){console.log(P),X(n()(n()(n()({},t),P),{},{orgUid:L==null?void 0:L.uid}))}).catch(function(P){console.log("Form errors:",P),c.yw.error("\u8BF7\u68C0\u67E5\u8868\u5355\u586B\u5199")})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(pe.Z,{title:v?"\u4FEE\u6539":"\u65B0\u5EFA",onClose:w,open:H,extra:(0,r.jsxs)(ve.Z,{children:[(0,r.jsx)(I.ZP,{onClick:w,children:"\u53D6\u6D88"}),(0,r.jsx)(I.ZP,{onClick:U,type:"primary",children:"\u4FDD\u5B58"})]}),children:(0,r.jsxs)(ue.A,{form:W,initialValues:n()({},t),submitter:{render:function(){return null}},children:[(0,r.jsx)(se.Z,{label:"\u5206\u7C7B",name:"categoryUid",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5206\u7C7B"}],options:re,fieldProps:{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u5206\u7C7B",onChange:q}}),(0,r.jsx)(se.Z,{label:"\u7C7B\u578B",name:"type",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B"}],options:[{label:"\u6587\u672C",value:m.PY},{label:"\u56FE\u7247",value:m.Qm},{label:"\u89C6\u9891",value:m.tV},{label:"\u97F3\u9891",value:m.Yu},{label:"\u6587\u4EF6",value:m.Qn}],fieldProps:{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B",onChange:ae}}),(0,r.jsx)(ie.Z,{label:"\u6807\u9898",name:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}),(0,r.jsx)(de.Z,{label:"\u5185\u5BB9",name:"content"})]})})})},ge=me,he=["current"],fe=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,r.jsx)(o.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"title",copyable:!0},{title:(0,r.jsx)(o.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"content"},{title:(0,r.jsx)(o.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInSearch:!0},{title:(0,r.jsx)(o.FormattedMessage,{id:"category",defaultMessage:"Category"}),dataIndex:"category",hideInSearch:!0,render:function(a,v){var t;return(t=v.category)===null||t===void 0?void 0:t.name}},{title:(0,r.jsx)(o.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180}],Pe=function(){var a=(0,o.useIntl)(),v=(0,O.useRef)(),t=(0,O.useState)(!0),H=D()(t,2),w=H[0],X=H[1],te=(0,O.useState)(),k=D()(te,2),W=k[0],L=k[1],re=(0,O.useState)(!1),q=D()(re,2),ae=q[0],U=q[1],g=(0,b.u)(function(l){return l.currentOrg}),P=[].concat(fe,[{title:a.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,render:function(y,h,T,K){return[(0,r.jsx)("a",{onClick:function(){xe(h)},children:a.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable")]}}]),_=(0,le.v)(function(l){return l.currentCategory}),je=function(){L(void 0),X(!1),U(!0)},xe=function(y){L(y),X(!0),U(!0)},De=function(){var l=C()(s()().mark(function y(h){var T,K;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(console.log("handleSubmitDrawer",h),w?c.yw.loading(a.formatMessage({id:"updating"})):c.yw.loading(a.formatMessage({id:"creating"})),!w){i.next=8;break}return i.next=5,Q(h);case 5:i.t0=i.sent,i.next=11;break;case 8:return i.next=10,N(h);case 10:i.t0=i.sent;case 11:T=i.t0,console.log("createBlog response:",h,T),T.code===200?(c.yw.destroy(),c.yw.loading(a.formatMessage({id:"create.success"})),U(!1),(K=v.current)===null||K===void 0||K.reloadAndRest()):(c.yw.destroy(),c.yw.error(T.message));case 14:case"end":return i.stop()}},y)}));return function(h){return l.apply(this,arguments)}}(),Oe=function(){U(!1)};(0,O.useEffect)(function(){var l;console.log("currentCategory:",_),(l=v.current)===null||l===void 0||l.reloadAndRest()},[_]);var Te=function(){console.log("handleRichEditor"),window.open("/admin/doceditor")};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z.Z,{columns:P,actionRef:v,cardBordered:!0,request:function(){var l=C()(s()().mark(function y(h,T,K){var ne,i,oe,$;return s()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return console.log("request:",h,T,K),c.yw.loading(a.formatMessage({id:"loading",defaultMessage:"Loading"})),ne=h.current,i=x()(h,he),oe=n()({pageNumber:h.current-1,orgUid:g.uid,categoryUid:_.uid==="all"?"":_.uid},i),V.next=6,p(oe);case 6:return $=V.sent,console.log("getAllBlogs response:",oe,$),c.yw.destroy(),$.code===200||c.yw.error($.message),V.abrupt("return",{data:$.data.content,success:!0,total:$.data.totalElements});case 11:case"end":return V.stop()}},y)}));return function(y,h,T){return l.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(y){console.log("page:",y)}},dateFormatter:"string",headerTitle:"\u535A\u5BA2",toolBarRender:function(){return[(0,r.jsx)(I.ZP,{icon:(0,r.jsx)(Y.Z,{}),type:"primary",onClick:Te,children:a.formatMessage({id:"create",defaultMessage:"Create"})},"button")]}}),(0,r.jsx)(ge,{isEdit:w,open:ae,blog:W,onClose:Oe,onSubmit:De})]})},ye=Pe,Ee=e(52670),Ce=f.Z.Sider,Se=f.Z.Content,Me=function(){var a=(0,d.Z)(),v=a.leftSiderStyle,t=a.contentStyle;return(0,r.jsx)("div",{children:(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(Ce,{style:v,children:(0,r.jsx)(Ee.Z,{type:m.qx})}),(0,r.jsx)(f.Z,{children:(0,r.jsx)(Se,{style:t,children:(0,r.jsx)(ye,{})})})]})})},Be=Me}}]);
