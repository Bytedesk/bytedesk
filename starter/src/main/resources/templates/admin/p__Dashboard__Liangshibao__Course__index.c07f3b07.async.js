"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1742],{11475:function(Z,S,e){e.d(S,{Z:function(){return c}});var A=e(1413),n=e(67294),d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},a=d,v=e(89099),l=function(p,y){return n.createElement(v.Z,(0,A.Z)((0,A.Z)({},p),{},{ref:y,icon:a}))},m=n.forwardRef(l),c=m},30300:function(Z,S,e){e.d(S,{FU:function(){return o},O7:function(){return x},k4:function(){return y},yr:function(){return R}});var A=e(15009),n=e.n(A),d=e(97857),a=e.n(d),v=e(99289),l=e.n(v),m=e(85615),c=e(86745);function o(r){return p.apply(this,arguments)}function p(){return p=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/category/query/org",{method:"GET",params:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),p.apply(this,arguments)}function y(r){return f.apply(this,arguments)}function f(){return f=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/category/create",{method:"POST",data:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),f.apply(this,arguments)}function R(r){return E.apply(this,arguments)}function E(){return E=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/category/update",{method:"POST",data:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),E.apply(this,arguments)}function T(r){return b.apply(this,arguments)}function b(){return b=_asyncToGenerator(_regeneratorRuntime().mark(function r(g){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/category/delete",{method:"POST",data:_objectSpread(_objectSpread({},g),{},{client:HTTP_CLIENT})}));case 1:case"end":return t.stop()}},r)})),b.apply(this,arguments)}function K(r){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function r(g){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/category/all",{method:"GET",params:_objectSpread(_objectSpread({},g),{},{client:HTTP_CLIENT})}));case 1:case"end":return t.stop()}},r)})),B.apply(this,arguments)}function x(){return L.apply(this,arguments)}function L(){return L=l()(n()().mark(function r(){return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,c.request)("/visitor/api/v1/category/query",{method:"GET",params:{client:m.bV}}));case 1:case"end":return P.stop()}},r)})),L.apply(this,arguments)}},7420:function(Z,S,e){e.d(S,{$T:function(){return y},A:function(){return K},Hf:function(){return T},P6:function(){return R},gx:function(){return o}});var A=e(15009),n=e.n(A),d=e(97857),a=e.n(d),v=e(99289),l=e.n(v),m=e(85615),c=e(86745);function o(r){return p.apply(this,arguments)}function p(){return p=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/query/org",{method:"GET",params:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),p.apply(this,arguments)}function y(r){return f.apply(this,arguments)}function f(){return f=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/query/user",{method:"GET",params:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),f.apply(this,arguments)}function R(r){return E.apply(this,arguments)}function E(){return E=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/create",{method:"POST",data:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),E.apply(this,arguments)}function T(r){return b.apply(this,arguments)}function b(){return b=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/update",{method:"POST",data:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),b.apply(this,arguments)}function K(r){return B.apply(this,arguments)}function B(){return B=l()(n()().mark(function r(g){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/delete",{method:"POST",data:a()(a()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},r)})),B.apply(this,arguments)}function x(r){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime().mark(function r(g){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/course/filter",{method:"GET",params:_objectSpread(_objectSpread({},g),{},{client:HTTP_CLIENT})}));case 1:case"end":return t.stop()}},r)})),L.apply(this,arguments)}},77154:function(Z,S,e){var A=e(39825);function n(){var d=(0,A.Z)(),a=d.isDarkMode,v=250,l={borderRight:a?"1px solid #333":"1px solid #ccc",background:a?"#141414":"#f5f5f5"},m={background:a?"#141414":"#fff"},c={borderLeft:a?"1px solid #333":"1px solid #ccc",background:a?"#141414":"#f5f5f5"},o={minHeight:120,background:a?"#141414":"#f5f5f5",height:"100vh"};return{leftSiderStyle:l,leftSiderWidth:v,headerStyle:m,rightSiderStyle:c,contentStyle:o}}S.Z=n},83373:function(Z,S,e){e.r(S),e.d(S,{default:function(){return ve}});var A=e(77154),n=e(21612),d=e(67294),a=e(15009),v=e.n(a),l=e(99289),m=e.n(l),c=e(5574),o=e.n(c),p=e(80049),y=e(7420),f=e(89333),R=e(60247),E=e(11475),T=e(51042),b=e(57482),K=e(85576),B=e(14726),x=e(8232),L=e(85265),r=e(42075),g=e(55102),P=e(3303),t=e(34041),ne=e(89102),u=e(85893),le=function(D){var O=D.isEdit,s=D.course,$=D.open,w=D.onClose,H=D.onSubmit,Y=x.Z.useForm(),q=o()(Y,1),W=q[0],G=(0,ne.v)(function(F){return F.categoryTreeOptions});(0,d.useEffect)(function(){if(s&&W){var F,M;W.setFieldsValue({name:s==null?void 0:s.name,description:s==null?void 0:s.description}),W.setFieldsValue({categories:[s==null||(F=s.mainCategory)===null||F===void 0?void 0:F.uid,s==null||(M=s.subCategory)===null||M===void 0?void 0:M.uid]})}else W!=null&&!O&&(console.log("form resetFields"),W.resetFields())},[s]);var ae=function(M){console.log("handleNameChange:",M)},ee=function(M,z){console.log("Cascader value:",M),console.log("Cascader selectedData:",z)},J=function(M){console.log("selected ".concat(M))},Q=function(){console.log("handleSubmit"),W.validateFields().then(function(M){console.log("Form values:",M);var z={uid:s==null?void 0:s.uid,name:M.name,cover:s.cover,description:M.description,detail:s.detail,price:s.price,mainCategory:{uid:M.categories[0]},subCategory:{uid:M.categories[1]},published:M.published==="true"};H(z)}).catch(function(M){console.log("Form errors:",M)})};return(0,u.jsx)("div",{children:(0,u.jsx)(L.Z,{title:O?"\u4FEE\u6539\u8BFE\u7A0B":"\u65B0\u5EFA\u8BFE\u7A0B",onClose:w,open:$,extra:(0,u.jsxs)(r.Z,{children:[(0,u.jsx)(B.ZP,{onClick:w,children:"\u53D6\u6D88"}),(0,u.jsx)(B.ZP,{onClick:Q,type:"primary",children:"\u4FDD\u5B58"})]}),children:(0,u.jsxs)(x.Z,{form:W,children:[(0,u.jsx)(x.Z.Item,{name:"name",label:"\u8BFE\u7A0B\u540D\u79F0",initialValue:s==null?void 0:s.name,children:(0,u.jsx)(g.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0"})}),(0,u.jsx)(x.Z.Item,{name:"categories",label:"\u8BFE\u7A0B\u5206\u7C7B",children:(0,u.jsx)(P.Z,{options:G,onChange:ee,placeholder:"\u9009\u62E9\u5206\u7C7B"})}),(0,u.jsx)(x.Z.Item,{name:"description",label:"\u8BFE\u7A0B\u63CF\u8FF0",initialValue:s==null?void 0:s.description,children:(0,u.jsx)(g.Z.TextArea,{placeholder:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u63CF\u8FF0"})}),(0,u.jsx)(x.Z.Item,{name:"published",label:"\u8BFE\u7A0B\u72B6\u6001",initialValue:s!=null&&s.published?"true":"false",children:(0,u.jsx)(t.default,{style:{width:120},onChange:J,options:[{value:"true",label:"\u5DF2\u53D1\u5E03"},{value:"false",label:"\u672A\u53D1\u5E03"}]})})]})})})},de=le,ce=e(30300),V=e(86745),_e=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5C01\u9762",dataIndex:"cover",render:function(D,O){return(0,u.jsx)("a",{href:O.cover,target:"_blank",children:(0,u.jsx)("img",{src:O.cover,width:"40",height:"40"})})}},{title:(0,u.jsx)(V.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"name",copyable:!0},{title:(0,u.jsx)(V.FormattedMessage,{id:"category",defaultMessage:"Category"}),key:"category",render:function(D,O){var s=O.mainCategory?O.mainCategory.name:"-",$=O.subCategory?O.subCategory.name:"-";return(0,u.jsxs)("span",{children:[s," / ",$]})}},{title:"\u57CE\u5E02",dataIndex:"city",render:function(D,O){return O.city?O.city.name:"-"}},{title:"\u53D1\u5E03\u4EBA",editable:!1,renderText:function(D,O,s,$){var w;return(w=O.user)===null||w===void 0?void 0:w.nickname}},{title:(0,u.jsx)(V.FormattedMessage,{id:"status",defaultMessage:"Status"}),key:"published",render:function(D,O){return O.published?"\u5DF2\u53D1\u5E03":"\u672A\u53D1\u5E03"}},{title:(0,u.jsx)(V.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",editable:!1,sorter:!0,hideInSearch:!0}],me=function(){var D=(0,V.useIntl)(),O=(0,R.L)(function(_){return _.userInfo}),s=(0,d.useRef)(),$=(0,d.useState)(1),w=o()($,2),H=w[0],Y=w[1],q=(0,d.useState)(10),W=o()(q,2),G=W[0],ae=W[1],ee=(0,d.useState)(!0),J=o()(ee,2),Q=J[0],F=J[1],M=(0,d.useState)(),z=o()(M,2),he=z[0],se=z[1],N=(0,f.K)(function(_){return{courseResult:_.courseResult,insertCourseResult:_.insertCourseResult,updateCourseResult:_.updateCourseResult,deleteCourseResult:_.deleteCourseResult,setCourseResult:_.setCourseResult}}),X=N.courseResult,Ce=N.insertCourseResult,ye=N.updateCourseResult,Ee=N.deleteCourseResult,be=N.setCourseResult,De=(0,ne.v)(function(_){return _.setCategoryResult}),Oe=(0,d.useState)(!1),ue=o()(Oe,2),Me=ue[0],te=ue[1],je=K.Z.useModal(),oe=o()(je,2),Re=oe[0],Te=oe[1],Pe=function(h){Re.confirm({title:D.formatMessage({id:"deleteTip"}),icon:(0,u.jsx)(E.Z,{}),content:"".concat(D.formatMessage({id:"deleteAfirm",defaultMessage:"Delete"}),"\u3010").concat(h.name,"\u3011\uFF1F"),onOk:function(){Be(h)},onCancel:function(){},okText:D.formatMessage({id:"ok"}),cancelText:D.formatMessage({id:"cancel"})})},Se=function(){se(void 0),F(!1),te(!0)},Ae=function(h){se(h),F(!0),te(!0)},re=function(){te(!1)},Ue=function(){var _=m()(v()().mark(function h(i){var j,U;return v()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(console.log("handleSubmitDrawer:",i),!Q){I.next=9;break}return I.next=4,(0,y.Hf)(i);case 4:j=I.sent,console.log("updateCourse:",j),j.code===200?(p.yw.success("\u66F4\u65B0\u6210\u529F"),ye(j.data),re()):p.yw.error(j.message),I.next=14;break;case 9:return I.next=11,(0,y.P6)(i);case 11:U=I.sent,console.log("createCourse:",U),U.code===200?(p.yw.success(D.formatMessage({id:"create.success",defaultMessage:"create success"})),Ce(U.data),re()):p.yw.error(U.message);case 14:case"end":return I.stop()}},h)}));return function(i){return _.apply(this,arguments)}}(),Be=function(){var _=m()(v()().mark(function h(i){var j;return v()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return console.log("handleDeleteCourse:",i),C.next=3,(0,y.A)(i);case 3:j=C.sent,j.code===200?Ee(i):p.yw.error(j.message);case 5:case"end":return C.stop()}},h)}));return function(i){return _.apply(this,arguments)}}(),Ie=[].concat(_e,[{title:D.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",render:function(h,i,j,U){return[(0,u.jsx)("a",{onClick:function(){console.log("edit record:",i),Ae(i)},children:D.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,u.jsx)(B.ZP,{size:"small",type:"link",onClick:function(){return Pe(i)},danger:!0,children:"\u5220\u9664"},"delete")]}}]),ie=function(){var _=m()(v()().mark(function h(){var i,j;return v()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(i={pageNumber:H-1,pageSize:G},!O.superUser){C.next=7;break}return C.next=4,(0,y.gx)(i);case 4:C.t0=C.sent,C.next=10;break;case 7:return C.next=9,(0,y.$T)(i);case 9:C.t0=C.sent;case 10:j=C.t0,console.log("getAllCourses response:",i,j),j.code===200?be(j):p.yw.error(j.message);case 13:case"end":return C.stop()}},h)}));return function(){return _.apply(this,arguments)}}(),xe=function(){var _=m()(v()().mark(function h(){var i;return v()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,(0,ce.O7)();case 2:i=U.sent,console.log("getAllCategories response:",i),i.code===200?De(i):p.yw.error(i.message);case 5:case"end":return U.stop()}},h)}));return function(){return _.apply(this,arguments)}}();return(0,d.useEffect)(function(){ie(),xe()},[]),(0,d.useEffect)(function(){ie()},[H,G]),(0,d.useEffect)(function(){console.log("courseResult:",X),s.current.reload()},[X]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(b.Z,{columns:Ie,actionRef:s,cardBordered:!0,request:function(){var _=m()(v()().mark(function h(i,j,U){return v()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return console.log("request:",i,j,U),Y(i.current),ae(i.pageSize),I.abrupt("return",Promise.resolve({data:X.data.content,success:!0,total:X.data.totalElements}));case 4:case"end":return I.stop()}},h)}));return function(h,i,j){return _.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:G,showQuickJumper:!0,onChange:function(h){console.log("page:",h)}},dateFormatter:"string",headerTitle:"\u8BFE\u7A0B",toolBarRender:function(){return[(0,u.jsxs)(B.ZP,{type:"primary",onClick:Se,children:[(0,u.jsx)(T.Z,{}),D.formatMessage({id:"create",defaultMessage:"Create"})]})]}}),(0,u.jsx)(de,{isEdit:Q,course:he,open:Me,onClose:re,onSubmit:Ue}),Te]})},pe=me,Fe=n.Z.Sider,fe=n.Z.Content,ge=function(){var D=(0,A.Z)(),O=D.contentStyle;return(0,u.jsx)(n.Z,{children:(0,u.jsx)(n.Z,{children:(0,u.jsx)(fe,{style:O,children:(0,u.jsx)(pe,{})})})})},ve=ge},89102:function(Z,S,e){e.d(S,{v:function(){return o}});var A=e(19632),n=e.n(A),d=e(97857),a=e.n(d),v=e(85615),l=e(73445),m=e(782),c=e(18753),o=(0,l.Ue)()((0,m.mW)((0,m.tJ)((0,c.n)(function(f,R){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:""},setCategoryResult:function(T){var b,K=y(T),B={uid:"all",name:"All"},x=a()(a()({},T),{},{data:{content:[B].concat(n()(T.data.content))}}),L=p(x);f({categoryResult:x,categoryTreeOptions:L,categorySelectOptions:K}),((b=T.data)===null||b===void 0||(b=b.content)===null||b===void 0?void 0:b.length)>0?f({currentCategory:T.data.content[0]}):f({currentCategory:{uid:""}})},setCurrentCategoryUid:function(T){var b=R().categoryResult.data.content.find(function(K){return K.uid===T});f({currentCategory:b})},deleteCategoryCache:function(){return f({},!0)}}}),{name:v.OM})));function p(f){var R=[];return f.data.content.forEach(function(E){var T={title:E.name,key:E.uid,children:[]};E.children&&Array.isArray(E.children)&&(T.children=E.children.map(function(b){return{title:b.name,key:b.uid,children:[]}})),R.push(T)}),R}function y(f){var R=[];return f.data.content.forEach(function(E){var T={label:E.name,value:E.uid};R.push(T)}),R}},89333:function(Z,S,e){e.d(S,{K:function(){return v}});var A=e(85615),n=e(73445),d=e(782),a=e(18753),v=(0,n.Ue)()((0,d.mW)((0,d.tJ)((0,a.n)(function(l,m){return{courseResult:{data:{content:[]}},insertCourseResult:function(o){l(function(p){var y=p.courseResult.data.content;y.unshift(o)})},updateCourseResult:function(o){l(function(p){var y=p.courseResult.data.content,f=y.findIndex(function(R){return R.uid===o.uid});f!==-1?y[f]=o:console.warn("Course with uid ".concat(o.uid," not found."))})},deleteCourseResult:function(o){l(function(p){var y=p.courseResult.data.content,f=y.findIndex(function(R){return R.uid===o.uid});f!==-1?y.splice(f,1):console.warn("Course with uid ".concat(o.uid," not found."))})},setCourseResult:function(o){l({courseResult:o})},deleteCourseCache:function(){return l({},!0)}}}),{name:A.vC})))},60247:function(Z,S,e){e.d(S,{L:function(){return v}});var A=e(85615),n=e(73445),d=e(782),a=e(18753),v=(0,n.Ue)()((0,d.mW)((0,d.tJ)((0,a.n)(function(l,m){return{userInfo:{uid:""},deviceUid:"",setUserInfo:function(o){l({userInfo:o})},setDeviceUid:function(o){l({deviceUid:o})},deleteUserInfo:function(){return l({},!0)}}}),{name:A.Em})))}}]);
