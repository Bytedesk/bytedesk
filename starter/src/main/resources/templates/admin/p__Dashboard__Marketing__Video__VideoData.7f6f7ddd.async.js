"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1426],{84881:function(e,t,n){var r=n(17082),o=n(51190),a=n(82308),i=n(44194),l=n(63653),u=n(86001),s=n(31549),d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var n=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,g=e.mode,h=e.valueEnum,v=e.request,y=e.showSearch,m=e.options,x=(0,o.Z)(e,d),Z=(0,i.useContext)(l.Z);return(0,s.jsx)(u.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,a.h)(h),request:v,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({options:m,mode:g,showSearch:y,getPopupContainer:Z.getPopupContainer},n),ref:t,proFieldProps:f},x),{},{children:c}))},f=i.forwardRef((function(e,t){var n=e.fieldProps,d=e.children,p=e.params,f=e.proFieldProps,g=e.mode,h=e.valueEnum,v=e.request,y=e.options,m=(0,o.Z)(e,c),x=(0,r.Z)({options:y,mode:g||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},n),Z=(0,i.useContext)(l.Z);return(0,s.jsx)(u.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,a.h)(h),request:v,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({getPopupContainer:Z.getPopupContainer},x),ref:t,proFieldProps:f},m),{},{children:d}))})),g=i.forwardRef(p);g.SearchSelect=f,g.displayName="ProFormComponent",t.Z=g},4499:function(e,t,n){var r=n(42601),o=n(17082),a=n(51190),i=n(46015),l=n(3909),u=n(98036),s=n(36490),d=n(44194),c=n(86001),p=n(31549),f=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],h="text",v=function(e){var t=(0,i.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),n=(0,r.Z)(t,2),a=n[0],s=n[1];return(0,p.jsx)(l.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var n,r=t.getFieldValue(e.name||[]);return(0,p.jsx)(u.Z,(0,o.Z)((0,o.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return s(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(n=e.statusRender)||void 0===n?void 0:n.call(e,r),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:a,children:e.children}))}})},y=function(e){var t=e.fieldProps,n=e.proFieldProps,r=(0,a.Z)(e,f);return(0,p.jsx)(c.Z,(0,o.Z)({valueType:h,fieldProps:t,filedConfig:{valueType:h},proFieldProps:n},r))};y.Password=function(e){var t=e.fieldProps,n=e.proFieldProps,i=(0,a.Z)(e,g),l=(0,d.useState)(!1),u=(0,r.Z)(l,2),f=u[0],y=u[1];return null!=t&&t.statusRender&&i.name?(0,p.jsx)(v,{name:i.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:y,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,o.Z)({valueType:"password",fieldProps:(0,o.Z)((0,o.Z)({},(0,s.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var n;null==t||null===(n=t.onBlur)||void 0===n||n.call(t,e),y(!1)},onClick:function(e){var n;null==t||null===(n=t.onClick)||void 0===n||n.call(t,e),y(!0)}}),proFieldProps:n,filedConfig:{valueType:h}},i))})}):(0,p.jsx)(c.Z,(0,o.Z)({valueType:"password",fieldProps:t,proFieldProps:n,filedConfig:{valueType:h}},i))},y.displayName="ProFormComponent",t.Z=y},32350:function(e,t,n){var r=n(17082),o=n(51190),a=n(44194),i=n(86001),l=n(31549),u=["fieldProps","proFieldProps"],s=function(e,t){var n=e.fieldProps,a=e.proFieldProps,s=(0,o.Z)(e,u);return(0,l.jsx)(i.Z,(0,r.Z)({ref:t,valueType:"textarea",fieldProps:n,proFieldProps:a},s))};t.Z=a.forwardRef(s)},46331:function(e,t,n){n.d(t,{BF:function(){return c},Vh:function(){return f},zZ:function(){return h}});var r=n(90819),o=n.n(r),a=n(73193),i=n.n(a),l=n(89933),u=n.n(l),s=n(90069),d=n(30921);function c(e){return p.apply(this,arguments)}function p(){return(p=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/blog/query/org",{method:"GET",params:i()(i()({},t),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/blog/create",{method:"POST",data:i()(i()({},t),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/blog/update",{method:"POST",data:i()(i()({},t),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},96865:function(e,t,n){var r=n(23864);t.Z=function(){var e=(0,r.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"}}}},64031:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(96865),o=n(75574),a=n(73193),i=n.n(a),l=n(84176),u=n.n(l),s=n(90819),d=n.n(s),c=n(89933),p=n.n(c),f=n(45332),g=n.n(f),h=n(86803),v=n(46331),y=n(40612),m=n(31816),x=n(19513),Z=n(75365),C=n(44194),P=n(90838),b=n(90069),w=n(99811),j=n(84881),S=n(4499),F=n(32350),k=n(3909),T=n(73442),M=n(3849),R=n(31549),E=function(e){var t=e.isEdit,n=e.blog,r=e.open,o=e.onClose,a=e.onSubmit,l=k.Z.useForm(),u=g()(l,1)[0],s=(0,y.u)((function(e){return e.currentOrg})),d=(0,P.v)((function(e){return e.categorySelectOptions}));(0,C.useEffect)((function(){var e;t?u.setFieldsValue({type:null==n?void 0:n.type,title:null==n?void 0:n.title,content:null==n?void 0:n.content,categoryUid:null==n||null===(e=n.category)||void 0===e?void 0:e.uid}):u.resetFields()}),[r]);return(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(T.Z,{title:t?"修改":"新建",onClose:o,open:r,extra:(0,R.jsxs)(M.Z,{children:[(0,R.jsx)(Z.ZP,{onClick:o,children:"取消"}),(0,R.jsx)(Z.ZP,{onClick:function(){console.log("handleSubmit"),u.validateFields().then((function(e){console.log(e),a(i()(i()(i()({},n),e),{},{orgUid:null==s?void 0:s.uid}))})).catch((function(e){console.log("Form errors:",e),h.yw.error("请检查表单填写")}))},type:"primary",children:"保存"})]}),children:(0,R.jsxs)(w.A,{form:u,initialValues:i()({},n),submitter:{render:function(){return null}},children:[(0,R.jsx)(j.Z,{label:"分类",name:"categoryUid",rules:[{required:!0,message:"请选择分类"}],options:d,fieldProps:{allowClear:!0,placeholder:"请选择分类",onChange:function(e){console.log("category selected ".concat(e))}}}),(0,R.jsx)(j.Z,{label:"类型",name:"type",rules:[{required:!0,message:"请选择类型"}],options:[{label:"文本",value:b.PYi},{label:"图片",value:b.Qm,disabled:!0},{label:"视频",value:b.tVi,disabled:!0},{label:"音频",value:b.Yu1,disabled:!0},{label:"文件",value:b.Qn,disabled:!0}],fieldProps:{allowClear:!0,placeholder:"请选择类型",onChange:function(e){console.log("type selected ".concat(e))}}}),(0,R.jsx)(S.Z,{label:"标题",name:"title",rules:[{required:!0,message:"请输入标题"}]}),(0,R.jsx)(F.Z,{label:"内容",name:"content"})]})})})},q=n(30921),I=["current"],A=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,R.jsx)(q.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"title",copyable:!0},{title:(0,R.jsx)(q.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"content"},{title:(0,R.jsx)(q.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInSearch:!0},{title:(0,R.jsx)(q.FormattedMessage,{id:"category",defaultMessage:"Category"}),dataIndex:"category",hideInSearch:!0,render:function(e,t){var n;return null===(n=t.category)||void 0===n?void 0:n.name}},{title:(0,R.jsx)(q.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180}],O=function(){var e=(0,q.useIntl)(),t=(0,C.useRef)(),n=(0,C.useState)(!0),r=g()(n,2),o=r[0],a=r[1],l=(0,C.useState)(),s=g()(l,2),c=s[0],f=s[1],b=(0,C.useState)(!1),w=g()(b,2),j=w[0],S=w[1],F=(0,y.u)((function(e){return e.currentOrg})),k=[].concat(A,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,render:function(t,n,r,o){return[(0,R.jsx)("a",{onClick:function(){M(n)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable")]}}]),T=(0,P.v)((function(e){return e.currentCategory})),M=function(e){f(e),a(!0),S(!0)},O=function(){var n=p()(d()().mark((function n(r){var a,i;return d()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("handleSubmitDrawer",r),o?h.yw.loading(e.formatMessage({id:"updating"})):h.yw.loading(e.formatMessage({id:"creating"})),!o){n.next=8;break}return n.next=5,(0,v.zZ)(r);case 5:n.t0=n.sent,n.next=11;break;case 8:return n.next=10,(0,v.Vh)(r);case 10:n.t0=n.sent;case 11:a=n.t0,console.log("createBlog response:",r,a),200===a.code?(h.yw.destroy(),h.yw.loading(e.formatMessage({id:"create.success"})),S(!1),null===(i=t.current)||void 0===i||i.reloadAndRest()):(h.yw.destroy(),h.yw.error(a.message));case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();(0,C.useEffect)((function(){var e;console.log("currentCategory:",T),null===(e=t.current)||void 0===e||e.reloadAndRest()}),[T]);var V=function(){console.log("handleRichEditor"),window.open("/admin/doceditor")};return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(x.Z,{columns:k,actionRef:t,cardBordered:!0,request:function(){var t=p()(d()().mark((function t(n,r,o){var a,l,s;return d()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",n,r,o),h.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),n.current,a=u()(n,I),l=i()({pageNumber:n.current-1,orgUid:null==F?void 0:F.uid,categoryUid:"all"===T.uid?"":T.uid},a),t.next=6,(0,v.BF)(l);case 6:return s=t.sent,console.log("getAllBlogs response:",l,s),h.yw.destroy(),200===s.code||h.yw.error(s.message),t.abrupt("return",{data:s.data.content,success:!0,total:s.data.totalElements});case 11:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"AI生成，并同步到各大社交媒体平台",toolBarRender:function(){return[(0,R.jsx)(Z.ZP,{icon:(0,R.jsx)(m.Z,{}),type:"primary",onClick:V,children:e.formatMessage({id:"create",defaultMessage:"Create"})},"button")]}}),(0,R.jsx)(E,{isEdit:o,open:j,blog:c,onClose:function(){S(!1)},onSubmit:O})]})},V=o.Z.Sider,B=o.Z.Content,U=function(){var e=(0,r.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,R.jsx)("div",{children:(0,R.jsxs)(o.Z,{children:[(0,R.jsx)(V,{style:t}),(0,R.jsx)(o.Z,{children:(0,R.jsx)(B,{style:n,children:(0,R.jsx)(O,{})})})]})})}},90838:function(e,t,n){n.d(t,{v:function(){return c}});var r=n(76711),o=n.n(r),a=n(73193),i=n.n(a),l=n(90069),u=n(39701),s=n(83642),d=n(41617),c=(0,u.Ue)()((0,s.mW)((0,s.tJ)((0,d.n)((function(e,t){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:""},setCategoryResult:function(t){var n,r=function(e){var t=[];return e.data.content.forEach((function(e){var n={label:e.name,value:e.uid};t.push(n)})),t}(t),a=i()(i()({},t),{},{data:{content:[{uid:"all",name:"All"}].concat(o()(t.data.content))}}),l=function(e){var t=[];return e.data.content.forEach((function(e){var n={title:e.name,key:e.uid,children:[]};e.children&&Array.isArray(e.children)&&(n.children=e.children.map((function(e){return{title:e.name,key:e.uid,children:[]}}))),t.push(n)})),t}(a);e({categoryResult:a,categoryTreeOptions:l,categorySelectOptions:r}),(null===(n=t.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.length)>0?e({currentCategory:t.data.content[0]}):e({currentCategory:{uid:""}})},insertCategory:function(t){e((function(e){e.categoryResult.data.content.unshift(t)}))},upgradeCategory:function(t){e((function(e){var n=e.categoryResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n[r]=t:console.warn("Category with uid ".concat(t.uid," not found."))}))},setCurrentCategory:function(t){e({currentCategory:t})},setCurrentCategoryUid:function(n){var r=t().categoryResult.data.content.find((function(e){return e.uid===n}));e({currentCategory:r})},deleteCategoryCache:function(){return e({},!0)}}})),{name:l.OMm})))}}]);