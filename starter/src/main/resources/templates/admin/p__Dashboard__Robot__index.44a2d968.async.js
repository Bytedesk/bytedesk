"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6693],{9465:function(Ce,ae,t){t.d(ae,{Ck:function(){return G},qL:function(){return F},z4:function(){return le}});var re=t(15009),a=t.n(re),de=t(97857),i=t.n(de),se=t(99289),O=t.n(se),ee=t(85615),h=t(86745);function F(v){return H.apply(this,arguments)}function H(){return H=O()(a()().mark(function v(Y){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.request)("/api/v1/quickbutton/query/org",{method:"GET",params:i()(i()({},Y),{},{client:ee.bV})}));case 1:case"end":return u.stop()}},v)})),H.apply(this,arguments)}function le(v){return g.apply(this,arguments)}function g(){return g=O()(a()().mark(function v(Y){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.request)("/api/v1/quickbutton/create",{method:"POST",data:i()(i()({},Y),{},{client:ee.bV})}));case 1:case"end":return u.stop()}},v)})),g.apply(this,arguments)}function G(v){return W.apply(this,arguments)}function W(){return W=O()(a()().mark(function v(Y){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.request)("/api/v1/quickbutton/update",{method:"POST",data:i()(i()({},Y),{},{client:ee.bV})}));case 1:case"end":return u.stop()}},v)})),W.apply(this,arguments)}function Q(v){return te.apply(this,arguments)}function te(){return te=_asyncToGenerator(_regeneratorRuntime().mark(function v(Y){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",request("/api/v1/quickbutton/delete",{method:"POST",data:_objectSpread(_objectSpread({},Y),{},{client:HTTP_CLIENT})}));case 1:case"end":return u.stop()}},v)})),te.apply(this,arguments)}},76545:function(Ce,ae,t){t.d(ae,{$l:function(){return G},gf:function(){return Q},lg:function(){return le},p0:function(){return F}});var re=t(15009),a=t.n(re),de=t(97857),i=t.n(de),se=t(99289),O=t.n(se),ee=t(85615),h=t(86745);function F(v){return H.apply(this,arguments)}function H(){return H=O()(a()().mark(function v(Y){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.request)("/api/v1/robot/query/org",{method:"GET",params:i()(i()({},Y),{},{client:ee.bV})}));case 1:case"end":return u.stop()}},v)})),H.apply(this,arguments)}function le(v){return g.apply(this,arguments)}function g(){return g=O()(a()().mark(function v(Y){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.request)("/api/v1/robot/create",{method:"POST",data:i()(i()({},Y),{},{client:ee.bV})}));case 1:case"end":return u.stop()}},v)})),g.apply(this,arguments)}function G(v){return W.apply(this,arguments)}function W(){return W=O()(a()().mark(function v(Y){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.request)("/api/v1/robot/update",{method:"POST",data:i()(i()({},Y),{},{client:ee.bV})}));case 1:case"end":return u.stop()}},v)})),W.apply(this,arguments)}function Q(v){return te.apply(this,arguments)}function te(){return te=O()(a()().mark(function v(Y){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.request)("/api/v1/robot/delete",{method:"POST",data:i()(i()({},Y),{},{client:ee.bV})}));case 1:case"end":return u.stop()}},v)})),te.apply(this,arguments)}},77154:function(Ce,ae,t){var re=t(39825);function a(){var de=(0,re.Z)(),i=de.isDarkMode,se={borderRight:i?"1px solid #333":"1px solid #ccc",background:i?"#141414":"#f5f5f5"},O={background:i?"#141414":"#fff"},ee={borderLeft:i?"1px solid #333":"1px solid #ccc",background:i?"#141414":"#f5f5f5"},h={minHeight:120,background:i?"#141414":"#f5f5f5"};return{leftSiderStyle:se,headerStyle:O,rightSiderStyle:ee,contentStyle:h}}ae.Z=a},73803:function(Ce,ae,t){var re=t(85615),a=t(66419),de=t(86745);function i(){var se=(0,de.useIntl)(),O=function(F){return F&&F.startsWith(re.Vo)?se.formatMessage({id:F,defaultMessage:F}):F},ee=function(F){return F!=null&&F.startsWith(re.Vo)?(0,a.aS)(se.formatMessage({id:F}),10):(0,a.aS)(F,10)};return{translateString:O,translateStringTranct:ee}}ae.Z=i},26886:function(Ce,ae,t){t.r(ae),t.d(ae,{default:function(){return Nt}});var re=t(21612),a=t(67294),de=t(15009),i=t.n(de),se=t(99289),O=t.n(se),ee=t(5574),h=t.n(ee),F=t(37326),H=t(85576),le=t(86250),g=t(14726),G=t(2487),W=t(7134),Q=t(11475),te=t(64789),v=t(86745),Y=t(39825),$=t(87676),u=t(85615),pe=t(34994),Ve=t(5966),xe=t(64317),ne=t(8232),e=t(85893),Ye=function(n){var s=n.open,r=n.onClose,o=n.onSubmit,c=ne.Z.useForm(),d=h()(c,1),R=d[0],m=(0,$.u)(function(C){return C.orgCurrent}),p=function(){console.log("handleSaveRobot"),R.validateFields().then(function(x){console.log("handleSaveRobot values:",x);var q={nickname:x.nickname,type:x.type,orgUid:m.uid};console.log("robotObject:",q),o(q)}).catch(function(x){console.log("Form errors:",x)})},D=function(){r()},Z=[{title:"\u5BA2\u670D\u673A\u5668\u4EBA",value:u.f4},{title:"\u8425\u9500\u673A\u5668\u4EBA(\u5F00\u53D1\u4E2D...)",value:u.wG}],I=function(x){console.log("onTreeSelectChange:",x)};return(0,e.jsx)("div",{children:(0,e.jsx)(H.Z,{title:"\u65B0\u5EFA\u673A\u5668\u4EBA",open:s,okText:"\u4FDD\u5B58",onOk:p,onCancel:D,children:(0,e.jsxs)(pe.A,{form:R,name:"basic",style:{maxWidth:400},submitter:!1,children:[(0,e.jsx)(Ve.Z,{label:"\u6635\u79F0",name:"nickname"}),(0,e.jsx)(xe.Z,{label:"\u7C7B\u578B",name:["type"],options:[{label:"\u5BA2\u670D\u673A\u5668\u4EBA",value:u.f4},{label:"\u8425\u9500\u673A\u5668\u4EBA(\u5F00\u53D1\u4E2D...)",value:u.wG}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B!"}],fieldProps:{placeholder:"\u9009\u62E9\u7C7B\u578B",onChange:I,allowClear:!0}})]})})})},Je=Ye,Fe=t(76545),V=t(80049),Ee=t(73803),Xe=function(){var n=(0,Y.Z)(),s=n.isDarkMode,r=(0,v.useIntl)(),o=(0,a.useRef)(!1),c=(0,Ee.Z)(),d=c.translateString,R=c.translateStringTranct,m=(0,F.V)(function(B){return{robotResult:B.robotResult,currentRobot:B.currentRobot,insertRobot:B.insertRobot,deleteCurrentRobot:B.deleteCurrentRobot,setRobotResult:B.setRobotResult,setCurrentRobot:B.setCurrentRobot}}),p=m.robotResult,D=m.currentRobot,Z=m.insertRobot,I=m.deleteCurrentRobot,C=m.setRobotResult,x=m.setCurrentRobot,q=(0,$.u)(function(B){return B.orgCurrent}),j=H.Z.useModal(),f=h()(j,2),K=f[0],A=f[1],U=function(w){K.confirm({title:r.formatMessage({id:"deleteTip"}),icon:(0,e.jsx)(Q.Z,{}),content:"\u786E\u8BA4\u8981\u5220\u9664\u673A\u5668\u4EBA\u3010".concat(d(w.nickname),"\u3011\u5417\uFF1F"),onOk:function(){console.log("\u786E\u8BA4\u5220\u9664"),P(w)},onCancel:function(){console.log("\u53D6\u6D88\u5220\u9664")},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"})})},P=function(){var B=O()(i()().mark(function w(N){var J;return i()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return console.log("delete robot",N),z.next=3,(0,Fe.gf)(N);case 3:J=z.sent,console.log("delete robot response",J),J.code===200?(V.yw.success("\u5220\u9664\u5BA2\u670D\u6210\u529F"),I(N.uid)):V.yw.error(J.message);case 6:case"end":return z.stop()}},w)}));return function(N){return B.apply(this,arguments)}}(),b=function(){var B=O()(i()().mark(function w(){var N,J;return i()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!o.current){z.next=3;break}return console.log("isLoading: 1",o.current),z.abrupt("return");case 3:return o.current=!0,V.yw.loading("loading"),N={pageNumber:0,pageSize:50,orgUid:q.uid},z.next=8,(0,Fe.p0)(N);case 8:J=z.sent,console.log("queryRobotsByOrg: ",J),J.code===200?C(J):V.yw.error(J.message),o.current=!1,V.yw.destroy();case 13:case"end":return z.stop()}},w)}));return function(){return B.apply(this,arguments)}}();(0,a.useEffect)(function(){console.log("getRobots"),b()},[]);var S=(0,a.useState)(!1),y=h()(S,2),E=y[0],M=y[1],k=function(){M(!0)},T=function(){var B=O()(i()().mark(function w(N){var J;return i()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return V.yw.loading("creating..."),z.next=3,(0,Fe.lg)(N);case 3:J=z.sent,console.log("handleSaveRobot response:",J),J.code===200?(V.yw.success(r.formatMessage({id:"create.success"})),Z(J.data),M(!1)):V.yw.error(J.message),V.yw.destroy();case 7:case"end":return z.stop()}},w)}));return function(N){return B.apply(this,arguments)}}(),oe=function(){M(!1)},ie=function(){k()},be=function(w,N){x(w)},ve=function(w){return(w==null?void 0:w.type)===u.f4?"\u5BA2\u670D\u673A\u5668\u4EBA":(w==null?void 0:w.type)===u.wG?"\u8425\u9500\u673A\u5668\u4EBA":w==null?void 0:w.type};return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{margin:10},children:(0,e.jsxs)(le.Z,{gap:"small",align:"flex-start",children:[(0,e.jsx)(g.ZP,{size:"small",type:"primary",icon:(0,e.jsx)(te.Z,{}),onClick:ie,children:r.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,e.jsx)(g.ZP,{size:"small",onClick:b,children:r.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,e.jsx)(g.ZP,{onClick:function(){return U(D)},size:"small",style:{float:"right"},danger:!0,disabled:(D==null?void 0:D.uid)==="",children:r.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]})}),(0,e.jsx)(G.Z,{itemLayout:"horizontal",dataSource:p.data.content,renderItem:function(w,N){return(0,e.jsx)(G.Z.Item,{style:(D==null?void 0:D.uid)===w.uid?{backgroundColor:s?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){return be(w,N)},children:(0,e.jsx)(G.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,e.jsx)(W.C,{src:w.avatar}),title:(0,e.jsx)(e.Fragment,{children:R(w==null?void 0:w.nickname)}),description:ve(w)})})}}),(0,e.jsx)(Je,{open:E,onClose:oe,onSubmit:T}),A]})},qe=Xe,Se=t(96087),We=t(85322),et=t(9220),tt=t(97857),me=t.n(tt),nt=t(66723),ze=t(88484),je=t(90672),rt=function(){var l,n=ne.Z.useForm(),s=h()(n,1),r=s[0],o=(0,v.useIntl)(),c=(0,Ee.Z)(),d=c.translateString,R=(0,F.V)(function(K){return{currentRobot:K.currentRobot,setCurrentRobot:K.setCurrentRobot}}),m=R.currentRobot,p=R.setCurrentRobot,D=(0,a.useState)(""),Z=h()(D,2),I=Z[0],C=Z[1];(0,a.useEffect)(function(){var K=F.V.subscribe(function(A,U){var P,b,S;r.setFieldValue("nickname",d((P=A.currentRobot)===null||P===void 0?void 0:P.nickname)),r.setFieldValue("welcomeTip",d((b=A.currentRobot)===null||b===void 0||(b=b.serviceSettings)===null||b===void 0?void 0:b.welcomeTip)),r.setFieldValue("description",d((S=A.currentRobot)===null||S===void 0?void 0:S.description))});return K},[m]);var x=function(){var K=O()(i()().mark(function A(U){var P,b;return i()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log("onFinish:",U),V.yw.loading("\u6B63\u5728\u4FEE\u6539"),P=me()(me()(me()({},m),U),{},{avatar:I}),console.log("robotObject:",P),y.next=6,(0,Fe.$l)(P);case 6:b=y.sent,console.log("updateRobot response:",b),b.code===200?(V.yw.success(o.formatMessage({id:"update.success"})),p(b.data)):V.yw.error(b.message),V.yw.destroy();case 10:case"end":return y.stop()}},A)}));return function(U){return K.apply(this,arguments)}}(),q=function(A){console.log("handleUploadSuccess:",A),C(A)},j=function(A){console.log("handleUploadError:",A)},f=function(A){return console.log("Upload event:",A),Array.isArray(A)?A:A==null?void 0:A.fileList};return(0,a.useEffect)(function(){C(m==null?void 0:m.avatar)},[m]),(0,e.jsxs)(pe.A,{form:r,onFinish:x,initialValues:{nickname:d(m==null?void 0:m.nickname),welcomeTip:d(m==null||(l=m.serviceSettings)===null||l===void 0?void 0:l.welcomeTip),description:d(m==null?void 0:m.description)},children:[(0,e.jsx)(ne.Z.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:f,label:o.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,e.jsxs)(nt.G,{onSuccess:q,onError:j,children:[(0,e.jsx)(W.C,{src:I}),(0,e.jsx)(g.ZP,{icon:(0,e.jsx)(ze.Z,{}),children:o.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,e.jsx)(Ve.Z,{width:"md",name:"nickname",label:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),tooltip:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),placeholder:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),rules:[{required:!0,message:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"})}]}),(0,e.jsx)(je.Z,{width:"md",name:"welcomeTip",label:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),tooltip:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),placeholder:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),rules:[{required:!0,message:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"})}]}),(0,e.jsx)(je.Z,{width:"md",name:"description",label:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),tooltip:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),placeholder:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),rules:[{required:!0,message:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"})}]})]})},ot=function(){var n=(0,v.useIntl)(),s=(0,a.useState)(!1),r=h()(s,2),o=r[0],c=r[1],d=(0,F.V)(function(R){return R.currentRobot});return(0,e.jsx)(et.Z,{onResize:function(m){c(m.width<596)},children:(0,e.jsx)(We.Z,{split:o?"horizontal":"vertical",bordered:!0,headerBordered:!0,children:(0,e.jsx)(We.Z,{colSpan:"50%",layout:"center",children:(0,e.jsx)(rt,{})})})},"resize-observer")};function Qt(l){return we.apply(this,arguments)}function we(){return we=_asyncToGenerator(_regeneratorRuntime().mark(function l(n){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/v1/kb/query",{method:"GET",params:{pageNumber:n.pageNumber,pageSize:n.pageSize,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},l)})),we.apply(this,arguments)}function at(l,n){return Oe.apply(this,arguments)}function Oe(){return Oe=O()(i()().mark(function l(n,s){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,v.request)("/api/v1/kb/file/query",{method:"GET",params:{kbName:n,pageNumber:s.pageNumber,pageSize:s.pageSize,client:u.bV}}));case 1:case"end":return o.stop()}},l)})),Oe.apply(this,arguments)}function st(l,n){return Ze.apply(this,arguments)}function Ze(){return Ze=O()(i()().mark(function l(n,s){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,v.request)("/api/v1/kb/doc/query",{method:"GET",params:{kbName:n,pageNumber:s.pageNumber,pageSize:s.pageSize,client:u.bV}}));case 1:case"end":return o.stop()}},l)})),Ze.apply(this,arguments)}function Ht(l,n){return Ke.apply(this,arguments)}function Ke(){return Ke=_asyncToGenerator(_regeneratorRuntime().mark(function l(n,s){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",request("/api/llm/kb/file/doc/update",{method:"POST",data:{did:n,pageContent:s,client:HTTP_CLIENT}}));case 1:case"end":return o.stop()}},l)})),Ke.apply(this,arguments)}function Yt(l,n,s){return Ie.apply(this,arguments)}function Ie(){return Ie=_asyncToGenerator(_regeneratorRuntime().mark(function l(n,s,r){return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",request("/update/doc",{method:"POST",data:{did:n,content:s,metadata:r,client:HTTP_CLIENT}}));case 1:case"end":return c.stop()}},l)})),Ie.apply(this,arguments)}function lt(l){return(0,v.request)("/api/v1/kb/file/delete",{method:"POST",params:{kid:l,client:u.bV}})}function it(l){return Ae.apply(this,arguments)}function Ae(){return Ae=O()(i()().mark(function l(n){return i()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,v.request)("/api/v1/kb/doc/delete",{method:"POST",params:{did:n,client:u.bV}}));case 1:case"end":return r.stop()}},l)})),Ae.apply(this,arguments)}function Jt(l){return Ue.apply(this,arguments)}function Ue(){return Ue=_asyncToGenerator(_regeneratorRuntime().mark(function l(n){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/delete/doc",{method:"POST",data:{did:n,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},l)})),Ue.apply(this,arguments)}var ut=t(64529),Ge=t(782),ct=t(71381),De=(0,ut.Ue)()((0,Ge.mW)((0,Ge.tJ)((0,ct.n)(function(l,n){return{kbFileResult:{},kbDocResult:{items:[]},currentKbFile:{},currentKbDoc:{fileName:"",pageContent:""},fetchFiles:function(){var s=O()(i()().mark(function o(c,d){var R;return i()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("kbName",c," pageParams",d),p.next=3,at(c,d);case 3:R=p.sent,console.log("kbName kbFiles",R);case 5:case"end":return p.stop()}},o)}));function r(o,c){return s.apply(this,arguments)}return r}(),deleteFile:function(){var s=O()(i()().mark(function o(c){var d,R,m,p,D;return i()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return console.log("delete file",c),I.next=3,lt(c);case 3:d=I.sent,R=n().kbFileResult.data.content.filter(function(C){return C.uid!==c}),l(function(C){return{kbFileResult:{items:R}}}),console.log("delete file result",d),m=n().kbDocResult.data.content,p=i()().mark(function C(){var x;return i()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:x=d.data[D],m=m.filter(function(f){return f.uid!==x});case 2:case"end":return j.stop()}},C)}),D=0;case 10:if(!(D<d.data.length)){I.next=15;break}return I.delegateYield(p(),"t0",12);case 12:D++,I.next=10;break;case 15:l(function(C){return{kbFileDocResult:{items:m}}});case 16:case"end":return I.stop()}},o)}));function r(o){return s.apply(this,arguments)}return r}(),fetchDocs:function(){var s=O()(i()().mark(function o(c,d){var R;return i()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("fetchFileDocs kbName",c," pageParams",d),p.next=3,st(c,d);case 3:R=p.sent,console.log("kbName kbFileDocs",R);case 5:case"end":return p.stop()}},o)}));function r(o,c){return s.apply(this,arguments)}return r}(),deleteFileDoc:function(){var s=O()(i()().mark(function o(c){var d,R;return i()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("delete file doc",c),p.next=3,it(c);case 3:d=p.sent,console.log("delete file doc result",d),R=n().kbDocResult.data.content.filter(function(D){return D.uid!==c}),l(function(D){return{kbFileDocResult:{items:R}}});case 7:case"end":return p.stop()}},o)}));function r(o){return s.apply(this,arguments)}return r}(),setCurrentFile:function(r){var o=n().kbFileResult.data.content.find(function(c){return c.uid===r});l({currentKbFile:o})},setCurrentFileDoc:function(r){var o=n().kbDocResult.data.content.find(function(c){return c.uid===r});console.log("setCurrentFileDoc",r,o),l({currentKbDoc:o})},updateKbFileDocPython:function(){var s=O()(i()().mark(function o(c,d,R){return i()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:console.log("updateKbFileDocPython",c,d,R);case 1:case"end":return p.stop()}},o)}));function r(o,c,d){return s.apply(this,arguments)}return r}(),deleteKbCache:function(){return l({},!0)}}}),{name:u.cn}))),ke=t(96853),Te=t(86738),ce=t(45360),Be=t(85265),ye=t(42075),Le=t(55102),dt=function(){var n=(0,v.useIntl)(),s=ne.Z.useForm(),r=h()(s,1),o=r[0],c=(0,F.V)(function(L){return{currentRobot:L.currentRobot}}),d=c.currentRobot,R=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),D=p[0],Z=p[1],I=(0,a.useState)(20),C=h()(I,2),x=C[0],q=C[1],j=De(function(L){return{kbFileDocResult:L.kbDocResult,currentKbFileDoc:L.currentKbDoc,fetchFileDocs:L.fetchDocs,setCurrentFileDoc:L.setCurrentFileDoc,updateKbFileDocPython:L.updateKbFileDocPython}}),f=j.kbFileDocResult,K=j.currentKbFileDoc,A=j.fetchFileDocs,U=j.setCurrentFileDoc,P=j.updateKbFileDocPython;De.subscribe(function(L,ue){console.log("kb",L)});var b=function(){};(0,a.useEffect)(function(){b()},[]),(0,a.useEffect)(function(){b()},[D,x]),(0,a.useEffect)(function(){Z(1),b()},[d]),(0,a.useEffect)(function(){R.current.reload()},[f]);var S=(0,a.useState)(!1),y=h()(S,2),E=y[0],M=y[1],k=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),T=h()(k,2),oe=T[0],ie=T[1],be=function(){M(!0)},ve=function(){M(!1)},B=function(){M(!1)},w=function(){console.log("handleInputText"),ie("\u8F93\u5165\u6587\u672C"),be()},N=function(){console.log("handleInputUrl"),ie("\u8F93\u5165\u7F51\u5740"),be()};function J(L){U(L.did),be()}function fe(L){console.log("handleDelete",L)}var z=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:n.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:n.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(ue,_e){return[(0,e.jsx)(g.ZP,{type:"link",size:"small",onClick:function(){return J(_e)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Te.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return fe(_e)},onCancel:function(){return B()},children:(0,e.jsx)(g.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],$e=function(ue){console.log("Success:",ue,K.uid,K.meta),P(K.uid,ue.pageContent,K.meta),ce.ZP.success("\u66F4\u65B0\u6210\u529F"),M(!1)},Me=function(ue){console.log("Failed:",ue)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:R,columns:z,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(ue,_e,Re){return console.log("request:",ue,_e,Re),Z(ue.current-1),q(ue.pageSize),Promise.resolve({data:f.data.content,success:!0,total:f.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(g.ZP,{onClick:w,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Be.Z,{title:oe,size:"default",placement:"right",onClose:B,open:E,extra:(0,e.jsx)(ye.Z,{children:(0,e.jsx)(g.ZP,{onClick:B,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(ne.Z,{form:o,name:"basic",onFinish:$e,onFinishFailed:Me,autoComplete:"off",children:[(0,e.jsx)(ne.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(ne.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Le.Z.TextArea,{rows:15})}),(0,e.jsx)(ne.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(g.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},ft=function(){var n=(0,v.useIntl)(),s=ne.Z.useForm(),r=h()(s,1),o=r[0],c=(0,F.V)(function(_){return{currentRobot:_.currentRobot}}),d=c.currentRobot,R=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),D=p[0],Z=p[1],I=(0,a.useState)(20),C=h()(I,2),x=C[0],q=C[1],j=De(function(_){return{kbFileDocResult:_.kbDocResult,currentKbFileDoc:_.currentKbDoc,fetchFileDocs:_.fetchDocs,setCurrentFileDoc:_.setCurrentFileDoc,updateKbFileDocPython:_.updateKbFileDocPython}}),f=j.kbFileDocResult,K=j.currentKbFileDoc,A=j.fetchFileDocs,U=j.setCurrentFileDoc,P=j.updateKbFileDocPython;De.subscribe(function(_,X){});var b=function(){};(0,a.useEffect)(function(){b()},[]),(0,a.useEffect)(function(){b()},[D,x]),(0,a.useEffect)(function(){Z(1),b()},[d]),(0,a.useEffect)(function(){R.current.reload()},[f]);var S=(0,a.useState)(!1),y=h()(S,2),E=y[0],M=y[1],k=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),T=h()(k,2),oe=T[0],ie=T[1],be=(0,a.useState)(""),ve=h()(be,2),B=ve[0],w=ve[1],N=function(){M(!0)},J=function(){M(!1)},fe=function(){M(!1)},z=function(){console.log("handleInputText"),ie("\u8F93\u5165\u6587\u672C"),N()},$e=function(){console.log("handleInputUrl"),ie("\u8F93\u5165\u7F51\u5740"),N()};function Me(_){U(_.did),N()}function L(_){console.log("handleDelete",_)}var ue=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:n.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:n.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(X,ge){return[(0,e.jsx)(g.ZP,{type:"link",size:"small",onClick:function(){return Me(ge)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Te.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return L(ge)},onCancel:function(){return fe()},children:(0,e.jsx)(g.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],_e=function(X){console.log("Success:",X,K.uid,K.meta),P(K.uid,X.pageContent,K.meta),ce.ZP.success("\u66F4\u65B0\u6210\u529F"),M(!1)},Re=function(X){console.log("Failed:",X)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:R,columns:ue,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(X,ge,he){return console.log("request:",X,ge,he),Z(X.current-1),q(X.pageSize),Promise.resolve({data:f.data.content,success:!0,total:f.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(g.ZP,{onClick:z,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Be.Z,{title:oe,size:"default",placement:"right",onClose:fe,open:E,extra:(0,e.jsx)(ye.Z,{children:(0,e.jsx)(g.ZP,{onClick:fe,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(ne.Z,{form:o,name:"basic",onFinish:_e,onFinishFailed:Re,autoComplete:"off",children:[(0,e.jsx)(ne.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(ne.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Le.Z.TextArea,{rows:15})}),(0,e.jsx)(ne.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(g.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},mt=function(){var n=(0,v.useIntl)(),s=ne.Z.useForm(),r=h()(s,1),o=r[0],c=(0,F.V)(function(_){return{currentRobot:_.currentRobot}}),d=c.currentRobot,R=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),D=p[0],Z=p[1],I=(0,a.useState)(20),C=h()(I,2),x=C[0],q=C[1],j=De(function(_){return{kbFileDocResult:_.kbDocResult,currentKbFileDoc:_.currentKbDoc,fetchFileDocs:_.fetchDocs,setCurrentFileDoc:_.setCurrentFileDoc,updateKbFileDocPython:_.updateKbFileDocPython}}),f=j.kbFileDocResult,K=j.currentKbFileDoc,A=j.fetchFileDocs,U=j.setCurrentFileDoc,P=j.updateKbFileDocPython;De.subscribe(function(_,X){o.setFieldValue("pageContent",_.currentKbDoc.content)});var b=function(){};(0,a.useEffect)(function(){b()},[]),(0,a.useEffect)(function(){b()},[D,x]),(0,a.useEffect)(function(){Z(1),b()},[d]),(0,a.useEffect)(function(){R.current.reload()},[f]);var S=(0,a.useState)(!1),y=h()(S,2),E=y[0],M=y[1],k=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),T=h()(k,2),oe=T[0],ie=T[1],be=(0,a.useState)(""),ve=h()(be,2),B=ve[0],w=ve[1],N=function(){M(!0)},J=function(){M(!1)},fe=function(){M(!1)},z=function(){console.log("handleInputText"),ie("\u8F93\u5165\u6587\u672C"),N()},$e=function(){console.log("handleInputUrl"),ie("\u8F93\u5165\u7F51\u5740"),N()};function Me(_){U(_.did),N()}function L(_){console.log("handleDelete",_)}var ue=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:n.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:n.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(X,ge){return[(0,e.jsx)(g.ZP,{type:"link",size:"small",onClick:function(){return Me(ge)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Te.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return L(ge)},onCancel:function(){return fe()},children:(0,e.jsx)(g.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],_e=function(X){console.log("Success:",X,K.uid,K.meta),P(K.uid,X.pageContent,K.meta),ce.ZP.success("\u66F4\u65B0\u6210\u529F"),M(!1)},Re=function(X){console.log("Failed:",X)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:R,columns:ue,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(X,ge,he){return console.log("request:",X,ge,he),Z(X.current-1),q(X.pageSize),Promise.resolve({data:f.data.content,success:!0,total:f.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(g.ZP,{onClick:z,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Be.Z,{title:oe,size:"default",placement:"right",onClose:fe,open:E,extra:(0,e.jsx)(ye.Z,{children:(0,e.jsx)(g.ZP,{onClick:fe,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(ne.Z,{form:o,name:"basic",onFinish:_e,onFinishFailed:Re,autoComplete:"off",children:[(0,e.jsx)(ne.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(ne.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Le.Z.TextArea,{rows:15})}),(0,e.jsx)(ne.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(g.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},pt=t(66476),bt=t(27484),Ne=t.n(bt),gt=function(){var n=(0,v.useIntl)(),s=ce.ZP.useMessage(),r=h()(s,2),o=r[0],c=r[1],d=(0,F.V)(function(k){return k.currentRobot}),R=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),D=p[0],Z=p[1],I=(0,a.useState)(10),C=h()(I,2),x=C[0],q=C[1],j=De(function(k){return{kbFileResult:k.kbFileResult,fetchFiles:k.fetchFiles,fetchFileDocs:k.fetchDocs,deleteFile:k.deleteFile}}),f=j.kbFileResult,K=j.fetchFiles,A=j.fetchFileDocs,U=j.deleteFile;function P(k){console.log("handleDelete",k),U(k.uid)}function b(){console.log("handleCancel")}var S=[{title:n.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),dataIndex:"name"},{title:n.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(T,oe){return[(0,e.jsx)(Te.Z,{title:n.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return P(oe)},onCancel:function(){return b()},children:(0,e.jsx)(g.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],y=function(){var T={pageNumber:D,pageSize:x};K(d.uid,T),A(d.uid,T)};(0,a.useEffect)(function(){y()},[]),(0,a.useEffect)(function(){y()},[D,x]),(0,a.useEffect)(function(){Z(1),y()},[d]),(0,a.useEffect)(function(){R.current.reload()},[f]);var E={file_name:"test.png",file_kid:Ne()(new Date).format("YYYYMMDDHHmmss"),rid:d.uid,client:u.bV},M={name:"file",action:"/api/v1/upload/file",headers:{Authorization:"Bearer "+localStorage.getItem(u.LA).replaceAll('"',"")},showUploadList:!1,data:E,beforeUpload:function(T){if(T.name.includes("_"))return ce.ZP.error(n.formatMessage({id:"pages.robot.file.name_invalid",defaultMessage:"File name should not contain _"})),!1;E.file_name=T.name;var oe=Ne()(new Date).format("YYYYMMDDHHmmss");return E.file_kid=oe,E.rid=d.uid,console.log("file:",T," uploadData:",E),o.open({type:"loading",content:n.formatMessage({id:"pages.robot.file.uploading",defaultMessage:"Uploading..."}),duration:0}),!0},onChange:function(T){T.file.status!=="uploading"&&console.log(T.file,T.fileList),T.file.status==="done"?(console.log(T.file.response.data),o.destroy(),ce.ZP.success("".concat(T.file.name," file uploaded successfully")),y()):T.file.status==="error"&&ce.ZP.error("".concat(T.file.name," file upload failed."))}};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:R,columns:S,headerTitle:d.nickname,request:function(T,oe,ie){return console.log("request:",T,oe,ie),Z(T.current),q(T.pageSize),Promise.resolve({data:f.data.content,success:!0,total:f.data.totalElements})},rowKey:"kid",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(pt.Z,me()(me()({},M),{},{children:(0,e.jsx)(g.ZP,{icon:(0,e.jsx)(ze.Z,{}),type:"primary",children:n.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})}),"upload")]}}),c]})},ht=function(){var n=(0,v.useIntl)(),s=[{key:"file",label:n.formatMessage({id:"pages.robot.kb.file",defaultMessage:"File"}),children:(0,e.jsx)(gt,{})},{key:"text",label:n.formatMessage({id:"pages.robot.kb.text",defaultMessage:"Text"}),children:(0,e.jsx)(dt,{})},{key:"qa",label:n.formatMessage({id:"pages.robot.kb.qa",defaultMessage:"Q&A"}),children:(0,e.jsx)(ft,{})},{key:"web",label:n.formatMessage({id:"pages.robot.kb.web",defaultMessage:"Website"}),children:(0,e.jsx)(mt,{})}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Se.Z,{tabPosition:"left",items:s})})},vt=ht,Qe=t(40056),He=t(96074),Pe=t(71230),_t=function(){var l=(0,F.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Pe.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(g.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(g.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Rt=function(){var l=(0,F.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Pe.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(g.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(g.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Dt=function(){var l=(0,F.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Pe.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(g.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(g.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},yt=function(){var l=(0,F.V)(function(r){return r.currentRobot}),n=function(){navigator.clipboard.writeText("/?rid="+l.uid+"&"),ce.ZP.success("\u590D\u5236\u6210\u529F")},s=function(){window.open("/?rid="+l.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Pe.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+l.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(g.ZP,{onClick:n,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(g.ZP,{onClick:s,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Ct=function(){var n=(0,v.useIntl)(),s=pe.A.useForm(),r=h()(s,1),o=r[0],c=(0,F.V)(function(D){return D.currentRobot}),d=(0,a.useMemo)(function(){return"http://localhost:9003/chat?t="+u.xt+"&sid="+c.uid+"&"},[c]);(0,a.useEffect)(function(){var D=F.V.subscribe(function(Z){console.log("currentRobot code:",Z.currentRobot),o.setFieldValue("code","http://localhost:9003/chat?t="+u.xt+"&sid="+Z.currentRobot.uid+"&")});return D},[c]);var R=function(){window.open(d)},m=function(){navigator.clipboard.writeText(d),ce.ZP.info("code copyied into clicpboard")},p=function(Z,I){return[(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){var x;(x=Z.form)===null||x===void 0||x.submit(),R()},children:n.formatMessage({id:"open",defaultMessage:"Open"})},"submit"),(0,e.jsx)(g.ZP,{onClick:function(){m()},children:n.formatMessage({id:"copy",defaultMessage:"Copy"})},"reset")]};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.A,{form:o,style:{marginLeft:"100px"},submitter:{render:p},initialValues:{code:d},children:(0,e.jsx)(je.Z,{width:"md",name:"code",label:n.formatMessage({id:"chat.widget.code",defaultMessage:"Code"})})})})},Ft=Ct,jt=function(){var n=(0,v.useIntl)(),s=pe.A.useForm(),r=h()(s,1),o=r[0],c=(0,F.V)(function(D){return D.currentRobot}),d=(0,a.useMemo)(function(){return"http://localhost:9003/chat?t="+u.xt+"&sid="+c.uid+"&"},[c]);(0,a.useEffect)(function(){var D=F.V.subscribe(function(Z){console.log("currentRobot code:",Z.currentRobot),o.setFieldValue("code","http://localhost:9003/chat?t="+u.xt+"&sid="+Z.currentRobot.uid+"&")});return D},[c]);var R=function(){window.open(d)},m=function(){navigator.clipboard.writeText(d),ce.ZP.info("code copyied into clicpboard")},p=function(Z,I){return[(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){var x;(x=Z.form)===null||x===void 0||x.submit(),R()},children:n.formatMessage({id:"open",defaultMessage:"Open"})},"submit"),(0,e.jsx)(g.ZP,{onClick:function(){m()},children:n.formatMessage({id:"copy",defaultMessage:"Copy"})},"reset")]};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.A,{form:o,style:{marginLeft:"100px"},submitter:{render:p},initialValues:{code:d},children:(0,e.jsx)(je.Z,{width:"md",name:"code",label:n.formatMessage({id:"chat.widget.code",defaultMessage:"Code"})})})})},Mt=jt,xt=[{key:"web",label:"Web",children:(0,e.jsx)(Ft,{})},{key:"h5",label:"H5",children:(0,e.jsx)(Mt,{})},{key:"ios",label:"iOS",children:(0,e.jsx)(_t,{})},{key:"android",label:"Android",children:(0,e.jsx)(yt,{})},{key:"uniapp",label:"Uniapp",children:(0,e.jsx)(Rt,{})},{key:"flutter",label:"Flutter",children:(0,e.jsx)(Dt,{})}],St=function(){var n=(0,v.useIntl)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Qe.Z,{message:n.formatMessage({id:"robot.no.agent.now",defaultMessage:"agent not supported now"}),type:"success"}),(0,e.jsx)(He.Z,{}),(0,e.jsx)(Se.Z,{tabPosition:"left",items:xt})]})},kt=St,Tt=t(34751),Pt=function(){var n=(0,a.useRef)(null),s=(0,v.useAccess)();s.canDebug&&console.log("TabFlow canDebug"),(0,Tt.useGesture)({onDrag:function(c){return r(c)}},{target:n,drag:{pointer:{keys:!1}}});var r=function(c){console.log("handleDragGesture:",c),V.yw.info("handleDragGesture")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(v.Access,{accessible:s.canDebug(),fallback:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(v.FormattedMessage,{id:u.h5})}),children:(0,e.jsx)(le.Z,{ref:n,style:{touchAction:"none"},children:(0,e.jsx)(g.ZP,{children:"drag"})})})})},Et=Pt,wt=t(52688),Ot=t(31199),Zt=function(){var l,n,s,r,o,c,d,R,m,p,D=(0,v.useIntl)(),Z=pe.A.useForm(),I=h()(Z,1),C=I[0],x=(0,Ee.Z)(),q=x.translateString,j=(0,F.V)(function(U){return{currentRobot:U.currentRobot,setCurrentRobot:U.setCurrentRobot}}),f=j.currentRobot,K=j.setCurrentRobot;F.V.subscribe(function(U,P){var b,S,y,E,M,k;C.setFieldValue("topK",(b=U.currentRobot)===null||b===void 0||(b=b.llm)===null||b===void 0?void 0:b.topK),C.setFieldValue("scoreThreshold",(S=U.currentRobot)===null||S===void 0||(S=S.llm)===null||S===void 0?void 0:S.scoreThreshold),C.setFieldValue("model",(y=U.currentRobot)===null||y===void 0||(y=y.llm)===null||y===void 0?void 0:y.model),C.setFieldValue("embeddings",(E=U.currentRobot)===null||E===void 0||(E=E.llm)===null||E===void 0?void 0:E.embeddings),C.setFieldValue("temperature",(M=U.currentRobot)===null||M===void 0||(M=M.llm)===null||M===void 0?void 0:M.temperature),C.setFieldValue("prompt",(k=U.currentRobot)===null||k===void 0||(k=k.llm)===null||k===void 0?void 0:k.prompt)});var A=function(){var U=O()(i()().mark(function P(b){var S,y;return i()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return console.log("handleSubmit",b),V.yw.loading("\u6B63\u5728\u4FEE\u6539"),S=me()(me()({},f),{},{llm:b}),console.log("robotObject:",S),M.next=6,(0,Fe.$l)(S);case 6:y=M.sent,console.log("updateRobot response:",y),y.code===200?(V.yw.destroy(),V.yw.success(D.formatMessage({id:"update.success"})),K(y.data)):(V.yw.destroy(),V.yw.error(y.message));case 9:case"end":return M.stop()}},P)}));return function(b){return U.apply(this,arguments)}}();return(0,e.jsxs)(pe.A,{form:C,size:"large",onFinish:A,initialValues:{enabled:f==null||(l=f.llm)===null||l===void 0?void 0:l.enabled,topK:f==null||(n=f.llm)===null||n===void 0?void 0:n.topK,scoreThreshold:f==null||(s=f.llm)===null||s===void 0?void 0:s.scoreThreshold,model:f==null||(r=f.llm)===null||r===void 0?void 0:r.model,embeddings:f==null||(o=f.llm)===null||o===void 0?void 0:o.embeddings,temperature:f==null||(c=f.llm)===null||c===void 0?void 0:c.temperature,prompt:q(f==null||(d=f.llm)===null||d===void 0?void 0:d.prompt),apiKey:f==null||(R=f.llm)===null||R===void 0?void 0:R.apiKey,apiSecret:f==null||(m=f.llm)===null||m===void 0?void 0:m.apiSecret,apiUrl:f==null||(p=f.llm)===null||p===void 0?void 0:p.apiUrl},children:[(0,e.jsx)(wt.Z,{width:"lg",name:"enabled",label:"enabled",tooltip:"\u662F\u5426\u542F\u7528\u5927\u6A21\u578B"}),(0,e.jsx)(je.Z,{width:"lg",name:"prompt",label:"prompt",placeholder:"\u8BF7\u8F93\u5165prompt",rules:[{required:!0,message:"\u8BF7\u8F93\u5165prompt"}]}),(0,e.jsx)(xe.Z,{width:"lg",name:"model",label:"model",allowClear:!0,options:[{value:"ZHIPUAI_GLM_3_TURBO",label:"\u667A\u8C31AI-GLM-3-Turbo"},{value:"ZHIPUAI_GLM_4",label:"\u667A\u8C31AI-GLM-4"},{value:"OLLAMA",label:"Ollama",disabled:!0},{value:"OPENAI",label:"OpenAi",disabled:!0}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5927\u6A21\u578B"}]}),(0,e.jsx)(xe.Z,{width:"lg",name:"embeddings",label:"embeddings",allowClear:!0,options:[{value:"M3E_BASE",label:"m3e-base"}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9embeddings"}]}),(0,e.jsx)(Ot.Z,{width:"lg",label:"\u6E29\u5EA6",name:"temperature",min:0,max:1,fieldProps:{precision:1,step:.1},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6E29\u5EA6"}]})]})},Kt=t(9465),It=function(){var n,s=(0,v.useIntl)(),r=pe.A.useForm(),o=h()(r,1),c=o[0],d=(0,$.u)(function(P){return P.orgCurrent}),R=(0,a.useState)(),m=h()(R,2),p=m[0],D=m[1],Z=(0,a.useState)([]),I=h()(Z,2),C=I[0],x=I[1],q=(0,F.V)(function(P){return{currentRobot:P.currentRobot,setCurrentRobot:P.setCurrentRobot}}),j=q.currentRobot,f=q.setCurrentRobot,K=function(){var P=O()(i()().mark(function b(){var S,y,E,M;return i()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return V.yw.loading("\u52A0\u8F7D\u4E2D"),y={pageNumber:0,pageSize:50,orgUid:d.uid},T.next=4,(0,Kt.qL)(y);case 4:E=T.sent,console.log("getAllQuickbuttons response:",y,E),V.yw.destroy(),E.code===200?D(E):V.yw.error(E.message),M=[],(S=j.serviceSettings)===null||S===void 0||S.quickButtons.forEach(function(oe){M.push(oe.uid)}),x(M);case 11:case"end":return T.stop()}},b)}));return function(){return P.apply(this,arguments)}}();(0,a.useEffect)(function(){K()},[d]),(0,a.useEffect)(function(){var P=F.V.subscribe(function(b){var S;console.log("TabQuickButton useRobotStore:",b);var y=[];(S=b.currentRobot.serviceSettings)===null||S===void 0||S.quickButtons.forEach(function(E){y.push(E.uid)}),x(y)});return P},[j]);var A=function(){var P=O()(i()().mark(function b(S){var y,E;return i()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return console.log("onFinish",S),y=me()(me()({},j),{},{serviceSettings:me()(me()({},j.serviceSettings),{},{quickButtonUids:S.quickbutton})}),console.log("robotObject:",y),k.next=5,(0,Fe.$l)(y);case 5:E=k.sent,console.log("updateRobot response:",E),E.code===200?(V.yw.destroy(),V.yw.success(s.formatMessage({id:"update.success"})),f(E.data)):(V.yw.destroy(),V.yw.error(E.message));case 8:case"end":return k.stop()}},b)}));return function(S){return P.apply(this,arguments)}}(),U=function(b){console.log("selected ".concat(b)),x(b)};return(0,e.jsxs)("div",{children:[(0,e.jsx)(Qe.Z,{message:s.formatMessage({id:"quickbutton.guide",defaultMessage:"Please goto Knowledge base -> QuickButton -> Create, then add quickbutton here"}),type:"success"}),(0,e.jsx)(He.Z,{}),(0,e.jsx)(pe.A,{form:c,layout:"vertical",initialValues:{},onFinish:A,children:(0,e.jsx)(xe.Z,{name:"quickbutton",width:"md",label:s.formatMessage({id:"quickbutton",defaultMessage:"QuickButton"}),options:p==null||(n=p.data)===null||n===void 0?void 0:n.content.map(function(P){return{label:P.title,value:P.uid}}),fieldProps:{mode:"multiple",onChange:U,allowClear:!0,value:C,placeholder:"\u8BF7\u9009\u62E9"}})})]})},At=It,Ut=function(){var n=(0,v.useIntl)(),s=[{key:"quickbutton",label:n.formatMessage({id:"quickbutton",defaultMessage:"QuickButton"}),children:(0,e.jsx)(At,{})},{key:"llm",label:n.formatMessage({id:"llm",defaultMessage:"LLM"}),children:(0,e.jsx)(Zt,{})}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Se.Z,{tabPosition:"left",items:s})})},Bt=Ut,Lt=function(){var n=(0,v.useIntl)(),s=function(c){},r=[{key:"basic",label:n.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,e.jsx)(ot,{})},{key:"kb",label:n.formatMessage({id:"pages.robot.tab.kb",defaultMessage:"Knowledge Base"}),children:(0,e.jsx)(vt,{})},{key:"advanced",label:n.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,e.jsx)(Bt,{})},{key:"flow",label:n.formatMessage({id:"pages.robot.tab.flow",defaultMessage:"Flow"}),children:(0,e.jsx)(Et,{})},{key:"channel",label:n.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,e.jsx)(kt,{})}];return(0,e.jsx)(Se.Z,{defaultActiveKey:"1",items:r,onChange:s})},$t=Lt,Vt=t(77154),Wt=re.Z.Sider,zt=re.Z.Content,Gt=function(){var n=(0,Vt.Z)(),s=n.leftSiderStyle,r=n.contentStyle;return(0,e.jsxs)(re.Z,{children:[(0,e.jsx)(Wt,{width:250,style:s,children:(0,e.jsx)(qe,{})}),(0,e.jsx)(re.Z,{children:(0,e.jsx)(zt,{style:r,children:(0,e.jsx)($t,{})})})]})},Nt=Gt},37326:function(Ce,ae,t){t.d(ae,{V:function(){return F}});var re=t(97857),a=t.n(re),de=t(19632),i=t.n(de),se=t(85615),O=t(64529),ee=t(782),h=t(71381),F=(0,O.Ue)()((0,ee.mW)((0,ee.tJ)((0,h.n)(function(H,le){return{robotResult:{data:{content:[]}},currentRobot:{uid:"",nickname:""},insertRobot:function(G){H(function(W){var Q=W.robotResult.data.content;Q.unshift(G)})},setRobotResult:function(G){H({robotResult:G});var W=le().currentRobot;if(W.uid===""||W===void 0){var Q;((Q=G.data)===null||Q===void 0||(Q=Q.content)===null||Q===void 0?void 0:Q.length)>0&&H({currentRobot:G.data.content[0]})}},setCurrentRobot:function(G){var W=le().robotResult.data.content,Q=W.findIndex(function(Y){return Y.uid===G.uid});if(Q!==-1){var te=[].concat(i()(W.slice(0,Q)),[G],i()(W.slice(Q+1))),v=a()(a()({},le().robotResult),{},{data:{content:te}});H({robotResult:v,currentRobot:G})}else console.warn("Robot with the specified uid not found."),H({currentRobot:G})},deleteCurrentRobot:function(G){var W=le().robotResult.data.content,Q=W.findIndex(function(te){return te.uid===G});Q!==-1?H({robotResult:a()(a()({},le().robotResult),{},{data:{content:[].concat(i()(W.slice(0,Q)),i()(W.slice(Q+1)))}})}):console.warn("Robot not found in cache:",G),le().currentRobot.uid===G&&H({currentRobot:{uid:""}})},deleteRobotCache:function(){return H({},!0)}}}),{name:se.Ei})))},66723:function(Ce,ae,t){t.d(ae,{G:function(){return H}});var re=t(97857),a=t.n(re),de=t(67294),i=t(66476),se=t(85615),O=t(27484),ee=t.n(O),h=t(80049),F=t(85893),H=function(g){var G=g.children,W=g.onSuccess,Q=g.onError,te={file:null,file_name:"test.png",file_type:"image/png"},v={name:"file",action:"/api/v1/upload/file",headers:{Authorization:"Bearer "+localStorage.getItem(se.LA)},data:te,showUploadList:!1,beforeUpload:function($){console.log("beforeUpload",$);var u=ee()(new Date).format("YYYYMMDDHHmmss")+"_"+$.name;te.file=$,te.file_name=u,te.file_type=$.type,console.log("beforeUpload",te)},onChange:function($){if($.file.status!=="uploading"&&console.log($.file,$.fileList),$.file.status==="done"){var u=$.file.response.data;console.log("url: ",u),W(u),h.yw.success("".concat($.file.name," \u4E0A\u4F20\u6210\u529F"))}else $.file.status==="error"&&(h.yw.error("".concat($.file.name," \u4E0A\u4F20\u5931\u8D25")),Q($.file))}};return(0,F.jsx)(i.Z,a()(a()({},v),{},{children:G}))}}}]);
