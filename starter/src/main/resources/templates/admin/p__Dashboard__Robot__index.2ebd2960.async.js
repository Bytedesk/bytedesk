"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6693],{9465:function(Ce,ae,n){n.d(ae,{Ck:function(){return z},qL:function(){return j},z4:function(){return ce}});var Q=n(15009),a=n.n(Q),fe=n(97857),c=n.n(fe),le=n(99289),O=n.n(le),te=n(85615),h=n(86745);function j(_){return H.apply(this,arguments)}function H(){return H=O()(a()().mark(function _(Y){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/v1/quickbutton/query/org",{method:"GET",params:c()(c()({},Y),{},{client:te.bV})}));case 1:case"end":return d.stop()}},_)})),H.apply(this,arguments)}function ce(_){return v.apply(this,arguments)}function v(){return v=O()(a()().mark(function _(Y){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/v1/quickbutton/create",{method:"POST",data:c()(c()({},Y),{},{client:te.bV})}));case 1:case"end":return d.stop()}},_)})),v.apply(this,arguments)}function z(_){return $.apply(this,arguments)}function $(){return $=O()(a()().mark(function _(Y){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/v1/quickbutton/update",{method:"POST",data:c()(c()({},Y),{},{client:te.bV})}));case 1:case"end":return d.stop()}},_)})),$.apply(this,arguments)}function G(_){return ne.apply(this,arguments)}function ne(){return ne=_asyncToGenerator(_regeneratorRuntime().mark(function _(Y){return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/api/v1/quickbutton/delete",{method:"POST",data:_objectSpread(_objectSpread({},Y),{},{client:HTTP_CLIENT})}));case 1:case"end":return d.stop()}},_)})),ne.apply(this,arguments)}},76545:function(Ce,ae,n){n.d(ae,{$l:function(){return z},gf:function(){return G},lg:function(){return ce},p0:function(){return j}});var Q=n(15009),a=n.n(Q),fe=n(97857),c=n.n(fe),le=n(99289),O=n.n(le),te=n(85615),h=n(86745);function j(_){return H.apply(this,arguments)}function H(){return H=O()(a()().mark(function _(Y){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/v1/robot/query/org",{method:"GET",params:c()(c()({},Y),{},{client:te.bV})}));case 1:case"end":return d.stop()}},_)})),H.apply(this,arguments)}function ce(_){return v.apply(this,arguments)}function v(){return v=O()(a()().mark(function _(Y){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/v1/robot/create",{method:"POST",data:c()(c()({},Y),{},{client:te.bV})}));case 1:case"end":return d.stop()}},_)})),v.apply(this,arguments)}function z(_){return $.apply(this,arguments)}function $(){return $=O()(a()().mark(function _(Y){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/v1/robot/update",{method:"POST",data:c()(c()({},Y),{},{client:te.bV})}));case 1:case"end":return d.stop()}},_)})),$.apply(this,arguments)}function G(_){return ne.apply(this,arguments)}function ne(){return ne=O()(a()().mark(function _(Y){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/v1/robot/delete",{method:"POST",data:c()(c()({},Y),{},{client:te.bV})}));case 1:case"end":return d.stop()}},_)})),ne.apply(this,arguments)}},77154:function(Ce,ae,n){var Q=n(39825);function a(){var fe=(0,Q.Z)(),c=fe.isDarkMode,le={borderRight:c?"1px solid #333":"1px solid #ccc",background:c?"#141414":"#f5f5f5"},O={background:c?"#141414":"#fff"},te={borderLeft:c?"1px solid #333":"1px solid #ccc",background:c?"#141414":"#f5f5f5"},h={minHeight:120,background:c?"#141414":"#f5f5f5"};return{leftSiderStyle:le,headerStyle:O,rightSiderStyle:te,contentStyle:h}}ae.Z=a},73803:function(Ce,ae,n){var Q=n(85615),a=n(66419),fe=n(86745);function c(){var le=(0,fe.useIntl)(),O=function(j){return j&&j.startsWith(Q.Vo)?le.formatMessage({id:j,defaultMessage:j}):j},te=function(j){return j!=null&&j.startsWith(Q.Vo)?(0,a.aS)(le.formatMessage({id:j}),10):(0,a.aS)(j,10)};return{translateString:O,translateStringTranct:te}}ae.Z=c},93980:function(Ce,ae,n){n.r(ae),n.d(ae,{default:function(){return qt}});var Q=n(21612),a=n(67294),fe=n(15009),c=n.n(fe),le=n(99289),O=n.n(le),te=n(5574),h=n.n(te),j=n(37326),H=n(85576),ce=n(86250),v=n(14726),z=n(2487),$=n(7134),G=n(11475),ne=n(64789),_=n(86745),Y=n(39825),B=n(87676),d=n(85615),me=n(34994),We=n(5966),Se=n(64317),re=n(8232),e=n(85893),Je=function(t){var l=t.open,r=t.onClose,o=t.onSubmit,u=re.Z.useForm(),f=h()(u,1),y=f[0],m=(0,B.u)(function(k){return k.orgCurrent}),p=function(){console.log("handleSaveRobot"),y.validateFields().then(function(T){console.log("handleSaveRobot values:",T);var J={nickname:T.nickname,type:T.type,orgUid:m.uid};console.log("robotObject:",J),o(J)}).catch(function(T){console.log("Form errors:",T)})},R=function(){r()},w=[{title:"\u5BA2\u670D\u673A\u5668\u4EBA",value:d.f4},{title:"\u8425\u9500\u673A\u5668\u4EBA(\u5F00\u53D1\u4E2D...)",value:d.wG}],b=function(T){console.log("onTreeSelectChange:",T)};return(0,e.jsx)("div",{children:(0,e.jsx)(H.Z,{title:"\u65B0\u5EFA\u673A\u5668\u4EBA",open:l,okText:"\u4FDD\u5B58",onOk:p,onCancel:R,children:(0,e.jsxs)(me.A,{form:y,name:"basic",style:{maxWidth:400},submitter:!1,children:[(0,e.jsx)(We.Z,{label:"\u6635\u79F0",name:"nickname"}),(0,e.jsx)(Se.Z,{label:"\u7C7B\u578B",name:["type"],options:[{label:"\u5BA2\u670D\u673A\u5668\u4EBA",value:d.f4},{label:"\u8425\u9500\u673A\u5668\u4EBA(\u5F00\u53D1\u4E2D...)",value:d.wG}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B!"}],fieldProps:{placeholder:"\u9009\u62E9\u7C7B\u578B",onChange:b,allowClear:!0}})]})})})},Xe=Je,Fe=n(76545),V=n(80049),Pe=n(73803),qe=function(){var t=(0,Y.Z)(),l=t.isDarkMode,r=(0,_.useIntl)(),o=(0,a.useRef)(!1),u=(0,Pe.Z)(),f=u.translateString,y=u.translateStringTranct,m=(0,j.V)(function(U){return{robotResult:U.robotResult,currentRobot:U.currentRobot,insertRobot:U.insertRobot,deleteCurrentRobot:U.deleteCurrentRobot,setRobotResult:U.setRobotResult,setCurrentRobot:U.setCurrentRobot}}),p=m.robotResult,R=m.currentRobot,w=m.insertRobot,b=m.deleteCurrentRobot,k=m.setRobotResult,T=m.setCurrentRobot,J=(0,B.u)(function(U){return U.orgCurrent}),i=H.Z.useModal(),L=h()(i,2),Z=L[0],S=L[1],ee=function(P){Z.confirm({title:"\u5220\u9664\u63D0\u793A",icon:(0,e.jsx)(G.Z,{}),content:"\u786E\u8BA4\u8981\u5220\u9664\u673A\u5668\u4EBA\u3010".concat(f(P.nickname),"\u3011\u5417\uFF1F"),onOk:function(){console.log("\u786E\u8BA4\u5220\u9664"),C(P)},onCancel:function(){console.log("\u53D6\u6D88\u5220\u9664")},okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},C=function(){var U=O()(c()().mark(function P(N){var X;return c()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return console.log("delete robot",N),W.next=3,(0,Fe.gf)(N);case 3:X=W.sent,console.log("delete robot response",X),X.code===200?(V.yw.success("\u5220\u9664\u5BA2\u670D\u6210\u529F"),b(N.uid)):V.yw.error(X.message);case 6:case"end":return W.stop()}},P)}));return function(N){return U.apply(this,arguments)}}(),g=function(){var U=O()(c()().mark(function P(){var N,X;return c()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!o.current){W.next=3;break}return console.log("isLoading: 1",o.current),W.abrupt("return");case 3:return o.current=!0,V.yw.loading("loading"),N={pageNumber:0,pageSize:50,orgUid:J.uid},W.next=8,(0,Fe.p0)(N);case 8:X=W.sent,console.log("queryRobotsByOrg: ",X),X.code===200?k(X):V.yw.error(X.message),o.current=!1,V.yw.destroy();case 13:case"end":return W.stop()}},P)}));return function(){return U.apply(this,arguments)}}();(0,a.useEffect)(function(){console.log("getRobots"),g()},[]);var M=(0,a.useState)(!1),F=h()(M,2),x=F[0],K=F[1],I=function(){K(!0)},E=function(){var U=O()(c()().mark(function P(N){var X;return c()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return V.yw.loading("creating..."),W.next=3,(0,Fe.lg)(N);case 3:X=W.sent,console.log("handleSaveRobot response:",X),X.code===200?(V.yw.success("\u521B\u5EFA\u6210\u529F"),w(X.data),K(!1)):V.yw.error(X.message),V.yw.destroy();case 7:case"end":return W.stop()}},P)}));return function(N){return U.apply(this,arguments)}}(),oe=function(){K(!1)},ie=function(){I()},be=function(P,N){T(P)},ve=function(P){return(P==null?void 0:P.type)===d.f4?"\u5BA2\u670D\u673A\u5668\u4EBA":(P==null?void 0:P.type)===d.wG?"\u8425\u9500\u673A\u5668\u4EBA":P==null?void 0:P.type};return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{margin:10},children:(0,e.jsxs)(ce.Z,{gap:"small",align:"flex-start",children:[(0,e.jsx)(v.ZP,{size:"small",type:"primary",icon:(0,e.jsx)(ne.Z,{}),onClick:ie,children:r.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,e.jsx)(v.ZP,{size:"small",onClick:g,children:r.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,e.jsx)(v.ZP,{onClick:function(){return ee(R)},size:"small",style:{float:"right"},danger:!0,disabled:(R==null?void 0:R.uid)==="",children:r.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]})}),(0,e.jsx)(z.Z,{itemLayout:"horizontal",dataSource:p.data.content,renderItem:function(P,N){return(0,e.jsx)(z.Z.Item,{style:(R==null?void 0:R.uid)===P.uid?{backgroundColor:l?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){return be(P,N)},children:(0,e.jsx)(z.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,e.jsx)($.C,{src:P.avatar}),title:(0,e.jsx)(e.Fragment,{children:y(P==null?void 0:P.nickname)}),description:ve(P)})})}}),(0,e.jsx)(Xe,{open:x,onClose:oe,onSubmit:E}),S]})},et=qe,Me=n(48096),ze=n(85322),tt=n(9220),nt=n(97857),se=n.n(nt),rt=n(66723),Ne=n(88484),je=n(90672),ot=function(){var s,t=re.Z.useForm(),l=h()(t,1),r=l[0],o=(0,_.useIntl)(),u=(0,Pe.Z)(),f=u.translateString,y=(0,j.V)(function(Z){return{currentRobot:Z.currentRobot,setCurrentRobot:Z.setCurrentRobot}}),m=y.currentRobot,p=y.setCurrentRobot,R=(0,a.useState)(""),w=h()(R,2),b=w[0],k=w[1];(0,a.useEffect)(function(){var Z=j.V.subscribe(function(S,ee){var C,g,M;r.setFieldValue("nickname",f((C=S.currentRobot)===null||C===void 0?void 0:C.nickname)),r.setFieldValue("welcomeTip",f((g=S.currentRobot)===null||g===void 0||(g=g.serviceSettings)===null||g===void 0?void 0:g.welcomeTip)),r.setFieldValue("description",f((M=S.currentRobot)===null||M===void 0?void 0:M.description))});return Z},[m]);var T=function(){var Z=O()(c()().mark(function S(ee){var C,g;return c()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return console.log("onFinish:",ee),V.yw.loading("\u6B63\u5728\u4FEE\u6539"),C=se()(se()(se()({},m),ee),{},{avatar:b}),console.log("robotObject:",C),F.next=6,(0,Fe.$l)(C);case 6:g=F.sent,console.log("updateRobot response:",g),g.code===200?(V.yw.success("\u4FEE\u6539\u6210\u529F"),p(g.data)):V.yw.error(g.message),V.yw.destroy();case 10:case"end":return F.stop()}},S)}));return function(ee){return Z.apply(this,arguments)}}(),J=function(S){console.log("handleUploadSuccess:",S),k(S)},i=function(S){console.log("handleUploadError:",S)},L=function(S){return console.log("Upload event:",S),Array.isArray(S)?S:S==null?void 0:S.fileList};return(0,a.useEffect)(function(){k(m==null?void 0:m.avatar)},[m]),(0,e.jsxs)(me.A,{form:r,onFinish:T,initialValues:{nickname:f(m==null?void 0:m.nickname),welcomeTip:f(m==null||(s=m.serviceSettings)===null||s===void 0?void 0:s.welcomeTip),description:f(m==null?void 0:m.description)},children:[(0,e.jsx)(re.Z.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:L,label:o.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,e.jsxs)(rt.G,{onSuccess:J,onError:i,children:[(0,e.jsx)($.C,{src:b}),(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(Ne.Z,{}),children:o.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,e.jsx)(We.Z,{width:"md",name:"nickname",label:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),tooltip:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),placeholder:o.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"})}),(0,e.jsx)(je.Z,{width:"md",name:"welcomeTip",label:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),tooltip:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),placeholder:o.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"})}),(0,e.jsx)(je.Z,{width:"md",name:"description",label:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),tooltip:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),placeholder:o.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"})})]})},at=function(){var t=(0,_.useIntl)(),l=(0,a.useState)(!1),r=h()(l,2),o=r[0],u=r[1],f=(0,j.V)(function(m){return m.currentRobot}),y=(0,a.useMemo)(function(){return"http://localhost:9003/chat?t="+d.xt+"&sid="+f.uid+"&"},[f]);return(0,e.jsx)(tt.Z,{onResize:function(p){u(p.width<596)},children:(0,e.jsx)(ze.Z,{split:o?"horizontal":"vertical",bordered:!0,headerBordered:!0,children:(0,e.jsx)(ze.Z,{colSpan:"50%",layout:"center",children:(0,e.jsx)(ot,{})})})},"resize-observer")};function en(s){return we.apply(this,arguments)}function we(){return we=_asyncToGenerator(_regeneratorRuntime().mark(function s(t){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/v1/kb/query",{method:"GET",params:{pageNumber:t.pageNumber,pageSize:t.pageSize,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},s)})),we.apply(this,arguments)}function lt(s,t){return Oe.apply(this,arguments)}function Oe(){return Oe=O()(c()().mark(function s(t,l){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,_.request)("/api/v1/kb/file/query",{method:"GET",params:{kbName:t,pageNumber:l.pageNumber,pageSize:l.pageSize,client:d.bV}}));case 1:case"end":return o.stop()}},s)})),Oe.apply(this,arguments)}function st(s,t){return Ze.apply(this,arguments)}function Ze(){return Ze=O()(c()().mark(function s(t,l){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,_.request)("/api/v1/kb/doc/query",{method:"GET",params:{kbName:t,pageNumber:l.pageNumber,pageSize:l.pageSize,client:d.bV}}));case 1:case"end":return o.stop()}},s)})),Ze.apply(this,arguments)}function tn(s,t){return Ke.apply(this,arguments)}function Ke(){return Ke=_asyncToGenerator(_regeneratorRuntime().mark(function s(t,l){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",request("/api/llm/kb/file/doc/update",{method:"POST",data:{did:t,pageContent:l,client:HTTP_CLIENT}}));case 1:case"end":return o.stop()}},s)})),Ke.apply(this,arguments)}function nn(s,t,l){return Ie.apply(this,arguments)}function Ie(){return Ie=_asyncToGenerator(_regeneratorRuntime().mark(function s(t,l,r){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",request("/update/doc",{method:"POST",data:{did:t,content:l,metadata:r,client:HTTP_CLIENT}}));case 1:case"end":return u.stop()}},s)})),Ie.apply(this,arguments)}function it(s){return(0,_.request)("/api/v1/kb/file/delete",{method:"POST",params:{kid:s,client:d.bV}})}function ut(s){return Ue.apply(this,arguments)}function Ue(){return Ue=O()(c()().mark(function s(t){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,_.request)("/api/v1/kb/doc/delete",{method:"POST",params:{did:t,client:d.bV}}));case 1:case"end":return r.stop()}},s)})),Ue.apply(this,arguments)}function rn(s){return Ae.apply(this,arguments)}function Ae(){return Ae=_asyncToGenerator(_regeneratorRuntime().mark(function s(t){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/delete/doc",{method:"POST",data:{did:t,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},s)})),Ae.apply(this,arguments)}var ct=n(64529),Ge=n(782),dt=n(71381),De=(0,ct.Ue)()((0,Ge.mW)((0,Ge.tJ)((0,dt.n)(function(s,t){return{kbFileResult:{},kbDocResult:{items:[]},currentKbFile:{},currentKbDoc:{fileName:"",pageContent:""},fetchFiles:function(){var l=O()(c()().mark(function o(u,f){var y;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("kbName",u," pageParams",f),p.next=3,lt(u,f);case 3:y=p.sent,console.log("kbName kbFiles",y);case 5:case"end":return p.stop()}},o)}));function r(o,u){return l.apply(this,arguments)}return r}(),deleteFile:function(){var l=O()(c()().mark(function o(u){var f,y,m,p,R;return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return console.log("delete file",u),b.next=3,it(u);case 3:f=b.sent,y=t().kbFileResult.data.content.filter(function(k){return k.uid!==u}),s(function(k){return{kbFileResult:{items:y}}}),console.log("delete file result",f),m=t().kbDocResult.data.content,p=c()().mark(function k(){var T;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:T=f.data[R],m=m.filter(function(L){return L.uid!==T});case 2:case"end":return i.stop()}},k)}),R=0;case 10:if(!(R<f.data.length)){b.next=15;break}return b.delegateYield(p(),"t0",12);case 12:R++,b.next=10;break;case 15:s(function(k){return{kbFileDocResult:{items:m}}});case 16:case"end":return b.stop()}},o)}));function r(o){return l.apply(this,arguments)}return r}(),fetchDocs:function(){var l=O()(c()().mark(function o(u,f){var y;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("fetchFileDocs kbName",u," pageParams",f),p.next=3,st(u,f);case 3:y=p.sent,console.log("kbName kbFileDocs",y);case 5:case"end":return p.stop()}},o)}));function r(o,u){return l.apply(this,arguments)}return r}(),deleteFileDoc:function(){var l=O()(c()().mark(function o(u){var f,y;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("delete file doc",u),p.next=3,ut(u);case 3:f=p.sent,console.log("delete file doc result",f),y=t().kbDocResult.data.content.filter(function(R){return R.uid!==u}),s(function(R){return{kbFileDocResult:{items:y}}});case 7:case"end":return p.stop()}},o)}));function r(o){return l.apply(this,arguments)}return r}(),setCurrentFile:function(r){var o=t().kbFileResult.data.content.find(function(u){return u.uid===r});s({currentKbFile:o})},setCurrentFileDoc:function(r){var o=t().kbDocResult.data.content.find(function(u){return u.uid===r});console.log("setCurrentFileDoc",r,o),s({currentKbDoc:o})},updateKbFileDocPython:function(){var l=O()(c()().mark(function o(u,f,y){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:console.log("updateKbFileDocPython",u,f,y);case 1:case"end":return p.stop()}},o)}));function r(o,u,f){return l.apply(this,arguments)}return r}(),deleteKbCache:function(){return s({},!0)}}}),{name:d.cn}))),ke=n(43892),Te=n(86738),de=n(45360),Be=n(85265),ye=n(42075),Le=n(55102),ft=function(){var t=(0,_.useIntl)(),l=re.Z.useForm(),r=h()(l,1),o=r[0],u=(0,j.V)(function(A){return{currentRobot:A.currentRobot}}),f=u.currentRobot,y=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),R=p[0],w=p[1],b=(0,a.useState)(20),k=h()(b,2),T=k[0],J=k[1],i=De(function(A){return{kbFileDocResult:A.kbDocResult,currentKbFileDoc:A.currentKbDoc,fetchFileDocs:A.fetchDocs,setCurrentFileDoc:A.setCurrentFileDoc,updateKbFileDocPython:A.updateKbFileDocPython}}),L=i.kbFileDocResult,Z=i.currentKbFileDoc,S=i.fetchFileDocs,ee=i.setCurrentFileDoc,C=i.updateKbFileDocPython;De.subscribe(function(A,ue){console.log("kb",A)});var g=function(){};(0,a.useEffect)(function(){g()},[]),(0,a.useEffect)(function(){g()},[R,T]),(0,a.useEffect)(function(){w(1),g()},[f]),(0,a.useEffect)(function(){y.current.reload()},[L]);var M=(0,a.useState)(!1),F=h()(M,2),x=F[0],K=F[1],I=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),E=h()(I,2),oe=E[0],ie=E[1],be=function(){K(!0)},ve=function(){K(!1)},U=function(){K(!1)},P=function(){console.log("handleInputText"),ie("\u8F93\u5165\u6587\u672C"),be()},N=function(){console.log("handleInputUrl"),ie("\u8F93\u5165\u7F51\u5740"),be()};function X(A){ee(A.did),be()}function pe(A){console.log("handleDelete",A)}var W=[{title:t.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:t.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:t.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:t.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(ue,_e){return[(0,e.jsx)(v.ZP,{type:"link",size:"small",onClick:function(){return X(_e)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Te.Z,{title:t.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return pe(_e)},onCancel:function(){return U()},children:(0,e.jsx)(v.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],Ve=function(ue){console.log("Success:",ue,Z.uid,Z.meta),C(Z.uid,ue.pageContent,Z.meta),de.ZP.success("\u66F4\u65B0\u6210\u529F"),K(!1)},xe=function(ue){console.log("Failed:",ue)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:y,columns:W,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(ue,_e,Re){return console.log("request:",ue,_e,Re),w(ue.current-1),J(ue.pageSize),Promise.resolve({data:L.data.content,success:!0,total:L.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(v.ZP,{onClick:P,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Be.Z,{title:oe,size:"default",placement:"right",onClose:U,open:x,extra:(0,e.jsx)(ye.Z,{children:(0,e.jsx)(v.ZP,{onClick:U,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(re.Z,{form:o,name:"basic",onFinish:Ve,onFinishFailed:xe,autoComplete:"off",children:[(0,e.jsx)(re.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(re.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Le.Z.TextArea,{rows:15})}),(0,e.jsx)(re.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(v.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},pt=function(){var t=(0,_.useIntl)(),l=re.Z.useForm(),r=h()(l,1),o=r[0],u=(0,j.V)(function(D){return{currentRobot:D.currentRobot}}),f=u.currentRobot,y=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),R=p[0],w=p[1],b=(0,a.useState)(20),k=h()(b,2),T=k[0],J=k[1],i=De(function(D){return{kbFileDocResult:D.kbDocResult,currentKbFileDoc:D.currentKbDoc,fetchFileDocs:D.fetchDocs,setCurrentFileDoc:D.setCurrentFileDoc,updateKbFileDocPython:D.updateKbFileDocPython}}),L=i.kbFileDocResult,Z=i.currentKbFileDoc,S=i.fetchFileDocs,ee=i.setCurrentFileDoc,C=i.updateKbFileDocPython;De.subscribe(function(D,q){});var g=function(){};(0,a.useEffect)(function(){g()},[]),(0,a.useEffect)(function(){g()},[R,T]),(0,a.useEffect)(function(){w(1),g()},[f]),(0,a.useEffect)(function(){y.current.reload()},[L]);var M=(0,a.useState)(!1),F=h()(M,2),x=F[0],K=F[1],I=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),E=h()(I,2),oe=E[0],ie=E[1],be=(0,a.useState)(""),ve=h()(be,2),U=ve[0],P=ve[1],N=function(){K(!0)},X=function(){K(!1)},pe=function(){K(!1)},W=function(){console.log("handleInputText"),ie("\u8F93\u5165\u6587\u672C"),N()},Ve=function(){console.log("handleInputUrl"),ie("\u8F93\u5165\u7F51\u5740"),N()};function xe(D){ee(D.did),N()}function A(D){console.log("handleDelete",D)}var ue=[{title:t.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:t.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:t.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:t.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(q,ge){return[(0,e.jsx)(v.ZP,{type:"link",size:"small",onClick:function(){return xe(ge)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Te.Z,{title:t.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return A(ge)},onCancel:function(){return pe()},children:(0,e.jsx)(v.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],_e=function(q){console.log("Success:",q,Z.uid,Z.meta),C(Z.uid,q.pageContent,Z.meta),de.ZP.success("\u66F4\u65B0\u6210\u529F"),K(!1)},Re=function(q){console.log("Failed:",q)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:y,columns:ue,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(q,ge,he){return console.log("request:",q,ge,he),w(q.current-1),J(q.pageSize),Promise.resolve({data:L.data.content,success:!0,total:L.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(v.ZP,{onClick:W,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Be.Z,{title:oe,size:"default",placement:"right",onClose:pe,open:x,extra:(0,e.jsx)(ye.Z,{children:(0,e.jsx)(v.ZP,{onClick:pe,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(re.Z,{form:o,name:"basic",onFinish:_e,onFinishFailed:Re,autoComplete:"off",children:[(0,e.jsx)(re.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(re.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Le.Z.TextArea,{rows:15})}),(0,e.jsx)(re.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(v.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},mt=function(){var t=(0,_.useIntl)(),l=re.Z.useForm(),r=h()(l,1),o=r[0],u=(0,j.V)(function(D){return{currentRobot:D.currentRobot}}),f=u.currentRobot,y=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),R=p[0],w=p[1],b=(0,a.useState)(20),k=h()(b,2),T=k[0],J=k[1],i=De(function(D){return{kbFileDocResult:D.kbDocResult,currentKbFileDoc:D.currentKbDoc,fetchFileDocs:D.fetchDocs,setCurrentFileDoc:D.setCurrentFileDoc,updateKbFileDocPython:D.updateKbFileDocPython}}),L=i.kbFileDocResult,Z=i.currentKbFileDoc,S=i.fetchFileDocs,ee=i.setCurrentFileDoc,C=i.updateKbFileDocPython;De.subscribe(function(D,q){o.setFieldValue("pageContent",D.currentKbDoc.content)});var g=function(){};(0,a.useEffect)(function(){g()},[]),(0,a.useEffect)(function(){g()},[R,T]),(0,a.useEffect)(function(){w(1),g()},[f]),(0,a.useEffect)(function(){y.current.reload()},[L]);var M=(0,a.useState)(!1),F=h()(M,2),x=F[0],K=F[1],I=(0,a.useState)("\u4FEE\u6539\u6587\u672C"),E=h()(I,2),oe=E[0],ie=E[1],be=(0,a.useState)(""),ve=h()(be,2),U=ve[0],P=ve[1],N=function(){K(!0)},X=function(){K(!1)},pe=function(){K(!1)},W=function(){console.log("handleInputText"),ie("\u8F93\u5165\u6587\u672C"),N()},Ve=function(){console.log("handleInputUrl"),ie("\u8F93\u5165\u7F51\u5740"),N()};function xe(D){ee(D.did),N()}function A(D){console.log("handleDelete",D)}var ue=[{title:t.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),width:150,dataIndex:"file_name"},{title:t.formatMessage({id:"pages.robot.file.content",defaultMessage:"Content"}),dataIndex:"page_content"},{title:t.formatMessage({id:"pages.robot.file.type",defaultMessage:"Type"}),width:80,dataIndex:"type"},{title:t.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(q,ge){return[(0,e.jsx)(v.ZP,{type:"link",size:"small",onClick:function(){return xe(ge)},children:"\u4FEE\u6539"},"edit"),(0,e.jsx)(Te.Z,{title:t.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return A(ge)},onCancel:function(){return pe()},children:(0,e.jsx)(v.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],_e=function(q){console.log("Success:",q,Z.uid,Z.meta),C(Z.uid,q.pageContent,Z.meta),de.ZP.success("\u66F4\u65B0\u6210\u529F"),K(!1)},Re=function(q){console.log("Failed:",q)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:y,columns:ue,headerTitle:"\u89E3\u6790\u6587\u672C\u5185\u5BB9",request:function(q,ge,he){return console.log("request:",q,ge,he),w(q.current-1),J(q.pageSize),Promise.resolve({data:L.data.content,success:!0,total:L.data.totalElements})},rowKey:"did",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(v.ZP,{onClick:W,children:"\u8F93\u5165\u95EE\u7B54\u5BF9"},"text")]}}),(0,e.jsx)(Be.Z,{title:oe,size:"default",placement:"right",onClose:pe,open:x,extra:(0,e.jsx)(ye.Z,{children:(0,e.jsx)(v.ZP,{onClick:pe,children:"\u53D6\u6D88"})}),children:(0,e.jsxs)(re.Z,{form:o,name:"basic",onFinish:_e,onFinishFailed:Re,autoComplete:"off",children:[(0,e.jsx)(re.Z.Item,{label:"\u6807\u9898",name:"fileName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898!"}]}),(0,e.jsx)(re.Z.Item,{label:"\u5185\u5BB9",name:"pageContent",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9!"}],children:(0,e.jsx)(Le.Z.TextArea,{rows:15})}),(0,e.jsx)(re.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsx)(v.ZP,{type:"primary",htmlType:"submit",children:"\u4FDD\u5B58"})})]})})]})},bt=n(66476),gt=n(27484),Qe=n.n(gt),ht=function(){var t=(0,_.useIntl)(),l=de.ZP.useMessage(),r=h()(l,2),o=r[0],u=r[1],f=(0,j.V)(function(I){return I.currentRobot}),y=(0,a.useRef)(),m=(0,a.useState)(1),p=h()(m,2),R=p[0],w=p[1],b=(0,a.useState)(10),k=h()(b,2),T=k[0],J=k[1],i=De(function(I){return{kbFileResult:I.kbFileResult,fetchFiles:I.fetchFiles,fetchFileDocs:I.fetchDocs,deleteFile:I.deleteFile}}),L=i.kbFileResult,Z=i.fetchFiles,S=i.fetchFileDocs,ee=i.deleteFile;function C(I){console.log("handleDelete",I),ee(I.uid)}function g(){console.log("handleCancel")}var M=[{title:t.formatMessage({id:"pages.robot.file.title",defaultMessage:"Title"}),dataIndex:"name"},{title:t.formatMessage({id:"pages.robot.file.action",defaultMessage:"Action"}),width:150,key:"option",valueType:"option",render:function(E,oe){return[(0,e.jsx)(Te.Z,{title:t.formatMessage({id:"pages.robot.file.delete",defaultMessage:"Delete"}),onConfirm:function(){return C(oe)},onCancel:function(){return g()},children:(0,e.jsx)(v.ZP,{type:"link",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"confirm_delete")]}}],F=function(){var E={pageNumber:R,pageSize:T};Z(f.uid,E),S(f.uid,E)};(0,a.useEffect)(function(){F()},[]),(0,a.useEffect)(function(){F()},[R,T]),(0,a.useEffect)(function(){w(1),F()},[f]),(0,a.useEffect)(function(){y.current.reload()},[L]);var x={file_name:"test.png",file_kid:Qe()(new Date).format("YYYYMMDDHHmmss"),rid:f.uid,client:d.bV},K={name:"file",action:"/api/v1/upload/file",headers:{Authorization:"Bearer "+localStorage.getItem(d.LA).replaceAll('"',"")},showUploadList:!1,data:x,beforeUpload:function(E){if(E.name.includes("_"))return de.ZP.error(t.formatMessage({id:"pages.robot.file.name_invalid",defaultMessage:"File name should not contain _"})),!1;x.file_name=E.name;var oe=Qe()(new Date).format("YYYYMMDDHHmmss");return x.file_kid=oe,x.rid=f.uid,console.log("file:",E," uploadData:",x),o.open({type:"loading",content:t.formatMessage({id:"pages.robot.file.uploading",defaultMessage:"Uploading..."}),duration:0}),!0},onChange:function(E){E.file.status!=="uploading"&&console.log(E.file,E.fileList),E.file.status==="done"?(console.log(E.file.response.data),o.destroy(),de.ZP.success("".concat(E.file.name," file uploaded successfully")),F()):E.file.status==="error"&&de.ZP.error("".concat(E.file.name," file upload failed."))}};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ke.Z,{actionRef:y,columns:M,headerTitle:f.nickname,request:function(E,oe,ie){return console.log("request:",E,oe,ie),w(E.current),J(E.pageSize),Promise.resolve({data:L.data.content,success:!0,total:L.data.totalElements})},rowKey:"kid",pagination:{showQuickJumper:!0},search:!1,toolBarRender:function(){return[(0,e.jsx)(bt.Z,se()(se()({},K),{},{children:(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(Ne.Z,{}),type:"primary",children:t.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})}),"upload")]}}),u]})},vt=function(){var t=(0,_.useIntl)(),l=[{key:"file",label:t.formatMessage({id:"pages.robot.kb.file",defaultMessage:"File"}),children:(0,e.jsx)(ht,{})},{key:"text",label:t.formatMessage({id:"pages.robot.kb.text",defaultMessage:"Text"}),children:(0,e.jsx)(ft,{})},{key:"qa",label:t.formatMessage({id:"pages.robot.kb.qa",defaultMessage:"Q&A"}),children:(0,e.jsx)(pt,{})},{key:"web",label:t.formatMessage({id:"pages.robot.kb.web",defaultMessage:"Website"}),children:(0,e.jsx)(mt,{})}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Me.Z,{tabPosition:"left",items:l})})},_t=vt,He=n(38925),Ye=n(96074),Ee=n(71230),Rt=function(){var s=(0,j.V)(function(r){return r.currentRobot}),t=function(){navigator.clipboard.writeText("/?rid="+s.uid+"&"),de.ZP.success("\u590D\u5236\u6210\u529F")},l=function(){window.open("/?rid="+s.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Ee.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+s.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(v.ZP,{onClick:t,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(v.ZP,{onClick:l,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Dt=function(){var s=(0,j.V)(function(r){return r.currentRobot}),t=function(){navigator.clipboard.writeText("/?rid="+s.uid+"&"),de.ZP.success("\u590D\u5236\u6210\u529F")},l=function(){window.open("/?rid="+s.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Ee.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+s.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(v.ZP,{onClick:t,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(v.ZP,{onClick:l,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},yt=function(){var s=(0,j.V)(function(r){return r.currentRobot}),t=function(){navigator.clipboard.writeText("/?rid="+s.uid+"&"),de.ZP.success("\u590D\u5236\u6210\u529F")},l=function(){window.open("/?rid="+s.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Ee.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+s.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(v.ZP,{onClick:t,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(v.ZP,{onClick:l,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Ct=function(){var s=(0,j.V)(function(r){return r.currentRobot}),t=function(){navigator.clipboard.writeText("/?rid="+s.uid+"&"),de.ZP.success("\u590D\u5236\u6210\u529F")},l=function(){window.open("/?rid="+s.uid+"&")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Ee.Z,{children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:"/?rid="+s.uid+"&"})}),(0,e.jsx)("div",{style:{marginLeft:10},children:(0,e.jsxs)(ye.Z,{children:[(0,e.jsx)(v.ZP,{onClick:t,children:"\u590D\u5236\u94FE\u63A5"}),(0,e.jsx)(v.ZP,{onClick:l,children:"\u6253\u5F00\u94FE\u63A5"})]})})]})})},Ft=function(){var t=(0,_.useIntl)(),l=me.A.useForm(),r=h()(l,1),o=r[0],u=(0,j.V)(function(R){return R.currentRobot}),f=(0,a.useMemo)(function(){return"http://localhost:9003/chat?t="+d.xt+"&sid="+u.uid+"&"},[u]);(0,a.useEffect)(function(){var R=j.V.subscribe(function(w){console.log("currentRobot code:",w.currentRobot),o.setFieldValue("code","http://localhost:9003/chat?t="+d.xt+"&sid="+w.currentRobot.uid+"&")});return R},[u]);var y=function(){window.open(f)},m=function(){navigator.clipboard.writeText(f),de.ZP.info("code copyied into clicpboard")},p=function(w,b){return[(0,e.jsx)(v.ZP,{type:"primary",onClick:function(){var T;(T=w.form)===null||T===void 0||T.submit(),y()},children:t.formatMessage({id:"open",defaultMessage:"Open"})},"submit"),(0,e.jsx)(v.ZP,{onClick:function(){m()},children:t.formatMessage({id:"copy",defaultMessage:"Copy"})},"reset")]};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(me.A,{form:o,style:{marginLeft:"100px"},submitter:{render:p},initialValues:{code:f},children:(0,e.jsx)(je.Z,{width:"md",name:"code",label:t.formatMessage({id:"chat.widget.code",defaultMessage:"Code"})})})})},jt=Ft,xt=function(){var t=(0,_.useIntl)(),l=me.A.useForm(),r=h()(l,1),o=r[0],u=(0,j.V)(function(R){return R.currentRobot}),f=(0,a.useMemo)(function(){return"http://localhost:9003/chat?t="+d.xt+"&sid="+u.uid+"&"},[u]);(0,a.useEffect)(function(){var R=j.V.subscribe(function(w){console.log("currentRobot code:",w.currentRobot),o.setFieldValue("code","http://localhost:9003/chat?t="+d.xt+"&sid="+w.currentRobot.uid+"&")});return R},[u]);var y=function(){window.open(f)},m=function(){navigator.clipboard.writeText(f),de.ZP.info("code copyied into clicpboard")},p=function(w,b){return[(0,e.jsx)(v.ZP,{type:"primary",onClick:function(){var T;(T=w.form)===null||T===void 0||T.submit(),y()},children:t.formatMessage({id:"open",defaultMessage:"Open"})},"submit"),(0,e.jsx)(v.ZP,{onClick:function(){m()},children:t.formatMessage({id:"copy",defaultMessage:"Copy"})},"reset")]};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(me.A,{form:o,style:{marginLeft:"100px"},submitter:{render:p},initialValues:{code:f},children:(0,e.jsx)(je.Z,{width:"md",name:"code",label:t.formatMessage({id:"chat.widget.code",defaultMessage:"Code"})})})})},St=xt,Mt=[{key:"web",label:"Web",children:(0,e.jsx)(jt,{})},{key:"h5",label:"H5",children:(0,e.jsx)(St,{})},{key:"ios",label:"iOS",children:(0,e.jsx)(Rt,{})},{key:"android",label:"Android",children:(0,e.jsx)(Ct,{})},{key:"uniapp",label:"Uniapp",children:(0,e.jsx)(Dt,{})},{key:"flutter",label:"Flutter",children:(0,e.jsx)(yt,{})}],kt=function(){var t=(0,_.useIntl)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(He.Z,{message:t.formatMessage({id:"robot.no.agent.now",defaultMessage:"agent not supported now"}),type:"success"}),(0,e.jsx)(Ye.Z,{}),(0,e.jsx)(Me.Z,{tabPosition:"left",items:Mt})]})},Tt=kt,$e=n(92369);function Et(s){var t=(0,$e.O1)({id:"draggable"}),l=t.attributes,r=t.listeners,o=t.setNodeRef,u=t.transform,f=u?{transform:"translate3d(".concat(u.x,"px, ").concat(u.y,"px, 0)")}:void 0;return(0,e.jsx)(v.ZP,se()(se()(se()({ref:o,style:f},r),l),{},{children:s.children}))}function Pt(s){var t=(0,$e.Zj)({id:"droppable"}),l=t.isOver,r=t.setNodeRef,o={color:l?"green":void 0};return(0,e.jsx)("div",{ref:r,style:o,children:s.children})}var on=Q.Z.Header,an=Q.Z.Footer,ln=Q.Z.Sider,wt=Q.Z.Content,Ot={minHeight:120},Zt=function(){var t=["A"],l=(0,a.useState)(null),r=h()(l,2),o=r[0],u=r[1],f=(0,e.jsx)(Et,{id:"draggable",children:"Drag me"});function y(b){console.log("handleDragStart",b)}function m(b){console.log("handleDragMove",b)}function p(b){console.log("handleDragOver",b)}function R(b){console.log("handleDragEnd",b);var k=b.over;u(k?k.id:null)}function w(b){console.log("handleDragCancel",b)}return(0,e.jsx)(wt,{style:Ot,children:(0,e.jsxs)($e.LB,{onDragStart:y,onDragMove:m,onDragOver:p,onDragEnd:R,children:[o===null?f:null,t.map(function(b){return(0,e.jsx)(Pt,{id:b,children:o===b?f:"Drop here ".concat(b)},b)})]})})},Kt=Zt,It=function(){var t=(0,_.useAccess)();return t.canDebug&&console.log("TabFlow canDebug"),(0,e.jsx)("div",{children:(0,e.jsx)(_.Access,{accessible:t.canDebug(),fallback:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(_.FormattedMessage,{id:d.h5})}),children:(0,e.jsx)(Kt,{})})})},Ut=It,At=n(52688),Bt=n(31199),Lt=function(){var s,t,l,r,o,u,f,y,m,p,R=re.Z.useForm(),w=h()(R,1),b=w[0],k=(0,Pe.Z)(),T=k.translateString,J=(0,j.V)(function(S){return{currentRobot:S.currentRobot,setCurrentRobot:S.setCurrentRobot}}),i=J.currentRobot,L=J.setCurrentRobot;j.V.subscribe(function(S,ee){var C,g,M,F,x,K;b.setFieldValue("topK",(C=S.currentRobot)===null||C===void 0||(C=C.llm)===null||C===void 0?void 0:C.topK),b.setFieldValue("scoreThreshold",(g=S.currentRobot)===null||g===void 0||(g=g.llm)===null||g===void 0?void 0:g.scoreThreshold),b.setFieldValue("model",(M=S.currentRobot)===null||M===void 0||(M=M.llm)===null||M===void 0?void 0:M.model),b.setFieldValue("embeddings",(F=S.currentRobot)===null||F===void 0||(F=F.llm)===null||F===void 0?void 0:F.embeddings),b.setFieldValue("temperature",(x=S.currentRobot)===null||x===void 0||(x=x.llm)===null||x===void 0?void 0:x.temperature),b.setFieldValue("prompt",(K=S.currentRobot)===null||K===void 0||(K=K.llm)===null||K===void 0?void 0:K.prompt)});var Z=function(){var S=O()(c()().mark(function ee(C){var g,M;return c()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return console.log("handleSubmit",C),V.yw.loading("\u6B63\u5728\u4FEE\u6539"),g=se()(se()({},i),{},{llm:C}),console.log("robotObject:",g),x.next=6,(0,Fe.$l)(g);case 6:M=x.sent,console.log("updateRobot response:",M),M.code===200?(V.yw.destroy(),V.yw.success("\u4FEE\u6539\u6210\u529F"),L(M.data)):(V.yw.destroy(),V.yw.error(M.message));case 9:case"end":return x.stop()}},ee)}));return function(C){return S.apply(this,arguments)}}();return(0,e.jsxs)(me.A,{form:b,size:"large",onFinish:Z,initialValues:{enabled:i==null||(s=i.llm)===null||s===void 0?void 0:s.enabled,topK:i==null||(t=i.llm)===null||t===void 0?void 0:t.topK,scoreThreshold:i==null||(l=i.llm)===null||l===void 0?void 0:l.scoreThreshold,model:i==null||(r=i.llm)===null||r===void 0?void 0:r.model,embeddings:i==null||(o=i.llm)===null||o===void 0?void 0:o.embeddings,temperature:i==null||(u=i.llm)===null||u===void 0?void 0:u.temperature,prompt:T(i==null||(f=i.llm)===null||f===void 0?void 0:f.prompt),apiKey:i==null||(y=i.llm)===null||y===void 0?void 0:y.apiKey,apiSecret:i==null||(m=i.llm)===null||m===void 0?void 0:m.apiSecret,apiUrl:i==null||(p=i.llm)===null||p===void 0?void 0:p.apiUrl},children:[(0,e.jsx)(At.Z,{width:"lg",name:"enabled",label:"enabled",tooltip:"\u662F\u5426\u542F\u7528\u5927\u6A21\u578B"}),(0,e.jsx)(je.Z,{width:"lg",name:"prompt",label:"prompt",placeholder:"\u8BF7\u8F93\u5165prompt"}),(0,e.jsx)(Se.Z,{width:"lg",name:"model",label:"model",allowClear:!0,options:[{value:"ZHIPUAI_GLM_3_TURBO",label:"\u667A\u8C31AI-GLM-3-Turbo"},{value:"ZHIPUAI_GLM_4",label:"\u667A\u8C31AI-GLM-4"},{value:"OLLAMA",label:"Ollama",disabled:!0},{value:"OPENAI",label:"OpenAi",disabled:!0}]}),(0,e.jsx)(Se.Z,{width:"lg",name:"embeddings",label:"embeddings",allowClear:!0,options:[{value:"M3E_BASE",label:"m3e-base"}]}),(0,e.jsx)(Bt.Z,{width:"lg",label:"\u6E29\u5EA6",name:"temperature",min:0,max:1,fieldProps:{precision:1,step:.1}})]})},$t=n(9465),Vt=function(){var t,l=(0,_.useIntl)(),r=me.A.useForm(),o=h()(r,1),u=o[0],f=(0,B.u)(function(C){return C.orgCurrent}),y=(0,a.useState)(),m=h()(y,2),p=m[0],R=m[1],w=(0,a.useState)([]),b=h()(w,2),k=b[0],T=b[1],J=(0,j.V)(function(C){return{currentRobot:C.currentRobot,setCurrentRobot:C.setCurrentRobot}}),i=J.currentRobot,L=J.setCurrentRobot,Z=function(){var C=O()(c()().mark(function g(){var M,F,x,K;return c()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return V.yw.loading("\u52A0\u8F7D\u4E2D"),F={pageNumber:0,pageSize:50,orgUid:f.uid},E.next=4,(0,$t.qL)(F);case 4:x=E.sent,console.log("getAllQuickbuttons response:",F,x),V.yw.destroy(),x.code===200?R(x):V.yw.error(x.message),K=[],(M=i.serviceSettings)===null||M===void 0||M.quickButtons.forEach(function(oe){K.push(oe.uid)}),T(K);case 11:case"end":return E.stop()}},g)}));return function(){return C.apply(this,arguments)}}();(0,a.useEffect)(function(){Z()},[f]),(0,a.useEffect)(function(){var C=j.V.subscribe(function(g){var M;console.log("TabQuickButton useRobotStore:",g);var F=[];(M=g.currentRobot.serviceSettings)===null||M===void 0||M.quickButtons.forEach(function(x){F.push(x.uid)}),T(F)});return C},[i]);var S=function(){var C=O()(c()().mark(function g(M){var F,x;return c()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return console.log("onFinish",M),F=se()(se()({},i),{},{serviceSettings:se()(se()({},i.serviceSettings),{},{quickButtonUids:M.quickbutton})}),console.log("robotObject:",F),I.next=5,(0,Fe.$l)(F);case 5:x=I.sent,console.log("updateRobot response:",x),x.code===200?(V.yw.destroy(),V.yw.success("\u4FEE\u6539\u6210\u529F"),L(x.data)):(V.yw.destroy(),V.yw.error(x.message));case 8:case"end":return I.stop()}},g)}));return function(M){return C.apply(this,arguments)}}(),ee=function(g){console.log("selected ".concat(g)),T(g)};return(0,e.jsxs)("div",{children:[(0,e.jsx)(He.Z,{message:l.formatMessage({id:"quickbutton.guide",defaultMessage:"Please goto Knowledge base -> QuickButton -> Create, then add quickbutton here"}),type:"success"}),(0,e.jsx)(Ye.Z,{}),(0,e.jsx)(me.A,{form:u,layout:"vertical",initialValues:{},onFinish:S,children:(0,e.jsx)(Se.Z,{name:"quickbutton",width:"md",label:l.formatMessage({id:"quickbutton",defaultMessage:"QuickButton"}),options:p==null||(t=p.data)===null||t===void 0?void 0:t.content.map(function(C){return{label:C.title,value:C.uid}}),fieldProps:{mode:"multiple",onChange:ee,allowClear:!0,value:k,placeholder:"\u8BF7\u9009\u62E9"}})})]})},Wt=Vt,zt=function(){var t=(0,_.useIntl)(),l=[{key:"quickbutton",label:t.formatMessage({id:"quickbutton",defaultMessage:"QuickButton"}),children:(0,e.jsx)(Wt,{})},{key:"llm",label:t.formatMessage({id:"llm",defaultMessage:"LLM"}),children:(0,e.jsx)(Lt,{})}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Me.Z,{tabPosition:"left",items:l})})},Nt=zt,Gt=function(){var t=(0,_.useIntl)(),l=function(u){},r=[{key:"basic",label:t.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,e.jsx)(at,{})},{key:"kb",label:t.formatMessage({id:"pages.robot.tab.kb",defaultMessage:"Knowledge Base"}),children:(0,e.jsx)(_t,{})},{key:"advanced",label:t.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,e.jsx)(Nt,{})},{key:"flow",label:t.formatMessage({id:"pages.robot.tab.flow",defaultMessage:"Flow"}),children:(0,e.jsx)(Ut,{})},{key:"channel",label:t.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,e.jsx)(Tt,{})}];return(0,e.jsx)(Me.Z,{defaultActiveKey:"1",items:r,onChange:l})},Qt=Gt,Ht=n(77154),Yt=Q.Z.Sider,Jt=Q.Z.Content,Xt=function(){var t=(0,Ht.Z)(),l=t.leftSiderStyle,r=t.contentStyle;return(0,e.jsxs)(Q.Z,{children:[(0,e.jsx)(Yt,{width:250,style:l,children:(0,e.jsx)(et,{})}),(0,e.jsx)(Q.Z,{children:(0,e.jsx)(Jt,{style:r,children:(0,e.jsx)(Qt,{})})})]})},qt=Xt},37326:function(Ce,ae,n){n.d(ae,{V:function(){return j}});var Q=n(97857),a=n.n(Q),fe=n(19632),c=n.n(fe),le=n(85615),O=n(64529),te=n(782),h=n(71381),j=(0,O.Ue)()((0,te.mW)((0,te.tJ)((0,h.n)(function(H,ce){return{robotResult:{data:{content:[]}},currentRobot:{uid:"",nickname:""},insertRobot:function(z){H(function($){var G=$.robotResult.data.content;G.unshift(z)})},setRobotResult:function(z){H({robotResult:z});var $=ce().currentRobot;if($.uid===""||$===void 0){var G;((G=z.data)===null||G===void 0||(G=G.content)===null||G===void 0?void 0:G.length)>0&&H({currentRobot:z.data.content[0]})}},setCurrentRobot:function(z){var $=ce().robotResult.data.content,G=$.findIndex(function(Y){return Y.uid===z.uid});if(G!==-1){var ne=[].concat(c()($.slice(0,G)),[z],c()($.slice(G+1))),_=a()(a()({},ce().robotResult),{},{data:{content:ne}});H({robotResult:_,currentRobot:z})}else console.warn("Robot with the specified uid not found."),H({currentRobot:z})},deleteCurrentRobot:function(z){var $=ce().robotResult.data.content,G=$.findIndex(function(ne){return ne.uid===z});G!==-1?H({robotResult:a()(a()({},ce().robotResult),{},{data:{content:[].concat(c()($.slice(0,G)),c()($.slice(G+1)))}})}):console.warn("Robot not found in cache:",z),ce().currentRobot.uid===z&&H({currentRobot:{uid:""}})},deleteRobotCache:function(){return H({},!0)}}}),{name:le.Ei})))},66723:function(Ce,ae,n){n.d(ae,{G:function(){return H}});var Q=n(97857),a=n.n(Q),fe=n(67294),c=n(66476),le=n(85615),O=n(27484),te=n.n(O),h=n(80049),j=n(85893),H=function(v){var z=v.children,$=v.onSuccess,G=v.onError,ne={file:null,file_name:"test.png",file_type:"image/png"},_={name:"file",action:"/api/v1/upload/file",headers:{Authorization:"Bearer "+localStorage.getItem(le.LA)},data:ne,showUploadList:!1,beforeUpload:function(B){console.log("beforeUpload",B);var d=te()(new Date).format("YYYYMMDDHHmmss")+"_"+B.name;ne.file=B,ne.file_name=d,ne.file_type=B.type,console.log("beforeUpload",ne)},onChange:function(B){if(B.file.status!=="uploading"&&console.log(B.file,B.fileList),B.file.status==="done"){var d=B.file.response.data;console.log("url: ",d),$(d),h.yw.success("".concat(B.file.name," \u4E0A\u4F20\u6210\u529F"))}else B.file.status==="error"&&(h.yw.error("".concat(B.file.name," \u4E0A\u4F20\u5931\u8D25")),G(B.file))}};return(0,j.jsx)(c.Z,a()(a()({},_),{},{children:z}))}}}]);
