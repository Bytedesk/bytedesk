"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1730],{87223:function(F,h,e){e.r(h);var C=e(15009),d=e.n(C),v=e(97857),E=e.n(v),R=e(99289),c=e.n(R),L=e(5574),D=e.n(L),p=e(98661),w=e(59203),Z=e(87547),I=e(94149),S=e(24454),k=e(10915),z=e(68262),U=e(5966),$=e(16434),N=e(24556),l=e(86745),A=e(9361),G=e(40056),H=e(32983),V=e(14726),Y=e(28459),J=e(31418),T=e(67294),y=e(39825),o=e(80049),P=e(85615),Q=e(63998),X=e(73935),q=e(60247),b=e(66419),s=e(85893),ee=A.Z.defaultAlgorithm,se=A.Z.darkAlgorithm,ae=function(){var f=(0,N.l)(function(M){var O=M.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:O.borderRadius,":hover":{backgroundColor:O.colorBgTextHover}}});return(0,s.jsx)("div",{className:f,"data-lang":!0,children:l.SelectLang&&(0,s.jsx)(l.SelectLang,{})})},W=function(f){var M=f.content;return(0,s.jsx)(G.Z,{style:{marginBottom:24},message:M,type:"error",showIcon:!0})},ne=function(){var f=A.Z.useToken(),M=f.token,O=(0,y.Z)(),te=O.isDarkMode,x=(0,T.useRef)(),j=(0,l.useModel)("@@initialState"),Me=j.initialState,Ee=j.loading,he=j.refresh,ie=j.setInitialState,oe=(0,T.useState)(!1),K=D()(oe,2),_e=K[0],le=K[1],ue=(0,Q.t)(function(i){return i.setAccessToken}),de=(0,q.L)(function(i){return i.setUserInfo}),ge=(0,l.getLocale)();console.log("register page locale:",ge);var g=(0,l.useIntl)();(0,T.useEffect)(function(){var i=window.location.href;(0,b.qx)(b.Hw,i)&&le(!0)},[]);var me=function(){var i=c()(d()().mark(function t(a){return d()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:a&&(0,X.flushSync)(function(){ie(function(m){return E()(E()({},m),{},{userInfo:a})})});case 1:case"end":return _.stop()}},t)}));return function(a){return i.apply(this,arguments)}}(),ce=function(){var i=c()(d()().mark(function t(a){var r,_,m;return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,console.log("values:",a),o.yw.loading("\u6B63\u5728\u6CE8\u518C\uFF0C\u8BF7\u7A0D\u540E..."),u.next=5,(0,p.z2)(E()({},a));case 5:if(r=u.sent,console.log("registerResult:",r),r.code!==200){u.next=15;break}return o.yw.destroy(),o.yw.success(r.message),_={username:a.email,password:a.password,platform:P.iw},pe(_),u.abrupt("return");case 15:o.yw.destroy(),o.yw.error(r.message);case 17:u.next=24;break;case 19:u.prev=19,u.t0=u.catch(0),m=g.formatMessage({id:"pages.register.failure",defaultMessage:"\u6CE8\u518C\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(u.t0),o.yw.error(m);case 24:case"end":return u.stop()}},t,null,[[0,19]])}));return function(a){return i.apply(this,arguments)}}(),pe=function(){var i=c()(d()().mark(function t(a){var r,_;return d()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("handleSubmit values: ",a),o.yw.loading("\u6B63\u5728\u767B\u5F55..."),n.next=5,(0,p.x4)(E()({},a));case 5:r=n.sent,console.log("LoginResult:",r),r.code===200?(o.yw.destroy(),o.yw.success("\u767B\u5F55\u6210\u529F\uFF01"),me(r.data.user),de(r.data.user),ue(r.data.accessToken),l.history.push("/")):(o.yw.destroy(),o.yw.error(r.message)),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(0),_=g.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(n.t0),o.yw.error(_);case 15:case"end":return n.stop()}},t,null,[[0,10]])}));return function(a){return i.apply(this,arguments)}}(),fe=function(){setTimeout(function(){var t;console.log("endCaptchaTiming"),(t=x.current)===null||t===void 0||t.endTiming()},2)};return(0,s.jsxs)(k._Y,{hashed:!1,dark:te,children:[(0,s.jsx)(ae,{}),(0,s.jsx)("div",{style:{backgroundColor:M.colorBgContainer,textAlign:"center",height:"100vh",backgroundImage:"url('/admin/assets/images/bg-wide.png')"},children:_e?(0,s.jsxs)(z.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,s.jsx)("img",{alt:"logo",src:"/admin/icons/logo.png"}),title:(0,s.jsx)(l.FormattedMessage,{id:"app.title"}),subTitle:g.formatMessage({id:"pages.login.registerAccount"}),initialValues:{autoLogin:!0},submitter:{searchConfig:{submitText:g.formatMessage({id:"pages.login.register"})}},onFinish:function(){var i=c()(d()().mark(function t(a){var r;return d()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return console.log("login values:",a),r={email:a.username,password:a.password,mobile:a.mobile,code:a.code,platform:P.iw},console.log("register info:",r),m.next=5,ce(r);case 5:case"end":return m.stop()}},t)}));return function(t){return i.apply(this,arguments)}}(),children:[status==="error"&&(0,s.jsx)(W,{content:g.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),(0,s.jsx)(U.Z,{name:"username",fieldProps:{size:"large",prefix:(0,s.jsx)(Z.Z,{})},placeholder:g.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u90AE\u7BB1"}),rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u90AE\u7BB1!"})},{pattern:/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/,message:"\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E"},{max:50,message:"\u90AE\u7BB1\u4E0D\u5F97\u8D85\u8FC750\u5B57\u7B26"}]}),(0,s.jsx)(U.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,s.jsx)(I.Z,{})},placeholder:g.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]}),(0,s.jsx)(U.Z,{fieldProps:{size:"large",prefix:(0,s.jsx)(S.Z,{})},name:"mobile",placeholder:g.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,s.jsx)($.Z,{fieldProps:{size:"large",prefix:(0,s.jsx)(I.Z,{})},captchaProps:{size:"large"},placeholder:g.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(t,a){return t?"".concat(a," ").concat(g.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):g.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],fieldRef:x,onGetCaptcha:function(){var i=c()(d()().mark(function t(a){var r,_;return d()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(a&&a.length===11)){n.next=13;break}return r={mobile:a,type:P.i_,platform:P.iw},n.next=4,(0,p.Y7)(r);case 4:if(_=n.sent,console.log("sendMobileCodeResult:",_),_.code===200){n.next=10;break}return o.yw.error(_.message),fe(),n.abrupt("return");case 10:o.yw.success(_.message),n.next=14;break;case 13:o.yw.error("\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF");case 14:case"end":return n.stop()}},t)}));return function(t){return i.apply(this,arguments)}}()}),status==="error"&&(0,s.jsx)(W,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),(0,s.jsx)("div",{style:{marginBottom:64},children:(0,s.jsx)("div",{style:{float:"right"},children:(0,s.jsx)(l.Link,{to:"/auth/login",children:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.submit",defaultMessage:"\u767B\u5F55 "})})})})]}):(0,s.jsx)("div",{style:{textAlign:"center",margin:"0 auto"},children:(0,s.jsx)(H.Z,{description:"only for vip users, please contact: 270580156@qq.com",children:(0,s.jsx)(V.ZP,{type:"primary",onClick:function(){window.open("https://www.weiyuai.cn")},children:"open weiyuai.cn"})})})}),(0,s.jsx)(w.$_,{})]})},re=function(){var f=(0,y.Z)(),M=f.isDarkMode;return(0,s.jsx)(Y.ZP,{theme:{algorithm:M?se:ee},children:(0,s.jsxs)(J.Z,{children:[(0,s.jsx)(o.ZP,{}),(0,s.jsx)(ne,{})]})})};h.default=re},60247:function(F,h,e){e.d(h,{L:function(){return R}});var C=e(85615),d=e(64529),v=e(782),E=e(71381),R=(0,d.Ue)()((0,v.mW)((0,v.tJ)((0,E.n)(function(c,L){return{userInfo:{uid:""},deviceUid:"",setUserInfo:function(p){c({userInfo:p})},setDeviceUid:function(p){c({deviceUid:p})},deleteUserInfo:function(){return c({},!0)}}}),{name:C.Em})))}}]);
