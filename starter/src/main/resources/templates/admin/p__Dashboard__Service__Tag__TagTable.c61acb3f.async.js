"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2701],{46046:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(73193),a=n.n(r),o=n(84176),l=n.n(o),u=n(90819),s=n.n(u),c=n(89933),i=n.n(c),d=n(45332),p=n.n(d),f=n(86803),g=n(55735),m=n(30921);function h(e){return v.apply(this,arguments)}function v(){return(v=i()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/tag/query/org",{method:"GET",params:a()(a()({},t),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return x.apply(this,arguments)}function x(){return x=i()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/tag/create",{method:"POST",data:a()(a()({},t),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=i()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/tag/update",{method:"POST",data:a()(a()({},t),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return j.apply(this,arguments)}function j(){return j=i()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/tag/delete",{method:"POST",data:a()(a()({},t),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}var k=n(40612),S=n(15722),T=n(25482),C=n(72381),F=n(29266),Z=n(53530),I=n(75365),A=n(44194),q=n(69169),D=n(4499),O=n(84881),P=n(73442),E=n(31549),V=function(e){var t=e.isEdit,n=e.tag,r=e.open,o=e.onClose,l=e.onSubmit,u=q.A.useForm(),s=p()(u,1)[0],c=(0,k.u)((function(e){return e.currentOrg})),i=(0,A.useState)([]),d=p()(i,2),f=d[0],m=d[1],h=(0,A.useState)([]),v=p()(h,2),b=v[0],x=v[1];(0,A.useEffect)((function(){t?(s.setFieldsValue({uid:null==n?void 0:n.uid,name:null==n?void 0:n.name,color:null==n?void 0:n.color,type:null==n?void 0:n.type}),x([null==n?void 0:n.color]),m([null==n?void 0:n.type])):s.setFieldsValue({name:"",color:"red",type:g.IuT})}),[t,n,s]);return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(P.Z,{title:"标签",onClose:o,open:r,children:(0,E.jsxs)(q.A,{form:s,name:"tagForm",onFinish:function(){console.log("handleSubmit"),s.validateFields().then((function(e){var t=a()(a()({},e),{},{orgUid:null==c?void 0:c.uid});console.log("submit",t),l(t)}))},children:[(0,E.jsx)(D.Z,{label:"名称",name:"name",rules:[{required:!0}]}),(0,E.jsx)(O.Z,{name:"color",label:"颜色",width:"md",options:[{label:"red",value:"red"},{label:"magenta",value:"magenta"},{label:"volcano",value:"volcano"},{label:"orange",value:"orange"},{label:"gold",value:"gold"},{label:"lime",value:"lime"},{label:"green",value:"green"},{label:"cyan",value:"cyan"},{label:"blue",value:"blue"},{label:"geekblue",value:"geekblue"},{label:"purple",value:"purple"},{label:"#f50",value:"#f50"}],fieldProps:{allowClear:!0,placeholder:"请选择颜色",value:b,onChange:function(e){console.log("selected color ".concat(e)),x(e)}}}),(0,E.jsx)(O.Z,{name:"type",label:"类型",width:"md",options:[{label:"会话标签",value:g.bDv},{label:"客户标签",value:g.IuT}],fieldProps:{allowClear:!0,placeholder:"请选择类型",value:f,onChange:function(e){console.log("selected type ".concat(e)),m(e)}}})]})})})},B=n(28977),Y=n.n(B),z=(n(44521),["current","pageSize"]),R=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,E.jsx)(m.FormattedMessage,{id:"name",defaultMessage:"Name"}),dataIndex:"name",copyable:!0,render:function(e,t){return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(F.Z,{color:t.color,children:t.name})})}},{title:(0,E.jsx)(m.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInSearch:!0,render:function(e,t){return(0,E.jsxs)(E.Fragment,{children:[t.type===g.bDv&&(0,E.jsx)(F.Z,{color:"blue",children:"会话标签"}),t.type===g.IuT&&(0,E.jsx)(F.Z,{color:"green",children:"客户标签"})]})}},{title:(0,E.jsx)(m.FormattedMessage,{id:"color",defaultMessage:"Color"}),dataIndex:"color",hideInSearch:!0,render:function(e,t){return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(F.Z,{color:t.color,children:t.color})})}},{title:(0,E.jsx)(m.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,render:function(e,t,n,r){return Y()(t.createdAt).format("YYYY-MM-DD HH:mm:ss")}}],U=function(){var e=(0,m.useIntl)(),t=(0,A.useRef)(),n=(0,A.useState)(1),r=p()(n,2),o=(r[0],r[1]),u=(0,A.useState)(10),c=p()(u,2),d=(c[0],c[1]),g=(0,k.u)((function(e){return e.currentOrg})),v=(0,A.useState)(!1),x=p()(v,2),w=x[0],j=x[1],F=(0,A.useState)({}),q=p()(F,2),D=q[0],O=q[1],P=(0,A.useState)(!1),B=p()(P,2),Y=B[0],U=B[1],H=Z.Z.useModal(),N=p()(H,2),G=N[0],J=N[1],K=[].concat(R,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",render:function(t,n,r,a){return[(0,E.jsx)("a",{onClick:function(){O(n),U(!0),j(!0)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,E.jsx)(I.ZP,{type:"link",onClick:function(){return function(t){G.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,E.jsx)(S.Z,{}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(t.name,"】？"),onOk:function(){Q(t)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})}(n)},danger:!0,children:e.formatMessage({id:"delete",defaultMessage:"Delete"})},"delete")]}}]),Q=function(){var n=i()(s()().mark((function n(r){var a;return s()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("deleteTag:",r),n.next=3,M(r);case 3:a=n.sent,console.log("deleteMember:",a),200===a.code?(f.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),t.current.reload()):f.yw.error(a.message);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),W=function(){var e=i()(s()().mark((function e(n){var r,a;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(n);case 2:r=e.sent,console.log("handleCreateTag response:",r),200===r.code?(null===(a=t.current)||void 0===a||a.reload(),j(!1)):f.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=i()(s()().mark((function e(n){var r,a;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.uid=null==D?void 0:D.uid,e.next=3,y(n);case 3:r=e.sent,console.log("handleUpdateTag response:",r),200===r.code?(null===(a=t.current)||void 0===a||a.reload(),j(!1)):f.yw.error(r.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){j(!0),U(!1),O({})};return(0,E.jsxs)(E.Fragment,{children:[w&&(0,E.jsx)(V,{isEdit:Y,open:w,tag:D,onClose:function(){j(!1)},onSubmit:function(e){console.log("onDrawerSubmit:",e),Y?L(e):W(e)}}),(0,E.jsx)(C.Z,{columns:K,actionRef:t,cardBordered:!0,request:function(){var e=i()(s()().mark((function e(t,n,r){var u,c,i,p,m;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.current,c=t.pageSize,i=l()(t,z),o(u),d(c),p=a()({pageNumber:u-1,pageSize:c,orgUid:null==g?void 0:g.uid},i),e.next=6,h(p);case 6:return m=e.sent,console.log("queryTagsByOrg response:",m,p),200===m.code||f.yw.error(m.message),e.abrupt("return",{data:m.data.content,success:!0,total:m.data.totalElements});case 10:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"标签列表",toolBarRender:function(){return[(0,E.jsx)(I.ZP,{type:"primary",icon:(0,E.jsx)(T.Z,{}),onClick:X,children:e.formatMessage({id:"create",defaultMessage:"Create"})})]}}),J]})}}}]);