"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9828],{93428:function(e,t,r){r.r(t),r.d(t,{default:function(){return Fe}});var n=r(21612),s=r(67294),a=r(15009),o=r.n(a),i=r(99289),l=r.n(i),u=r(5574),d=r.n(u),c=r(80049),g=r(3418),f=r(21317),p=r(39825),m=r(30694),v=r(87676),h=r(18678),k=r(11475),y=r(64789),x=r(86745),b=r(85576),j=r(86250),Z=r(14726),M=r(2487),w=r(7134),F=r(73803),S=r(34994),C=r(5966),q=r(64317),W=r(85893),D=function(e){var t=e.open,r=e.onClose,n=e.onSubmit,a=S.A.useForm(),o=d()(a,1)[0],i=(0,F.Z)().translateString,l=(0,v.u)((function(e){return e.currentOrg})),u=(0,m.E)((function(e){return e.agentResult})),c=(0,s.useState)([]),g=d()(c,2),f=g[0],p=g[1];return(0,W.jsx)("div",{children:(0,W.jsx)(b.Z,{title:"创建技能组",open:t,forceRender:!0,onOk:function(){console.log("handleOk"),o.validateFields().then((function(e){console.log("form values:",e);var t={nickname:o.getFieldValue("nickname"),agentUids:o.getFieldValue("agents"),orgUid:l.uid};console.log("workgroup:",t),n(t)})).catch((function(e){console.log("Form errors:",e)}))},onCancel:function(){console.log("handleCancel"),r()},children:(0,W.jsxs)(S.A,{form:o,name:"wgForm",submitter:{render:function(e,t){return(0,W.jsx)(W.Fragment,{})}},children:[(0,W.jsx)(C.Z,{label:"技能组昵称",name:"nickname",rules:[{required:!0,message:"请输入昵称!"}]}),(0,W.jsx)(q.Z,{name:"agents",label:"成员",options:u.data.content.map((function(e){return{value:e.uid,label:i(e.nickname)}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:"请选择成员",value:f,onChange:function(e){console.log("selected ".concat(e)),p(e)}}})]})})})},P=function(){var e=(0,x.useIntl)(),t=(0,s.useRef)(!1),r=(0,F.Z)().translateStringTranct,n=(0,p.Z)().isDarkMode,a=(0,s.useState)(!1),i=d()(a,2),u=i[0],S=i[1],C=(0,v.u)((function(e){return e.currentOrg})),q=(0,m.E)((function(e){return e.setAgentResult})),P=(0,h.$)((function(e){return{workgroupResult:e.workgroupResult,currentWorkgroup:e.currentWorkgroup,setWorkgroupResult:e.setWorkgroupResult,insertWorkgroup:e.insertWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup,deleteCurrentWorkgroup:e.deleteCurrentWorkgroup}})),U=P.workgroupResult,A=P.currentWorkgroup,R=P.setWorkgroupResult,E=P.insertWorkgroup,T=P.setCurrentWorkgroup,I=P.deleteCurrentWorkgroup,V=b.Z.useModal(),z=d()(V,2),G=z[0],L=z[1],B=function(t){G.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,W.jsx)(k.Z,{}),content:"".concat(e.formatMessage({id:"deleteAfirm",defaultMessage:"Delete"}),"【").concat(t.nickname,"】？"),onOk:function(){O(t)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})},O=function(){var t=l()(o()().mark((function t(r){var n;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("delete workgroup",r),c.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),t.next=4,(0,f.zl)(r);case 4:n=t.sent,console.log("delete workgroup response",n),200===n.code?(c.yw.destroy(),c.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),I(r.uid)):(c.yw.destroy(),c.yw.error(n.message));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=function(){var e=l()(o()().mark((function e(){var t,r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pageNumber:0,pageSize:50,orgUid:C.uid},e.next=3,(0,g._t)(t);case 3:r=e.sent,console.log("queryAgentsByOrg: ",r),200===r.code?q(r):c.yw.error(r.message);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=l()(o()().mark((function e(){var r,n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.current){e.next=3;break}return console.log("isLoading: 1",t.current),e.abrupt("return");case 3:return t.current=!0,c.yw.loading("loading"),r={pageNumber:0,pageSize:50,orgUid:C.uid},e.next=8,(0,f.u7)(r);case 8:n=e.sent,console.log("getWorkgroups",n),200===n.code?(c.yw.destroy(),R(n)):(c.yw.destroy(),c.yw.error(n.message)),t.current=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){H(),N()}),[]);var Q=function(){var t=l()(o()().mark((function t(r){var n;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("handleSave",r),c.yw.loading(e.formatMessage({id:"creating",defaultMessage:"Creating"})),t.next=4,(0,f.p0)(r);case 4:n=t.sent,console.log("create workgroup:",n),200===n.code?(c.yw.destroy(),c.yw.success(e.formatMessage({id:"create.success",defaultMessage:"create success"})),S(!1),E(n.data)):(c.yw.destroy(),S(!1),c.yw.error(n.message));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(j.Z,{style:{margin:10},gap:"small",align:"flex-start",children:[(0,W.jsx)(Z.ZP,{size:"small",type:"primary",icon:(0,W.jsx)(y.Z,{}),onClick:function(){S(!0)},children:e.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,W.jsx)(Z.ZP,{size:"small",onClick:H,children:e.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,W.jsx)(Z.ZP,{onClick:function(){return B(A)},size:"small",danger:!0,disabled:A&&""===A.uid,children:e.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,W.jsx)(M.Z,{itemLayout:"horizontal",dataSource:U.data.content,renderItem:function(e,t){return(0,W.jsx)(M.Z.Item,{style:A.uid===e.uid?{backgroundColor:n?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){T(e)},children:(0,W.jsx)(M.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,W.jsx)(w.C,{src:e.avatar}),title:(0,W.jsx)(W.Fragment,{children:r(e.nickname)}),description:r(e.description)})})}}),(0,W.jsx)(D,{open:u,onClose:function(){S(!1)},onSubmit:Q}),L]})},U=r(11941),A=r(97857),R=r.n(A),E=r(90672),T=r(8232),I=r(88484),V=r(53004),z=function(){var e=S.A.useForm(),t=d()(e,1)[0],r=(0,x.useIntl)(),n=(0,F.Z)().translateString,a=(0,m.E)((function(e){return e.agentResult})),i=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),u=i.currentWorkgroup,g=i.setCurrentWorkgroup,p=(0,s.useState)([]),v=d()(p,2),k=v[0],y=v[1],b=(0,s.useState)(""),j=d()(b,2),M=j[0],D=j[1];(0,s.useEffect)((function(){if(u){var e;t.setFieldValue("nickname",n(null==u?void 0:u.nickname)),t.setFieldValue("description",n(null==u?void 0:u.description));var r=[];null===(e=u.agents)||void 0===e||e.forEach((function(e){r.push(e.uid)})),y(r)}}),[u]);var P=function(){var e=l()(o()().mark((function e(t){var n,s,a,i,l,d,p,m,v;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish",t),c.yw.loading("修改中..."),m=R()(R()(R()({},u),t),{},{avatar:M,agentUids:k,serviceSettings:R()(R()({},u.serviceSettings),{},{robotUid:null===(n=u.serviceSettings)||void 0===n||null===(n=n.robot)||void 0===n?void 0:n.uid,quickFaqUids:null===(s=u.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==u||null===(a=u.serviceSettings)||void 0===a||null===(a=a.faqs)||void 0===a?void 0:a.map((function(e){return e.uid})),guessFaqUids:null==u||null===(i=u.serviceSettings)||void 0===i||null===(i=i.guessFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),hotFaqUids:null===(l=u.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==u||null===(d=u.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),worktimeUids:null===(p=u.serviceSettings)||void 0===p||null===(p=p.worktimes)||void 0===p?void 0:p.map((function(e){return e.uid}))})}),console.log("workgroupObject:",m),e.next=6,(0,f.W5)(m);case 6:v=e.sent,console.log("updateWorkGroup response:",v),200===v.code?(c.yw.destroy(),c.yw.success(r.formatMessage({id:"update.success"})),g(v.data)):(c.yw.destroy(),c.yw.error(v.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){D(null==u?void 0:u.avatar)}),[u]),(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(S.A,{form:t,style:{marginLeft:"100px",width:"300px"},onFinish:P,children:[(0,W.jsx)(T.Z.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:r.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,W.jsxs)(V.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e),D(e)},onError:function(e){console.log("handleUploadError:",e)},children:[(0,W.jsx)(w.C,{src:M}),(0,W.jsx)(Z.ZP,{icon:(0,W.jsx)(I.Z,{}),children:r.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,W.jsx)(C.Z,{width:"md",name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入技能组昵称"}]}),(0,W.jsx)(q.Z,{name:"agents",label:"成员",width:"md",options:a.data.content.map((function(e){return{value:e.uid,label:n(e.nickname)}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:"请选择成员",value:k,onChange:function(e){console.log("selected ".concat(e)),y(e)}},rules:[{required:!0,message:"请选择成员"}]}),(0,W.jsx)(E.Z,{width:"md",name:"description",label:"描述",rules:[{required:!0,message:"请输入描述"}]})]})})},G=r(85615),L=r(63434),B=r(1413),O=r(91),N=r(22270),H=r(78045),Q=r(90789),$=r(29258),J=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],K=s.forwardRef((function(e,t){var r=e.fieldProps,n=e.options,s=e.radioType,a=e.layout,o=e.proFieldProps,i=e.valueEnum,l=(0,O.Z)(e,J);return(0,W.jsx)($.Z,(0,B.Z)((0,B.Z)({valueType:"button"===s?"radioButton":"radio",ref:t,valueEnum:(0,N.h)(i,void 0)},l),{},{fieldProps:(0,B.Z)({options:n,layout:a},r),proFieldProps:o,filedConfig:{customLightMode:!0}}))})),_=s.forwardRef((function(e,t){var r=e.fieldProps,n=e.children;return(0,W.jsx)(H.ZP,(0,B.Z)((0,B.Z)({},r),{},{ref:t,children:n}))})),X=(0,Q.G)(_,{valuePropName:"checked",ignoreWidth:!0});X.Group=K,X.Button=H.ZP.Button,X.displayName="ProFormComponent";var Y=X,ee=function(){var e=T.Z.useForm(),t=d()(e,1)[0],r=(0,x.useIntl)(),n=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),a=n.currentWorkgroup,i=n.setCurrentWorkgroup,u=(0,s.useState)(!1),g=d()(u,2),p=(g[0],g[1]),m=(0,s.useState)(G.Jxp),v=d()(m,2),k=v[0],y=v[1];(0,s.useEffect)((function(){return h.$.subscribe((function(e){t.setFieldValue("recent",e.currentWorkgroup.recent),t.setFieldValue("routeType",e.currentWorkgroup.routeType)}))}),[a]),(0,s.useEffect)((function(){p(a.recent),y(a.routeType)}),[]);var b=function(){var e=l()(o()().mark((function e(t){var n,s,l,u,d,g;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish:",t),c.yw.loading("正在修改..."),d=R()(R()(R()({},a),{},{agentUids:a.agents.map((function(e){return e.uid}))},t),{},{serviceSettings:R()(R()({},a.serviceSettings),{},{robotUid:null===(n=a.serviceSettings)||void 0===n||null===(n=n.robot)||void 0===n?void 0:n.uid,quickFaqUids:null===(s=a.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null===(l=a.serviceSettings)||void 0===l||null===(l=l.faqs)||void 0===l?void 0:l.map((function(e){return e.uid})),worktimeUids:null===(u=a.serviceSettings)||void 0===u||null===(u=u.worktimes)||void 0===u?void 0:u.map((function(e){return e.uid}))})}),console.log("workgroupObject:",d),e.next=6,(0,f.W5)(d);case 6:g=e.sent,console.log("updateWorkGroup response:",g),200===g.code?(c.yw.destroy(),c.yw.success(r.formatMessage({id:"update.success"})),i(g.data)):(c.yw.destroy(),c.yw.error(g.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(S.A,{form:t,style:{marginLeft:"100px"},initialValues:{recent:null==a?void 0:a.recent,routeType:null==a?void 0:a.routeType},submitter:{render:function(e,t){return[(0,W.jsx)(Z.ZP,{type:"primary",onClick:function(){var t;null===(t=e.form)||void 0===t||t.submit()},children:"保存"},"submit")]}},onFinish:b,children:[(0,W.jsx)(L.Z,{name:"recent",label:"熟客优先",fieldProps:{onChange:function(e){console.log("checked = ".concat(e.target.checked)),p(e.target.checked)}}}),(0,W.jsx)(Y.Group,{name:"routeType",label:"路由类型",options:[{label:"轮询",value:G.Jxp},{label:"当日接待最少优先",value:G.Cap},{label:"饱和度最低优先",value:G.Vdp},{label:"进行中会话最少优先",value:G.Q2z}],fieldProps:{value:k,onChange:function(e){console.log("radio checked",e.target.value),y(e.target.value)}}}),(0,W.jsxs)(S.A.Item,{children:[k===G.Jxp&&(0,W.jsx)("p",{children:"根据客服上线时间进入队列轮流分配。注意：当客服网络不稳定掉线重连之后，会重新排到队列末尾"}),k===G.Cap&&(0,W.jsx)("p",{children:"根据当日(0点开始)客服接待总数进行分配，优先分配给数量最少者。注意：假如客服上班时间不统一，晚登录者登录后会集中收到分配新客，直到跟其他在线客服接待数量相等为止"}),k===G.Vdp&&(0,W.jsx)("p",{children:"根据（客服最大接待数量-当前进行中会话数量）之差分配，优先分配给数量最大者。注意：假如每个客服最大接待数量相等，则此方法跟’进行中会话最少优先‘效果一样"}),k===G.Q2z&&(0,W.jsx)("p",{children:"根据客服当前进行中会话进行分配，优先分配给数量最少者。注意：客服接待数量会受到客服接待速度的影响，接待完毕之后，客服手动结束会话有利于加速分配新客"})]})]})})},te=r(38437),re=r(79964),ne=r(50748),se=r(99072),ae=r(63772),oe=r(9025),ie=r(23035),le=r(51364),ue=r(64423),de=r(54050),ce=r(73453),ge=r(48489),fe=r(91116),pe=r(35791),me=function(){var e=(0,x.useIntl)(),t=(0,s.useMemo)((function(){return!0}),[]),r=[{key:"faq",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faq",defaultMessage:"FAQ"}),children:(0,W.jsx)(re.Z,{type:G.aZD}),disabled:t},{key:"quickFaqs",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.quickbutton",defaultMessage:"QuickButton"}),children:(0,W.jsx)(le.Z,{type:G.aZD}),disabled:t},{key:"faqGuess",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faqGuess",defaultMessage:"FaqGuess"}),children:(0,W.jsx)(ue.Z,{type:G.aZD}),disabled:t},{key:"faqHot",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faqHot",defaultMessage:"FaqHot"}),children:(0,W.jsx)(ne.Z,{type:G.aZD}),disabled:t},{key:"faqShortcut",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faqShortcut",defaultMessage:"FaqShortcut"}),children:(0,W.jsx)(se.Z,{type:G.aZD}),disabled:t},{key:"rate",label:(0,W.jsx)(x.FormattedMessage,{id:"rate",defaultMessage:"Rate"}),children:(0,W.jsx)(ae.Z,{type:G.aZD}),disabled:t},{key:"leaveMsg",label:(0,W.jsx)(x.FormattedMessage,{id:"leavemsg",defaultMessage:"Leave Msg"}),children:(0,W.jsx)(oe.Z,{type:G.aZD}),disabled:t},{key:"survey",label:(0,W.jsx)(x.FormattedMessage,{id:"survey",defaultMessage:"Survey"}),children:(0,W.jsx)(pe.Z,{type:G.aZD}),disabled:t},{key:"history",label:(0,W.jsx)(x.FormattedMessage,{id:"history",defaultMessage:"History"}),children:(0,W.jsx)(ce.Z,{type:G.aZD}),disabled:t},{key:"inputassociation",label:(0,W.jsx)(x.FormattedMessage,{id:"inputassociation",defaultMessage:"Input Association"}),children:(0,W.jsx)(fe.Z,{type:G.aZD}),disabled:t},{key:"black",label:(0,W.jsx)(x.FormattedMessage,{id:"black",defaultMessage:"Black"}),children:(0,W.jsx)(de.Z,{type:G.aZD}),disabled:t},{key:"antiharassment",label:(0,W.jsx)(x.FormattedMessage,{id:"antiharassment",defaultMessage:"Anti Harassment"}),children:(0,W.jsx)(ie.Z,{type:G.aZD}),disabled:t}];return(0,W.jsxs)(W.Fragment,{children:[t&&(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(te.Z,{message:"企业版-高级功能",style:{marginBottom:20},type:"warning",action:(0,W.jsx)(Z.ZP,{type:"link",icon:(0,W.jsx)(ge.Z,{}),onClick:function(){return window.open(G.rVq)},children:e.formatMessage({id:"setting.helpdoc"})})})}),(0,W.jsx)(U.Z,{tabPosition:"left",items:r})]})},ve=r(36649),he=r(16737),ke=r(31207),ye=r(22268),xe=r(99606),be=r(59518),je=function(){var e=(0,x.useIntl)(),t=(0,s.useState)([]),r=d()(t,2),n=r[0],a=r[1],o=[{key:"basic",label:e.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,W.jsx)(z,{})},{key:"serviceSettings",label:e.formatMessage({id:"pages.agent.service.settings",defaultMessage:"Service Settings"}),children:(0,W.jsx)(be.Z,{type:G.aZD})},{key:"robot",label:e.formatMessage({id:"pages.agent.robot",defaultMessage:"Robot"}),children:(0,W.jsx)(xe.Z,{type:G.aZD})},{key:"route",label:e.formatMessage({id:"pages.workgroup.tab.route",defaultMessage:"Route"}),children:(0,W.jsx)(ee,{})},{key:"advanced",label:e.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,W.jsx)(me,{})},{key:"channel",label:e.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,W.jsx)(ve.Z,{type:G.aZD})},{key:"channelsocial",label:e.formatMessage({id:"channelsocial",defaultMessage:"Social Channel"}),children:(0,W.jsx)(he.Z,{type:G.aZD})},{key:"channelshop",label:e.formatMessage({id:"channelshop",defaultMessage:"Shop Channel"}),children:(0,W.jsx)(ye.Z,{type:G.aZD})},{key:"channelforeign",label:e.formatMessage({id:"channelforeign",defaultMessage:"Foreign Channel"}),children:(0,W.jsx)(ke.Z,{type:G.aZD})}];return(0,s.useEffect)((function(){a(o)}),[]),(0,W.jsx)(U.Z,{defaultActiveKey:"basic",items:n})},Ze=r(77154),Me=n.Z.Sider,we=n.Z.Content,Fe=function(){var e=(0,Ze.Z)(),t=e.leftSiderStyle,r=e.leftSiderWidth;return(0,W.jsxs)(n.Z,{children:[(0,W.jsx)(Me,{width:r,style:t,children:(0,W.jsx)(P,{})}),(0,W.jsx)(n.Z,{children:(0,W.jsx)(we,{children:(0,W.jsx)(je,{})})})]})}}}]);