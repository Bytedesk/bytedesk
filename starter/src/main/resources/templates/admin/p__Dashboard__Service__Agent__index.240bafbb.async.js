"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1642],{32863:function(e,t,n){var r=n(17082),a=n(51190),s=n(44194),i=n(93288),u=n(31549),o=["fieldProps","request","params","proFieldProps"],l=function(e,t){var n=e.fieldProps,s=e.request,l=e.params,c=e.proFieldProps,d=(0,a.Z)(e,o);return(0,u.jsx)(i.Z,(0,r.Z)({valueType:"treeSelect",fieldProps:n,ref:t,request:s,params:l,filedConfig:{customLightMode:!0},proFieldProps:c},d))},c=s.forwardRef(l);t.Z=c},78477:function(e,t,n){n.d(t,{AP:function(){return d},_J:function(){return y},t5:function(){return m},v_:function(){return f}});var r=n(90819),a=n.n(r),s=n(73193),i=n.n(s),u=n(89933),o=n.n(u),l=n(77667),c=n(7206);function d(e){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/query/org",{method:"GET",params:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/create",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/update",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/delete",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},65872:function(e,t,n){n.d(t,{NX:function(){return d},O9:function(){return f},ZG:function(){return m},bN:function(){return y}});var r=n(90819),a=n.n(r),s=n(73193),i=n.n(s),u=n(89933),o=n.n(u),l=n(77667),c=n(7206);function d(e){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/query/org",{method:"GET",params:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/create",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/update",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/autoreply/delete",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},77849:function(e,t,n){n.d(t,{D$:function(){return f},EP:function(){return y},hS:function(){return m},z_:function(){return d}});var r=n(90819),a=n.n(r),s=n(73193),i=n.n(s),u=n(89933),o=n.n(u),l=n(77667),c=n(7206);function d(e){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/query/org",{method:"GET",params:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/create",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/update",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/member/delete",{method:"POST",data:i()(i()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},74382:function(e,t,n){n.r(t),n.d(t,{default:function(){return je}});var r=n(64476),a=n(44194),s=n(45332),i=n.n(s),u=n(50571),o=n(90819),l=n.n(o),c=n(73193),d=n.n(c),p=n(89933),f=n.n(p),g=n(89756),m=n(81153),v=n(1780),y=n(85702),h=n(77667),b=n(39701),x=n(83642),j=n(41617),w=(0,b.Ue)()((0,x.mW)((0,x.tJ)((0,j.n)((function(e,t){return{memberResult:{data:{content:[],totalElements:0}},insertMember:function(t){e((function(e){e.memberResult.data.content.unshift(t)}))},updateMember:function(t){e((function(e){var n=e.memberResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n[r]=t:console.warn("Member with uid ".concat(t.uid," not found."))}))},deleteMember:function(t){e((function(e){var n=e.memberResult.data.content,r=n.findIndex((function(e){return e.uid===t.uid}));-1!==r?n.splice(r,1):console.warn("Member with uid ".concat(t.uid," not found."))}))},setMemberResult:function(t){e({memberResult:t})},deleteMemberCache:function(){return e({},!0)}}})),{name:h.PQL}))),k=n(92349),S=n(69957),M=n(5728),q=n(43688),F=n(11607),Z=n(7206),R=n(21276),C=n(12265),A=n(31549),U=function(){var e=M.A.useForm(),t=i()(e,1)[0],n=(0,Z.useIntl)(),r=(0,v.Z)().translateString,s=w((function(e){return e.memberResult})),u=(0,y.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),o=u.currentAgent,c=u.setCurrentAgent,p=(0,a.useState)(""),h=i()(p,2),b=h[0],x=h[1];(0,a.useMemo)((function(){for(var e,t,n=[],r=0;r<s.data.content.length;r++){var a={title:"",value:"",children:[]};e=s.data.content[r],(t=a).title=e.nickname,t.value=e.uid,n.push(a)}return n}),[s]);(0,a.useEffect)((function(){var e;o&&t.setFieldsValue({nickname:r(null==o?void 0:o.nickname),email:null==o?void 0:o.email,mobile:null==o?void 0:o.mobile,description:r(null==o?void 0:o.description),memberUid:null==o||null===(e=o.member)||void 0===e?void 0:e.uid})}),[o]);var j=function(){var e=f()(l()().mark((function e(t){var r,a,s,i,u,p,f,v,y;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish:",t),g.yw.loading(n.formatMessage({id:"updating"})),v=d()(d()(d()({},o),t),{},{avatar:b,serviceSettings:d()(d()({},o.serviceSettings),{},{robotUid:null==o||null===(r=o.serviceSettings)||void 0===r||null===(r=r.robot)||void 0===r?void 0:r.uid,quickFaqUids:null==o||null===(a=o.serviceSettings)||void 0===a||null===(a=a.quickFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),faqUids:null==o||null===(s=o.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),guessFaqUids:null==o||null===(i=o.serviceSettings)||void 0===i||null===(i=i.guessFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),hotFaqUids:null==o||null===(u=o.serviceSettings)||void 0===u||null===(u=u.hotFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),shortcutFaqUids:null==o||null===(p=o.serviceSettings)||void 0===p||null===(p=p.shortcutFaqs)||void 0===p?void 0:p.map((function(e){return e.uid})),worktimeUids:null==o||null===(f=o.serviceSettings)||void 0===f||null===(f=f.worktimes)||void 0===f?void 0:f.map((function(e){return e.uid}))}),autoReplySettings:d()({},o.autoReplySettings)}),console.log("agentObject:",v),e.next=6,(0,m.sE)(v);case 6:y=e.sent,console.log("updateAgent response:",y),200===y.code?(g.yw.destroy(),g.yw.success(n.formatMessage({id:"update.success"})),c(y.data)):(g.yw.destroy(),g.yw.error(y.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){var e;o&&(x(o.avatar),t.setFieldsValue({member:null==o||null===(e=o.member)||void 0===e?void 0:e.nickname}))}),[o]),(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(M.A,{form:t,style:{marginLeft:"100px"},onFinish:j,children:[(0,A.jsx)(M.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:n.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,A.jsxs)(k.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e),x(e)},onError:function(e){console.log("handleUploadError:",e),g.yw.error(e)},children:[(0,A.jsx)(R.C,{src:b}),(0,A.jsx)(C.ZP,{icon:(0,A.jsx)(S.Z,{}),children:n.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,A.jsx)(q.Z,{width:"md",name:"nickname",label:"客服卡片-展示客服昵称",rules:[{required:!0,message:"请输入客服昵称"}]}),(0,A.jsx)(q.Z,{width:"md",name:"email",label:"客服卡片-展示邮箱",rules:[{required:!0,message:"请输入邮箱"}]}),(0,A.jsx)(q.Z,{width:"md",name:"mobile",label:"客服卡片-展示手机号",rules:[{required:!0,message:"请输入手机号"}]}),(0,A.jsx)(F.Z,{width:"md",name:"description",label:"客服卡片-展示描述",rules:[{required:!0,message:"请输入描述"}]}),(0,A.jsx)(q.Z,{width:"md",name:"member",label:"绑定成员",disabled:!0})]})})},P=n(93982),T=n(89875),N=n(18874),V=n(66772),E=n(13253),O=n(9750),I=n(57545),L=n(90588),z=n(10187),D=n(65872),G=n(78477),Q=n(40431),_=n(11984),B=n(31806),H=n(8091),W=function(e){var t,n=e.type,r=(0,Z.useIntl)(),s=(0,Z.useNavigate)(),u=M.A.useForm(),o=i()(u,1)[0],c=(0,v.Z)().translateString,p=(0,a.useState)(),b=i()(p,2),x=b[0],j=b[1],w=(0,a.useState)(),k=i()(w,2),S=k[0],q=k[1],R=(0,Q.u)((function(e){return e.currentOrg})),U=(0,y.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),P=U.currentAgent,T=U.setCurrentAgent,N=(0,a.useState)(h.DST),V=i()(N,2),E=V[0],O=V[1],I=function(){var e=f()(l()().mark((function e(){var t,n;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.yw.loading(r.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,orgUid:R.uid},e.next=4,(0,D.NX)(t);case 4:n=e.sent,console.log("getAutoReplies response:",t,n),g.yw.destroy(),200===n.code?j(n):g.yw.error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){I()}),[]);var L=function(){var e=f()(l()().mark((function e(){var t,n;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.yw.loading(r.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:E===h.PZ1?h.jNC:h.QPQ,orgUid:R.uid},e.next=4,(0,G.AP)(t);case 4:n=e.sent,console.log("getKeywordBase response:",t,n),g.yw.destroy(),200===n.code?q(n):g.yw.error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){L()}),[E]),(0,a.useEffect)((function(){var e,t,r,a,s,i,u,l;n===h.Njn&&(O(null==P||null===(e=P.autoReplySettings)||void 0===e?void 0:e.autoReplyType),o.setFieldsValue({enabled:null==P||null===(t=P.autoReplySettings)||void 0===t?void 0:t.enabled,autoReplyType:null==P||null===(r=P.autoReplySettings)||void 0===r?void 0:r.autoReplyType,autoReplyUid:null==P||null===(a=P.autoReplySettings)||void 0===a?void 0:a.autoReplyUid,autoReplyContentType:null==P||null===(s=P.autoReplySettings)||void 0===s?void 0:s.autoReplyContentType,autoReplyContent:null==P||null===(i=P.autoReplySettings)||void 0===i?void 0:i.autoReplyContent,kbUid:null==P||null===(u=P.autoReplySettings)||void 0===u?void 0:u.kbUid}),o.setFieldValue("autoReplyUid",null==P||null===(l=P.autoReplySettings)||void 0===l?void 0:l.autoReplyContent))}),[P]);var z=function(){var e=f()(l()().mark((function e(t){var a,s,i,u,o,c,p,f,v;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleAutoReplySubmit:",t),n!==h.Njn){e.next=9;break}return f=d()(d()({},P),{},{serviceSettings:d()(d()({},null==P?void 0:P.serviceSettings),{},{robotUid:null==P||null===(a=P.serviceSettings)||void 0===a||null===(a=a.robot)||void 0===a?void 0:a.uid,quickFaqUids:null==P||null===(s=P.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==P||null===(i=P.serviceSettings)||void 0===i||null===(i=i.faqs)||void 0===i?void 0:i.map((function(e){return e.uid})),guessFaqUids:null==P||null===(u=P.serviceSettings)||void 0===u||null===(u=u.guessFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),hotFaqUids:null==P||null===(o=P.serviceSettings)||void 0===o||null===(o=o.hotFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),shortcutFaqUids:null==P||null===(c=P.serviceSettings)||void 0===c||null===(c=c.shortcutFaqs)||void 0===c?void 0:c.map((function(e){return e.uid})),worktimeUids:null==P||null===(p=P.serviceSettings)||void 0===p||null===(p=p.worktimes)||void 0===p?void 0:p.map((function(e){return e.uid}))}),autoReplySettings:d()(d()({},P.autoReplySettings),{},{enabled:t.enabled,autoReplyType:t.autoReplyType,autoReplyUid:t.autoReplyUid,autoReplyContentType:t.autoReplyContentType,autoReplyContent:t.autoReplyContent,kbUid:t.kbUid})}),console.log("agentObject:",f),e.next=6,(0,m.sE)(f);case 6:v=e.sent,console.log("updateAgent response:",v),200===v.code?(g.yw.destroy(),g.yw.success(r.formatMessage({id:"update.success"})),T(v.data)):(g.yw.destroy(),g.yw.error(v.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=f()(l()().mark((function e(t){var a,s,i,u,o,c,p,f,v;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleAutoReplyEnabledChange:",t),n!==h.Njn){e.next=9;break}return f=d()(d()({},P),{},{serviceSettings:d()(d()({},null==P?void 0:P.serviceSettings),{},{robotUid:null==P||null===(a=P.serviceSettings)||void 0===a||null===(a=a.robot)||void 0===a?void 0:a.uid,quickFaqUids:null==P||null===(s=P.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==P||null===(i=P.serviceSettings)||void 0===i||null===(i=i.faqs)||void 0===i?void 0:i.map((function(e){return e.uid})),guessFaqUids:null==P||null===(u=P.serviceSettings)||void 0===u||null===(u=u.guessFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),hotFaqUids:null==P||null===(o=P.serviceSettings)||void 0===o||null===(o=o.hotFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),shortcutFaqUids:null==P||null===(c=P.serviceSettings)||void 0===c||null===(c=c.shortcutFaqs)||void 0===c?void 0:c.map((function(e){return e.uid})),worktimeUids:null==P||null===(p=P.serviceSettings)||void 0===p||null===(p=p.worktimes)||void 0===p?void 0:p.map((function(e){return e.uid}))}),autoReplySettings:d()(d()({},P.autoReplySettings),{},{enabled:t})}),console.log("agentObject:",f),e.next=6,(0,m.sE)(f);case 6:v=e.sent,console.log("updateAgent response:",v),200===v.code?(g.yw.destroy(),g.yw.success(r.formatMessage({id:"update.success"})),T(v.data)):(g.yw.destroy(),g.yw.error(v.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(M.A,{form:o,onFinish:z,children:[(0,A.jsx)(B.Z,{width:"md",name:"enabled",label:"是否启用自动回复",fieldProps:{onChange:W}}),(0,A.jsx)(H.Z,{width:"md",name:"autoReplyType",label:"自动回复类型",options:[{label:"固定回复",value:h.DST},{label:"关键字匹配",value:h.PZ1},{label:"大模型回复",value:h.PcP}],fieldProps:{onChange:function(e,t){!function(e,t){console.log("handleAutoReplyTypeChange:",e),O(e)}(e)}}}),E===h.DST&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(M.A.Item,{children:(0,A.jsx)(C.ZP,{icon:(0,A.jsx)(_.Z,{}),onClick:function(){s("/kb/autoreply/data")},children:"添加固定回复内容"},"github")}),(0,A.jsx)(H.Z,{width:"md",name:"autoReplyUid",label:"选择固定回复内容",options:null==x||null===(t=x.data)||void 0===t?void 0:t.content.map((function(e){return{label:c(e.content),value:e.uid}})),fieldProps:{onChange:function(e,t){!function(e,t){var n;console.log("handleAutoReplySelectChange:",e),null==x||null===(n=x.data.content)||void 0===n||n.forEach((function(t){t.uid===e&&o.setFieldsValue({autoReplyContentType:t.type,autoReplyContent:t.content})}))}(e)}}}),(0,A.jsx)(H.Z,{width:"md",name:"autoReplyContentType",label:"固定回复类型",options:[{label:"文本",value:h.PYi},{label:"图片",value:h.Qm},{label:"视频",value:h.tVi},{label:"音频",value:h.Yu1},{label:"文件",value:h.Qn}],disabled:!0}),(0,A.jsx)(F.Z,{width:"md",name:"autoReplyContent",label:"固定回复内容",disabled:!0})]}),E===h.PZ1&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(M.A.Item,{children:(0,A.jsx)(C.ZP,{icon:(0,A.jsx)(_.Z,{}),onClick:function(){s("/kb/keyword/data")},children:"添加关键词知识库"},"github")}),(0,A.jsx)(H.Z,{width:"md",name:"kbUid",label:"选择关键词知识库",options:null==S?void 0:S.data.content.map((function(e){return{label:c(e.name),value:e.uid}}))})]}),E===h.PcP&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(M.A.Item,{children:(0,A.jsx)(C.ZP,{icon:(0,A.jsx)(_.Z,{}),onClick:function(){s("/kb/llm/data")},children:"添加大模型知识库"},"github")}),(0,A.jsx)(H.Z,{width:"md",name:"kbUid",label:"选择大模型知识库库",options:null==S?void 0:S.data.content.map((function(e){return{label:c(e.name),value:e.uid}}))})]})]})})},$=n(40574),J=n(16655),K=n(64859),X=n(28243),Y=function(){var e=(0,Z.useIntl)(),t=(0,a.useMemo)((function(){return"opensource"===h.nGu}),[]),n=[{key:"faq",label:(0,A.jsx)(Z.FormattedMessage,{id:"menu.knowledge.faq",defaultMessage:"FAQ"}),children:(0,A.jsx)(T.Z,{type:h.Njn}),disabled:t},{key:"quickFaqs",label:(0,A.jsx)(Z.FormattedMessage,{id:"menu.knowledge.quickbutton",defaultMessage:"QuickButton"}),children:(0,A.jsx)(L.Z,{type:h.Njn}),disabled:t},{key:"faqGuess",label:(0,A.jsx)(Z.FormattedMessage,{id:"menu.knowledge.faqGuess",defaultMessage:"FaqGuess"}),children:(0,A.jsx)(z.Z,{type:h.Njn}),disabled:t},{key:"faqHot",label:(0,A.jsx)(Z.FormattedMessage,{id:"menu.knowledge.faqHot",defaultMessage:"FaqHot"}),children:(0,A.jsx)(N.Z,{type:h.Njn}),disabled:t},{key:"faqShortcut",label:(0,A.jsx)(Z.FormattedMessage,{id:"menu.knowledge.faqShortcut",defaultMessage:"FaqShortcut"}),children:(0,A.jsx)(V.Z,{type:h.Njn}),disabled:t},{key:"rate",label:(0,A.jsx)(Z.FormattedMessage,{id:"rate",defaultMessage:"Rate"}),children:(0,A.jsx)(O.Z,{type:h.Njn}),disabled:t},{key:"autoreply",label:(0,A.jsx)(Z.FormattedMessage,{id:"autoreply",defaultMessage:"Auto Reply"}),children:(0,A.jsx)(W,{type:h.Njn}),disabled:t},{key:"leaveMsg",label:(0,A.jsx)(Z.FormattedMessage,{id:"leavemsg",defaultMessage:"Leave Msg"}),children:(0,A.jsx)(E.Z,{type:h.Njn}),disabled:t},{key:"survey",label:(0,A.jsx)(Z.FormattedMessage,{id:"survey",defaultMessage:"Survey"}),children:(0,A.jsx)(X.Z,{type:h.Njn}),disabled:t},{key:"history",label:(0,A.jsx)(Z.FormattedMessage,{id:"history",defaultMessage:"History"}),children:(0,A.jsx)($.Z,{type:h.Njn}),disabled:t},{key:"inputassociation",label:(0,A.jsx)(Z.FormattedMessage,{id:"inputassociation",defaultMessage:"Input Association"}),children:(0,A.jsx)(K.Z,{type:h.Njn}),disabled:t},{key:"antiharassment",label:(0,A.jsx)(Z.FormattedMessage,{id:"antiharassment",defaultMessage:"Anti Harassment"}),children:(0,A.jsx)(I.Z,{type:h.Njn}),disabled:t}],r=(0,a.useState)([]),s=i()(r,2),o=s[0],l=s[1];return(0,a.useEffect)((function(){l(n)}),[]),(0,A.jsxs)(A.Fragment,{children:[t&&(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(P.Z,{message:"企业版-高级功能",style:{marginBottom:20},type:"warning",action:(0,A.jsx)(C.ZP,{type:"link",icon:(0,A.jsx)(J.Z,{}),onClick:function(){return window.open(h.VPj)},children:e.formatMessage({id:"setting.helpcenter"})})})}),(0,A.jsx)(u.Z,{tabPosition:"left",items:o})]})},ee=n(82639),te=n(93030),ne=n(89242),re=n(19743),ae=n(35504),se=n(63515),ie=function(){var e=(0,Z.useIntl)(),t=(0,a.useState)([]),n=i()(t,2),r=n[0],s=n[1],o=[{key:"basic",label:e.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,A.jsx)(U,{})},{key:"serviceSettings",label:e.formatMessage({id:"pages.agent.service.settings",defaultMessage:"Service Settings"}),children:(0,A.jsx)(se.Z,{type:h.Njn})},{key:"robot",label:e.formatMessage({id:"pages.agent.robot",defaultMessage:"Robot"}),children:(0,A.jsx)(ae.Z,{type:h.Njn})},{key:"advanced",label:e.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,A.jsx)(Y,{})},{key:"channel",label:e.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,A.jsx)(ee.Z,{type:h.Njn})},{key:"channelsocial",label:e.formatMessage({id:"channelsocial",defaultMessage:"Social Channel"}),children:(0,A.jsx)(te.Z,{type:h.Njn})},{key:"channelshop",label:e.formatMessage({id:"channelshop",defaultMessage:"Shop Channel"}),children:(0,A.jsx)(re.Z,{type:h.Njn})},{key:"channelforeign",label:e.formatMessage({id:"channelforeign",defaultMessage:"Foreign Channel"}),children:(0,A.jsx)(ne.Z,{type:h.Njn})}];return(0,a.useEffect)((function(){s(o)}),[]),(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(u.Z,{defaultActiveKey:"basic",items:r})})},ue=n(74145),oe=n(50484),le=n(70458),ce=n(83730),de=n(80093),pe=n(90136),fe=n(66765),ge=n(32863),me=function(e){var t=e.open,n=e.onClose,r=e.onSubmit,s=fe.ZP.useForm(),u=i()(s,1)[0],o=(0,Q.u)((function(e){return e.currentOrg})),l=w((function(e){return e.memberResult})),c=(0,a.useMemo)((function(){for(var e,t,n=[],r=0;r<l.data.content.length;r++){var a={title:"",value:"",children:[]};e=l.data.content[r],(t=a).title=e.nickname,t.value=e.uid,n.push(a)}return n}),[l]);return(0,A.jsx)("div",{children:(0,A.jsx)(ce.Z,{title:"创建客服",open:t,forceRender:!0,onOk:function(){console.log("handleOk"),u.validateFields().then((function(e){console.log("form values:",e);var t={nickname:u.getFieldValue("nickname"),email:u.getFieldValue("email"),mobile:u.getFieldValue("mobile"),memberUid:u.getFieldValue("memberUid"),orgUid:o.uid};console.log("agent:",t),r(t)})).catch((function(e){console.log("Form errors:",e)}))},onCancel:function(){console.log("handleCancel"),n()},children:(0,A.jsxs)(fe.ZP,{form:u,name:"agentForm",style:{maxWidth:400},submitter:!1,children:[(0,A.jsx)(ge.Z,{label:"绑定成员",name:"memberUid",tooltip:"请先到组织-》成员-》创建成员",rules:[{required:!0,message:"请选择成员!"}],fieldProps:{multiple:!1,treeDefaultExpandAll:!0,placeholder:"请选择成员",onChange:function(e){console.log("onTreeSelectChange:",e);for(var t=0;t<l.data.content.length;t++){var n=l.data.content[t];n.uid===e&&(console.log("element:",n),u.setFieldsValue({nickname:n.nickname}),u.setFieldsValue({email:n.email}),u.setFieldsValue({mobile:n.mobile}))}},treeData:c}}),(0,A.jsx)(q.Z,{label:"昵称",name:"nickname",rules:[{required:!0,message:"请输入昵称!"}]}),(0,A.jsx)(q.Z,{label:"邮箱",name:"email",rules:[{required:!0,message:"请输入邮箱!"},{type:"email",message:"请输入正确的邮箱地址"}]}),(0,A.jsx)(q.Z,{label:"手机号",name:"mobile",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号"}]})]})})})},ve=n(77849),ye=function(){var e=(0,Z.useIntl)(),t=(0,a.useRef)(!1),n=(0,v.Z)(),r=n.translateString,s=n.translateStringTranct,u=(0,ue.Z)().isDarkMode,o=(0,a.useState)(!1),c=i()(o,2),d=c[0],p=c[1],b=(0,Q.u)((function(e){return e.currentOrg})),x=w((function(e){return e.setMemberResult})),j=(0,y.E)((function(e){return{agentResult:e.agentResult,currentAgent:e.currentAgent,insertAgent:e.insertAgent,setAgentResult:e.setAgentResult,setCurrentAgent:e.setCurrentAgent,deleteCurrentAgent:e.deleteCurrentAgent}})),k=j.agentResult,S=j.currentAgent,M=j.insertAgent,q=j.setAgentResult,F=j.setCurrentAgent,U=j.deleteCurrentAgent,P=ce.Z.useModal(),T=i()(P,2),N=T[0],V=T[1],E=function(){var t=f()(l()().mark((function t(n){var r;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("delete agent",n),g.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),t.next=4,(0,m.Lr)(n);case 4:r=t.sent,console.log("delete agent response",r),200===r.code?(g.yw.destroy(),g.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),U(n.uid)):(g.yw.destroy(),g.yw.error(r.message));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var e=f()(l()().mark((function e(){var n,r;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.current){e.next=3;break}return console.log("isLoading: 1",t.current),e.abrupt("return");case 3:return t.current=!0,g.yw.loading("loading"),n={pageNumber:0,pageSize:50,orgUid:b.uid},e.next=8,(0,m._t)(n);case 8:r=e.sent,console.log("queryAgentsByOrg: ",r),200===r.code?(g.yw.destroy(),q(r)):(g.yw.destroy(),g.yw.error(r.message)),t.current=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=f()(l()().mark((function e(){var t,n;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pageNumber:0,pageSize:50,orgUid:b.uid},e.next=3,(0,ve.z_)(t);case 3:n=e.sent,console.log("queryAllMembers:",t,n),200===n.code?x(n):g.yw.error(n.message);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){O(),I()}),[]);var L=function(){var t=f()(l()().mark((function t(n){var r;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("save agent"),g.yw.loading(e.formatMessage({id:"creating",defaultMessage:"Creating"})),t.next=4,(0,m.x_)(n);case 4:r=t.sent,console.log("create agent:",r),200===r.code?(g.yw.destroy(),g.yw.success(e.formatMessage({id:"create.success"})),M(r.data),p(!1)):(g.yw.destroy(),g.yw.error(r.message));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(de.Z,{style:{margin:10},gap:"small",align:"flex-start",children:[(0,A.jsx)(C.ZP,{size:"small",type:"primary",icon:(0,A.jsx)(le.Z,{}),onClick:function(){p(!0)},children:e.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,A.jsx)(C.ZP,{size:"small",onClick:O,children:e.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,A.jsx)(C.ZP,{onClick:function(){return function(t){N.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,A.jsx)(oe.Z,{}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(r(t.nickname),"】？"),onOk:function(){E(t)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})}(S)},size:"small",danger:!0,disabled:""===(null==S?void 0:S.uid),children:e.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,A.jsx)(pe.Z,{itemLayout:"horizontal",dataSource:k.data.content,renderItem:function(e,t){return(0,A.jsx)(pe.Z.Item,{style:S.uid===e.uid?{backgroundColor:u?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){F(e)},children:(0,A.jsx)(pe.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,A.jsx)(R.C,{src:e.avatar}),title:(0,A.jsx)(A.Fragment,{children:s(e.nickname)}),description:(n=e,(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("span",{style:{color:"#999999",fontSize:12},children:[n.status===h.Ra4&&"[😀-在线接待]",n.status===h.LZ1&&"[🔻-客服下线]",n.status===h.tU$&&"[🏃‍♀️-客服忙碌]",n.connected?" ✅连接成功":" ❌连接断开"]})}))})},e.uid);var n}}),d&&(0,A.jsx)(me,{open:d,onClose:function(){p(!1)},onSubmit:L}),V]})},he=n(93139),be=r.Z.Sider,xe=r.Z.Content,je=function(){var e=(0,he.Z)(),t=e.leftSiderStyle,n=e.leftSiderWidth;return(0,a.useEffect)((function(){}),[]),(0,A.jsxs)(r.Z,{children:[(0,A.jsx)(be,{width:n,style:t,children:(0,A.jsx)(ye,{})}),(0,A.jsx)(r.Z,{children:(0,A.jsx)(xe,{children:(0,A.jsx)(ie,{})})})]})}}}]);