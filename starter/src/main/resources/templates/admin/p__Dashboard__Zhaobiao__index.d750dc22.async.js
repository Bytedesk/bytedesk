"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8327],{70150:function(A,f,e){e.d(f,{W5:function(){return W}});var h=e(15009),l=e.n(h),m=e(97857),u=e.n(m),E=e(99289),c=e.n(E),R=e(85615),p=e(88541),y=e.n(p),x=e(86745);function W(o){return b.apply(this,arguments)}function b(){return b=c()(l()().mark(function o(a){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/v1/message/query/org",{method:"GET",params:u()({},a)}));case 1:case"end":return n.stop()}},o)})),b.apply(this,arguments)}function Z(o){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function o(a){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/user/robot",{method:"GET",params:{page:a.pageNumber,size:a.pageSize,client:HTTP_CLIENT}}));case 1:case"end":return n.stop()}},o)})),D.apply(this,arguments)}function z(o){return g.apply(this,arguments)}function g(){return g=_asyncToGenerator(_regeneratorRuntime().mark(function o(a){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/message/rest/send",{method:"POST",data:{json:a,client:HTTP_CLIENT}}));case 1:case"end":return n.stop()}},o)})),g.apply(this,arguments)}function k(o,a){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function o(a,_){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("http://127.0.0.1:1001/visitor/api/v1/ai/ollama/chat",{method:"GET",params:{query:a,kbUid:_,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},o)})),P.apply(this,arguments)}function G(o,a,_){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function o(a,_,n){var r,s;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:console.log("sendMessageAiStream: ",a),r="http://127.0.0.1:1001/visitor/api/v1/ai/ollama/chat/stream?query=".concat(a,"&kbUid=").concat(_),s=new EventSource(r,{withCredentials:!1}),s.onopen=function(t){console.log("onopen:",t.target)},s.onmessage=function(t){console.log("onmessage:",t.data),n(t.data)},s.onerror=function(t){console.log("onerror:",t),s.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",t),s.close()},s.addEventListener("customEventName",function(t){console.log("Message id is "+t.lastEventId)});case 7:case"end":return i.stop()}},o)})),I.apply(this,arguments)}function H(o,a){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function o(a,_){var n,r;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:console.log("sendMessageSSE: ",a),n="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(a.sid,"&content=").concat(a.content),r=new EventSource(n,{withCredentials:!1}),r.onopen=function(i){console.log("onopen:",i.target)},r.onmessage=function(i){_(i.data);var t=JSON.parse(i.data);if(t.type=="finish"){r&&r.close();return}},r.onerror=function(i){console.log("onerror:",i),alert("server error"),r.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",i),r.close()},r.addEventListener("customEventName",function(i){console.log("Message id is "+i.lastEventId)});case 7:case"end":return d.stop()}},o)})),C.apply(this,arguments)}function N(o,a){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function o(a,_){var n,r,s;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:console.log("sendMessageSSEPolyfill: ",a),n=localStorage.ACCESS_TOKEN,r="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(a.sid,"&content=").concat(a.content),s=new EventSourcePolyfill(r,{headers:{Authorization:"Bearer ".concat(n)}}),s.onopen=function(t){console.log("onopen:",t.target)},s.onmessage=function(t){console.log("onmessage:",t.data),_(t.data);var U=JSON.parse(t.data);if(U.type=="finish"){s&&s.close();return}},s.onerror=function(t){console.log("onerror:",t),alert("server error"),s.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",t),s.close()},s.addEventListener("customEventName",function(t){console.log("Message id is "+t.lastEventId)});case 8:case"end":return i.stop()}},o)})),j.apply(this,arguments)}},77154:function(A,f,e){var h=e(39825);function l(){var m=(0,h.Z)(),u=m.isDarkMode,E=250,c={borderRight:u?"1px solid #333":"1px solid #ccc",background:u?"#141414":"#f5f5f5"},R={background:u?"#141414":"#fff"},p={borderLeft:u?"1px solid #333":"1px solid #ccc",background:u?"#141414":"#f5f5f5"},y={minHeight:120,background:u?"#141414":"#f5f5f5",height:"100vh"};return{leftSiderStyle:c,leftSiderWidth:E,headerStyle:R,rightSiderStyle:p,contentStyle:y}}f.Z=l},85778:function(A,f,e){e.r(f),e.d(f,{default:function(){return a}});var h=e(77154),l=e(21612),m=e(50136),u=e(67294),E=e(15009),c=e.n(E),R=e(99289),p=e.n(R),y=e(5574),x=e.n(y),W=e(80049),b=e(70150),Z=e(69888),D=e(87676),z=e(57482),g=e(85893),k=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,g.jsx)(FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",copyable:!0},{title:(0,g.jsx)(FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0},{title:intl.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",render:function(n,r,s,d){return[(0,g.jsx)("a",{onClick:function(){var t;d==null||(t=d.startEditable)===null||t===void 0||t.call(d,r.uid)},children:"\u4FEE\u6539"},"editable")]}}],P=function(){var n=(0,u.useRef)(),r=(0,u.useState)(1),s=x()(r,2),d=s[0],i=s[1],t=(0,u.useState)(10),U=x()(t,2),K=U[0],J=U[1],Q=(0,D.u)(function(v){return v.currentOrg}),w=(0,Z.G)(function(v){return{messageResult:v.messageResult,setMemberResult:v.setMessageResult}}),L=w.messageResult,V=w.setMemberResult,$=function(){var v=p()(c()().mark(function O(){var M,S;return c()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return M={pageNumber:d-1,pageSize:K,orgUid:Q.uid},T.next=3,(0,b.W5)(M);case 3:S=T.sent,console.log("getAllMessages response:",M,S),S.code===200?V(S):W.yw.error(S.message);case 6:case"end":return T.stop()}},O)}));return function(){return v.apply(this,arguments)}}();return(0,u.useEffect)(function(){$()},[]),(0,u.useEffect)(function(){$()},[d,K]),(0,u.useEffect)(function(){console.log("messageResult:",L),n.current.reload()},[L]),(0,g.jsx)(z.Z,{columns:k,actionRef:n,cardBordered:!0,request:function(){var v=p()(c()().mark(function O(M,S,F){return c()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return console.log("request:",M,S,F),i(M.current),J(M.pageSize),B.abrupt("return",Promise.resolve({data:L.data.content,success:!0,total:L.data.totalElements}));case 4:case"end":return B.stop()}},O)}));return function(O,M,S){return v.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:K,showQuickJumper:!0,onChange:function(O){console.log("page:",O)}},dateFormatter:"string",headerTitle:"\u7EC4\u7EC7\u6D88\u606F",toolBarRender:function(){return[]}})},G=P,I=l.Z.Header,H=l.Z.Footer,C=l.Z.Sider,N=l.Z.Content,j=[{label:"\u9AD8\u7EA7",key:"top",children:[{label:"column",key:"xinxixitongxiangmuguanlishi"}]},{label:"\u4E2D\u7EA7",key:"middle",children:[{label:"column2",key:"xitongjichengxiangmuguanligongchengshi"}]}],o=function(){var n=(0,h.Z)(),r=n.leftSiderStyle,s=n.contentStyle,d=function(t){console.log("menu click ",t)};return(0,g.jsxs)(l.Z,{children:[(0,g.jsx)(C,{style:r,children:(0,g.jsx)(m.Z,{mode:"inline",onClick:d,defaultSelectedKeys:["xinxixitongxiangmuguanlishi"],defaultOpenKeys:["top","middle"],items:j})}),(0,g.jsx)(l.Z,{children:(0,g.jsx)(N,{style:s,children:(0,g.jsx)(G,{})})})]})},a=o},69888:function(A,f,e){e.d(f,{G:function(){return E}});var h=e(85615),l=e(73445),m=e(782),u=e(18753),E=(0,l.Ue)()((0,m.mW)((0,m.tJ)((0,u.n)(function(c,R){return{messageResult:{data:{content:[]}},setMessageResult:function(y){c({messageResult:y})},deleteMessageCache:function(){return c({},!0)}}}),{name:h.j87})))},87676:function(A,f,e){e.d(f,{u:function(){return E}});var h=e(85615),l=e(73445),m=e(782),u=e(18753),E=(0,l.Ue)()((0,m.mW)((0,m.tJ)((0,u.n)(function(c,R){return{currentOrg:{uid:"",name:"",description:""},setCurrentOrg:function(y){c({currentOrg:y})},deleteOrg:function(){return c({},!0)}}}),{name:h.eRd})))}}]);
