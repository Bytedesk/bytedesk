"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[3165],{93139:function(e,t,n){var r=n(74145);t.Z=function(){var e=(0,r.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"}}}},57870:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var r=n(93139),a=n(64476),u=n(44194),i=n(90819),s=n.n(i),o=n(89933),c=n.n(o),d=n(45332),l=n.n(d),f=n(89756),p=n(73193),h=n.n(p),g=n(77667),m=n(82045);function x(e){return y.apply(this,arguments)}function y(){return(y=c()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/media/query/org",{method:"GET",params:h()(h()({},t),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=c()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/media/query/user",{method:"GET",params:h()(h()({},t),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=n(39701),S=n(83642),w=n(41617),M=(0,k.Ue)()((0,S.mW)((0,S.tJ)((0,w.n)((function(e,t){return{mediaResult:{data:{content:[]}},setMediaResult:function(t){e({mediaResult:t})},deleteMediaCache:function(){return e({},!0)}}})),{name:g.hS2}))),R=n(22509),j=n(52519),Z=n(31549);var C=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"标题",dataIndex:"title",copyable:!0},{title:(0,Z.jsx)(FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",render:function(e,t){return"image"===t.type?"图片":"视频"}},{title:(0,Z.jsx)(FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"content",ellipsis:!0,render:function(e,t){return function(e){return"image"===e.type?(0,Z.jsx)(Z.Fragment,{children:e.content.split(",").map((function(e,t){return(0,Z.jsxs)("a",{href:e,target:"_blank",children:["查看图片 ",t+1]},t)}))}):(0,Z.jsx)("a",{href:e.content,target:"_blank",children:"播放视频"})}(t)}},{title:(0,Z.jsx)(FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0},{title:intl.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",render:function(e,t,n,r){return[(0,Z.jsx)("a",{onClick:function(){console.log("edit record:",t)},children:"修改"},"editable")]}}],I=function(){var e=(0,R.L)((function(e){return e.userInfo})),t=(0,u.useRef)(),n=(0,u.useState)(1),r=l()(n,2),a=r[0],i=r[1],o=(0,u.useState)(10),d=l()(o,2),p=d[0],h=d[1],g=M((function(e){return{mediaResult:e.mediaResult,setMediaResult:e.setMediaResult}})),m=g.mediaResult,y=g.setMediaResult,b=function(){var t=c()(s()().mark((function t(){var n,r;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={pageNumber:a-1,pageSize:p},null==e||!e.superUser){t.next=7;break}return t.next=4,x(n);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,v(n);case 9:t.t0=t.sent;case 10:r=t.t0,console.log("getAllMedias response:",n,r),200===r.code?y(r):f.yw.error(r.message);case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,u.useEffect)((function(){b()}),[]),(0,u.useEffect)((function(){b()}),[a,p]),(0,u.useEffect)((function(){console.log("mediaResult:",m),t.current.reload()}),[m]),(0,Z.jsx)(j.Z,{columns:C,actionRef:t,cardBordered:!0,request:function(){var e=c()(s()().mark((function e(t,n,r){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request:",t,n,r),i(t.current),h(t.pageSize),e.abrupt("return",Promise.resolve({data:m.data.content,success:!0,total:m.data.totalElements}));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:p,showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"视频/图片",toolBarRender:function(){return[]}})},q=(a.Z.Sider,a.Z.Content),A=function(){var e=(0,r.Z)(),t=(e.leftSiderStyle,e.contentStyle);return(0,Z.jsx)(a.Z,{children:(0,Z.jsx)(a.Z,{children:(0,Z.jsx)(q,{style:t,children:(0,Z.jsx)(I,{})})})})}}}]);