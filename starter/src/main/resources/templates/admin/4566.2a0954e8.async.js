"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4566],{66916:function(e,t,n){n.d(t,{$l:function(){return h},JT:function(){return y},gf:function(){return F},lg:function(){return g},n1:function(){return S},p0:function(){return c},s9:function(){return f}});var i=n(90819),o=n.n(i),s=n(73193),r=n.n(s),u=n(89933),a=n.n(u),l=n(55735),d=n(30921);function c(e){return v.apply(this,arguments)}function v(){return(v=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/query/org",{method:"GET",params:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return p.apply(this,arguments)}function p(){return(p=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/create",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/create/prompt",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return w.apply(this,arguments)}function w(){return(w=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/update",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return q.apply(this,arguments)}function q(){return(q=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/update/avatar",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/update/prompt",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return k.apply(this,arguments)}function k(){return(k=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/delete",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},99885:function(e,t,n){n.d(t,{Yg:function(){return h},kh:function(){return g},pf:function(){return c},y:function(){return f}});var i=n(90819),o=n.n(i),s=n(73193),r=n.n(s),u=n(89933),a=n.n(u),l=n(55735),d=n(30921);function c(e){return v.apply(this,arguments)}function v(){return(v=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/query/org",{method:"GET",params:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return p.apply(this,arguments)}function p(){return(p=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/create",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/update",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return w.apply(this,arguments)}function w(){return(w=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/delete",{method:"POST",data:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},69842:function(e,t,n){n.d(t,{H:function(){return c}});var i=n(90819),o=n.n(i),s=n(73193),r=n.n(s),u=n(89933),a=n.n(u),l=n(55735),d=n(30921);function c(e){return v.apply(this,arguments)}function v(){return(v=a()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/vip/invoice/query/org",{method:"GET",params:r()(r()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},43705:function(e,t,n){var i=n(73193),o=n.n(i),s=n(90819),r=n.n(s),u=n(89933),a=n.n(u),l=n(45332),d=n.n(l),c=n(86803),v=n(99885),g=n(66916),p=n(76750),f=n(66310),m=n(40612),h=n(40429),w=n(5651),S=n(69169),q=n(48708),y=n(84881),b=n(30921),F=n(32943),k=n(75365),x=n(38775),U=n(3849),C=n(44194),j=n(1902),M=n(95490),T=n(55735),R=n(24170),A=n(72614),Z=n(11184),I=n(31549);t.Z=function(e){var t,n=e.type,i=S.A.useForm(),s=d()(i,1)[0],u=(0,b.useIntl)(),l=(0,b.useNavigate)(),P=(0,p.Z)().translateString,L=(0,Z.M)(),W=L.config,V=L.updateConfig,_=(0,m.u)((function(e){return e.currentOrg})),N=(0,C.useState)(),D=d()(N,2),O=D[0],E=D[1],X=(0,f.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),Y=X.currentRobot,B=X.setCurrentRobot,$=(0,j.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),H=$.currentAgent,G=$.setCurrentAgent,Q=(0,M.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),z=Q.currentWorkgroup,K=Q.setCurrentWorkgroup,J=(0,C.useMemo)((function(){return n===T._X4?{chatType:T.xtN,chatSid:Y.uid}:n===T.Njn?{chatType:T.scI,chatSid:H.uid}:n===T.aZD?{chatType:T.vPY,chatSid:z.uid}:{chatType:T.xtN,chatSid:""}}),[n,Y,H,z]),ee=J.chatType,te=J.chatSid,ne=function(){var e=a()(r()().mark((function e(){var t,n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(u.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,orgUid:null==_?void 0:_.uid},e.next=4,(0,v.pf)(t);case 4:n=e.sent,console.log("getAllFaqs response:",t,n),c.yw.destroy(),200===n.code?E(n):c.yw.error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,C.useEffect)((function(){ne()}),[]),(0,C.useEffect)((function(){var e,t,i;if(n===T._X4)s.setFieldsValue({showFaqs:null==Y||null===(e=Y.serviceSettings)||void 0===e?void 0:e.showFaqs,faqUids:null==Y||null===(t=Y.serviceSettings)||void 0===t||null===(t=t.faqs)||void 0===t?void 0:t.map((function(e){return e.uid}))}),null!=Y&&null!==(i=Y.serviceSettings)&&void 0!==i&&i.showFaqs?V(o()(o()({},W),{},{window:o()(o()({},W.window),{},{width:680}),chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})})):V(o()(o()({},W),{},{window:o()(o()({},W.window),{},{width:380}),chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})}));else if(n===T.Njn){var r,u,a;s.setFieldsValue({showFaqs:null==H||null===(r=H.serviceSettings)||void 0===r?void 0:r.showFaqs,faqUids:null==H||null===(u=H.serviceSettings)||void 0===u||null===(u=u.faqs)||void 0===u?void 0:u.map((function(e){return e.uid}))}),null!=H&&null!==(a=H.serviceSettings)&&void 0!==a&&a.showFaqs?V(o()(o()({},W),{},{window:o()(o()({},W.window),{},{width:680}),chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})})):V(o()(o()({},W),{},{window:o()(o()({},W.window),{},{width:380}),chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})}))}else if(n===T.aZD){var l,d,c;s.setFieldsValue({showFaqs:null==z||null===(l=z.serviceSettings)||void 0===l?void 0:l.showFaqs,faqUids:null==z||null===(d=z.serviceSettings)||void 0===d||null===(d=d.faqs)||void 0===d?void 0:d.map((function(e){return e.uid}))}),null!=z&&null!==(c=z.serviceSettings)&&void 0!==c&&c.showFaqs?V(o()(o()({},W),{},{window:o()(o()({},W.window),{},{width:680}),chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})})):V(o()(o()({},W),{},{window:o()(o()({},W.window),{},{width:380}),chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})}))}}),[Y,H,z,ee,te]);var ie=function(){var e=a()(r()().mark((function e(t){var i,s,a,l,d,v,p,f,m,h,w,S,q,y,b,F,k,x,U,C,j,M,Z,I,P;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onFinish",t),n!==T._X4){e.next=11;break}return v=o()(o()({},Y),{},{serviceSettings:o()(o()({},Y.serviceSettings),{},{showFaqs:t.showFaqs,faqUids:t.faqUids,welcomeFaqUids:null==Y||null===(i=Y.serviceSettings)||void 0===i||null===(i=i.welcomeFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),quickFaqUids:null==Y||null===(s=Y.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),guessFaqUids:null==Y||null===(a=Y.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),hotFaqUids:null==Y||null===(l=Y.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==Y||null===(d=Y.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))})}),console.log("robotObject:",v),e.next=6,(0,g.$l)(v);case 6:p=e.sent,console.log("updateRobot response:",p),200===p.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),B(p.data)):(c.yw.destroy(),c.yw.error(p.message)),e.next=29;break;case 11:if(n!==T.Njn){e.next=21;break}return b=o()(o()({},H),{},{serviceSettings:o()(o()({},null==H?void 0:H.serviceSettings),{},{showFaqs:t.showFaqs,faqUids:t.faqUids,welcomeFaqUids:null==H||null===(f=H.serviceSettings)||void 0===f||null===(f=f.welcomeFaqs)||void 0===f?void 0:f.map((function(e){return e.uid})),quickFaqUids:null==H||null===(m=H.serviceSettings)||void 0===m||null===(m=m.quickFaqs)||void 0===m?void 0:m.map((function(e){return e.uid})),guessFaqUids:null==H||null===(h=H.serviceSettings)||void 0===h||null===(h=h.guessFaqs)||void 0===h?void 0:h.map((function(e){return e.uid})),hotFaqUids:null==H||null===(w=H.serviceSettings)||void 0===w||null===(w=w.hotFaqs)||void 0===w?void 0:w.map((function(e){return e.uid})),shortcutFaqUids:null==H||null===(S=H.serviceSettings)||void 0===S||null===(S=S.shortcutFaqs)||void 0===S?void 0:S.map((function(e){return e.uid}))}),messageLeaveSettings:o()(o()({},H.messageLeaveSettings),{},{worktimeUids:null==H||null===(q=H.messageLeaveSettings)||void 0===q||null===(q=q.worktimes)||void 0===q?void 0:q.map((function(e){return e.uid}))}),robotSettings:o()(o()({},H.robotSettings),{},{robotUid:null==H||null===(y=H.robotSettings)||void 0===y||null===(y=y.robot)||void 0===y?void 0:y.uid}),autoReplySettings:o()({},H.autoReplySettings)}),console.log("agentObject:",b),e.next=16,(0,R.sE)(b);case 16:F=e.sent,console.log("updateAgent response:",F),200===F.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),G(F.data)):(c.yw.destroy(),c.yw.error(F.message)),e.next=29;break;case 21:if(n!==T.aZD){e.next=29;break}return I=o()(o()({},z),{},{serviceSettings:o()(o()({},z.serviceSettings),{},{showFaqs:t.showFaqs,faqUids:t.faqUids,welcomeFaqUids:null==z||null===(k=z.serviceSettings)||void 0===k||null===(k=k.welcomeFaqs)||void 0===k?void 0:k.map((function(e){return e.uid})),quickFaqUids:null==z||null===(x=z.serviceSettings)||void 0===x||null===(x=x.quickFaqs)||void 0===x?void 0:x.map((function(e){return e.uid})),guessFaqUids:null==z||null===(U=z.serviceSettings)||void 0===U||null===(U=U.guessFaqs)||void 0===U?void 0:U.map((function(e){return e.uid})),hotFaqUids:null==z||null===(C=z.serviceSettings)||void 0===C||null===(C=C.hotFaqs)||void 0===C?void 0:C.map((function(e){return e.uid})),shortcutFaqUids:null==z||null===(j=z.serviceSettings)||void 0===j||null===(j=j.shortcutFaqs)||void 0===j?void 0:j.map((function(e){return e.uid}))}),robotSettings:o()(o()({},z.robotSettings),{},{robotUid:null==z||null===(M=z.robotSettings)||void 0===M||null===(M=M.robot)||void 0===M?void 0:M.uid}),messageLeaveSettings:o()(o()({},z.messageLeaveSettings),{},{worktimeUids:null==z||null===(Z=z.messageLeaveSettings)||void 0===Z||null===(Z=Z.worktimes)||void 0===Z?void 0:Z.map((function(e){return e.uid}))}),agentUids:z.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",I),e.next=26,(0,A.W5)(I);case 26:P=e.sent,console.log("updateWorkGroup response:",P),200===P.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),K(P.data)):(c.yw.destroy(),c.yw.error(P.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=a()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabFaqs handleChange",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,I.jsxs)("div",{children:[(0,I.jsx)(F.Z,{message:u.formatMessage({id:"faq.create.first"}),type:"success",action:(0,I.jsx)(k.ZP,{type:"link",icon:(0,I.jsx)(h.Z,{}),onClick:function(){return window.open(T.VPj)},children:u.formatMessage({id:"setting.helpcenter"})})}),(0,I.jsx)(x.Z,{}),(0,I.jsxs)(S.A,{form:s,layout:"vertical",onFinish:ie,children:[(0,I.jsx)(q.Z,{label:u.formatMessage({id:"faq.show.faqs"}),name:"showFaqs",fieldProps:{onChange:oe}}),(0,I.jsx)(S.A.Item,{children:(0,I.jsx)(k.ZP,{type:"primary",icon:(0,I.jsx)(w.Z,{}),onClick:function(){l("/kb/llm/data")},children:u.formatMessage({id:"faq.add.faqs"})},"github")}),(0,I.jsx)(y.Z,{name:"faqUids",width:"md",label:u.formatMessage({id:"menu.kbase.faq"}),options:null==O||null===(t=O.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return{label:P(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:(0,I.jsx)(b.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}})]}),(0,I.jsxs)(U.Z,{direction:"horizontal",style:{width:"100%",marginTop:10,marginBottom:10},children:[(0,I.jsx)(k.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:u.formatMessage({id:"chat.window.show"})}),(0,I.jsx)(k.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.hideChat()},children:u.formatMessage({id:"chat.window.hide"})})]})]})}},71469:function(e,t,n){var i=n(73193),o=n.n(i),s=n(90819),r=n.n(s),u=n(89933),a=n.n(u),l=n(45332),d=n.n(l),c=n(86803),v=n(99885),g=n(66916),p=n(76750),f=n(66310),m=n(40612),h=n(40429),w=n(5651),S=n(69169),q=n(48708),y=n(84881),b=n(30921),F=n(32943),k=n(75365),x=n(38775),U=n(3849),C=n(44194),j=n(1902),M=n(95490),T=n(55735),R=n(24170),A=n(72614),Z=n(11184),I=n(31549);t.Z=function(e){var t,n=e.type,i=S.A.useForm(),s=d()(i,1)[0],u=(0,b.useIntl)(),l=(0,b.useNavigate)(),P=(0,p.Z)().translateString,L=(0,Z.M)(),W=L.config,V=L.updateConfig,_=(0,m.u)((function(e){return e.currentOrg})),N=(0,C.useState)(),D=d()(N,2),O=D[0],E=D[1],X=(0,f.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),Y=X.currentRobot,B=X.setCurrentRobot,$=(0,j.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),H=$.currentAgent,G=$.setCurrentAgent,Q=(0,M.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),z=Q.currentWorkgroup,K=Q.setCurrentWorkgroup,J=(0,C.useMemo)((function(){return n===T._X4?{chatType:T.xtN,chatSid:Y.uid}:n===T.Njn?{chatType:T.scI,chatSid:H.uid}:n===T.aZD?{chatType:T.vPY,chatSid:z.uid}:{chatType:T.xtN,chatSid:""}}),[n,Y,H,z]),ee=J.chatType,te=J.chatSid,ne=function(){var e=a()(r()().mark((function e(){var t,n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(u.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,orgUid:null==_?void 0:_.uid},e.next=4,(0,v.pf)(t);case 4:n=e.sent,console.log("getAllFaqs response:",t,n),c.yw.destroy(),200===n.code?E(n):c.yw.error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,C.useEffect)((function(){ne()}),[_]),(0,C.useEffect)((function(){var e,t;if(n===T._X4)s.setFieldsValue({showQuickFaqs:null==Y||null===(e=Y.serviceSettings)||void 0===e?void 0:e.showQuickFaqs,quickFaqUids:null==Y||null===(t=Y.serviceSettings)||void 0===t||null===(t=t.quickFaqs)||void 0===t?void 0:t.map((function(e){return e.uid}))}),V(o()(o()({},W),{},{chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})}));else if(n===T.Njn){var i,r;s.setFieldsValue({showQuickFaqs:null==H||null===(i=H.serviceSettings)||void 0===i?void 0:i.showQuickFaqs,quickFaqUids:null==H||null===(r=H.serviceSettings)||void 0===r||null===(r=r.quickFaqs)||void 0===r?void 0:r.map((function(e){return e.uid}))}),V(o()(o()({},W),{},{chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})}))}else if(n===T.aZD){var u,a;s.setFieldsValue({showQuickFaqs:null==z||null===(u=z.serviceSettings)||void 0===u?void 0:u.showQuickFaqs,quickFaqUids:null==z||null===(a=z.serviceSettings)||void 0===a||null===(a=a.quickFaqs)||void 0===a?void 0:a.map((function(e){return e.uid}))}),V(o()(o()({},W),{},{chatConfig:o()(o()({},W.chatConfig),{},{org:null==_?void 0:_.uid,t:ee,sid:te})}))}}),[Y,H,z,ee,te]);var ie=function(){var e=a()(r()().mark((function e(t){var i,s,a,l,d,v,p,f,m,h,w,S,q,y,b,F,k,x,U,C,j,M,Z,I,P;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onFinish",t),n!==T._X4){e.next=11;break}return v=o()(o()({},Y),{},{serviceSettings:o()(o()({},Y.serviceSettings),{},{showQuickFaqs:t.showQuickFaqs,quickFaqUids:t.quickFaqUids,welcomeFaqUids:null==Y||null===(i=Y.serviceSettings)||void 0===i||null===(i=i.welcomeFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),faqUids:null==Y||null===(s=Y.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),guessFaqUids:null==Y||null===(a=Y.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),hotFaqUids:null==Y||null===(l=Y.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==Y||null===(d=Y.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))})}),console.log("robotObject:",v),e.next=6,(0,g.$l)(v);case 6:p=e.sent,console.log("updateRobot response:",p),200===p.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),B(p.data)):(c.yw.destroy(),c.yw.error(p.message)),e.next=29;break;case 11:if(n!==T.Njn){e.next=21;break}return b=o()(o()({},H),{},{serviceSettings:o()(o()({},null==H?void 0:H.serviceSettings),{},{showQuickFaqs:t.showQuickFaqs,quickFaqUids:t.quickFaqUids,welcomeFaqUids:null==H||null===(f=H.serviceSettings)||void 0===f||null===(f=f.welcomeFaqs)||void 0===f?void 0:f.map((function(e){return e.uid})),faqUids:null==H||null===(m=H.serviceSettings)||void 0===m||null===(m=m.faqs)||void 0===m?void 0:m.map((function(e){return e.uid})),guessFaqUids:null==H||null===(h=H.serviceSettings)||void 0===h||null===(h=h.guessFaqs)||void 0===h?void 0:h.map((function(e){return e.uid})),hotFaqUids:null==H||null===(w=H.serviceSettings)||void 0===w||null===(w=w.hotFaqs)||void 0===w?void 0:w.map((function(e){return e.uid})),shortcutFaqUids:null==H||null===(S=H.serviceSettings)||void 0===S||null===(S=S.shortcutFaqs)||void 0===S?void 0:S.map((function(e){return e.uid}))}),robotSettings:o()(o()({},H.robotSettings),{},{robotUid:null==H||null===(q=H.robotSettings)||void 0===q||null===(q=q.robot)||void 0===q?void 0:q.uid}),messageLeaveSettings:o()(o()({},H.messageLeaveSettings),{},{worktimeUids:null==H||null===(y=H.messageLeaveSettings)||void 0===y||null===(y=y.worktimes)||void 0===y?void 0:y.map((function(e){return e.uid}))}),autoReplySettings:o()({},H.autoReplySettings)}),console.log("agentObject:",b),e.next=16,(0,R.sE)(b);case 16:F=e.sent,console.log("updateAgent response:",F),200===F.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),G(F.data)):(c.yw.destroy(),c.yw.error(F.message)),e.next=29;break;case 21:if(n!==T.aZD){e.next=29;break}return I=o()(o()({},z),{},{serviceSettings:o()(o()({},z.serviceSettings),{},{showQuickFaqs:t.showQuickFaqs,quickFaqUids:t.quickFaqUids,welcomeFaqUids:null==z||null===(k=z.serviceSettings)||void 0===k||null===(k=k.welcomeFaqs)||void 0===k?void 0:k.map((function(e){return e.uid})),faqUids:null===(x=z.serviceSettings)||void 0===x||null===(x=x.faqs)||void 0===x?void 0:x.map((function(e){return e.uid})),guessFaqUids:null==z||null===(U=z.serviceSettings)||void 0===U||null===(U=U.guessFaqs)||void 0===U?void 0:U.map((function(e){return e.uid})),hotFaqUids:null==z||null===(C=z.serviceSettings)||void 0===C||null===(C=C.hotFaqs)||void 0===C?void 0:C.map((function(e){return e.uid})),shortcutFaqUids:null==z||null===(j=z.serviceSettings)||void 0===j||null===(j=j.shortcutFaqs)||void 0===j?void 0:j.map((function(e){return e.uid}))}),robotSettings:o()(o()({},z.robotSettings),{},{robotUid:null==z||null===(M=z.robotSettings)||void 0===M||null===(M=M.robot)||void 0===M?void 0:M.uid}),messageLeaveSettings:o()(o()({},z.messageLeaveSettings),{},{worktimeUids:null==z||null===(Z=z.messageLeaveSettings)||void 0===Z||null===(Z=Z.worktimes)||void 0===Z?void 0:Z.map((function(e){return e.uid}))}),agentUids:z.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",I),e.next=26,(0,A.W5)(I);case 26:P=e.sent,console.log("updateWorkGroup response:",P),200===P.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),K(P.data)):(c.yw.destroy(),c.yw.error(P.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=a()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabFaqs handleChange",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,I.jsxs)("div",{children:[(0,I.jsx)(F.Z,{message:u.formatMessage({id:"faq.create.first"}),type:"success",action:(0,I.jsx)(k.ZP,{type:"link",icon:(0,I.jsx)(h.Z,{}),onClick:function(){return window.open(T.VPj)},children:u.formatMessage({id:"setting.helpcenter"})})}),(0,I.jsx)(x.Z,{}),(0,I.jsxs)(S.A,{form:s,layout:"vertical",onFinish:ie,children:[(0,I.jsx)(q.Z,{label:u.formatMessage({id:"faq.show.quick.buttons"}),name:"showQuickFaqs",fieldProps:{onChange:oe}}),(0,I.jsx)(S.A.Item,{children:(0,I.jsx)(k.ZP,{type:"primary",icon:(0,I.jsx)(w.Z,{}),onClick:function(){l("/kb/llm/data")},children:u.formatMessage({id:"faq.add.quick.buttons"})},"github")}),(0,I.jsx)(y.Z,{name:"quickFaqUids",width:"md",label:u.formatMessage({id:"menu.kbase.quickbutton"}),options:null==O||null===(t=O.data)||void 0===t?void 0:t.content.map((function(e){return{label:P(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:(0,I.jsx)(b.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}})]}),(0,I.jsxs)(U.Z,{direction:"horizontal",style:{width:"100%",marginTop:10,marginBottom:10},children:[(0,I.jsx)(k.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:u.formatMessage({id:"show.chat.window"})}),(0,I.jsx)(k.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.hideChat()},children:u.formatMessage({id:"hide.chat.window"})})]})]})}},50796:function(e,t,n){var i=n(90819),o=n.n(i),s=n(73193),r=n.n(s),u=n(89933),a=n.n(u),l=n(45332),d=n.n(l),c=n(86803),v=n(24170),g=n(66916),p=n(72614),f=n(1902),m=n(66310),h=n(95490),w=n(55735),S=n(69169),q=n(48708),y=n(30921),b=n(44194),F=n(31549);t.Z=function(e){var t=e.type,n=(0,y.useIntl)(),i=S.A.useForm(),s=d()(i,1)[0],u=(0,m.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),l=u.currentRobot,k=u.setCurrentRobot,x=(0,f.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),U=x.currentAgent,C=x.setCurrentAgent,j=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),M=j.currentWorkgroup,T=j.setCurrentWorkgroup;(0,b.useEffect)((function(){var e;if(t===w._X4)s.setFieldsValue({showInputAssociation:null==l||null===(e=l.serviceSettings)||void 0===e?void 0:e.showInputAssociation});else if(t===w.Njn){var n;s.setFieldsValue({showInputAssociation:null==U||null===(n=U.serviceSettings)||void 0===n?void 0:n.showInputAssociation})}else if(t===w.aZD){var i;s.setFieldsValue({showInputAssociation:null==M||null===(i=M.serviceSettings)||void 0===i?void 0:i.showInputAssociation})}}),[l,U,M]);var R=function(){var e=a()(o()().mark((function e(i){var s,u,a,d,f,m,h,S,q,y,b,F,x,j,R,A,Z,I,P,L,W,V,_,N,D;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleInputAssociationSubmit:",i),t!==w._X4){e.next=11;break}return m=r()(r()({},l),{},{serviceSettings:r()(r()({},l.serviceSettings),{},{showInputAssociation:i.showInputAssociation,faqUids:null==U||null===(s=U.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),quickFaqUids:null==l||null===(u=l.serviceSettings)||void 0===u||null===(u=u.quickFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),guessFaqUids:null==l||null===(a=l.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),hotFaqUids:null==l||null===(d=l.serviceSettings)||void 0===d||null===(d=d.hotFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),shortcutFaqUids:null==l||null===(f=l.serviceSettings)||void 0===f||null===(f=f.shortcutFaqs)||void 0===f?void 0:f.map((function(e){return e.uid}))})}),console.log("robotObject:",m),e.next=6,(0,g.$l)(m);case 6:h=e.sent,console.log("updateRobot response:",h),200===h.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),k(h.data)):(c.yw.destroy(),c.yw.error(h.message)),e.next=29;break;case 11:if(t!==w.Njn){e.next=21;break}return R=r()(r()({},U),{},{serviceSettings:r()(r()({},null==U?void 0:U.serviceSettings),{},{showInputAssociation:i.showInputAssociation,faqUids:null==U||null===(S=U.serviceSettings)||void 0===S||null===(S=S.faqs)||void 0===S?void 0:S.map((function(e){return e.uid})),quickFaqUids:null==U||null===(q=U.serviceSettings)||void 0===q||null===(q=q.quickFaqs)||void 0===q?void 0:q.map((function(e){return e.uid})),guessFaqUids:null==U||null===(y=U.serviceSettings)||void 0===y||null===(y=y.guessFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),hotFaqUids:null==U||null===(b=U.serviceSettings)||void 0===b||null===(b=b.hotFaqs)||void 0===b?void 0:b.map((function(e){return e.uid})),shortcutFaqUids:null==U||null===(F=U.serviceSettings)||void 0===F||null===(F=F.shortcutFaqs)||void 0===F?void 0:F.map((function(e){return e.uid}))}),robotSettings:r()(r()({},U.robotSettings),{},{robotUid:null==U||null===(x=U.robotSettings)||void 0===x||null===(x=x.robot)||void 0===x?void 0:x.uid}),messageLeaveSettings:r()(r()({},U.messageLeaveSettings),{},{worktimeUids:null==U||null===(j=U.messageLeaveSettings)||void 0===j||null===(j=j.worktimes)||void 0===j?void 0:j.map((function(e){return e.uid}))}),autoReplySettings:r()({},U.autoReplySettings)}),console.log("agentObject:",R),e.next=16,(0,v.sE)(R);case 16:A=e.sent,console.log("updateAgent response:",A),200===A.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),C(A.data)):(c.yw.destroy(),c.yw.error(A.message)),e.next=29;break;case 21:if(t!==w.aZD){e.next=29;break}return N=r()(r()({},M),{},{serviceSettings:r()(r()({},M.serviceSettings),{},{showInputAssociation:i.showInputAssociation,faqUids:null==U||null===(Z=U.serviceSettings)||void 0===Z||null===(Z=Z.faqs)||void 0===Z?void 0:Z.map((function(e){return e.uid})),quickFaqUids:null===(I=M.serviceSettings)||void 0===I||null===(I=I.quickFaqs)||void 0===I?void 0:I.map((function(e){return e.uid})),guessFaqUids:null==M||null===(P=M.serviceSettings)||void 0===P||null===(P=P.guessFaqs)||void 0===P?void 0:P.map((function(e){return e.uid})),hotFaqUids:null==M||null===(L=M.serviceSettings)||void 0===L||null===(L=L.hotFaqs)||void 0===L?void 0:L.map((function(e){return e.uid})),shortcutFaqUids:null==M||null===(W=M.serviceSettings)||void 0===W||null===(W=W.shortcutFaqs)||void 0===W?void 0:W.map((function(e){return e.uid}))}),robotSettings:r()(r()({},M.robotSettings),{},{robotUid:null==M||null===(V=M.robotSettings)||void 0===V||null===(V=V.robot)||void 0===V?void 0:V.uid}),messageLeaveSettings:r()(r()({},M.messageLeaveSettings),{},{worktimeUids:null==M||null===(_=M.messageLeaveSettings)||void 0===_||null===(_=_.worktimes)||void 0===_?void 0:_.map((function(e){return e.uid}))}),agentUids:M.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",N),e.next=26,(0,p.W5)(N);case 26:D=e.sent,console.log("updateWorkGroup response:",D),200===D.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),T(D.data)):(c.yw.destroy(),c.yw.error(D.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,F.jsx)("div",{children:(0,F.jsx)(S.A,{form:s,onFinish:R,children:(0,F.jsx)(q.Z,{width:"md",name:"showInputAssociation",label:n.formatMessage({id:"showInputAssociation",defaultMessage:"Show Input Association"})})})})}},75808:function(e,t,n){var i=n(90819),o=n.n(i),s=n(89933),r=n.n(s),u=n(73193),a=n.n(u),l=n(45332),d=n.n(l),c=n(86803),v=n(24170),g=n(66916),p=n(72614),f=n(1902),m=n(66310),h=n(95490),w=n(55735),S=n(69169),q=n(48708),y=n(32350),b=n(30921),F=n(44194),k=n(11184),x=n(3849),U=n(75365),C=n(31549);t.Z=function(e){var t=e.type,n=(0,b.useIntl)(),i=S.A.useForm(),s=d()(i,1)[0],u=(0,k.M)(),l=u.config,j=u.updateConfig,M=(0,m.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),T=M.currentRobot,R=M.setCurrentRobot,A=(0,f.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),Z=A.currentAgent,I=A.setCurrentAgent,P=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),L=P.currentWorkgroup,W=P.setCurrentWorkgroup,V=(0,F.useMemo)((function(){return t===w._X4?{chatType:w.xtN,chatSid:T.uid}:t===w.Njn?{chatType:w.scI,chatSid:Z.uid}:t===w.aZD?{chatType:w.vPY,chatSid:L.uid}:{chatType:w.xtN,chatSid:""}}),[t,T,Z,L]),_=V.chatType,N=V.chatSid;(0,F.useEffect)((function(){var e,n,i,o,r,u;if(t===w._X4)s.setFieldsValue({autoPopup:null==T||null===(e=T.serviceSettings)||void 0===e?void 0:e.autoPopup,showInvite:null==T||null===(n=T.inviteSettings)||void 0===n?void 0:n.show,inviteText:null==T||null===(i=T.inviteSettings)||void 0===i?void 0:i.text}),j(a()(a()({},l),{},{autoPopup:null==T||null===(o=T.serviceSettings)||void 0===o?void 0:o.autoPopup,inviteConfig:{show:null==T||null===(r=T.inviteSettings)||void 0===r?void 0:r.show,text:null==T||null===(u=T.inviteSettings)||void 0===u?void 0:u.text},chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N})}));else if(t===w.Njn){var d,c,v,g,p,f;s.setFieldsValue({autoPopup:null==Z||null===(d=Z.serviceSettings)||void 0===d?void 0:d.autoPopup,showInvite:null==Z||null===(c=Z.inviteSettings)||void 0===c?void 0:c.show,inviteText:null==Z||null===(v=Z.inviteSettings)||void 0===v?void 0:v.text}),j(a()(a()({},l),{},{autoPopup:null==Z||null===(g=Z.serviceSettings)||void 0===g?void 0:g.autoPopup,inviteConfig:{show:null==Z||null===(p=Z.inviteSettings)||void 0===p?void 0:p.show,text:null==Z||null===(f=Z.inviteSettings)||void 0===f?void 0:f.text},chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N})}))}else if(t===w.aZD){var m,h,S,q,y,b;s.setFieldsValue({autoPopup:null==L||null===(m=L.serviceSettings)||void 0===m?void 0:m.autoPopup,showInvite:null==L||null===(h=L.inviteSettings)||void 0===h?void 0:h.show,inviteText:null==L||null===(S=L.inviteSettings)||void 0===S?void 0:S.text}),j(a()(a()({},l),{},{autoPopup:null==L||null===(q=L.serviceSettings)||void 0===q?void 0:q.autoPopup,inviteConfig:{show:null==L||null===(y=L.inviteSettings)||void 0===y?void 0:y.show,text:null==L||null===(b=L.inviteSettings)||void 0===b?void 0:b.text},chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N})}))}}),[T,Z,L,_,N]);var D=function(){var e=r()(o()().mark((function e(i){var s,r,u,l,d,f,m,h,S,q,y,b,F,k,x,U,C,j,M,A,P,V,_,N,D,O,E,X;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handlePreFormSubmit:",i),t!==w._X4){e.next=11;break}return m=a()(a()({},T),{},{serviceSettings:a()(a()({},T.serviceSettings),{},{autoPopup:i.autoPopup,welcomeFaqUids:null==T||null===(s=T.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==T||null===(r=T.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),quickFaqUids:null==T||null===(u=T.serviceSettings)||void 0===u||null===(u=u.quickFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),guessFaqUids:null==T||null===(l=T.serviceSettings)||void 0===l||null===(l=l.guessFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),hotFaqUids:null==T||null===(d=T.serviceSettings)||void 0===d||null===(d=d.hotFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),shortcutFaqUids:null==T||null===(f=T.serviceSettings)||void 0===f||null===(f=f.shortcutFaqs)||void 0===f?void 0:f.map((function(e){return e.uid}))}),inviteSettings:a()(a()({},T.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("robotObject:",m),e.next=6,(0,g.$l)(m);case 6:h=e.sent,console.log("updateRobot response:",h),200===h.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),R(h.data)):(c.yw.destroy(),c.yw.error(h.message)),e.next=29;break;case 11:if(t!==w.Njn){e.next=21;break}return C=a()(a()({},Z),{},{serviceSettings:a()(a()({},null==Z?void 0:Z.serviceSettings),{},{autoPopup:i.autoPopup,welcomeFaqUids:null==Z||null===(S=Z.serviceSettings)||void 0===S||null===(S=S.faqs)||void 0===S?void 0:S.map((function(e){return e.uid})),faqUids:null==Z||null===(q=Z.serviceSettings)||void 0===q||null===(q=q.faqs)||void 0===q?void 0:q.map((function(e){return e.uid})),quickFaqUids:null==Z||null===(y=Z.serviceSettings)||void 0===y||null===(y=y.quickFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),guessFaqUids:null==Z||null===(b=Z.serviceSettings)||void 0===b||null===(b=b.guessFaqs)||void 0===b?void 0:b.map((function(e){return e.uid})),hotFaqUids:null==Z||null===(F=Z.serviceSettings)||void 0===F||null===(F=F.hotFaqs)||void 0===F?void 0:F.map((function(e){return e.uid})),shortcutFaqUids:null==Z||null===(k=Z.serviceSettings)||void 0===k||null===(k=k.shortcutFaqs)||void 0===k?void 0:k.map((function(e){return e.uid}))}),robotSettings:a()(a()({},Z.robotSettings),{},{robotUid:null==Z||null===(x=Z.robotSettings)||void 0===x||null===(x=x.robot)||void 0===x?void 0:x.uid}),messageLeaveSettings:a()(a()({},Z.messageLeaveSettings),{},{worktimeUids:null==Z||null===(U=Z.messageLeaveSettings)||void 0===U||null===(U=U.worktimes)||void 0===U?void 0:U.map((function(e){return e.uid}))}),autoReplySettings:a()({},Z.autoReplySettings),inviteSettings:a()(a()({},Z.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("agentObject:",C),e.next=16,(0,v.sE)(C);case 16:j=e.sent,console.log("updateAgent response:",j),200===j.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),I(j.data)):(c.yw.destroy(),c.yw.error(j.message)),e.next=29;break;case 21:if(t!==w.aZD){e.next=29;break}return E=a()(a()({},L),{},{serviceSettings:a()(a()({},L.serviceSettings),{},{autoPopup:i.autoPopup,welcomeFaqUids:null==L||null===(M=L.serviceSettings)||void 0===M||null===(M=M.faqs)||void 0===M?void 0:M.map((function(e){return e.uid})),faqUids:null==L||null===(A=L.serviceSettings)||void 0===A||null===(A=A.faqs)||void 0===A?void 0:A.map((function(e){return e.uid})),quickFaqUids:null===(P=L.serviceSettings)||void 0===P||null===(P=P.quickFaqs)||void 0===P?void 0:P.map((function(e){return e.uid})),guessFaqUids:null==L||null===(V=L.serviceSettings)||void 0===V||null===(V=V.guessFaqs)||void 0===V?void 0:V.map((function(e){return e.uid})),hotFaqUids:null==L||null===(_=L.serviceSettings)||void 0===_||null===(_=_.hotFaqs)||void 0===_?void 0:_.map((function(e){return e.uid})),shortcutFaqUids:null==L||null===(N=L.serviceSettings)||void 0===N||null===(N=N.shortcutFaqs)||void 0===N?void 0:N.map((function(e){return e.uid}))}),robotSettings:a()(a()({},L.robotSettings),{},{robotUid:null==L||null===(D=L.robotSettings)||void 0===D||null===(D=D.robot)||void 0===D?void 0:D.uid}),messageLeaveSettings:a()(a()({},L.messageLeaveSettings),{},{worktimeUids:null==L||null===(O=L.messageLeaveSettings)||void 0===O||null===(O=O.worktimes)||void 0===O?void 0:O.map((function(e){return e.uid}))}),inviteSettings:a()(a()({},L.inviteSettings),{},{show:i.showInvite,text:i.inviteText}),agentUids:L.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",E),e.next=26,(0,p.W5)(E);case 26:X=e.sent,console.log("updateWorkGroup response:",X),200===X.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),W(X.data)):(c.yw.destroy(),c.yw.error(X.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,C.jsxs)("div",{children:[(0,C.jsxs)(S.A,{form:s,onFinish:D,children:[(0,C.jsx)(q.Z,{width:"md",name:"autoPopup",label:n.formatMessage({id:"autoPopup",defaultMessage:"Auto Popup"})}),(0,C.jsx)(q.Z,{width:"md",name:"showInvite",label:n.formatMessage({id:"showInvite",defaultMessage:"Show Invite"})}),(0,C.jsx)(y.Z,{width:"md",name:"inviteText",label:n.formatMessage({id:"inviteText",defaultMessage:"Invite Text"})})]}),(0,C.jsxs)(x.Z,{direction:"horizontal",style:{width:"100%",marginTop:10,marginBottom:10},children:[(0,C.jsx)(U.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:n.formatMessage({id:"show.chat.window"})}),(0,C.jsx)(U.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.hideChat()},children:n.formatMessage({id:"hide.chat.window"})})]})]})}},54166:function(e,t,n){n(90819),n(73193),n(89933),n(45332),n(24170),n(66916),n(72614),n(1902),n(66310),n(95490),n(55735),n(30921),n(44194),n(31549)},23635:function(e,t,n){var i=n(90819),o=n.n(i),s=n(73193),r=n.n(s),u=n(89933),a=n.n(u),l=n(45332),d=n.n(l),c=n(86803),v=n(24170),g=n(72614),p=n(1902),f=n(95490),m=n(55735),h=n(65461),w=n(69169),S=n(48708),q=n(30921),y=n(44194),b=n(51990),F=n(66310),k=n(66916),x=n(76750),U=n(31549);t.Z=function(e){var t=e.type,n=(0,q.useIntl)(),i=w.A.useForm(),s=d()(i,1)[0],u=(0,x.Z)().translateString,l=(0,y.useState)(!1),C=d()(l,2),j=(C[0],C[1],(0,y.useState)("")),M=d()(j,2),T=M[0],R=M[1],A=(0,F.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),Z=A.currentRobot,I=A.setCurrentRobot,P=(0,p.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),L=P.currentAgent,W=P.setCurrentAgent,V=(0,f.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),_=V.currentWorkgroup,N=V.setCurrentWorkgroup;(0,y.useEffect)((function(){var e,n,i;if(t===m.Njn)s.setFieldValue("showRateBtn",null==L||null===(e=L.serviceSettings)||void 0===e?void 0:e.showRateBtn),s.setFieldValue("autoInviteRate",null==L||null===(n=L.serviceSettings)||void 0===n?void 0:n.autoInviteRate),R(u(null==L||null===(i=L.serviceSettings)||void 0===i?void 0:i.inviteRateTip));else if(t===m.aZD){var o,r,a;s.setFieldValue("showRateBtn",null==_||null===(o=_.serviceSettings)||void 0===o?void 0:o.showRateBtn),s.setFieldValue("autoInviteRate",null==_||null===(r=_.serviceSettings)||void 0===r?void 0:r.autoInviteRate),R(u(null==_||null===(a=_.serviceSettings)||void 0===a?void 0:a.inviteRateTip))}else if(t===m._X4){var l,d,c;s.setFieldValue("showRateBtn",null==Z||null===(l=Z.serviceSettings)||void 0===l?void 0:l.showRateBtn),s.setFieldValue("autoInviteRate",null==Z||null===(d=Z.serviceSettings)||void 0===d?void 0:d.autoInviteRate),R(u(null==Z||null===(c=Z.serviceSettings)||void 0===c?void 0:c.inviteRateTip))}}),[L,_]);var D=function(){var e=a()(o()().mark((function e(i){var s,u,a,l,d,p,f,h,w,S,q,y,b,F,x,U,C,j,M,R,A,P,V,D,O,E,X;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onFinish:",i),t!==m._X4){e.next=11;break}return p=r()(r()({},Z),{},{serviceSettings:r()(r()({},Z.serviceSettings),{},{showRateBtn:i.showRateBtn,autoInviteRate:i.autoInviteRate,inviteRateTip:T,rateMsgCount:i.rateMsgCount,welcomeFaqUids:null==i?void 0:i.welcomeFaqUids,quickFaqUids:null===(s=L.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==Z||null===(u=Z.serviceSettings)||void 0===u||null===(u=u.faqs)||void 0===u?void 0:u.map((function(e){return e.uid})),guessFaqUids:null==Z||null===(a=Z.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),hotFaqUids:null==Z||null===(l=Z.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==Z||null===(d=Z.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))})}),console.log("robotObject:",p),e.next=6,(0,k.$l)(p);case 6:f=e.sent,console.log("updateRobot response:",f),200===f.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),I(f.data)):(c.yw.destroy(),c.yw.error(f.message)),e.next=29;break;case 11:if(t!==m.Njn){e.next=21;break}return U=r()(r()({},L),{},{serviceSettings:r()(r()({},null==L?void 0:L.serviceSettings),{},{showRateBtn:i.showRateBtn,autoInviteRate:i.autoInviteRate,inviteRateTip:T,rateMsgCount:i.rateMsgCount,welcomeFaqUids:null==L||null===(h=L.serviceSettings)||void 0===h||null===(h=h.welcomeFaqs)||void 0===h?void 0:h.map((function(e){return e.uid})),quickFaqUids:null==L||null===(w=L.serviceSettings)||void 0===w||null===(w=w.quickFaqs)||void 0===w?void 0:w.map((function(e){return e.uid})),faqUids:null==L||null===(S=L.serviceSettings)||void 0===S||null===(S=S.faqs)||void 0===S?void 0:S.map((function(e){return e.uid})),guessFaqUids:null==L||null===(q=L.serviceSettings)||void 0===q||null===(q=q.guessFaqs)||void 0===q?void 0:q.map((function(e){return e.uid})),hotFaqUids:null==L||null===(y=L.serviceSettings)||void 0===y||null===(y=y.hotFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),shortcutFaqUids:null==L||null===(b=L.serviceSettings)||void 0===b||null===(b=b.shortcutFaqs)||void 0===b?void 0:b.map((function(e){return e.uid}))}),robotSettings:r()(r()({},L.robotSettings),{},{robotUid:null==L||null===(F=L.robotSettings)||void 0===F||null===(F=F.robot)||void 0===F?void 0:F.uid}),messageLeaveSettings:r()(r()({},L.messageLeaveSettings),{},{worktimeUids:null==L||null===(x=L.messageLeaveSettings)||void 0===x||null===(x=x.worktimes)||void 0===x?void 0:x.map((function(e){return e.uid}))}),autoReplySettings:r()({},L.autoReplySettings)}),console.log("agentObject:",U),e.next=16,(0,v.sE)(U);case 16:C=e.sent,console.log("updateAgent response:",C),200===C.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),W(C.data)):(c.yw.destroy(),c.yw.error(C.message)),e.next=29;break;case 21:if(t!==m.aZD){e.next=29;break}return E=r()(r()({},_),{},{serviceSettings:r()(r()({},_.serviceSettings),{},{showRateBtn:i.showRateBtn,autoInviteRate:i.autoInviteRate,inviteRateTip:T,rateMsgCount:i.rateMsgCount,welcomeFaqUids:null==_||null===(j=_.serviceSettings)||void 0===j||null===(j=j.welcomeFaqs)||void 0===j?void 0:j.map((function(e){return e.uid})),quickFaqUids:null===(M=_.serviceSettings)||void 0===M||null===(M=M.quickFaqs)||void 0===M?void 0:M.map((function(e){return e.uid})),faqUids:null==_||null===(R=_.serviceSettings)||void 0===R||null===(R=R.faqs)||void 0===R?void 0:R.map((function(e){return e.uid})),guessFaqUids:null==_||null===(A=_.serviceSettings)||void 0===A||null===(A=A.guessFaqs)||void 0===A?void 0:A.map((function(e){return e.uid})),hotFaqUids:null===(P=_.serviceSettings)||void 0===P||null===(P=P.hotFaqs)||void 0===P?void 0:P.map((function(e){return e.uid})),shortcutFaqUids:null==_||null===(V=_.serviceSettings)||void 0===V||null===(V=V.shortcutFaqs)||void 0===V?void 0:V.map((function(e){return e.uid}))}),robotSettings:r()(r()({},_.robotSettings),{},{robotUid:null==_||null===(D=_.robotSettings)||void 0===D||null===(D=D.robot)||void 0===D?void 0:D.uid}),messageLeaveSettings:r()(r()({},_.messageLeaveSettings),{},{worktimeUids:null==_||null===(O=_.messageLeaveSettings)||void 0===O||null===(O=O.worktimes)||void 0===O?void 0:O.map((function(e){return e.uid}))}),agentUids:_.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",E),e.next=26,(0,g.W5)(E);case 26:X=e.sent,console.log("updateWorkGroup response:",X),200===X.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),N(X.data)):(c.yw.destroy(),c.yw.error(X.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,U.jsx)(U.Fragment,{children:(0,U.jsxs)(w.A,{form:s,onFinish:D,style:{marginLeft:"20px"},children:[(0,U.jsx)(S.Z,{width:"md",name:"showRateBtn",label:n.formatMessage({id:"rate.show.button"}),tooltip:n.formatMessage({id:"rate.show.button.tooltip"})}),(0,U.jsx)(S.Z,{width:"md",name:"autoInviteRate",label:n.formatMessage({id:"rate.auto.invite.rate"}),tooltip:n.formatMessage({id:"rate.auto.invite.rate.tooltip"})}),(0,U.jsx)(w.A.Item,{name:"inviteRateTip",label:n.formatMessage({id:"rate.auto.invite.rate.tip"}),tooltip:n.formatMessage({id:"rate.auto.invite.rate.tip.tooltip"}),rules:[{required:!0,message:n.formatMessage({id:"rate.auto.invite.rate.tip.required"})}],children:(0,U.jsx)(b.Z,{placeholder:n.formatMessage({id:"rate.auto.invite.rate.tip.placeholder"}),value:T,toolbarKeys:(0,h.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){R(e)}})}),!1]})})}},40836:function(e,t,n){var i=n(90819),o=n.n(i),s=n(89933),r=n.n(s),u=n(73193),a=n.n(u),l=n(45332),d=n.n(l),c=n(86803),v=n(24170),g=n(66916),p=n(72614),f=n(1902),m=n(66310),h=n(95490),w=n(55735),S=n(69169),q=n(48708),y=n(32350),b=n(30921),F=n(44194),k=n(3849),x=n(75365),U=n(11184),C=n(31549);t.Z=function(e){var t=e.type,n=(0,b.useIntl)(),i=S.A.useForm(),s=d()(i,1)[0],u=(0,U.M)(),l=u.config,j=u.updateConfig,M=(0,m.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),T=M.currentRobot,R=M.setCurrentRobot,A=(0,f.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),Z=A.currentAgent,I=A.setCurrentAgent,P=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),L=P.currentWorkgroup,W=P.setCurrentWorkgroup,V=(0,F.useMemo)((function(){return t===w._X4?{chatType:w.xtN,chatSid:T.uid}:t===w.Njn?{chatType:w.scI,chatSid:Z.uid}:t===w.aZD?{chatType:w.vPY,chatSid:L.uid}:{chatType:w.xtN,chatSid:""}}),[t,T,Z,L]),_=V.chatType,N=V.chatSid;(0,F.useEffect)((function(){if(t===w._X4){var e,n,i=null==T||null===(e=T.serviceSettings)||void 0===e?void 0:e.showRightIframe;s.setFieldsValue({showRightIframe:i,rightIframeUrl:null==T||null===(n=T.serviceSettings)||void 0===n?void 0:n.rightIframeUrl}),j(i?a()(a()({},l),{},{chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N}),window:a()(a()({},l.window),{},{width:680})}):a()(a()({},l),{},{chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N}),window:a()(a()({},l.window),{},{width:380})}))}else if(t===w.Njn){var o,r,u=null==Z||null===(o=Z.serviceSettings)||void 0===o?void 0:o.showRightIframe;s.setFieldsValue({showRightIframe:u,rightIframeUrl:null==Z||null===(r=Z.serviceSettings)||void 0===r?void 0:r.rightIframeUrl}),j(u?a()(a()({},l),{},{chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N}),window:a()(a()({},l.window),{},{width:680})}):a()(a()({},l),{},{chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N}),window:a()(a()({},l.window),{},{width:380})}))}else if(t===w.aZD){var d,c,v=null==L||null===(d=L.serviceSettings)||void 0===d?void 0:d.showRightIframe;s.setFieldsValue({showRightIframe:v,rightIframeUrl:null==L||null===(c=L.serviceSettings)||void 0===c?void 0:c.rightIframeUrl}),j(v?a()(a()({},l),{},{chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N}),window:a()(a()({},l.window),{},{width:680})}):a()(a()({},l),{},{chatConfig:a()(a()({},l.chatConfig),{},{t:_,sid:N}),window:a()(a()({},l.window),{},{width:380})}))}}),[T,Z,L,_,N]);var D=function(){var e=r()(o()().mark((function e(i){var s,r,u,l,d,f,m,h,S,q,y,b,F,k,x,U,C,j,M,A,P,V,_,N,D,O,E,X,Y;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleRightSubmit:",i),t!==w._X4){e.next=11;break}return m=a()(a()({},T),{},{serviceSettings:a()(a()({},T.serviceSettings),{},{showRightIframe:i.showRightIframe,rightIframeUrl:i.rightIframeUrl,welcomeFaqUids:null==T||null===(s=T.serviceSettings)||void 0===s||null===(s=s.welcomeFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==T||null===(r=T.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),quickFaqUids:null==T||null===(u=T.serviceSettings)||void 0===u||null===(u=u.quickFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),guessFaqUids:null==T||null===(l=T.serviceSettings)||void 0===l||null===(l=l.guessFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),hotFaqUids:null==T||null===(d=T.serviceSettings)||void 0===d||null===(d=d.hotFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),shortcutFaqUids:null==T||null===(f=T.serviceSettings)||void 0===f||null===(f=f.shortcutFaqs)||void 0===f?void 0:f.map((function(e){return e.uid}))})}),console.log("robotObject:",m),e.next=6,(0,g.$l)(m);case 6:h=e.sent,console.log("updateRobot response:",h),200===h.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),R(h.data)):(c.yw.destroy(),c.yw.error(h.message)),e.next=29;break;case 11:if(t!==w.Njn){e.next=21;break}return C=a()(a()({},Z),{},{serviceSettings:a()(a()({},null==Z?void 0:Z.serviceSettings),{},{showRightIframe:i.showRightIframe,rightIframeUrl:i.rightIframeUrl,welcomeFaqUids:null==Z||null===(S=Z.serviceSettings)||void 0===S||null===(S=S.welcomeFaqs)||void 0===S?void 0:S.map((function(e){return e.uid})),faqUids:null==Z||null===(q=Z.serviceSettings)||void 0===q||null===(q=q.faqs)||void 0===q?void 0:q.map((function(e){return e.uid})),quickFaqUids:null==Z||null===(y=Z.serviceSettings)||void 0===y||null===(y=y.quickFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),guessFaqUids:null==Z||null===(b=Z.serviceSettings)||void 0===b||null===(b=b.guessFaqs)||void 0===b?void 0:b.map((function(e){return e.uid})),hotFaqUids:null==Z||null===(F=Z.serviceSettings)||void 0===F||null===(F=F.hotFaqs)||void 0===F?void 0:F.map((function(e){return e.uid})),shortcutFaqUids:null==Z||null===(k=Z.serviceSettings)||void 0===k||null===(k=k.shortcutFaqs)||void 0===k?void 0:k.map((function(e){return e.uid}))}),robotSettings:a()(a()({},Z.robotSettings),{},{robotUid:null==Z||null===(x=Z.robotSettings)||void 0===x||null===(x=x.robot)||void 0===x?void 0:x.uid}),messageLeaveSettings:a()(a()({},Z.messageLeaveSettings),{},{worktimeUids:null==Z||null===(U=Z.messageLeaveSettings)||void 0===U||null===(U=U.worktimes)||void 0===U?void 0:U.map((function(e){return e.uid}))}),autoReplySettings:a()({},Z.autoReplySettings)}),console.log("agentObject:",C),e.next=16,(0,v.sE)(C);case 16:j=e.sent,console.log("updateAgent response:",j),200===j.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),I(j.data)):(c.yw.destroy(),c.yw.error(j.message)),e.next=29;break;case 21:if(t!==w.aZD){e.next=29;break}return X=a()(a()({},L),{},{serviceSettings:a()(a()({},L.serviceSettings),{},{showRightIframe:i.showRightIframe,rightIframeUrl:i.rightIframeUrl,welcomeFaqUids:null==L||null===(M=L.serviceSettings)||void 0===M||null===(M=M.welcomeFaqs)||void 0===M?void 0:M.map((function(e){return e.uid})),faqUids:null==L||null===(A=L.serviceSettings)||void 0===A||null===(A=A.faqs)||void 0===A?void 0:A.map((function(e){return e.uid})),quickFaqUids:null==L||null===(P=L.serviceSettings)||void 0===P||null===(P=P.quickFaqs)||void 0===P?void 0:P.map((function(e){return e.uid})),guessFaqUids:null==L||null===(V=L.serviceSettings)||void 0===V||null===(V=V.guessFaqs)||void 0===V?void 0:V.map((function(e){return e.uid})),hotFaqUids:null==L||null===(_=L.serviceSettings)||void 0===_||null===(_=_.hotFaqs)||void 0===_?void 0:_.map((function(e){return e.uid})),shortcutFaqUids:null==L||null===(N=L.serviceSettings)||void 0===N||null===(N=N.shortcutFaqs)||void 0===N?void 0:N.map((function(e){return e.uid}))}),robotSettings:a()(a()({},L.robotSettings),{},{robotUid:null==L||null===(D=L.robotSettings)||void 0===D||null===(D=D.robot)||void 0===D?void 0:D.uid}),messageLeaveSettings:a()(a()({},L.messageLeaveSettings),{},{worktimeUids:null==L||null===(O=L.messageLeaveSettings)||void 0===O||null===(O=O.worktimes)||void 0===O?void 0:O.map((function(e){return e.uid}))}),agentUids:null==L||null===(E=L.agents)||void 0===E?void 0:E.map((function(e){return e.uid}))}),console.log("workgroupObject:",X),e.next=26,(0,p.W5)(X);case 26:Y=e.sent,console.log("updateWorkGroup response:",Y),200===Y.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),W(Y.data)):(c.yw.destroy(),c.yw.error(Y.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,C.jsxs)("div",{children:[(0,C.jsxs)(S.A,{form:s,onFinish:D,children:[(0,C.jsx)(q.Z,{width:"md",name:"showRightIframe",label:n.formatMessage({id:"showRightIframe"})}),(0,C.jsx)(y.Z,{width:"md",name:"rightIframeUrl",label:n.formatMessage({id:"rightIframeUrl"})})]}),(0,C.jsxs)(k.Z,{direction:"horizontal",style:{width:"100%",marginTop:10,marginBottom:10},children:[(0,C.jsx)(x.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:n.formatMessage({id:"show.chat.window"})}),(0,C.jsx)(x.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.hideChat()},children:n.formatMessage({id:"hide.chat.window"})})]})]})}},14238:function(e,t,n){var i=n(73193),o=n.n(i),s=n(90819),r=n.n(s),u=n(89933),a=n.n(u),l=n(45332),d=n.n(l),c=n(86803),v=n(24170),g=n(66916),p=n(72614),f=n(76750),m=n(1902),h=n(66310),w=n(95490),S=n(55735),q=n(69169),y=n(85954),b=n(84881),F=n(79907),k=n(30921),x=n(44194),U=n(51990),C=n(65461),j=n(40612),M=n(99885),T=n(31549);t.Z=function(e){var t,n=e.type,i=q.A.useForm(),s=d()(i,1)[0],u=(0,k.useIntl)(),l=(0,f.Z)().translateString,R=(0,x.useState)(!1),A=d()(R,2),Z=A[0],I=A[1],P=(0,j.u)((function(e){return e.currentOrg})),L=(0,x.useState)(),W=d()(L,2),V=W[0],_=W[1],N=(0,h.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),D=N.currentRobot,O=N.setCurrentRobot,E=(0,m.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),X=E.currentAgent,Y=E.setCurrentAgent,B=(0,w.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),$=B.currentWorkgroup,H=B.setCurrentWorkgroup,G=(0,x.useState)(""),Q=d()(G,2),z=Q[0],K=Q[1],J=(0,x.useState)(""),ee=d()(J,2),te=ee[0],ne=ee[1],ie=(0,x.useState)(""),oe=d()(ie,2),se=oe[0],re=oe[1],ue=(0,x.useState)(""),ae=d()(ue,2),le=ae[0],de=ae[1],ce=(0,x.useState)(""),ve=d()(ce,2),ge=ve[0],pe=ve[1],fe=(0,x.useState)(!1),me=d()(fe,2),he=me[0],we=me[1],Se=(0,x.useState)(""),qe=d()(Se,2),ye=qe[0],be=qe[1],Fe=function(){var e=a()(r()().mark((function e(){var t,n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(u.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,orgUid:null==P?void 0:P.uid},e.next=4,(0,M.pf)(t);case 4:n=e.sent,console.log("getAllFaqs response:",t,n),c.yw.destroy(),200===n.code?_(n):c.yw.error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,x.useEffect)((function(){Fe()}),[]);var ke=function(e){var t;if(console.log("setFormValues:",e),K(l(null==e?void 0:e.welcomeTip)),re(l(null==e?void 0:e.topTip)),de(l(null==e?void 0:e.agentCloseTip)),pe(l(null==e?void 0:e.autoCloseTip)),I(null==e?void 0:e.showTopTip),we(null==e?void 0:e.showUnknownAnswer),be(l(null==e?void 0:e.unknownAnswer)),s.setFieldValue("showTopTip",null==e?void 0:e.showTopTip),s.setFieldValue("autoCloseMin",null==e?void 0:e.autoCloseMin),s.setFieldValue("showLogo",null==e?void 0:e.showLogo),s.setFieldValue("showUnknownAnswer",null==e?void 0:e.showUnknownAnswer),s.setFieldValue("welcomeFaqUids",null==e||null===(t=e.welcomeFaqs)||void 0===t?void 0:t.map((function(e){return e.uid}))),n===S._X4);else if(n===S.Njn){var i;ne(l(null==X||null===(i=X.messageLeaveSettings)||void 0===i?void 0:i.messageLeaveTip))}else if(n===S.aZD){var o;ne(l(null==$||null===(o=$.messageLeaveSettings)||void 0===o?void 0:o.messageLeaveTip))}};(0,x.useEffect)((function(){n===S._X4?ke(null==D?void 0:D.serviceSettings):n===S.Njn?(ke(null==X?void 0:X.serviceSettings),s.setFieldValue("maxThreadCount",null==X?void 0:X.maxThreadCount)):n===S.aZD&&ke(null==$?void 0:$.serviceSettings)}),[D,X,$]);var xe=function(){var e=a()(r()().mark((function e(t){var i,s,a,l,d,f,m,h,w,q,y,b,F,k,x,U,C,j,M,T,R,A,I,P,L;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onFinish:",t," showTopTip:",Z),c.yw.loading(u.formatMessage({id:"updating"})),n!==S._X4){e.next=12;break}return f=o()(o()({},D),{},{serviceSettings:o()(o()({},D.serviceSettings),{},{topTip:se,showTopTip:Z,welcomeTip:z,autoCloseTip:ge,autoCloseMin:(null==t?void 0:t.autoCloseMin)||25,showLogo:(null==t?void 0:t.showLogo)||!0,showUnknownAnswer:he,unknownAnswer:ye,welcomeFaqUids:null==t?void 0:t.welcomeFaqUids,quickFaqUids:null===(i=X.serviceSettings)||void 0===i||null===(i=i.quickFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),faqUids:null==D||null===(s=D.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),guessFaqUids:null==D||null===(a=D.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),hotFaqUids:null==D||null===(l=D.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==D||null===(d=D.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))})}),console.log("robotObject:",f),e.next=7,(0,g.$l)(f);case 7:m=e.sent,console.log("updateRobot response:",m),200===m.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),O(m.data)):(c.yw.destroy(),c.yw.error(m.message)),e.next=30;break;case 12:if(n!==S.Njn){e.next=22;break}return x=o()(o()({},X),{},{serviceSettings:o()(o()({},X.serviceSettings),{},{topTip:se,showTopTip:Z,welcomeTip:z,agentCloseTip:le,autoCloseTip:ge,autoCloseMin:(null==t?void 0:t.autoCloseMin)||25,showLogo:(null==t?void 0:t.showLogo)||!0,showUnknownAnswer:he,unknownAnswer:ye,welcomeFaqUids:null==t?void 0:t.welcomeFaqUids,quickFaqUids:null===(h=X.serviceSettings)||void 0===h||null===(h=h.quickFaqs)||void 0===h?void 0:h.map((function(e){return e.uid})),faqUids:null===(w=X.serviceSettings)||void 0===w||null===(w=w.faqs)||void 0===w?void 0:w.map((function(e){return e.uid})),guessFaqUids:null==X||null===(q=X.serviceSettings)||void 0===q||null===(q=q.guessFaqs)||void 0===q?void 0:q.map((function(e){return e.uid})),hotFaqUids:null==X||null===(y=X.serviceSettings)||void 0===y||null===(y=y.hotFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),shortcutFaqUids:null==X||null===(b=X.serviceSettings)||void 0===b||null===(b=b.shortcutFaqs)||void 0===b?void 0:b.map((function(e){return e.uid}))}),messageLeaveSettings:o()(o()({},X.messageLeaveSettings),{},{messageLeaveTip:te,worktimeUids:null===(F=X.messageLeaveSettings)||void 0===F||null===(F=F.worktimes)||void 0===F?void 0:F.map((function(e){return e.uid}))}),robotSettings:o()(o()({},X.robotSettings),{},{robotUid:null===(k=X.robotSettings)||void 0===k||null===(k=k.robot)||void 0===k?void 0:k.uid}),maxThreadCount:(null==t?void 0:t.maxThreadCount)||10}),console.log("agentObject:",x),e.next=17,(0,v.sE)(x);case 17:U=e.sent,console.log("updateAgent response:",U),200===U.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),Y(U.data)):(c.yw.destroy(),c.yw.error(U.message)),e.next=30;break;case 22:if(n!==S.aZD){e.next=30;break}return P=o()(o()({},$),{},{serviceSettings:o()(o()({},$.serviceSettings),{},{topTip:se,showTopTip:Z,welcomeTip:z,agentCloseTip:le,autoCloseTip:ge,autoCloseMin:(null==t?void 0:t.autoCloseMin)||25,showLogo:(null==t?void 0:t.showLogo)||!0,showUnknownAnswer:he,unknownAnswer:ye,welcomeFaqUids:null==t?void 0:t.welcomeFaqUids,quickFaqUids:null===(C=$.serviceSettings)||void 0===C||null===(C=C.quickFaqs)||void 0===C?void 0:C.map((function(e){return e.uid})),faqUids:null===(j=$.serviceSettings)||void 0===j||null===(j=j.faqs)||void 0===j?void 0:j.map((function(e){return e.uid})),guessFaqUids:null==$||null===(M=$.serviceSettings)||void 0===M||null===(M=M.guessFaqs)||void 0===M?void 0:M.map((function(e){return e.uid})),hotFaqUids:null==$||null===(T=$.serviceSettings)||void 0===T||null===(T=T.hotFaqs)||void 0===T?void 0:T.map((function(e){return e.uid})),shortcutFaqUids:null==$||null===(R=$.serviceSettings)||void 0===R||null===(R=R.shortcutFaqs)||void 0===R?void 0:R.map((function(e){return e.uid}))}),messageLeaveSettings:o()(o()({},$.messageLeaveSettings),{},{messageLeaveTip:te,worktimeUids:null===(A=$.messageLeaveSettings)||void 0===A||null===(A=A.worktimes)||void 0===A?void 0:A.map((function(e){return e.uid}))}),robotSettings:o()(o()({},$.robotSettings),{},{robotUid:null===(I=$.robotSettings)||void 0===I||null===(I=I.robot)||void 0===I?void 0:I.uid}),agentUids:$.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",P),e.next=27,(0,p.W5)(P);case 27:L=e.sent,console.log("updateWorkGroup response:",L),200===L.code?(c.yw.destroy(),c.yw.success(u.formatMessage({id:"update.success"})),H(L.data)):(c.yw.destroy(),c.yw.error(L.message));case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,T.jsxs)(q.A,{form:s,onFinish:xe,style:{marginLeft:"20px"},children:[(0,T.jsx)(y.Z,{name:"showTopTip",width:"md",label:u.formatMessage({id:"agent.settings.show.top.tip"}),fieldProps:{onChange:function(e){var t,i;if(console.log("checked = ".concat(e.target.checked,", showTopTip:").concat(null==X||null===(t=X.serviceSettings)||void 0===t?void 0:t.showTopTip)),I(e.target.checked),e.target.checked)if(n===S._X4)re(l(null==D||null===(i=D.serviceSettings)||void 0===i?void 0:i.topTip));else if(n===S.Njn){var o;re(l(null==X||null===(o=X.serviceSettings)||void 0===o?void 0:o.topTip))}else if(n===S.aZD){var s;re(l(null==$||null===(s=$.serviceSettings)||void 0===s?void 0:s.topTip))}}}}),Z&&(0,T.jsx)(q.A.Item,{name:"topTip",label:u.formatMessage({id:"agent.settings.top.tip"}),rules:[{required:!0,message:u.formatMessage({id:"agent.settings.top.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:u.formatMessage({id:"agent.settings.top.tip.placeholder"}),value:se,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){re(e)}})}),(0,T.jsx)(q.A.Item,{name:"welcomeTip",label:u.formatMessage({id:"agent.settings.welcome.tip"}),tooltip:u.formatMessage({id:"agent.settings.welcome.tip"}),rules:[{required:!0,message:u.formatMessage({id:"agent.settings.welcome.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:u.formatMessage({id:"agent.settings.welcome.tip.placeholder"}),value:z,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){K(e)}})}),(0,T.jsx)(b.Z,{name:"welcomeFaqUids",width:"md",label:u.formatMessage({id:"menu.kbase.faq.welcome"}),options:null==V||null===(t=V.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return{label:l(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:(0,T.jsx)(k.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}}),n!=S._X4&&(0,T.jsx)(q.A.Item,{name:"messageLeaveTip",label:u.formatMessage({id:"agent.settings.leave.msg"}),rules:[{required:!0,message:u.formatMessage({id:"agent.settings.leave.msg.required"})}],children:(0,T.jsx)(U.Z,{placeholder:u.formatMessage({id:"agent.settings.leave.msg.placeholder"}),value:te,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){ne(e)}})}),(0,T.jsx)(F.Z,{width:"md",name:"autoCloseMin",label:u.formatMessage({id:"agent.settings.auto.close.time"}),tooltip:u.formatMessage({id:"agent.settings.auto.close.time.tooltip"}),min:1}),n!=S._X4&&(0,T.jsx)(q.A.Item,{name:"agentCloseTip",label:u.formatMessage({id:"agent.settings.agent.close.tip"}),tooltip:u.formatMessage({id:"agent.settings.agent.close.tip.tooltip"}),rules:[{required:!0,message:u.formatMessage({id:"agent.settings.agent.close.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:u.formatMessage({id:"agent.settings.agent.close.tip.placeholder"}),value:le,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){de(e)}})}),(0,T.jsx)(q.A.Item,{name:"autoCloseTip",label:u.formatMessage({id:"agent.settings.auto.close.tip"}),tooltip:u.formatMessage({id:"agent.settings.auto.close.tip.tooltip"}),rules:[{required:!0,message:u.formatMessage({id:"agent.settings.auto.close.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:u.formatMessage({id:"agent.settings.auto.close.tip.placeholder"}),value:ge,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){pe(e)}})}),n===S._X4&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(y.Z,{name:"showUnknownAnswer",width:"md",label:u.formatMessage({id:"agent.settings.show.unknown.answer",defaultMessage:"启用未知问题固定回复"}),fieldProps:{onChange:function(e){var t;if(console.log("checked = ".concat(e.target.checked)),we(e.target.checked),e.target.checked)if(n===S._X4)be(l(null==D||null===(t=D.serviceSettings)||void 0===t?void 0:t.unknownAnswer));else if(n===S.Njn){var i;be(l(null==X||null===(i=X.serviceSettings)||void 0===i?void 0:i.unknownAnswer))}else if(n===S.aZD){var o;be(l(null==$||null===(o=$.serviceSettings)||void 0===o?void 0:o.unknownAnswer))}}}}),he&&(0,T.jsx)(q.A.Item,{name:"unknownAnswer",label:u.formatMessage({id:"agent.settings.unknown.answer",defaultMessage:"未知问题固定回复"}),rules:[{required:!0,message:u.formatMessage({id:"agent.settings.unknown.answer.required",defaultMessage:"请输入未知问题固定回复"})}],children:(0,T.jsx)(U.Z,{placeholder:u.formatMessage({id:"agent.settings.unknown.answer.placeholder",defaultMessage:"请输入未知问题固定回复"}),value:ye,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){be(e)}})})]}),n===S.Njn&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("p",{children:u.formatMessage({id:"agent.settings.max.thread.tip1"})}),(0,T.jsx)("p",{children:u.formatMessage({id:"agent.settings.max.thread.tip2"})}),(0,T.jsx)("p",{children:u.formatMessage({id:"agent.settings.max.thread.tip3"})}),(0,T.jsx)(F.Z,{width:"md",name:"maxThreadCount",label:u.formatMessage({id:"agent.settings.max.thread"}),min:0})]}),(0,T.jsx)(y.Z,{name:"showLogo",width:"md",label:u.formatMessage({id:"agent.settings.show.logo"}),tooltip:u.formatMessage({id:"agent.settings.show.logo.tooltip"}),fieldProps:{onChange:function(e){console.log("onShowLogoChange = ".concat(e.target.checked))}},disabled:!0})]})}},98473:function(e,t,n){var i=n(76711),o=n.n(i),s=n(90819),r=n.n(s),u=n(73193),a=n.n(u),l=n(89933),d=n.n(l),c=n(45332),v=n.n(c),g=n(86803),p=n(24170),f=n(66916),m=n(72614),h=n(1902),w=n(66310),S=n(95490),q=n(55735),y=n(69169),b=n(48708),F=n(32350),k=n(79907),x=n(30921),U=n(44194),C=n(32327),j=n(71738),M=n(44781),T=n(16309),R=n(78819),A=n(52288),Z=(n(29266),n(3849),n(75365),n(62673)),I=n(38775),P=n(53530),L=(n(59304),n(54881),n(31549)),W=(C.Z.Text,j.Z.Panel,M.Z.Option),V="no_response",_="keyword_match",N="visit_count",D="page_stay",O="time_range",E=[{label:"无响应触发",value:V}];t.Z=function(e){var t=e.type,n=(0,x.useIntl)(),i=y.A.useForm(),s=v()(i,1)[0],u=(0,U.useState)([]),l=v()(u,2),c=l[0],C=l[1],j=(0,U.useState)(!1),X=v()(j,2),Y=X[0],B=X[1],$=(0,U.useState)(null),H=v()($,2),G=(H[0],H[1],T.Z.useForm()),Q=v()(G,1)[0],z=(0,U.useState)(null),K=v()(z,2),J=K[0],ee=(K[1],(0,w.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}}))),te=ee.currentRobot,ne=ee.setCurrentRobot,ie=(0,h.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),oe=ie.currentAgent,se=ie.setCurrentAgent,re=(0,S.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),ue=re.currentWorkgroup,ae=re.setCurrentWorkgroup,le=(0,U.useMemo)((function(){return t===q._X4?{chatType:q.xtN,chatSid:te.uid}:t===q.Njn?{chatType:q.scI,chatSid:oe.uid}:t===q.aZD?{chatType:q.vPY,chatSid:ue.uid}:{chatType:q.xtN,chatSid:""}}),[t,te,oe,ue]),de=le.chatType,ce=le.chatSid;(0,U.useEffect)((function(){if(t===q._X4){var e,n,i,o,r,u,a,l,d,c,v,g=null!=te&&null!==(e=te.serviceSettings)&&void 0!==e&&e.triggerConditions&&(null===(n=JSON.parse(null==te||null===(i=te.serviceSettings)||void 0===i?void 0:i.triggerConditions))||void 0===n?void 0:n.conditions)||[];s.setFieldsValue({autoPopup:null==te||null===(o=te.serviceSettings)||void 0===o?void 0:o.autoPopup,showInvite:null==te||null===(r=te.inviteSettings)||void 0===r?void 0:r.show,inviteText:null==te||null===(u=te.inviteSettings)||void 0===u?void 0:u.text,enableProactiveTrigger:null==te||null===(a=te.serviceSettings)||void 0===a?void 0:a.enableProactiveTrigger,noResponseTimeout:(null==te||null===(l=te.serviceSettings)||void 0===l?void 0:l.noResponseTimeout)||300,proactiveMessage:null==te||null===(d=te.serviceSettings)||void 0===d?void 0:d.proactiveMessage,maxProactiveCount:(null==te||null===(c=te.serviceSettings)||void 0===c?void 0:c.maxProactiveCount)||3,proactiveInterval:(null==te||null===(v=te.serviceSettings)||void 0===v?void 0:v.proactiveInterval)||600}),C(g)}else if(t===q.Njn){var p,f,m,h,w,S,y,b,F,k,x,U=null!=oe&&null!==(p=oe.serviceSettings)&&void 0!==p&&p.triggerConditions&&(null===(f=JSON.parse(null==oe||null===(m=oe.serviceSettings)||void 0===m?void 0:m.triggerConditions))||void 0===f?void 0:f.conditions)||[];s.setFieldsValue({autoPopup:null==oe||null===(h=oe.serviceSettings)||void 0===h?void 0:h.autoPopup,showInvite:null==oe||null===(w=oe.inviteSettings)||void 0===w?void 0:w.show,inviteText:null==oe||null===(S=oe.inviteSettings)||void 0===S?void 0:S.text,enableProactiveTrigger:null==oe||null===(y=oe.serviceSettings)||void 0===y?void 0:y.enableProactiveTrigger,noResponseTimeout:(null==oe||null===(b=oe.serviceSettings)||void 0===b?void 0:b.noResponseTimeout)||300,proactiveMessage:null==oe||null===(F=oe.serviceSettings)||void 0===F?void 0:F.proactiveMessage,maxProactiveCount:(null==oe||null===(k=oe.serviceSettings)||void 0===k?void 0:k.maxProactiveCount)||3,proactiveInterval:(null==oe||null===(x=oe.serviceSettings)||void 0===x?void 0:x.proactiveInterval)||600}),C(U)}else if(t===q.aZD){var j,M,T,R,A,Z,I,P,L,W,V,_=null!=ue&&null!==(j=ue.serviceSettings)&&void 0!==j&&j.triggerConditions&&(null===(M=JSON.parse(null==ue||null===(T=ue.serviceSettings)||void 0===T?void 0:T.triggerConditions))||void 0===M?void 0:M.conditions)||[];s.setFieldsValue({autoPopup:null==ue||null===(R=ue.serviceSettings)||void 0===R?void 0:R.autoPopup,showInvite:null==ue||null===(A=ue.inviteSettings)||void 0===A?void 0:A.show,inviteText:null==ue||null===(Z=ue.inviteSettings)||void 0===Z?void 0:Z.text,enableProactiveTrigger:null==ue||null===(I=ue.serviceSettings)||void 0===I?void 0:I.enableProactiveTrigger,noResponseTimeout:(null==ue||null===(P=ue.serviceSettings)||void 0===P?void 0:P.noResponseTimeout)||300,proactiveMessage:null==ue||null===(L=ue.serviceSettings)||void 0===L?void 0:L.proactiveMessage,maxProactiveCount:(null==ue||null===(W=ue.serviceSettings)||void 0===W?void 0:W.maxProactiveCount)||3,proactiveInterval:(null==ue||null===(V=ue.serviceSettings)||void 0===V?void 0:V.proactiveInterval)||600}),C(_)}}),[te,oe,ue,de,ce]);var ve=function(){var e=d()(r()().mark((function e(i){var o,s,u,l,d,v,h,w,S,y,b,F,k,x,U,C,j,M,T,R,A,Z,I,P,L,W,V,_,N;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handlePreFormSubmit:",i),o=JSON.stringify({conditions:c}),t!==q._X4){e.next=12;break}return w=a()(a()({},te),{},{serviceSettings:a()(a()({},te.serviceSettings),{},{autoPopup:i.autoPopup,enableProactiveTrigger:i.enableProactiveTrigger,noResponseTimeout:i.noResponseTimeout,proactiveMessage:i.proactiveMessage,maxProactiveCount:i.maxProactiveCount,proactiveInterval:i.proactiveInterval,triggerConditions:o,welcomeFaqUids:null==te||null===(s=te.serviceSettings)||void 0===s||null===(s=s.welcomeFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==te||null===(u=te.serviceSettings)||void 0===u||null===(u=u.faqs)||void 0===u?void 0:u.map((function(e){return e.uid})),quickFaqUids:null==te||null===(l=te.serviceSettings)||void 0===l||null===(l=l.quickFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),guessFaqUids:null==te||null===(d=te.serviceSettings)||void 0===d||null===(d=d.guessFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),hotFaqUids:null==te||null===(v=te.serviceSettings)||void 0===v||null===(v=v.hotFaqs)||void 0===v?void 0:v.map((function(e){return e.uid})),shortcutFaqUids:null==te||null===(h=te.serviceSettings)||void 0===h||null===(h=h.shortcutFaqs)||void 0===h?void 0:h.map((function(e){return e.uid}))}),inviteSettings:a()(a()({},te.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("robotObject:",w),e.next=7,(0,f.$l)(w);case 7:S=e.sent,console.log("updateRobot response:",S),200===S.code?(g.yw.destroy(),g.yw.success(n.formatMessage({id:"update.success"})),ne(S.data)):(g.yw.destroy(),g.yw.error(S.message)),e.next=30;break;case 12:if(t!==q.Njn){e.next=22;break}return M=a()(a()({},oe),{},{serviceSettings:a()(a()({},null==oe?void 0:oe.serviceSettings),{},{autoPopup:i.autoPopup,enableProactiveTrigger:i.enableProactiveTrigger,noResponseTimeout:i.noResponseTimeout,proactiveMessage:i.proactiveMessage,maxProactiveCount:i.maxProactiveCount,proactiveInterval:i.proactiveInterval,triggerConditions:o,welcomeFaqUids:null==oe||null===(y=oe.serviceSettings)||void 0===y||null===(y=y.welcomeFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),faqUids:null==oe||null===(b=oe.serviceSettings)||void 0===b||null===(b=b.faqs)||void 0===b?void 0:b.map((function(e){return e.uid})),quickFaqUids:null==oe||null===(F=oe.serviceSettings)||void 0===F||null===(F=F.quickFaqs)||void 0===F?void 0:F.map((function(e){return e.uid})),guessFaqUids:null==oe||null===(k=oe.serviceSettings)||void 0===k||null===(k=k.guessFaqs)||void 0===k?void 0:k.map((function(e){return e.uid})),hotFaqUids:null==oe||null===(x=oe.serviceSettings)||void 0===x||null===(x=x.hotFaqs)||void 0===x?void 0:x.map((function(e){return e.uid})),shortcutFaqUids:null==oe||null===(U=oe.serviceSettings)||void 0===U||null===(U=U.shortcutFaqs)||void 0===U?void 0:U.map((function(e){return e.uid}))}),robotSettings:a()(a()({},oe.robotSettings),{},{robotUid:null==oe||null===(C=oe.robotSettings)||void 0===C||null===(C=C.robot)||void 0===C?void 0:C.uid}),messageLeaveSettings:a()(a()({},oe.messageLeaveSettings),{},{worktimeUids:null==oe||null===(j=oe.messageLeaveSettings)||void 0===j||null===(j=j.worktimes)||void 0===j?void 0:j.map((function(e){return e.uid}))}),autoReplySettings:a()({},oe.autoReplySettings),inviteSettings:a()(a()({},oe.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("agentObject:",M),e.next=17,(0,p.sE)(M);case 17:T=e.sent,console.log("updateAgent response:",T),200===T.code?(g.yw.destroy(),g.yw.success(n.formatMessage({id:"update.success"})),se(T.data)):(g.yw.destroy(),g.yw.error(T.message)),e.next=30;break;case 22:if(t!==q.aZD){e.next=30;break}return _=a()(a()({},ue),{},{serviceSettings:a()(a()({},ue.serviceSettings),{},{autoPopup:i.autoPopup,enableProactiveTrigger:i.enableProactiveTrigger,noResponseTimeout:i.noResponseTimeout,proactiveMessage:i.proactiveMessage,maxProactiveCount:i.maxProactiveCount,proactiveInterval:i.proactiveInterval,triggerConditions:o,welcomeFaqUids:null==ue||null===(R=ue.serviceSettings)||void 0===R||null===(R=R.welcomeFaqs)||void 0===R?void 0:R.map((function(e){return e.uid})),faqUids:null==ue||null===(A=ue.serviceSettings)||void 0===A||null===(A=A.faqs)||void 0===A?void 0:A.map((function(e){return e.uid})),quickFaqUids:null===(Z=ue.serviceSettings)||void 0===Z||null===(Z=Z.quickFaqs)||void 0===Z?void 0:Z.map((function(e){return e.uid})),guessFaqUids:null==ue||null===(I=ue.serviceSettings)||void 0===I||null===(I=I.guessFaqs)||void 0===I?void 0:I.map((function(e){return e.uid})),hotFaqUids:null==ue||null===(P=ue.serviceSettings)||void 0===P||null===(P=P.hotFaqs)||void 0===P?void 0:P.map((function(e){return e.uid})),shortcutFaqUids:null==ue||null===(L=ue.serviceSettings)||void 0===L||null===(L=L.shortcutFaqs)||void 0===L?void 0:L.map((function(e){return e.uid}))}),robotSettings:a()(a()({},ue.robotSettings),{},{robotUid:null==ue||null===(W=ue.robotSettings)||void 0===W||null===(W=W.robot)||void 0===W?void 0:W.uid}),messageLeaveSettings:a()(a()({},ue.messageLeaveSettings),{},{worktimeUids:null==ue||null===(V=ue.messageLeaveSettings)||void 0===V||null===(V=V.worktimes)||void 0===V?void 0:V.map((function(e){return e.uid}))}),inviteSettings:a()(a()({},ue.inviteSettings),{},{show:i.showInvite,text:i.inviteText}),agentUids:ue.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",_),e.next=27,(0,m.W5)(_);case 27:N=e.sent,console.log("updateWorkGroup response:",N),200===N.code?(g.yw.destroy(),g.yw.success(n.formatMessage({id:"update.success"})),ae(N.data)):(g.yw.destroy(),g.yw.error(N.message));case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,L.jsxs)("div",{children:[(0,L.jsxs)(y.A,{form:s,onFinish:ve,children:[(0,L.jsxs)(Z.Z,{title:"主动触发设置",children:[(0,L.jsx)(b.Z,{width:"md",name:"enableProactiveTrigger",label:"启用主动触发"}),(0,L.jsx)(y.A.Group,{children:(0,L.jsx)(F.Z,{width:"md",name:"proactiveMessage",label:"主动发送的消息内容",placeholder:"例如：您好，看起来您有一段时间没有互动了。请问还需要帮助吗？"})}),(0,L.jsx)(y.A.Group,{children:(0,L.jsx)(k.Z,{width:"xs",name:"noResponseTimeout",label:"无响应超时时间(秒)",min:1,fieldProps:{addonAfter:"秒"}})})]}),(0,L.jsx)(I.Z,{})]}),(0,L.jsx)(P.Z,{title:null!==J?"编辑触发条件":"添加触发条件",open:Y,onOk:function(){Q.validateFields().then((function(e){var t=e.keywords;t&&"string"==typeof t&&(t=t.split(",").map((function(e){return e.trim()})).filter((function(e){return e})));var n={type:e.type,message:e.message,timeout:e.type===V||e.type===D?e.timeout:void 0,keywords:e.type===_?t:void 0,threshold:e.type===N?e.threshold:void 0,start:e.type===O?e.start:void 0,end:e.type===O?e.end:void 0};if(null!==J){var i=o()(c);i[J]=n,C(i)}else C([].concat(o()(c),[n]));B(!1),Q.resetFields()}))},onCancel:function(){return B(!1)},width:600,children:(0,L.jsxs)(T.Z,{form:Q,layout:"vertical",initialValues:{type:V,timeout:300,message:"您好，需要帮助吗？"},children:[(0,L.jsx)(T.Z.Item,{name:"type",label:"触发类型",rules:[{required:!0,message:"请选择触发类型"}],children:(0,L.jsx)(M.Z,{children:E.map((function(e){return(0,L.jsx)(W,{value:e.value,children:e.label},e.value)}))})}),function(){switch(Q.getFieldValue("type")){case V:return(0,L.jsx)(T.Z.Item,{name:"timeout",label:"无响应超时时间(秒)",rules:[{required:!0,message:"请输入超时时间"}],children:(0,L.jsx)(R.Z,{min:1})});case _:return(0,L.jsx)(T.Z.Item,{name:"keywords",label:"关键词列表(逗号分隔)",rules:[{required:!0,message:"请输入关键词"}],children:(0,L.jsx)(A.Z,{placeholder:"例如: 价格, 费用, 多少钱"})});case N:return(0,L.jsx)(T.Z.Item,{name:"threshold",label:"访问次数阈值",rules:[{required:!0,message:"请输入访问次数"}],children:(0,L.jsx)(R.Z,{min:1})});case D:return(0,L.jsx)(T.Z.Item,{name:"timeout",label:"页面停留时间(秒)",rules:[{required:!0,message:"请输入停留时间"}],children:(0,L.jsx)(R.Z,{min:1})});case O:return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(T.Z.Item,{name:"start",label:"开始时间",rules:[{required:!0,message:"请输入开始时间"}],children:(0,L.jsx)(A.Z,{placeholder:"格式: HH:mm, 例如: 09:00"})}),(0,L.jsx)(T.Z.Item,{name:"end",label:"结束时间",rules:[{required:!0,message:"请输入结束时间"}],children:(0,L.jsx)(A.Z,{placeholder:"格式: HH:mm, 例如: 18:00"})})]});default:return null}}(),(0,L.jsx)(T.Z.Item,{name:"message",label:"触发消息",rules:[{required:!0,message:"请输入触发后发送的消息"}],children:(0,L.jsx)(A.Z.TextArea,{rows:3,placeholder:"触发条件满足后发送给用户的消息"})})]})})]})}},51990:function(e,t,n){var i=n(73193),o=n.n(i),s=n(84176),r=n.n(s),u=n(86803),a=n(23864),l=n(44521),d=n(55735),c=n(30921),v=n(83905),g=(n(26286),n(28977)),p=n.n(g),f=n(44194),m=n(31549),h=["placeholder","defaultValue","value","style","toolbarKeys","onChange","options"];t.Z=function(e){var t=e.placeholder,n=e.defaultValue,i=e.value,s=e.style,g=e.toolbarKeys,w=e.onChange,S=(e.options,r()(e,h)),q=((0,c.useIntl)(),(0,a.Z)().isDarkMode),y=(0,f.useRef)(null),b=(0,f.useRef)(null);return(0,f.useEffect)((function(){if(y.current){if(!b.current){var e=new v.cW({element:y.current,theme:q?"dark":"light",placeholder:t,content:n,toolbarKeys:g,image:{uploadUrl:(0,l.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(d.LA8)},uploader:function(e,t,n,i){console.log("uploader:",e,t,n,i);var s=p()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,r=new FormData;return r.append("file",e),r.append("file_name",s),r.append("file_type",e.type),r.append("is_avatar","false"),r.append("kb_type",d.bE7),r.append("category_uid",""),r.append("kb_uid",""),r.append("client",d.bVn),new Promise((function(e,i){fetch(t,{method:"POST",headers:o()({Accept:"application/json"},n),body:r}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){u.yw.destroy(),u.yw.success("".concat(s," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,alt:s}};e(n)}else u.yw.destroy(),u.yw.error("".concat(s," 上传失败"))})).catch((function(e){i(e)}))}))}},video:{uploadUrl:(0,l.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(d.LA8)},uploader:function(e,t,n,i){console.log("uploader:",e,t,n,i);var s=p()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,r=new FormData;return r.append("file",e),r.append("file_name",s),r.append("file_type",e.type),r.append("is_avatar","false"),r.append("kb_type",d.bE7),r.append("category_uid",""),r.append("kb_uid",""),r.append("client",d.bVn),new Promise((function(e,i){fetch(t,{method:"POST",headers:o()({Accept:"application/json"},n),body:r}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){u.yw.destroy(),u.yw.success("".concat(s," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,poster:"https://www.weiyuai.cn/avatars/video_poster.png"}};e(n)}else u.yw.destroy(),u.yw.error("".concat(s," 上传失败"))})).catch((function(e){i(e)}))}))}},attachment:{uploadUrl:(0,l.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(d.LA8)},uploader:function(e,t,n,i){console.log("uploader:",e,t,n,i);var s=p()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,r=new FormData;return r.append("file",e),r.append("file_name",s),r.append("file_type",e.type),r.append("is_avatar","false"),r.append("kb_type",d.bE7),r.append("category_uid",""),r.append("kb_uid",""),r.append("client",d.bVn),new Promise((function(e,i){fetch(t,{method:"POST",headers:o()({Accept:"application/json"},n),body:r}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){u.yw.destroy(),u.yw.success("".concat(s," 上传成功"));var n={errorCode:0,data:{href:t.data.fileUrl,fileName:s}};e(n)}else u.yw.destroy(),u.yw.error("".concat(s," 上传失败"))})).catch((function(e){i(e)}))}))}},onChange:function(e){"function"==typeof w&&w(e.getHtml(),e.getMarkdown())}});b.current=e}return function(){b.current&&(b.current.destroy(),b.current=null)}}}),[]),(0,f.useEffect)((function(){b.current&&i!==b.current.getHtml()&&b.current.setContent(i||"")}),[i]),(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",o()(o()({ref:y},S),{},{style:o()({height:"100%"},s)}))})}},55930:function(e,t,n){n(44194),n(30921),n(53038),n(76432),n(29897),n(6897);var i=n(75574);n(79686),n(31549),i.Z.Sider,i.Z.Content},82211:function(e,t,n){n(44194);var i=n(8247),o=n(45178),s=n(5724),r=n(54518),u=n(7785),a=n(42909),l=n(53038),d=n(81360),c=n(99980),v=n(66329),g=n(91723),p=n(31549);t.Z=function(e){var t=e.type,n=[{key:"web",label:"Web",children:(0,p.jsx)(g.Z,{type:t})},{key:"react",label:"React",children:(0,p.jsx)(a.Z,{type:t})},{key:"vue",label:"Vue",children:(0,p.jsx)(v.Z,{type:t})},{key:"svelte",label:"Svelte",children:(0,p.jsx)(d.Z,{type:t})},{key:"vanilla",label:"Vanilla",children:(0,p.jsx)(c.Z,{type:t})},{key:"ios",label:"iOS",children:(0,p.jsx)(o.Z,{type:t})},{key:"android",label:"Android",children:(0,p.jsx)(u.Z,{type:t})},{key:"uniapp",label:"Uniapp",children:(0,p.jsx)(s.Z,{type:t})},{key:"flutter",label:"Flutter",children:(0,p.jsx)(r.Z,{type:t})}];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.Z,{type:t}),(0,p.jsx)(i.Z,{tabPosition:"left",items:n})]})}},73170:function(e,t,n){n(44194),n(30921),n(53038),n(44574),n(10354),n(51103),n(75262),n(62476),n(15025),n(79686),n(31549)},9389:function(e,t,n){n(44194);var i=n(30921),o=(n(11452),n(53038),n(36378),n(53300),n(21325),n(79176),n(13161),n(90819),n(73193),n(84176),n(89933),n(45332),n(40612),n(69842),n(55735),n(31549));i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,n(63289),n(40803),i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage},53038:function(e,t,n){var i=n(30921),o=n(31549);t.Z=function(e){e.type,(0,i.useIntl)();return(0,o.jsx)(o.Fragment,{})}},6631:function(e,t,n){n.d(t,{G:function(){return v}});var i=n(73193),o=n.n(i),s=(n(44194),n(30348)),r=n(55735),u=n(28977),a=n.n(u),l=n(86803),d=n(44521),c=n(31549),v=function(e){var t=e.children,n=e.onSuccess,i=e.onError,u={file:null,file_name:"test.png",file_type:"image/png",is_avatar:"true",kb_type:r.IrL,category_uid:"",kb_uid:"",client:r.bVn},v={name:"file",accept:"image/*",action:(0,d.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(r.LA8)},data:u,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var t=a()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;u.file=e,u.file_name=t,u.file_type=e.type,console.log("beforeUpload",u)},onChange:function(e){if("uploading"!==e.file.status&&console.log("not uploading:",e.file),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data.fileUrl;n(t),l.yw.success("".concat(e.file.name," 上传成功"))}else i(e.file),l.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(l.yw.error("".concat(e.file.name," 上传失败")),i(e.file))}};return(0,c.jsx)(s.Z,o()(o()({},v),{},{children:t}))}}}]);