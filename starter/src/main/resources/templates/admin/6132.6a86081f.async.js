"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6132],{78416:function(e,n,r){r.d(n,{HH:function(){return h},T:function(){return p},fx:function(){return v},mK:function(){return d}});var t=r(90819),o=r.n(t),i=r(73193),a=r.n(i),s=r(89933),l=r.n(s),u=r(77667),c=r(7206);function d(e){return f.apply(this,arguments)}function f(){return(f=l()(o()().mark((function e(n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/query/org",{method:"GET",params:a()(a()({},n),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=l()(o()().mark((function e(n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/create",{method:"POST",data:a()(a()({},n),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return(g=l()(o()().mark((function e(n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/update",{method:"POST",data:a()(a()({},n),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return(y=l()(o()().mark((function e(n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/delete",{method:"POST",data:a()(a()({},n),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},83629:function(e,n,r){r.d(n,{Z:function(){return O}});var t=r(90819),o=r.n(t),i=r(89933),a=r.n(i),s=r(45332),l=r.n(s),u=r(44194),c=r(78416),d=r(89756),f=r(74145),p=r(1780),m=r(7206),v=r(83730),g=r(80093),h=r(12265),y=r(90136),x=r(21276),w=r(40431),k=r(77667),P=r(50484),b=r(31816),j=r(17960),L=r(5728),M=r(8091),S=r(43688),Z=r(47807),C=r(31549),E=function(e){var n=e.open,r=e.isEdit,t=e.llmProvider,i=e.level,s=e.onCancel,f=e.onSubmit,p=Z.Z.useForm(),m=l()(p,1)[0],g=(0,w.u)((function(e){return e.currentOrg})),h=(0,u.useState)([]),y=l()(h,2),x=y[0],P=y[1],b=(0,u.useState)([]),j=l()(b,2),E=j[0],O=j[1],U=(0,u.useState)(),q=l()(U,2),K=q[0],R=q[1],T=function(){var e=a()(o()().mark((function e(){var n,r,t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("requestLlmProviders"),n={pageNumber:0,pageSize:50,status:"",level:k.Hxq},e.next=4,(0,c.mK)(n);case 4:r=e.sent,console.log("queryLlmProvidersByOrg: ",r),200===r.code?P(null==r||null===(t=r.data)||void 0===t?void 0:t.content):d.yw.error(r.message);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){var e=[];x.forEach((function(n){e.push({label:n.nickname,value:n.name,disabled:n.status!==k.KY})})),O(e)}),[x]),(0,u.useEffect)((function(){i===k.K78&&T()}),[]),(0,u.useEffect)((function(){r?(R(t),m.setFieldsValue({name:null==t?void 0:t.name,nickname:null==t?void 0:t.nickname,apiUrl:null==t?void 0:t.apiUrl,apiKey:null==t?void 0:t.apiKey})):m.resetFields()}),[r,t]);return(0,C.jsx)("div",{children:(0,C.jsx)(v.Z,{title:"添加大模型提供商",open:n,forceRender:!0,onOk:function(){m.validateFields().then(function(){var e=a()(o()().mark((function e(n){var i;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={uid:r?null==t?void 0:t.uid:"",name:null==K?void 0:K.name,nickname:null==n?void 0:n.nickname,logo:null==K?void 0:K.logo,description:null==K?void 0:K.description,apiUrl:null==n?void 0:n.apiUrl,apiKey:null==n?void 0:n.apiKey,webUrl:null==K?void 0:K.webUrl,status:k.KY,level:k.K78,orgUid:null==g?void 0:g.uid},console.log("handleSaveLlmProvider:",n,i),f(i);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log("Failed:",e),d.yw.error("创建角色失败")}))},onCancel:s,children:(0,C.jsxs)(L.A,{form:m,name:"form",style:{maxWidth:400},submitter:{render:function(){return null}},children:[i===k.K78&&(0,C.jsx)(M.Z,{label:"选择大模型提供商",name:"name",options:E,fieldProps:{placeholder:"选择大模型提供商(必选)",allowClear:!0,onChange:function(e){console.log("onParentSelectChange:",e);var n=x.find((function(n){return n.name===e}));R(n),console.log("selectedProvider:",n),m.setFieldsValue({nickname:null==n?void 0:n.nickname,apiUrl:null==n?void 0:n.apiUrl,apiKey:null==n?void 0:n.apiKey})},dropdownStyle:{maxHeight:400,overflow:"auto"}}}),(0,C.jsx)(S.Z,{label:"名称",name:"nickname",rules:[{required:!0,message:"请输入名称!"}],fieldProps:{onPressEnter:function(e){}}}),(0,C.jsx)(S.Z,{label:"ApiUrl",name:"apiUrl",rules:[{required:!0,message:"请输入apiUrl!"}],fieldProps:{onPressEnter:function(e){}}}),(0,C.jsx)(S.Z,{label:"ApiKey",name:"apiKey",fieldProps:{onPressEnter:function(e){}}})]})})})},O=function(e){var n,r=e.level,t=(0,f.Z)().isDarkMode,i=(0,m.useIntl)(),s=((0,u.useRef)(!1),(0,p.Z)()),L=s.translateString,M=s.translateStringTranct,S=(0,w.u)((function(e){return e.currentOrg})),Z=(0,u.useState)(!1),O=l()(Z,2),U=O[0],q=O[1],K=(0,u.useState)(!1),R=l()(K,2),T=R[0],F=R[1],I=(0,j.A)((function(e){return{llmproviderResult:e.llmproviderResult,currentLlmProvider:e.currentLlmProvider,setLlmProviderResult:e.setLlmProviderResult,insertLlmProvider:e.insertLlmProvider,setCurrentLlmProvider:e.setCurrentLlmProvider,upgradeLlmProvider:e.upgradeLlmProvider,deleteCurrentLlmProvider:e.deleteCurrentLlmProvider}})),V=I.llmproviderResult,A=I.currentLlmProvider,D=I.setLlmProviderResult,z=I.insertLlmProvider,H=I.setCurrentLlmProvider,W=I.upgradeLlmProvider,Y=I.deleteCurrentLlmProvider,G=v.Z.useModal(),N=l()(G,2),B=N[0],_=N[1],J=function(){var e=a()(o()().mark((function e(n){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("delete robot",n),d.yw.loading(i.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=4,(0,c.HH)(n);case 4:r=e.sent,console.log("delete robot response",r),200===r.code?(d.yw.destroy(),d.yw.success(i.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),Y(n.uid)):(d.yw.destroy(),d.yw.error(r.message));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Q=function(){var e=a()(o()().mark((function e(){var n,t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getLlmProviders"),n={pageNumber:0,pageSize:50,status:r===k.Hxq?"":k.KY,orgUid:null==S?void 0:S.uid,level:r},e.next=4,(0,c.mK)(n);case 4:t=e.sent,console.log("queryLlmProvidersByOrg: ",t),200===t.code?D(t):d.yw.error(t.message);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){Q()}),[]);var X=function(){var e=a()(o()().mark((function e(n){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("createLlmProvider",n),d.yw.loading(i.formatMessage({id:"creating"})),e.next=4,(0,c.T)(n);case 4:r=e.sent,console.log("createLlmProvider:",r),200===r.code?(d.yw.destroy(),d.yw.success(i.formatMessage({id:"create.success",defaultMessage:"create success"})),z(r.data),q(!1)):(d.yw.destroy(),d.yw.error(r.message));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),$=function(){var e=a()(o()().mark((function e(n){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.yw.loading(i.formatMessage({id:"updating"})),e.next=3,(0,c.fx)(n);case 3:r=e.sent,console.log("updateLlmProvider:",n,r),200===r.code?(d.yw.destroy(),d.yw.success(i.formatMessage({id:"update.success",defaultMessage:"update success"})),W(r.data),q(!1)):(d.yw.destroy(),d.yw.error(r.message));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{margin:10},children:(0,C.jsxs)(g.Z,{gap:"small",align:"flex-start",children:[(0,C.jsx)(h.ZP,{size:"small",type:"primary",icon:(0,C.jsx)(b.Z,{}),onClick:function(){console.log("new llmProvider"),F(!1),q(!0)},children:i.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,C.jsx)(h.ZP,{size:"small",onClick:function(){console.log("edit llmProvider"),F(!0),q(!0)},disabled:""===(null==A?void 0:A.uid),children:i.formatMessage({id:"edit",defaultMessage:"Edit"})}),(0,C.jsx)(h.ZP,{onClick:function(){return e=A,void B.confirm({title:i.formatMessage({id:"deleteTip"}),icon:(0,C.jsx)(P.Z,{}),content:"".concat(i.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(L(e.nickname),"】？"),onOk:function(){J(e)},onCancel:function(){},okText:i.formatMessage({id:"ok"}),cancelText:i.formatMessage({id:"cancel"})});var e},size:"small",style:{float:"right"},danger:!0,disabled:""===(null==A?void 0:A.uid),children:i.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]})}),(0,C.jsx)(y.Z,{itemLayout:"horizontal",dataSource:(null==V||null===(n=V.data)||void 0===n?void 0:n.content)||[],renderItem:function(e,n){return(0,C.jsx)(y.Z.Item,{style:(null==A?void 0:A.uid)===e.uid?{backgroundColor:t?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){H(e)},children:(0,C.jsx)(y.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,C.jsx)(x.C,{src:e.logo}),title:(0,C.jsx)(C.Fragment,{children:M(null==e?void 0:e.nickname)}),description:(null==e?void 0:e.status)===k.KY?"上线发布":"未上线"})})}}),U&&(0,C.jsx)(E,{open:U,isEdit:T,level:r,llmProvider:A,onCancel:function(){q(!1)},onSubmit:function(e){T?$(e):X(e)}}),_]})}},74573:function(e,n,r){r.d(n,{Z:function(){return $}});var t=r(76711),o=r.n(t),i=r(45332),a=r.n(i),s=r(44194),l=r(50571),u=r(73193),c=r.n(u),d=r(90819),f=r.n(d),p=r(89933),m=r.n(p),v=r(89756),g=r(77667),h=r(7206);function y(e){return x.apply(this,arguments)}function x(){return(x=m()(f()().mark((function e(n){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/model/query/org",{method:"GET",params:c()(c()({},n),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=m()(f()().mark((function e(n){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/model/create",{method:"POST",data:c()(c()({},n),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return b.apply(this,arguments)}function b(){return(b=m()(f()().mark((function e(n){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/model/update",{method:"POST",data:c()(c()({},n),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return L.apply(this,arguments)}function L(){return(L=m()(f()().mark((function e(n){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/model/delete",{method:"POST",data:c()(c()({},n),{},{client:g.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=r(40431),S=r(83730),Z=r(73668),C=r(72434),E=r(62599),O=r(12265),U=r(90136),q=r(5728),K=r(43688),R=r(61411),T=r(31549),F=function(e){var n=e.isEdit,r=e.llmmodel,t=e.provider,o=e.open,i=e.level,l=e.onClose,u=e.onSubmit,c=q.A.useForm(),d=a()(c,1)[0],f=((0,h.useIntl)(),(0,M.u)((function(e){return e.currentOrg})));(0,s.useEffect)((function(){n&&r&&d?d.setFieldsValue({uid:null==r?void 0:r.uid,name:null==r?void 0:r.name,nickname:null==r?void 0:r.nickname}):(console.log("form resetFields"),d.resetFields())}),[r]);return(0,s.useEffect)((function(){}),[r]),(0,T.jsx)("div",{children:(0,T.jsx)(R.Z,{title:n?"编辑模型":"新建模型",onClose:l,open:o,extra:(0,T.jsxs)(E.Z,{children:[(0,T.jsx)(O.ZP,{onClick:l,children:"取消"}),(0,T.jsx)(O.ZP,{onClick:function(){console.log("handleSubmit"),d.validateFields().then((function(e){console.log("Form values:",e);var o={uid:n?null==r?void 0:r.uid:"",name:e.name,nickname:e.nickname,providerUid:null==t?void 0:t.uid,level:i,orgUid:null==f?void 0:f.uid};console.log("llmmodelObject:",o),u(o)})).catch((function(e){console.log("Form errors:",e)}))},type:"primary",children:"保存"})]}),children:(0,T.jsxs)(q.A,{form:d,name:"model",submitter:!1,children:[(0,T.jsx)(K.Z,{label:"名称(用于接口调用)",name:"name"}),(0,T.jsx)(K.Z,{label:"昵称(便于记忆)",name:"nickname"})]})})})},I=r(50484),V=r(31816),A=r(31611),D=r(78416),z=r(74145),H=r(1780),W=r(17960),Y=function(e){var n=e.provider,r=e.level,t=(0,h.useIntl)(),o=(0,z.Z)().isDarkMode,i=(0,s.useState)(!0),l=a()(i,2),u=l[0],d=l[1],p=(0,H.Z)(),x=p.translateString,k=(p.translateStringTranct,(0,s.useState)(n)),b=a()(k,2),L=b[0],q=b[1],K=(0,s.useState)(),R=a()(K,2),Y=R[0],G=R[1],N=(0,s.useState)(!1),B=a()(N,2),_=B[0],J=B[1],Q=(0,M.u)((function(e){return e.currentOrg})),X=(0,s.useState)([]),$=a()(X,2),ee=$[0],ne=$[1],re=(0,W.A)((function(e){return e.upgradeLlmProvider})),te=S.Z.useModal(),oe=a()(te,2),ie=oe[0],ae=oe[1],se=function(){var e=m()(f()().mark((function e(n){var r;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("delete robot",n),v.yw.loading(t.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=4,j(n);case 4:r=e.sent,console.log("delete robot response",r),200===r.code?(v.yw.destroy(),v.yw.success(t.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),le()):(v.yw.destroy(),v.yw.error(r.message));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),le=function(){var e=m()(f()().mark((function e(){var n,t;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("requestModels"),n={pageNumber:0,pageSize:50,providerUid:null==L?void 0:L.uid,orgUid:null==Q?void 0:Q.uid,level:r},e.next=4,y(n);case 4:t=e.sent,console.log("queryLlmModelsByOrg: ",t,r),200===t.code?ne(t.data.content):v.yw.error(t.message);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){le()}),[]);var ue=function(){J(!1)},ce=function(){var e=m()(f()().mark((function e(n){var r,o;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleSubmitDrawer:",n),!u){e.next=9;break}return e.next=4,P(n);case 4:r=e.sent,console.log("updateLlmModel:",r),200===r.code?(v.yw.success(t.formatMessage({id:"update.success",defaultMessage:"update success"})),le(),ue()):v.yw.error(r.message),e.next=14;break;case 9:return e.next=11,w(n);case 11:o=e.sent,console.log("createLlmModel:",o),200===o.code?(v.yw.success(t.formatMessage({id:"create.success",defaultMessage:"create success"})),le(),ue()):v.yw.error(o.message);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),de=function(){var e=m()(f()().mark((function e(n){var r,o;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleUpdateProvider:",L),r=c()(c()({},L),{},{status:n?g.KY:g.L2A}),e.next=4,(0,D.fx)(r);case 4:o=e.sent,console.log("updateLlmProvider:",r,o),200===o.code?(v.yw.destroy(),v.yw.success(t.formatMessage({id:"update.success",defaultMessage:"update success"})),q(o.data),re(o.data)):(v.yw.destroy(),v.yw.error(o.message));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),fe=function(e,n){var r;console.log("list on delete",e),r=e,ie.confirm({title:t.formatMessage({id:"deleteTip"}),icon:(0,T.jsx)(I.Z,{}),content:"".concat(t.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(x(r.nickname),"】？"),onOk:function(){se(r)},onCancel:function(){},okText:t.formatMessage({id:"ok"}),cancelText:t.formatMessage({id:"cancel"})})};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("h1",{children:(0,T.jsx)("a",{href:null==L?void 0:L.webUrl,target:"_blank",children:null==L?void 0:L.nickname})}),(0,T.jsxs)("p",{children:["apiUrl: ",null==L?void 0:L.apiUrl]}),(0,T.jsxs)("p",{children:["apiKey: ",null==L?void 0:L.apiKey]}),(0,T.jsxs)("p",{children:["webUrl: ",null==L?void 0:L.webUrl]}),r===g.Hxq&&(0,T.jsx)(Z.Z,{checkedChildren:"上线发布",unCheckedChildren:"下线调试",defaultChecked:(null==L?void 0:L.status)===g.KY,onChange:function(e){console.log("switch to ".concat(e)),de(e)}}),(0,T.jsx)(C.Z,{orientation:"left",children:"模型列表"}),(0,T.jsxs)(E.Z,{children:[(0,T.jsx)(O.ZP,{icon:(0,T.jsx)(V.Z,{}),type:"primary",onClick:function(){d(!1),J(!0)},children:"添加模型"}),(0,T.jsx)(O.ZP,{icon:(0,T.jsx)(A.Z,{}),onClick:le,children:"刷新模型"})]}),(0,T.jsx)(U.Z,{itemLayout:"horizontal",dataSource:ee,renderItem:function(e,n){return(0,T.jsx)(U.Z.Item,{style:(null==Y?void 0:Y.uid)===e.uid?{backgroundColor:o?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){G(e)},actions:[(0,T.jsx)(O.ZP,{type:"link",onClick:function(){return n=e,console.log("list on edit",n),d(!0),void J(!0);var n},children:t.formatMessage({id:"edit",defaultMessage:"Edit"})},"edit"),(0,T.jsx)(O.ZP,{type:"link",onClick:function(){return fe(e)},children:t.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})},"delete")],children:(0,T.jsx)(U.Z.Item.Meta,{style:{marginLeft:"10px"},title:e.nickname,description:e.name})})}}),_&&(0,T.jsx)(F,{isEdit:u,llmmodel:Y,provider:L,open:_,level:r,onClose:ue,onSubmit:ce}),ae]})};function G(){return N.apply(this,arguments)}function N(){return(N=m()(f()().mark((function e(){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/ollama4j/ping",{method:"GET",params:{client:g.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){return _.apply(this,arguments)}function _(){return(_=m()(f()().mark((function e(){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/ollama4j/local-models",{method:"GET",params:{client:g.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=r(93982),Q=r(74828),X=function(e){e.provider,e.level;var n=(0,s.useState)(!1),r=a()(n,2),t=r[0],o=r[1],i=(0,s.useState)(!1),l=a()(i,2),u=l[0],c=l[1],d=(0,s.useState)([]),p=a()(d,2),v=p[0],g=p[1],h=function(){var e=m()(f()().mark((function e(){var n;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),console.log("pingOllama"),e.next=4,G();case 4:n=e.sent,console.log("getOllamaServerStatus: ",n),200===n.code?(c(n.data),o(!1)):(c(!1),o(!1));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=m()(f()().mark((function e(){var n;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("requestLocalModels"),e.next=3,B();case 3:n=e.sent,console.log("getOllamaLocalModels: ",n),200===n.code&&g(n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){h(),y()};return(0,s.useEffect)((function(){x()}),[]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(O.ZP,{icon:(0,T.jsx)(A.Z,{}),loading:t,type:"primary",onClick:x,children:"刷新"}),(0,T.jsx)("br",{}),(0,T.jsx)("br",{}),u?(0,T.jsx)(J.Z,{message:"Ollama运行中",type:"success"}):(0,T.jsx)(J.Z,{message:"请首先启动Ollama",type:"error"}),(0,T.jsx)(C.Z,{orientation:"left",children:"本地模型列表"}),(0,T.jsx)(U.Z,{itemLayout:"horizontal",dataSource:v,renderItem:function(e,n){return(0,T.jsx)(U.Z.Item,{children:(0,T.jsx)(U.Z.Item.Meta,{title:null==e?void 0:e.name,description:(0,Q.mr)(null==e?void 0:e.modified_at.toString())})})}})]})},$=function(e){var n=e.level,r=(0,s.useState)(""),t=a()(r,2),i=t[0],u=t[1],c=(0,s.useState)([]),d=a()(c,2),f=d[0],p=d[1],m=(0,W.A)((function(e){return{currentLlmProvider:e.currentLlmProvider,setCurrentLlmProvider:e.setCurrentLlmProvider}})),v=m.currentLlmProvider;m.setCurrentLlmProvider;(0,s.useEffect)((function(){if(console.log("currentLlmProvider: ",v),f.find((function(e){return e.key===(null==v?void 0:v.name)})))u(null==v?void 0:v.name);else{var e=o()(f);"ollama"===(null==v?void 0:v.name)?e.push({label:null==v?void 0:v.nickname,children:(0,T.jsx)(X,{provider:v,level:n}),key:null==v?void 0:v.name,closable:!0}):e.push({label:null==v?void 0:v.nickname,children:(0,T.jsx)(Y,{provider:v,level:n}),key:null==v?void 0:v.name,closable:!0}),p(e),u(null==v?void 0:v.name)}}),[v]);return(0,T.jsx)(l.Z,{type:"editable-card",onChange:function(e){u(e)},activeKey:i,onEdit:function(e,n){!function(e){var n=i,r=-1;f.forEach((function(n,t){n.key===e&&(r=t-1)}));var t=f.filter((function(n){return n.key!==e}));t.length&&n===e&&(n=r>=0?t[r].key:t[0].key),p(t),u(n)}(e)},items:f})}},93139:function(e,n,r){var t=r(74145);n.Z=function(){var e=(0,t.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"}}}},1780:function(e,n,r){var t=r(77667),o=r(74828),i=r(7206);n.Z=function(){var e=(0,i.useIntl)();return{translateString:function(n){return n&&n.startsWith(t.VoP)?e.formatMessage({id:n,defaultMessage:n}):n},translateStringTranct:function(n){return null!=n&&n.startsWith(t.VoP)||null!=n&&n.startsWith("ROLE_")?(0,o.aS)(e.formatMessage({id:n,defaultMessage:n}),10):(0,o.aS)(n,10)}}}},17960:function(e,n,r){r.d(n,{A:function(){return d}});var t=r(73193),o=r.n(t),i=r(76711),a=r.n(i),s=r(77667),l=r(39701),u=r(83642),c=r(41617),d=(0,l.Ue)()((0,u.mW)((0,u.tJ)((0,c.n)((function(e,n){return{llmproviderResult:{data:{content:[]}},currentLlmProvider:{uid:"",nickname:""},insertLlmProvider:function(n){e((function(e){e.llmproviderResult.data.content.unshift(n)}))},upgradeLlmProvider:function(n){e((function(e){var r=e.llmproviderResult.data.content,t=r.findIndex((function(e){return e.uid===n.uid}));-1!==t?r[t]=n:console.warn("LlmProvider with uid ".concat(n.uid," not found."))}))},setLlmProviderResult:function(r){e({llmproviderResult:r});var t,o=n().currentLlmProvider;""!==o.uid&&void 0!==o||(null===(t=r.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.length)>0&&e({currentLlmProvider:r.data.content[0]})},setCurrentLlmProvider:function(r){var t=n().llmproviderResult.data.content,i=t.findIndex((function(e){return e.uid===r.uid}));if(-1!==i){var s=[].concat(a()(t.slice(0,i)),[r],a()(t.slice(i+1))),l=o()(o()({},n().llmproviderResult),{},{data:{content:s}});e({llmproviderResult:l,currentLlmProvider:r})}else e({currentLlmProvider:r})},deleteCurrentLlmProvider:function(r){var t=n().llmproviderResult.data.content,i=t.findIndex((function(e){return e.uid===r}));-1!==i?e({llmproviderResult:o()(o()({},n().llmproviderResult),{},{data:{content:[].concat(a()(t.slice(0,i)),a()(t.slice(i+1)))}})}):console.warn("LlmProvider not found in cache:",r),n().currentLlmProvider.uid===r&&e({currentLlmProvider:{uid:""}})},deleteLlmProviderCache:function(){return e({},!0)}}})),{name:s.O4M})))}}]);