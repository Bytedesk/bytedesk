"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6693],{92710:function(e,t,n){n.d(t,{Z:function(){return l}});var s=n(13800),r=n(75271),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"},a=n(45791),i=function(e,t){return r.createElement(a.Z,(0,s.Z)((0,s.Z)({},e),{},{ref:t,icon:o}))};var l=r.forwardRef(i)},45463:function(e,t,n){n.d(t,{Z:function(){return l}});var s=n(13800),r=n(75271),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},a=n(45791),i=function(e,t){return r.createElement(a.Z,(0,s.Z)((0,s.Z)({},e),{},{ref:t,icon:o}))};var l=r.forwardRef(i)},79619:function(e,t,n){n.d(t,{Z:function(){return l}});var s=n(13800),r=n(75271),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},a=n(45791),i=function(e,t){return r.createElement(a.Z,(0,s.Z)((0,s.Z)({},e),{},{ref:t,icon:o}))};var l=r.forwardRef(i)},43591:function(e,t,n){var s=n(13800),r=n(60323),o=n(24671),a=n(26803),i=n(75271),l=n(34699),u=n(89755),d=n(52676),c=["options","fieldProps","proFieldProps","valueEnum"],f=i.forwardRef((function(e,t){var n=e.options,a=e.fieldProps,i=e.proFieldProps,l=e.valueEnum,f=(0,r.Z)(e,c);return(0,d.jsx)(u.Z,(0,s.Z)({ref:t,valueType:"checkbox",valueEnum:(0,o.h)(l,void 0),fieldProps:(0,s.Z)({options:n},a),lightProps:(0,s.Z)({labelFormatter:function(){return(0,d.jsx)(u.Z,(0,s.Z)({ref:t,valueType:"checkbox",mode:"read",valueEnum:(0,o.h)(l,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,s.Z)({options:n},a),proFieldProps:i},f))}},f.lightProps),proFieldProps:i},f))})),g=i.forwardRef((function(e,t){var n=e.fieldProps,r=e.children;return(0,d.jsx)(a.Z,(0,s.Z)((0,s.Z)({ref:t},n),{},{children:r}))})),p=(0,l.G)(g,{valuePropName:"checked"});p.Group=f,t.Z=p},75149:function(e,t,n){var s=n(13800),r=n(60323),o=n(75271),a=n(89755),i=n(52676),l=["fieldProps","min","proFieldProps","max"],u=function(e,t){var n=e.fieldProps,o=e.min,u=e.proFieldProps,d=e.max,c=(0,r.Z)(e,l);return(0,i.jsx)(a.Z,(0,s.Z)({valueType:"digit",fieldProps:(0,s.Z)({min:o,max:d},n),ref:t,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:u},c))},d=o.forwardRef(u);t.Z=d},80954:function(e,t,n){n.d(t,{AP:function(){return c},_J:function(){return b},t5:function(){return m},v_:function(){return g}});var s=n(90228),r=n.n(s),o=n(26068),a=n.n(o),i=n(87999),l=n.n(i),u=n(64453),d=n(45234);function c(e){return f.apply(this,arguments)}function f(){return(f=l()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/query/org",{method:"GET",params:a()(a()({},t),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return p.apply(this,arguments)}function p(){return(p=l()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/create",{method:"POST",data:a()(a()({},t),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=l()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/update",{method:"POST",data:a()(a()({},t),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return h.apply(this,arguments)}function h(){return(h=l()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/delete",{method:"POST",data:a()(a()({},t),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},73112:function(e,t,n){n.r(t),n.d(t,{default:function(){return ve}});var s=n(16242),r=n(75271),o=n(90228),a=n.n(o),i=n(87999),l=n.n(i),u=n(48305),d=n.n(u),c=n(64978),f=n(8591),g=n(85867),p=n(42502),m=n(94455),v=n(29132),b=n(65060),h=n(45463),y=n(45234),x=n(94414),w=n(65098),M=n(64453),j=n(43393),k=n(64826),F=n(6817),Z=n(52676),q=function(e){var t=e.open,n=e.onClose,s=e.onSubmit,r=(0,y.useIntl)(),o=j.A.useForm(),a=d()(o,1)[0],i=(0,w.u)((function(e){return e.currentOrg}));return(0,Z.jsx)("div",{children:(0,Z.jsx)(f.Z,{title:r.formatMessage({id:"pages.robot.new",defaultMessage:"New"}),open:t,forceRender:!0,okText:r.formatMessage({id:"save",defaultMessage:"Save"}),onOk:function(){console.log("handleSaveRobot"),a.validateFields().then((function(e){console.log("handleSaveRobot values:",e);var t={nickname:e.nickname,type:e.type,orgUid:i.uid};console.log("robotObject:",t),s(t)})).catch((function(e){console.log("Form errors:",e)}))},onCancel:function(){n()},children:(0,Z.jsxs)(j.A,{form:a,name:"basic",style:{maxWidth:400},submitter:!1,children:[(0,Z.jsx)(k.Z,{label:r.formatMessage({id:"nickname",defaultMessage:"Nickname"}),name:"nickname",rules:[{required:!0,message:r.formatMessage({id:"nickname",defaultMessage:"Nickname"})}]}),(0,Z.jsx)(F.Z,{label:r.formatMessage({id:"type",defaultMessage:"Type"}),name:["type"],options:[{label:r.formatMessage({id:M.f4h,defaultMessage:"Service"}),value:M.f4h},{label:r.formatMessage({id:M.wG_,defaultMessage:"Marketing"}),value:M.wG_,disabled:!0}],rules:[{required:!0,message:r.formatMessage({id:"choose",defaultMessage:"Choose"})}],fieldProps:{placeholder:r.formatMessage({id:"choose",defaultMessage:"Choose"}),onChange:function(e){console.log("onTreeSelectChange:",e)},allowClear:!0}})]})})})},S=n(76469),R=n(37240),C=n(92785),P=function(){var e=(0,x.Z)().isDarkMode,t=(0,y.useIntl)(),n=(0,r.useRef)(!1),s=(0,C.Z)(),o=s.translateString,i=s.translateStringTranct,u=(0,c.V)((function(e){return{robotResult:e.robotResult,currentRobot:e.currentRobot,insertRobot:e.insertRobot,deleteCurrentRobot:e.deleteCurrentRobot,setRobotResult:e.setRobotResult,setCurrentRobot:e.setCurrentRobot}})),M=u.robotResult,j=u.currentRobot,k=u.insertRobot,F=u.deleteCurrentRobot,P=u.setRobotResult,U=u.setCurrentRobot,T=(0,w.u)((function(e){return e.currentOrg})),A=f.Z.useModal(),O=d()(A,2),V=O[0],I=O[1],E=function(){var e=l()(a()().mark((function e(n){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("delete robot",n),R.yw.loading(t.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=4,(0,S.gf)(n);case 4:s=e.sent,console.log("delete robot response",s),200===s.code?(R.yw.destroy(),R.yw.success(t.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),F(n.uid)):(R.yw.destroy(),R.yw.error(s.message));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=l()(a()().mark((function e(){var t,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.current){e.next=3;break}return console.log("isLoading: 1",n.current),e.abrupt("return");case 3:return n.current=!0,R.yw.loading("loading"),t={pageNumber:0,pageSize:50,orgUid:null==T?void 0:T.uid},e.next=8,(0,S.p0)(t);case 8:s=e.sent,console.log("queryRobotsByOrg: ",s),200===s.code?(R.yw.destroy(),P(s)):(R.yw.destroy(),R.yw.error(s.message)),n.current=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){_()}),[]);var L=(0,r.useState)(!1),N=d()(L,2),z=N[0],B=N[1],G=function(){var e=l()(a()().mark((function e(n){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R.yw.loading(t.formatMessage({id:"creating",defaultMessage:"Creating"})),e.next=3,(0,S.lg)(n);case 3:s=e.sent,console.log("handleSaveRobot response:",s),200===s.code?(R.yw.destroy(),R.yw.success(t.formatMessage({id:"create.success"})),k(s.data),B(!1)):(R.yw.destroy(),B(!1),R.yw.error(s.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(e){return t.formatMessage({id:null==e?void 0:e.type,defaultMessage:null==e?void 0:e.type})};return(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{style:{margin:10},children:(0,Z.jsxs)(g.Z,{gap:"small",align:"flex-start",children:[(0,Z.jsx)(p.ZP,{size:"small",type:"primary",icon:(0,Z.jsx)(h.Z,{}),onClick:function(){B(!0)},children:t.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,Z.jsx)(p.ZP,{size:"small",onClick:_,children:t.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,Z.jsx)(p.ZP,{onClick:function(){return function(e){V.confirm({title:t.formatMessage({id:"deleteTip"}),icon:(0,Z.jsx)(b.Z,{}),content:"".concat(t.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(o(e.nickname),"】？"),onOk:function(){E(e)},onCancel:function(){},okText:t.formatMessage({id:"ok"}),cancelText:t.formatMessage({id:"cancel"})})}(j)},size:"small",style:{float:"right"},danger:!0,disabled:""===(null==j?void 0:j.uid),children:t.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]})}),(0,Z.jsx)(m.Z,{itemLayout:"horizontal",dataSource:M.data.content,renderItem:function(t,n){return(0,Z.jsx)(m.Z.Item,{style:(null==j?void 0:j.uid)===t.uid?{backgroundColor:e?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){U(t)},children:(0,Z.jsx)(m.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,Z.jsx)(v.C,{src:t.avatar}),title:(0,Z.jsx)(Z.Fragment,{children:i(null==t?void 0:t.nickname)}),description:X(t)})})}}),(0,Z.jsx)(q,{open:z,onClose:function(){B(!1)},onSubmit:G}),I]})},U=n(14604),T=n(20679),A=n(16548),O=n(20395),V=n(61575),I=n(3013),E=n(26068),_=n.n(E),L=n(99755),N=n(65012),z=n(75149),B=n(7283),G=function(){var e=(0,y.useIntl)(),t=j.A.useForm(),n=d()(t,1)[0],s=(0,C.Z)().translateString,o=(0,c.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),i=o.currentRobot,u=o.setCurrentRobot;(0,r.useEffect)((function(){var e,t,r,o,a,l;n.setFieldValue("enabled",null==i||null===(e=i.llm)||void 0===e?void 0:e.enabled),n.setFieldValue("topK",null==i||null===(t=i.llm)||void 0===t?void 0:t.topK),n.setFieldValue("scoreThreshold",null==i||null===(r=i.llm)||void 0===r?void 0:r.scoreThreshold),n.setFieldValue("model",null==i||null===(o=i.llm)||void 0===o?void 0:o.model),n.setFieldValue("temperature",null==i||null===(a=i.llm)||void 0===a?void 0:a.temperature),n.setFieldValue("prompt",s(null==i||null===(l=i.llm)||void 0===l?void 0:l.prompt))}),[i]);var f=function(){var t=l()(a()().mark((function t(n){var s,r,o,l,d,c,f;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("TabKeyword handleEnableChange",n),R.yw.loading(e.formatMessage({id:"updating"})),c=_()(_()({},i),{},{serviceSettings:_()(_()({},null==i?void 0:i.serviceSettings),{},{faqUids:null==i||null===(s=i.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),quickFaqUids:null==i||null===(r=i.serviceSettings)||void 0===r||null===(r=r.quickFaqs)||void 0===r?void 0:r.map((function(e){return e.uid})),guessFaqUids:null==i||null===(o=i.serviceSettings)||void 0===o||null===(o=o.guessFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),hotFaqUids:null==i||null===(l=i.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==i||null===(d=i.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))}),llm:_()(_()({},null==i?void 0:i.llm),{},{enabled:n})}),console.log("robotObject:",c),t.next=6,(0,S.$l)(c);case 6:f=t.sent,console.log("updateRobot response:",f),200===f.code?(R.yw.destroy(),R.yw.success(e.formatMessage({id:"update.success"})),u(f.data)):(R.yw.destroy(),R.yw.error(f.message));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=l()(a()().mark((function t(n){var s,r,o,l,d,c,f;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("handleSubmit",n),R.yw.loading(e.formatMessage({id:"updating"})),c=_()(_()({},i),{},{serviceSettings:_()(_()({},i.serviceSettings),{},{faqUids:null===(s=i.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),quickFaqUids:null==i||null===(r=i.serviceSettings)||void 0===r||null===(r=r.quickFaqs)||void 0===r?void 0:r.map((function(e){return e.uid})),guessFaqUids:null==i||null===(o=i.serviceSettings)||void 0===o||null===(o=o.guessFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),hotFaqUids:null==i||null===(l=i.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==i||null===(d=i.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))}),llm:n}),console.log("robotObject:",c),t.next=6,(0,S.$l)(c);case 6:f=t.sent,console.log("updateRobot response:",f),200===f.code?(R.yw.destroy(),R.yw.success(e.formatMessage({id:"update.success"})),u(f.data)):(R.yw.destroy(),R.yw.error(f.message));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(T.Z,{message:"大模型暂未支持云服务，如需使用，可私有部署，并配置自有key使用",action:(0,Z.jsx)(p.ZP,{type:"link",onClick:function(){window.open(M.rVq)},children:"docs"})}),(0,Z.jsx)(B.Z,{}),(0,Z.jsxs)(j.A,{form:n,size:"large",submitter:{render:function(e,t){return[(0,Z.jsx)(p.ZP,{type:"default",onClick:function(){var t;null===(t=e.form)||void 0===t||t.resetFields()},children:"重置"},"reset"),(0,Z.jsx)(p.ZP,{type:"primary",onClick:function(){var t;null===(t=e.form)||void 0===t||t.submit()},children:"保存"},"submit")]},submitButtonProps:{size:"large",htmlType:"button"}},onFinish:g,children:[(0,Z.jsx)(L.Z,{width:"lg",name:"enabled",label:"enabled",tooltip:"启用大模型后，将会关闭关键词。用户在发送消息时，将会直接请求大模型。",fieldProps:{onChange:f}}),(0,Z.jsx)(N.Z,{width:"lg",name:"prompt",label:"prompt",placeholder:"请输入prompt",rules:[{required:!0,message:"请输入prompt"}]}),(0,Z.jsx)(F.Z,{width:"lg",name:"model",label:"model",allowClear:!0,options:[{value:"ZHIPUAI_GLM_3_TURBO",label:"智谱AI-GLM-3-Turbo"},{value:"ZHIPUAI_GLM_4",label:"智谱AI-GLM-4"},{value:"OLLAMA",label:"Ollama"},{value:"OPENAI",label:"OpenAi",disabled:!0}],rules:[{required:!0,message:"请选择大模型"}]}),(0,Z.jsx)(z.Z,{width:"lg",label:"温度",name:"temperature",min:0,max:1,fieldProps:{precision:1,step:.1},rules:[{required:!0,message:"请输入温度"}]}),(0,Z.jsx)(z.Z,{width:"lg",label:"上下文消息数",name:"contextMsgCount",min:0,max:10,fieldProps:{precision:0,step:1},rules:[{required:!0,message:"请输入上下文消息数"}]})]})]})},X=n(92710),H=function(){var e=(0,y.useIntl)(),t=(0,y.useNavigate)(),n=j.A.useForm(),s=d()(n,1)[0],o=((0,C.Z)().translateString,(0,c.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}}))),i=o.currentRobot,u=o.setCurrentRobot;(0,r.useEffect)((function(){var e;s.setFieldValue("enabled",!(null!=i&&null!==(e=i.llm)&&void 0!==e&&e.enabled)),s.setFieldValue("defaultReply",null==i?void 0:i.defaultReply)}),[i]);var f=function(){var t=l()(a()().mark((function t(){return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.validateFields().then(function(){var t=l()(a()().mark((function t(n){var s,r,o,l,d,c,f;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("TabKeyword handleSubmit",n),R.yw.loading(e.formatMessage({id:"updating"})),c=_()(_()({},i),{},{serviceSettings:_()(_()({},null==i?void 0:i.serviceSettings),{},{faqUids:null==i||null===(s=i.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),quickFaqUids:null==i||null===(r=i.serviceSettings)||void 0===r||null===(r=r.quickFaqs)||void 0===r?void 0:r.map((function(e){return e.uid})),guessFaqUids:null==i||null===(o=i.serviceSettings)||void 0===o||null===(o=o.guessFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),hotFaqUids:null==i||null===(l=i.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==i||null===(d=i.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))}),llm:_()(_()({},null==i?void 0:i.llm),{},{enabled:!n.enabled}),defaultReply:n.defaultReply}),console.log("robotObject:",c),t.next=6,(0,S.$l)(c);case 6:f=t.sent,console.log("updateRobot response:",f),200===f.code?(R.yw.destroy(),R.yw.success(e.formatMessage({id:"update.success"})),u(f.data)):(R.yw.destroy(),R.yw.error(f.message));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log("Form errors:",e)}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g=function(){var t=l()(a()().mark((function t(n){var s,r,o,l,d,c,f;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("TabKeyword handleEnableChange",n),R.yw.loading(e.formatMessage({id:"updating"})),c=_()(_()({},i),{},{serviceSettings:_()(_()({},null==i?void 0:i.serviceSettings),{},{quickFaqUids:null==i||null===(s=i.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==i||null===(r=i.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),guessFaqUids:null==i||null===(o=i.serviceSettings)||void 0===o||null===(o=o.guessFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),hotFaqUids:null==i||null===(l=i.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==i||null===(d=i.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))}),llm:_()(_()({},null==i?void 0:i.llm),{},{enabled:!n})}),console.log("robotObject:",c),t.next=6,(0,S.$l)(c);case 6:f=t.sent,console.log("updateRobot response:",f),200===f.code?(R.yw.destroy(),R.yw.success(e.formatMessage({id:"update.success"})),u(f.data)):(R.yw.destroy(),R.yw.error(f.message));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)(j.A,{form:s,onFinish:f,children:[(0,Z.jsx)(L.Z,{label:"是否启用关键词",name:"enabled",tooltip:"启用关键字后，将会关闭大模型。用户在发送消息时，如果消息内容包含关键字，则机器人将匹配关键字并自动回复。",fieldProps:{onChange:g}}),(0,Z.jsx)(j.A.Item,{children:(0,Z.jsx)(p.ZP,{icon:(0,Z.jsx)(X.Z,{}),onClick:function(){t("/kb/keyword/data")},children:"添加关键字"},"github")}),(0,Z.jsx)(N.Z,{width:"lg",label:"未匹配回复语",name:"defaultReply"})]})})},$=function(e){e.type;return(0,Z.jsx)("div",{children:"TODO: 对接fastgpt、dify等工具"})},D=n(69889),K=function(){return(0,Z.jsx)("div",{children:(0,Z.jsx)(D.Z,{})})},Q=n(27066),W=n(61714),J=n(33778),Y=n(80954),ee=function(){var e=(0,y.useIntl)(),t=(0,y.useNavigate)(),n=j.A.useForm(),s=d()(n,1)[0],o=(0,C.Z)().translateString,i=(0,r.useState)(),u=d()(i,2),f=u[0],g=u[1],m=(0,w.u)((function(e){return e.currentOrg})),v=(0,c.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),b=v.currentRobot,h=v.setCurrentRobot,x=function(){var t=l()(a()().mark((function t(){var n,s;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return R.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:50,type:M.QPQ,orgUid:m.uid},t.next=4,(0,Y.AP)(n);case 4:s=t.sent,console.log("getKeywordBase response:",n,s),R.yw.destroy(),200===s.code?g(s):R.yw.error(s.message);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,r.useEffect)((function(){x()}),[]),(0,r.useEffect)((function(){s.setFieldValue("kbUid",null==b?void 0:b.kbUid)}),[b]);var k=function(){var t=l()(a()().mark((function t(n){var s,r,o,i,l,u,d;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onFinish values:",n),u=_()(_()({},b),{},{serviceSettings:_()(_()({},b.serviceSettings),{},{faqUids:null==b||null===(s=b.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),quickFaqUids:null==b||null===(r=b.serviceSettings)||void 0===r||null===(r=r.quickFaqs)||void 0===r?void 0:r.map((function(e){return e.uid})),guessFaqUids:null==b||null===(o=b.serviceSettings)||void 0===o||null===(o=o.guessFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),hotFaqUids:null==b||null===(i=b.serviceSettings)||void 0===i||null===(i=i.hotFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),shortcutFaqUids:null==b||null===(l=b.serviceSettings)||void 0===l||null===(l=l.shortcutFaqs)||void 0===l?void 0:l.map((function(e){return e.uid}))}),kbUid:n.kbUid}),console.log("robotObject:",u),t.next=5,(0,S.$l)(u);case 5:d=t.sent,console.log("updateRobot response:",d),200===d.code?(R.yw.destroy(),R.yw.success(e.formatMessage({id:"update.success"})),h(d.data)):(R.yw.destroy(),R.yw.error(d.message));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.jsx)("div",{children:(0,Z.jsxs)(j.A,{form:s,onFinish:k,children:[(0,Z.jsx)(F.Z,{width:"md",name:"kbUid",label:"知识库",options:null==f?void 0:f.data.content.map((function(e){return{value:e.uid,label:o(e.name)}})),fieldProps:{onChange:function(e){console.log("kbUid:",e)}}}),(0,Z.jsx)(j.A.Item,{children:(0,Z.jsx)(p.ZP,{icon:(0,Z.jsx)(X.Z,{}),onClick:function(){t("/kb/llm/data")},children:"添加大模型知识库"},"github")})]})})},te=n(95297),ne=n(42452),se=n(27028),re=n(67585),oe=function(){var e=(0,y.useIntl)(),t=(0,r.useMemo)((function(){return!0}),[]),n=[{key:"kb",label:(0,Z.jsx)(y.FormattedMessage,{id:"pages.robot.tab.kb",defaultMessage:"Knowledge Base"}),children:(0,Z.jsx)(ee,{}),disabled:t},{key:"faq",label:(0,Z.jsx)(y.FormattedMessage,{id:"menu.knowledge.faq",defaultMessage:"Faq"}),children:(0,Z.jsx)(A.Z,{type:M._X4}),disabled:t},{key:"quickFaqs",label:(0,Z.jsx)(y.FormattedMessage,{id:"menu.knowledge.quickbutton",defaultMessage:"QuickButton"}),children:(0,Z.jsx)(W.Z,{type:M._X4}),disabled:t},{key:"faqGuess",label:(0,Z.jsx)(y.FormattedMessage,{id:"menu.knowledge.faqGuess",defaultMessage:"FaqGuess"}),children:(0,Z.jsx)(O.Z,{type:M._X4}),disabled:t},{key:"faqHot",label:(0,Z.jsx)(y.FormattedMessage,{id:"menu.knowledge.faqHot",defaultMessage:"FaqHot"}),children:(0,Z.jsx)(V.Z,{type:M._X4}),disabled:t},{key:"faqShortcut",label:(0,Z.jsx)(y.FormattedMessage,{id:"menu.knowledge.faqShortcut",defaultMessage:"FaqShortcut"}),children:(0,Z.jsx)(I.Z,{type:M._X4}),disabled:t},{key:"llm",label:(0,Z.jsx)(y.FormattedMessage,{id:"llm",defaultMessage:"Llm"}),children:(0,Z.jsx)(G,{}),disabled:t},{key:"keyword",label:(0,Z.jsx)(y.FormattedMessage,{id:"keyword",defaultMessage:"Keyword"}),children:(0,Z.jsx)(H,{}),disabled:t},{key:"third",label:(0,Z.jsx)(y.FormattedMessage,{id:"third",defaultMessage:"Third"}),children:(0,Z.jsx)($,{type:M._X4}),disabled:t},{key:"transfer",label:(0,Z.jsx)(y.FormattedMessage,{id:"transfer",defaultMessage:"Transfer"}),children:(0,Z.jsx)(K,{}),disabled:t},{key:"survey",label:(0,Z.jsx)(y.FormattedMessage,{id:"survey",defaultMessage:"Survey"}),children:(0,Z.jsx)(re.Z,{type:M._X4}),disabled:t},{key:"history",label:(0,Z.jsx)(y.FormattedMessage,{id:"history",defaultMessage:"History"}),children:(0,Z.jsx)(te.Z,{type:M._X4}),disabled:t},{key:"inputassociation",label:(0,Z.jsx)(y.FormattedMessage,{id:"inputassociation",defaultMessage:"Input Association"}),children:(0,Z.jsx)(se.Z,{type:M._X4}),disabled:t},{key:"black",label:(0,Z.jsx)(y.FormattedMessage,{id:"black",defaultMessage:"Black"}),children:(0,Z.jsx)(J.Z,{type:M._X4}),disabled:t},{key:"antiharassment",label:(0,Z.jsx)(y.FormattedMessage,{id:"antiharassment",defaultMessage:"Anti Harassment"}),children:(0,Z.jsx)(Q.Z,{type:M._X4}),disabled:t}];return(0,Z.jsxs)(Z.Fragment,{children:[t&&(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(T.Z,{message:"企业版-高级功能",style:{marginBottom:20},type:"warning",action:(0,Z.jsx)(p.ZP,{type:"link",icon:(0,Z.jsx)(ne.Z,{}),onClick:function(){return window.open(M.rVq)},children:e.formatMessage({id:"setting.helpdoc"})})})}),(0,Z.jsx)(U.Z,{tabPosition:"left",items:n})]})},ae=n(77705),ie=n(79619),le=n(92813),ue=function(){var e=j.A.useForm(),t=d()(e,1)[0],n=(0,y.useIntl)(),s=(0,C.Z)().translateString,o=(0,c.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),i=o.currentRobot,u=o.setCurrentRobot,f=(0,r.useState)(""),g=d()(f,2),m=g[0],b=g[1];(0,r.useEffect)((function(){var e;i&&(t.setFieldValue("nickname",s(null==i?void 0:i.nickname)),t.setFieldValue("welcomeTip",s(null==i||null===(e=i.serviceSettings)||void 0===e?void 0:e.welcomeTip)),t.setFieldValue("description",s(null==i?void 0:i.description)))}),[i]);var h=function(){var e=l()(a()().mark((function e(t){var s,r,o,l,d,c,f;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish:",t),R.yw.loading(n.formatMessage({id:"updating"})),c=_()(_()({},i),{},{serviceSettings:_()(_()({},i.serviceSettings),{},{welcomeTip:t.welcomeTip,quickFaqUids:null==i||null===(s=i.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==i||null===(r=i.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),guessFaqUids:null==i||null===(o=i.serviceSettings)||void 0===o||null===(o=o.guessFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),hotFaqUids:null==i||null===(l=i.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==i||null===(d=i.serviceSettings)||void 0===d||null===(d=d.shortcutFaqs)||void 0===d?void 0:d.map((function(e){return e.uid}))}),nickname:t.nickname,description:t.description,avatar:m}),console.log("robotObject:",c),e.next=6,(0,S.$l)(c);case 6:f=e.sent,console.log("updateRobot response:",f),200===f.code?(R.yw.success(n.formatMessage({id:"update.success"})),u(f.data)):R.yw.error(f.message),R.yw.destroy();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,r.useEffect)((function(){b(null==i?void 0:i.avatar)}),[i]),(0,Z.jsxs)(j.A,{form:t,style:{marginLeft:"100px"},onFinish:h,children:[(0,Z.jsx)(le.Z.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:null==e?void 0:e.fileList},label:n.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,Z.jsxs)(ae.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e),b(e)},onError:function(e){console.log("handleUploadError:",e)},children:[(0,Z.jsx)(v.C,{src:m}),(0,Z.jsx)(p.ZP,{icon:(0,Z.jsx)(ie.Z,{}),children:n.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,Z.jsx)(k.Z,{width:"md",name:"nickname",label:n.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),tooltip:n.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),placeholder:n.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"}),rules:[{required:!0,message:n.formatMessage({id:"pages.robot.tab.title",defaultMessage:"Title"})}]}),(0,Z.jsx)(N.Z,{width:"md",name:"welcomeTip",label:n.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),tooltip:n.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),placeholder:n.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"}),rules:[{required:!0,message:n.formatMessage({id:"pages.robot.tab.welcomeTip",defaultMessage:"welcomeTip"})}]}),(0,Z.jsx)(N.Z,{width:"md",name:"description",label:n.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),tooltip:n.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),placeholder:n.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),rules:[{required:!0,message:n.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"})}]})]})},de=n(32998),ce=function(e){var t=e.type;console.log("TabApi:",t);var n=(0,y.useAccess)();return n.canDebug&&console.log("TabApi canDebug"),(0,Z.jsx)("div",{children:(0,Z.jsx)("p",{children:(0,Z.jsx)(y.Access,{accessible:n.canDebug(),fallback:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(y.FormattedMessage,{id:M.h5w})}),children:"开放api、权限控制、统计数据"})})})},fe=function(){var e=(0,y.useIntl)(),t=(0,r.useState)([]),n=d()(t,2),s=n[0],o=n[1],a=[{key:"basic",label:e.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,Z.jsx)(ue,{})},{key:"serviceSettings",label:e.formatMessage({id:"pages.agent.service.settings",defaultMessage:"Service Settings"}),children:(0,Z.jsx)(de.Z,{type:M._X4})},{key:"advanced",label:e.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,Z.jsx)(oe,{})},{key:"tabapi",label:"API",children:(0,Z.jsx)(ce,{type:M._X4})}];return(0,r.useEffect)((function(){o(a)}),[]),(0,Z.jsx)(U.Z,{defaultActiveKey:"basic",items:s})},ge=n(7571),pe=s.Z.Sider,me=s.Z.Content,ve=function(){var e=(0,ge.Z)(),t=e.leftSiderStyle,n=e.leftSiderWidth,r=e.contentStyle;return(0,Z.jsxs)(s.Z,{children:[(0,Z.jsx)(pe,{width:n,style:t,children:(0,Z.jsx)(P,{})}),(0,Z.jsx)(s.Z,{children:(0,Z.jsx)(me,{style:r,children:(0,Z.jsx)(fe,{})})})]})}},8591:function(e,t,n){n.d(t,{Z:function(){return w}});var s=n(96986),r=n(55849),o=n(29168),a=n(75271),i=n(82187),l=n.n(i),u=n(40995),d=n(52825),c=n(34662),f=n(30076),g=n(90698),p=n(9573),m=n(20339),v=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};var b=(0,d.i)((e=>{const{prefixCls:t,className:n,closeIcon:s,closable:r,type:o,title:i,children:d,footer:b}=e,h=v(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:y}=a.useContext(c.E_),x=y(),w=t||y("modal"),M=(0,f.Z)(x),[j,k,F]=(0,m.ZP)(w,M),Z=`${w}-confirm`;let q={};return q=o?{closable:null!=r&&r,title:"",footer:"",children:a.createElement(g.O,Object.assign({},e,{prefixCls:w,confirmPrefixCls:Z,rootPrefixCls:x,content:d}))}:{closable:null==r||r,title:i,footer:null!==b&&a.createElement(p.$,Object.assign({},e)),children:d},j(a.createElement(u.s,Object.assign({prefixCls:w,className:l()(k,`${w}-pure-panel`,o&&Z,o&&`${Z}-${o}`,n,F,M)},h,{closeIcon:(0,p.b)(w,s),closable:r},q)))})),h=n(64501);function y(e){return(0,s.ZP)((0,s.uW)(e))}const x=o.Z;x.useModal=h.Z,x.info=function(e){return(0,s.ZP)((0,s.cw)(e))},x.success=function(e){return(0,s.ZP)((0,s.vq)(e))},x.error=function(e){return(0,s.ZP)((0,s.AQ)(e))},x.warning=y,x.warn=y,x.confirm=function(e){return(0,s.ZP)((0,s.Au)(e))},x.destroyAll=function(){for(;r.Z.length;){const e=r.Z.pop();e&&e()}},x.config=s.ai,x._InternalPanelDoNotUseOrYouWillBeFired=b;var w=x}}]);