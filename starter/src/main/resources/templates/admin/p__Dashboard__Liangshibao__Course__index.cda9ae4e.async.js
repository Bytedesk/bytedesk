"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1742],{11475:function(Z,R,e){e.d(R,{Z:function(){return c}});var j=e(1413),r=e(67294),d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},n=d,_=e(91146),l=function(f,y){return r.createElement(_.Z,(0,j.Z)((0,j.Z)({},f),{},{ref:y,icon:n}))},m=r.forwardRef(l),c=m},51042:function(Z,R,e){var j=e(1413),r=e(67294),d=e(42110),n=e(91146),_=function(c,o){return r.createElement(n.Z,(0,j.Z)((0,j.Z)({},c),{},{ref:o,icon:d.Z}))},l=r.forwardRef(_);R.Z=l},30300:function(Z,R,e){e.d(R,{FU:function(){return o},O7:function(){return F},k4:function(){return y},yr:function(){return P}});var j=e(15009),r=e.n(j),d=e(97857),n=e.n(d),_=e(99289),l=e.n(_),m=e(85615),c=e(86745);function o(a){return f.apply(this,arguments)}function f(){return f=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/category/query/org",{method:"GET",params:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),f.apply(this,arguments)}function y(a){return v.apply(this,arguments)}function v(){return v=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/category/create",{method:"POST",data:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),v.apply(this,arguments)}function P(a){return E.apply(this,arguments)}function E(){return E=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/category/update",{method:"POST",data:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),E.apply(this,arguments)}function U(a){return S.apply(this,arguments)}function S(){return S=_asyncToGenerator(_regeneratorRuntime().mark(function a(g){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/category/delete",{method:"POST",data:_objectSpread(_objectSpread({},g),{},{client:HTTP_CLIENT})}));case 1:case"end":return t.stop()}},a)})),S.apply(this,arguments)}function w(a){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function a(g){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/category/all",{method:"GET",params:_objectSpread(_objectSpread({},g),{},{client:HTTP_CLIENT})}));case 1:case"end":return t.stop()}},a)})),I.apply(this,arguments)}function F(){return W.apply(this,arguments)}function W(){return W=l()(r()().mark(function a(){return r()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",(0,c.request)("/visitor/api/v1/category/query",{method:"GET",params:{client:m.bV}}));case 1:case"end":return T.stop()}},a)})),W.apply(this,arguments)}},7420:function(Z,R,e){e.d(R,{$T:function(){return y},A:function(){return w},Hf:function(){return U},P6:function(){return P},gx:function(){return o}});var j=e(15009),r=e.n(j),d=e(97857),n=e.n(d),_=e(99289),l=e.n(_),m=e(85615),c=e(86745);function o(a){return f.apply(this,arguments)}function f(){return f=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/query/org",{method:"GET",params:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),f.apply(this,arguments)}function y(a){return v.apply(this,arguments)}function v(){return v=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/query/user",{method:"GET",params:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),v.apply(this,arguments)}function P(a){return E.apply(this,arguments)}function E(){return E=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/create",{method:"POST",data:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),E.apply(this,arguments)}function U(a){return S.apply(this,arguments)}function S(){return S=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/update",{method:"POST",data:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),S.apply(this,arguments)}function w(a){return I.apply(this,arguments)}function I(){return I=l()(r()().mark(function a(g){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/api/v1/course/delete",{method:"POST",data:n()(n()({},g),{},{client:m.bV})}));case 1:case"end":return t.stop()}},a)})),I.apply(this,arguments)}function F(a){return W.apply(this,arguments)}function W(){return W=_asyncToGenerator(_regeneratorRuntime().mark(function a(g){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/course/filter",{method:"GET",params:_objectSpread(_objectSpread({},g),{},{client:HTTP_CLIENT})}));case 1:case"end":return t.stop()}},a)})),W.apply(this,arguments)}},77154:function(Z,R,e){var j=e(39825);function r(){var d=(0,j.Z)(),n=d.isDarkMode,_=250,l={borderRight:n?"1px solid #333":"1px solid #ccc",background:n?"#141414":"#f5f5f5"},m={background:n?"#141414":"#fff"},c={borderLeft:n?"1px solid #333":"1px solid #ccc",background:n?"#141414":"#f5f5f5"},o={minHeight:120,background:n?"#141414":"#f5f5f5"};return{leftSiderStyle:l,leftSiderWidth:_,headerStyle:m,rightSiderStyle:c,contentStyle:o}}R.Z=r},83373:function(Z,R,e){e.r(R),e.d(R,{default:function(){return ve}});var j=e(77154),r=e(21612),d=e(67294),n=e(15009),_=e.n(n),l=e(99289),m=e.n(l),c=e(5574),o=e.n(c),f=e(80049),y=e(7420),v=e(89333),P=e(60247),E=e(11475),U=e(51042),S=e(53719),w=e(85576),I=e(14726),F=e(8232),W=e(85265),a=e(42075),g=e(55102),T=e(2084),t=e(74656),ne=e(89102),u=e(85893),le=function(b){var D=b.isEdit,s=b.course,$=b.open,K=b.onClose,H=b.onSubmit,Y=F.Z.useForm(),q=o()(Y,1),L=q[0],G=(0,ne.v)(function(x){return x.categoryTreeOptions});(0,d.useEffect)(function(){if(s&&L){var x,O;L.setFieldsValue({name:s==null?void 0:s.name,description:s==null?void 0:s.description}),L.setFieldsValue({categories:[s==null||(x=s.mainCategory)===null||x===void 0?void 0:x.uid,s==null||(O=s.subCategory)===null||O===void 0?void 0:O.uid]})}else L!=null&&!D&&(console.log("form resetFields"),L.resetFields())},[s]);var ae=function(O){console.log("handleNameChange:",O)},ee=function(O,z){console.log("Cascader value:",O),console.log("Cascader selectedData:",z)},J=function(O){console.log("selected ".concat(O))},Q=function(){console.log("handleSubmit"),L.validateFields().then(function(O){console.log("Form values:",O);var z={uid:s==null?void 0:s.uid,name:O.name,cover:s.cover,description:O.description,detail:s.detail,price:s.price,mainCategory:{uid:O.categories[0]},subCategory:{uid:O.categories[1]},published:O.published==="true"};H(z)}).catch(function(O){console.log("Form errors:",O)})};return(0,u.jsx)("div",{children:(0,u.jsx)(W.Z,{title:D?"\u4FEE\u6539\u8BFE\u7A0B":"\u65B0\u5EFA\u8BFE\u7A0B",onClose:K,open:$,extra:(0,u.jsxs)(a.Z,{children:[(0,u.jsx)(I.ZP,{onClick:K,children:"\u53D6\u6D88"}),(0,u.jsx)(I.ZP,{onClick:Q,type:"primary",children:"\u4FDD\u5B58"})]}),children:(0,u.jsxs)(F.Z,{form:L,children:[(0,u.jsx)(F.Z.Item,{name:"name",label:"\u8BFE\u7A0B\u540D\u79F0",initialValue:s==null?void 0:s.name,children:(0,u.jsx)(g.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0"})}),(0,u.jsx)(F.Z.Item,{name:"categories",label:"\u8BFE\u7A0B\u5206\u7C7B",children:(0,u.jsx)(T.Z,{options:G,onChange:ee,placeholder:"\u9009\u62E9\u5206\u7C7B"})}),(0,u.jsx)(F.Z.Item,{name:"description",label:"\u8BFE\u7A0B\u63CF\u8FF0",initialValue:s==null?void 0:s.description,children:(0,u.jsx)(g.Z.TextArea,{placeholder:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u63CF\u8FF0"})}),(0,u.jsx)(F.Z.Item,{name:"published",label:"\u8BFE\u7A0B\u72B6\u6001",initialValue:s!=null&&s.published?"true":"false",children:(0,u.jsx)(t.Z,{style:{width:120},onChange:J,options:[{value:"true",label:"\u5DF2\u53D1\u5E03"},{value:"false",label:"\u672A\u53D1\u5E03"}]})})]})})})},de=le,ce=e(30300),V=e(86745),_e=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5C01\u9762",dataIndex:"cover",render:function(b,D){return(0,u.jsx)("a",{href:D.cover,target:"_blank",children:(0,u.jsx)("img",{src:D.cover,width:"40",height:"40"})})}},{title:(0,u.jsx)(V.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"name",copyable:!0},{title:(0,u.jsx)(V.FormattedMessage,{id:"category",defaultMessage:"Category"}),key:"category",render:function(b,D){var s=D.mainCategory?D.mainCategory.name:"-",$=D.subCategory?D.subCategory.name:"-";return(0,u.jsxs)("span",{children:[s," / ",$]})}},{title:"\u57CE\u5E02",dataIndex:"city",render:function(b,D){return D.city?D.city.name:"-"}},{title:"\u53D1\u5E03\u4EBA",editable:!1,renderText:function(b,D,s,$){var K;return(K=D.user)===null||K===void 0?void 0:K.nickname}},{title:(0,u.jsx)(V.FormattedMessage,{id:"status",defaultMessage:"Status"}),key:"published",render:function(b,D){return D.published?"\u5DF2\u53D1\u5E03":"\u672A\u53D1\u5E03"}},{title:(0,u.jsx)(V.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",editable:!1,sorter:!0,hideInSearch:!0}],me=function(){var b=(0,V.useIntl)(),D=(0,P.L)(function(p){return p.userInfo}),s=(0,d.useRef)(),$=(0,d.useState)(1),K=o()($,2),H=K[0],Y=K[1],q=(0,d.useState)(10),L=o()(q,2),G=L[0],ae=L[1],ee=(0,d.useState)(!0),J=o()(ee,2),Q=J[0],x=J[1],O=(0,d.useState)(),z=o()(O,2),he=z[0],se=z[1],N=(0,v.K)(function(p){return{courseResult:p.courseResult,insertCourseResult:p.insertCourseResult,updateCourseResult:p.updateCourseResult,deleteCourseResult:p.deleteCourseResult,setCourseResult:p.setCourseResult}}),X=N.courseResult,Ce=N.insertCourseResult,ye=N.updateCourseResult,Ee=N.deleteCourseResult,be=N.setCourseResult,De=(0,ne.v)(function(p){return p.setCategoryResult}),Oe=(0,d.useState)(!1),ue=o()(Oe,2),Me=ue[0],te=ue[1],je=w.Z.useModal(),oe=o()(je,2),Re=oe[0],Pe=oe[1],Te=function(h){Re.confirm({title:b.formatMessage({id:"deleteTip"}),icon:(0,u.jsx)(E.Z,{}),content:"".concat(b.formatMessage({id:"deleteAfirm",defaultMessage:"Delete"}),"\u3010").concat(h.name,"\u3011\uFF1F"),onOk:function(){Ie(h)},onCancel:function(){},okText:b.formatMessage({id:"ok"}),cancelText:b.formatMessage({id:"cancel"})})},Se=function(){se(void 0),x(!1),te(!0)},Ae=function(h){se(h),x(!0),te(!0)},re=function(){te(!1)},Ue=function(){var p=m()(_()().mark(function h(i){var M,A;return _()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(console.log("handleSubmitDrawer:",i),!Q){B.next=9;break}return B.next=4,(0,y.Hf)(i);case 4:M=B.sent,console.log("updateCourse:",M),M.code===200?(f.yw.success("\u66F4\u65B0\u6210\u529F"),ye(M.data),re()):f.yw.error(M.message),B.next=14;break;case 9:return B.next=11,(0,y.P6)(i);case 11:A=B.sent,console.log("createCourse:",A),A.code===200?(f.yw.success(b.formatMessage({id:"create.success",defaultMessage:"create success"})),Ce(A.data),re()):f.yw.error(A.message);case 14:case"end":return B.stop()}},h)}));return function(i){return p.apply(this,arguments)}}(),Ie=function(){var p=m()(_()().mark(function h(i){var M;return _()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return console.log("handleDeleteCourse:",i),C.next=3,(0,y.A)(i);case 3:M=C.sent,M.code===200?Ee(i):f.yw.error(M.message);case 5:case"end":return C.stop()}},h)}));return function(i){return p.apply(this,arguments)}}(),Be=[].concat(_e,[{title:b.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",render:function(h,i,M,A){return[(0,u.jsx)("a",{onClick:function(){console.log("edit record:",i),Ae(i)},children:b.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,u.jsx)(I.ZP,{size:"small",type:"link",onClick:function(){return Te(i)},danger:!0,children:"\u5220\u9664"},"delete")]}}]),ie=function(){var p=m()(_()().mark(function h(){var i,M;return _()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(i={pageNumber:H-1,pageSize:G},!D.superUser){C.next=7;break}return C.next=4,(0,y.gx)(i);case 4:C.t0=C.sent,C.next=10;break;case 7:return C.next=9,(0,y.$T)(i);case 9:C.t0=C.sent;case 10:M=C.t0,console.log("getAllCourses response:",i,M),M.code===200?be(M):f.yw.error(M.message);case 13:case"end":return C.stop()}},h)}));return function(){return p.apply(this,arguments)}}(),xe=function(){var p=m()(_()().mark(function h(){var i;return _()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,(0,ce.O7)();case 2:i=A.sent,console.log("getAllCategories response:",i),i.code===200?De(i):f.yw.error(i.message);case 5:case"end":return A.stop()}},h)}));return function(){return p.apply(this,arguments)}}();return(0,d.useEffect)(function(){ie(),xe()},[]),(0,d.useEffect)(function(){ie()},[H,G]),(0,d.useEffect)(function(){console.log("courseResult:",X),s.current.reload()},[X]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(S.Z,{columns:Be,actionRef:s,cardBordered:!0,request:function(){var p=m()(_()().mark(function h(i,M,A){return _()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return console.log("request:",i,M,A),Y(i.current),ae(i.pageSize),B.abrupt("return",Promise.resolve({data:X.data.content,success:!0,total:X.data.totalElements}));case 4:case"end":return B.stop()}},h)}));return function(h,i,M){return p.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:G,showQuickJumper:!0,onChange:function(h){console.log("page:",h)}},dateFormatter:"string",headerTitle:"\u8BFE\u7A0B",toolBarRender:function(){return[(0,u.jsxs)(I.ZP,{type:"primary",onClick:Se,children:[(0,u.jsx)(U.Z,{}),b.formatMessage({id:"create",defaultMessage:"Create"})]})]}}),(0,u.jsx)(de,{isEdit:Q,course:he,open:Me,onClose:re,onSubmit:Ue}),Pe]})},pe=me,Fe=r.Z.Sider,fe=r.Z.Content,ge=function(){var b=(0,j.Z)(),D=b.contentStyle;return(0,u.jsx)(r.Z,{children:(0,u.jsx)(r.Z,{children:(0,u.jsx)(fe,{style:D,children:(0,u.jsx)(pe,{})})})})},ve=ge},89102:function(Z,R,e){e.d(R,{v:function(){return o}});var j=e(19632),r=e.n(j),d=e(97857),n=e.n(d),_=e(85615),l=e(73445),m=e(782),c=e(71381),o=(0,l.Ue)()((0,m.mW)((0,m.tJ)((0,c.n)(function(v,P){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:""},setCategoryResult:function(U){var S=y(U),w={uid:"all",name:"All"},I=n()(n()({},U),{},{data:{content:[w].concat(r()(U.data.content))}}),F=f(I);v({categoryResult:I,categoryTreeOptions:F,categorySelectOptions:S})},setCurrentCategoryUid:function(U){var S=P().categoryResult.data.content.find(function(w){return w.uid===U});v({currentCategory:S})},deleteCategoryCache:function(){return v({},!0)}}}),{name:_.OM})));function f(v){var P=[];return v.data.content.forEach(function(E){var U={title:E.name,key:E.uid,children:[]};E.children&&Array.isArray(E.children)&&(U.children=E.children.map(function(S){return{title:S.name,key:S.uid,children:[]}})),P.push(U)}),P}function y(v){var P=[];return v.data.content.forEach(function(E){var U={label:E.name,value:E.uid};P.push(U)}),P}},89333:function(Z,R,e){e.d(R,{K:function(){return _}});var j=e(85615),r=e(73445),d=e(782),n=e(71381),_=(0,r.Ue)()((0,d.mW)((0,d.tJ)((0,n.n)(function(l,m){return{courseResult:{data:{content:[]}},insertCourseResult:function(o){l(function(f){var y=f.courseResult.data.content;y.unshift(o)})},updateCourseResult:function(o){l(function(f){var y=f.courseResult.data.content,v=y.findIndex(function(P){return P.uid===o.uid});v!==-1?y[v]=o:console.warn("Course with uid ".concat(o.uid," not found."))})},deleteCourseResult:function(o){l(function(f){var y=f.courseResult.data.content,v=y.findIndex(function(P){return P.uid===o.uid});v!==-1?y.splice(v,1):console.warn("Course with uid ".concat(o.uid," not found."))})},setCourseResult:function(o){l({courseResult:o})},deleteCourseCache:function(){return l({},!0)}}}),{name:j.vC})))},60247:function(Z,R,e){e.d(R,{L:function(){return _}});var j=e(85615),r=e(73445),d=e(782),n=e(71381),_=(0,r.Ue)()((0,d.mW)((0,d.tJ)((0,n.n)(function(l,m){return{userInfo:{uid:""},deviceUid:"",setUserInfo:function(o){l({userInfo:o})},setDeviceUid:function(o){l({deviceUid:o})},deleteUserInfo:function(){return l({},!0)}}}),{name:j.Em})))}}]);
