"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[5131],{4499:function(e,n,t){var r=t(42601),a=t(17082),i=t(73457),o=t(46015),u=t(16309),c=t(98036),l=t(36490),s=t(44194),d=t(87413),p=t(31549),f=["fieldProps","proFieldProps"],m=["fieldProps","proFieldProps"],h="text",v=function(e){var n=(0,o.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),t=(0,r.Z)(n,2),i=t[0],l=t[1];return(0,p.jsx)(u.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(n){var t,r=n.getFieldValue(e.name||[]);return(0,p.jsx)(c.Z,(0,a.Z)((0,a.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return l(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(t=e.statusRender)||void 0===t?void 0:t.call(e,r),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:i,children:e.children}))}})},g=function(e){var n=e.fieldProps,t=e.proFieldProps,r=(0,i.Z)(e,f);return(0,p.jsx)(d.Z,(0,a.Z)({valueType:h,fieldProps:n,filedConfig:{valueType:h},proFieldProps:t},r))};g.Password=function(e){var n=e.fieldProps,t=e.proFieldProps,o=(0,i.Z)(e,m),u=(0,s.useState)(!1),c=(0,r.Z)(u,2),f=c[0],g=c[1];return null!=n&&n.statusRender&&o.name?(0,p.jsx)(v,{name:o.name,statusRender:null==n?void 0:n.statusRender,popoverProps:null==n?void 0:n.popoverProps,strengthText:null==n?void 0:n.strengthText,open:f,onOpenChange:g,children:(0,p.jsx)("div",{children:(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:(0,a.Z)((0,a.Z)({},(0,l.Z)(n,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var t;null==n||null===(t=n.onBlur)||void 0===t||t.call(n,e),g(!1)},onClick:function(e){var t;null==n||null===(t=n.onClick)||void 0===t||t.call(n,e),g(!0)}}),proFieldProps:t,filedConfig:{valueType:h}},o))})}):(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:n,proFieldProps:t,filedConfig:{valueType:h}},o))},g.displayName="ProFormComponent",n.Z=g},78413:function(e,n,t){t.r(n),t.d(n,{default:function(){return tn}});var r=t(96865),a=t(75574),i=t(45332),o=t.n(i),u=t(23864),c=t(73193),l=t.n(c),s=t(76711),d=t.n(s),p=t(55735),f=t(44435),m=t(83642),h=t(83890),v=(0,f.Ue)()((0,m.mW)((0,m.tJ)((0,h.n)((function(e,n){return{llmproviderResult:{data:{content:[]}},currentChannel:{name:"web",nickname:"网站/H5"},currentType:p.aZD,insertChannel:function(n){e((function(e){e.llmproviderResult.data.content.unshift(n)}))},setChannelResult:function(t){e({llmproviderResult:t});var r,a=n().currentChannel;""!==a.uid&&void 0!==a||(null===(r=t.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentChannel:t.data.content[0]})},setCurrentChannel:function(t){var r=n().llmproviderResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));if(-1!==a){var i=[].concat(d()(r.slice(0,a)),[t],d()(r.slice(a+1))),o=l()(l()({},n().llmproviderResult),{},{data:{content:i}});e({llmproviderResult:o,currentChannel:t})}else e({currentChannel:t})},setCurrentType:function(n){e({currentType:n})},deleteCurrentChannel:function(t){var r=n().llmproviderResult.data.content,a=r.findIndex((function(e){return e.uid===t}));-1!==a?e({llmproviderResult:l()(l()({},n().llmproviderResult),{},{data:{content:[].concat(d()(r.slice(0,a)),d()(r.slice(a+1)))}})}):console.warn("Channel not found in cache:",t),n().currentChannel.uid===t&&e({currentChannel:{uid:""}})},deleteChannelCache:function(){return e({},!0)}}})),{name:p.uCV}))),g=t(9452),x=t(44194),y=t(31549),w=[{name:"web",nickname:"网站/H5"},{name:"react",nickname:"React"},{name:"vue",nickname:"Vue"},{name:"svelte",nickname:"Svelte"},{name:"vanilla",nickname:"Vanilla"},{name:"ios",nickname:"iOS"},{name:"android",nickname:"安卓"},{name:"uniapp",nickname:"Uniapp"},{name:"flutter",nickname:"Flutter"},{name:"wechat-mp",nickname:"微信公众号"},{name:"wechat-mini",nickname:"微信小程序"},{name:"wechat-work",nickname:"企业微信"},{name:"wechat-kefu",nickname:"微信客服"},{name:"douyin",nickname:"抖音"},{name:"xiaohongshu",nickname:"小红书"},{name:"baidu",nickname:"百度"},{name:"weibo",nickname:"微博"},{name:"bilibili",nickname:"哔哩哔哩"},{name:"zhihu",nickname:"知乎"},{name:"pdd",nickname:"拼多多"},{name:"jd",nickname:"京东"},{name:"qianniu",nickname:"千牛"},{name:"doudian",nickname:"抖店"},{name:"whatsapp",nickname:"Whatsapp"},{name:"telegram",nickname:"Telegram"},{name:"facebook",nickname:"Facebook"},{name:"instagram",nickname:"Instagram"},{name:"line",nickname:"Line"},{name:"wordpress",nickname:"Wordpress"},{name:"shopify",nickname:"Shopify"},{name:"lazada",nickname:"Lazada"},{name:"woocommerce",nickname:"Woocommerce"},{name:"opencart",nickname:"Opencart"},{name:"magento",nickname:"Magento"},{name:"prestashop",nickname:"Prestashop"}],j=function(){var e=(0,u.Z)().isDarkMode,n=(0,x.useState)([]),t=o()(n,2),r=t[0],a=t[1],i=v((function(e){return{currentChannel:e.currentChannel,setCurrentChannel:e.setCurrentChannel}})),c=i.currentChannel,l=i.setCurrentChannel;return(0,x.useEffect)((function(){var e=[].concat(w);a(e)}),[]),(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(g.Z,{itemLayout:"horizontal",dataSource:r,renderItem:function(n,t){return(0,y.jsx)(g.Z.Item,{style:(null==c?void 0:c.name)===n.name?{backgroundColor:e?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){l(n)},children:(0,y.jsx)(g.Z.Item.Meta,{title:(0,y.jsx)("div",{style:{marginLeft:10},children:n.nickname})})})}})})},M=t(8247),Z=t(90819),k=t.n(Z),C=t(89933),b=t.n(C),W=t(86803),R=t(24170),S=t(72614),T=t(76750),P=t(1902),I=t(40612),A=t(95490),E=t(67402),F=t(38775),O=t(32327),U=t(13161),z=t(79176),N=t(21325),q=t(53300),D=t(36378),L=t(11452),V=t(44574),K=t(75262),B=t(10354),$=t(51103),G=t(29897),_=t(76432),J=t(6897),X=t(62476),H=t(15025),Q=O.Z.Title,Y=O.Z.Text,ee=function(e){var n=e.channel,t=((0,x.useRef)(!1),(0,T.Z)().translateString),r=v((function(e){return{currentType:e.currentType,setCurrentType:e.setCurrentType}})),a=r.currentType,i=r.setCurrentType,u=(0,I.u)((function(e){return e.currentOrg})),c=[{label:"一对一",value:p.Njn},{label:"技能组",value:p.aZD}],l=(0,P.E)((function(e){return{agentResult:e.agentResult,currentAgent:e.currentAgent,setAgentResult:e.setAgentResult,setCurrentAgent:e.setCurrentAgent}})),s=l.agentResult,d=l.currentAgent,f=l.setAgentResult,m=l.setCurrentAgent,h=(0,x.useState)([]),g=o()(h,2),w=g[0],j=g[1],M=(0,A.$)((function(e){return{workgroupResult:e.workgroupResult,currentWorkgroup:e.currentWorkgroup,setWorkgroupResult:e.setWorkgroupResult,setCurrentWorkgroup:e.setCurrentWorkgroup}})),Z=M.workgroupResult,C=M.currentWorkgroup,O=M.setWorkgroupResult,ee=M.setCurrentWorkgroup,ne=(0,x.useState)(null==d?void 0:d.uid),te=o()(ne,2),re=te[0],ae=te[1],ie=(0,x.useState)(null==C?void 0:C.uid),oe=o()(ie,2),ue=oe[0],ce=oe[1],le=(0,x.useState)([]),se=o()(le,2),de=se[0],pe=se[1],fe=function(){var e=b()(k()().mark((function e(){var n,r,a;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W.yw.loading("loading"),n={pageNumber:0,pageSize:50,orgUid:null==u?void 0:u.uid},e.next=4,(0,R._t)(n);case 4:r=e.sent,console.log("queryAgentsByOrg: ",r),200===r.code?(W.yw.destroy(),f(r),r.data.content.length>0&&(m(r.data.content[0]),ae(r.data.content[0].uid)),a=[],r.data.content.forEach((function(e){var n={label:t(e.nickname),value:e.uid};a.push(n)})),j(a)):(W.yw.destroy(),W.yw.error(r.message));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=b()(k()().mark((function e(){var n,r,a;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W.yw.loading("loading"),n={pageNumber:0,pageSize:50,orgUid:null==u?void 0:u.uid},e.next=4,(0,S.u7)(n);case 4:r=e.sent,console.log("getWorkgroups",r),200===r.code?(W.yw.destroy(),O(r),r.data.content.length>0&&(ee(r.data.content[0]),ce(r.data.content[0].uid)),a=[],r.data.content.forEach((function(e){var n={label:t(e.nickname),value:e.uid};a.push(n)})),pe(a)):(W.yw.destroy(),W.yw.error(r.message));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,x.useEffect)((function(){fe(),me()}),[a]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(E.ZP.Group,{onChange:function(e){console.log("radio type checked:".concat(e.target.value)),i(e.target.value)},options:c,defaultValue:a,optionType:"button",buttonStyle:"solid"}),(0,y.jsx)("br",{}),(0,y.jsx)("br",{}),a===p.Njn&&(null==d?void 0:d.uid)&&(0,y.jsx)(E.ZP.Group,{onChange:function(e){console.log("radio agent checked:".concat(e.target.value));var n=s.data.content.find((function(n){return n.uid===e.target.value}));m(n)},options:w,defaultValue:re,optionType:"button",buttonStyle:"solid"}),a===p.aZD&&(null==d?void 0:d.uid)&&(0,y.jsx)(E.ZP.Group,{onChange:function(e){console.log("radio workgroup checked:".concat(e.target.value));var n=Z.data.content.find((function(n){return n.uid===e.target.value}));ee(n)},options:de,defaultValue:ue,optionType:"button",buttonStyle:"solid"}),(0,y.jsx)(F.Z,{}),(0,y.jsx)(Q,{level:5,children:"组织orgUid"}),(0,y.jsx)(Y,{code:!0,copyable:!0,children:null==u?void 0:u.uid}),(0,y.jsx)(Q,{level:5,children:"一对一当前客服Uid"}),(0,y.jsx)(Y,{code:!0,copyable:!0,children:null==d?void 0:d.uid}),(0,y.jsx)(Q,{level:5,children:"当前技能组Uid"}),(0,y.jsx)(Y,{code:!0,copyable:!0,children:null==C?void 0:C.uid}),(0,y.jsx)(F.Z,{}),"douyin"===(null==n?void 0:n.name)&&(0,y.jsx)(U.Z,{}),"xiaohongshu"===(null==n?void 0:n.name)&&(0,y.jsx)(z.Z,{}),"baidu"===(null==n?void 0:n.name)&&(0,y.jsx)(N.Z,{}),"weibo"===(null==n?void 0:n.name)&&(0,y.jsx)(q.Z,{}),"bilibili"===(null==n?void 0:n.name)&&(0,y.jsx)(D.Z,{}),"zhihu"===(null==n?void 0:n.name)&&(0,y.jsx)(L.Z,{}),"pdd"===(null==n?void 0:n.name)&&(0,y.jsx)(V.Z,{}),"jd"===(null==n?void 0:n.name)&&(0,y.jsx)(K.Z,{}),"qianniu"===(null==n?void 0:n.name)&&(0,y.jsx)(B.Z,{}),"doudian"===(null==n?void 0:n.name)&&(0,y.jsx)($.Z,{}),"whatsapp"===(null==n?void 0:n.name)&&(0,y.jsx)(G.Z,{}),"telegram"===(null==n?void 0:n.name)&&(0,y.jsx)(_.Z,{}),"line"===(null==n?void 0:n.name)&&(0,y.jsx)(J.Z,{}),"shopify"===(null==n?void 0:n.name)&&(0,y.jsx)(X.Z,{}),"lazada"===(null==n?void 0:n.name)&&(0,y.jsx)(H.Z,{})]})},ne=t(7785),te=t(54518),re=t(45178),ae=t(42909),ie=t(81360),oe=t(5724),ue=t(99980),ce=t(66329),le=t(30634),se=function(e){var n=e.channel;return(0,y.jsxs)(y.Fragment,{children:["web"===(null==n?void 0:n.name)&&(0,y.jsx)(le.Z,{type:p.aZD}),"react"===(null==n?void 0:n.name)&&(0,y.jsx)(ae.Z,{type:n.name}),"vue"===(null==n?void 0:n.name)&&(0,y.jsx)(ce.Z,{type:n.name}),"angular"===(null==n?void 0:n.name)&&(0,y.jsx)(ae.Z,{type:n.name}),"svelte"===(null==n?void 0:n.name)&&(0,y.jsx)(ie.Z,{type:n.name}),"vanilla"===(null==n?void 0:n.name)&&(0,y.jsx)(ue.Z,{type:n.name}),"ios"===(null==n?void 0:n.name)&&(0,y.jsx)(re.Z,{type:n.name}),"android"===(null==n?void 0:n.name)&&(0,y.jsx)(ne.Z,{type:n.name}),"uniapp"===(null==n?void 0:n.name)&&(0,y.jsx)(oe.Z,{type:n.name}),"flutter"===(null==n?void 0:n.name)&&(0,y.jsx)(te.Z,{type:n.name})]})},de=t(79686),pe=t(40803),fe=(0,f.Ue)()((0,m.mW)((0,m.tJ)((0,h.n)((function(e,n){return{wechatMpResult:{data:{content:[]}},currentWechatMp:{uid:"",nickname:"",avatar:"",description:""},insertWechatMp:function(n){e((function(e){e.wechatMpResult.data.content.unshift(n)}))},updateWechatMp:function(n){e((function(e){var t=e.wechatMpResult.data.content,r=t.findIndex((function(e){return e.uid===n.uid}));-1!==r?t[r]=n:console.warn("WechatMp with uid ".concat(n.uid," not found."))}))},deleteWechatMp:function(n){e((function(e){var t=e.wechatMpResult.data.content,r=t.findIndex((function(e){return e.uid===n.uid}));-1!==r?t.splice(r,1):console.warn("WechatMp with uid ".concat(n.uid," not found."))}))},setWechatMpResult:function(t){var r;(e({wechatMpResult:t}),""===n().currentWechatMp.uid)&&((null===(r=t.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentWechatMp:t.data.content[0]}))},setCurrentWechatMp:function(t){var r=n().wechatMpResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));if(-1!==a){var i=[].concat(d()(r.slice(0,a)),[t],d()(r.slice(a+1))),o=l()(l()({},n().wechatMpResult),{},{data:{content:i}});e({wechatMpResult:o,currentWechatMp:t})}else console.warn("WechatMp with the specified uid not found."),e({currentWechatMp:t})},deleteCurrentWechatMp:function(t){var r=n().wechatMpResult.data.content,a=r.findIndex((function(e){return e.uid===t}));-1!==a?e({wechatMpResult:l()(l()({},n().wechatMpResult),{},{data:{content:[].concat(d()(r.slice(0,a)),d()(r.slice(a+1)))}})}):console.warn("WechatMp not found in cache:",t),n().currentWechatMp.uid===t&&e({currentWechatMp:{uid:""}})},deleteWechatMpCache:function(){return e({},!0)}}})),{name:p._SZ}))),me=t(15722),he=t(82669),ve=t(30921),ge=t(53530),xe=t(27487),ye=t(75365),we=t(63289),je=function(){var e=(0,ve.useIntl)(),n=(0,x.useRef)(!1),t=(0,T.Z)().translateStringTranct,r=(0,u.Z)().isDarkMode,a=(0,x.useState)(!1),i=o()(a,2),c=i[0],l=i[1],s=(0,x.useState)(!1),d=o()(s,2),p=d[0],f=d[1],m=(0,I.u)((function(e){return e.currentOrg})),h=fe((function(e){return{wechatMpResult:e.wechatMpResult,currentWechatMp:e.currentWechatMp,setWechatMpResult:e.setWechatMpResult,insertWechatMp:e.insertWechatMp,setCurrentWechatMp:e.setCurrentWechatMp,deleteCurrentWechatMp:e.deleteCurrentWechatMp}})),v=h.wechatMpResult,w=h.currentWechatMp,j=h.setWechatMpResult,M=h.insertWechatMp,Z=h.setCurrentWechatMp,C=h.deleteCurrentWechatMp,R=ge.Z.useModal(),S=o()(R,2),P=S[0],A=S[1],E=function(){var n=b()(k()().mark((function n(t){var r;return k()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("delete wechatMp",t),W.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),n.next=4,(0,pe.ul)(t);case 4:r=n.sent,console.log("delete wechatMp response",r),200===r.code?(W.yw.destroy(),W.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),C(t.uid)):(W.yw.destroy(),W.yw.error(r.message));case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F=function(){var e=b()(k()().mark((function e(){var t,r;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.current){e.next=3;break}return console.log("isLoading: 1",n.current),e.abrupt("return");case 3:return n.current=!0,W.yw.loading("loading"),t={pageNumber:0,pageSize:50,orgUid:null==m?void 0:m.uid},e.next=8,(0,pe.aq)(t);case 8:r=e.sent,console.log("getWechatMps",r),200===r.code?(W.yw.destroy(),j(r)):(W.yw.destroy(),W.yw.error(r.message)),n.current=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,x.useEffect)((function(){F()}),[]);var O=function(){var e=b()(k()().mark((function e(n){var t;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,pe._Z)(n);case 2:t=e.sent,console.log("handleCreateWechatMp response:",t),200===t.code?(M(t.data),l(!1)):W.yw.error(t.message);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),U=function(){var e=b()(k()().mark((function e(n){var t;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.uid=null==w?void 0:w.uid,e.next=3,(0,pe.sS)(n);case 3:t=e.sent,console.log("handleUpdateWechatMp response:",t),200===t.code?(Z(t.data),l(!1)):W.yw.error(t.message);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(xe.Z,{style:{margin:10},gap:"small",align:"flex-start",children:[(0,y.jsx)(ye.ZP,{size:"small",type:"primary",icon:(0,y.jsx)(he.Z,{}),onClick:function(){l(!0),f(!1)},children:e.formatMessage({id:"bind",defaultMessage:"Bind"})}),(0,y.jsx)(ye.ZP,{size:"small",onClick:function(){f(!0),l(!0)},disabled:w&&""===w.uid,children:e.formatMessage({id:"edit",defaultMessage:"Edit"})}),(0,y.jsx)(ye.ZP,{size:"small",danger:!0,onClick:function(){return n=w,void P.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,y.jsx)(me.Z,{}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(n.name,"】？"),onOk:function(){E(n)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})});var n},disabled:w&&""===w.uid,children:e.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,y.jsx)(g.Z,{itemLayout:"horizontal",dataSource:v.data.content,renderItem:function(e,n){return(0,y.jsx)(g.Z.Item,{style:w.uid===e.uid?{backgroundColor:r?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){Z(e)},children:(0,y.jsx)(g.Z.Item.Meta,{style:{marginLeft:"10px"},title:(0,y.jsx)(y.Fragment,{children:t(e.name)}),description:t(e.description)})})}}),c&&(0,y.jsx)(we.Z,{isEdit:p,open:c,wechatmp:w,onClose:function(){l(!1)},onSubmit:function(e){console.log("onDrawerSubmit:",e),p?U(e):O(e)}}),A]})},Me=function(){var e=fe((function(e){return{currentWechatMp:e.currentWechatMp}})).currentWechatMp;return(0,y.jsx)(y.Fragment,{children:""!==(null==e?void 0:e.uid)&&(0,y.jsxs)("div",{className:"flex items-center justify-end",children:[(0,y.jsxs)("p",{children:["URL: ",e.url,(0,y.jsx)(ye.ZP,{onClick:function(){navigator.clipboard.writeText(null==e?void 0:e.url),W.yw.success("URL已复制")},children:"复制"})]}),(0,y.jsxs)("p",{children:["Token: ",e.token,(0,y.jsx)(ye.ZP,{onClick:function(){navigator.clipboard.writeText(null==e?void 0:e.token),W.yw.success("Token已复制")},children:"复制"})]})]})})},Ze=function(e){console.log(e)},ke=[{key:"agent",label:"客服管理",children:(0,y.jsx)(Me,{})}],Ce=function(){var e=(0,x.useState)([]),n=o()(e,2),t=n[0],r=n[1];return(0,x.useEffect)((function(){var e=[].concat(ke);r(e)}),[]),(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(M.Z,{defaultActiveKey:"agent",items:t,onChange:Ze})})},be=a.Z.Sider,We=a.Z.Content,Re=function(){var e=(0,r.Z)(),n=e.leftSiderStyle,t=e.leftSiderWidth;return(0,y.jsxs)(a.Z,{children:[(0,y.jsx)(be,{width:t,style:n,children:(0,y.jsx)(je,{})}),(0,y.jsx)(a.Z,{children:(0,y.jsx)(We,{children:(0,y.jsx)(Ce,{})})})]})};function Se(e){return Te.apply(this,arguments)}function Te(){return(Te=b()(k()().mark((function e(n){return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,ve.request)("/api/v1/wechat/mini/create",{method:"POST",data:l()(l()({},n),{},{client:p.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e){return Ie.apply(this,arguments)}function Ie(){return(Ie=b()(k()().mark((function e(n){return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,ve.request)("/api/v1/wechat/mini/update",{method:"POST",data:l()(l()({},n),{},{client:p.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=b()(k()().mark((function e(n){return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,ve.request)("/api/v1/wechat/mini/delete",{method:"POST",data:l()(l()({},n),{},{client:p.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=b()(k()().mark((function e(n){return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,ve.request)("/api/v1/wechat/mini/query/org",{method:"GET",params:l()(l()({},n),{},{client:p.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue=(0,f.Ue)()((0,m.mW)((0,m.tJ)((0,h.n)((function(e,n){return{wechatMiniResult:{data:{content:[]}},currentWechatMini:{uid:"",nickname:"",avatar:"",description:""},insertWechatMini:function(n){e((function(e){e.wechatMiniResult.data.content.unshift(n)}))},updateWechatMini:function(n){e((function(e){var t=e.wechatMiniResult.data.content,r=t.findIndex((function(e){return e.uid===n.uid}));-1!==r?t[r]=n:console.warn("WechatMini with uid ".concat(n.uid," not found."))}))},deleteWechatMini:function(n){e((function(e){var t=e.wechatMiniResult.data.content,r=t.findIndex((function(e){return e.uid===n.uid}));-1!==r?t.splice(r,1):console.warn("WechatMini with uid ".concat(n.uid," not found."))}))},setWechatMiniResult:function(t){var r;(e({wechatMiniResult:t}),""===n().currentWechatMini.uid)&&((null===(r=t.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentWechatMini:t.data.content[0]}))},setCurrentWechatMini:function(t){var r=n().wechatMiniResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));if(-1!==a){var i=[].concat(d()(r.slice(0,a)),[t],d()(r.slice(a+1))),o=l()(l()({},n().wechatMiniResult),{},{data:{content:i}});e({wechatMiniResult:o,currentWechatMini:t})}else console.warn("WechatMini with the specified uid not found."),e({currentWechatMini:t})},deleteCurrentWechatMini:function(t){var r=n().wechatMiniResult.data.content,a=r.findIndex((function(e){return e.uid===t}));-1!==a?e({wechatMiniResult:l()(l()({},n().wechatMiniResult),{},{data:{content:[].concat(d()(r.slice(0,a)),d()(r.slice(a+1)))}})}):console.warn("WechatMini not found in cache:",t),n().currentWechatMini.uid===t&&e({currentWechatMini:{uid:""}})},deleteWechatMiniCache:function(){return e({},!0)}}})),{name:p.I5N}))),ze=t(69169),Ne=t(4499),qe=t(84881),De=t(73442),Le=t(3849),Ve=function(e){var n,t=e.isEdit,r=e.wechatmini,a=e.open,i=e.onClose,u=e.onSubmit,c=ze.A.useForm(),s=o()(c,1)[0],d=(0,T.Z)().translateStringTranct,p=(0,I.u)((function(e){return e.currentOrg})),f=(0,A.$)((function(e){return{workgroupResult:e.workgroupResult,setWorkgroupResult:e.setWorkgroupResult}})),m=f.workgroupResult,h=f.setWorkgroupResult;(0,x.useEffect)((function(){t?s.setFieldsValue({name:null==r?void 0:r.name,appId:null==r?void 0:r.appId,appSecret:null==r?void 0:r.appSecret,encodingAesKey:null==r?void 0:r.encodingAesKey,encryptMode:null==r?void 0:r.encryptMode,dataType:null==r?void 0:r.dataType,workgroupUid:null==r?void 0:r.workgroupUid}):s.setFieldsValue({name:"",appId:"",appSecret:"",encodingAesKey:"",encryptMode:"PLAINTEXT",dataType:"xml",workgroupUid:""})}),[t,r,s]);var v=function(){var e=b()(k()().mark((function e(){var n,t;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W.yw.loading("loading"),n={pageNumber:0,pageSize:50,orgUid:null==p?void 0:p.uid},e.next=4,(0,S.u7)(n);case 4:t=e.sent,console.log("getWorkgroups",t),200===t.code?(W.yw.destroy(),h(t)):(W.yw.destroy(),W.yw.error(t.message));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,x.useEffect)((function(){v()}),[]);return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(De.Z,{title:"微信小程序",onClose:i,open:a,children:(0,y.jsxs)(ze.A,{form:s,name:"wechatMiniForm",onFinish:function(){console.log("handleSubmit"),s.validateFields().then((function(e){var n=l()(l()({},e),{},{orgUid:null==p?void 0:p.uid});console.log("submit",n),u(n)}))},children:[(0,y.jsx)(Ne.Z,{label:"名称",name:"name",rules:[{required:!0}]}),(0,y.jsx)(Ne.Z,{label:"appId",name:"appId",rules:[{required:!0}]}),(0,y.jsx)(Ne.Z,{label:"appSecret",name:"appSecret",rules:[{required:!0}]}),(0,y.jsx)(Ne.Z,{label:"EncodingAESKey",name:"encodingAesKey",rules:[{required:!0}]}),(0,y.jsxs)(Le.Z,{children:[(0,y.jsx)(ye.ZP,{onClick:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",t=0;t<43;t++){var r=Math.floor(Math.random()*e.length);n+=e.charAt(r)}s.setFieldsValue({encodingAesKey:n})},children:"随机生成"}),(0,y.jsx)(ye.ZP,{onClick:function(){var e=s.getFieldValue("encodingAesKey");if(e){var n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),W.yw.success("已复制到剪切板")}},children:"复制"})]}),(0,y.jsx)(qe.Z,{label:"消息加解密方式",name:"encryptMode",options:[{label:"明文模式",value:"PLAINTEXT"},{label:"兼容模式",value:"COMPATIBLE"},{label:"安全模式",value:"SAFE"}],fieldProps:{defaultValue:"PLAINTEXT",allowClear:!0},rules:[{required:!0}]}),(0,y.jsx)(Ne.Z,{label:"数据格式",name:"dataType",rules:[{required:!0}],disabled:!0}),(0,y.jsx)(qe.Z,{label:"客服技能组",name:"workgroupUid",options:null==m||null===(n=m.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.map((function(e){return{label:d(e.nickname),value:e.uid}})),fieldProps:{allowClear:!0},rules:[{required:!0}]}),(0,y.jsx)("p",{children:"注：微信公众号-》设置与开发-》开发接口管理-》基本设置 获取相关信息"})]})})})},Ke=function(){var e=(0,ve.useIntl)(),n=(0,x.useRef)(!1),t=(0,T.Z)().translateStringTranct,r=(0,u.Z)().isDarkMode,a=(0,x.useState)(!1),i=o()(a,2),c=i[0],l=i[1],s=(0,x.useState)(!1),d=o()(s,2),p=d[0],f=d[1],m=(0,I.u)((function(e){return e.currentOrg})),h=Ue((function(e){return{wechatMiniResult:e.wechatMiniResult,currentWechatMini:e.currentWechatMini,setWechatMiniResult:e.setWechatMiniResult,insertWechatMini:e.insertWechatMini,setCurrentWechatMini:e.setCurrentWechatMini,deleteCurrentWechatMini:e.deleteCurrentWechatMini}})),v=h.wechatMiniResult,w=h.currentWechatMini,j=h.setWechatMiniResult,M=h.insertWechatMini,Z=h.setCurrentWechatMini,C=h.deleteCurrentWechatMini,R=ge.Z.useModal(),S=o()(R,2),P=S[0],A=S[1],E=function(){var n=b()(k()().mark((function n(t){var r;return k()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("delete wechatMini",t),W.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),n.next=4,Ae(t);case 4:r=n.sent,console.log("delete wechatMini response",r),200===r.code?(W.yw.destroy(),W.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),C(t.uid)):(W.yw.destroy(),W.yw.error(r.message));case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F=function(){var e=b()(k()().mark((function e(){var t,r;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.current){e.next=3;break}return console.log("isLoading: 1",n.current),e.abrupt("return");case 3:return n.current=!0,W.yw.loading("loading"),t={pageNumber:0,pageSize:50,orgUid:null==m?void 0:m.uid},e.next=8,Fe(t);case 8:r=e.sent,console.log("getWechatMinis",r),200===r.code?(W.yw.destroy(),j(r)):(W.yw.destroy(),W.yw.error(r.message)),n.current=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,x.useEffect)((function(){F()}),[]);var O=function(){var e=b()(k()().mark((function e(n){var t;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se(n);case 2:t=e.sent,console.log("handleCreateWechatMini response:",t),200===t.code?(M(t.data),l(!1)):W.yw.error(t.message);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),U=function(){var e=b()(k()().mark((function e(n){var t;return k()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.uid=null==w?void 0:w.uid,e.next=3,Pe(n);case 3:t=e.sent,console.log("handleUpdateWechatMini response:",t),200===t.code?(Z(t.data),l(!1)):W.yw.error(t.message);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(xe.Z,{style:{margin:10},gap:"small",align:"flex-start",children:[(0,y.jsx)(ye.ZP,{size:"small",type:"primary",icon:(0,y.jsx)(he.Z,{}),onClick:function(){l(!0),f(!1)},children:e.formatMessage({id:"bind",defaultMessage:"Bind"})}),(0,y.jsx)(ye.ZP,{size:"small",onClick:function(){f(!0),l(!0)},disabled:w&&""===w.uid,children:e.formatMessage({id:"edit",defaultMessage:"Edit"})}),(0,y.jsx)(ye.ZP,{size:"small",danger:!0,onClick:function(){return n=w,void P.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,y.jsx)(me.Z,{}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(n.name,"】？"),onOk:function(){E(n)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})});var n},disabled:w&&""===w.uid,children:e.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,y.jsx)(g.Z,{itemLayout:"horizontal",dataSource:v.data.content,renderItem:function(e,n){return(0,y.jsx)(g.Z.Item,{style:w.uid===e.uid?{backgroundColor:r?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){Z(e)},children:(0,y.jsx)(g.Z.Item.Meta,{style:{marginLeft:"10px"},title:(0,y.jsx)(y.Fragment,{children:t(e.name)}),description:t(e.description)})})}}),c&&(0,y.jsx)(Ve,{isEdit:p,open:c,wechatmini:w,onClose:function(){l(!1)},onSubmit:function(e){console.log("onDrawerSubmit:",e),p?U(e):O(e)}}),A]})},Be=function(){var e=Ue((function(e){return{currentWechatMini:e.currentWechatMini}})).currentWechatMini;return(0,y.jsx)(y.Fragment,{children:""!==(null==e?void 0:e.uid)&&(0,y.jsxs)("div",{className:"flex items-center justify-end",children:[(0,y.jsxs)("p",{children:["URL: ",e.url,(0,y.jsx)(ye.ZP,{onClick:function(){navigator.clipboard.writeText(null==e?void 0:e.url),W.yw.success("URL已复制")},children:"复制"})]}),(0,y.jsxs)("p",{className:"ml-2",children:["Token: ",e.token,(0,y.jsx)(ye.ZP,{onClick:function(){navigator.clipboard.writeText(null==e?void 0:e.token),W.yw.success("Token已复制")},children:"复制"})]})]})})},$e=function(e){console.log(e)},Ge=[{key:"agent",label:"客服管理",children:(0,y.jsx)(Be,{})}],_e=function(){var e=(0,x.useState)([]),n=o()(e,2),t=n[0],r=n[1];return(0,x.useEffect)((function(){var e=[].concat(Ge);r(e)}),[]),(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(M.Z,{defaultActiveKey:"agent",items:t,onChange:$e})})},Je=a.Z.Sider,Xe=a.Z.Content,He=function(){var e=(0,r.Z)(),n=e.leftSiderStyle,t=e.leftSiderWidth;return(0,y.jsxs)(a.Z,{children:[(0,y.jsx)(Je,{width:t,style:n,children:(0,y.jsx)(Ke,{})}),(0,y.jsx)(a.Z,{children:(0,y.jsx)(Xe,{children:(0,y.jsx)(_e,{})})})]})},Qe=function(e){var n=e.channel,t=(0,x.useState)([]),r=o()(t,2),a=r[0],i=r[1],u=(0,x.useState)(!0),c=o()(u,2),l=c[0],s=c[1];return(0,x.useEffect)((function(){var e=[];"web"===(null==n?void 0:n.name)||"react"===(null==n?void 0:n.name)||"vue"===(null==n?void 0:n.name)||"angular"===(null==n?void 0:n.name)||"svelte"===(null==n?void 0:n.name)||"vanilla"===(null==n?void 0:n.name)||"ios"===(null==n?void 0:n.name)||"android"===(null==n?void 0:n.name)||"flutter"===(null==n?void 0:n.name)||"uniapp"===(null==n?void 0:n.name)?(s(!0),e.push({key:"info",label:"基本信息",children:(0,y.jsx)(ee,{channel:n})},{key:"code",label:"客服代码",children:(0,y.jsx)(se,{channel:n})})):s(!1),i(e)}),[n]),(0,y.jsxs)("div",{style:{padding:"0 24px"},children:[l&&(0,y.jsx)(M.Z,{defaultActiveKey:"info",items:a}),"wechat-mp"===(null==n?void 0:n.name)&&(0,y.jsx)(Re,{}),"wechat-mini"===(null==n?void 0:n.name)&&(0,y.jsx)(He,{}),"wechat-work"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"wechat-kefu"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"douyin"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"xiaohongshu"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"baidu"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"weibo"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"bilibili"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"zhihu"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"pdd"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"jd"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"qianniu"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"doudian"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"whatsapp"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"telegram"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"facebook"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"line"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"shopify"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"lazada"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"wordpress"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"woocommerce"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"opencart"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"magento"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{}),"prestashop"===(null==n?void 0:n.name)&&(0,y.jsx)(de.Z,{})]})},Ye=function(){var e=(0,x.useState)(""),n=o()(e,2),t=n[0],r=n[1],a=(0,x.useState)([]),i=o()(a,2),u=i[0],c=i[1],l=v().currentChannel;(0,x.useEffect)((function(){l&&s(l)}),[l]);var s=function(e){var n=e.name;-1===u.findIndex((function(e){return e.key===n}))&&c([].concat(d()(u),[{label:e.nickname,key:n,children:(0,y.jsx)(Qe,{channel:e}),channelInfo:e,closable:!0}])),r(n)};return(0,y.jsx)(M.Z,{hideAdd:!0,onChange:function(e){r(e)},activeKey:t,type:"editable-card",onEdit:function(e,n){"remove"===n&&function(e){var n=u.findIndex((function(n){return n.key===e})),a=u.filter((function(n){return n.key!==e}));if(a.length&&e===t){var i=a[n===a.length?n-1:n].key;r(i)}c(a)}(e)},items:u})},en=a.Z.Sider,nn=a.Z.Content,tn=function(){var e=(0,r.Z)(),n=e.leftSiderStyle,t=e.contentStyle;return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(a.Z,{children:[(0,y.jsx)(en,{style:n,children:(0,y.jsx)(j,{})}),(0,y.jsx)(a.Z,{children:(0,y.jsx)(nn,{style:t,children:(0,y.jsx)(Ye,{})})})]})})}},53530:function(e,n,t){t.d(n,{Z:function(){return j}});var r=t(18960),a=t(31695),i=t(27710),o=t(44194),u=t(51865),c=t.n(u),l=t(24255),s=t(43037),d=t(37167),p=t(30829),f=t(78660),m=t(59348),h=t(6750),v=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};var g=(0,s.i)((e=>{const{prefixCls:n,className:t,closeIcon:r,closable:a,type:i,title:u,children:s,footer:g}=e,x=v(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:y}=o.useContext(d.E_),w=y(),j=n||y("modal"),M=(0,p.Z)(w),[Z,k,C]=(0,h.ZP)(j,M),b=`${j}-confirm`;let W={};return W=i?{closable:null!=a&&a,title:"",footer:"",children:o.createElement(f.O,Object.assign({},e,{prefixCls:j,confirmPrefixCls:b,rootPrefixCls:w,content:s}))}:{closable:null==a||a,title:u,footer:null!==g&&o.createElement(m.$,Object.assign({},e)),children:s},Z(o.createElement(l.s,Object.assign({prefixCls:j,className:c()(k,`${j}-pure-panel`,i&&b,i&&`${b}-${i}`,t,C,M)},x,{closeIcon:(0,m.b)(j,r),closable:a},W)))})),x=t(75807);function y(e){return(0,r.ZP)((0,r.uW)(e))}const w=i.Z;w.useModal=x.Z,w.info=function(e){return(0,r.ZP)((0,r.cw)(e))},w.success=function(e){return(0,r.ZP)((0,r.vq)(e))},w.error=function(e){return(0,r.ZP)((0,r.AQ)(e))},w.warning=y,w.warn=y,w.confirm=function(e){return(0,r.ZP)((0,r.Au)(e))},w.destroyAll=function(){for(;a.Z.length;){const e=a.Z.pop();e&&e()}},w.config=r.ai,w._InternalPanelDoNotUseOrYouWillBeFired=g;var j=w},57181:function(e,n,t){t.d(n,{G:function(){return i}});var r=t(33866),a=function(e){if((0,r.Z)()&&window.document.documentElement){var n=Array.isArray(e)?e:[e],t=window.document.documentElement;return n.some((function(e){return e in t.style}))}return!1};function i(e,n){return Array.isArray(e)||void 0===n?a(e):function(e,n){if(!a(e))return!1;var t=document.createElement("div"),r=t.style[e];return t.style[e]=n,t.style[e]!==r}(e,n)}}}]);