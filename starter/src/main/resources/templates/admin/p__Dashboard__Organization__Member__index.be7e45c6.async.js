"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[557],{995:function(se,W,a){a.r(W),a.d(W,{default:function(){return r}});var b=a(19245),F=a(21612),I=a(67294),p=a(15009),M=a.n(p),x=a(99289),A=a.n(x),B=a(5574),O=a.n(B),P=a(64789),N=a(33277),v=a(8232),w=a(45360),J=a(85576),V=a(83863),D=a(96365),G=a(14726),s=a(85893),R=function(){var u=v.Z.useForm(),f=O()(u,1),i=f[0],j=(0,I.useState)(!1),h=O()(j,2),Q=h[0],$=h[1],g=(0,b.u)(function(c){return{depCurrent:c.depCurrent,depOptions:c.depOptions,createMem:c.createMem,setDepCurrent:c.setDepCurrent}}),E=g.depCurrent,Y=g.depOptions,Z=g.createMem,K=g.setDepCurrent,q=function(){$(!0)},_=function(){var c=A()(M()().mark(function y(){var S,T,C,ne,ae,z,le,ue;return M()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(S=i.getFieldValue("jobNo"),T=i.getFieldValue("realname"),C=i.getFieldValue("seatNo"),ne=i.getFieldValue("telephone"),ae=i.getFieldValue("mobile"),z=i.getFieldValue("email"),le=E.did,console.log("realname",T),E.did!==""){te.next=11;break}return w.ZP.error("please choose a department"),te.abrupt("return");case 11:T?(ue={jobNo:S,realname:T,seatNo:C,telephone:ne,mobile:ae,email:z,depDid:le},Z(ue),$(!1)):w.ZP.error("name should not be null");case 12:case"end":return te.stop()}},y)}));return function(){return c.apply(this,arguments)}}(),ee=function(){$(!1)},re=function(){console.log("new mem"),q()},L=function(y){console.log("select checked",y),K(y)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(J.Z,{title:"\u6DFB\u52A0\u6210\u5458",open:Q,onOk:_,onCancel:ee,children:(0,s.jsxs)(v.Z,{form:i,name:"memForm",initialValues:{dep_did:E.did},children:[(0,s.jsx)(v.Z.Item,{label:"\u90E8\u95E8",name:"dep_did",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8!"}],children:(0,s.jsx)(V.Z,{options:Y,onChange:L})}),(0,s.jsx)(v.Z.Item,{label:"\u59D3\u540D",name:"realname",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D!"}],children:(0,s.jsx)(D.Z,{})}),(0,s.jsx)(v.Z.Item,{label:"\u624B\u673A\u53F7",name:"mobile",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7!"}],children:(0,s.jsx)(D.Z,{})}),(0,s.jsx)(v.Z.Item,{label:"\u5DE5\u53F7",name:"jobNo",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u5DE5\u53F7!"}],children:(0,s.jsx)(D.Z,{})}),(0,s.jsx)(v.Z.Item,{label:"\u5EA7\u4F4D\u53F7",name:"seatNo",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u5EA7\u4F4D\u53F7!"}],children:(0,s.jsx)(D.Z,{})}),(0,s.jsx)(v.Z.Item,{label:"\u5206\u673A\u53F7",name:"telephone",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u5206\u673A\u53F7!"}],children:(0,s.jsx)(D.Z,{})}),(0,s.jsx)(v.Z.Item,{label:"\u90AE\u7BB1",name:"email",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1!"}],children:(0,s.jsx)(D.Z,{})})]})}),(0,s.jsx)(G.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(P.Z,{}),onClick:re,children:"create user"}),(0,s.jsx)(N.Rs,{rowKey:"id",headerTitle:E.name,dataSource:E.members,showActions:"hover",editable:{onSave:function(){var c=A()(M()().mark(function S(T,C,ne){return M()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return console.log(T,C,ne),z.abrupt("return",!0);case 2:case"end":return z.stop()}},S)}));function y(S,T,C){return c.apply(this,arguments)}return y}()},metas:{title:{dataIndex:"realname"},avatar:{dataIndex:"user.avatar",editable:!1},description:{dataIndex:"user.description",render:function(y){return(0,s.jsx)("div",{children:y})}},actions:{render:function(y,S,T,C){return[(0,s.jsx)("a",{onClick:function(){C==null||C.startEditable(S.mid)},children:"\u7F16\u8F91"},"link")]}}}})]})},U=R,H=a(86250),X=a(68508),k=function(){var u=v.Z.useForm(),f=O()(u,1),i=f[0],j=(0,I.useState)(!1),h=O()(j,2),Q=h[0],$=h[1],g=(0,b.u)(function(c){return{depCurrent:c.depCurrent,departments:c.departments,createDep:c.createDep,setDepCurrent:c.setDepCurrent}}),E=g.depCurrent,Y=g.departments,Z=g.createDep,K=g.setDepCurrent,q=function(){$(!0)},_=function(){var c=A()(M()().mark(function y(){var S;return M()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:S=i.getFieldValue("nickname"),console.log("nickname",S),S?(Z(S),$(!1)):w.ZP.error("\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A");case 3:case"end":return C.stop()}},y)}));return function(){return c.apply(this,arguments)}}(),ee=function(){$(!1)},re=function(){console.log("new dep"),q()},L=function(y){K(y.key)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(H.Z,{gap:"small",wrap:"wrap",children:(0,s.jsx)(G.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(P.Z,{}),onClick:re,children:"create dep"})}),(0,s.jsx)(X.Z,{onClick:L,defaultSelectedKeys:[E.did],mode:"inline",items:Y}),(0,s.jsx)(J.Z,{title:"\u521B\u5EFA\u90E8\u95E8",open:Q,onOk:_,onCancel:ee,children:(0,s.jsx)(v.Z,{form:i,name:"depForm",style:{maxWidth:400},children:(0,s.jsx)(v.Z.Item,{label:"\u90E8\u95E8\u540D\u79F0",name:"nickname",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0!"}],children:(0,s.jsx)(D.Z,{})})})})]})},o=k,d=F.Z.Sider,m=F.Z.Content,e={margin:"10px",minHeight:120,backgroundColor:"#EEFAE0"},n={margin:"10px",backgroundColor:"#EEFAE0",borderRight:"1px solid #ccc"},t=function(){var u=(0,b.u)(function(f){return f.queryOrgs});return(0,I.useEffect)(function(){u()},[]),(0,s.jsxs)(F.Z,{children:[(0,s.jsx)(d,{style:n,children:(0,s.jsx)(o,{})}),(0,s.jsx)(F.Z,{children:(0,s.jsx)(m,{style:e,children:(0,s.jsx)(U,{})})})]})},r=t},19245:function(se,W,a){a.d(W,{u:function(){return k}});var b=a(19632),F=a.n(b),I=a(15009),p=a.n(I),M=a(99289),x=a.n(M),A=a(97857),B=a.n(A),O=a(86745);function P(o){return N.apply(this,arguments)}function N(){return N=x()(p()().mark(function o(d){return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,O.request)("/api/org",{method:"POST",data:{nickname:d,client:"web"}}));case 1:case"end":return e.stop()}},o)})),N.apply(this,arguments)}function v(o,d,m){return w.apply(this,arguments)}function w(){return w=x()(p()().mark(function o(d,m,e){return p()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,O.request)("/api/v1/dep/create",{method:"POST",data:{nickname:d,parent_did:m,org_oid:e,client:"web"}}));case 1:case"end":return t.stop()}},o)})),w.apply(this,arguments)}function J(o){return V.apply(this,arguments)}function V(){return V=x()(p()().mark(function o(d){return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,O.request)("/api/v1/mem/create",{method:"POST",data:B()(B()({},d),{},{client:"web"})}));case 1:case"end":return e.stop()}},o)})),V.apply(this,arguments)}function D(o,d){return G.apply(this,arguments)}function G(){return G=x()(p()().mark(function o(d,m){return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,O.request)("/api/v1/org/query",{method:"GET",params:{pageNumber:d,pageSize:m,client:"web"}}));case 1:case"end":return n.stop()}},o)})),G.apply(this,arguments)}function s(o){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime().mark(function o(d){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/org",_objectSpread({method:"GET",params:{client:"web"}},d||{})));case 1:case"end":return e.stop()}},o)})),R.apply(this,arguments)}var U=a(64529),H=a(782),X=a(1151),k=(0,U.Ue)()((0,H.mW)((0,H.tJ)((0,X.n)(function(o,d){return{orgCurrent:{oid:"",name:"",avatar:"",description:""},depOptions:[],depCurrent:{did:""},departments:[],createOrg:function(){var m=x()(p()().mark(function n(t){var r;return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,P(t);case 2:r=u.sent,console.log("createOrg:",r),r.code==200&&d().transferOrgToTree(r.data);case 5:case"end":return u.stop()}},n)}));function e(n){return m.apply(this,arguments)}return e}(),createDep:function(){var m=x()(p()().mark(function n(t){var r,l,u,f;return p()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return r=d().orgCurrent.oid,j.next=3,v(t,"",r);case 3:l=j.sent,console.log("createDep:",l),l.code==200&&(u={label:l.data.name,key:l.data.did},f={label:l.data.name,value:l.data.did},o({depOptions:[].concat(F()(d().depOptions),[f]),departments:[].concat(F()(d().departments),[u])}));case 6:case"end":return j.stop()}},n)}));function e(n){return m.apply(this,arguments)}return e}(),setDepCurrent:function(e){for(var n=d().orgCurrent.departments,t=0;t<n.length;t++){var r=n[t];r.did===e&&o({depCurrent:r})}},createMem:function(){var m=x()(p()().mark(function n(t){var r,l,u,f,i;return p()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,J(t);case 2:if(r=h.sent,console.log("createMem:",t.depDid,r),r.code==200){for(l=d().orgCurrent,u=l.departments,f=0;f<u.length;f++)i=u[f],i.did===t.depDid&&(i.members=[r.data].concat(F()(i.members)),i.did===d().depCurrent.did&&o({depCurrent:i})),u[f]=i;l.departments=u,o({orgCurrent:l})}case 5:case"end":return h.stop()}},n)}));function e(n){return m.apply(this,arguments)}return e}(),queryOrgs:function(){var m=x()(p()().mark(function n(){var t,r;return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,D(0,10);case 2:if(t=u.sent,console.log("refresh orgs:",t),t.data.content.length!=0){u.next=6;break}return u.abrupt("return");case 6:r=t.data.content[0],d().transferOrgToTree(r);case 8:case"end":return u.stop()}},n)}));function e(){return m.apply(this,arguments)}return e}(),transferOrgToTree:function(e){for(var n=[],t=[],r=0;r<e.departments.length;r++){var l=e.departments[r],u={label:l.name,key:l.did};t.push(u);var f={label:l.name,value:l.did};n.push(f)}o({orgCurrent:e,depOptions:n,departments:t})},deleteOrgCache:function(){return o({},!0)}}}),{name:"ORGANIZTION_STORE"})))},86250:function(se,W,a){a.d(W,{Z:function(){return m}});var b=a(67294),F=a(93967),I=a.n(F),p=a(98423),M=a(98065),x=a(53124),A=a(91945),B=a(45503);const O=["wrap","nowrap","wrap-reverse"],P=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],N=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],v=(e,n)=>{const t={};return O.forEach(r=>{t[`${e}-wrap-${r}`]=n.wrap===r}),t},w=(e,n)=>{const t={};return N.forEach(r=>{t[`${e}-align-${r}`]=n.align===r}),t[`${e}-align-stretch`]=!n.align&&!!n.vertical,t},J=(e,n)=>{const t={};return P.forEach(r=>{t[`${e}-justify-${r}`]=n.justify===r}),t};function V(e,n){return I()(Object.assign(Object.assign(Object.assign({},v(e,n)),w(e,n)),J(e,n)))}var D=V;const G=e=>{const{componentCls:n}=e;return{[n]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},s=e=>{const{componentCls:n}=e;return{[n]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},R=e=>{const{componentCls:n}=e,t={};return O.forEach(r=>{t[`${n}-wrap-${r}`]={flexWrap:r}}),t},U=e=>{const{componentCls:n}=e,t={};return N.forEach(r=>{t[`${n}-align-${r}`]={alignItems:r}}),t},H=e=>{const{componentCls:n}=e,t={};return P.forEach(r=>{t[`${n}-justify-${r}`]={justifyContent:r}}),t},X=()=>({});var k=(0,A.I$)("Flex",e=>{const{paddingXS:n,padding:t,paddingLG:r}=e,l=(0,B.TS)(e,{flexGapSM:n,flexGap:t,flexGapLG:r});return[G(l),s(l),R(l),U(l),H(l)]},X,{resetStyle:!1}),o=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(e);l<r.length;l++)n.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(t[r[l]]=e[r[l]]);return t},m=b.forwardRef((e,n)=>{const{prefixCls:t,rootClassName:r,className:l,style:u,flex:f,gap:i,children:j,vertical:h=!1,component:Q="div"}=e,$=o(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:g,direction:E,getPrefixCls:Y}=b.useContext(x.E_),Z=Y("flex",t),[K,q,_]=k(Z),ee=h!=null?h:g==null?void 0:g.vertical,re=I()(l,r,g==null?void 0:g.className,Z,q,_,D(Z,e),{[`${Z}-rtl`]:E==="rtl",[`${Z}-gap-${i}`]:(0,M.n)(i),[`${Z}-vertical`]:ee}),L=Object.assign(Object.assign({},g==null?void 0:g.style),u);return f&&(L.flex=f),i&&!(0,M.n)(i)&&(L.gap=i),K(b.createElement(Q,Object.assign({ref:n,className:re,style:L},(0,p.Z)($,["justify","wrap","align"])),j))})}}]);
