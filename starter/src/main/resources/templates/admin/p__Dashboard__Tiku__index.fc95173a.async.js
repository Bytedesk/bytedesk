"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8455],{70150:function(A,f,e){e.d(f,{W5:function(){return W}});var h=e(15009),l=e.n(h),m=e(97857),i=e.n(m),E=e(99289),c=e.n(E),O=e(85615),p=e(88541),y=e.n(p),x=e(86745);function W(o){return D.apply(this,arguments)}function D(){return D=c()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/v1/message/query/org",{method:"GET",params:i()({},s)}));case 1:case"end":return n.stop()}},o)})),D.apply(this,arguments)}function K(o){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function o(s){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/user/robot",{method:"GET",params:{page:s.pageNumber,size:s.pageSize,client:HTTP_CLIENT}}));case 1:case"end":return n.stop()}},o)})),P.apply(this,arguments)}function z(o){return g.apply(this,arguments)}function g(){return g=_asyncToGenerator(_regeneratorRuntime().mark(function o(s){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/message/rest/send",{method:"POST",data:{json:s,client:HTTP_CLIENT}}));case 1:case"end":return n.stop()}},o)})),g.apply(this,arguments)}function G(o,s){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function o(s,_){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("http://127.0.0.1:1001/visitor/api/v1/ai/ollama/chat",{method:"GET",params:{query:s,kbUid:_,client:HTTP_CLIENT}}));case 1:case"end":return r.stop()}},o)})),C.apply(this,arguments)}function N(o,s,_){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function o(s,_,n){var r,a;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:console.log("sendMessageAiStream: ",s),r="http://127.0.0.1:1001/visitor/api/v1/ai/ollama/chat/stream?query=".concat(s,"&kbUid=").concat(_),a=new EventSource(r,{withCredentials:!1}),a.onopen=function(t){console.log("onopen:",t.target)},a.onmessage=function(t){console.log("onmessage:",t.data),n(t.data)},a.onerror=function(t){console.log("onerror:",t),a.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",t),a.close()},a.addEventListener("customEventName",function(t){console.log("Message id is "+t.lastEventId)});case 7:case"end":return u.stop()}},o)})),I.apply(this,arguments)}function H(o,s){return b.apply(this,arguments)}function b(){return b=_asyncToGenerator(_regeneratorRuntime().mark(function o(s,_){var n,r;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:console.log("sendMessageSSE: ",s),n="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(s.sid,"&content=").concat(s.content),r=new EventSource(n,{withCredentials:!1}),r.onopen=function(u){console.log("onopen:",u.target)},r.onmessage=function(u){_(u.data);var t=JSON.parse(u.data);if(t.type=="finish"){r&&r.close();return}},r.onerror=function(u){console.log("onerror:",u),alert("server error"),r.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",u),r.close()},r.addEventListener("customEventName",function(u){console.log("Message id is "+u.lastEventId)});case 7:case"end":return d.stop()}},o)})),b.apply(this,arguments)}function w(o,s){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function o(s,_){var n,r,a;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:console.log("sendMessageSSEPolyfill: ",s),n=localStorage.ACCESS_TOKEN,r="".concat("","/visitor/api/v1/zhipuai/sse?uid=&sid=").concat(s.sid,"&content=").concat(s.content),a=new EventSourcePolyfill(r,{headers:{Authorization:"Bearer ".concat(n)}}),a.onopen=function(t){console.log("onopen:",t.target)},a.onmessage=function(t){console.log("onmessage:",t.data),_(t.data);var U=JSON.parse(t.data);if(U.type=="finish"){a&&a.close();return}},a.onerror=function(t){console.log("onerror:",t),alert("server error"),a.readyState===EventSource.CLOSED?console.log("connection is closed"):console.log("Error occured",t),a.close()},a.addEventListener("customEventName",function(t){console.log("Message id is "+t.lastEventId)});case 8:case"end":return u.stop()}},o)})),j.apply(this,arguments)}},77154:function(A,f,e){var h=e(39825);function l(){var m=(0,h.Z)(),i=m.isDarkMode,E=250,c={borderRight:i?"1px solid #333":"1px solid #ccc",background:i?"#141414":"#f5f5f5"},O={background:i?"#141414":"#fff"},p={borderLeft:i?"1px solid #333":"1px solid #ccc",background:i?"#141414":"#f5f5f5"},y={minHeight:120,background:i?"#141414":"#f5f5f5",height:"100vh"};return{leftSiderStyle:c,leftSiderWidth:E,headerStyle:O,rightSiderStyle:p,contentStyle:y}}f.Z=l},16501:function(A,f,e){e.r(f),e.d(f,{default:function(){return s}});var h=e(77154),l=e(21612),m=e(50136),i=e(67294),E=e(15009),c=e.n(E),O=e(99289),p=e.n(O),y=e(5574),x=e.n(y),W=e(80049),D=e(70150),K=e(69888),P=e(87676),z=e(57482),g=e(85893),G=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,g.jsx)(FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",copyable:!0},{title:(0,g.jsx)(FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0},{title:intl.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",render:function(n,r,a,d){return[(0,g.jsx)("a",{onClick:function(){var t;d==null||(t=d.startEditable)===null||t===void 0||t.call(d,r.uid)},children:"\u4FEE\u6539"},"editable")]}}],C=function(){var n=(0,i.useRef)(),r=(0,i.useState)(1),a=x()(r,2),d=a[0],u=a[1],t=(0,i.useState)(10),U=x()(t,2),k=U[0],J=U[1],Q=(0,P.u)(function(v){return v.currentOrg}),Z=(0,K.G)(function(v){return{messageResult:v.messageResult,setMemberResult:v.setMessageResult}}),L=Z.messageResult,V=Z.setMemberResult,$=function(){var v=p()(c()().mark(function T(){var M,S;return c()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return M={pageNumber:d-1,pageSize:k,orgUid:Q.uid},R.next=3,(0,D.W5)(M);case 3:S=R.sent,console.log("getAllMessages response:",M,S),S.code===200?V(S):W.yw.error(S.message);case 6:case"end":return R.stop()}},T)}));return function(){return v.apply(this,arguments)}}();return(0,i.useEffect)(function(){$()},[]),(0,i.useEffect)(function(){$()},[d,k]),(0,i.useEffect)(function(){console.log("messageResult:",L),n.current.reload()},[L]),(0,g.jsx)(z.Z,{columns:G,actionRef:n,cardBordered:!0,request:function(){var v=p()(c()().mark(function T(M,S,F){return c()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return console.log("request:",M,S,F),u(M.current),J(M.pageSize),B.abrupt("return",Promise.resolve({data:L.data.content,success:!0,total:L.data.totalElements}));case 4:case"end":return B.stop()}},T)}));return function(T,M,S){return v.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:k,showQuickJumper:!0,onChange:function(T){console.log("page:",T)}},dateFormatter:"string",headerTitle:"\u7EC4\u7EC7\u6D88\u606F",toolBarRender:function(){return[]}})},N=C,I=l.Z.Header,H=l.Z.Footer,b=l.Z.Sider,w=l.Z.Content,j=[{label:"\u9AD8\u7EA7",key:"top",children:[{label:"column",key:"xinxixitongxiangmuguanlishi"}]},{label:"\u4E2D\u7EA7",key:"middle",children:[{label:"column2",key:"xitongjichengxiangmuguanligongchengshi"}]}],o=function(){var n=(0,h.Z)(),r=n.leftSiderStyle,a=n.contentStyle,d=function(t){console.log("menu click ",t)};return(0,g.jsxs)(l.Z,{children:[(0,g.jsx)(b,{style:r,children:(0,g.jsx)(m.Z,{mode:"inline",onClick:d,defaultSelectedKeys:["xinxixitongxiangmuguanlishi"],defaultOpenKeys:["top","middle"],items:j})}),(0,g.jsx)(l.Z,{children:(0,g.jsx)(w,{style:a,children:(0,g.jsx)(N,{})})})]})},s=o},69888:function(A,f,e){e.d(f,{G:function(){return E}});var h=e(85615),l=e(73445),m=e(782),i=e(18753),E=(0,l.Ue)()((0,m.mW)((0,m.tJ)((0,i.n)(function(c,O){return{messageResult:{data:{content:[]}},setMessageResult:function(y){c({messageResult:y})},deleteMessageCache:function(){return c({},!0)}}}),{name:h.j87})))},87676:function(A,f,e){e.d(f,{u:function(){return E}});var h=e(85615),l=e(73445),m=e(782),i=e(18753),E=(0,l.Ue)()((0,m.mW)((0,m.tJ)((0,i.n)(function(c,O){return{currentOrg:{uid:"",name:"",description:""},setCurrentOrg:function(y){c({currentOrg:y})},deleteOrg:function(){return c({},!0)}}}),{name:h.eRd})))}}]);
