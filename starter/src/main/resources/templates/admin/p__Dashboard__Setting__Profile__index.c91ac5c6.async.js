"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9290],{79619:function(e,r,n){n.d(r,{Z:function(){return i}});var s=n(13800),a=n(75271),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},t=n(45791),l=function(e,r){return a.createElement(t.Z,(0,s.Z)((0,s.Z)({},e),{},{ref:r,icon:o}))};var i=a.forwardRef(l)},65012:function(e,r,n){var s=n(13800),a=n(60323),o=n(75271),t=n(89755),l=n(52676),i=["fieldProps","proFieldProps"],c=function(e,r){var n=e.fieldProps,o=e.proFieldProps,c=(0,a.Z)(e,i);return(0,l.jsx)(t.Z,(0,s.Z)({ref:r,valueType:"textarea",fieldProps:n,proFieldProps:o},c))};r.Z=o.forwardRef(c)},77705:function(e,r,n){n.d(r,{G:function(){return d}});var s=n(26068),a=n.n(s),o=(n(75271),n(30224)),t=n(64453),l=n(16483),i=n.n(l),c=n(37240),u=n(49437),f=n(52676),d=function(e){var r=e.children,n=e.onSuccess,s=e.onError,l={file:null,file_name:"test.png",file_type:"image/png",is_avatar:"true",kb_type:t.IrL,category_uid:"",kb_uid:"",client:t.bVn},d={name:"file",accept:"image/*",action:(0,u.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(t.LA8)},data:l,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var r=i()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;l.file=e,l.file_name=r,l.file_type=e.type,console.log("beforeUpload",l)},onChange:function(e){if("uploading"!==e.file.status&&console.log("not uploading:",e.file),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var r=e.file.response.data;n(r),c.yw.success("".concat(e.file.name," 上传成功"))}else s(e.file),c.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(c.yw.error("".concat(e.file.name," 上传失败")),s(e.file))}};return(0,f.jsx)(o.Z,a()(a()({},d),{},{children:r}))}},17109:function(e,r,n){n.r(r),n.d(r,{default:function(){return O}});var s=n(90228),a=n.n(s),o=n(26068),t=n.n(o),l=n(87999),i=n.n(l),c=n(48305),u=n.n(c),f=n(75271),d=n(29132),m=n(42502),p=n(43393),g=n(64826),w=n(65012),b=n(45234),h=n(79619),v=n(65453),P=n(25141),x=n(37240),Z=n(77705),y=n(92785),j=n(74592),M=n(8591),C=n(52676),k=function(e){var r=e.open,n=e.onClose,s=(0,b.useIntl)(),o=(0,y.Z)().translateString;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(M.Z,{title:s.formatMessage({id:"pages.settings.reset.password",defaultMessage:"重置密码"}),forceRender:!0,open:r,footer:null,onCancel:function(){n()},children:(0,C.jsxs)(p.A,{initialValues:{oldPassword:"",newPassword:"",confirmPassword:""},onFinish:function(){var e=i()(a()().mark((function e(r){var s,t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("changePassword:",r),!(r.newPassword.trim().length<6)){e.next=4;break}return x.yw.error("密码最小长度不能小于6"),e.abrupt("return");case 4:if(r.newPassword===r.confirmPassword){e.next=7;break}return x.yw.error("两次输入密码不一致"),e.abrupt("return");case 7:return s={oldPassword:r.oldPassword,newPassword:r.newPassword},e.next=10,(0,P.Cp)(s);case 10:t=e.sent,console.log("changePassword response:",t),200===t.code?(x.yw.success("Password changed successfully!"),n()):x.yw.error(o(t.message));case 13:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,C.jsx)(g.Z.Password,{name:"oldPassword",label:"原密码(手机号直接登录用户，可以留空)"}),(0,C.jsx)(g.Z.Password,{name:"newPassword",label:"新密码"}),(0,C.jsx)(g.Z.Password,{name:"confirmPassword",label:"确认密码"})]})})})},I={labelCol:{span:8},wrapperCol:{span:8}},O=function(){var e=(0,b.useIntl)(),r=(0,y.Z)().translateString,n=(0,v.L)((function(e){return{userInfo:e.userInfo,setUserInfo:e.setUserInfo}})),s=n.userInfo,o=n.setUserInfo,l=(0,f.useState)(""),c=u()(l,2),M=c[0],O=c[1],U=(0,f.useState)(!1),E=u()(U,2),V=E[0],A=E[1],_=function(){var r=i()(a()().mark((function r(n){var l,i;return a()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l=t()(t()(t()({},s),n),{},{avatar:M}),console.log(l),r.next=4,(0,P.ck)(l);case 4:i=r.sent,console.log("updateProfile response:",i),200===i.code?(x.yw.success(e.formatMessage({id:"update.success"})),i.data.username!==s.username?(0,j.NZ)():o(i.data)):x.yw.error(i.message);case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return(0,f.useEffect)((function(){s&&O(s.avatar)}),[s]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(p.A,t()(t()({},I),{},{onFinish:_,initialValues:{uid:s.uid,username:s.username,nickname:s.nickname,email:s.email,mobile:s.mobile,description:r(s.description)},children:[(0,C.jsx)(g.Z,{name:"uid",label:"Uid",rules:[{required:!0}],readonly:!0}),(0,C.jsx)(p.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:e.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,C.jsxs)(Z.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e),O(e)},onError:function(e){console.log("handleUploadError:",e)},children:[(0,C.jsx)(d.C,{src:M}),(0,C.jsx)(m.ZP,{icon:(0,C.jsx)(h.Z,{}),children:e.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,C.jsx)(g.Z,{name:"username",label:e.formatMessage({id:"username.change.tip",defaultMessage:"Username"}),rules:[{required:!0}]}),(0,C.jsx)(m.ZP,{onClick:function(){A(!0)},children:e.formatMessage({id:"pages.settings.reset.password",defaultMessage:"重置密码"})}),(0,C.jsx)(g.Z,{name:"nickname",label:e.formatMessage({id:"nickname",defaultMessage:"Nickname"}),rules:[{required:!0}]}),(0,C.jsx)(g.Z,{name:"email",label:s.emailVerified?e.formatMessage({id:"email.verified",defaultMessage:"Email Verified"}):e.formatMessage({id:"email.unverified",defaultMessage:"email unverified"}),rules:[{type:"email"}],readonly:!0}),(0,C.jsx)(g.Z,{name:"mobile",label:s.mobileVerified?e.formatMessage({id:"mobile.verified",defaultMessage:"Mobile Verified"}):e.formatMessage({id:"mobile.unverified",defaultMessage:"mobile unverified"}),readonly:!0}),(0,C.jsx)(w.Z,{name:"description",label:e.formatMessage({id:"description",defaultMessage:"Description"})})]})),(0,C.jsx)(k,{open:V,onClose:function(){A(!1)}})]})}},8591:function(e,r,n){n.d(r,{Z:function(){return x}});var s=n(96986),a=n(55849),o=n(29168),t=n(75271),l=n(82187),i=n.n(l),c=n(40995),u=n(52825),f=n(34662),d=n(30076),m=n(90698),p=n(9573),g=n(20339),w=function(e,r){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)r.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n};var b=(0,u.i)((e=>{const{prefixCls:r,className:n,closeIcon:s,closable:a,type:o,title:l,children:u,footer:b}=e,h=w(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:v}=t.useContext(f.E_),P=v(),x=r||v("modal"),Z=(0,d.Z)(P),[y,j,M]=(0,g.ZP)(x,Z),C=`${x}-confirm`;let k={};return k=o?{closable:null!=a&&a,title:"",footer:"",children:t.createElement(m.O,Object.assign({},e,{prefixCls:x,confirmPrefixCls:C,rootPrefixCls:P,content:u}))}:{closable:null==a||a,title:l,footer:null!==b&&t.createElement(p.$,Object.assign({},e)),children:u},y(t.createElement(c.s,Object.assign({prefixCls:x,className:i()(j,`${x}-pure-panel`,o&&C,o&&`${C}-${o}`,n,M,Z)},h,{closeIcon:(0,p.b)(x,s),closable:a},k)))})),h=n(64501);function v(e){return(0,s.ZP)((0,s.uW)(e))}const P=o.Z;P.useModal=h.Z,P.info=function(e){return(0,s.ZP)((0,s.cw)(e))},P.success=function(e){return(0,s.ZP)((0,s.vq)(e))},P.error=function(e){return(0,s.ZP)((0,s.AQ)(e))},P.warning=v,P.warn=v,P.confirm=function(e){return(0,s.ZP)((0,s.Au)(e))},P.destroyAll=function(){for(;a.Z.length;){const e=a.Z.pop();e&&e()}},P.config=s.ai,P._InternalPanelDoNotUseOrYouWillBeFired=b;var x=P}}]);