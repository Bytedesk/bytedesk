"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1742],{11475:function(K,P,e){e.d(P,{Z:function(){return c}});var R=e(1413),t=e(67294),d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},r=d,_=e(89099),i=function(f,E){return t.createElement(_.Z,(0,R.Z)((0,R.Z)({},f),{},{ref:E,icon:r}))},m=t.forwardRef(i),c=m},51042:function(K,P,e){var R=e(1413),t=e(67294),d=e(42110),r=e(89099),_=function(c,s){return t.createElement(r.Z,(0,R.Z)((0,R.Z)({},c),{},{ref:s,icon:d.Z}))},i=t.forwardRef(_);P.Z=i},30300:function(K,P,e){e.d(P,{FU:function(){return s},O7:function(){return w},k4:function(){return E},yr:function(){return j}});var R=e(15009),t=e.n(R),d=e(97857),r=e.n(d),_=e(99289),i=e.n(_),m=e(85615),c=e(86745);function s(a){return f.apply(this,arguments)}function f(){return f=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/category/query/org",{method:"GET",params:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),f.apply(this,arguments)}function E(a){return g.apply(this,arguments)}function g(){return g=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/category/create",{method:"POST",data:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),g.apply(this,arguments)}function j(a){return D.apply(this,arguments)}function D(){return D=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/category/update",{method:"POST",data:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),D.apply(this,arguments)}function A(a){return M.apply(this,arguments)}function M(){return M=_asyncToGenerator(_regeneratorRuntime().mark(function a(v){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/category/delete",{method:"POST",data:_objectSpread(_objectSpread({},v),{},{client:HTTP_CLIENT})}));case 1:case"end":return n.stop()}},a)})),M.apply(this,arguments)}function Z(a){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function a(v){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/category/all",{method:"GET",params:_objectSpread(_objectSpread({},v),{},{client:HTTP_CLIENT})}));case 1:case"end":return n.stop()}},a)})),U.apply(this,arguments)}function w(){return L.apply(this,arguments)}function L(){return L=i()(t()().mark(function a(){return t()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",(0,c.request)("/visitor/api/v1/category/query",{method:"GET",params:{client:m.bV}}));case 1:case"end":return T.stop()}},a)})),L.apply(this,arguments)}},7420:function(K,P,e){e.d(P,{$T:function(){return E},A:function(){return Z},Hf:function(){return A},P6:function(){return j},gx:function(){return s}});var R=e(15009),t=e.n(R),d=e(97857),r=e.n(d),_=e(99289),i=e.n(_),m=e(85615),c=e(86745);function s(a){return f.apply(this,arguments)}function f(){return f=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/course/query/org",{method:"GET",params:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),f.apply(this,arguments)}function E(a){return g.apply(this,arguments)}function g(){return g=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/course/query/user",{method:"GET",params:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),g.apply(this,arguments)}function j(a){return D.apply(this,arguments)}function D(){return D=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/course/create",{method:"POST",data:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),D.apply(this,arguments)}function A(a){return M.apply(this,arguments)}function M(){return M=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/course/update",{method:"POST",data:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),M.apply(this,arguments)}function Z(a){return U.apply(this,arguments)}function U(){return U=i()(t()().mark(function a(v){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/v1/course/delete",{method:"POST",data:r()(r()({},v),{},{client:m.bV})}));case 1:case"end":return n.stop()}},a)})),U.apply(this,arguments)}function w(a){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime().mark(function a(v){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/course/filter",{method:"GET",params:_objectSpread(_objectSpread({},v),{},{client:HTTP_CLIENT})}));case 1:case"end":return n.stop()}},a)})),L.apply(this,arguments)}},77154:function(K,P,e){var R=e(39825);function t(){var d=(0,R.Z)(),r=d.isDarkMode,_={borderRight:r?"1px solid #333":"1px solid #ccc",background:r?"#141414":"#f5f5f5",width:260},i={background:r?"#141414":"#fff"},m={borderLeft:r?"1px solid #333":"1px solid #ccc",background:r?"#141414":"#f5f5f5"},c={minHeight:120,background:r?"#141414":"#f5f5f5"};return{leftSiderStyle:_,headerStyle:i,rightSiderStyle:m,contentStyle:c}}P.Z=t},83373:function(K,P,e){e.r(P),e.d(P,{default:function(){return ve}});var R=e(77154),t=e(21612),d=e(67294),r=e(15009),_=e.n(r),i=e(99289),m=e.n(i),c=e(5574),s=e.n(c),f=e(80049),E=e(7420),g=e(89333),j=e(60247),D=e(11475),A=e(51042),M=e(1269),Z=e(85576),U=e(14726),w=e(8232),L=e(85265),a=e(42075),v=e(96365),T=e(40782),n=e(83863),te=e(89102),l=e(85893),ie=function(B){var h=B.isEdit,u=B.course,z=B.open,W=B.onClose,X=B.onSubmit,Y=w.Z.useForm(),k=s()(Y,1),x=k[0],q=(0,te.v)(function(F){return F.categoryTreeOptions});(0,d.useEffect)(function(){if(u&&x){var F,O;x.setFieldsValue({name:u==null?void 0:u.name,description:u==null?void 0:u.description}),x.setFieldsValue({categories:[u==null||(F=u.mainCategory)===null||F===void 0?void 0:F.uid,u==null||(O=u.subCategory)===null||O===void 0?void 0:O.uid]})}else x!=null&&!h&&(console.log("form resetFields"),x.resetFields())},[u]);var re=function(O){console.log("handleNameChange:",O)},N=function(O,V){console.log("Cascader value:",O),console.log("Cascader selectedData:",V)},H=function(O){console.log("selected ".concat(O))},J=function(){console.log("handleSubmit"),x.validateFields().then(function(O){console.log("Form values:",O);var V={uid:u==null?void 0:u.uid,name:O.name,cover:u.cover,description:O.description,detail:u.detail,price:u.price,mainCategory:{uid:O.categories[0]},subCategory:{uid:O.categories[1]},published:O.published==="true"};X(V)}).catch(function(O){console.log("Form errors:",O)})};return(0,l.jsx)("div",{children:(0,l.jsx)(L.Z,{title:h?"\u4FEE\u6539\u8BFE\u7A0B":"\u65B0\u5EFA\u8BFE\u7A0B",onClose:W,open:z,extra:(0,l.jsxs)(a.Z,{children:[(0,l.jsx)(U.ZP,{onClick:W,children:"\u53D6\u6D88"}),(0,l.jsx)(U.ZP,{onClick:J,type:"primary",children:"\u4FDD\u5B58"})]}),children:(0,l.jsxs)(w.Z,{form:x,children:[(0,l.jsx)(w.Z.Item,{name:"name",label:"\u8BFE\u7A0B\u540D\u79F0",initialValue:u==null?void 0:u.name,children:(0,l.jsx)(v.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0"})}),(0,l.jsx)(w.Z.Item,{name:"categories",label:"\u8BFE\u7A0B\u5206\u7C7B",children:(0,l.jsx)(T.Z,{options:q,onChange:N,placeholder:"\u9009\u62E9\u5206\u7C7B"})}),(0,l.jsx)(w.Z.Item,{name:"description",label:"\u8BFE\u7A0B\u63CF\u8FF0",initialValue:u==null?void 0:u.description,children:(0,l.jsx)(v.Z.TextArea,{placeholder:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u63CF\u8FF0"})}),(0,l.jsx)(w.Z.Item,{name:"published",label:"\u8BFE\u7A0B\u72B6\u6001",initialValue:u!=null&&u.published?"true":"false",children:(0,l.jsx)(n.Z,{style:{width:120},onChange:H,options:[{value:"true",label:"\u5DF2\u53D1\u5E03"},{value:"false",label:"\u672A\u53D1\u5E03"}]})})]})})})},le=ie,de=e(30300),ce=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5C01\u9762",dataIndex:"cover",render:function(B,h){return(0,l.jsx)("a",{href:h.cover,target:"_blank",children:(0,l.jsx)("img",{src:h.cover,width:"40",height:"40"})})}},{title:"\u540D\u79F0",dataIndex:"name",copyable:!0},{title:"\u5206\u7C7B",key:"category",render:function(B,h){var u=h.mainCategory?h.mainCategory.name:"-",z=h.subCategory?h.subCategory.name:"-";return(0,l.jsxs)("span",{children:[u," / ",z]})}},{title:"\u57CE\u5E02",dataIndex:"city",render:function(B,h){return h.city?h.city.name:"-"}},{title:"\u53D1\u5E03\u4EBA",editable:!1,renderText:function(B,h,u,z){var W;return(W=h.user)===null||W===void 0?void 0:W.nickname}},{title:"\u72B6\u6001",key:"published",render:function(B,h){return h.published?"\u5DF2\u53D1\u5E03":"\u672A\u53D1\u5E03"}},{title:"\u66F4\u65B0\u65F6\u95F4",key:"updatedAt",dataIndex:"updatedAt",editable:!1,sorter:!0,hideInSearch:!0}],_e=function(){var B=(0,j.L)(function(p){return p.userInfo}),h=(0,d.useRef)(),u=(0,d.useState)(1),z=s()(u,2),W=z[0],X=z[1],Y=(0,d.useState)(10),k=s()(Y,2),x=k[0],q=k[1],re=(0,d.useState)(!0),N=s()(re,2),H=N[0],J=N[1],F=(0,d.useState)(),O=s()(F,2),V=O[0],ae=O[1],G=(0,g.K)(function(p){return{courseResult:p.courseResult,insertCourseResult:p.insertCourseResult,updateCourseResult:p.updateCourseResult,deleteCourseResult:p.deleteCourseResult,setCourseResult:p.setCourseResult}}),Q=G.courseResult,ge=G.insertCourseResult,he=G.updateCourseResult,Ce=G.deleteCourseResult,ye=G.setCourseResult,Ee=(0,te.v)(function(p){return p.setCategoryResult}),De=(0,d.useState)(!1),ue=s()(De,2),Oe=ue[0],ee=ue[1],be=Z.Z.useModal(),se=s()(be,2),Re=se[0],Pe=se[1],je=function(C){Re.confirm({title:"\u5220\u9664\u63D0\u793A",icon:(0,l.jsx)(D.Z,{}),content:"\u786E\u8BA4\u8981\u5220\u9664\u8BFE\u7A0B\u3010".concat(C.name,"\u3011\u5417\uFF1F"),onOk:function(){console.log("\u786E\u8BA4\u5220\u9664"),Ae(C)},onCancel:function(){console.log("\u53D6\u6D88\u5220\u9664")},okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},Te=function(){ae(void 0),J(!1),ee(!0)},Me=function(C){ae(C),J(!0),ee(!0)},ne=function(){ee(!1)},Se=function(){var p=m()(_()().mark(function C(o){var b,S;return _()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(console.log("handleSubmitDrawer:",o),!H){I.next=9;break}return I.next=4,(0,E.Hf)(o);case 4:b=I.sent,console.log("updateCourse:",b),b.code===200?(f.yw.success("\u66F4\u65B0\u6210\u529F"),he(b.data),ne()):f.yw.error(b.message),I.next=14;break;case 9:return I.next=11,(0,E.P6)(o);case 11:S=I.sent,console.log("createCourse:",S),S.code===200?(f.yw.success("\u521B\u5EFA\u6210\u529F"),ge(S.data),ne()):f.yw.error(S.message);case 14:case"end":return I.stop()}},C)}));return function(o){return p.apply(this,arguments)}}(),Ae=function(){var p=m()(_()().mark(function C(o){var b;return _()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log("handleDeleteCourse:",o),y.next=3,(0,E.A)(o);case 3:b=y.sent,b.code===200?Ce(o):f.yw.error(b.message);case 5:case"end":return y.stop()}},C)}));return function(o){return p.apply(this,arguments)}}(),Ue=[].concat(ce,[{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(C,o,b,S){return[(0,l.jsx)("a",{onClick:function(){console.log("edit record:",o),Me(o)},children:"\u4FEE\u6539"},"editable"),(0,l.jsx)(U.ZP,{size:"small",type:"link",onClick:function(){return je(o)},danger:!0,children:"\u5220\u9664"},"delete")]}}]),oe=function(){var p=m()(_()().mark(function C(){var o,b;return _()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(o={pageNumber:W-1,pageSize:x},!B.superUser){y.next=7;break}return y.next=4,(0,E.gx)(o);case 4:y.t0=y.sent,y.next=10;break;case 7:return y.next=9,(0,E.$T)(o);case 9:y.t0=y.sent;case 10:b=y.t0,console.log("getAllCourses response:",o,b),b.code===200?ye(b):f.yw.error(b.message);case 13:case"end":return y.stop()}},C)}));return function(){return p.apply(this,arguments)}}(),Be=function(){var p=m()(_()().mark(function C(){var o;return _()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,de.O7)();case 2:o=S.sent,console.log("getAllCategories response:",o),o.code===200?Ee(o):f.yw.error(o.message);case 5:case"end":return S.stop()}},C)}));return function(){return p.apply(this,arguments)}}();return(0,d.useEffect)(function(){oe(),Be()},[]),(0,d.useEffect)(function(){oe()},[W,x]),(0,d.useEffect)(function(){console.log("courseResult:",Q),h.current.reload()},[Q]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.Z,{columns:Ue,actionRef:h,cardBordered:!0,request:function(){var p=m()(_()().mark(function C(o,b,S){return _()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return console.log("request:",o,b,S),X(o.current),q(o.pageSize),I.abrupt("return",Promise.resolve({data:Q.data.content,success:!0,total:Q.data.totalElements}));case 4:case"end":return I.stop()}},C)}));return function(C,o,b){return p.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:x,showQuickJumper:!0,onChange:function(C){console.log("page:",C)}},dateFormatter:"string",headerTitle:"\u8BFE\u7A0B",toolBarRender:function(){return[(0,l.jsxs)(U.ZP,{type:"primary",onClick:Te,children:[(0,l.jsx)(A.Z,{}),"\u65B0\u5EFA"]})]}}),(0,l.jsx)(le,{isEdit:H,course:V,open:Oe,onClose:ne,onSubmit:Se}),Pe]})},me=_e,Ie=t.Z.Sider,pe=t.Z.Content,fe=function(){var B=(0,R.Z)(),h=B.contentStyle;return(0,l.jsx)(t.Z,{children:(0,l.jsx)(t.Z,{children:(0,l.jsx)(pe,{style:h,children:(0,l.jsx)(me,{})})})})},ve=fe},89102:function(K,P,e){e.d(P,{v:function(){return s}});var R=e(19632),t=e.n(R),d=e(97857),r=e.n(d),_=e(85615),i=e(64529),m=e(782),c=e(71381),s=(0,i.Ue)()((0,m.mW)((0,m.tJ)((0,c.n)(function(g,j){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:""},setCategoryResult:function(A){var M=E(A),Z={uid:"all",name:"\u5168\u90E8"},U=r()(r()({},A),{},{data:{content:[Z].concat(t()(A.data.content))}}),w=f(U);g({categoryResult:U,categoryTreeOptions:w,categorySelectOptions:M})},setCurrentCategoryUid:function(A){var M=j().categoryResult.data.content.find(function(Z){return Z.uid===A});g({currentCategory:M})},deleteCategoryCache:function(){return g({},!0)}}}),{name:_.OM})));function f(g){var j=[];return g.data.content.forEach(function(D){var A={title:D.name,key:D.uid,children:[]};D.children&&Array.isArray(D.children)&&(A.children=D.children.map(function(M){return{title:M.name,key:M.uid,children:[]}})),j.push(A)}),j}function E(g){var j=[];return g.data.content.forEach(function(D){var A={label:D.name,value:D.uid};j.push(A)}),j}},89333:function(K,P,e){e.d(P,{K:function(){return _}});var R=e(85615),t=e(64529),d=e(782),r=e(71381),_=(0,t.Ue)()((0,d.mW)((0,d.tJ)((0,r.n)(function(i,m){return{courseResult:{data:{content:[]}},insertCourseResult:function(s){i(function(f){var E=f.courseResult.data.content;E.unshift(s)})},updateCourseResult:function(s){i(function(f){var E=f.courseResult.data.content,g=E.findIndex(function(j){return j.uid===s.uid});g!==-1?E[g]=s:console.warn("Course with uid ".concat(s.uid," not found."))})},deleteCourseResult:function(s){i(function(f){var E=f.courseResult.data.content,g=E.findIndex(function(j){return j.uid===s.uid});g!==-1?E.splice(g,1):console.warn("Course with uid ".concat(s.uid," not found."))})},setCourseResult:function(s){i({courseResult:s})},deleteCourseCache:function(){return i({},!0)}}}),{name:R.vC})))},60247:function(K,P,e){e.d(P,{L:function(){return _}});var R=e(85615),t=e(64529),d=e(782),r=e(71381),_=(0,t.Ue)()((0,d.mW)((0,d.tJ)((0,r.n)(function(i,m){return{userInfo:{uid:""},deviceUid:"",setUserInfo:function(s){i({userInfo:s})},setDeviceUid:function(s){i({deviceUid:s})},deleteUserInfo:function(){return i({},!0)}}}),{name:R.Em})))}}]);
