"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9290],{88484:function(e,n,r){r.d(n,{Z:function(){return i}});var s=r(1413),a=r(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},t=r(89099),l=function(e,n){return a.createElement(t.Z,(0,s.Z)((0,s.Z)({},e),{},{ref:n,icon:o}))};var i=a.forwardRef(l)},90672:function(e,n,r){var s=r(1413),a=r(91),o=r(67294),t=r(29258),l=r(85893),i=["fieldProps","proFieldProps"],c=function(e,n){var r=e.fieldProps,o=e.proFieldProps,c=(0,a.Z)(e,i);return(0,l.jsx)(t.Z,(0,s.Z)({ref:n,valueType:"textarea",fieldProps:r,proFieldProps:o},c))};n.Z=o.forwardRef(c)},53004:function(e,n,r){r.d(n,{G:function(){return d}});var s=r(97857),a=r.n(s),o=(r(67294),r(64121)),t=r(85615),l=r(27484),i=r.n(l),c=r(80049),u=r(17634),f=r(85893),d=function(e){var n=e.children,r=e.onSuccess,s=e.onError,l={file:null,file_name:"test.png",file_type:"image/png",is_avatar:"true",kb_type:"",category_uid:"",kb_uid:"",client:t.bVn},d={name:"file",accept:"image/*",action:(0,u.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(t.LA8)},data:l,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var n=i()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;l.file=e,l.file_name=n,l.file_type=e.type,console.log("beforeUpload",l)},onChange:function(e){if("uploading"!==e.file.status&&console.log("not uploading:",e.file),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var n=e.file.response.data;r(n),c.yw.success("".concat(e.file.name," 上传成功"))}else s(e.file),c.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(c.yw.error("".concat(e.file.name," 上传失败")),s(e.file))}};return(0,f.jsx)(o.Z,a()(a()({},d),{},{children:n}))}},22078:function(e,n,r){r.r(n),r.d(n,{default:function(){return O}});var s=r(15009),a=r.n(s),o=r(97857),t=r.n(o),l=r(99289),i=r.n(l),c=r(5574),u=r.n(c),f=r(67294),d=r(7134),p=r(14726),m=r(34994),g=r(5966),w=r(90672),b=r(86745),h=r(88484),v=r(60247),P=r(16761),x=r(80049),y=r(53004),Z=r(73803),j=r(16854),M=r(85576),C=r(85893),k=function(e){var n=e.open,r=e.onClose,s=(0,b.useIntl)();return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(M.Z,{title:s.formatMessage({id:"pages.settings.reset.password",defaultMessage:"重置密码"}),forceRender:!0,open:n,footer:null,onCancel:function(){r()},children:(0,C.jsxs)(m.A,{initialValues:{oldPassword:"",newPassword:"",confirmPassword:""},onFinish:function(){var e=i()(a()().mark((function e(n){var s,o;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("changePassword:",n),!(n.newPassword.trim().length<6)){e.next=4;break}return x.yw.error("password length should not be less than 6"),e.abrupt("return");case 4:if(n.newPassword===n.confirmPassword){e.next=7;break}return x.yw.error("New password and confirm password do not match"),e.abrupt("return");case 7:return s={oldPassword:n.oldPassword,newPassword:n.newPassword},e.next=10,(0,P.Cp)(s);case 10:o=e.sent,console.log("changePassword response:",o),200===o.code?(x.yw.success("Password changed successfully!"),r()):x.yw.error(o.message);case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:[(0,C.jsx)(g.Z.Password,{name:"oldPassword",label:"原密码(手机号直接登录用户，可以留空)"}),(0,C.jsx)(g.Z.Password,{name:"newPassword",label:"新密码"}),(0,C.jsx)(g.Z.Password,{name:"confirmPassword",label:"确认密码"})]})})})},I={labelCol:{span:8},wrapperCol:{span:8}},O=function(){var e=(0,b.useIntl)(),n=(0,Z.Z)().translateString,r=(0,v.L)((function(e){return{userInfo:e.userInfo,setUserInfo:e.setUserInfo}})),s=r.userInfo,o=r.setUserInfo,l=(0,f.useState)(""),c=u()(l,2),M=c[0],O=c[1],U=(0,f.useState)(!1),E=u()(U,2),V=E[0],A=E[1],_=function(){var n=i()(a()().mark((function n(r){var l,i;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=t()(t()(t()({},s),r),{},{avatar:M}),console.log(l),n.next=4,(0,P.ck)(l);case 4:i=n.sent,console.log("updateProfile response:",i),200===i.code?(x.yw.success(e.formatMessage({id:"update.success"})),i.data.username!==s.username?(0,j.NZ)():o(i.data)):x.yw.error(i.message);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,f.useEffect)((function(){s&&O(s.avatar)}),[s]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(m.A,t()(t()({},I),{},{onFinish:_,initialValues:{uid:s.uid,username:s.username,nickname:s.nickname,email:s.email,mobile:s.mobile,description:n(s.description)},children:[(0,C.jsx)(g.Z,{name:"uid",label:"Uid",rules:[{required:!0}],readonly:!0}),(0,C.jsx)(m.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:e.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,C.jsxs)(y.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e),O(e)},onError:function(e){console.log("handleUploadError:",e)},children:[(0,C.jsx)(d.C,{src:M}),(0,C.jsx)(p.ZP,{icon:(0,C.jsx)(h.Z,{}),children:e.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,C.jsx)(g.Z,{name:"username",label:e.formatMessage({id:"username.change.tip",defaultMessage:"Username"}),rules:[{required:!0}]}),(0,C.jsx)(p.ZP,{onClick:function(){A(!0)},children:e.formatMessage({id:"pages.settings.reset.password",defaultMessage:"重置密码"})}),(0,C.jsx)(g.Z,{name:"nickname",label:e.formatMessage({id:"nickname",defaultMessage:"Nickname"}),rules:[{required:!0}]}),(0,C.jsx)(g.Z,{name:"email",label:s.emailVerified?e.formatMessage({id:"email.verified",defaultMessage:"Email Verified"}):e.formatMessage({id:"email.unverified",defaultMessage:"email unverified"}),rules:[{type:"email"}],readonly:!0}),(0,C.jsx)(g.Z,{name:"mobile",label:s.mobileVerified?e.formatMessage({id:"mobile.verified",defaultMessage:"Mobile Verified"}):e.formatMessage({id:"mobile.unverified",defaultMessage:"mobile unverified"}),readonly:!0}),(0,C.jsx)(w.Z,{name:"description",label:e.formatMessage({id:"description",defaultMessage:"Description"})})]})),(0,C.jsx)(k,{open:V,onClose:function(){A(!1)}})]})}},85576:function(e,n,r){r.d(n,{Z:function(){return x}});var s=r(56080),a=r(38657),o=r(56745),t=r(67294),l=r(93967),i=r.n(l),c=r(40974),u=r(8745),f=r(53124),d=r(35792),p=r(32409),m=r(4941),g=r(71194),w=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)n.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]])}return r};var b=(0,u.i)((e=>{const{prefixCls:n,className:r,closeIcon:s,closable:a,type:o,title:l,children:u,footer:b}=e,h=w(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:v}=t.useContext(f.E_),P=v(),x=n||v("modal"),y=(0,d.Z)(P),[Z,j,M]=(0,g.ZP)(x,y),C=`${x}-confirm`;let k={};return k=o?{closable:null!=a&&a,title:"",footer:"",children:t.createElement(p.O,Object.assign({},e,{prefixCls:x,confirmPrefixCls:C,rootPrefixCls:P,content:u}))}:{closable:null==a||a,title:l,footer:null!==b&&t.createElement(m.$,Object.assign({},e)),children:u},Z(t.createElement(c.s,Object.assign({prefixCls:x,className:i()(j,`${x}-pure-panel`,o&&C,o&&`${C}-${o}`,r,M,y)},h,{closeIcon:(0,m.b)(x,s),closable:a},k)))})),h=r(94423);function v(e){return(0,s.ZP)((0,s.uW)(e))}const P=o.Z;P.useModal=h.Z,P.info=function(e){return(0,s.ZP)((0,s.cw)(e))},P.success=function(e){return(0,s.ZP)((0,s.vq)(e))},P.error=function(e){return(0,s.ZP)((0,s.AQ)(e))},P.warning=v,P.warn=v,P.confirm=function(e){return(0,s.ZP)((0,s.Au)(e))},P.destroyAll=function(){for(;a.Z.length;){const e=a.Z.pop();e&&e()}},P.config=s.ai,P._InternalPanelDoNotUseOrYouWillBeFired=b;var x=P}}]);