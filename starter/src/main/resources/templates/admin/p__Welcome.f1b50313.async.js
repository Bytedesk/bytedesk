"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8185],{61124:function(n,e,r){r.d(e,{Kq:function(){return f},RL:function(){return d}});var t=r(90819),i=r.n(t),o=r(73193),a=r.n(o),u=r(89933),c=r.n(u),s=r(77667),l=r(82045);function f(n){return p.apply(this,arguments)}function p(){return(p=c()(i()().mark((function n(e){return i()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,l.request)("/api/v1/org/create",{method:"POST",data:a()(a()({},e),{},{client:s.bVn})}));case 1:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function d(n){return g.apply(this,arguments)}function g(){return(g=c()(i()().mark((function n(e){return i()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,l.request)("/api/v1/org/update",{method:"POST",data:a()(a()({},e),{},{client:s.bVn})}));case 1:case"end":return n.stop()}}),n)})))).apply(this,arguments)}},62538:function(n,e,r){r.r(e),r.d(e,{default:function(){return j}});var t=r(90819),i=r.n(t),o=r(89933),a=r.n(o),u=r(45332),c=r.n(u),s=r(89756),l=r(61124),f=r(40431),p=r(77667),d=r(74828),g=r(82045),h=r(64476),w=r(38923),y=r(19140),v=r(44194),m=(r(73193),r(72434),r(50477),r(82835),r(40751),r(56337),r(51338),r(31549)),b=(r(78603),r(41525),r(95943),r(62599),r(9486),r(83730)),x=r(12265),k=h.Z.Content,O={marginLeft:20,marginTop:10,marginRight:20},j=function(){var n=(0,g.useNavigate)(),e=((0,g.useModel)("@@initialState").initialState||{}).userInfo,r=(0,f.u)((function(n){return n.setCurrentOrg})),t=(0,v.useState)(!1),o=c()(t,2),u=o[0],j=o[1],C=(0,v.useState)(""),S=c()(C,2),Z=S[0],z=S[1],P=(0,v.useState)(!1),q=c()(P,2),V=q[0],T=q[1],E=(0,v.useState)(!1),K=c()(E,2),L=K[0],R=K[1],A=function(){var n=a()(i()().mark((function n(){return i()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=e){n.next=2;break}return n.abrupt("return");case 2:if(null!==(null==e?void 0:e.currentOrganization)&&void 0!==(null==e?void 0:e.currentOrganization)){n.next=6;break}return console.log("before initOrganization",e),(null==e?void 0:e.platform)===p.Ogg&&R(!0),n.abrupt("return");case 6:console.log("after initOrganization"),r(null==e?void 0:e.currentOrganization);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),B=function(){var n=a()(i()().mark((function n(){var t,o,a;return i()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==Z){n.next=3;break}return s.yw.error("请输入组织名称"),n.abrupt("return");case 3:return j(!0),s.yw.loading("创建组织中，请稍后..."),t=null!=e&&e.mobile?null==e?void 0:e.mobile:null==e?void 0:e.email,o={name:Z,code:t,logo:"https://www.weiyuai.cn/logo.png",description:Z+"description"},n.next=9,(0,l.Kq)(o);case 9:a=n.sent,console.log("createOrg response:",a),200===a.code?(j(!1),r(a.data),s.yw.destroy(),s.yw.success("创建组织成功"),R(!1),window.location.reload()):(j(!1),s.yw.destroy(),s.yw.error(a.message));case 13:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,v.useEffect)((function(){A(),null!=e&&e.emailVerified||null!=e&&e.mobileVerified||(console.log("before verifyAccount",e),s.yw.error("请先验证邮箱和手机号"),n("/setting/certification")),(0,d.Bc)()&&console.log("weiyuaiSaas")}),[e]),(0,m.jsx)(h.Z,{children:(0,m.jsxs)(k,{style:O,children:[(0,m.jsx)(w.Z,{description:"欢迎使用微语"}),!1,(0,m.jsxs)(b.Z,{title:"未发现所在组织",open:L,onOk:B,onCancel:function(){s.yw.error("请创建或加入组织")},maskClosable:!1,footer:[(0,m.jsx)(x.ZP,{type:"primary",onClick:function(){R(!1)},disabled:!0,children:"加入已有组织(即将上线)"},"join"),(0,m.jsx)(x.ZP,{type:"primary",loading:u,onClick:function(){V?B():(T(!0),j(!1))},children:"创建组织"},"create")],children:[(0,m.jsx)("p",{children:"您需要创建或加入已有组织"}),V&&(0,m.jsx)(y.Z,{placeholder:"请输入组织名称",value:Z,onChange:function(n){return z(n.target.value)},onPressEnter:B})]})]})})}}}]);