"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9828],{95557:function(e,t,r){r.r(t),r.d(t,{default:function(){return Me}});var n=r(64476),s=r(44194),a=r(90819),o=r.n(a),i=r(89933),u=r.n(i),l=r(45332),c=r.n(l),d=r(32078),g=r(97910),f=r(12007),p=r(39522),m=r(43292),v=r(60346),h=r(42411),k=r(50484),y=r(70458),x=r(79434),b=r(83730),j=r(80093),Z=r(12265),w=r(90136),M=r(21276),F=r(79720),S=r(5728),C=r(43688),q=r(8091),W=r(31549),P=function(e){var t=e.open,r=e.onClose,n=e.onSubmit,a=S.A.useForm(),o=c()(a,1)[0],i=(0,F.Z)().translateString,u=(0,v.u)((function(e){return e.currentOrg})),l=(0,m.E)((function(e){return e.agentResult})),d=(0,s.useState)([]),g=c()(d,2),f=g[0],p=g[1];return(0,W.jsx)("div",{children:(0,W.jsx)(b.Z,{title:"创建技能组",open:t,forceRender:!0,onOk:function(){console.log("handleOk"),o.validateFields().then((function(e){console.log("form values:",e);var t={nickname:o.getFieldValue("nickname"),agentUids:o.getFieldValue("agents"),orgUid:u.uid};console.log("workgroup:",t),n(t)})).catch((function(e){console.log("Form errors:",e)}))},onCancel:function(){console.log("handleCancel"),r()},children:(0,W.jsxs)(S.A,{form:o,name:"wgForm",submitter:{render:function(e,t){return(0,W.jsx)(W.Fragment,{})}},children:[(0,W.jsx)(C.Z,{label:"技能组昵称",name:"nickname",rules:[{required:!0,message:"请输入昵称!"}]}),(0,W.jsx)(q.Z,{name:"agents",label:"成员",options:l.data.content.map((function(e){return{value:e.uid,label:i(e.nickname)}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:"请选择成员",value:f,onChange:function(e){console.log("selected ".concat(e)),p(e)}}})]})})})},D=function(){var e=(0,x.useIntl)(),t=(0,s.useRef)(!1),r=(0,F.Z)().translateStringTranct,n=(0,p.Z)().isDarkMode,a=(0,s.useState)(!1),i=c()(a,2),l=i[0],S=i[1],C=(0,v.u)((function(e){return e.currentOrg})),q=(0,m.E)((function(e){return e.setAgentResult})),D=(0,h.$)((function(e){return{workgroupResult:e.workgroupResult,currentWorkgroup:e.currentWorkgroup,setWorkgroupResult:e.setWorkgroupResult,insertWorkgroup:e.insertWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup,deleteCurrentWorkgroup:e.deleteCurrentWorkgroup}})),U=D.workgroupResult,A=D.currentWorkgroup,R=D.setWorkgroupResult,E=D.insertWorkgroup,T=D.setCurrentWorkgroup,I=D.deleteCurrentWorkgroup,V=b.Z.useModal(),z=c()(V,2),G=z[0],L=z[1],O=function(t){G.confirm({title:e.formatMessage({id:"deleteTip"}),icon:(0,W.jsx)(k.Z,{}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(t.nickname,"】？"),onOk:function(){B(t)},onCancel:function(){},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})},B=function(){var t=u()(o()().mark((function t(r){var n;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("delete workgroup",r),d.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),t.next=4,(0,f.zl)(r);case 4:n=t.sent,console.log("delete workgroup response",n),200===n.code?(d.yw.destroy(),d.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),I(r.uid)):(d.yw.destroy(),d.yw.error(n.message));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=function(){var e=u()(o()().mark((function e(){var t,r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pageNumber:0,pageSize:50,orgUid:C.uid},e.next=3,(0,g._t)(t);case 3:r=e.sent,console.log("queryAgentsByOrg: ",r),200===r.code?q(r):d.yw.error(r.message);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=u()(o()().mark((function e(){var r,n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.current){e.next=3;break}return console.log("isLoading: 1",t.current),e.abrupt("return");case 3:return t.current=!0,d.yw.loading("loading"),r={pageNumber:0,pageSize:50,orgUid:C.uid},e.next=8,(0,f.u7)(r);case 8:n=e.sent,console.log("getWorkgroups",n),200===n.code?(d.yw.destroy(),R(n)):(d.yw.destroy(),d.yw.error(n.message)),t.current=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){H(),N()}),[]);var Q=function(){var t=u()(o()().mark((function t(r){var n;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("handleSave",r),d.yw.loading(e.formatMessage({id:"creating",defaultMessage:"Creating"})),t.next=4,(0,f.p0)(r);case 4:n=t.sent,console.log("create workgroup:",n),200===n.code?(d.yw.destroy(),d.yw.success(e.formatMessage({id:"create.success",defaultMessage:"create success"})),S(!1),E(n.data)):(d.yw.destroy(),S(!1),d.yw.error(n.message));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(j.Z,{style:{margin:10},gap:"small",align:"flex-start",children:[(0,W.jsx)(Z.ZP,{size:"small",type:"primary",icon:(0,W.jsx)(y.Z,{}),onClick:function(){S(!0)},children:e.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,W.jsx)(Z.ZP,{size:"small",onClick:H,children:e.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,W.jsx)(Z.ZP,{onClick:function(){return O(A)},size:"small",danger:!0,disabled:A&&""===A.uid,children:e.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,W.jsx)(w.Z,{itemLayout:"horizontal",dataSource:U.data.content,renderItem:function(e,t){return(0,W.jsx)(w.Z.Item,{style:A.uid===e.uid?{backgroundColor:n?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){T(e)},children:(0,W.jsx)(w.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,W.jsx)(M.C,{src:e.avatar}),title:(0,W.jsx)(W.Fragment,{children:r(e.nickname)}),description:r(e.description)})},e.uid)}}),(0,W.jsx)(P,{open:l,onClose:function(){S(!1)},onSubmit:Q}),L]})},U=r(50571),A=r(73193),R=r.n(A),E=r(11607),T=r(69957),I=r(11968),V=function(){var e=S.A.useForm(),t=c()(e,1)[0],r=(0,x.useIntl)(),n=(0,F.Z)().translateString,a=(0,m.E)((function(e){return e.agentResult})),i=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),l=i.currentWorkgroup,g=i.setCurrentWorkgroup,p=(0,s.useState)([]),v=c()(p,2),k=v[0],y=v[1],b=(0,s.useState)(""),j=c()(b,2),w=j[0],P=j[1];(0,s.useEffect)((function(){if(l){var e;t.setFieldValue("nickname",n(null==l?void 0:l.nickname)),t.setFieldValue("description",n(null==l?void 0:l.description));var r=[];null===(e=l.agents)||void 0===e||e.forEach((function(e){r.push(e.uid)})),y(r)}}),[l]);var D=function(){var e=u()(o()().mark((function e(t){var n,s,a,i,u,c,p,m,v;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish",t),d.yw.loading("修改中..."),m=R()(R()(R()({},l),t),{},{avatar:w,agentUids:k,serviceSettings:R()(R()({},l.serviceSettings),{},{robotUid:null===(n=l.serviceSettings)||void 0===n||null===(n=n.robot)||void 0===n?void 0:n.uid,quickFaqUids:null===(s=l.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==l||null===(a=l.serviceSettings)||void 0===a||null===(a=a.faqs)||void 0===a?void 0:a.map((function(e){return e.uid})),guessFaqUids:null==l||null===(i=l.serviceSettings)||void 0===i||null===(i=i.guessFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),hotFaqUids:null===(u=l.serviceSettings)||void 0===u||null===(u=u.hotFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),shortcutFaqUids:null==l||null===(c=l.serviceSettings)||void 0===c||null===(c=c.shortcutFaqs)||void 0===c?void 0:c.map((function(e){return e.uid})),worktimeUids:null===(p=l.serviceSettings)||void 0===p||null===(p=p.worktimes)||void 0===p?void 0:p.map((function(e){return e.uid}))})}),console.log("workgroupObject:",m),e.next=6,(0,f.W5)(m);case 6:v=e.sent,console.log("updateWorkGroup response:",v),200===v.code?(d.yw.destroy(),d.yw.success(r.formatMessage({id:"update.success"})),g(v.data)):(d.yw.destroy(),d.yw.error(v.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){P(null==l?void 0:l.avatar)}),[l]),(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(S.A,{form:t,style:{marginLeft:"100px",width:"300px"},onFinish:D,children:[(0,W.jsx)(S.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:r.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,W.jsxs)(I.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e),P(e)},onError:function(e){console.log("handleUploadError:",e),d.yw.error(e)},children:[(0,W.jsx)(M.C,{src:w}),(0,W.jsx)(Z.ZP,{icon:(0,W.jsx)(T.Z,{}),children:r.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,W.jsx)(C.Z,{width:"md",name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入技能组昵称"}]}),(0,W.jsx)(q.Z,{name:"agents",label:"成员",width:"md",options:a.data.content.map((function(e){return{value:e.uid,label:n(e.nickname)}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:"请选择成员",value:k,onChange:function(e){console.log("selected ".concat(e)),y(e)}},rules:[{required:!0,message:"请选择成员"}]}),(0,W.jsx)(E.Z,{width:"md",name:"description",label:"描述",rules:[{required:!0,message:"请输入描述"}]})]})})},z=r(18850),G=r(2724),L=r(17082),O=r(51190),B=r(19753),N=r(33959),H=r(79379),Q=r(5986),$=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],J=s.forwardRef((function(e,t){var r=e.fieldProps,n=e.options,s=e.radioType,a=e.layout,o=e.proFieldProps,i=e.valueEnum,u=(0,O.Z)(e,$);return(0,W.jsx)(Q.Z,(0,L.Z)((0,L.Z)({valueType:"button"===s?"radioButton":"radio",ref:t,valueEnum:(0,B.h)(i,void 0)},u),{},{fieldProps:(0,L.Z)({options:n,layout:a},r),proFieldProps:o,filedConfig:{customLightMode:!0}}))})),K=s.forwardRef((function(e,t){var r=e.fieldProps,n=e.children;return(0,W.jsx)(N.ZP,(0,L.Z)((0,L.Z)({},r),{},{ref:t,children:n}))})),_=(0,H.G)(K,{valuePropName:"checked",ignoreWidth:!0});_.Group=J,_.Button=N.ZP.Button,_.displayName="ProFormComponent";var X=_,Y=r(47807),ee=function(){var e=Y.Z.useForm(),t=c()(e,1)[0],r=(0,x.useIntl)(),n=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),a=n.currentWorkgroup,i=n.setCurrentWorkgroup,l=(0,s.useState)(!1),g=c()(l,2),p=(g[0],g[1]),m=(0,s.useState)(z.Jxp),v=c()(m,2),k=v[0],y=v[1];(0,s.useEffect)((function(){return h.$.subscribe((function(e){t.setFieldValue("recent",e.currentWorkgroup.recent),t.setFieldValue("routeType",e.currentWorkgroup.routeType)}))}),[a]),(0,s.useEffect)((function(){p(a.recent),y(a.routeType)}),[]);var b=function(){var e=u()(o()().mark((function e(t){var n,s,u,l,c,g;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish:",t),d.yw.loading("正在修改..."),c=R()(R()(R()({},a),{},{agentUids:a.agents.map((function(e){return e.uid}))},t),{},{serviceSettings:R()(R()({},a.serviceSettings),{},{robotUid:null===(n=a.serviceSettings)||void 0===n||null===(n=n.robot)||void 0===n?void 0:n.uid,quickFaqUids:null===(s=a.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null===(u=a.serviceSettings)||void 0===u||null===(u=u.faqs)||void 0===u?void 0:u.map((function(e){return e.uid})),worktimeUids:null===(l=a.serviceSettings)||void 0===l||null===(l=l.worktimes)||void 0===l?void 0:l.map((function(e){return e.uid}))})}),console.log("workgroupObject:",c),e.next=6,(0,f.W5)(c);case 6:g=e.sent,console.log("updateWorkGroup response:",g),200===g.code?(d.yw.destroy(),d.yw.success(r.formatMessage({id:"update.success"})),i(g.data)):(d.yw.destroy(),d.yw.error(g.message));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(S.A,{form:t,style:{marginLeft:"100px"},initialValues:{recent:null==a?void 0:a.recent,routeType:null==a?void 0:a.routeType},submitter:{render:function(e,t){return[(0,W.jsx)(Z.ZP,{type:"primary",onClick:function(){var t;null===(t=e.form)||void 0===t||t.submit()},children:"保存"},"submit")]}},onFinish:b,children:[(0,W.jsx)(G.Z,{name:"recent",label:"熟客优先",fieldProps:{onChange:function(e){console.log("checked = ".concat(e.target.checked)),p(e.target.checked)}}}),(0,W.jsx)(X.Group,{name:"routeType",label:"路由类型",options:[{label:"轮询",value:z.Jxp},{label:"当日接待最少优先",value:z.Cap},{label:"饱和度最低优先",value:z.Vdp},{label:"进行中会话最少优先",value:z.Q2z}],fieldProps:{value:k,onChange:function(e){console.log("radio checked",e.target.value),y(e.target.value)}}}),(0,W.jsxs)(S.A.Item,{children:[k===z.Jxp&&(0,W.jsx)("p",{children:"根据客服上线时间进入队列轮流分配。注意：当客服网络不稳定掉线重连之后，会重新排到队列末尾"}),k===z.Cap&&(0,W.jsx)("p",{children:"根据当日(0点开始)客服接待总数进行分配，优先分配给数量最少者。注意：假如客服上班时间不统一，晚登录者登录后会集中收到分配新客，直到跟其他在线客服接待数量相等为止"}),k===z.Vdp&&(0,W.jsx)("p",{children:"根据（客服最大接待数量-当前进行中会话数量）之差分配，优先分配给数量最大者。注意：假如每个客服最大接待数量相等，则此方法跟’进行中会话最少优先‘效果一样"}),k===z.Q2z&&(0,W.jsx)("p",{children:"根据客服当前进行中会话进行分配，优先分配给数量最少者。注意：客服接待数量会受到客服接待速度的影响，接待完毕之后，客服手动结束会话有利于加速分配新客"})]})]})})},te=r(93982),re=r(90382),ne=r(26101),se=r(63557),ae=r(75761),oe=r(75352),ie=r(91325),ue=r(31160),le=r(51593),ce=r(99648),de=r(16655),ge=r(67025),fe=r(71705),pe=function(){var e=(0,x.useIntl)(),t=(0,s.useMemo)((function(){return!0}),[]),r=[{key:"faq",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faq",defaultMessage:"FAQ"}),children:(0,W.jsx)(re.Z,{type:z.aZD}),disabled:t},{key:"quickFaqs",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.quickbutton",defaultMessage:"QuickButton"}),children:(0,W.jsx)(ue.Z,{type:z.aZD}),disabled:t},{key:"faqGuess",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faqGuess",defaultMessage:"FaqGuess"}),children:(0,W.jsx)(le.Z,{type:z.aZD}),disabled:t},{key:"faqHot",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faqHot",defaultMessage:"FaqHot"}),children:(0,W.jsx)(ne.Z,{type:z.aZD}),disabled:t},{key:"faqShortcut",label:(0,W.jsx)(x.FormattedMessage,{id:"menu.knowledge.faqShortcut",defaultMessage:"FaqShortcut"}),children:(0,W.jsx)(se.Z,{type:z.aZD}),disabled:t},{key:"rate",label:(0,W.jsx)(x.FormattedMessage,{id:"rate",defaultMessage:"Rate"}),children:(0,W.jsx)(ae.Z,{type:z.aZD}),disabled:t},{key:"leaveMsg",label:(0,W.jsx)(x.FormattedMessage,{id:"leavemsg",defaultMessage:"Leave Msg"}),children:(0,W.jsx)(oe.Z,{type:z.aZD}),disabled:t},{key:"survey",label:(0,W.jsx)(x.FormattedMessage,{id:"survey",defaultMessage:"Survey"}),children:(0,W.jsx)(fe.Z,{type:z.aZD}),disabled:t},{key:"history",label:(0,W.jsx)(x.FormattedMessage,{id:"history",defaultMessage:"History"}),children:(0,W.jsx)(ce.Z,{type:z.aZD}),disabled:t},{key:"inputassociation",label:(0,W.jsx)(x.FormattedMessage,{id:"inputassociation",defaultMessage:"Input Association"}),children:(0,W.jsx)(ge.Z,{type:z.aZD}),disabled:t},{key:"antiharassment",label:(0,W.jsx)(x.FormattedMessage,{id:"antiharassment",defaultMessage:"Anti Harassment"}),children:(0,W.jsx)(ie.Z,{type:z.aZD}),disabled:t}];return(0,W.jsxs)(W.Fragment,{children:[t&&(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(te.Z,{message:"企业版-高级功能",style:{marginBottom:20},type:"warning",action:(0,W.jsx)(Z.ZP,{type:"link",icon:(0,W.jsx)(de.Z,{}),onClick:function(){return window.open(z.VPj)},children:e.formatMessage({id:"setting.helpcenter"})})})}),(0,W.jsx)(U.Z,{tabPosition:"left",items:r})]})},me=r(84025),ve=r(88598),he=r(98788),ke=r(62807),ye=r(73189),xe=r(11888),be=function(){var e=(0,x.useIntl)(),t=(0,s.useState)([]),r=c()(t,2),n=r[0],a=r[1],o=[{key:"basic",label:e.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,W.jsx)(V,{})},{key:"serviceSettings",label:e.formatMessage({id:"pages.agent.service.settings",defaultMessage:"Service Settings"}),children:(0,W.jsx)(xe.Z,{type:z.aZD})},{key:"robot",label:e.formatMessage({id:"pages.agent.robot",defaultMessage:"Robot"}),children:(0,W.jsx)(ye.Z,{type:z.aZD})},{key:"route",label:e.formatMessage({id:"pages.workgroup.tab.route",defaultMessage:"Route"}),children:(0,W.jsx)(ee,{})},{key:"advanced",label:e.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,W.jsx)(pe,{})},{key:"channel",label:e.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,W.jsx)(me.Z,{type:z.aZD})},{key:"channelsocial",label:e.formatMessage({id:"channelsocial",defaultMessage:"Social Channel"}),children:(0,W.jsx)(ve.Z,{type:z.aZD})},{key:"channelshop",label:e.formatMessage({id:"channelshop",defaultMessage:"Shop Channel"}),children:(0,W.jsx)(ke.Z,{type:z.aZD})},{key:"channelforeign",label:e.formatMessage({id:"channelforeign",defaultMessage:"Foreign Channel"}),children:(0,W.jsx)(he.Z,{type:z.aZD})}];return(0,s.useEffect)((function(){a(o)}),[]),(0,W.jsx)(U.Z,{defaultActiveKey:"basic",items:n})},je=r(66964),Ze=n.Z.Sider,we=n.Z.Content,Me=function(){var e=(0,je.Z)(),t=e.leftSiderStyle,r=e.leftSiderWidth;return(0,W.jsxs)(n.Z,{children:[(0,W.jsx)(Ze,{width:r,style:t,children:(0,W.jsx)(D,{})}),(0,W.jsx)(n.Z,{children:(0,W.jsx)(we,{children:(0,W.jsx)(be,{})})})]})}}}]);