"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2730],{72730:function(e,a,t){t.d(a,{uploadScreenshot:function(){return o}});var i=t(79430),n=t(94557);async function o(e,a){var t;const o=`screenshot_${(new Date).toISOString().replace(/[-:T.]/g,"").slice(0,14)}.jpg`;return(null==(t=(await async function(e,a,t,o){try{const l=(new Date).toISOString().replace(/[-:T.]/g,"").slice(0,14),r=a||`${l}_${e.name}`,d=t||e.type||"image/jpeg",s=new FormData;s.append("file",e),s.append("fileName",r),s.append("fileType",d),s.append("isAvatar",(null==o?void 0:o.isAvatar)||"false"),s.append("kbType",(null==o?void 0:o.kbType)||"feedback");const p=(null==o?void 0:o.visitorUid)||localStorage.getItem("bytedesk_uid")||localStorage.getItem("bytedesk_visitor_uid")||"",c=(null==o?void 0:o.visitorNickname)||localStorage.getItem("bytedesk_nickname")||"",u=(null==o?void 0:o.visitorAvatar)||localStorage.getItem("bytedesk_avatar")||"",g=(null==o?void 0:o.orgUid)||"";s.append("visitorUid",p),s.append("visitorNickname",c),s.append("visitorAvatar",u),s.append("orgUid",g),s.append("client",(null==o?void 0:o.client)||"web"),null!=o&&o.isDebug&&n.Z.debug("handleUpload formData",s);const v=`${(0,i.k)()}/visitor/api/upload/file`,k=await fetch(v,{method:"POST",headers:{},body:s});if(!k.ok)throw new Error(`上传失败: ${k.status} ${k.statusText}`);const b=await k.json();return null!=o&&o.isDebug&&n.Z.debug("upload data:",b),b}catch(e){throw n.Z.error("文件上传失败:",e),e}}(e,o,"image/jpeg",{...a,kbType:"feedback"})).data)?void 0:t.fileUrl)||""}}}]);