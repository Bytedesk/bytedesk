"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4458],{31806:function(e,t,a){a.d(t,{Z:function(){return r}});var i=a(83910),n=a(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},u=a(54183),l=function(e,t){return n.createElement(u.Z,(0,i.Z)({},e,{ref:t,icon:s}))};var r=n.forwardRef(l)},58791:function(e,t,a){var i=a(83910),n=a(44194),s=a(85333),u=a(54183),l=function(e,t){return n.createElement(u.Z,(0,i.Z)({},e,{ref:t,icon:s.Z}))},r=n.forwardRef(l);t.Z=r},7704:function(e,t,a){a.d(t,{AP:function(){return m},_J:function(){return h},t5:function(){return c},v_:function(){return v}});var i=a(90819),n=a.n(i),s=a(73193),u=a.n(s),l=a(89933),r=a.n(l),o=a(39497),d=a(14906);function m(e){return f.apply(this,arguments)}function f(){return(f=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/query/org",{method:"GET",params:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return(g=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/create",{method:"POST",data:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return p.apply(this,arguments)}function p(){return(p=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/update",{method:"POST",data:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return M.apply(this,arguments)}function M(){return(M=r()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/delete",{method:"POST",data:u()(u()({},t),{},{channel:o.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},417:function(e,t,a){var i=a(90819),n=a.n(i),s=a(89933),u=a.n(s),l=a(45332),r=a.n(l),o=a(73614),d=a(91361),m=a(71256),f=a(11329),v=a(25784),g=(a(2250),a(89965),a(41196)),c=a(14906),p=a(44194),h=a(33019),M=a(98830),x=(a(39497),a(31549));t.Z=function(e){var t,a,i=e.messageLeaveSettings,s=e.onMessageLeaveSettingsChange,l=(0,c.useIntl)(),w=(0,d.Z)().translateString,y=v.A.useForm(),T=r()(y,1)[0],b=(null===(t=g.Z.useWatch)||void 0===t||t.call(g.Z,"messageLeaveNotify",T),null===(a=g.Z.useWatch)||void 0===a?void 0:a.call(g.Z,"messageLeaveNotifyType",T)),q=(0,M.u)((function(e){return e.currentOrg})),L=(0,p.useMemo)((function(){return null!=i?i:{}}),[i]),k=(0,p.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==L?void 0:L.draft)&&void 0!==t?t:null==L?void 0:L.live)&&void 0!==e?e:void 0}),[L]),j=((0,p.useMemo)((function(){return[{label:l.formatMessage({id:"leavemsg.notify.email",defaultMessage:"Email"}),value:"EMAIL"},{label:l.formatMessage({id:"leavemsg.notify.sms",defaultMessage:"SMS"}),value:"SMS"},{label:l.formatMessage({id:"leavemsg.notify.email_sms",defaultMessage:"Email + SMS"}),value:"EMAIL_SMS"}]}),[l]),(0,p.useRef)("")),Z=(0,p.useState)(""),W=r()(Z,2),E=W[0],P=W[1],S=(0,p.useCallback)((function(e){e&&0!==Object.keys(e).length&&(null==s||s(e))}),[s]);(0,p.useEffect)((function(){var e,t,a;T.setFieldsValue({messageLeaveEnabled:null===(e=null==k?void 0:k.messageLeaveEnabled)||void 0===e||e,messageLeaveAgentUid:null==k?void 0:k.messageLeaveAgentUid,messageLeaveNotify:null!==(t=null==k?void 0:k.messageLeaveNotify)&&void 0!==t&&t,messageLeaveNotifyType:null!==(a=null==k?void 0:k.messageLeaveNotifyType)&&void 0!==a?a:"EMAIL",messageLeaveNotifyEmail:null==k?void 0:k.messageLeaveNotifyEmail,messageLeaveNotifyMobile:null==k?void 0:k.messageLeaveNotifyMobile,messageLeaveForm:null==k?void 0:k.messageLeaveForm});var i=w(null==k?void 0:k.messageLeaveTip)||"";j.current!==i&&(j.current=i,P(i),T.setFieldValue("messageLeaveTip",i))}),[k,T,w]);var C=(0,p.useCallback)((function(e){S(e)}),[S]),F=(0,p.useCallback)((function(e){j.current=e,P(e),T.setFieldValue("messageLeaveTip",e),S({messageLeaveTip:e})}),[S,T]),V=((0,p.useCallback)(function(){var e=u()(n()().mark((function e(t){var a,i,s;return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=q&&q.uid){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,(0,h._t)({pageNumber:0,pageSize:100,orgUid:q.uid,searchText:null!=t?t:""});case 5:if(200!==(null==(a=e.sent)?void 0:a.code)){e.next=8;break}return e.abrupt("return",(null!==(i=null==a||null===(s=a.data)||void 0===s?void 0:s.content)&&void 0!==i?i:[]).map((function(e){return{label:(null==e?void 0:e.nickname)||(null==e?void 0:e.uid),value:null==e?void 0:e.uid}})).filter((function(e){return Boolean(e.value)})));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),[null==q?void 0:q.uid]),!1);null!=b||null==k||k.messageLeaveNotifyType;return(0,x.jsxs)(v.A,{form:T,submitter:!1,style:{marginLeft:"20px"},onValuesChange:function(e){return C(e)},children:[!1,(0,x.jsx)(v.A.Item,{name:"messageLeaveTip",label:(0,x.jsxs)("span",{children:[l.formatMessage({id:"agent.settings.leave.msg"}),(0,x.jsx)(o.Z,{type:"messageLeave",keys:["messageLeaveTip"],live:null==L?void 0:L.live,draft:null==L?void 0:L.draft})]}),rules:[{required:!0,message:l.formatMessage({id:"agent.settings.leave.msg.required"})}],children:(0,x.jsx)(f.Z,{placeholder:l.formatMessage({id:"agent.settings.leave.msg.placeholder"}),value:E,toolbarKeys:(0,m.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:F},"messageLeaveTipEditor")}),!1,V,V,false,false]})}},24476:function(e,t,a){var i=a(45332),n=a.n(i),s=a(73614),u=a(25784),l=a(60796),r=a(80953),o=a(14906),d=a(44194),m=a(31549);t.Z=function(e){e.variant;var t,a,i=e.queueSettings,f=e.onQueueSettingsChange,v=(0,o.useIntl)(),g=u.A.useForm(),c=n()(g,1)[0],p=(0,d.useRef)(!1),h=u.A.useWatch("showEstimatedWaitTime",c),M=(0,d.useMemo)((function(){return{position:"{position}",waitTime:"{waitTime}"}}),[]),x=(0,d.useMemo)((function(){return null!=i?i:{}}),[i]),w=(0,d.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==x?void 0:x.draft)&&void 0!==t?t:null==x?void 0:x.live)&&void 0!==e?e:void 0}),[null==x?void 0:x.draft,null==x?void 0:x.live]),y=(0,d.useCallback)((function(e){e&&0!==Object.keys(e).length&&(null==f||f(e))}),[f]),T=(0,d.useCallback)((function(e,t){var a=!1!==t,i=[];return!1!==e&&i.push(v.formatMessage({id:"queue.settings.tip.fragment.position",defaultMessage:"您前面还有 {position} 人排队"},M)),a&&i.push(v.formatMessage({id:"queue.settings.tip.fragment.wait",defaultMessage:"预计等待 {waitTime}"},M)),i.push(v.formatMessage({id:"queue.settings.tip.fragment.suffix",defaultMessage:"请耐心等候。"})),i.filter(Boolean).join("，")}),[v,M]),b=(0,d.useCallback)((function(e){var t=e&&"showQueuePosition"in e?e.showQueuePosition:c.getFieldValue("showQueuePosition"),a=e&&"showEstimatedWaitTime"in e?e.showEstimatedWaitTime:c.getFieldValue("showEstimatedWaitTime"),i=T(t,a);c.getFieldValue("queueTip")!==i&&(p.current=!0,c.setFieldsValue({queueTip:i}),p.current=!1,y({queueTip:i}))}),[T,y,c]);(0,d.useEffect)((function(){var e,t,a,i,n,s,u,l;p.current=!0,c.setFieldsValue({queueRobot:null!==(e=null==w?void 0:w.queueRobot)&&void 0!==e&&e,showQueuePosition:null===(t=null==w?void 0:w.showQueuePosition)||void 0===t||t,showEstimatedWaitTime:null===(a=null==w?void 0:w.showEstimatedWaitTime)||void 0===a||a,avgWaitTimePerPerson:null!==(i=null==w?void 0:w.avgWaitTimePerPerson)&&void 0!==i?i:60,maxWaiting:null!==(n=null==w?void 0:w.maxWaiting)&&void 0!==n?n:1e4,maxWaitTime:null!==(s=null==w?void 0:w.maxWaitTime)&&void 0!==s?s:86400,queueTip:null!==(u=null==w?void 0:w.queueTip)&&void 0!==u?u:"",queueReadyTip:null!==(l=null==w?void 0:w.queueReadyTip)&&void 0!==l?l:""}),p.current=!1}),[w,c]);var q=(0,d.useCallback)((function(e){p.current||(y(e),("showQueuePosition"in e||"showEstimatedWaitTime"in e)&&b(e))}),[y,b]);t=null!=h?h:null==w?void 0:w.showEstimatedWaitTime;return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(u.A,{layout:"vertical",form:c,submitter:!1,style:{marginLeft:"20px"},onValuesChange:q,children:[(0,m.jsx)(l.Z,{width:"md",name:"maxWaiting",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.max.waiting",defaultMessage:"最大等待人数"}),(0,m.jsx)(s.Z,{type:"generic",keys:["maxWaiting"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),min:1,max:1e5,fieldProps:{precision:0},tooltip:v.formatMessage({id:"queue.settings.max.waiting.tooltip",defaultMessage:"设置允许同时排队等待的最大访客数量，超过则进入留言流程"})}),(0,m.jsx)(l.Z,{width:"md",name:"maxWaitTime",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.max.wait.time",defaultMessage:"最大等待时间(秒)"}),(0,m.jsx)(s.Z,{type:"generic",keys:["maxWaitTime"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),min:1,max:604800,fieldProps:{precision:0},tooltip:v.formatMessage({id:"queue.settings.max.wait.time.tooltip",defaultMessage:"设置访客最长排队等待时间（秒），超时后将进入留言流程"}),extra:v.formatMessage({id:"queue.settings.max.wait.time.extra",defaultMessage:"当前设置：约 {hours} 小时"},{hours:Math.round((null!==(a=null==w?void 0:w.maxWaitTime)&&void 0!==a?a:86400)/3600)})}),(0,m.jsx)(l.Z,{width:"md",name:"avgWaitTimePerPerson",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.avg.wait.time.per.person",defaultMessage:"每人平均等待时长(秒)"}),(0,m.jsx)(s.Z,{type:"generic",keys:["avgWaitTimePerPerson"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),min:1,max:600,fieldProps:{precision:0},tooltip:v.formatMessage({id:"queue.settings.avg.wait.time.per.person.tooltip",defaultMessage:"用于计算预计等待时间，预计等待时间 = 前面排队人数 × 每人平均等待时长"}),extra:v.formatMessage({id:"queue.settings.avg.wait.time.per.person.extra",defaultMessage:"默认值：60 秒（1 分钟）"})}),(0,m.jsx)(r.Z,{width:"lg",name:"queueTip",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.tip",defaultMessage:"排队提示语模板"}),(0,m.jsx)(s.Z,{type:"generic",keys:["queueTip"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),fieldProps:{rows:3,maxLength:500},placeholder:v.formatMessage({id:"queue.settings.tip.placeholder",defaultMessage:"您前面还有 {position} 人排队，预计等待 {waitTime}，请耐心等候。"},{position:M.position,waitTime:M.waitTime}),tooltip:v.formatMessage({id:"queue.settings.tip.tooltip",defaultMessage:"访客排队时显示的提示信息，支持模板变量自动替换"}),extra:(0,m.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:v.formatMessage({id:"queue.settings.tip.variables",defaultMessage:"支持的模板变量：\n• '{'position'}' - 当前排队位置（前面的排队人数）\n• '{'queueSize'}' - 当前队列总人数\n• '{'waitSeconds'}' - 预计等待秒数\n• '{'waitMinutes'}' - 预计等待分钟数\n• '{'waitTime'}' - 格式化的等待时间（如\"约5分钟\"）"})})}),(0,m.jsx)(r.Z,{width:"lg",name:"queueReadyTip",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.ready.tip",defaultMessage:"即将接入提示语"}),(0,m.jsx)(s.Z,{type:"generic",keys:["queueReadyTip"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),fieldProps:{rows:2,maxLength:200},placeholder:v.formatMessage({id:"queue.settings.ready.tip.placeholder",defaultMessage:"客服即将为您服务，请稍候..."}),tooltip:v.formatMessage({id:"queue.settings.ready.tip.tooltip",defaultMessage:"当访客排队位置为0（即前面没有人排队，下一个就是该访客）时显示的提示信息"}),extra:v.formatMessage({id:"queue.settings.ready.tip.extra",defaultMessage:"此提示语用于替代排队位置为0时的默认提示，提升用户体验"})})]})})}},52260:function(e,t,a){a(73193),a(84176),a(45332),a(14906),a(44194),a(31549)}}]);