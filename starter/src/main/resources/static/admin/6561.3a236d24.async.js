"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6561],{92936:function(e,t,n){n.d(t,{Bv:function(){return P},L0:function(){return q},QB:function(){return x},RF:function(){return j},YO:function(){return M},YQ:function(){return Z},Yg:function(){return m},kh:function(){return p},kv:function(){return b},pf:function(){return c},y:function(){return v}});var r=n(90819),i=n.n(r),a=n(73193),o=n.n(a),l=n(89933),s=n.n(l),u=n(27353),d=n(2290);function c(e){return f.apply(this,arguments)}function f(){return(f=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/query/org",{method:"GET",params:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/create",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/update",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return y.apply(this,arguments)}function y(){return(y=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/delete",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/enable",{method:"POST",data:{uid:t.uid,enabled:t.enabled,channel:u.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return S.apply(this,arguments)}function S(){return(S=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/deleteAll",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return k.apply(this,arguments)}function k(){return(k=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateIndex",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return C.apply(this,arguments)}function C(){return(C=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateVectorIndex",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return T.apply(this,arguments)}function T(){return(T=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateAllIndex",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return A.apply(this,arguments)}function A(){return(A=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateAllVectorIndex",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return U.apply(this,arguments)}function U(){return(U=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/agent/text/faq-similar-questions",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},37278:function(e,t,n){n.d(t,{Ck:function(){return m},dv:function(){return x},pw:function(){return b},qL:function(){return p},z4:function(){return v}});var r=n(90819),i=n.n(r),a=n(89933),o=n.n(a),l=n(73193),s=n.n(l),u=n(27353),d=n(2290),c="/api/v1/quickbutton";function f(e){var t;return s()(s()({},e),{},{channel:null!==(t=null==e?void 0:e.channel)&&void 0!==t?t:u.XtJ})}function p(e){return g.apply(this,arguments)}function g(){return(g=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/query/org"),{method:"GET",params:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/create"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return y.apply(this,arguments)}function y(){return(y=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/update"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/delete"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return S.apply(this,arguments)}function S(){return(S=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/enable"),{method:"POST",data:f(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},62210:function(e,t,n){var r=n(73193),i=n.n(r),a=n(90819),o=n.n(a),l=n(89933),s=n.n(l),u=n(45332),d=n.n(u),c=n(64273),f=n(50884),p=n(77129),g=n(28520),v=n(27353),h=n(97588),m=n(74056),y=n(62613),b=n(42701),w=n(17455),x=n(2290),S=n(44194),j=n(31549);t.Z=function(e){var t=h.A.useForm(),n=d()(t,1)[0],r=(0,x.useIntl)(),a=(0,g.u)((function(e){return e.currentOrg})),l=(0,S.useState)([]),u=d()(l,2),k=u[0],M=u[1],C=(0,S.useRef)(!1),q=(0,S.useMemo)((function(){var t;return null!==(t=e.serviceSettings)&&void 0!==t?t:{}}),[e.serviceSettings]),T=(0,S.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==q?void 0:q.draft)&&void 0!==t?t:null==q?void 0:q.live)&&void 0!==e?e:void 0}),[q]);return(0,S.useEffect)((function(){null!=a&&a.uid&&!C.current&&(C.current=!0,s()(o()().mark((function e(){var t,n,r,i;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pageNumber:0,pageSize:100,type:v.QPQ,orgUid:a.uid},e.next=3,(0,p.AP)(t);case 3:200===(n=e.sent).code?(i=((null===(r=n.data)||void 0===r?void 0:r.content)||[]).map((function(e){return{label:e.name||e.uid||"",value:e.uid}})),M(i)):f.yw.error(n.message);case 5:case"end":return e.stop()}}),e)})))())}),[null==a?void 0:a.uid]),(0,S.useEffect)((function(){var e,t,r,i;n.setFieldsValue({inputAssociationEnabled:null!==(e=null==T?void 0:T.inputAssociationEnabled)&&void 0!==e&&e,inputPreviewEnabled:null!==(t=null==T?void 0:T.inputPreviewEnabled)&&void 0!==t&&t,inputPreviewAlwaysShow:null!==(r=null==T?void 0:T.inputPreviewAlwaysShow)&&void 0!==r&&r,inputPreviewShowSeconds:null!==(i=null==T?void 0:T.inputPreviewShowSeconds)&&void 0!==i?i:5,inputAssociationKbUid:null==T?void 0:T.inputAssociationKbUid})}),[n,null==T?void 0:T.inputAssociationEnabled,null==T?void 0:T.inputPreviewEnabled,null==T?void 0:T.inputPreviewAlwaysShow,null==T?void 0:T.inputPreviewShowSeconds,null==T?void 0:T.inputAssociationKbUid]),(0,j.jsxs)(h.A,{form:n,submitter:!1,style:{marginLeft:20},children:["robot"!==e.variant&&(0,j.jsx)(m.Z,{name:"inputPreviewEnabled",width:"md",label:(0,j.jsxs)("span",{children:[(0,j.jsx)(x.FormattedMessage,{id:"settings.inputPreview.enable",defaultMessage:"启用访客输入预览"}),(0,j.jsx)(c.Z,{type:"service",keys:["inputPreviewEnabled"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),fieldProps:{onChange:function(t){var n;null===(n=e.onServiceSettingsChange)||void 0===n||n.call(e,i()({inputPreviewEnabled:t},t?{}:{inputPreviewAlwaysShow:!1,inputPreviewShowSeconds:5}))}}}),"robot"!==e.variant&&(0,j.jsx)(y.Z,{name:["inputPreviewEnabled","inputPreviewAlwaysShow"],children:function(t){var n=!0===(null==t?void 0:t.inputPreviewEnabled),r=!0===(null==t?void 0:t.inputPreviewAlwaysShow);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(m.Z,{name:"inputPreviewAlwaysShow",width:"md",disabled:!n,label:(0,j.jsxs)("span",{children:[(0,j.jsx)(x.FormattedMessage,{id:"settings.inputPreview.alwaysShow",defaultMessage:"输入预览一直显示"}),(0,j.jsx)(c.Z,{type:"service",keys:["inputPreviewAlwaysShow"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),fieldProps:{onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputPreviewAlwaysShow:t})}}}),(0,j.jsx)(b.Z,{name:"inputPreviewShowSeconds",width:"md",hidden:!n||r,min:1,max:600,fieldProps:{precision:0,onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputPreviewShowSeconds:"number"==typeof t?t:5})}},label:(0,j.jsxs)("span",{children:[(0,j.jsx)(x.FormattedMessage,{id:"settings.inputPreview.showSeconds",defaultMessage:"输入预览显示时长(秒)"}),(0,j.jsx)(c.Z,{type:"service",keys:["inputPreviewShowSeconds"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]})})]})}}),(0,j.jsx)(m.Z,{name:"inputAssociationEnabled",width:"md",label:(0,j.jsxs)("span",{children:[(0,j.jsx)(x.FormattedMessage,{id:"settings.inputAssociation.enable",defaultMessage:"启用访客输入联想"}),(0,j.jsx)(c.Z,{type:"service",keys:["inputAssociationEnabled"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),fieldProps:{onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputAssociationEnabled:t})}}}),(0,j.jsx)(w.Z,{name:"inputAssociationKbUid",width:"md",label:(0,j.jsxs)("span",{children:[(0,j.jsx)(x.FormattedMessage,{id:"settings.inputAssociation.kb",defaultMessage:"联想关联知识库"}),(0,j.jsx)(c.Z,{type:"service",keys:["inputAssociationKbUid"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),options:k,fieldProps:{allowClear:!0,onChange:function(t){var n;return null===(n=e.onServiceSettingsChange)||void 0===n?void 0:n.call(e,{inputAssociationKbUid:t})}},placeholder:r.formatMessage({id:"choose",defaultMessage:"Choose"})})]})}},10463:function(e,t,n){n(90819),n(89933),n(73193),n(45332),n(71981),n(87675),n(28073),n(27353),n(2290),n(44194),n(34844),n(64273),n(31549)},26809:function(e,t,n){var r=n(90819),i=n.n(r),a=n(89933),o=n.n(a),l=n(45332),s=n.n(l),u=(n(54685),n(97588)),d=n(74056),c=n(2290),f=n(44194),p=(n(53478),n(21002)),g=n(31549);t.Z=function(e){e.variant;var t=e.serviceSettings,n=e.onServiceSettingsChange,r=(0,c.useIntl)(),a=u.A.useForm(),l=s()(a,1)[0],v=(0,p.Z)().translateString,h=(0,f.useState)(!1),m=s()(h,2),y=(m[0],m[1]),b=(0,f.useState)(""),w=s()(b,2),x=(w[0],w[1]),S=(0,f.useMemo)((function(){var e,n;return null!==(e=null!==(n=null==t?void 0:t.draft)&&void 0!==n?n:null==t?void 0:t.live)&&void 0!==e?e:void 0}),[null==t?void 0:t.draft,null==t?void 0:t.live]);(0,f.useEffect)((function(){var e=!(null==S||!S.showRateBtn),t=v(null==S?void 0:S.inviteRateTip)||"";l.setFieldsValue({showRateBtn:null==S?void 0:S.showRateBtn,autoInviteRate:null==S?void 0:S.autoInviteRate}),y(e),x(t)}),[S,l,v]);var j=function(){var e=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onFinish:",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=o()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRating handleChange autoInviteRate",t),l.setFieldValue("autoInviteRate",t),null==n||n({autoInviteRate:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(u.A,{form:l,onFinish:j,submitter:!1,style:{marginLeft:"20px"},children:[(0,g.jsx)(d.Z,{width:"md",name:"autoInviteRate",label:r.formatMessage({id:"rate.auto.invite.rate"}),tooltip:r.formatMessage({id:"rate.auto.invite.rate.tooltip"}),fieldProps:{onChange:k}}),!1]})})}},21525:function(e,t,n){var r=n(76711),i=n.n(r),a=n(90819),o=n.n(a),l=n(89933),s=n.n(l),u=n(45332),d=n.n(u),c=n(50884),f=n(92936),p=n(77129),g=n(28520),v=n(21002),h=n(27353),m=n(64273),y=n(97588),b=n(74056),w=n(67186),x=n(17455),S=n(62342),j=n(2290),k=n(44194),M=n(10820),C=n(97765),q=n(31549);t.Z=function(e){var t,n,r,a,l=e.variant,u=e.serviceSettings,T=e.onServiceSettingsChange,P=e.agentRightPanelTabs,A=e.onAgentRightPanelTabsChange,Z=(e.settingsUid,e.isActive,(0,j.useIntl)()),U=y.A.useForm(),R=d()(U,1)[0],F=(0,g.u)((function(e){return e.currentOrg})),I=(0,v.Z)().translateString,K=null==u?void 0:u.live,O=null==u?void 0:u.draft,E=(0,k.useMemo)((function(){var e;return null!==(e=null!=O?O:K)&&void 0!==e?e:{}}),[O,K]),B=(0,k.useState)(),L=d()(B,2),_=L[0],V=L[1],Q=(0,k.useState)(),J=d()(Q,2),z=J[0],D=J[1],N=(0,k.useState)(),Y=d()(N,2),X=Y[0],H=Y[1],W=(0,k.useState)("iframe"),$=d()(W,2),G=$[0],ee=$[1],te=null!==(t=null==P?void 0:P.live)&&void 0!==t?t:[],ne=null!==(n=null==P?void 0:P.draft)&&void 0!==n?n:void 0,re=(0,k.useMemo)((function(){var e;return null!==(e=null!=ne?ne:te)&&void 0!==e?e:[]}),[ne,te]),ie=(0,k.useCallback)(function(){var e=s()(o()().mark((function e(t){var n,r,i,a,l,s,u,d;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||X){e.next=4;break}return console.log("TabRight: 没有选择知识库，无法获取FAQ"),V(void 0),e.abrupt("return");case 4:return c.yw.loading(Z.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:100,orgUid:null==F?void 0:F.uid,kbUid:t||X},e.prev=6,e.next=9,(0,f.pf)(n);case 9:r=e.sent,C.Z.debug("TabRight.getFaqs response:",n,r),c.yw.destroy(),200===r.code?(i={code:r.code,message:r.message,data:{content:null==r?void 0:r.data.content.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer,kbUid:e.kbUid,orgUid:e.orgUid}})),totalElements:null==r?void 0:r.data.totalElements,totalPages:null==r?void 0:r.data.totalPages,number:null==r?void 0:r.data.number}},V(i),a=t||X,l=R.getFieldValue("faqUids")||[],a&&l.length>0&&(u=(null==i||null===(s=i.data.content)||void 0===s?void 0:s.map((function(e){return e.uid})))||[],(d=l.filter((function(e){return u.includes(e)}))).length!==l.length&&R.setFieldValue("faqUids",d))):c.yw.error(r.message),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(6),c.yw.destroy(),console.error("TabRight 获取FAQ失败:",e.t0),c.yw.error("获取FAQ失败");case 20:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}(),[null==F?void 0:F.uid,R,Z,X]),ae=(0,k.useCallback)(s()(o()().mark((function e(){var t,n,r,i,a;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(Z.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:h.QPQ,orgUid:null==F?void 0:F.uid},e.prev=2,e.next=5,(0,p.AP)(t);case 5:n=e.sent,C.Z.debug("TabRight.getKbases response:",t,n),c.yw.destroy(),200===n.code?(i={code:n.code,message:n.message,data:{content:null==n?void 0:n.data.content.map((function(e){return{uid:e.uid,name:e.name,type:e.type,orgUid:e.orgUid}})),totalElements:null==n?void 0:n.data.totalElements,totalPages:null==n?void 0:n.data.totalPages,number:null==n?void 0:n.data.number}},D(i),null!=O&&O.faqKbUid?a=O.faqKbUid:null!=K&&K.faqKbUid?a=K.faqKbUid:(null==i||null===(r=i.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&(a=null==i?void 0:i.data.content[0].uid),a&&(H(a),R.setFieldValue("faqKbUid",a),ie(a))):c.yw.error(n.message),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),c.yw.destroy(),console.error("TabRight 获取知识库失败:",e.t0),c.yw.error("获取知识库失败");case 16:case"end":return e.stop()}}),e,null,[[2,11]])}))),[null==F?void 0:F.uid,R,ie,Z,null==O?void 0:O.faqKbUid,null==K?void 0:K.faqKbUid]);(0,k.useEffect)((function(){var e=Array.isArray(null==E?void 0:E.faqs)?(null==E?void 0:E.faqs).map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[];R.setFieldsValue({showRightIframe:null==E?void 0:E.showRightIframe,rightIframeUrl:null==E?void 0:E.rightIframeUrl,showFaqs:null==E?void 0:E.showFaqs,faqKbUid:null==E?void 0:E.faqKbUid,faqUids:Array.isArray(null==E?void 0:E.faqUids)?null==E?void 0:E.faqUids:e,agentRightPanelTabs:re}),null!=E&&E.faqKbUid&&E.faqKbUid!==X&&(H(E.faqKbUid),ie(E.faqKbUid))}),[R,ie,E,re,X]),(0,k.useEffect)((function(){null!=F&&F.uid&&ae()}),[null==F?void 0:F.uid,ae]);var oe=function(){var e=s()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showRightIframe",t),R.setFieldValue("showRightIframe",t),null==T||T({showRightIframe:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=s()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showFaqs",t),R.setFieldValue("showFaqs",t),null==T||T({showFaqs:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(b.Z,{width:"md",name:"showRightIframe",label:(0,q.jsxs)("span",{children:[Z.formatMessage({id:"showRightIframe"}),(0,q.jsx)(m.Z,{type:"service",keys:["showRightIframe"],live:K,draft:O})]}),fieldProps:{onChange:oe}}),(0,q.jsx)(w.Z,{width:"md",name:"rightIframeUrl",label:(0,q.jsxs)("span",{children:[Z.formatMessage({id:"rightIframeUrl"}),(0,q.jsx)(m.Z,{type:"service",keys:["rightIframeUrl"],live:K,draft:O})]}),tooltip:Z.formatMessage({id:"rightIframeUrl.tooltip",defaultMessage:"可自定义嵌入式广告网址（需以 http:// 或 https:// 开头）"}),extra:Z.formatMessage({id:"rightIframeUrl.extra",defaultMessage:"该地址会以 iframe 方式嵌入展示，可用于配置广告/活动页等。"}),placeholder:Z.formatMessage({id:"rightIframeUrl.placeholder",defaultMessage:"请输入以 http:// 或 https:// 开头的URL"}),rules:[{type:"url",message:Z.formatMessage({id:"rightIframeUrl.invalid",defaultMessage:"请输入有效的URL地址"})},{pattern:/^https?:\/\/[^\s]+$/i,message:Z.formatMessage({id:"rightIframeUrl.scheme.required",defaultMessage:"必须以 http:// 或 https:// 开头"})}],fieldProps:{type:"url",inputMode:"url",allowClear:!0}})]}),ue=(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(b.Z,{width:"md",name:"showFaqs",label:(0,q.jsxs)("span",{children:[Z.formatMessage({id:"faq.show.faqs"}),(0,q.jsx)(m.Z,{type:"service",keys:["showFaqs"],live:K,draft:O})]}),fieldProps:{onChange:le}}),(0,q.jsx)(x.Z,{name:"faqKbUid",width:"md",label:(0,q.jsxs)("span",{children:[Z.formatMessage({id:"faq.kbase.select",defaultMessage:"选择侧边栏常见问题知识库"}),(0,q.jsx)(m.Z,{type:"service",keys:["faqKbUid"],live:K,draft:O})]}),options:null==z||null===(r=z.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.map((function(e){return{label:I(e.name),value:e.uid}})),fieldProps:{onChange:function(e){console.log("TabRight selected kbase:",e),H(e),R.setFieldValue("faqUids",[]),ie(e),null==T||T({faqKbUid:e,faqUids:[]})},allowClear:!0,placeholder:Z.formatMessage({id:"choose",defaultMessage:"Choose"})}}),(0,q.jsx)(x.Z,{name:"faqUids",width:"md",label:(0,q.jsxs)("span",{children:[Z.formatMessage({id:"menu.kbase.faq"}),(0,q.jsx)(m.Z,{type:"service",keys:["faqUids"],live:K,draft:O})]}),tooltip:Z.formatMessage({id:"faq.uids.dependency.tooltip",defaultMessage:"FAQ options depend on the knowledge base selected above."}),extra:Z.formatMessage({id:"faq.uids.dependency.note",defaultMessage:"Choose a knowledge base first; switching it refreshes the FAQ list and clears current selections."}),options:null==_||null===(a=_.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.map((function(e){return{label:I(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:Z.formatMessage({id:"choose",defaultMessage:"Choose"})}})]}),de=(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(S.u,{name:"agentRightPanelTabs",creatorButtonProps:{creatorButtonText:Z.formatMessage({id:"agent.rightpanel.tab.add",defaultMessage:"添加 Tab"})},deleteIconProps:{tooltipText:Z.formatMessage({id:"delete",defaultMessage:"删除"})},copyIconProps:!1,children:function(){return(0,q.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,q.jsx)(w.Z,{name:"title",width:"md",label:Z.formatMessage({id:"agent.rightpanel.tab.title",defaultMessage:"Tab 标题"}),placeholder:Z.formatMessage({id:"agent.rightpanel.tab.title.placeholder",defaultMessage:"请输入标题"}),rules:[{required:!0,message:Z.formatMessage({id:"required",defaultMessage:"必填"})}]}),(0,q.jsx)(w.Z,{name:"url",width:"xl",label:Z.formatMessage({id:"agent.rightpanel.tab.url",defaultMessage:"内嵌 URL"}),placeholder:Z.formatMessage({id:"agent.rightpanel.tab.url.placeholder",defaultMessage:"请输入以 http:// 或 https:// 开头的URL"}),rules:[{required:!0,message:Z.formatMessage({id:"required",defaultMessage:"必填"})},{type:"url",message:Z.formatMessage({id:"rightIframeUrl.invalid",defaultMessage:"请输入有效的URL地址"})},{pattern:/^https?:\/\/[^\s]+$/i,message:Z.formatMessage({id:"rightIframeUrl.scheme.required",defaultMessage:"必须以 http:// 或 https:// 开头"})}],fieldProps:{type:"url",inputMode:"url",allowClear:!0}})]})}})});return(0,q.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,q.jsx)(y.A,{form:R,onValuesChange:function(e,t){var n={};Object.prototype.hasOwnProperty.call(e,"rightIframeUrl")&&(n.rightIframeUrl=t.rightIframeUrl),Object.prototype.hasOwnProperty.call(e,"faqUids")&&(n.faqUids=t.faqUids),Object.prototype.hasOwnProperty.call(e,"faqKbUid")&&(n.faqKbUid=t.faqKbUid),Object.keys(n).length>0&&(null==T||T(n)),Object.prototype.hasOwnProperty.call(e,"agentRightPanelTabs")&&(null==A||A(t.agentRightPanelTabs||[]))},submitter:!1,children:(0,q.jsx)(M.Z,{activeKey:G,onChange:ee,items:[{key:"iframe",label:Z.formatMessage({id:"showRightIframe",defaultMessage:"右侧iframe"}),children:se},{key:"faq",label:Z.formatMessage({id:"faq.show.faqs",defaultMessage:"常见问题"}),children:ue}].concat(i()("agent"===l?[{key:"agent-right-panel-tabs",label:Z.formatMessage({id:"agent.rightpanel.tabs",defaultMessage:"客服端右侧栏自定义tab"}),children:de}]:[]))})})})}},30881:function(e,t,n){n(90819),n(10154),n(73193),n(89933),n(45332),n(24471),n(21002),n(28520),n(87675),n(27353),n(97765),n(51011),n(44194),n(31549)},17345:function(e,t,n){var r=n(73193),i=n.n(r),a=n(45332),o=n.n(a),l=n(64273),s=n(32461),u=n(27353),d=n(97588),c=n(42701),f=n(87187),p=n(2290),g=n(46206),v=n(31461),h=n(44194),m=n(31549);t.Z=function(e){var t,n=d.A.useForm(),r=o()(n,1)[0],a=(0,p.useIntl)(),y={width:320},b=(0,s.z)((function(e){return{currentRobotSettings:e.currentRobotSettings,currentAgentSettings:e.currentAgentSettings,currentWorkgroupSettings:e.currentWorkgroupSettings,setCurrentRobotSettings:e.setCurrentRobotSettings,setCurrentAgentSettings:e.setCurrentAgentSettings,setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings}})),w=b.currentRobotSettings,x=b.currentAgentSettings,S=b.currentWorkgroupSettings,j=b.setCurrentRobotSettings,k=b.setCurrentAgentSettings,M=b.setCurrentWorkgroupSettings,C=void 0!==e.variant,q=C?e:null,T=C?q.variant:(t=e.type)===u.Njn?"agent":t===u._X4?"robot":"workgroup",P=(0,h.useMemo)((function(){var e;return C?null!==(e=null==q?void 0:q.serviceSettings)&&void 0!==e?e:{}:"agent"===T?{live:null==x?void 0:x.serviceSettings,draft:null==x?void 0:x.draftServiceSettings}:"robot"===T?{live:null==w?void 0:w.serviceSettings,draft:null==w?void 0:w.draftServiceSettings}:{live:null==S?void 0:S.serviceSettings,draft:null==S?void 0:S.draftServiceSettings}}),[C,q,T,x,w,S]),A=(0,h.useMemo)((function(){var e,t;return"agent"!==T?null:C?null!==(t=null==q?void 0:q.agentMeta)&&void 0!==t?t:null:{maxThreadCount:null==x?void 0:x.maxThreadCount,allowAgentCloseThread:null===(e=null==x?void 0:x.allowAgentCloseThread)||void 0===e||e,timeoutRemindTime:null==x?void 0:x.timeoutRemindTime}}),[T,C,q,x]),Z=(0,h.useCallback)((function(e){"agent"===T&&x?k(i()(i()({},x),{},{serviceSettings:i()(i()({},x.serviceSettings),e),draftServiceSettings:i()(i()({},x.draftServiceSettings||{}),e)})):"robot"===T&&w?j(i()(i()({},w),{},{serviceSettings:i()(i()({},w.serviceSettings),e),draftServiceSettings:i()(i()({},w.draftServiceSettings||{}),e)})):"workgroup"===T&&S&&M(i()(i()({},S),{},{serviceSettings:i()(i()({},S.serviceSettings),e),draftServiceSettings:i()(i()({},S.draftServiceSettings||{}),e)}))}),[T,x,w,S,k,j,M]),U=(0,h.useCallback)((function(e){"agent"===T&&x&&k(i()(i()({},x),e))}),[T,x,k]),R=(0,h.useCallback)((function(e){var t;C?null==q||null===(t=q.onServiceSettingsChange)||void 0===t||t.call(q,e):Z(e)}),[C,q,Z]),F=(0,h.useCallback)((function(e){var t;"agent"===T&&(C?null==q||null===(t=q.onAgentMetaChange)||void 0===t||t.call(q,e):U(e))}),[T,C,q,U]),I=(0,h.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==P?void 0:P.draft)&&void 0!==t?t:null==P?void 0:P.live)&&void 0!==e?e:void 0}),[P]);(0,h.useEffect)((function(){r.setFieldsValue({autoCloseMin:null==I?void 0:I.autoCloseMin,showLogo:null==I?void 0:I.showLogo,requireLogin:null==I?void 0:I.requireLogin})}),[r,I]);return(0,h.useEffect)((function(){var e;"agent"===T&&r.setFieldsValue({maxThreadCount:null==A?void 0:A.maxThreadCount,allowAgentCloseThread:null===(e=null==A?void 0:A.allowAgentCloseThread)||void 0===e||e,timeoutRemindTime:null==A?void 0:A.timeoutRemindTime})}),[r,T,null==A?void 0:A.maxThreadCount,null==A?void 0:A.allowAgentCloseThread,null==A?void 0:A.timeoutRemindTime]),(0,m.jsxs)(d.A,{form:r,submitter:!1,style:{marginLeft:"20px"},children:["agent"===T&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.Z,{width:"md",name:"maxThreadCount",label:a.formatMessage({id:"agent.settings.max.thread"}),tooltip:a.formatMessage({id:"agent.settings.max.thread.tooltip",defaultMessage:"超出此设置数量会自动进入排队队列，需要手动接入"}),min:0,formItemProps:{style:y},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&F({maxThreadCount:e})}}}),(0,m.jsx)(d.A.Item,{label:a.formatMessage({id:"agent.settings.timeout.remind",defaultMessage:"超时提醒时间"}),tooltip:a.formatMessage({id:"agent.settings.timeout.remind.tooltip",defaultMessage:"超过设定时间未回复客户将收到提醒"}),style:y,children:(0,m.jsxs)(g.Z.Compact,{block:!0,children:[(0,m.jsx)(c.Z,{formItemProps:{noStyle:!0},width:"md",name:"timeoutRemindTime",min:1,fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&F({timeoutRemindTime:e})}}}),(0,m.jsx)(v.Z,{disabled:!0,value:a.formatMessage({id:"time.minute",defaultMessage:"分钟"}),style:{width:72,textAlign:"center"},readOnly:!0,tabIndex:-1})]})}),(0,m.jsx)(f.Z,{name:"allowAgentCloseThread",width:"md",label:a.formatMessage({id:"agent.settings.allow.close.thread",defaultMessage:"允许客服手动结束会话"}),tooltip:a.formatMessage({id:"agent.settings.allow.close.thread.tooltip",defaultMessage:"关闭后，客服端将隐藏“结束会话”按钮"}),formItemProps:{style:y},fieldProps:{onChange:function(e){F({allowAgentCloseThread:e.target.checked})}}})]}),(0,m.jsx)(c.Z,{width:"md",name:"autoCloseMin",label:(0,m.jsxs)("span",{children:[a.formatMessage({id:"agent.settings.auto.close.time"}),(0,m.jsx)(l.Z,{type:"service",keys:["autoCloseMin"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),tooltip:a.formatMessage({id:"agent.settings.auto.close.time.tooltip"}),min:1,formItemProps:{style:y},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&R({autoCloseMin:e})}}}),(0,m.jsx)(f.Z,{name:"requireLogin",width:"md",label:(0,m.jsxs)("span",{children:[a.formatMessage({id:"agent.settings.require.login",defaultMessage:"访客咨询需登录"}),(0,m.jsx)(l.Z,{type:"service",keys:["requireLogin"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),tooltip:a.formatMessage({id:"agent.settings.require.login.tooltip",defaultMessage:"开启后，访客必须先登录才能发起咨询"}),formItemProps:{style:y},fieldProps:{onChange:function(e){R({requireLogin:e.target.checked})}}})]})}},69897:function(e,t,n){var r=n(45332),i=n.n(r),a=n(64273),o=n(21002),l=n(54685),s=n(97588),u=n(87187),d=n(2290),c=n(44194),f=n(53478),p=n(31549);t.Z=function(e){var t=s.A.useForm(),n=i()(t,1)[0],r=(0,d.useIntl)(),g=(0,o.Z)().translateString,v=e.variant,h=e.serviceSettings,m=e.onServiceSettingsChange,y=(0,c.useState)(!1),b=i()(y,2),w=b[0],x=b[1],S=(0,c.useState)(""),j=i()(S,2),k=j[0],M=j[1],C=(0,c.useState)(""),q=i()(C,2),T=q[0],P=q[1],A=(0,c.useState)(""),Z=i()(A,2),U=Z[0],R=Z[1],F=(0,c.useRef)({topTip:"",agentCloseTip:"",autoCloseTip:""}),I=(0,c.useMemo)((function(){return null!=h?h:{}}),[h]),K=(0,c.useCallback)((function(e){null==m||m(e)}),[m]),O=(0,c.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==I?void 0:I.draft)&&void 0!==t?t:null==I?void 0:I.live)&&void 0!==e?e:void 0}),[I]);(0,c.useEffect)((function(){var e=!(null==O||!O.showTopTip);w!==e&&(x(e),n.setFieldValue("showTopTip",e));var t=function(e,t){var r=g(t)||"";F.current[e]!==r&&(F.current[e]=r,"topTip"===e?M(r):"agentCloseTip"===e?P(r):"autoCloseTip"===e&&R(r),n.setFieldValue(e,r))};O?(t("topTip",O.topTip),t("agentCloseTip",O.agentCloseTip),t("autoCloseTip",O.autoCloseTip)):(t("topTip",""),t("agentCloseTip",""),t("autoCloseTip",""))}),[O,n,w,g,v]);var E=(0,c.useCallback)((function(e){F.current.topTip=e,M(e),n.setFieldValue("topTip",e),K({topTip:e})}),[n,K]),B=(0,c.useCallback)((function(e){F.current.agentCloseTip=e,P(e),n.setFieldValue("agentCloseTip",e),K({agentCloseTip:e})}),[n,K]),L=(0,c.useCallback)((function(e){F.current.autoCloseTip=e,R(e),n.setFieldValue("autoCloseTip",e),K({autoCloseTip:e})}),[n,K]);return(0,p.jsxs)(s.A,{form:n,submitter:!1,style:{marginLeft:"20px"},children:[(0,p.jsx)(u.Z,{name:"showTopTip",width:"md",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.show.top.tip"}),(0,p.jsx)(a.Z,{type:"service",keys:["showTopTip"],live:null==I?void 0:I.live,draft:null==I?void 0:I.draft})]}),fieldProps:{onChange:function(e){x(e.target.checked),e.target.checked&&M(g(null==O?void 0:O.topTip)),K({showTopTip:e.target.checked})}}}),w&&(0,p.jsx)(s.A.Item,{name:"topTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.top.tip"}),(0,p.jsx)(a.Z,{type:"service",keys:["topTip"],live:null==I?void 0:I.live,draft:null==I?void 0:I.draft})]}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.top.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.top.tip.placeholder"}),value:k,toolbarKeys:(0,l.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return E(e)}},"topTipEditor")}),"agent"===v&&(0,p.jsx)(s.A.Item,{name:"agentCloseTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.agent.close.tip"}),(0,p.jsx)(a.Z,{type:"service",keys:["agentCloseTip"],live:null==I?void 0:I.live,draft:null==I?void 0:I.draft})]}),tooltip:r.formatMessage({id:"agent.settings.agent.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.agent.close.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.agent.close.tip.placeholder"}),value:T,toolbarKeys:(0,l.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return B(e)}},"agentCloseTipEditor")}),(0,p.jsx)(s.A.Item,{name:"autoCloseTip",label:(0,p.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.auto.close.tip"}),(0,p.jsx)(a.Z,{type:"service",keys:["autoCloseTip"],live:null==I?void 0:I.live,draft:null==I?void 0:I.draft})]}),tooltip:r.formatMessage({id:"agent.settings.auto.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.auto.close.tip.required"})}],children:(0,p.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.auto.close.tip.placeholder"}),value:U,toolbarKeys:(0,l.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return L(e)}},"autoCloseTipEditor")})]})}},30722:function(e,t,n){var r=n(73193),i=n.n(r),a=n(90819),o=n.n(a),l=n(89933),s=n.n(l),u=n(45332),d=n.n(u),c=n(50884),f=n(37278),p=n(28520),g=n(97588),v=n(74056),h=n(17455),m=n(2290),y=n(44194),b=n(41455),w=n(46589),x=n(10820),S=n(21002),j=n(64273),k=n(31549),M=["smile","upload","rate","leavemsg"],C=function(e){var t=Array.isArray(e)?e.filter(Boolean).map((function(e){return String(e)})):[];if(!t.length)return[].concat(M);var n=[];return t.forEach((function(e){var t="image"===e||"file"===e?"upload":e;n.includes(t)||n.push(t)})),n};t.Z=function(e){var t=e.variant,n=e.serviceSettings,r=e.onServiceSettingsChange,a=(0,m.useIntl)(),l=g.A.useForm(),u=d()(l,1)[0],M=(0,S.Z)().translateString,q=(0,p.u)((function(e){return e.currentOrg})),T=(0,y.useState)("toolbar"),P=d()(T,2),A=P[0],Z=P[1],U=(0,y.useState)([]),R=d()(U,2),F=R[0],I=R[1],K=(0,y.useState)(!1),O=d()(K,2),E=O[0],B=O[1],L=null==n?void 0:n.live,_=null==n?void 0:n.draft,V=(0,y.useMemo)((function(){return null!=_?_:L}),[_,L]),Q=(0,y.useCallback)(s()(o()().mark((function e(){var t,n,r,i,l,s,d,p;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=q&&q.uid){e.next=3;break}return I([]),e.abrupt("return");case 3:return B(!0),t=c.yw.loading(a.formatMessage({id:"loading",defaultMessage:"Loading"})),e.prev=5,e.next=8,(0,f.qL)({pageNumber:0,pageSize:200,orgUid:q.uid});case 8:200===(n=e.sent).code?(i=((null==n||null===(r=n.data)||void 0===r?void 0:r.content)||[]).filter((function(e){return Boolean(null==e?void 0:e.uid)})),l=i.sort((function(e,t){var n,r;return(null!==(n=null==e?void 0:e.orderIndex)&&void 0!==n?n:0)-(null!==(r=null==t?void 0:t.orderIndex)&&void 0!==r?r:0)})),I(l),s=new Set(l.map((function(e){return e.uid}))),d=u.getFieldValue("quickButtonUids")||[],(p=d.filter((function(e){return s.has(e)}))).length!==d.length&&u.setFieldValue("quickButtonUids",p)):c.yw.error(n.message||a.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),c.yw.error(a.formatMessage({id:"request.failed",defaultMessage:"Request failed"}));case 15:return e.prev=15,null==t||t(),B(!1),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[5,12,15,19]])}))),[null==q?void 0:q.uid,u,a]);(0,y.useEffect)((function(){Q()}),[Q]),(0,y.useEffect)((function(){var e,t,n,r,i,a,o,l,s,d;if(V){var c=V.toolbar||{},f=null==V?void 0:V.quickButtons,p=null!==(e=c.upload)&&void 0!==e?e:Boolean(c.image)||Boolean(c.file)||void 0===c.image&&void 0===c.file;u.setFieldsValue({smile:null===(t=c.smile)||void 0===t||t,upload:p,uploadRobot:null===(n=c.uploadRobot)||void 0===n||n,rate:null===(r=c.rate)||void 0===r||r,leavemsg:null===(i=c.leavemsg)||void 0===i||i,orderSelector:null===(a=c.orderSelector)||void 0===a||a,ticket:null===(o=c.ticket)||void 0===o||o,audio:null===(l=c.audio)||void 0===l||l,video:null===(s=c.video)||void 0===s||s,tel:null===(d=c.tel)||void 0===d||d,toolbarOrder:C(c.order),showQuickButtons:V.showQuickButtons,quickButtonUids:Array.isArray(null==V?void 0:V.quickButtonUids)?V.quickButtonUids:Array.isArray(f)?f.map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[]})}}),[V,u]);var J=(0,y.useCallback)((function(e){u.setFieldValue("showQuickButtons",e),null==r||r({showQuickButtons:e})}),[u,r]),z=(0,y.useMemo)((function(){return null!=F&&F.length?F.filter((function(e){return Boolean(null==e?void 0:e.uid)})).map((function(e){return{label:M(e.title)||e.title||e.uid,value:e.uid}})):[]}),[F,M]),D=(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(b.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,k.jsx)(w.Z,{span:12,children:(0,k.jsx)(v.Z,{name:"smile",label:(0,k.jsxs)("span",{children:[a.formatMessage({id:"chat.toolbar.emoji",defaultMessage:"Emoji"}),(0,k.jsx)(j.Z,{type:"service",keys:["toolbar"],live:L,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),(0,k.jsx)(w.Z,{span:12,children:(0,k.jsx)(v.Z,{name:"upload",label:(0,k.jsxs)("span",{children:[a.formatMessage({id:"chat.toolbar.upload",defaultMessage:"Upload"}),(0,k.jsx)(j.Z,{type:"service",keys:["toolbar"],live:L,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),("robot"===t||"workgroup"===t)&&(0,k.jsx)(w.Z,{span:12,children:(0,k.jsx)(v.Z,{name:"uploadRobot",label:(0,k.jsxs)("span",{children:[a.formatMessage({id:"chat.toolbar.upload.robot",defaultMessage:"机器人接待显示发送图片/文件"}),(0,k.jsx)(j.Z,{type:"service",keys:["toolbar"],live:L,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),(0,k.jsx)(w.Z,{span:12,children:(0,k.jsx)(v.Z,{name:"rate",label:(0,k.jsxs)("span",{children:[a.formatMessage({id:"chat.toolbar.rate",defaultMessage:"Rate"}),(0,k.jsx)(j.Z,{type:"service",keys:["toolbar"],live:L,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),(0,k.jsx)(w.Z,{span:12,children:(0,k.jsx)(v.Z,{name:"leavemsg",label:(0,k.jsxs)("span",{children:[a.formatMessage({id:"chat.toolbar.leaveMsg",defaultMessage:"Leave Msg"}),(0,k.jsx)(j.Z,{type:"service",keys:["toolbar"],live:L,draft:_})]}),formItemProps:{style:{marginBottom:8}}})})]})}),N=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(v.Z,{label:(0,k.jsxs)("span",{children:[a.formatMessage({id:"faq.show.quick.buttons"}),(0,k.jsx)(j.Z,{type:"service",keys:["showQuickButtons"],live:L,draft:_})]}),name:"showQuickButtons",width:"md",fieldProps:{onChange:J}}),(0,k.jsx)(h.Z,{name:"quickButtonUids",width:"lg",label:(0,k.jsxs)("span",{children:[a.formatMessage({id:"menu.kbase.quickbutton"}),(0,k.jsx)(j.Z,{type:"service",keys:["quickButtonUids","quickButtons"],live:L,draft:_})]}),options:z,fieldProps:{mode:"multiple",allowClear:!0,showSearch:!0,optionFilterProp:"label",placeholder:(0,k.jsx)(m.FormattedMessage,{id:"choose",defaultMessage:"Choose"}),loading:E}})]});return(0,k.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,k.jsx)(g.A,{form:u,onValuesChange:function(e,n){var a=["smile","upload","rate","leavemsg"];"robot"!==t&&"workgroup"!==t||a.push("uploadRobot");var o={};a.forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=n[t])}));var l=Object.prototype.hasOwnProperty.call(e,"toolbarOrder"),s={},u=i()(i()({},(null==L?void 0:L.toolbar)||{}),(null==_?void 0:_.toolbar)||{});Object.keys(o).length>0&&(s.toolbar=i()(i()({},u),o)),l&&(s.toolbar=i()(i()({},s.toolbar||u),{},{order:C(n.toolbarOrder||[])})),["showQuickButtons","quickButtonUids"].forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=n[t])})),0!==Object.keys(s).length&&(null==r||r(s))},submitter:!1,children:(0,k.jsx)(x.Z,{activeKey:A,onChange:Z,items:[{key:"toolbar",label:a.formatMessage({id:"chat.toolbar.settings",defaultMessage:"访客端工具栏设置"}),children:D},{key:"quickButton",label:a.formatMessage({id:"quick.faq.settings",defaultMessage:"访客端快捷按钮设置"}),children:N}]})})})}},2533:function(e,t,n){n.d(t,{Z:function(){return E}});var r=n(76711),i=n.n(r),a=n(73193),o=n.n(a),l=n(45332),s=n.n(l),u=n(64273),d=n(90819),c=n.n(d),f=n(89933),p=n.n(f),g=n(50884),v=n(97588),h=n(74056),m=n(67186),y=n(83788),b=n(19058),w=n(46206),x=n(90883),S=n(44194),j=n(31549),k={enabled:!0,triggerKey:"",config:"{}"},M=function(e){var t=e.open,n=e.record,r=e.onClose,i=e.onSubmit,a=v.A.useForm(),l=s()(a,1)[0],u=!(null==n||!n.uid);return(0,S.useEffect)((function(){t&&l.setFieldsValue(o()(o()({},k),null!=n?n:{}))}),[l,t,n]),(0,j.jsx)(b.Z,{title:u?"编辑触发器":"添加触发器",width:600,open:t,onClose:r,destroyOnHidden:!0,extra:(0,j.jsxs)(w.Z,{children:[(0,j.jsx)(x.ZP,{onClick:r,children:"取消"}),(0,j.jsx)(x.ZP,{type:"primary",onClick:function(){return l.submit()},children:"保存"})]}),children:(0,j.jsxs)(v.A,{form:l,layout:"vertical",submitter:!1,initialValues:k,onFinish:function(){var e=p()(c()().mark((function e(t){var n,r,a,o,l,s;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(null!==(n=null==t?void 0:t.triggerKey)&&void 0!==n?n:"").trim()){e.next=4;break}return g.yw.error("请填写 Trigger Key"),e.abrupt("return",!1);case 4:l=(null!==(r=null==t?void 0:t.config)&&void 0!==r?r:"{}").toString().trim(),s=l.length>0?l:"{}",e.prev=6,JSON.parse(s),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(6),g.yw.error("配置(JSON) 格式不正确"),e.abrupt("return",!1);case 14:return i({uid:null==t?void 0:t.uid,triggerKey:o,enabled:null===(a=null==t?void 0:t.enabled)||void 0===a||a,type:null==t?void 0:t.type,name:null==t?void 0:t.name,description:null==t?void 0:t.description,config:s}),e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e,null,[[6,10]])})));return function(t){return e.apply(this,arguments)}}(),children:[(0,j.jsx)(h.Z,{name:"enabled",label:"是否启用",fieldProps:{checkedChildren:"启用",unCheckedChildren:"禁用"}}),(0,j.jsx)(m.Z,{name:"triggerKey",label:"Trigger Key",placeholder:"例如：visitor_no_response_proactive_message",rules:[{required:!0,message:"请填写 Trigger Key"}]}),(0,j.jsx)(m.Z,{name:"type",label:"类型（可选）",placeholder:"例如：THREAD/CUSTOMER/TICKET"}),(0,j.jsx)(m.Z,{name:"name",label:"名称（可选）",placeholder:"显示名称"}),(0,j.jsx)(m.Z,{name:"description",label:"描述（可选）",placeholder:"描述信息"}),(0,j.jsx)(y.Z,{name:"config",label:"配置(JSON)",placeholder:'例如：{"noResponseTimeout":300,"proactiveMessage":"您好..."}',fieldProps:{autoSize:{minRows:4,maxRows:10}}})]})})},C=n(27353),q=n(2290);function T(e){return P.apply(this,arguments)}function P(){return(P=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,q.request)("/api/v1/trigger/query/org",{method:"GET",params:o()(o()({},t),{},{channel:C.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=n(97765),Z=n(2887),U=n(64724),R=n(38623),F=function(e){var t=e.open,n=e.orgUid,r=e.onClose,i=e.onSelect,a=(0,S.useState)(!1),o=s()(a,2),l=o[0],u=o[1],d=(0,S.useState)(0),f=s()(d,2),v=f[0],h=f[1],m=(0,S.useState)(10),y=s()(m,2),k=y[0],M=y[1],C=(0,S.useState)([]),q=s()(C,2),P=q[0],F=q[1],I=(0,S.useState)(0),K=s()(I,2),O=K[0],E=K[1],B=(0,S.useCallback)(p()(c()().mark((function e(){var r,i,a,o,l,s,d;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return u(!0),e.prev=3,l={pageNumber:v,pageSize:k,orgUid:n},e.next=7,T(l);case 7:if(s=e.sent,A.Z.debug("queryTriggersByOrg fetchList:",s,l),200===(null==s?void 0:s.code)){e.next=14;break}return g.yw.error((null==s?void 0:s.message)||"加载触发器列表失败"),F([]),E(0),e.abrupt("return");case 14:d=null!==(r=null==s||null===(i=s.data)||void 0===i?void 0:i.content)&&void 0!==r?r:[],F(d),E(null!==(a=null==s||null===(o=s.data)||void 0===o?void 0:o.totalElements)&&void 0!==a?a:0),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(3),g.yw.error("加载触发器列表失败"),F([]),E(0);case 24:return e.prev=24,u(!1),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[3,19,24,27]])}))),[t,n,v,k]);return(0,S.useEffect)((function(){B()}),[B]),(0,j.jsx)(b.Z,{title:"选择触发器",width:600,open:t,onClose:r,destroyOnHidden:!0,children:(0,j.jsx)(Z.Z,{loading:l,dataSource:P,rowKey:function(e){return e.uid||"".concat(e.triggerKey||"","-").concat(e.name||"")},pagination:{current:v+1,pageSize:k,total:O,showSizeChanger:!0,onChange:function(e,t){h(Math.max(0,(null!=e?e:1)-1)),t&&t!==k&&M(t)}},renderItem:function(e){var t=null==e?void 0:e.enabled;return(0,j.jsx)(Z.Z.Item,{actions:[(0,j.jsx)(x.ZP,{size:"small",type:"link",onClick:function(){return i({uid:(t=e).uid,triggerKey:t.triggerKey,enabled:t.enabled,type:t.type,name:t.name,description:t.description,config:t.config});var t},children:"选择"},"select")],children:(0,j.jsx)(Z.Z.Item.Meta,{title:(0,j.jsxs)(w.Z,{size:8,wrap:!0,children:[(0,j.jsx)(U.Z.Text,{strong:!0,children:(null==e?void 0:e.name)||"(未命名)"}),(0,j.jsx)(R.Z,{children:t?"启用":"禁用"}),null!=e&&e.type?(0,j.jsx)(R.Z,{children:e.type}):null]}),description:(0,j.jsxs)("div",{children:[null!=e&&e.triggerKey?(0,j.jsxs)(U.Z.Text,{type:"secondary",children:["Trigger Key：",e.triggerKey]}):null,null!=e&&e.description?(0,j.jsx)("div",{children:e.description}):null]})})})}})})},I=n(28520),K=n(77601),O=n(30235),E=function(e){e.variant;var t=e.triggerSettings,n=e.onTriggerSettingsChange,r=(0,S.useRef)(""),a=(0,S.useRef)(""),l=(0,S.useRef)(!1),d=(0,I.u)((function(e){return e.currentOrg})),c=null==d?void 0:d.uid,f=(0,S.useState)(!1),p=s()(f,2),g=p[0],v=p[1],h=(0,S.useState)(!1),m=s()(h,2),y=m[0],b=m[1],k=(0,S.useState)(null),C=s()(k,2),q=C[0],T=C[1],P=(0,S.useState)(null),A=s()(P,2),Z=A[0],E=A[1],B=(0,S.useMemo)((function(){var e,n;return null!==(e=null!==(n=null==t?void 0:t.draft)&&void 0!==n?n:null==t?void 0:t.live)&&void 0!==e?e:{}}),[t]),L=(0,S.useMemo)((function(){var e=null==B?void 0:B.triggers;return Array.isArray(e)?e:[]}),[B]),_=(0,S.useMemo)((function(){var e,n,r,i;return null!==(e=null!==(n=null==t||null===(r=t.draft)||void 0===r?void 0:r.uid)&&void 0!==n?n:null==t||null===(i=t.live)||void 0===i?void 0:i.uid)&&void 0!==e?e:""}),[null==t?void 0:t.draft,null==t?void 0:t.live]),V=(0,S.useCallback)((function(e){var t,n,r;if(!e)return null;var i=(null!==(t=e.triggerKey)&&void 0!==t?t:"").toString().trim(),a=(null!==(n=e.config)&&void 0!==n?n:"{}").toString();return o()(o()({},e.uid?{uid:e.uid}:{}),{},{triggerKey:i,enabled:null===(r=e.enabled)||void 0===r||r,type:e.type,name:e.name,description:e.description,config:a.trim().length>0?a:"{}"})}),[]),Q=(0,S.useCallback)((function(e){return e.map((function(e){var t,n,r,i,a,o,l;return[null!==(t=e.uid)&&void 0!==t?t:"",null!==(n=e.triggerKey)&&void 0!==n?n:"",String(null!==(r=e.enabled)&&void 0!==r?r:""),null!==(i=e.type)&&void 0!==i?i:"",null!==(a=e.name)&&void 0!==a?a:"",null!==(o=e.description)&&void 0!==o?o:"",null!==(l=e.config)&&void 0!==l?l:""].join("|")})).join("\n")}),[]),J=(0,S.useMemo)((function(){return{triggers:L.filter((function(e){return!!e})).map((function(e){return V(e)})).filter((function(e){return!!e})).filter((function(e){var t;return(null!==(t=e.triggerKey)&&void 0!==t?t:"").trim().length>0}))}}),[L,V]),z=(0,S.useCallback)((function(e,t){var n,r,i=(null!==(n=null==e?void 0:e.uid)&&void 0!==n?n:"").toString().trim();if(i)return i;var a=(null!==(r=null==e?void 0:e.triggerKey)&&void 0!==r?r:"").toString().trim();return a?"triggerKey:".concat(a,":").concat(null!=t?t:""):"row:".concat(Date.now(),":").concat(Math.random().toString(16).slice(2))}),[]),D=(0,S.useCallback)((function(e){return(Array.isArray(e)?e:[]).map((function(e,t){return o()(o()({},e),{},{__rowKey:(null==e?void 0:e.__rowKey)||z(e,t)})}))}),[z]),N=(0,S.useState)((function(){return D(J.triggers)})),Y=s()(N,2),X=Y[0],H=Y[1],W=(0,S.useRef)(X);(0,S.useEffect)((function(){W.current=X}),[X]);var $=(0,S.useMemo)((function(){var e;return(null!==(e=J.triggers)&&void 0!==e?e:[]).filter((function(e){var t;return(null!==(t=e.triggerKey)&&void 0!==t?t:"").trim().length>0}))}),[J.triggers]),G=(0,S.useMemo)((function(){return Q($)}),[$,Q]);(0,S.useEffect)((function(){var e,t=r.current,n=_;if(t!==n)return r.current=n,l.current=!1,a.current=G,void H(D(J.triggers));if(l.current){var i=(null!==(e=W.current)&&void 0!==e?e:[]).filter((function(e){return!!e})).map((function(e){return V(e)})).filter((function(e){return!!e})).filter((function(e){var t;return(null!==(t=e.triggerKey)&&void 0!==t?t:"").trim().length>0}));Q(i)===G&&(l.current=!1,a.current!==G&&(a.current=G,H(D(J.triggers))))}else a.current!==G&&(a.current=G,H(D(J.triggers)))}),[G,J.triggers,V,Q,_,D]);var ee=(0,S.useCallback)((function(e){var t=e.filter((function(e){return!!e})).map((function(e){return V(e)})).filter((function(e){return!!e})).filter((function(e){var t;return(null!==(t=e.triggerKey)&&void 0!==t?t:"").trim().length>0}));Q(t)!==G&&(l.current=!0,null==n||n({triggers:t}))}),[G,V,n,Q]),te=(0,S.useCallback)((function(){v(!0)}),[]),ne=(0,S.useCallback)((function(e){var t=Array.isArray(X)?i()(X):[],n=null==e?void 0:e.uid,r=null==e?void 0:e.triggerKey;if(!t.some((function(e){var t;return n?(null==e?void 0:e.uid)===n:!!r&&(null!==(t=null==e?void 0:e.triggerKey)&&void 0!==t?t:"").toString()===r.toString()}))){var a=o()(o()({},e),{},{__rowKey:(null==e?void 0:e.__rowKey)||z(e,t.length)});t.push(a),H(t),ee(t)}v(!1)}),[ee,z,X]),re=(0,S.useCallback)((function(e){var t=(Array.isArray(X)?X:[])[e];t&&(E(e),T(t),b(!0))}),[X]),ie=(0,S.useCallback)((function(e){var t=Array.isArray(X)?i()(X):[];e<0||e>=t.length||(t.splice(e,1),H(t),ee(t))}),[ee,X]),ae=(0,S.useCallback)((function(e){var t=Array.isArray(X)?i()(X):[];if(null==Z){var n=o()(o()({},e),{},{__rowKey:(null==e?void 0:e.__rowKey)||z(e,t.length)});t.push(n)}else{var r=t[Z],a=null==r?void 0:r.uid,l=null==r?void 0:r.__rowKey;t[Z]=o()(o()(o()(o()({},r),e),!a||null!=e&&e.uid?{}:{uid:a}),l?{__rowKey:l}:{__rowKey:z(e,Z)})}H(t),b(!1),T(null),E(null),ee(t)}),[Z,ee,z,X]),oe=(0,S.useMemo)((function(){return[{title:"启用",dataIndex:"enabled",width:80,render:function(e,t){return(0,j.jsx)(R.Z,{children:null!=t&&t.enabled?"启用":"禁用"})}},{title:"Trigger Key",dataIndex:"triggerKey",ellipsis:!0},{title:"类型",dataIndex:"type",width:120,render:function(e,t){return null!=t&&t.type?(0,j.jsx)(R.Z,{children:t.type}):"-"}},{title:"名称",dataIndex:"name",ellipsis:!0},{title:"操作",valueType:"option",width:160,render:function(e,t,n){var r="number"==typeof n?n:-1;return(0,j.jsxs)(w.Z,{size:8,children:[(0,j.jsx)(x.ZP,{size:"small",onClick:function(){return re(r)},children:"编辑"}),(0,j.jsx)(x.ZP,{danger:!0,size:"small",onClick:function(){return ie(r)},children:"删除"})]})}}]}),[re,ie]);return(0,j.jsxs)("div",{children:[g&&(0,j.jsx)(F,{open:g,orgUid:c,onClose:function(){return v(!1)},onSelect:ne}),y&&(0,j.jsx)(M,{open:y,record:q,onClose:function(){b(!1),T(null),E(null)},onSubmit:ae}),(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[(0,j.jsxs)(w.Z,{size:8,children:[(0,j.jsx)(U.Z.Text,{strong:!0,children:"触发器列表"}),(0,j.jsx)(u.Z,{type:"generic",keys:["triggers"],live:null==t?void 0:t.live,draft:null==t?void 0:t.draft})]}),(0,j.jsx)(x.ZP,{onClick:te,children:"添加触发器"})]}),(0,j.jsx)(K.Z,{rowKey:function(e){return e.__rowKey},columns:oe,dataSource:X,search:!1,options:!1,pagination:!1}),(0,j.jsx)(O.Z,{})]})}},53478:function(e,t,n){var r=n(73193),i=n.n(r),a=n(50884),o=n(96775),l=n(61476),s=n(27353),u=n(2290),d=n(47888),c=(n(91361),n(96596)),f=n.n(c),p=n(44194),g=n(31549);t.Z=function(e){var t=e.placeholder,n=e.defaultValue,r=e.value,c=e.style,v=e.toolbarKeys,h=e.maxLength,m=e.onChange,y=e.options,b=(0,u.useIntl)(),w=(0,o.Z)().isDarkMode,x=(0,p.useRef)(null),S=(0,p.useRef)(null),j=(0,p.useRef)(!1),k=(0,p.useRef)(m);(0,p.useEffect)((function(){k.current=m}),[m]);var M=function(e,t,n){"function"!=typeof k.current||j.current||k.current(e,t,n)};return(0,p.useEffect)((function(){if(x.current){if(!S.current){var e=new d.cW(i()(i()({element:x.current,theme:w?"dark":"light",placeholder:t,content:n,toolbarKeys:v},y||{}),{},{image:{uploadUrl:(0,l.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(s.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var o=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,l=new FormData;return l.append("file",e),l.append("fileName",o),l.append("fileType",e.type),l.append("isAvatar","false"),l.append("kbType",s.QPQ),l.append("categoryUid",""),l.append("kbUid",""),l.append("orgUid",""),l.append("client",s.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:i()({Accept:"application/json"},n),body:l}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){a.yw.destroy(),a.yw.success("".concat(o," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,alt:o}};e(n)}else a.yw.destroy(),a.yw.error("".concat(o," 上传失败"))})).catch((function(e){r(e)}))}))}},video:{uploadUrl:(0,l.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(s.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var o=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,l=new FormData;return l.append("file",e),l.append("fileName",o),l.append("fileType",e.type),l.append("isAvatar","false"),l.append("kbType",s.QPQ),l.append("categoryUid",""),l.append("kbUid",""),l.append("client",s.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:i()({Accept:"application/json"},n),body:l}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){a.yw.destroy(),a.yw.success("".concat(o," 上传成功"));var n={errorCode:0,data:{src:t.data.fileUrl,poster:"https://www.weiyuai.cn/avatars/video_poster.png"}};e(n)}else a.yw.destroy(),a.yw.error("".concat(o," 上传失败"))})).catch((function(e){r(e)}))}))}},attachment:{uploadUrl:(0,l.M$)(),uploadFormName:"file",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem(s.LA8)},uploader:function(e,t,n,r){console.log("uploader:",e,t,n,r);var o=f()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,l=new FormData;return l.append("file",e),l.append("fileName",o),l.append("fileType",e.type),l.append("isAvatar","false"),l.append("kbType",s.QPQ),l.append("categoryUid",""),l.append("kbUid",""),l.append("client",s.XtJ),new Promise((function(e,r){fetch(t,{method:"POST",headers:i()({Accept:"application/json"},n),body:l}).then((function(e){return e.json()})).then((function(t){if(console.log("upload data:",t),200===t.code){a.yw.destroy(),a.yw.success("".concat(o," 上传成功"));var n={errorCode:0,data:{href:t.data.fileUrl,fileName:o}};e(n)}else a.yw.destroy(),a.yw.error("".concat(o," 上传失败"))})).catch((function(e){r(e)}))}))}},onChange:function(e){var t=e.getText(),n=t.length,r="number"==typeof h?h:Number.POSITIVE_INFINITY;if(n>r){var i,o;a.yw.warning(b.formatMessage({id:"character.limit.reached"},{limit:r})||"已达到 ".concat(r," 字符限制"));var l=t.substring(0,r);j.current=!0,setTimeout((function(){S.current&&S.current.setContent(l),j.current=!1}),0),M((null===(i=S.current)||void 0===i?void 0:i.getHtml())||"",(null===(o=S.current)||void 0===o?void 0:o.getMarkdown())||"",l)}else M(e.getHtml(),e.getMarkdown(),e.getText())}}));S.current=e}return function(){S.current&&(S.current.destroy(),S.current=null)}}}),[]),(0,p.useEffect)((function(){S.current&&void 0!==r&&r!==S.current.getHtml()&&(j.current=!0,S.current.setContent(r||"",!1),requestAnimationFrame((function(){j.current=!1})))}),[r]),(0,g.jsx)("div",{ref:x,style:i()({height:"100%"},c)})}},64273:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(73193),i=n.n(r),a=n(44194),o=n(48518),l=n(38623),s=n(86222),u=n.n(s),d=n(89957),c=n.n(d),f=["welcomeFaqUids","faqUids","quickButtonUids","guessFaqUids","hotFaqUids","shortcutFaqUids","proactiveFaqUids"],p=["welcomeFaqs","faqs","quickButtons","guessFaqs","hotFaqs","shortcutFaqs","proactiveFaqs"];function g(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e,t){if(!e)return e;if(!t||0===t.length)return e;var n={};return t.forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})),n}function h(e){var t=e&&g(e)?i()({},e):{};return p.forEach((function(e){t[e]&&(t[e.replace(/s$/,"Uids")]=function(e){if(Array.isArray(e))return e.map((function(e){return null==e?void 0:e.uid})).filter(Boolean).map(String)}(t[e]),delete t[e])})),f.forEach((function(e){t[e]&&(t[e]=function(e){if(!Array.isArray(e))return e;var t=e.slice();return t.every((function(e){return["string","number","boolean"].includes(c()(e))}))?t.map((function(e){return"string"==typeof e?e:String(e)})).sort():t}(t[e]))})),t}function m(e){return e&&g(e)?i()({},e):{}}function y(e){var t=new WeakSet;return JSON.stringify(function e(n){if(null===n||"object"!==c()(n))return n;if(!t.has(n)){if(t.add(n),Array.isArray(n))return n.map((function(t){return e(t)}));var r,i=Object.keys(n).sort(),a={},o=u()(i);try{for(o.s();!(r=o.n()).done;){var l=r.value;a[l]=e(n[l])}}catch(e){o.e(e)}finally{o.f()}return a}}(e))}function b(e,t){return y(e)===y(t)}var w=n(31549),x=function(e){var t=e.hasDiff,n=e.type,r=void 0===n?"service":n,s=e.live,u=e.draft,d=e.keys,c=e.text,f=void 0===c?"草稿未发布":c,p=e.style;return(0,a.useMemo)((function(){if("boolean"==typeof t)return t;if(!s&&!u)return!1;switch(r){case"service":return function(e,t,n){return!b(v(h(e),n),v(h(t),n))}(s,u,d);case"messageLeave":return function(e,t,n){return!b(v(m(e),n),v(m(t),n))}(s,u,d);default:return function(e,t,n){return!b(v(e||{},n),v(t||{},n))}(s,u,d)}}),[t,r,s,u,d])?(0,w.jsx)(o.Z,{title:"string"==typeof f?f:"草稿与线上不一致",children:(0,w.jsx)(l.Z,{color:"orange",style:i()({marginLeft:8,height:20,lineHeight:"18px"},p),children:"Draft"})}):null}},32461:function(e,t,n){n.d(t,{z:function(){return l}});var r=n(27353),i=n(26557),a=n(26407),o=n(20744),l=(0,i.Ue)()((0,a.mW)((0,a.tJ)((0,o.n)((function(e){return{currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null,setCurrentAgentSettings:function(t){return e({currentAgentSettings:t})},setCurrentRobotSettings:function(t){return e({currentRobotSettings:t})},setCurrentWorkgroupSettings:function(t){return e({currentWorkgroupSettings:t})},clear:function(){return e({currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null})}}})),{name:r.rpR})))}}]);