"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1730],{58087:function(e,t,n){var r=n(11757),o=n(44194),a=n(15323),s=n(54183),i=function(e,t){return o.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:a.Z}))},c=o.forwardRef(i);t.Z=c},88678:function(e,t,n){n.d(t,{Z:function(){return b}});var r=n(90819),o=n.n(r),a=n(89933),s=n.n(a),i=n(45332),c=n.n(i),l=n(55735),u=n(30921);function d(){return p.apply(this,arguments)}function p(){return(p=s()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/kaptcha/api/v1/get",{method:"GET",params:{client:l.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){return f.apply(this,arguments)}function f(){return(f=s()(o()().mark((function e(t,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/kaptcha/api/v1/check",{method:"POST",data:{captchaUid:t,captchaCode:n,client:l.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(58087),h=n(52288),v=n(44194),x=n(31549),b=function(e){var t=e.onKaptchaChange,n=e.onKaptchaCheck,r=(0,u.useIntl)(),a=(0,v.useState)(),i=c()(a,2),l=i[0],p=i[1],f=(0,v.useState)(),b=c()(f,2),w=b[0],y=b[1],M=function(){var e=s()(o()().mark((function e(){var t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:200===(t=e.sent).code&&(p(t.data.captchaUid),y(t.data.captchaImage));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=s()(o()().mark((function e(t,r){var a;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t,r);case 2:a=e.sent,console.log("checkCaptcha response",a),200===a.code?n&&n(!0):n&&n(!1);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){M()}),[]);return(0,x.jsx)(x.Fragment,{children:w&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(h.Z,{onChange:function(e){t&&(t(l,e.target.value),e.target.value&&""!==e.target.value&&4===e.target.value.trim().length?j(l,e.target.value):n&&n(!1))},prefix:(0,x.jsx)(m.Z,{}),placeholder:r.formatMessage({id:"captcha",defaultMessage:"captcha"}),style:{width:"65%",float:"left",height:40},allowClear:!0}),(0,x.jsx)("img",{src:w,alt:"captcha",onClick:M})]})})}},53881:function(e,t,n){n.r(t);var r=n(73193),o=n.n(r),a=n(90819),s=n.n(a),i=n(89933),c=n.n(i),l=n(45332),u=n.n(l),d=n(45739),p=n(67907),g=n(10022),f=n(26978),m=n(40795),h=n(69169),v=n(65821),x=n(57245),b=n(4499),w=n(59129),y=n(93769),M=n(30921),j=n(42540),C=n(36669),k=n(73589),$=n(75365),Z=n(96839),S=n(98094),I=n(44194),E=n(23864),z=n(86803),N=n(55735),P=n(98240),O=n(56321),T=n(51239),B=n(65461),L=n(88678),H=n(44521),R=n(31549),q=j.Z.defaultAlgorithm,A=j.Z.darkAlgorithm,F=function(){var e=(0,y.l)((function(e){var t=e.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:t.borderRadius,":hover":{backgroundColor:t.colorBgTextHover}}}));return(0,R.jsx)("div",{className:e,"data-lang":!0,children:M.SelectLang&&(0,R.jsx)(M.SelectLang,{})})},D=function(e){var t=e.content;return(0,R.jsx)(C.Z,{style:{marginBottom:24},message:t,type:"error",showIcon:!0})},W=function(){var e=h.A.useForm(),t=u()(e,1)[0],n=j.Z.useToken().token,r=(0,E.Z)().isDarkMode,a=(0,I.useRef)(),i=(0,I.useState)(!1),l=u()(i,2),y=l[0],C=l[1],Z=(0,M.useModel)("@@initialState"),S=(Z.initialState,Z.loading,Z.refresh,Z.setInitialState),q=(0,I.useState)(!1),A=u()(q,2),W=A[0],U=A[1],V=(0,P.t)((function(e){return e.setAccessToken})),G=(0,T.L)((function(e){return e.setUserInfo})),K=(0,M.getLocale)();console.log("register page locale:",K);var _=(0,M.useIntl)(),X=(0,I.useState)(""),Y=u()(X,2),Q=Y[0],J=Y[1],ee=(0,I.useState)(""),te=u()(ee,2),ne=te[0],re=te[1],oe=function(){var e=c()(s()().mark((function e(n,r){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J(n),re(r),t.setFieldValue("captchaCode",r);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ae=function(){var e=c()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,I.useEffect)((function(){(0,H.ME)(),(0,B.Bc)()&&U(!0),(0,B.pr)()}),[]);var se=function(){var e=c()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(0,O.flushSync)((function(){S((function(e){return o()(o()({},e),{},{userInfo:t})}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=c()(s()().mark((function e(t){var n,r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("values:",t),z.yw.loading(_.formatMessage({id:"registering",defaultMessage:"registering..."})),e.next=5,(0,d.z2)(o()({},t));case 5:if(n=e.sent,console.log("registerResult:",n),200!==n.code){e.next=15;break}return z.yw.destroy(),z.yw.success(n.message),r={username:t.email,password:t.password,captchaUid:Q,captchaCode:t.captchaCode,platform:N.iw8},ce(r),e.abrupt("return");case 15:z.yw.destroy(),z.yw.error(n.message);case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0),z.yw.error(_.formatMessage({id:"register.error",defaultMessage:"register failed"}));case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=c()(s()().mark((function e(t){var n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("handleSubmit values: ",t),z.yw.loading(_.formatMessage({id:"logging",defaultMessage:"logging..."})),e.next=5,(0,d.x4)(o()({},t));case 5:n=e.sent,console.log("LoginResult:",n),200===n.code?(z.yw.destroy(),z.yw.success(_.formatMessage({id:"login.success",defaultMessage:"login success"})),se(n.data.user),G(n.data.user),V(n.data.accessToken),M.history.push("/")):(z.yw.destroy(),z.yw.error(n.message)),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0),z.yw.error(_.formatMessage({id:"login.error",defaultMessage:"login failed"}));case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return(0,R.jsxs)(v._Y,{hashed:!1,dark:r,children:[(0,R.jsx)(F,{}),(0,R.jsx)("div",{style:{backgroundColor:n.colorBgContainer,textAlign:"center",height:"100vh",backgroundImage:"url('/admin/assets/images/bg-wide.png')"},children:W?(0,R.jsxs)(x.U,{form:t,contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,R.jsx)("img",{alt:"logo",src:"/admin/icons/logo.png"}),title:(0,R.jsx)(M.FormattedMessage,{id:"app.title"}),subTitle:_.formatMessage({id:"pages.login.registerAccount"}),initialValues:{autoLogin:!0},submitter:{searchConfig:{submitText:_.formatMessage({id:"pages.login.register"})}},onFinish:function(){var e=c()(s()().mark((function e(t){var n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("login values:",t),n={email:t.username,password:t.password,mobile:t.mobile,code:t.code,captchaUid:Q,captchaCode:t.captchaCode,platform:N.iw8},console.log("register info:",n),e.next=5,ie(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:["error"===status&&(0,R.jsx)(D,{content:_.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"账户或密码错误"})}),(0,R.jsx)(b.Z,{name:"username",fieldProps:{size:"large",prefix:(0,R.jsx)(g.Z,{})},placeholder:_.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"邮箱"}),rules:[{required:!0,message:(0,R.jsx)(M.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"请输入邮箱!"})},{pattern:/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/,message:"邮箱格式不正确"},{max:50,message:"邮箱不得超过50字符"}]}),(0,R.jsx)(b.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,R.jsx)(f.Z,{})},placeholder:_.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"密码"}),rules:[{required:!0,message:(0,R.jsx)(M.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"请输入密码！"})}]}),(0,R.jsx)(b.Z,{fieldProps:{size:"large",prefix:(0,R.jsx)(m.Z,{})},name:"mobile",placeholder:_.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"手机号"}),rules:[{required:!0,message:(0,R.jsx)(M.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"请输入手机号！"})},{pattern:/^1\d{10}$/,message:(0,R.jsx)(M.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"手机号格式错误！"})}]}),(0,R.jsx)(h.A.Item,{name:"captchaCode",rules:[{required:!0,message:_.formatMessage({id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],children:(0,R.jsx)(L.Z,{onKaptchaChange:oe,onKaptchaCheck:ae})}),(0,R.jsx)(w.Z,{fieldProps:{size:"large",prefix:(0,R.jsx)(f.Z,{})},captchaProps:{size:"large",disabled:!y},placeholder:_.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"请输入验证码"}),captchaTextRender:function(e,t){return e?"".concat(t," ").concat(_.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"获取验证码"})):_.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"获取验证码"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,R.jsx)(M.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],fieldRef:a,onGetCaptcha:function(){var e=c()(s()().mark((function e(t){var n,r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||11!==t.length){e.next=13;break}return n={mobile:t,type:N.zgb,captchaUid:Q,captchaCode:ne,platform:N.iw8},e.next=4,(0,d.Y7)(n);case 4:if(r=e.sent,console.log("sendMobileCodeResult:",r),200===r.code){e.next=10;break}return z.yw.error(r.message),setTimeout((function(){var e;console.log("endCaptchaTiming"),null===(e=a.current)||void 0===e||e.endTiming()}),2),e.abrupt("return");case 10:z.yw.success(r.message),e.next=14;break;case 13:z.yw.error("手机号格式错误");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),"error"===status&&(0,R.jsx)(D,{content:"验证码错误"}),(0,R.jsx)("div",{style:{marginBottom:64},children:(0,R.jsx)("div",{style:{float:"right"},children:(0,R.jsx)(M.Link,{to:"/auth/login",children:(0,R.jsx)(M.FormattedMessage,{id:"pages.login.submit",defaultMessage:"登录 "})})})})]}):(0,R.jsx)("div",{style:{textAlign:"center",margin:"0 auto"},children:(0,R.jsx)(k.Z,{description:"only for vip users, please contact: 270580156@qq.com",children:(0,R.jsx)($.ZP,{type:"primary",onClick:function(){window.open("https://www.weiyuai.cn")},children:"open weiyuai.cn"})})})}),(0,R.jsx)(p.$_,{})]})};t.default=function(){var e=(0,E.Z)().isDarkMode;return(0,R.jsx)(Z.ZP,{theme:{algorithm:e?A:q},children:(0,R.jsxs)(S.Z,{children:[(0,R.jsx)(z.ZP,{}),(0,R.jsx)(W,{})]})})}},36669:function(e,t,n){n.d(t,{Z:function(){return q}});var r=n(44194),o=n(58644),a=n(92520),s=n(14377),i=n(64985),c=n(18701),l=n(51865),u=n.n(l),d=n(77588),p=n(67762),g=n(34221),f=n(79145),m=n(37167),h=n(47825),v=n(88874),x=n(65759);const b=(e,t,n,r,o)=>({background:e,border:`${(0,h.bf)(r.lineWidth)} ${r.lineType} ${t}`,[`${o}-icon`]:{color:n}}),w=e=>{const{componentCls:t,motionDurationSlow:n,marginXS:r,marginSM:o,fontSize:a,fontSizeLG:s,lineHeight:i,borderRadiusLG:c,motionEaseInOutCirc:l,withDescriptionIconSize:u,colorText:d,colorTextHeading:p,withDescriptionPadding:g,defaultPadding:f}=e;return{[t]:Object.assign(Object.assign({},(0,v.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:f,wordWrap:"break-word",borderRadius:c,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:a,lineHeight:i},"&-message":{color:p},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${l}, opacity ${n} ${l},\n        padding-top ${n} ${l}, padding-bottom ${n} ${l},\n        margin-bottom ${n} ${l}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${t}-with-description`]:{alignItems:"flex-start",padding:g,[`${t}-icon`]:{marginInlineEnd:o,fontSize:u,lineHeight:0},[`${t}-message`]:{display:"block",marginBottom:r,color:p,fontSize:s},[`${t}-description`]:{display:"block",color:d}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},y=e=>{const{componentCls:t,colorSuccess:n,colorSuccessBorder:r,colorSuccessBg:o,colorWarning:a,colorWarningBorder:s,colorWarningBg:i,colorError:c,colorErrorBorder:l,colorErrorBg:u,colorInfo:d,colorInfoBorder:p,colorInfoBg:g}=e;return{[t]:{"&-success":b(o,r,n,e,t),"&-info":b(g,p,d,e,t),"&-warning":b(i,s,a,e,t),"&-error":Object.assign(Object.assign({},b(u,l,c,e,t)),{[`${t}-description > pre`]:{margin:0,padding:0}})}}},M=e=>{const{componentCls:t,iconCls:n,motionDurationMid:r,marginXS:o,fontSizeIcon:a,colorIcon:s,colorIconHover:i}=e;return{[t]:{"&-action":{marginInlineStart:o},[`${t}-close-icon`]:{marginInlineStart:o,padding:0,overflow:"hidden",fontSize:a,lineHeight:(0,h.bf)(a),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:s,transition:`color ${r}`,"&:hover":{color:i}}},"&-close-text":{color:s,transition:`color ${r}`,"&:hover":{color:i}}}}};var j=(0,x.I$)("Alert",(e=>[w(e),y(e),M(e)]),(e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}))),C=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const k={success:o.Z,info:c.Z,error:a.Z,warning:i.Z},$=e=>{const{icon:t,prefixCls:n,type:o}=e,a=k[o]||null;return t?(0,f.wm)(t,r.createElement("span",{className:`${n}-icon`},t),(()=>({className:u()(`${n}-icon`,t.props.className)}))):r.createElement(a,{className:`${n}-icon`})},Z=e=>{const{isClosable:t,prefixCls:n,closeIcon:o,handleClose:a,ariaProps:i}=e,c=!0===o||void 0===o?r.createElement(s.Z,null):o;return t?r.createElement("button",Object.assign({type:"button",onClick:a,className:`${n}-close-icon`,tabIndex:0},i),c):null},S=r.forwardRef(((e,t)=>{const{description:n,prefixCls:o,message:a,banner:s,className:i,rootClassName:c,style:l,onMouseEnter:f,onMouseLeave:h,onClick:v,afterClose:x,showIcon:b,closable:w,closeText:y,closeIcon:M,action:k,id:S}=e,I=C(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[E,z]=r.useState(!1);const N=r.useRef(null);r.useImperativeHandle(t,(()=>({nativeElement:N.current})));const{getPrefixCls:P,direction:O,alert:T}=r.useContext(m.E_),B=P("alert",o),[L,H,R]=j(B),q=t=>{var n;z(!0),null===(n=e.onClose)||void 0===n||n.call(e,t)},A=r.useMemo((()=>void 0!==e.type?e.type:s?"warning":"info"),[e.type,s]),F=r.useMemo((()=>!("object"!=typeof w||!w.closeIcon)||(!!y||("boolean"==typeof w?w:!1!==M&&null!=M||!!(null==T?void 0:T.closable)))),[y,M,w,null==T?void 0:T.closable]),D=!(!s||void 0!==b)||b,W=u()(B,`${B}-${A}`,{[`${B}-with-description`]:!!n,[`${B}-no-icon`]:!D,[`${B}-banner`]:!!s,[`${B}-rtl`]:"rtl"===O},null==T?void 0:T.className,i,c,R,H),U=(0,p.Z)(I,{aria:!0,data:!0}),V=r.useMemo((()=>{var e,t;return"object"==typeof w&&w.closeIcon?w.closeIcon:y||(void 0!==M?M:"object"==typeof(null==T?void 0:T.closable)&&(null===(e=null==T?void 0:T.closable)||void 0===e?void 0:e.closeIcon)?null===(t=null==T?void 0:T.closable)||void 0===t?void 0:t.closeIcon:null==T?void 0:T.closeIcon)}),[M,w,y,null==T?void 0:T.closeIcon]),G=r.useMemo((()=>{const e=null!=w?w:null==T?void 0:T.closable;if("object"==typeof e){const{closeIcon:t}=e;return C(e,["closeIcon"])}return{}}),[w,null==T?void 0:T.closable]);return L(r.createElement(d.ZP,{visible:!E,motionName:`${B}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:x},((t,o)=>{let{className:s,style:i}=t;return r.createElement("div",Object.assign({id:S,ref:(0,g.sQ)(N,o),"data-show":!E,className:u()(W,s),style:Object.assign(Object.assign(Object.assign({},null==T?void 0:T.style),l),i),onMouseEnter:f,onMouseLeave:h,onClick:v,role:"alert"},U),D?r.createElement($,{description:n,icon:e.icon,prefixCls:B,type:A}):null,r.createElement("div",{className:`${B}-content`},a?r.createElement("div",{className:`${B}-message`},a):null,n?r.createElement("div",{className:`${B}-description`},n):null),k?r.createElement("div",{className:`${B}-action`},k):null,r.createElement(Z,{isClosable:F,prefixCls:B,closeIcon:V,handleClose:q,ariaProps:G}))})))}));var I=S,E=n(74592),z=n(32099),N=n(42885),P=n(19567),O=n(27842);function T(e,t,n){return t=(0,N.Z)(t),(0,O.Z)(e,(0,P.Z)()?Reflect.construct(t,n||[],(0,N.Z)(e).constructor):t.apply(e,n))}var B=n(14755);let L=function(e){function t(){var e;return(0,E.Z)(this,t),(e=T(this,t,arguments)).state={error:void 0,info:{componentStack:""}},e}return(0,B.Z)(t,e),(0,z.Z)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){const{message:e,description:t,id:n,children:o}=this.props,{error:a,info:s}=this.state,i=(null==s?void 0:s.componentStack)||null,c=void 0===e?(a||"").toString():e,l=void 0===t?i:t;return a?r.createElement(I,{id:n,type:"error",message:c,description:r.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},l)}):o}}])}(r.Component);var H=L;const R=I;R.ErrorBoundary=H;var q=R}}]);