"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6378],{84881:function(e,n,t){var r=t(17082),a=t(73457),o=t(82308),s=t(44194),u=t(63653),i=t(5369),l=t(31549),c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,n){var t=e.fieldProps,d=e.children,p=e.params,f=e.proFieldProps,h=e.mode,m=e.valueEnum,g=e.request,v=e.showSearch,b=e.options,x=(0,a.Z)(e,c),y=(0,s.useContext)(u.Z);return(0,l.jsx)(i.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,o.h)(m),request:g,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({options:b,mode:h,showSearch:v,getPopupContainer:y.getPopupContainer},t),ref:n,proFieldProps:f},x),{},{children:d}))},f=s.forwardRef((function(e,n){var t=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,h=e.mode,m=e.valueEnum,g=e.request,v=e.options,b=(0,a.Z)(e,d),x=(0,r.Z)({options:v,mode:h||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},t),y=(0,s.useContext)(u.Z);return(0,l.jsx)(i.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,o.h)(m),request:g,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({getPopupContainer:y.getPopupContainer},x),ref:n,proFieldProps:f},b),{},{children:c}))})),h=s.forwardRef(p);h.SearchSelect=f,h.displayName="ProFormComponent",n.Z=h},4499:function(e,n,t){var r=t(42601),a=t(17082),o=t(73457),s=t(46015),u=t(57178),i=t(98036),l=t(36490),c=t(44194),d=t(5369),p=t(31549),f=["fieldProps","proFieldProps"],h=["fieldProps","proFieldProps"],m="text",g=function(e){var n=(0,s.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),t=(0,r.Z)(n,2),o=t[0],l=t[1];return(0,p.jsx)(u.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(n){var t,r=n.getFieldValue(e.name||[]);return(0,p.jsx)(i.Z,(0,a.Z)((0,a.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return l(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(t=e.statusRender)||void 0===t?void 0:t.call(e,r),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:o,children:e.children}))}})},v=function(e){var n=e.fieldProps,t=e.proFieldProps,r=(0,o.Z)(e,f);return(0,p.jsx)(d.Z,(0,a.Z)({valueType:m,fieldProps:n,filedConfig:{valueType:m},proFieldProps:t},r))};v.Password=function(e){var n=e.fieldProps,t=e.proFieldProps,s=(0,o.Z)(e,h),u=(0,c.useState)(!1),i=(0,r.Z)(u,2),f=i[0],v=i[1];return null!=n&&n.statusRender&&s.name?(0,p.jsx)(g,{name:s.name,statusRender:null==n?void 0:n.statusRender,popoverProps:null==n?void 0:n.popoverProps,strengthText:null==n?void 0:n.strengthText,open:f,onOpenChange:v,children:(0,p.jsx)("div",{children:(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:(0,a.Z)((0,a.Z)({},(0,l.Z)(n,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var t;null==n||null===(t=n.onBlur)||void 0===t||t.call(n,e),v(!1)},onClick:function(e){var t;null==n||null===(t=n.onClick)||void 0===t||t.call(n,e),v(!0)}}),proFieldProps:t,filedConfig:{valueType:m}},s))})}):(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:n,proFieldProps:t,filedConfig:{valueType:m}},s))},v.displayName="ProFormComponent",n.Z=v},27522:function(e,n,t){t.d(n,{AP:function(){return d},_J:function(){return v},t5:function(){return m},v_:function(){return f}});var r=t(90819),a=t.n(r),o=t(73193),s=t.n(o),u=t(89933),i=t.n(u),l=t(55735),c=t(30921);function d(e){return p.apply(this,arguments)}function p(){return(p=i()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/query/org",{method:"GET",params:s()(s()({},n),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=i()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/create",{method:"POST",data:s()(s()({},n),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=i()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/update",{method:"POST",data:s()(s()({},n),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=i()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/delete",{method:"POST",data:s()(s()({},n),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},96865:function(e,n,t){var r=t(23864);n.Z=function(){var e=(0,r.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"}}}},76750:function(e,n,t){var r=t(55735),a=t(65461),o=t(30921);n.Z=function(){var e=(0,o.useIntl)();return{translateString:function(n){return null==n?n:n&&(null!=n&&n.startsWith(r.VoP)||null!=n&&n.startsWith("ROLE_"))?e.formatMessage({id:n,defaultMessage:n}):n},translateStringTranct:function(n){return null==n?n:null!=n&&n.startsWith(r.VoP)||null!=n&&n.startsWith("ROLE_")?(0,a.aS)(e.formatMessage({id:n,defaultMessage:n}),10):(0,a.aS)(n,10)}}}},83139:function(e,n,t){t.d(n,{Z:function(){return T}});var r=t(90819),a=t.n(r),o=t(89933),s=t.n(o),u=t(45332),i=t.n(u),l=t(53530),c=t(9452),d=t(44194),p=t(86803),f=t(76750),h=t(40612),m=t(55735),g=t(69169),v=t(84881),b=t(4499),x=t(32350),y=t(31549),k=function(e){var n=e.open,t=e.isEdit,r=e.type,o=e.kbase,u=e.onCancel,c=e.onSubmit,k=g.A.useForm(),w=i()(k,1)[0],Z=(0,f.Z)().translateString,P=(0,h.u)((function(e){return e.currentOrg}));(0,d.useEffect)((function(){t?(w.setFieldsValue({name:Z(null==o?void 0:o.name)}),w.setFieldsValue({headline:Z(null==o?void 0:o.headline)}),w.setFieldsValue({footerHtml:Z(null==o?void 0:o.footerHtml)}),w.setFieldsValue({descriptionHtml:Z(null==o?void 0:o.descriptionHtml)}),w.setFieldsValue({language:null==o?void 0:o.language})):(w.resetFields(),w.setFieldsValue({language:"ZH_CN"}))}),[n]);var K=function(){w.validateFields().then(function(){var e=s()(a()().mark((function e(n){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleSaveDep:",n),s={uid:t?null==o?void 0:o.uid:"",name:n.name,headline:n.headline,descriptionHtml:n.descriptionHtml,footerHtml:n.footerHtml,type:r,language:n.language,orgUid:null==P?void 0:P.uid},c(s);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log("Failed:",e),p.yw.error("创建知识库失败")}))},C=function(e){"Enter"===e.key&&K()};return(0,y.jsx)("div",{children:(0,y.jsx)(l.Z,{title:"新建知识库",open:n,forceRender:!0,onOk:K,onCancel:u,children:(0,y.jsxs)(g.A,{form:w,submitter:!1,children:[(0,y.jsx)(v.Z,{label:"知识库语言",name:"language",rules:[{required:!0,message:"请选择知识库语言!"}],options:[{label:"简体中文",value:"ZH_CN"},{label:"English",value:"EN"},{label:"繁体中文",value:"ZH_TW"}],fieldProps:{onChange:function(e){console.log("handleLanguageSelect:",e)},placeholder:"请选择知识库语言",allowClear:!0}}),(0,y.jsx)(b.Z,{label:"知识库名称",name:"name",rules:[{required:!0,message:"请输入名称!"}],fieldProps:{onPressEnter:C,placeholder:"请输入名称"}}),r===m.VX&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(b.Z,{label:"主标题",name:"headline",rules:[{required:!0,message:"请输入主标题!"}],fieldProps:{onPressEnter:C,placeholder:"请输入名称"}}),(0,y.jsx)(x.Z,{label:"页脚",name:"footerHtml",rules:[{required:!0,message:"请输入页脚!"}]})]}),(0,y.jsx)(x.Z,{label:"描述",name:"descriptionHtml"})]})})})},w=t(27522),Z=t(6397),P=t(23864),K=t(30921),C=t(15722),j=t(27487),S=t(75365),F=function(e){var n=e.currentKbase,t=e.handleNewKbase,r=e.handleEditKbase,a=e.showDeleteConfirmModel,o=(0,K.useIntl)();return(0,y.jsx)("div",{children:(0,y.jsxs)(j.Z,{gap:"small",wrap:"wrap",style:{padding:"10px"},children:[(0,y.jsx)(S.ZP,{size:"small",type:"primary",onClick:t,children:o.formatMessage({id:"createKb",defaultMessage:"Create Knowledge Base"})}),""!==(null==n?void 0:n.uid)&&(null==n?void 0:n.uid)!==m.zBg&&(0,y.jsx)(S.ZP,{size:"small",onClick:r,children:o.formatMessage({id:"edit",defaultMessage:"Edit"})}),""!==(null==n?void 0:n.uid)&&(null==n?void 0:n.uid)!==m.zBg&&(0,y.jsx)(S.ZP,{onClick:function(){return a(n)},size:"small",style:{float:"right"},danger:!0,children:o.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]})})},R=l.Z.confirm,T=function(e){var n=e.type,t=(0,K.useIntl)(),r=(0,d.useRef)(!1),o=(0,d.useState)(!1),u=i()(o,2),l=u[0],g=u[1],v=(0,P.Z)().isDarkMode,b=(0,f.Z)().translateString,x=(0,h.u)((function(e){return e.currentOrg})),j=(0,d.useState)(!0),S=i()(j,2),T=S[0],E=S[1],M=(0,Z.j)((function(e){return{kbaseResult:e.kbaseResult,currentKbase:e.currentKbase,insertKbase:e.insertKbase,updateLocalKbase:e.updateKbase,setKbaseResult:e.setKbaseResult,setCurrentKbase:e.setCurrentKbase,removeKbase:e.removeKbase}})),H=M.kbaseResult,q=M.currentKbase,V=M.insertKbase,O=M.updateLocalKbase,I=M.setKbaseResult,L=M.setCurrentKbase,D=M.removeKbase,N=function(){var e=s()(a()().mark((function e(){var t,o;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.current){e.next=3;break}return console.log("isLoading: 1",r.current),e.abrupt("return");case 3:return r.current=!0,p.yw.loading("loading"),t={pageNumber:0,pageSize:50,type:n,orgUid:null==x?void 0:x.uid},e.next=8,(0,w.AP)(t);case 8:o=e.sent,console.log("queryKbasesByOrg: ",o),200===o.code?(p.yw.destroy(),I(o)):(p.yw.destroy(),p.yw.error(o.message)),r.current=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){console.log("useEffect"),N()}),[]);var _=function(){var e=s()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T?W(n):z(n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),z=function(){var e=s()(a()().mark((function e(n){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("create kb",n),e.next=3,(0,w.v_)(n);case 3:t=e.sent,console.log("create kb response",t),200===t.code?(V(t.data),g(!1)):(console.log("create kb failed",t),p.yw.error(t.message));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),W=function(){var e=s()(a()().mark((function e(n){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("update kb",n),e.next=3,(0,w.t5)(n);case 3:t=e.sent,console.log("update kb response",t),200===t.code?(O(t.data),g(!1)):(console.log("update kb failed",t),p.yw.error(t.message));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),B=function(){var e=s()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleEditKbase: ",q),E(!0),g(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=s()(a()().mark((function e(n){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleDeleteKbase: ",n),1!==H.data.content.length){e.next=4;break}return p.yw.error(t.formatMessage({id:"deleteKbaseTip"})),e.abrupt("return");case 4:return e.next=6,(0,w._J)(n);case 6:r=e.sent,console.log("handleDeleteKbase: ",r),200==r.code?(D(n.uid),N()):(console.log("handleDeleteKbase: ",r),p.yw.error(r.message));case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),A=function(e){return n!=m._FS?b(e.descriptionHtml):e.level===m.Hxq?"全平台客服可见":e.level===m.whQ?"本组织客服可见":e.level===m.fyH?"本客服可见":b(e.descriptionHtml)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(F,{currentKbase:q,handleNewKbase:function(){console.log("new kb"),E(!1),g(!0)},handleEditKbase:B,showDeleteConfirmModel:function(e){R({title:t.formatMessage({id:"deleteTip"}),icon:(0,y.jsx)(C.Z,{}),content:"".concat(t.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(b(e.name),"】？"),onOk:function(){U(e)},onCancel:function(){},okText:t.formatMessage({id:"ok"}),cancelText:t.formatMessage({id:"cancel"})})}}),(0,y.jsx)(c.Z,{itemLayout:"horizontal",dataSource:H.data.content,renderItem:function(e,n){return(0,y.jsx)(c.Z.Item,{style:q.uid===e.uid?{backgroundColor:v?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){L(e)},children:(0,y.jsx)(c.Z.Item.Meta,{style:{marginLeft:"10px"},title:b(e.name),description:A(e)})})}}),l&&(0,y.jsx)(k,{open:l,isEdit:T,type:n,kbase:q,onSubmit:_,onCancel:function(){g(!1)}})]})}},6397:function(e,n,t){t.d(n,{j:function(){return d}});var r=t(73193),a=t.n(r),o=t(76711),s=t.n(o),u=t(55735),i=t(44435),l=t(83642),c=t(83890),d=(0,i.Ue)()((0,l.mW)((0,l.tJ)((0,c.n)((function(e,n){return{currentKbase:{uid:"",orgUid:""},kbaseResult:{data:{content:[]}},insertKbase:function(n){e((function(e){e.kbaseResult.data.content.unshift(n)}))},updateKbase:function(n){e((function(e){var t=e.kbaseResult.data.content,r=t.findIndex((function(e){return e.uid===n.uid}));-1!==r?t[r]=n:console.warn("Kbase with uid ".concat(n.uid," not found."))}))},setKbaseResult:function(n){var t;e({kbaseResult:n}),(null===(t=n.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.length)>0&&e({currentKbase:n.data.content[0]})},setCurrentKbase:function(t){var r=n().kbaseResult.data.content,o=r.findIndex((function(e){return e.uid===t.uid}));if(-1!==o){var u=[].concat(s()(r.slice(0,o)),[t],s()(r.slice(o+1))),i=a()(a()({},n().kbaseResult),{},{data:{content:u}});e({kbaseResult:i,currentKbase:t})}else console.warn("Kbase with the specified uid not found."),e({currentKbase:t})},removeKbase:function(t){var r=n().kbaseResult.data.content,o=r.findIndex((function(e){return e.uid===t}));-1!==o?e({kbaseResult:a()(a()({},n().kbaseResult),{},{data:{content:[].concat(s()(r.slice(0,o)),s()(r.slice(o+1)))}})}):console.warn("Kbase not found in cache:",t),n().currentKbase.uid===t&&e({currentKbase:{uid:"",orgUid:""}})},deleteKbaseCache:function(){return e({},!0)}}})),{name:u.wKE})))}}]);