"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8185],{32725:function(e,t,n){n.d(t,{EN:function(){return d},G_:function(){return p},Vh:function(){return b},WN:function(){return m},ry:function(){return v}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),c=n(94976),l=n(4628);function d(e){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ai/statistic/token/query/org",{method:"GET",params:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ai/statistic/token/delete",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){return x.apply(this,arguments)}function x(){return(x=u()(i()().mark((function e(t,n){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ai/statistic/token/hourly",{method:"GET",params:{orgUid:t,date:n,channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t,n){return g.apply(this,arguments)}function g(){return(g=u()(i()().mark((function e(t,n,r){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ai/statistic/token/hourly/provider",{method:"GET",params:{orgUid:t,date:n,aiProvider:r,channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t,n){return y.apply(this,arguments)}function y(){return(y=u()(i()().mark((function e(t,n,r){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ai/statistic/token/hourly/model",{method:"GET",params:{orgUid:t,date:n,aiModelType:r,channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},10440:function(e,t,n){n.d(t,{K_:function(){return b},Np:function(){return p},dx:function(){return v},xH:function(){return m},xs:function(){return d}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),c=n(94976),l=n(4628);function d(e){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/freeswitch/cdr/query/org",{method:"GET",params:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/freeswitch/cdr/create",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return(x=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/freeswitch/cdr/update",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/freeswitch/cdr/delete",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/freeswitch/cdr/delete/org",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},67212:function(e,t,n){n.d(t,{Az:function(){return d},Bv:function(){return C},DO:function(){return b},L0:function(){return T},RF:function(){return k},Xc:function(){return v},YO:function(){return Z},jX:function(){return m},tu:function(){return p}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),c=n(94976),l=n(4628);function d(e){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/query/org",{method:"GET",params:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/create",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return(x=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/update",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/delete",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/deleteAll",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return j.apply(this,arguments)}function j(){return(j=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/updateIndex",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return w.apply(this,arguments)}function w(){return(w=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/updateVectorIndex",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return S.apply(this,arguments)}function S(){return(S=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/updateAllIndex",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return M.apply(this,arguments)}function M(){return(M=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/article/updateAllVectorIndex",{method:"POST",data:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},83163:function(e,t,n){n.d(t,{Wq:function(){return d}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),c=n(94976),l=n(4628);function d(e){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/queue/query/org",{method:"GET",params:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},39386:function(e,t,n){n.d(t,{Eb:function(){return d},RU:function(){return p}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),c=n(94976),l=n(4628);function d(){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/service/statistic/query",{method:"GET",params:{channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/service/statistic/query/date",{method:"GET",params:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},35820:function(e,t,n){n.d(t,{AD:function(){return d}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),c=n(94976),l=n(4628);function d(e){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ticket/statistic/query/date",{method:"GET",params:s()(s()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},21850:function(e,t,n){var r=n(25553);t.Z=function(){var e=(0,r.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},35797:function(e,t,n){n.r(t),n.d(t,{default:function(){return pe}});var r=n(45332),i=n.n(r),a=n(74171),s=n(4628),o=n(44194),u=n(84993),c=n(27729),l=n(69533),d=n(31549),h=function(e){var t=e.open,n=e.onClose,r=(0,s.useIntl)(),i=(0,s.useNavigate)(),a=function(){localStorage.setItem("skipVerification","true"),n()};return(0,d.jsx)(c.Z,{title:r.formatMessage({id:"welcome.verify.modal.title",defaultMessage:"账号验证提示"}),open:t,onCancel:a,footer:[(0,d.jsx)(l.ZP,{onClick:a,children:r.formatMessage({id:"welcome.verify.later",defaultMessage:"稍后验证"})},"later"),(0,d.jsx)(l.ZP,{type:"primary",onClick:function(){n(),i("/setting/certification")},children:r.formatMessage({id:"welcome.verify.now",defaultMessage:"立即验证"})},"now")],children:(0,d.jsx)("p",{children:r.formatMessage({id:"welcome.verify.modal.description",defaultMessage:"您的邮箱和手机号尚未验证，为保障账号安全，建议您尽快完成验证。"})})})},p=n(96955),f=n(67242),v=n(90819),x=n.n(v),m=n(89933),g=n.n(m),b=n(73193),y=n.n(b),k=n(45516),j=n(30861),Z=n(82878),w=n(92351),T=n(90581),S=n(30310),C=n(68177),M=n(26874),P=n(95018),R=n(65641),I=n(93646),D=n(10390),q=n(87989),A=n(34073),O=n(96798),E=n(80556),L=n(58791),F=n(93878),J=n(70424),X=n(82741),N=n(74840),z=n(58087),H=n(79479),Y=n(17811),B=n(97876),U=n(71194),G=n(96596),_=n.n(G),K=n(43388),W=n(39386),V=n(35820),Q=n(32725),$=n(10440),ee=n(67212),te=n(94976);function ne(e){return re.apply(this,arguments)}function re(){return(re=g()(x()().mark((function e(t){return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/notice/query/org",{method:"GET",params:y()(y()({},t),{},{channel:te.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=n(83163),ae=n(85977),se=j.default.RangePicker,oe=Z.Z.Title,ue=Z.Z.Text,ce=function(e){if(!e||e<=0)return"0s";if(e<60)return"".concat(Math.round(e),"s");var t=Math.floor(e/60),n=Math.round(e%60);return"".concat(t,"m ").concat(n,"s")},le=function(e){return null==e||Number.isNaN(e)?0:Math.max(0,Math.min(100,Math.round(e)))},de=function(){var e,t,n,r,u,c,h=(0,k.s0)(),v=(0,s.useIntl)(),m=(0,s.useAccess)(),b=(0,o.useCallback)((function(e,t,n){return v.formatMessage({id:e,defaultMessage:t},n)}),[v]),j=function(){try{return!1}catch(e){return!1}}(),Z=(0,a.u)((function(e){return e.currentOrg})),G=(0,o.useMemo)((function(){try{var e,t,n;return null!==(e=null==m||null===(t=m.getModulePermission)||void 0===t||null===(t=t.call(m,ae.MY.SERVICE_STATISTIC))||void 0===t||null===(n=t.canRead)||void 0===n?void 0:n.call(t))&&void 0!==e&&e}catch(e){return!1}}),[m]),re=(0,o.useMemo)((function(){try{var e,t,n;return null!==(e=null==m||null===(t=m.getModulePermission)||void 0===t||null===(t=t.call(m,ae.MY.TICKET_STATISTIC))||void 0===t||null===(n=t.canRead)||void 0===n?void 0:n.call(t))&&void 0!==e&&e}catch(e){return!1}}),[m]),de=(0,o.useMemo)((function(){try{var e,t,n;return null!==(e=null==m||null===(t=m.getModulePermission)||void 0===t||null===(t=t.call(m,ae.MY.AI_STATISTIC))||void 0===t||null===(n=t.canRead)||void 0===n?void 0:n.call(t))&&void 0!==e&&e}catch(e){return!1}}),[m]),he=(0,o.useMemo)((function(){try{var e,t,n;return null!==(e=null==m||null===(t=m.getModulePermission)||void 0===t||null===(t=t.call(m,ae.MY.CALL_STATISTIC))||void 0===t||null===(n=t.canRead)||void 0===n?void 0:n.call(t))&&void 0!==e&&e}catch(e){return!1}}),[m]),pe=(0,o.useMemo)((function(){try{var e,t,n;return null!==(e=null==m||null===(t=m.getModulePermission)||void 0===t||null===(t=t.call(m,ae.MY.QUEUE))||void 0===t||null===(n=t.canRead)||void 0===n?void 0:n.call(t))&&void 0!==e&&e}catch(e){return!1}}),[m]),fe=(0,o.useMemo)((function(){try{var e,t,n;return null!==(e=null==m||null===(t=m.getModulePermission)||void 0===t||null===(t=t.call(m,ae.MY.ARTICLE))||void 0===t||null===(n=t.canRead)||void 0===n?void 0:n.call(t))&&void 0!==e&&e}catch(e){return!1}}),[m]),ve=(0,o.useMemo)((function(){try{var e,t,n;return null!==(e=null==m||null===(t=m.getModulePermission)||void 0===t||null===(t=t.call(m,ae.MY.NOTICE))||void 0===t||null===(n=t.canRead)||void 0===n?void 0:n.call(t))&&void 0!==e&&e}catch(e){return!1}}),[m]),xe=(0,o.useState)([_()().startOf("day").subtract(6,"day"),_()().endOf("day")]),me=i()(xe,2),ge=me[0],be=me[1],ye=(0,o.useState)(),ke=i()(ye,2),je=ke[0],Ze=ke[1],we=(0,o.useState)(),Te=i()(we,2),Se=Te[0],Ce=Te[1],Me=(0,o.useState)(),Pe=i()(Me,2),Re=Pe[0],Ie=Pe[1],De=(0,o.useState)([]),qe=i()(De,2),Ae=qe[0],Oe=qe[1],Ee=(0,o.useState)(0),Le=i()(Ee,2),Fe=Le[0],Je=Le[1],Xe=(0,o.useState)([]),Ne=i()(Xe,2),ze=Ne[0],He=Ne[1],Ye=(0,o.useState)(0),Be=i()(Ye,2),Ue=Be[0],Ge=Be[1],_e=(0,o.useState)([]),Ke=i()(_e,2),We=Ke[0],Ve=Ke[1],Qe=(0,o.useState)(0),$e=i()(Qe,2),et=$e[0],tt=$e[1],nt=(0,o.useState)([]),rt=i()(nt,2),it=rt[0],at=rt[1],st=(0,o.useMemo)((function(){return{kpis:G||re,ticketStatusPie:re,aiTokenLine:de,serviceStatusPie:G,serviceDurationLine:G,serviceHourlyLine:pe,recentCalls:j&&he,articles:fe,notices:ve,agentPerformance:G}}),[j,G,re,de,pe,he,fe,ve]),ot=(0,o.useState)(st),ut=i()(ot,2),ct=ut[0],lt=ut[1],dt=(0,o.useState)(!1),ht=i()(dt,2),pt=ht[0],ft=ht[1],vt=(0,o.useMemo)((function(){return y()(y()({},ct),{},{kpis:Boolean(ct.kpis&&(G||re)),ticketStatusPie:Boolean(ct.ticketStatusPie&&re),aiTokenLine:Boolean(ct.aiTokenLine&&de),serviceStatusPie:Boolean(ct.serviceStatusPie&&G),serviceDurationLine:Boolean(ct.serviceDurationLine&&G),serviceHourlyLine:Boolean(ct.serviceHourlyLine&&pe),recentCalls:Boolean(ct.recentCalls&&j&&he),agentPerformance:Boolean(ct.agentPerformance&&G),articles:Boolean(ct.articles&&fe),notices:Boolean(ct.notices&&ve)})}),[ct,G,re,de,pe,j,he,fe,ve]),xt=(0,o.useMemo)((function(){return Object.values(vt).some(Boolean)}),[vt]),mt=(0,o.useMemo)((function(){return Boolean(G||re||de||he||pe||fe||ve)}),[G,re,de,he,pe,fe,ve]),gt=(0,o.useMemo)((function(){return!mt}),[mt]),bt=(0,o.useState)(!1),yt=i()(bt,2),kt=yt[0],jt=yt[1],Zt=(0,o.useMemo)((function(){var e;return null===(e=ge[0])||void 0===e?void 0:e.format("YYYY-MM-DD")}),[ge]),wt=(0,o.useMemo)((function(){var e;return null===(e=ge[1])||void 0===e?void 0:e.format("YYYY-MM-DD")}),[ge]),Tt=(0,o.useCallback)(g()(x()().mark((function e(){var t,n,r,a,s,o,u,c,l,d,h,p,v,m,g,y,k,w,T,S,C,M,P,R,I,D,q,A,O,E,L,F,J,X,N,z,H,Y,B;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=Z&&Z.uid){e.next=2;break}return e.abrupt("return");case 2:return jt(!0),e.prev=3,t=Z.uid,n=j&&he?(0,$.xs)({orgUid:t,pageNumber:0,pageSize:10,startStamp:"".concat(Zt," 00:00:00"),endStamp:"".concat(wt," 23:59:59"),sortBy:"startStamp",sortDirection:"descend"}):Promise.resolve(void 0),r=G?(0,W.RU)({orgUid:t,startDate:Zt,endDate:wt,type:te.whQ}):Promise.resolve(void 0),a=re?(0,V.AD)({orgUid:t,startDate:Zt,endDate:wt,type:te.whQ}):Promise.resolve(void 0),s=de?(0,Q.ry)(t,wt||_()().format("YYYY-MM-DD")):Promise.resolve(void 0),o=fe?(0,ee.Az)({orgUid:t,pageNumber:0,pageSize:5,sortBy:"createdAt",sortDirection:"descend"}):Promise.resolve(void 0),u=ve?ne({orgUid:t,pageNumber:0,pageSize:5,sortBy:"createdAt",sortDirection:"descend"}):Promise.resolve(void 0),c=pe?(0,ie.Wq)({orgUid:t,pageNumber:0,pageSize:100,day:wt}):Promise.resolve(void 0),e.next=14,Promise.all([r,a,s,n,o,u,c]);case 14:if(l=e.sent,d=i()(l,7),h=d[0],p=d[1],v=d[2],m=d[3],g=d[4],y=d[5],k=d[6],f.Z.debug("[Dashboard.refresh] responses",{orgUid:t,startDate:Zt,endDate:wt,permission:{canReadServiceStatistic:G,canReadTicketStatistic:re,canReadAiStatistic:de,canReadCallStatistic:he,canReadQueue:pe,canReadArticles:fe,canReadNotices:ve},serviceRes:h,ticketRes:p,aiRes:v,cdrRes:m,articleRes:g,noticeRes:y,queueRes:k}),!G){e.next=35;break}if(200!==(null==h?void 0:h.code)||!h.data){e.next=29;break}Ze(h.data),e.next=33;break;case 29:return e.next=31,(0,W.Eb)();case 31:200===(null==(w=e.sent)?void 0:w.code)&&Ze(w.data);case 33:e.next=36;break;case 35:Ze(void 0);case 36:re&&200===(null==p?void 0:p.code)?Ce(p.data):Ce(void 0),de&&200===(null==v?void 0:v.code)?Ie(v.data):Ie(void 0),j&&he&&m&&"number"==typeof m.code&&200===m.code?(Oe((null===(T=(C=m).data)||void 0===T?void 0:T.content)||[]),Je((null===(S=C.data)||void 0===S?void 0:S.totalElements)||0)):(Oe([]),Je(0)),fe&&200===(null==g?void 0:g.code)?(He((null===(M=g.data)||void 0===M?void 0:M.content)||[]),Ge((null===(P=g.data)||void 0===P?void 0:P.totalElements)||0)):(He([]),Ge(0)),ve&&200===(null==y?void 0:y.code)?(Ve((null===(R=y.data)||void 0===R?void 0:R.content)||[]),tt((null===(I=y.data)||void 0===I?void 0:I.totalElements)||0)):(Ve([]),tt(0)),pe&&200===(null==k?void 0:k.code)?(q=(null===(D=k.data)||void 0===D?void 0:D.content)||[],A=Array.from({length:24},(function(){return 0})),q.forEach((function(e){(e.threadsCountByHour||[]).forEach((function(e,t){t>=0&&t<24&&(A[t]+=e||0)}))})),at(A.map((function(e,t){return{hour:"".concat(t,":00"),count:e}})))):at([]),e.next=52;break;case 44:e.prev=44,e.t0=e.catch(3),z=e.t0,f.Z.debug("[Dashboard.refresh] error",{message:null==z?void 0:z.message,name:null==z?void 0:z.name,code:null==z?void 0:z.code,status:null==z||null===(O=z.response)||void 0===O?void 0:O.status,data:null==z||null===(E=z.response)||void 0===E?void 0:E.data,url:null==z||null===(L=z.config)||void 0===L?void 0:L.url,method:null==z||null===(F=z.config)||void 0===F?void 0:F.method,params:null==z||null===(J=z.config)||void 0===J?void 0:J.params}),H=null==z||null===(X=z.response)||void 0===X||null===(X=X.data)||void 0===X?void 0:X.message,Y=null==z||null===(N=z.response)||void 0===N||null===(N=N.data)||void 0===N?void 0:N.code,B="string"==typeof H&&H.trim()?"number"==typeof Y?"".concat(H," (code=").concat(Y,")"):H:e.t0 instanceof Error?e.t0.message:b("dashboard.load.failed","加载仪表盘数据失败"),K.yw.error(B);case 52:return e.prev=52,jt(!1),e.finish(52);case 55:case"end":return e.stop()}}),e,null,[[3,44,52,55]])}))),[null==Z?void 0:Z.uid,Zt,wt,b,j,G,re,de,he,pe,fe,ve]);(0,o.useEffect)((function(){if(null!=Z&&Z.uid){var e="dashboard_visibility_".concat(Z.uid);try{var t=localStorage.getItem(e);if(t){var n=JSON.parse(t);lt(y()(y()({},st),n))}else lt(st)}catch(e){lt(st)}}}),[null==Z?void 0:Z.uid]),(0,o.useEffect)((function(){if(null!=Z&&Z.uid){var e="dashboard_visibility_".concat(Z.uid);try{localStorage.setItem(e,JSON.stringify(ct))}catch(e){}}}),[ct,null==Z?void 0:Z.uid]),(0,o.useEffect)((function(){Tt()}),[Tt]);var St=(0,o.useMemo)((function(){var e=Se,t=(null==e?void 0:e.totalTickets)||0;return[{type:b("ticket.status.new","新建"),value:(null==e?void 0:e.newTickets)||0},{type:b("ticket.status.processing","处理中"),value:(null==e?void 0:e.processingTickets)||0},{type:b("ticket.status.resolved","已解决"),value:(null==e?void 0:e.resolvedTickets)||0},{type:b("ticket.status.closed","已结束"),value:(null==e?void 0:e.closedTickets)||0},{type:b("ticket.status.holding","挂起中"),value:(null==e?void 0:e.holdingTickets)||0},{type:b("ticket.status.pending","待处理"),value:(null==e?void 0:e.pendingTickets)||0}].filter((function(e){return e.value>0||0===t}))}),[Se,b]),Ct=(0,o.useMemo)((function(){var e=(null==Re?void 0:Re.hourlyData)||[],t=new Map;return e.forEach((function(e){"number"==typeof e.hour&&t.set(e.hour,e)})),Array.from({length:24},(function(e,n){var r,i;return{hour:"".concat(n,":00"),tokens:(null===(r=t.get(n))||void 0===r?void 0:r.totalTokens)||0,requests:(null===(i=t.get(n))||void 0===i?void 0:i.totalRequests)||0}}))}),[Re]),Mt=(0,o.useMemo)((function(){var e=je||{},t=[{type:b("thread.process.status.queuing","排队中"),value:e.queuingThreadCount||0},{type:b("queue.member.status.serving","正在服务"),value:e.currentThreadCount||0},{type:b("service.thread.status.accepted","已接入"),value:e.acceptedThreadCount||0},{type:b("queue.member.status.abandoned","已放弃"),value:e.abandonedThreadCount||0},{type:b("leave.msg.status.transferred","已转接"),value:e.transferredThreadCount||0},{type:b("service.thread.status.invited","邀请接入"),value:e.invitedThreadCount||0}],n=t.reduce((function(e,t){return e+(t.value||0)}),0);return t.filter((function(e){return e.value>0||0===n}))}),[je,b]),Pt=(0,o.useMemo)((function(){var e=je||{};return[{bucket:b("service.statistic.duration.within5min","5分钟内结束"),value:e.durationWithin5Min||0},{bucket:b("service.statistic.duration.within15min","5-15分钟结束"),value:e.durationWithin15Min||0},{bucket:b("service.statistic.duration.over15min","超过15分钟"),value:e.durationOver15Min||0}]}),[je,b]),Rt=[{title:b("dashboard.calls.table.caller","主叫"),dataIndex:"callerIdNumber",key:"callerIdNumber",width:140},{title:b("dashboard.calls.table.callee","被叫"),dataIndex:"destinationNumber",key:"destinationNumber",width:140},{title:b("dashboard.calls.table.startedAt","开始时间"),dataIndex:"startStamp",key:"startStamp",render:function(e){return _()(e).format("MM-DD HH:mm")}},{title:b("dashboard.calls.table.duration","时长"),dataIndex:"billsec",key:"billsec",render:function(e){return ce(e)}},{title:b("dashboard.calls.table.hangupCause","挂断原因"),dataIndex:"hangupCause",key:"hangupCause",ellipsis:!0}],It=[{title:b("dashboard.kbase.table.title","标题"),dataIndex:"title",key:"title",render:function(e){return(0,d.jsx)(w.Z,{title:e,children:(0,d.jsx)(ue,{ellipsis:!0,style:{maxWidth:220,display:"inline-block"},children:e})})}},{title:b("dashboard.kbase.table.readCount","阅读"),dataIndex:"readCount",key:"readCount",width:100},{title:b("dashboard.kbase.table.createdAt","发布时间"),dataIndex:"createdAt",key:"createdAt",width:160,render:function(e){return _()(e).format("MM-DD HH:mm")}},{title:b("dashboard.kbase.table.status","状态"),key:"published",width:100,render:function(e,t){return t.published?(0,d.jsx)(T.Z,{color:"green",children:b("dashboard.kbase.status.published","已发布")}):(0,d.jsx)(T.Z,{children:b("dashboard.kbase.status.draft","草稿")})}}],Dt=[{title:b("dashboard.notice.table.title","标题"),dataIndex:"title",key:"title",render:function(e){return(0,d.jsx)(w.Z,{title:e,children:(0,d.jsx)(ue,{ellipsis:!0,style:{maxWidth:320,display:"inline-block"},children:e||"-"})})}},{title:b("dashboard.notice.table.type","类型"),dataIndex:"type",key:"type",width:120,render:function(e){return e?(0,d.jsx)(T.Z,{color:"blue",children:e}):"-"}},{title:b("dashboard.notice.table.status","状态"),dataIndex:"status",key:"status",width:120,render:function(e){var t="published"===e?b("dashboard.notice.status.published","Published"):"draft"===e?b("dashboard.notice.status.draft","Draft"):e||"-";return e?(0,d.jsx)(T.Z,{color:"published"===e?"green":"draft"===e?"default":"gold",children:t}):"-"}},{title:b("dashboard.notice.table.createdAt","发布时间"),dataIndex:"createdAt",key:"createdAt",width:160,render:function(e){return e?_()(e).format("MM-DD HH:mm"):"-"}}],qt=[{title:b("service.statistic.table.agent","客服名称"),dataIndex:"name",key:"name"},{title:b("service.statistic.table.onlineTime","在线时长"),dataIndex:"onlineTime",key:"onlineTime",render:function(e){return void 0!==e?"".concat(e,"h"):"-"}},{title:b("service.statistic.table.sessionCount","接待会话数"),dataIndex:"sessionCount",key:"sessionCount"},{title:b("service.statistic.table.avgResponseTime","平均响应时间"),dataIndex:"avgResponseTime",key:"avgResponseTime",render:function(e){return void 0!==e?"".concat(e).concat(b("service.statistic.unit.minute","分钟")):"-"}},{title:b("service.statistic.table.avgSessionTime","平均会话时长"),dataIndex:"avgSessionTime",key:"avgSessionTime",render:function(e){return void 0!==e?"".concat(e).concat(b("service.statistic.unit.minute","分钟")):"-"}},{title:b("service.statistic.table.satisfaction","满意度评分"),dataIndex:"satisfaction",key:"satisfaction",render:function(e){return void 0!==e?"".concat(e,"%"):"-"}},{title:b("service.statistic.table.workingHours","工作时长"),dataIndex:"workingHours",key:"workingHours",render:function(e){return void 0!==e?"".concat(e,"h"):"-"}},{title:b("service.statistic.table.transferRate","转接率"),dataIndex:"transferRate",key:"transferRate",render:function(e){return void 0!==e?"".concat(e,"%"):"-"}},{title:b("service.statistic.table.firstResolutionRate","首次解决率"),dataIndex:"firstResolutionRate",key:"firstResolutionRate",render:function(e){return void 0!==e?"".concat(e,"%"):"-"}},{title:b("service.statistic.table.overdueCount","超时会话数"),dataIndex:"overdueCount",key:"overdueCount"}],At=(0,o.useMemo)((function(){if(!je)return[];var e=je,t=Number(e.acceptedThreadCount||0),n=Number(e.transferredThreadCount||0),r=Number(e.onlineTime||0),i=Number(e.avgFirstResponseTime||0),a=Number(e.avgConversationTime||0),s=r>0?Math.round(r/3600*10)/10:0,o=i>0?Math.round(i/60):0,u=a>0?Math.round(a/60):0,c=le(e.satisfactionRate),l=t>0?le(n/t*100):0,d=void 0!==e.firstResolutionRate?le(e.firstResolutionRate):void 0,h=void 0!==e.overdueThreadCount?Number(e.overdueThreadCount):void 0;return[{key:"org-summary",name:(null==Z?void 0:Z.name)||"组织汇总",onlineTime:s,sessionCount:t,avgResponseTime:o,avgSessionTime:u,satisfaction:c,workingHours:s,transferRate:l,firstResolutionRate:d,overdueCount:h}]}),[je,null==Z?void 0:Z.name]);return(0,d.jsxs)(S.Z,{direction:"vertical",size:16,style:{width:"100%"},children:[!gt&&(0,d.jsx)(C.Z,{variant:"borderless",styles:{body:{padding:16}},children:(0,d.jsxs)(M.Z,{justify:"space-between",align:"middle",gutter:[16,16],children:[(0,d.jsxs)(P.Z,{flex:"auto",children:[(0,d.jsx)(oe,{level:4,style:{margin:0},children:b("dashboard.title","运营概览")}),(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.subtitle","在线客服、工单系统、呼叫中心、知识库、AI助手 一体化总览")})]}),(0,d.jsx)(P.Z,{children:(0,d.jsxs)(S.Z,{children:[(0,d.jsx)(se,{allowClear:!1,value:ge,onChange:function(e){return e&&be([e[0].startOf("day"),e[1].endOf("day")])},presets:[{label:b("queue.statistic.today","今日"),value:[_()().startOf("day"),_()().endOf("day")]},{label:b("queue.statistic.yesterday","昨日"),value:[_()().subtract(1,"day").startOf("day"),_()().subtract(1,"day").endOf("day")]},{label:b("queue.statistic.week","近7天"),value:[_()().startOf("day").subtract(6,"day"),_()().endOf("day")]},{label:b("queue.statistic.month","近30天"),value:[_()().startOf("day").subtract(29,"day"),_()().endOf("day")]}]}),(0,d.jsx)(l.ZP,{icon:(0,d.jsx)(E.Z,{}),onClick:Tt,children:b("pages.refresh","刷新")}),(0,d.jsx)(R.Z,{trigger:["click"],open:pt,onOpenChange:ft,title:(0,d.jsx)("b",{children:b("dashboard.settings.title","显示设置")}),content:(0,d.jsxs)(S.Z,{direction:"vertical",size:8,children:[(G||re)&&(0,d.jsx)(I.Z,{checked:ct.kpis,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{kpis:e.target.checked})}))},children:b("dashboard.settings.kpis","KPI 指标")}),(0,d.jsx)(D.Z,{style:{margin:"4px 0"}}),re&&(0,d.jsx)(I.Z,{checked:ct.ticketStatusPie,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{ticketStatusPie:e.target.checked})}))},children:b("dashboard.settings.ticketStatusPie","工单状态分布")}),de&&(0,d.jsx)(I.Z,{checked:ct.aiTokenLine,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{aiTokenLine:e.target.checked})}))},children:b("dashboard.settings.aiTokenLine","AI Token 今日使用趋势")}),(0,d.jsx)(D.Z,{style:{margin:"4px 0"}}),G&&(0,d.jsx)(I.Z,{checked:ct.serviceStatusPie,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{serviceStatusPie:e.target.checked})}))},children:b("dashboard.settings.serviceStatusPie","会话状态分布")}),G&&(0,d.jsx)(I.Z,{checked:ct.serviceDurationLine,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{serviceDurationLine:e.target.checked})}))},children:b("dashboard.settings.serviceDurationLine","会话时长分布")}),pe&&(0,d.jsx)(I.Z,{checked:ct.serviceHourlyLine,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{serviceHourlyLine:e.target.checked})}))},children:b("dashboard.settings.serviceHourlyLine","会话请求时间点")}),(0,d.jsx)(D.Z,{style:{margin:"4px 0"}}),j&&he&&(0,d.jsx)(I.Z,{checked:ct.recentCalls,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{recentCalls:e.target.checked})}))},children:b("dashboard.settings.recentCalls","最近呼叫")}),fe&&(0,d.jsx)(I.Z,{checked:ct.articles,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{articles:e.target.checked})}))},children:b("dashboard.settings.articles","最近知识库文章")}),ve&&(0,d.jsx)(I.Z,{checked:ct.notices,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{notices:e.target.checked})}))},children:b("dashboard.settings.notices","平台动态")}),(0,d.jsx)(D.Z,{style:{margin:"4px 0"}}),G&&(0,d.jsx)(I.Z,{checked:ct.agentPerformance,onChange:function(e){return lt((function(t){return y()(y()({},t),{},{agentPerformance:e.target.checked})}))},children:b("dashboard.settings.agentPerformance","客服绩效统计")}),(0,d.jsxs)(S.Z,{size:8,children:[(0,d.jsx)(l.ZP,{size:"small",onClick:function(){return lt(st)},children:b("dashboard.settings.reset","恢复默认")}),(0,d.jsx)(l.ZP,{size:"small",type:"primary",onClick:function(){return ft(!1)},children:b("dashboard.settings.done","完成")})]})]}),children:(0,d.jsx)(l.ZP,{children:b("dashboard.settings.title","显示设置")})})]})})]})}),!xt&&(0,d.jsx)(C.Z,{variant:"borderless",styles:{body:{padding:24}},children:(0,d.jsx)(p.Z,{description:(0,d.jsxs)(S.Z,{direction:"vertical",size:4,children:[(0,d.jsx)(ue,{children:b("dashboard.empty.noCards","暂无可展示的仪表盘模块")}),(0,d.jsx)(ue,{type:"secondary",children:gt?b("dashboard.empty.noPermission","当前账号暂无任何可访问的模块权限，请联系管理员授权后再查看。"):b("dashboard.empty.noCards.hint","可能原因：已在“显示设置”中关闭了所有模块。")})]})})}),vt.kpis&&(0,d.jsxs)(M.Z,{gutter:[16,16],children:[G&&(0,d.jsx)(P.Z,{xs:24,sm:12,md:8,lg:6,xl:4,children:(0,d.jsx)(C.Z,{loading:kt,children:(0,d.jsx)(q.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.kpi.onlineAgents.tooltip","当前在线客服数量 / 总客服数"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/agent")},children:[(0,d.jsx)(L.Z,{})," ",b("dashboard.kpi.onlineAgents","在线客服")]})}),value:null!==(e=null==je?void 0:je.onlineAgentCount)&&void 0!==e?e:0,suffix:"/ ".concat(Math.max(0,(null!==(t=null==je?void 0:je.onlineAgentCount)&&void 0!==t?t:0)+(null!==(n=null==je?void 0:je.offlineAgentCount)&&void 0!==n?n:0)))})})}),G&&(0,d.jsx)(P.Z,{xs:24,sm:12,md:8,lg:6,xl:4,children:(0,d.jsx)(C.Z,{loading:kt,children:(0,d.jsx)(q.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.kpi.queuingThreads.tooltip","当前排队中的会话数量"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(F.Z,{})," ",b("dashboard.kpi.queuingThreads","排队会话")]})}),value:null!==(r=null==je?void 0:je.queuingThreadCount)&&void 0!==r?r:0})})}),G&&(0,d.jsx)(P.Z,{xs:24,sm:12,md:8,lg:6,xl:4,children:(0,d.jsx)(C.Z,{loading:kt,children:(0,d.jsx)(q.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.kpi.acceptRate.tooltip","选定时间内已接入会话占比"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(J.Z,{})," ",b("service.statistic.acceptRate","接通率")]})}),value:le(null==je?void 0:je.acceptRate),suffix:"%"})})}),G&&(0,d.jsx)(P.Z,{xs:24,sm:12,md:8,lg:6,xl:4,children:(0,d.jsx)(C.Z,{loading:kt,children:(0,d.jsx)(q.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.kpi.avgFirstResponse.tooltip","从用户发起到客服首次回复的平均时长"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(J.Z,{})," ",b("dashboard.kpi.avgFirstResponse","平均首响")]})}),value:ce(null==je?void 0:je.avgFirstResponseTime)})})}),re&&(0,d.jsx)(P.Z,{xs:24,sm:12,md:8,lg:6,xl:4,children:(0,d.jsx)(C.Z,{loading:kt,children:(0,d.jsx)(q.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.kpi.ticketTotal.tooltip","选定时间内创建的工单总量"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/ticket-service/overview")},children:[(0,d.jsx)(X.Z,{})," ",b("dashboard.kpi.ticketTotal","工单总数")]})}),value:null!==(u=null==Se?void 0:Se.totalTickets)&&void 0!==u?u:0})})}),(re||G)&&(0,d.jsx)(P.Z,{xs:24,sm:12,md:8,lg:6,xl:4,children:(0,d.jsx)(C.Z,{loading:kt,children:(0,d.jsx)(q.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.kpi.satisfaction.tooltip","客户评价的满意度比例"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/ticket-service/rating")},children:[(0,d.jsx)(N.Z,{})," ",b("dashboard.kpi.satisfaction","满意度")]})}),value:le(null!==(c=null==Se?void 0:Se.customerSatisfactionRate)&&void 0!==c?c:null==je?void 0:je.satisfactionRate),suffix:"%"})})})]}),(vt.serviceStatusPie||vt.serviceDurationLine)&&(0,d.jsx)(M.Z,{gutter:[16,16],children:vt.serviceStatusPie&&vt.serviceDurationLine?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P.Z,{xs:24,lg:10,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.service.statusDistribution.tooltip","在线客服会话的状态分布"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(L.Z,{})," ",b("dashboard.service.statusDistribution","会话状态分布")]})}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(B.Z,{data:Mt,angleField:"value",colorField:"type",radius:.9,legend:{position:"bottom"},height:300})})}),(0,d.jsx)(P.Z,{xs:24,lg:14,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.service.sessionDuration.tooltip","会话时长区间内的会话数量"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(J.Z,{})," ",b("service.statistic.sessionDuration","会话时长分布")]})}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.unit.sessionCount","单位：会话数")}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(U.Z,{data:Pt,xField:"bucket",yField:"value",smooth:!0,height:300,tooltip:{showMarkers:!1},xAxis:{label:{autoRotate:!1}}})})})]}):vt.serviceStatusPie?(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.service.statusDistribution.tooltip","在线客服会话的状态分布"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(L.Z,{})," ",b("dashboard.service.statusDistribution","会话状态分布")]})}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(B.Z,{data:Mt,angleField:"value",colorField:"type",radius:.9,legend:{position:"bottom"},height:300})})}):(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.service.sessionDuration.tooltip","会话时长区间内的会话数量"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(J.Z,{})," ",b("service.statistic.sessionDuration","会话时长分布")]})}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.unit.sessionCount","单位：会话数")}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(U.Z,{data:Pt,xField:"bucket",yField:"value",smooth:!0,height:300,tooltip:{showMarkers:!1},xAxis:{label:{autoRotate:!1}}})})})}),vt.serviceHourlyLine&&(0,d.jsx)(M.Z,{gutter:[16,16],children:(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.service.hourlyRequests.tooltip","每小时发起会话请求的人次"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/thread")},children:[(0,d.jsx)(F.Z,{})," ",b("dashboard.service.hourlyRequests","在线客服会话请求时间点")]})}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.unit.peoplePerHour","单位：人次/小时")}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(U.Z,{data:it,xField:"hour",yField:"count",smooth:!0,height:300,tooltip:{showMarkers:!1},xAxis:{tickCount:12}})})})}),vt.agentPerformance&&(0,d.jsx)(M.Z,{gutter:[16,16],children:(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.agentPerformance.tooltip","客服维度关键绩效指标汇总"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/online-service/agent")},children:[(0,d.jsx)(L.Z,{})," ",b("dashboard.agentPerformance.title","客服绩效统计")]})}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.agentPerformance.extra","按客服汇总")}),loading:kt,children:(0,d.jsx)(O.Z,{rowKey:function(e){return e.key||"".concat(e.name)},size:"small",columns:qt,dataSource:At,scroll:{x:!0},pagination:{pageSize:10},locale:{emptyText:b("noData","暂无数据")}})})})}),(vt.ticketStatusPie||vt.aiTokenLine)&&(0,d.jsx)(M.Z,{gutter:[16,16],children:vt.ticketStatusPie&&vt.aiTokenLine?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P.Z,{xs:24,lg:10,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.ticket.statusDistribution.tooltip","选定时间内各状态工单数量占比"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/ticket-service/overview")},children:[(0,d.jsx)(X.Z,{})," ",b("dashboard.ticket.statusDistribution","工单状态分布")]})}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(B.Z,{data:St,angleField:"value",colorField:"type",radius:.9,legend:{position:"bottom"},height:300})})}),(0,d.jsx)(P.Z,{xs:24,lg:14,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.ai.tokenTodayTrend.tooltip","今日各小时 Token 消耗趋势"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/robot-service/token")},children:[(0,d.jsx)(z.Z,{})," ",b("dashboard.ai.tokenTodayTrend","AI Token 今日使用趋势")]})}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.unit.token","单位：Token")}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(U.Z,{data:Ct,xField:"hour",yField:"tokens",smooth:!0,height:300,tooltip:{showMarkers:!1},xAxis:{tickCount:12}})})})]}):vt.ticketStatusPie?(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.ticket.statusDistribution.tooltip","选定时间内各状态工单数量占比"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/ticket-service/overview")},children:[(0,d.jsx)(X.Z,{})," ",b("dashboard.ticket.statusDistribution","工单状态分布")]})}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(B.Z,{data:St,angleField:"value",colorField:"type",radius:.9,legend:{position:"bottom"},height:300})})}):(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.ai.tokenTodayTrend.tooltip","今日各小时 Token 消耗趋势"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/robot-service/token")},children:[(0,d.jsx)(z.Z,{})," ",b("dashboard.ai.tokenTodayTrend","AI Token 今日使用趋势")]})}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.unit.token","单位：Token")}),loading:kt,children:kt?(0,d.jsx)(A.Z,{active:!0,paragraph:{rows:6}}):(0,d.jsx)(U.Z,{data:Ct,xField:"hour",yField:"tokens",smooth:!0,height:300,tooltip:{showMarkers:!1},xAxis:{tickCount:12}})})})}),j&&vt.recentCalls&&(0,d.jsx)(M.Z,{gutter:[16,16],children:(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)(w.Z,{title:b("dashboard.calls.tooltip","FreeSWITCH 最近呼入/呼出记录（仅调试）"),children:(0,d.jsxs)("span",{style:{cursor:"pointer"},onClick:function(){return h("/bi/callcenter-service/summary")},children:[(0,d.jsx)(H.Z,{})," ",b("dashboard.calls.title","最近呼叫")]})}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.calls.total","共 {total} 通",{total:Fe})}),children:(0,d.jsx)(O.Z,{rowKey:function(e){return e.uid},size:"small",loading:kt,columns:Rt,dataSource:Ae,pagination:!1})})})}),(vt.articles||vt.notices)&&(0,d.jsx)(M.Z,{gutter:[16,16],children:vt.articles&&vt.notices?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P.Z,{xs:24,lg:12,children:(0,d.jsx)(C.Z,{title:(0,d.jsxs)("span",{children:[(0,d.jsx)(Y.Z,{})," ",b("dashboard.kbase.title","最近知识库文章")]}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.kbase.total","共 {total} 篇",{total:Ue})}),children:(0,d.jsx)(O.Z,{rowKey:function(e){return e.uid},size:"small",loading:kt,columns:It,dataSource:ze,pagination:!1})})}),(0,d.jsx)(P.Z,{xs:24,lg:12,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)("span",{children:b("dashboard.notice.title","平台动态")}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.notice.total","共 {total} 条",{total:et})}),children:(0,d.jsx)(O.Z,{rowKey:function(e){return e.uid},size:"small",loading:kt,columns:Dt,dataSource:We,pagination:!1})})})]}):vt.articles?(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsxs)("span",{children:[(0,d.jsx)(Y.Z,{})," ",b("dashboard.kbase.title","最近知识库文章")]}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.kbase.total","共 {total} 篇",{total:Ue})}),children:(0,d.jsx)(O.Z,{rowKey:function(e){return e.uid},size:"small",loading:kt,columns:It,dataSource:ze,pagination:!1})})}):(0,d.jsx)(P.Z,{xs:24,children:(0,d.jsx)(C.Z,{title:(0,d.jsx)("span",{children:b("dashboard.notice.title","平台动态")}),extra:(0,d.jsx)(ue,{type:"secondary",children:b("dashboard.notice.total","共 {total} 条",{total:et})}),children:(0,d.jsx)(O.Z,{rowKey:function(e){return e.uid},size:"small",loading:kt,columns:Dt,dataSource:We,pagination:!1})})})})]})},he=n(21850),pe=function(){var e=(0,he.Z)().contentStyle,t=((0,s.useModel)("@@initialState").initialState||{}).userInfo,n=(0,a.u)((function(e){return e.setCurrentOrg})),r=(0,s.useIntl)(),c=(0,s.useAccess)();c.canDebug&&f.Z.log("Developing canDebug");var l=(0,o.useState)(!1),v=i()(l,2),x=v[0],m=v[1],g=(0,o.useState)(!1),b=i()(g,2),y=b[0],k=b[1];return(0,o.useEffect)((function(){!function(){if(t){if(!t.currentOrganization)return f.Z.log("before initOrganization",t),void m(!0);f.Z.log("after initOrganization"),n(t.currentOrganization)}}(),"true"!==localStorage.getItem("skipVerification")&&(!t||t.emailVerified||t.mobileVerified||k(!0))}),[t]),(0,d.jsxs)("div",{style:e,children:[(0,d.jsx)(s.Access,{accessible:c.isEnterpriseOrPlatformEdition(),fallback:(0,d.jsx)("div",{style:{marginTop:100,textAlign:"center"},children:(0,d.jsx)(p.Z,{description:r.formatMessage({id:"welcome.empty.enterprisePlatformOnly",defaultMessage:"企业版&&平台版在此显示统计数据等"})})}),children:(0,d.jsx)(de,{})}),(0,d.jsx)(u.Z,{open:x,onClose:function(){return m(!1)},onSuccess:function(e){n(e),window.location.reload()}}),(0,d.jsx)(h,{open:y,onClose:function(){return k(!1)}})]})}}}]);