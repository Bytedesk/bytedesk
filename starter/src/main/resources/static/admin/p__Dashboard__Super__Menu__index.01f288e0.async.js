"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4461],{83381:function(e,n,t){t.d(n,{Z:function(){return l}});var a=t(38404),r=t(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},s=t(5901),i=function(e,n){return r.createElement(s.Z,(0,a.Z)({},e,{ref:n,icon:o}))};var l=r.forwardRef(i)},17455:function(e,n,t){var a=t(80627),r=t(93683),o=t(68422),s=t(44194),i=t(84729),l=t(69983),d=t(31549),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],f=function(e,n){var t=e.fieldProps,c=e.children,f=e.params,p=e.proFieldProps,g=e.mode,m=e.valueEnum,h=e.request,v=e.showSearch,M=e.options,x=(0,r.Z)(e,u),y=(0,s.useContext)(i.Z);return(0,d.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,o.h)(m),request:h,params:f,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:M,mode:g,showSearch:v,getPopupContainer:y.getPopupContainer},t),ref:n,proFieldProps:p},x),{},{children:c}))},p=s.forwardRef((function(e,n){var t=e.fieldProps,u=e.children,f=e.params,p=e.proFieldProps,g=e.mode,m=e.valueEnum,h=e.request,v=e.options,M=(0,r.Z)(e,c),x=(0,a.Z)({options:v,mode:g||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},t),y=(0,s.useContext)(i.Z);return(0,d.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,o.h)(m),request:h,params:f,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:y.getPopupContainer},x),ref:n,proFieldProps:p},M),{},{children:u}))})),g=s.forwardRef(f);g.SearchSelect=p,g.displayName="ProFormComponent",n.Z=g},74056:function(e,n,t){var a=t(80627),r=t(93683),o=t(44194),s=t(69983),i=t(31549),l=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],d=o.forwardRef((function(e,n){var t=e.fieldProps,o=e.unCheckedChildren,d=e.checkedChildren,u=e.proFieldProps,c=(0,r.Z)(e,l);return(0,i.jsx)(s.Z,(0,a.Z)({valueType:"switch",fieldProps:(0,a.Z)({unCheckedChildren:o,checkedChildren:d},t),ref:n,valuePropName:"checked",proFieldProps:u,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},c))}));n.Z=d},67186:function(e,n,t){var a=t(29552),r=t(80627),o=t(93683),s=t(92032),i=t(69159),l=t(43928),d=t(21762),u=t(44194),c=t(69983),f=t(31549),p=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],m="text",h=function(e){var n=(0,s.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),t=(0,a.Z)(n,2),o=t[0],d=t[1];return(0,f.jsx)(i.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(n){var t,a=n.getFieldValue(e.name||[]);return(0,f.jsx)(l.Z,(0,r.Z)((0,r.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return d(e)},content:(0,f.jsxs)("div",{style:{padding:"4px 0"},children:[null===(t=e.statusRender)||void 0===t?void 0:t.call(e,a),e.strengthText?(0,f.jsx)("div",{style:{marginTop:10},children:(0,f.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:o,children:e.children}))}})},v=function(e){var n=e.fieldProps,t=e.proFieldProps,a=(0,o.Z)(e,p);return(0,f.jsx)(c.Z,(0,r.Z)({valueType:m,fieldProps:n,filedConfig:{valueType:m},proFieldProps:t},a))};v.Password=function(e){var n=e.fieldProps,t=e.proFieldProps,s=(0,o.Z)(e,g),i=(0,u.useState)(!1),l=(0,a.Z)(i,2),p=l[0],v=l[1];return null!=n&&n.statusRender&&s.name?(0,f.jsx)(h,{name:s.name,statusRender:null==n?void 0:n.statusRender,popoverProps:null==n?void 0:n.popoverProps,strengthText:null==n?void 0:n.strengthText,open:p,onOpenChange:v,children:(0,f.jsx)("div",{children:(0,f.jsx)(c.Z,(0,r.Z)({valueType:"password",fieldProps:(0,r.Z)((0,r.Z)({},(0,d.Z)(n,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var t;null==n||null===(t=n.onBlur)||void 0===t||t.call(n,e),v(!1)},onClick:function(e){var t;null==n||null===(t=n.onClick)||void 0===t||t.call(n,e),v(!0)}}),proFieldProps:t,filedConfig:{valueType:m}},s))})}):(0,f.jsx)(c.Z,(0,r.Z)({valueType:"password",fieldProps:n,proFieldProps:t,filedConfig:{valueType:m}},s))},v.displayName="ProFormComponent",n.Z=v},83788:function(e,n,t){var a=t(80627),r=t(93683),o=t(44194),s=t(69983),i=t(31549),l=["fieldProps","proFieldProps"],d=function(e,n){var t=e.fieldProps,o=e.proFieldProps,d=(0,r.Z)(e,l);return(0,i.jsx)(s.Z,(0,a.Z)({ref:n,valueType:"textarea",fieldProps:t,proFieldProps:o},d))};n.Z=o.forwardRef(d)},90938:function(e,n,t){var a=t(96775);n.Z=function(){var e=(0,a.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},93663:function(e,n,t){t.r(n),t.d(n,{default:function(){return G}});var a=t(90938),r=t(73193),o=t.n(r),s=t(90819),i=t.n(s),l=t(89933),d=t.n(l),u=t(45332),c=t.n(u),f=t(50884),p=t(27353),g=t(2290);function m(e){return h.apply(this,arguments)}function h(){return(h=d()(i()().mark((function e(n){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,g.request)("/api/v1/menu/query/org",{method:"GET",params:o()({},n)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return M.apply(this,arguments)}function M(){return(M=d()(i()().mark((function e(n){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,g.request)("/api/v1/menu/create",{method:"POST",data:o()(o()({},n),{},{channel:p.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return y.apply(this,arguments)}function y(){return(y=d()(i()().mark((function e(n){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,g.request)("/api/v1/menu/update",{method:"POST",data:o()(o()({},n),{},{channel:p.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return k.apply(this,arguments)}function k(){return(k=d()(i()().mark((function e(n){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,g.request)("/api/v1/menu/delete",{method:"POST",data:o()(o()({},n),{},{channel:p.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=t(28520),P=t(83381),Z=t(6992),C=t(77601),S=t(38623),j=t(48518),T=t(64724),O=t(50693),F=t(70937),N=t(90883),I=t(44194),E=t(84176),W=t.n(E),q=t(97588),A=t(67186),B=t(83788),R=t(17455),L=t(74056),K=t(19058),U=t(46206),D=t(31549),z=["iconPreset"],V={type:"DESKTOP",color:"blue",order:0,enabled:!0,openInNewWindow:!0},J=function(e){var n=e.open,t=e.isEdit,a=e.orgUid,r=e.menu,s=e.onClose,i=e.onSubmit,l=q.A.useForm(),d=c()(l,1)[0],u=(0,g.useIntl)(),f=(0,I.useMemo)((function(){return[{label:u.formatMessage({id:"menu.type.option.admin",defaultMessage:"Admin · Console"}),value:"ADMIN",disabled:!0},{label:u.formatMessage({id:"menu.type.option.desktop",defaultMessage:"Desktop · Workspace"}),value:"DESKTOP"},{label:u.formatMessage({id:"menu.type.option.workflow",defaultMessage:"Workflow · Automation"}),value:"WORKFLOW",disabled:!0},{label:u.formatMessage({id:"menu.type.option.notebase",defaultMessage:"NoteBase · Knowledge"}),value:"NOTEBASE",disabled:!0},{label:u.formatMessage({id:"menu.type.option.kanban",defaultMessage:"Kanban · Task Board"}),value:"KANBAN",disabled:!0}]}),[u]),p=(0,I.useMemo)((function(){return[{label:u.formatMessage({id:"menu.icon.option.message",defaultMessage:"Message · MessageOutlined"}),value:"MessageOutlined"},{label:u.formatMessage({id:"menu.icon.option.mail",defaultMessage:"Mail · MailOutlined"}),value:"MailOutlined"},{label:u.formatMessage({id:"menu.icon.option.settings",defaultMessage:"Settings · SettingOutlined"}),value:"SettingOutlined"},{label:u.formatMessage({id:"menu.icon.option.statistic",defaultMessage:"Statistic · LineChartOutlined"}),value:"LineChartOutlined"},{label:u.formatMessage({id:"menu.icon.option.support",defaultMessage:"Support · PhoneOutlined"}),value:"PhoneOutlined"},{label:u.formatMessage({id:"menu.icon.option.knowledge",defaultMessage:"Knowledge · BookOutlined"}),value:"BookOutlined"},{label:u.formatMessage({id:"menu.icon.option.link",defaultMessage:"External Link · LinkOutlined"}),value:"LinkOutlined"}]}),[u]);(0,I.useEffect)((function(){if(n)if(t&&r){var e,a,s=null===(e=p.find((function(e){return e.value===r.icon})))||void 0===e?void 0:e.value;d.setFieldsValue(o()(o()(o()({},V),r),{},{order:null!==(a=r.order)&&void 0!==a?a:0,iconPreset:s}))}else d.setFieldsValue(o()(o()({},V),{},{iconPreset:void 0}));else d.resetFields()}),[n,t,r,d,p]);return(0,D.jsx)(K.Z,{title:t?u.formatMessage({id:"menu.edit",defaultMessage:"编辑菜单"}):u.formatMessage({id:"menu.create",defaultMessage:"创建菜单"}),width:560,destroyOnHidden:!0,onClose:s,open:n,extra:(0,D.jsxs)(U.Z,{children:[(0,D.jsx)(N.ZP,{onClick:s,children:u.formatMessage({id:"cancel",defaultMessage:"取消"})}),(0,D.jsx)(N.ZP,{type:"primary",onClick:function(){return d.submit()},children:u.formatMessage({id:"save",defaultMessage:"保存"})})]}),children:(0,D.jsxs)(q.A,{form:d,layout:"vertical",submitter:!1,onFinish:function(){return d.validateFields().then((function(e){var n,t=e.iconPreset,s=W()(e,z),l=o()(o()({},s),{},{uid:null==r?void 0:r.uid,color:s.color||"blue",icon:s.icon||t||"LinkOutlined",orgUid:null!==(n=null==r?void 0:r.orgUid)&&void 0!==n?n:a});i(l)}))},children:[(0,D.jsx)(A.Z,{name:"name",label:u.formatMessage({id:"name",defaultMessage:"名称"}),rules:[{required:!0,message:u.formatMessage({id:"menu.name.required",defaultMessage:"请输入菜单名称"})}]}),(0,D.jsx)(B.Z,{name:"description",label:u.formatMessage({id:"description",defaultMessage:"描述"}),fieldProps:{rows:2}}),(0,D.jsx)(R.Z,{name:"type",label:u.formatMessage({id:"type",defaultMessage:"类型"}),options:f,rules:[{required:!0,message:u.formatMessage({id:"menu.type.required",defaultMessage:"请选择菜单类型"})}]}),(0,D.jsx)(A.Z,{name:"link",label:u.formatMessage({id:"link",defaultMessage:"链接"}),rules:[{required:!0,message:u.formatMessage({id:"menu.link.required",defaultMessage:"请输入链接地址"})}]}),(0,D.jsx)(L.Z,{name:"enabled",label:u.formatMessage({id:"enabled",defaultMessage:"启用"})}),(0,D.jsx)(L.Z,{name:"openInNewWindow",label:u.formatMessage({id:"menu.new.window",defaultMessage:"新窗口打开"})})]})})},X=t(97765),H=function(){var e=(0,g.useIntl)(),n=(0,I.useRef)(),t=(0,w.u)((function(e){return e.currentOrg})),a=(0,I.useState)(!1),r=c()(a,2),s=r[0],l=r[1],u=(0,I.useState)(!1),p=c()(u,2),h=p[0],M=p[1],y=(0,I.useState)(),k=c()(y,2),E=k[0],W=k[1],q=(0,I.useState)(null),A=c()(q,2),B=A[0],R=A[1],L=(0,I.useMemo)((function(){return{ADMIN:{text:e.formatMessage({id:"menu.type.option.admin",defaultMessage:"Admin · Console"})},DESKTOP:{text:e.formatMessage({id:"menu.type.option.desktop",defaultMessage:"Desktop · Workspace"})},WORKFLOW:{text:e.formatMessage({id:"menu.type.option.workflow",defaultMessage:"Workflow · Automation"})},NOTEBASE:{text:e.formatMessage({id:"menu.type.option.notebase",defaultMessage:"NoteBase · Knowledge"})},KANBAN:{text:e.formatMessage({id:"menu.type.option.kanban",defaultMessage:"Kanban · Task Board"})}}}),[e]),K=function(){null!=t&&t.uid?(M(!1),W(void 0),l(!0)):f.yw.warning(e.formatMessage({id:"menu.org.required",defaultMessage:"请先选择组织"}))},U=function(){var a=d()(i()().mark((function a(r){var o,s,l;return i()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b({uid:r.uid,orgUid:null!==(o=r.orgUid)&&void 0!==o?o:null==t?void 0:t.uid});case 2:s=a.sent,X.Z.debug("delete menu",s),200===s.code?(f.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"删除成功"})),null===(l=n.current)||void 0===l||l.reload()):f.yw.error(s.message||e.formatMessage({id:"delete.failed",defaultMessage:"删除失败"}));case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),z=function(){var t=d()(i()().mark((function t(a){var r,s,d;return i()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.orgUid){t.next=3;break}return f.yw.error(e.formatMessage({id:"menu.org.required",defaultMessage:"请先选择组织"})),t.abrupt("return");case 3:if(!h||null==E||!E.uid){t.next=9;break}return t.next=6,x(o()(o()(o()({},E),a),{},{uid:E.uid}));case 6:s=t.sent,t.next=12;break;case 9:return t.next=11,v(a);case 11:s=t.sent;case 12:X.Z.debug("persist menu",null===(r=s)||void 0===r?void 0:r.data,a),200===s.code?(f.yw.success(e.formatMessage({id:"save.success",defaultMessage:"保存成功"})),l(!1),null===(d=n.current)||void 0===d||d.reload()):f.yw.error(s.message||e.formatMessage({id:"save.failed",defaultMessage:"保存失败"}));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),V=function(){var a=d()(i()().mark((function a(r,o,s){var l,d,u,c;return i()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.uid){a.next=2;break}return a.abrupt("return");case 2:return R("".concat(r.uid,"-").concat(o)),d={uid:r.uid,name:r.name,description:r.description,type:r.type,color:r.color,icon:r.icon,link:r.link,order:r.order,enabled:"enabled"===o?s:r.enabled,openInNewWindow:"openInNewWindow"===o?s:r.openInNewWindow,orgUid:null!==(l=r.orgUid)&&void 0!==l?l:null==t?void 0:t.uid},a.prev=4,a.next=7,x(d);case 7:200===(u=a.sent).code?null===(c=n.current)||void 0===c||c.reload():f.yw.error(u.message||e.formatMessage({id:"save.failed",defaultMessage:"保存失败"})),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(4),f.yw.error(e.formatMessage({id:"menu.toggle.failed",defaultMessage:"更新开关失败"}));case 14:return a.prev=14,R(null),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[4,11,14,17]])})));return function(e,n,t){return a.apply(this,arguments)}}(),H=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:e.formatMessage({id:"name",defaultMessage:"名称"}),dataIndex:"name",key:"name",copyable:!0,ellipsis:!0},{title:e.formatMessage({id:"type",defaultMessage:"类型"}),dataIndex:"type",key:"type",valueType:"select",valueEnum:L,render:function(e,n){var t;return(0,D.jsx)(S.Z,{color:"blue",children:(null===(t=L[n.type])||void 0===t?void 0:t.text)||n.type})}},{title:e.formatMessage({id:"link",defaultMessage:"链接"}),dataIndex:"link",key:"link",copyable:!0,ellipsis:!0,render:function(e,n){return n.link?(0,D.jsx)(j.Z,{title:n.link,children:(0,D.jsx)(T.Z.Link,{href:n.link,target:"_blank",rel:"noreferrer",children:n.link})}):"-"}},{title:e.formatMessage({id:"enabled",defaultMessage:"启用"}),dataIndex:"enabled",key:"enabled",valueType:"select",valueEnum:{true:{text:e.formatMessage({id:"enabled",defaultMessage:"启用"})},false:{text:e.formatMessage({id:"disabled",defaultMessage:"禁用"})}},render:function(e,n){return(0,D.jsx)(O.Z,{checked:n.enabled,onChange:function(e){return V(n,"enabled",e)},loading:B==="".concat(n.uid,"-enabled")})}},{title:e.formatMessage({id:"menu.new.window",defaultMessage:"新窗口打开"}),dataIndex:"openInNewWindow",key:"openInNewWindow",hideInSearch:!0,render:function(e,n){return(0,D.jsx)(O.Z,{checked:n.openInNewWindow,onChange:function(e){return V(n,"openInNewWindow",e)},loading:B==="".concat(n.uid,"-openInNewWindow")})}},{title:e.formatMessage({id:"createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",key:"createdAt",sorter:!0,hideInSearch:!0,width:200},{title:e.formatMessage({id:"actions",defaultMessage:"操作"}),valueType:"option",key:"option",fixed:"right",width:160,render:function(n,t){return[(0,D.jsx)("a",{onClick:function(){return function(e){M(!0),W(e),l(!0)}(t)},children:e.formatMessage({id:"edit",defaultMessage:"编辑"})},"edit"),(0,D.jsx)(F.Z,{title:e.formatMessage({id:"deleteTip",defaultMessage:"确认删除?"}),onConfirm:function(){return U(t)},okText:e.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"cancel",defaultMessage:"取消"}),icon:(0,D.jsx)(P.Z,{style:{color:"red"}}),children:(0,D.jsx)(N.ZP,{type:"link",danger:!0,children:e.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")]}}];return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(C.Z,{rowKey:"uid",actionRef:n,columns:H,search:{labelWidth:"auto"},pagination:{defaultPageSize:10,showSizeChanger:!0},scroll:{x:1200},request:function(){var n=d()(i()().mark((function n(a,r){var o,s,l,d,u;return i()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=t&&t.uid){n.next=2;break}return n.abrupt("return",{data:[],success:!0,total:0});case 2:return l={pageNumber:a.current?a.current-1:0,pageSize:a.pageSize,orgUid:t.uid,name:a.name,type:a.type,link:a.link},void 0!==a.enabled&&(l.enabled=!0===a.enabled||"true"===a.enabled),(d=Object.keys(r||{})[0])&&(l.sortBy=d,l.sortDirection="ascend"===r[d]?"asc":"desc"),n.next=8,m(l);case 8:if(200===(u=n.sent).code){n.next=12;break}return f.yw.error(u.message||e.formatMessage({id:"menu.load.failed",defaultMessage:"加载菜单失败"})),n.abrupt("return",{data:[],success:!1,total:0});case 12:return n.abrupt("return",{data:(null===(o=u.data)||void 0===o?void 0:o.content)||[],success:!0,total:(null===(s=u.data)||void 0===s?void 0:s.totalElements)||0});case 13:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),toolBarRender:function(){return[(0,D.jsx)(N.ZP,{type:"primary",icon:(0,D.jsx)(Z.Z,{}),onClick:K,children:e.formatMessage({id:"menu.create",defaultMessage:"创建菜单"})},"create")]}}),(0,D.jsx)(J,{open:s,isEdit:h,menu:E,orgUid:null==t?void 0:t.uid,onClose:function(){l(!1)},onSubmit:z})]})},G=function(){var e=(0,a.Z)().contentStyle;return(0,D.jsx)("div",{style:e,children:(0,D.jsx)(H,{})})}}}]);