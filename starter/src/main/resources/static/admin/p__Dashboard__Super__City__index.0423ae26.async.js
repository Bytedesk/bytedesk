"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6856],{83381:function(e,t,r){r.d(t,{Z:function(){return u}});var a=r(38404),s=r(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},i=r(5901),o=function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var u=s.forwardRef(o)},28031:function(e,t,r){r.d(t,{Z:function(){return u}});var a=r(38404),s=r(44194),n={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},i=r(5901),o=function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var u=s.forwardRef(o)},80503:function(e,t,r){r.d(t,{Z:function(){return u}});var a=r(38404),s=r(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},i=r(5901),o=function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var u=s.forwardRef(o)},15883:function(e,t,r){var a=r(38404),s=r(44194),n=r(78041),i=r(5901),o=function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:n.Z}))},u=s.forwardRef(o);t.Z=u},42701:function(e,t,r){var a=r(80627),s=r(93683),n=r(44194),i=r(69983),o=r(31549),u=["fieldProps","min","proFieldProps","max"],l=function(e,t){var r=e.fieldProps,n=e.min,l=e.proFieldProps,d=e.max,c=(0,s.Z)(e,u);return(0,o.jsx)(i.Z,(0,a.Z)({valueType:"digit",fieldProps:(0,a.Z)({min:n,max:d},r),ref:t,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:l},c))},d=n.forwardRef(l);t.Z=d},17455:function(e,t,r){var a=r(80627),s=r(93683),n=r(68422),i=r(44194),o=r(84729),u=r(69983),l=r(31549),d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var r=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,g=e.mode,m=e.valueEnum,h=e.request,y=e.showSearch,M=e.options,v=(0,s.Z)(e,d),x=(0,i.useContext)(o.Z);return(0,l.jsx)(u.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(m),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:M,mode:g,showSearch:y,getPopupContainer:x.getPopupContainer},r),ref:t,proFieldProps:f},v),{},{children:c}))},f=i.forwardRef((function(e,t){var r=e.fieldProps,d=e.children,p=e.params,f=e.proFieldProps,g=e.mode,m=e.valueEnum,h=e.request,y=e.options,M=(0,s.Z)(e,c),v=(0,a.Z)({options:y,mode:g||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),x=(0,i.useContext)(o.Z);return(0,l.jsx)(u.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(m),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:x.getPopupContainer},v),ref:t,proFieldProps:f},M),{},{children:d}))})),g=i.forwardRef(p);g.SearchSelect=f,g.displayName="ProFormComponent",t.Z=g},74056:function(e,t,r){var a=r(80627),s=r(93683),n=r(44194),i=r(69983),o=r(31549),u=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],l=n.forwardRef((function(e,t){var r=e.fieldProps,n=e.unCheckedChildren,l=e.checkedChildren,d=e.proFieldProps,c=(0,s.Z)(e,u);return(0,o.jsx)(i.Z,(0,a.Z)({valueType:"switch",fieldProps:(0,a.Z)({unCheckedChildren:n,checkedChildren:l},r),ref:t,valuePropName:"checked",proFieldProps:d,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},c))}));t.Z=l},67186:function(e,t,r){var a=r(29552),s=r(80627),n=r(93683),i=r(92032),o=r(69159),u=r(43928),l=r(21762),d=r(44194),c=r(69983),p=r(31549),f=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],m="text",h=function(e){var t=(0,i.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,a.Z)(t,2),n=r[0],l=r[1];return(0,p.jsx)(o.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var r,a=t.getFieldValue(e.name||[]);return(0,p.jsx)(u.Z,(0,s.Z)((0,s.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return l(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,a),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:n,children:e.children}))}})},y=function(e){var t=e.fieldProps,r=e.proFieldProps,a=(0,n.Z)(e,f);return(0,p.jsx)(c.Z,(0,s.Z)({valueType:m,fieldProps:t,filedConfig:{valueType:m},proFieldProps:r},a))};y.Password=function(e){var t=e.fieldProps,r=e.proFieldProps,i=(0,n.Z)(e,g),o=(0,d.useState)(!1),u=(0,a.Z)(o,2),f=u[0],y=u[1];return null!=t&&t.statusRender&&i.name?(0,p.jsx)(h,{name:i.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:y,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:(0,s.Z)((0,s.Z)({},(0,l.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==t||null===(r=t.onBlur)||void 0===r||r.call(t,e),y(!1)},onClick:function(e){var r;null==t||null===(r=t.onClick)||void 0===r||r.call(t,e),y(!0)}}),proFieldProps:r,filedConfig:{valueType:m}},i))})}):(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:m}},i))},y.displayName="ProFormComponent",t.Z=y},90938:function(e,t,r){var a=r(96775);t.Z=function(){var e=(0,a.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},13155:function(e,t,r){r.r(t),r.d(t,{default:function(){return ue}});var a=r(84176),s=r.n(a),n=r(73193),i=r.n(n),o=r(90819),u=r.n(o),l=r(89933),d=r.n(l),c=r(45332),p=r.n(c),f=r(50884),g=r(27353),m=r(2290);function h(e){return y.apply(this,arguments)}function y(){return(y=d()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/city/query/org",{method:"GET",params:i()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return v.apply(this,arguments)}function v(){return(v=d()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/city/create",{method:"POST",data:i()(i()({},t),{},{channel:g.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return w.apply(this,arguments)}function w(){return(w=d()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/city/update",{method:"POST",data:i()(i()({},t),{},{channel:g.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return b.apply(this,arguments)}function b(){return(b=d()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/city/delete",{method:"POST",data:i()(i()({},t),{},{channel:g.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return P.apply(this,arguments)}function P(){return(P=d()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/city/reset",{method:"POST",data:i()(i()({},t||{}),{},{channel:g.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return C.apply(this,arguments)}function C(){return(C=d()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/city/init",{method:"POST",data:i()(i()({},t||{}),{},{channel:g.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=r(90938),I=r(21002),T=r(28520),F=r(61476),L=r(28031),R=r(83381),q=r(15883),E=r(6992),O=r(80503),z=r(77601),B=r(35746),N=r(38623),U=r(70937),A=r(18221),V=r(90883),J=r(56668),D=r(44194),X=r(89622),H=r(67186),G=r(17455),W=r(42701),Q=r(74056),K=r(31549),$=function(e){var t=e.open,r=e.mode,a=e.editingRecord,s=e.orgUid,n=e.onOpenChange,o=e.onSuccess,l=(0,m.useIntl)(),c=[{label:l.formatMessage({id:"super.city.drawer.type.province",defaultMessage:"省/直辖市"}),value:"province"},{label:l.formatMessage({id:"super.city.drawer.type.city",defaultMessage:"城市"}),value:"city"},{label:l.formatMessage({id:"super.city.drawer.type.county",defaultMessage:"区/县"}),value:"county"},{label:l.formatMessage({id:"super.city.drawer.type.circle",defaultMessage:"商圈"}),value:"circle"}];return(0,K.jsxs)(X.a,{title:"create"===r?l.formatMessage({id:"super.city.drawer.title.create",defaultMessage:"新增城市"}):l.formatMessage({id:"super.city.drawer.title.edit",defaultMessage:"编辑城市"}),open:t,onOpenChange:n,width:560,layout:"horizontal",labelCol:{span:6},wrapperCol:{span:18},initialValues:"edit"===r?{name:null==a?void 0:a.name,cap:null==a?void 0:a.cap,code:null==a?void 0:a.code,hot:null==a?void 0:a.hot,lat:null==a?void 0:a.lat,lng:null==a?void 0:a.lng,open:null==a?void 0:a.open,type:null==a?void 0:a.type,parentId:null==a?void 0:a.parentId,pinyin:null==a?void 0:a.pinyin}:{hot:!1,open:!0},onFinish:function(){var e=d()(u()().mark((function e(t){var n,d;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i()(i()({},t),{},{orgUid:s}),f.yw.loading("edit"===r?l.formatMessage({id:"super.city.drawer.update.loading",defaultMessage:"更新中..."}):l.formatMessage({id:"super.city.drawer.create.loading",defaultMessage:"创建中..."})),e.prev=2,"edit"!==r){e.next=9;break}return e.next=6,x(i()(i()({},n),{},{uid:null==a?void 0:a.uid}));case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,M(n);case 11:e.t0=e.sent;case 12:if(d=e.t0,f.yw.destroy(),200!==(null==d?void 0:d.code)){e.next=18;break}return f.yw.success("edit"===r?l.formatMessage({id:"super.city.drawer.update.success",defaultMessage:"更新成功"}):l.formatMessage({id:"super.city.drawer.create.success",defaultMessage:"创建成功"})),null==o||o(),e.abrupt("return",!0);case 18:return f.yw.error((null==d?void 0:d.message)||("edit"===r?l.formatMessage({id:"super.city.drawer.update.failed",defaultMessage:"更新失败"}):l.formatMessage({id:"super.city.drawer.create.failed",defaultMessage:"创建失败"}))),e.abrupt("return",!1);case 22:return e.prev=22,e.t1=e.catch(2),f.yw.destroy(),f.yw.error("edit"===r?l.formatMessage({id:"super.city.drawer.update.failed",defaultMessage:"更新失败"}):l.formatMessage({id:"super.city.drawer.create.failed",defaultMessage:"创建失败"})),e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(t){return e.apply(this,arguments)}}(),children:[(0,K.jsx)(H.Z,{name:"name",label:l.formatMessage({id:"super.city.column.name",defaultMessage:"名称"}),placeholder:l.formatMessage({id:"super.city.drawer.placeholder.name",defaultMessage:"请输入城市名称"}),rules:[{required:!0,message:l.formatMessage({id:"super.city.drawer.required.name",defaultMessage:"请输入名称"})}]}),(0,K.jsx)(H.Z,{name:"cap",label:l.formatMessage({id:"super.city.column.cap",defaultMessage:"简称"}),placeholder:l.formatMessage({id:"super.city.drawer.placeholder.cap",defaultMessage:"如：BJ"})}),(0,K.jsx)(H.Z,{name:"code",label:l.formatMessage({id:"super.city.column.code",defaultMessage:"行政编码"}),placeholder:l.formatMessage({id:"super.city.drawer.placeholder.code",defaultMessage:"如：110000"})}),(0,K.jsx)(G.Z,{name:"type",label:l.formatMessage({id:"super.city.column.type",defaultMessage:"类型"}),placeholder:l.formatMessage({id:"super.city.drawer.placeholder.type",defaultMessage:"请选择类型"}),options:c,rules:[{required:!0,message:l.formatMessage({id:"super.city.drawer.required.type",defaultMessage:"请选择类型"})}]}),(0,K.jsx)(H.Z,{name:"pinyin",label:l.formatMessage({id:"super.city.column.pinyin",defaultMessage:"拼音"}),placeholder:l.formatMessage({id:"super.city.drawer.placeholder.pinyin",defaultMessage:"如：beijing"})}),(0,K.jsx)(W.Z,{name:"parentId",label:l.formatMessage({id:"super.city.column.parentId",defaultMessage:"父级ID"}),fieldProps:{precision:0}}),(0,K.jsx)(H.Z,{name:"lat",label:l.formatMessage({id:"super.city.column.lat",defaultMessage:"纬度"}),placeholder:l.formatMessage({id:"super.city.drawer.placeholder.lat",defaultMessage:"如：39.9042"})}),(0,K.jsx)(H.Z,{name:"lng",label:l.formatMessage({id:"super.city.column.lng",defaultMessage:"经度"}),placeholder:l.formatMessage({id:"super.city.drawer.placeholder.lng",defaultMessage:"如：116.4074"})}),(0,K.jsx)(Q.Z,{name:"hot",label:l.formatMessage({id:"super.city.column.hot",defaultMessage:"热门"})}),(0,K.jsx)(Q.Z,{name:"open",label:l.formatMessage({id:"super.city.column.open",defaultMessage:"启用"})})]})};function Y(e){return _.apply(this,arguments)}function _(){return(_=d()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/test/api/v1/phone/lookup",{method:"GET",params:{number:t}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee=r(12715),te=r(69159),re=r(46206),ae=r(31461),se=r(88547),ne=r(64724),ie=function(e){var t=e.open,r=e.onOpenChange,a=(0,m.useIntl)(),s=te.Z.useForm(),n=p()(s,1)[0],i=(0,D.useState)(!1),o=p()(i,2),l=o[0],c=o[1],g=(0,D.useState)(null),h=p()(g,2),y=h[0],M=h[1],v=(0,D.useMemo)((function(){return a.formatMessage({id:"super.city.phoneLookup.modal.title",defaultMessage:"手机号归属地查询"})}),[a]);(0,D.useEffect)((function(){t||(M(null),n.resetFields(),c(!1))}),[t,n]);var x,w=function(){var e=d()(u()().mark((function e(){var t,r,s,i,o,l;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.validateFields();case 2:return t=e.sent,r=String((null==t?void 0:t.number)||"").trim(),c(!0),e.prev=5,e.next=8,Y(r);case 8:200===(null==(s=e.sent)?void 0:s.code)?(M((null==s?void 0:s.data)||null),null!=s&&s.data||f.yw.warning(a.formatMessage({id:"super.city.phoneLookup.message.noData",defaultMessage:"未返回数据"}))):f.yw.error((null==s?void 0:s.message)||a.formatMessage({id:"super.city.phoneLookup.message.failed",defaultMessage:"查询失败"})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),l=(null===e.t0||void 0===e.t0||null===(i=e.t0.data)||void 0===i?void 0:i.message)||(null===e.t0||void 0===e.t0||null===(o=e.t0.response)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.message)||(null===e.t0||void 0===e.t0?void 0:e.t0.message)||a.formatMessage({id:"super.city.phoneLookup.message.failed",defaultMessage:"查询失败"}),f.yw.error(l);case 16:return e.prev=16,c(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[5,12,16,19]])})));return function(){return e.apply(this,arguments)}}();return(0,K.jsxs)(B.Z,{open:t,title:v,onCancel:function(){return r(!1)},footer:(0,K.jsxs)(re.Z,{children:[(0,K.jsx)(V.ZP,{onClick:function(){return r(!1)},children:a.formatMessage({id:"super.city.phoneLookup.button.close",defaultMessage:"关闭"})}),(0,K.jsx)(V.ZP,{type:"primary",icon:(0,K.jsx)(ee.Z,{}),loading:l,onClick:w,children:a.formatMessage({id:"super.city.phoneLookup.button.search",defaultMessage:"查询"})})]}),destroyOnHidden:!0,children:[(0,K.jsx)(te.Z,{form:n,layout:"vertical",onFinish:w,initialValues:{number:""},children:(0,K.jsx)(te.Z.Item,{label:a.formatMessage({id:"super.city.phoneLookup.form.label",defaultMessage:"手机号 / 号段"}),name:"number",rules:[{required:!0,message:a.formatMessage({id:"super.city.phoneLookup.form.required",defaultMessage:"请输入 11 位手机号或前 7 位号段"})},{validator:(x=d()(u()().mark((function e(t,r){var s;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=String(r||"").trim()){e.next=3;break}return e.abrupt("return");case 3:if(/^\d{7,11}$/.test(s)){e.next=5;break}throw new Error(a.formatMessage({id:"super.city.phoneLookup.form.invalid",defaultMessage:"number 必须是 7-11 位数字"}));case 5:case"end":return e.stop()}}),e)}))),function(e,t){return x.apply(this,arguments)})}],children:(0,K.jsx)(ae.Z,{placeholder:a.formatMessage({id:"super.city.phoneLookup.form.placeholder",defaultMessage:"例如：13800138000 或 1380013"}),maxLength:11,allowClear:!0,onPressEnter:function(){return n.submit()}})})}),y?(0,K.jsxs)(se.Z,{column:1,bordered:!0,size:"small",title:a.formatMessage({id:"super.city.phoneLookup.result.title",defaultMessage:"查询结果"}),children:[(0,K.jsx)(se.Z.Item,{label:a.formatMessage({id:"super.city.phoneLookup.result.number",defaultMessage:"号码"}),children:y.number||"-"}),(0,K.jsx)(se.Z.Item,{label:a.formatMessage({id:"super.city.phoneLookup.result.province",defaultMessage:"省份"}),children:y.province||"-"}),(0,K.jsx)(se.Z.Item,{label:a.formatMessage({id:"super.city.phoneLookup.result.city",defaultMessage:"城市"}),children:y.city||"-"}),(0,K.jsx)(se.Z.Item,{label:a.formatMessage({id:"super.city.phoneLookup.result.zipCode",defaultMessage:"邮编"}),children:y.zipCode||"-"}),(0,K.jsx)(se.Z.Item,{label:a.formatMessage({id:"super.city.phoneLookup.result.areaCode",defaultMessage:"区号"}),children:y.areaCode||"-"}),(0,K.jsx)(se.Z.Item,{label:a.formatMessage({id:"super.city.phoneLookup.result.isp",defaultMessage:"运营商"}),children:y.ispCnName||y.isp||"-"})]}):(0,K.jsx)(ne.Z.Text,{type:"secondary",children:a.formatMessage({id:"super.city.phoneLookup.tips.empty",defaultMessage:"输入号码后点击“查询”。"})})]})},oe=["current","pageSize"],ue=function(){var e,t,r=(0,m.useIntl)(),a=(0,S.Z)().contentStyle,n=(0,m.useAccess)(),o=null!==(e=null==n||null===(t=n.canSuper)||void 0===t?void 0:t.call(n))&&void 0!==e&&e,l=(0,I.Z)().translateString,c=(0,D.useRef)(),y=(0,T.u)((function(e){return e.currentOrg})),M=B.Z.useModal(),v=p()(M,2),x=v[0],w=v[1],b=(0,D.useState)(!1),P=p()(b,2),C=P[0],X=P[1],H=(0,D.useState)("create"),G=p()(H,2),W=G[0],Q=G[1],Y=(0,D.useState)({}),_=p()(Y,2),ee=_[0],te=_[1],re=(0,D.useState)(!1),ae=p()(re,2),se=ae[0],ne=ae[1],ue=(0,D.useState)(1),le=p()(ue,2),de=le[0],ce=le[1],pe=(0,D.useState)(10),fe=p()(pe,2),ge=fe[0],me=fe[1],he=(0,D.useState)(0),ye=p()(he,2),Me=ye[0],ve=ye[1],xe=(0,D.useState)({}),we=p()(xe,2),Ze=we[0],be=we[1],ke=(0,D.useMemo)((function(){return{province:{text:r.formatMessage({id:"super.city.drawer.type.province",defaultMessage:"省/直辖市"})},city:{text:r.formatMessage({id:"super.city.drawer.type.city",defaultMessage:"城市"})},county:{text:r.formatMessage({id:"super.city.drawer.type.county",defaultMessage:"区/县"})},circle:{text:r.formatMessage({id:"super.city.drawer.type.circle",defaultMessage:"商圈"})}}}),[r]),Pe=function(){f.yw.warning(r.formatMessage({id:"super.city.message.superOnly",defaultMessage:"仅超级管理员可操作城市数据"}))},je=function(){o?(Q("create"),te({}),X(!0)):Pe()},Ce=function(){var e=d()(u()().mark((function e(t){var a,s,n;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return Pe(),e.abrupt("return");case 3:if(null!=t&&t.uid){e.next=5;break}return e.abrupt("return");case 5:return f.yw.loading(r.formatMessage({id:"super.city.delete.loading",defaultMessage:"删除中..."})),e.prev=6,e.next=9,Z({uid:t.uid,orgUid:null==y?void 0:y.uid});case 9:a=e.sent,f.yw.destroy(),200===(null==a?void 0:a.code)?(f.yw.success(r.formatMessage({id:"super.city.delete.success",defaultMessage:"删除成功"})),null===(s=c.current)||void 0===s||null===(n=s.reloadAndRest)||void 0===n||n.call(s)):f.yw.error((null==a?void 0:a.message)||r.formatMessage({id:"super.city.delete.failed",defaultMessage:"删除失败"})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(6),f.yw.destroy(),f.yw.error(r.formatMessage({id:"super.city.delete.failed",defaultMessage:"删除失败"}));case 18:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=d()(u()().mark((function e(){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return Pe(),e.abrupt("return");case 3:x.confirm({title:r.formatMessage({id:"super.city.reset.modal.title",defaultMessage:"一键重置确认"}),content:r.formatMessage({id:"super.city.reset.modal.content",defaultMessage:"将删除所有城市数据，且不可恢复。确认继续？"}),okText:r.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:r.formatMessage({id:"cancel",defaultMessage:"取消"}),okButtonProps:{danger:!0},onOk:function(){var e=d()(u()().mark((function e(){var t,a,s;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.yw.loading(r.formatMessage({id:"super.city.reset.loading",defaultMessage:"重置中..."})),e.prev=1,e.next=4,k({orgUid:null==y?void 0:y.uid});case 4:t=e.sent,f.yw.destroy(),200===(null==t?void 0:t.code)?(f.yw.success(l(null==t?void 0:t.message)||r.formatMessage({id:"super.city.reset.success",defaultMessage:"重置成功"})),null===(a=c.current)||void 0===a||null===(s=a.reloadAndRest)||void 0===s||s.call(a)):f.yw.error(l(null==t?void 0:t.message)||r.formatMessage({id:"super.city.reset.failed",defaultMessage:"重置失败"})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),f.yw.destroy(),f.yw.error(r.formatMessage({id:"super.city.reset.failed",defaultMessage:"重置失败"}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}()});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=function(){var e=d()(u()().mark((function e(){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return Pe(),e.abrupt("return");case 3:x.confirm({title:r.formatMessage({id:"super.city.init.modal.title",defaultMessage:"一键初始化确认"}),content:r.formatMessage({id:"super.city.init.modal.content",defaultMessage:"将从内置 SQL 脚本后台导入城市数据（已有数据将跳过，建议先重置）。确认继续？"}),okText:r.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:r.formatMessage({id:"cancel",defaultMessage:"取消"}),onOk:function(){var e=d()(u()().mark((function e(){var t,a,s;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.yw.loading(r.formatMessage({id:"super.city.init.loading",defaultMessage:"初始化中..."})),e.prev=1,e.next=4,j({orgUid:null==y?void 0:y.uid});case 4:t=e.sent,f.yw.destroy(),200===(null==t?void 0:t.code)?(!0===(null==t?void 0:t.data)?f.yw.success(l(null==t?void 0:t.message)||r.formatMessage({id:"super.city.init.success.started",defaultMessage:"已在后台开始导入，请稍后刷新"})):f.yw.warning(l(null==t?void 0:t.message)||r.formatMessage({id:"super.city.init.success.skipped",defaultMessage:"初始化已跳过（已有数据）"})),null===(a=c.current)||void 0===a||null===(s=a.reload)||void 0===s||s.call(a)):f.yw.error(l(null==t?void 0:t.message)||r.formatMessage({id:"super.city.init.failed",defaultMessage:"初始化失败"})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),f.yw.destroy(),f.yw.error(r.formatMessage({id:"super.city.init.failed",defaultMessage:"初始化失败"}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}()});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=d()(u()().mark((function e(t,r,a){var s,n;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return Pe(),e.abrupt("return");case 3:s=localStorage.getItem(g.LA8),n=i()({orgUid:(null==y?void 0:y.uid)||"",accessToken:s||"",exportType:t},Ze),"current"===t?(n.pageNumber=String(de-1),n.pageSize=String(ge)):"all"===t?(n.pageNumber="0",n.pageSize="1000"):"range"===t&&void 0!==r&&void 0!==a&&(n.pageNumber=String(r),n.pageSize=String(a)),window.open((0,F.kG)()+"/api/v1/city/export?"+new URLSearchParams(n).toString());case 7:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),Fe=(0,D.useMemo)((function(){var e=r.formatMessage({id:"super.city.export.count",defaultMessage:"{count}条"},{count:Me}),t=[{key:"export-current",icon:(0,K.jsx)(L.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return Te("current")}}];if(Me>0)if(Me<=1e3)t.push({key:"export-all",icon:(0,K.jsx)(L.Z,{}),label:"".concat(r.formatMessage({id:"export.all",defaultMessage:"导出全部"})," (").concat(e,")"),onClick:function(){return Te("all")}});else{for(var a=[],s=1e3,n=Math.ceil(Me/s),i=function(e){var t=e*s+1,n=Math.min((e+1)*s,Me);a.push({key:"export-range-".concat(e),label:r.formatMessage({id:"super.city.export.rangeItem",defaultMessage:"{start}-{end} ({count}条)"},{start:t,end:n,count:n-t+1}),onClick:function(){return Te("range",e,s)}})},o=0;o<n;o++)i(o);t.push({key:"export-range",icon:(0,K.jsx)(L.Z,{}),label:"".concat(r.formatMessage({id:"export.range",defaultMessage:"分段导出"})," (").concat(e,")"),children:a})}return t}),[Me,null==y?void 0:y.uid,de,ge,Ze,o]),Le=(0,D.useMemo)((function(){return[{key:"init",label:r.formatMessage({id:"super.city.action.init",defaultMessage:"一键初始化"}),onClick:Ie},{key:"reset",danger:!0,label:r.formatMessage({id:"super.city.action.reset",defaultMessage:"一键重置"}),onClick:Se},{type:"divider"},{key:"export",icon:(0,K.jsx)(L.Z,{}),label:r.formatMessage({id:"import.export",defaultMessage:"导入导出"}),children:Fe,disabled:!0}]}),[Fe,Ie,Se,r]),Re=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:r.formatMessage({id:"super.city.column.name",defaultMessage:"名称"}),dataIndex:"name",copyable:!0,width:160,fixed:"left"},{title:r.formatMessage({id:"super.city.column.cap",defaultMessage:"简称"}),dataIndex:"cap",width:120,hideInSearch:!0},{title:r.formatMessage({id:"super.city.column.code",defaultMessage:"行政编码"}),dataIndex:"code",width:140},{title:r.formatMessage({id:"super.city.column.type",defaultMessage:"类型"}),dataIndex:"type",width:120,valueType:"select",valueEnum:ke,render:function(e,t){var r,a=null==t?void 0:t.type,s=a&&(null===(r=ke[a])||void 0===r?void 0:r.text)||(null==t?void 0:t.type)||"-";return(0,K.jsx)(N.Z,{children:s})}},{title:r.formatMessage({id:"super.city.column.pinyin",defaultMessage:"拼音"}),dataIndex:"pinyin",width:140,hideInSearch:!0},{title:r.formatMessage({id:"super.city.column.hot",defaultMessage:"热门"}),dataIndex:"hot",width:90,valueType:"select",valueEnum:{true:{text:r.formatMessage({id:"super.city.value.yes",defaultMessage:"是"})},false:{text:r.formatMessage({id:"super.city.value.no",defaultMessage:"否"})}},render:function(e,t){return(0,K.jsx)(N.Z,{color:t.hot?"gold":"default",children:t.hot?r.formatMessage({id:"super.city.hot.hot",defaultMessage:"热门"}):r.formatMessage({id:"super.city.hot.normal",defaultMessage:"普通"})})}},{title:r.formatMessage({id:"super.city.column.open",defaultMessage:"启用"}),dataIndex:"open",width:90,valueType:"select",valueEnum:{true:{text:r.formatMessage({id:"super.city.open.enabled",defaultMessage:"启用"})},false:{text:r.formatMessage({id:"super.city.open.disabled",defaultMessage:"禁用"})}},render:function(e,t){return(0,K.jsx)(N.Z,{color:t.open?"success":"default",children:t.open?r.formatMessage({id:"super.city.open.enabled",defaultMessage:"启用"}):r.formatMessage({id:"super.city.open.disabled",defaultMessage:"禁用"})})}},{title:r.formatMessage({id:"super.city.column.parentId",defaultMessage:"父级ID"}),dataIndex:"parentId",width:110,hideInSearch:!0},{title:r.formatMessage({id:"super.city.column.lat",defaultMessage:"纬度"}),dataIndex:"lat",width:120,hideInSearch:!0},{title:r.formatMessage({id:"super.city.column.lng",defaultMessage:"经度"}),dataIndex:"lng",width:120,hideInSearch:!0},{title:r.formatMessage({id:"super.city.column.createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",width:170,sorter:!0,defaultSortOrder:"descend",hideInSearch:!0},{title:r.formatMessage({id:"super.city.column.updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",width:170,sorter:!0,hideInSearch:!0},{title:r.formatMessage({id:"super.city.column.actions",defaultMessage:"操作"}),valueType:"option",width:140,fixed:"right",render:function(e,t){return o?[(0,K.jsx)("a",{onClick:function(){return function(e){o?(Q("edit"),te(e),X(!0)):Pe()}(t)},children:r.formatMessage({id:"super.city.action.edit",defaultMessage:"编辑"})},"edit"),(0,K.jsx)(U.Z,{title:r.formatMessage({id:"super.city.delete.confirm",defaultMessage:"确认删除？"}),icon:(0,K.jsx)(R.Z,{style:{color:"red"}}),onConfirm:function(){return Ce(t)},okText:r.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:r.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,K.jsx)("a",{style:{color:"#ff4d4f"},children:r.formatMessage({id:"super.city.action.delete",defaultMessage:"删除"})})},"delete")]:null}}];return o?(0,K.jsxs)("div",{style:a,children:[se&&(0,K.jsx)(ie,{open:se,onOpenChange:ne}),C&&(0,K.jsx)($,{open:C,mode:W,editingRecord:ee,orgUid:null==y?void 0:y.uid,onOpenChange:function(e){e||X(!1)},onSuccess:function(){var e,t;X(!1),null===(e=c.current)||void 0===e||null===(t=e.reloadAndRest)||void 0===t||t.call(e)}}),(0,K.jsx)(z.Z,{columns:Re,actionRef:c,cardBordered:!0,scroll:{x:"max-content"},rowKey:function(e){return e.uid||e.code||e.name||""},request:function(){var e=d()(u()().mark((function e(t,a){var n,o,l,d,c,p,g,m,M,v,x;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(n=t).current,l=n.pageSize,d=s()(n,oe),ce(o),me(l),be(d),c=Object.keys(a||{})[0],p=c?a[c]:void 0,g=i()(i()({pageNumber:(o||1)-1,pageSize:l,orgUid:null==y?void 0:y.uid},c?{sortBy:c,sortDirection:p}:{}),d),e.next=9,h(g);case 9:if(200!==(null==(m=e.sent)?void 0:m.code)){e.next=13;break}return ve((null==m||null===(M=m.data)||void 0===M?void 0:M.totalElements)||0),e.abrupt("return",{data:(null==m||null===(v=m.data)||void 0===v?void 0:v.content)||[],success:!0,total:(null==m||null===(x=m.data)||void 0===x?void 0:x.totalElements)||0});case 13:return f.yw.error((null==m?void 0:m.message)||r.formatMessage({id:"super.city.query.failed",defaultMessage:"查询失败"})),e.abrupt("return",{data:[],success:!0,total:0});case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e,t){ce(e),me(t)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"super.city.table.title",defaultMessage:"城市列表"}),toolBarRender:function(){return[(0,K.jsx)(V.ZP,{icon:(0,K.jsx)(q.Z,{}),onClick:function(){return ne(!0)},children:r.formatMessage({id:"super.city.action.phoneLookup",defaultMessage:"手机号归属地"})},"phone-lookup"),(0,K.jsx)(V.ZP,{type:"primary",icon:(0,K.jsx)(E.Z,{}),onClick:je,children:r.formatMessage({id:"super.city.action.create",defaultMessage:"新增"})},"create"),(0,K.jsx)(J.Z,{menu:{items:Le},placement:"bottom",children:(0,K.jsxs)(V.ZP,{children:[r.formatMessage({id:"super.city.action.more",defaultMessage:"更多操作"}),(0,K.jsx)(O.Z,{})]})},"more")]}}),w]}):(0,K.jsx)(A.Z,{type:"warning",showIcon:!0,message:r.formatMessage({id:"super.city.permission.title",defaultMessage:"无权限"}),description:r.formatMessage({id:"super.city.permission.desc",defaultMessage:"City 管理仅超级管理员可用。"})})}}}]);