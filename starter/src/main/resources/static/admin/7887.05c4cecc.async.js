"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[7887],{82863:function(e,n,t){t.d(n,{Jr:function(){return f},LF:function(){return p},Oh:function(){return y},WS:function(){return h}});var r=t(90819),a=t.n(r),i=t(73193),u=t.n(i),o=t(89933),c=t.n(o),s=t(55735),l=t(30921);function p(e){return d.apply(this,arguments)}function d(){return(d=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/model/query/org",{method:"GET",params:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/model/create",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/model/update",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/model/delete",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},36605:function(e,n,t){t.d(n,{HH:function(){return y},T:function(){return f},fx:function(){return h},mK:function(){return p}});var r=t(90819),a=t.n(r),i=t(73193),u=t.n(i),o=t(89933),c=t.n(o),s=t(55735),l=t(30921);function p(e){return d.apply(this,arguments)}function d(){return(d=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/provider/query/org",{method:"GET",params:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/provider/create",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/provider/update",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/provider/delete",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},92053:function(e,n,t){t.d(n,{G9:function(){return g},J$:function(){return j},N6:function(){return x},VM:function(){return s},c8:function(){return p},gF:function(){return h},rg:function(){return f},sF:function(){return y}});var r=t(90819),a=t.n(r),i=t(89933),u=t.n(i),o=t(55735),c=t(30921);function s(){return l.apply(this,arguments)}function l(){return(l=u()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/ping",{method:"GET",params:{client:o.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return d.apply(this,arguments)}function d(){return(d=u()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/local-models",{method:"GET",params:{client:o.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return m.apply(this,arguments)}function m(){return(m=u()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/models",{method:"GET",params:{client:o.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=u()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/library/models/"+n+"/details",{method:"GET",params:{client:o.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=u()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/models/"+n+"/details",{method:"GET",params:{client:o.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return w.apply(this,arguments)}function w(){return(w=u()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/models/pull",{method:"POST",params:{client:o.bVn},data:{model:n}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return k.apply(this,arguments)}function k(){return(k=u()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/models/delete",{method:"POST",params:{client:o.bVn},data:{model:n}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return T.apply(this,arguments)}function T(){return(T=u()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/ollama4j/embedding-model/exists",{method:"GET",params:{client:o.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},27522:function(e,n,t){t.d(n,{AP:function(){return p},_J:function(){return y},t5:function(){return h},v_:function(){return f}});var r=t(90819),a=t.n(r),i=t(73193),u=t.n(i),o=t(89933),c=t.n(o),s=t(55735),l=t(30921);function p(e){return d.apply(this,arguments)}function d(){return(d=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/kbase/query/org",{method:"GET",params:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/kbase/create",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/kbase/update",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=c()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/kbase/delete",{method:"POST",data:u()(u()({},n),{},{client:s.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},40679:function(e,n,t){var r=t(10154),a=t.n(r),i=t(73193),u=t.n(i),o=t(90819),c=t.n(o),s=t(89933),l=t.n(s),p=t(45332),d=t.n(p),f=t(86803),m=t(82863),h=t(92053),v=t(76750),y=t(55735),b=t(88721),x=t(32327),w=t(62673),g=t(40269),k=t(3849),j=t(73442),T=t(75365),S=t(8247),q=t(30921),V=t(44194),P=t(31549),C=x.Z.Text,M=V.memo((function(e){var n,t=e.visible,r=e.onCancel,i=e.onOk,o=e.initialProvider,s=e.initialModel,p=e.initialModelLabel,M=e.providers,O=e.currentOrgUid,L=e.existingProviderModels,Z=void 0===L?{}:L,E=e.onModelsLoaded,G=e.allowedModelTypes,N=void 0===G?[]:G,F=(0,q.useIntl)(),I=(0,v.Z)().translateString,A=(0,V.useState)(o||""),H=d()(A,2),J=H[0],R=H[1],U=(0,V.useState)(Z),D=d()(U,2),K=D[0],W=D[1],_=(0,V.useState)(o||""),z=d()(_,2),B=z[0],Q=z[1],$=(0,V.useState)(s||""),X=d()($,2),Y=X[0],ee=X[1],ne=(0,V.useState)(p||""),te=d()(ne,2),re=te[0],ae=te[1],ie=(0,V.useState)(!1),ue=d()(ie,2),oe=ue[0],ce=ue[1];(0,V.useEffect)((function(){Q(o),ee(s),ae(p),R(o)}),[o,s,p,t]),(0,V.useEffect)((function(){if(t&&J&&!K[J]&&!oe){ce(!0),f.yw.loading({content:F.formatMessage({id:"loading"}),key:"modelLoading"});var e=M.find((function(e){return e.name===J}));e&&("ollama"===e.name?de():me(e))}}),[t,J,M]);var se=(0,V.useCallback)((function(){B&&Y&&i(B,Y,re)}),[B,Y,re,i]),le=(0,V.useCallback)((function(e){return["bge","embed","m3e","vector","nomic","e5","gte","instructor","sentence-transformers","text-embedding","all-mpnet","multi-qa","paraphrase","sbert","clip","jina","onnx"].some((function(n){return e.toLowerCase().includes(n.toLowerCase())}))}),[]),pe=(0,V.useCallback)((function(e){return e?e.filter((function(e){return!le(e.value)&&(!N||0===N.length||(!e.type||N.includes(e.type)))})):[]}),[N,le]),de=function(){var e=l()(c()().mark((function e(){var n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.VM)();case 3:200===(n=e.sent).code&&n.data?fe():(f.yw.error(n.message),f.yw.destroy("modelLoading"),ce(!1)),e.next=13;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to check Ollama status:",e.t0),f.yw.error(F.formatMessage({id:"error"})),f.yw.destroy("modelLoading"),ce(!1);case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=l()(c()().mark((function e(){var n,t,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.c8)();case 3:200===(n=e.sent).code?(t=n.data.map((function(e){return{value:e.name,label:e.name,providerName:"ollama"}})),r=pe(t),W((function(e){return u()(u()({},e),{},{ollama:r})})),E&&E("ollama",r)):f.yw.error(n.message),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to fetch local models:",e.t0),f.yw.error(F.formatMessage({id:"error"}));case 11:return e.prev=11,f.yw.destroy("modelLoading"),ce(!1),e.finish(11);case 15:case"end":return e.stop()}}),e,null,[[0,7,11,15]])})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=l()(c()().mark((function e(n){var t,r,i,o;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={pageNumber:0,pageSize:50,providerUid:null==n?void 0:n.uid,orgUid:O,level:y.whQ},e.next=4,(0,m.LF)(t);case 4:200===(r=e.sent).code?(i=r.data.content.map((function(e){return{value:e.name,label:e.nickname,description:e.description,type:e.type,providerName:n.name}})),o=pe(i),W((function(e){return u()(u()({},e),{},a()({},n.name,o))})),E&&E(n.name,o)):f.yw.error(r.message),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch models:",e.t0),f.yw.error(F.formatMessage({id:"error"}));case 12:return e.prev=12,f.yw.destroy("modelLoading"),ce(!1),e.finish(12);case 16:case"end":return e.stop()}}),e,null,[[0,8,12,16]])})));return function(n){return e.apply(this,arguments)}}(),he=(0,V.useCallback)((function(e,n){Q(e),ee(n.value),ae(n.label)}),[]),ve=(0,V.useCallback)((function(e){if(R(e),!K[e]&&!oe){ce(!0),f.yw.loading({content:F.formatMessage({id:"loading"}),key:"modelLoading"});var n=M.find((function(n){return n.name===e}));n&&("ollama"===n.name?de():me(n))}}),[M,K,oe]),ye=V.memo((function(e){var n=e.model,t=e.providerName;return(0,P.jsxs)(w.Z,{hoverable:!0,style:{cursor:"pointer",border:Y===n.value&&B===t?"2px solid #1890ff":"1px solid #e8e8e8"},onClick:function(){return he(t,n)},children:[(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,P.jsx)(x.Z.Title,{level:5,style:{margin:0},children:n.label}),(0,P.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[n.type&&(0,P.jsx)("div",{style:{marginBottom:8},children:(0,b.Rb)(n.type)}),Y===n.value&&B===t&&(0,P.jsx)(g.Z,{status:"processing",text:"已选"})]})]}),n.description&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(x.Z.Text,{type:"secondary",children:null==n?void 0:n.value}),(0,P.jsx)(x.Z.Paragraph,{ellipsis:{rows:2},type:"secondary",style:{marginTop:8},children:n.description})]})]},n.value)}),(function(e,n){return e.model.value===n.model.value&&e.providerName===n.providerName&&(Y===e.model.value&&B===e.providerName)===(Y===n.model.value&&B===n.providerName)})),be=(0,V.useMemo)((function(){return M.map((function(e){var n,t;return{key:e.name,label:I(e.nickname),children:(0,P.jsx)("div",{style:{minHeight:"400px",width:"100%"},children:(0,P.jsxs)(k.Z,{direction:"vertical",style:{width:"100%"},children:[oe&&J===e.name&&!K[e.name]?(0,P.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,P.jsx)(C,{type:"secondary",children:"加载模型中..."})}):(!K[e.name]||0===(null===(n=K[e.name])||void 0===n?void 0:n.length))&&(0,P.jsx)(C,{type:"secondary",children:"暂无可用模型"}),(0,P.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px"},children:null===(t=K[e.name])||void 0===t?void 0:t.map((function(n){return(0,P.jsx)(ye,{model:n,providerName:e.name},n.value)}))})]})})}}))}),[M,K,J,oe,Y,B,I]);return(0,P.jsx)(j.Z,{title:"选择AI模型",open:t,onClose:r,width:700,destroyOnClose:!1,footer:(0,P.jsxs)("div",{style:{textAlign:"right"},children:[(0,P.jsx)(T.ZP,{onClick:r,style:{marginRight:8},children:"取消"}),(0,P.jsx)(T.ZP,{onClick:se,type:"primary",children:"确定"})]}),children:M.length>0&&(0,P.jsx)(S.Z,{activeKey:J||(null===(n=M[0])||void 0===n?void 0:n.name),onChange:ve,items:be,destroyInactiveTabPane:!1})})}),(function(e,n){return e.visible===n.visible&&e.initialProvider===n.initialProvider&&e.initialModel===n.initialModel&&e.initialModelLabel===n.initialModelLabel}));n.Z=M},96865:function(e,n,t){var r=t(23864);n.Z=function(){var e=(0,r.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"}}}}}]);