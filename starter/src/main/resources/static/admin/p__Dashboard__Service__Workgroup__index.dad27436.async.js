"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9828],{91825:function(e,t,n){var r=n(94433),i=n(38956),s=n(57343),o=n(4342),a=n(44194),l=n(55870),u=n(9953),d=n(31549),g=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],c=a.forwardRef((function(e,t){var n=e.fieldProps,o=e.options,a=e.radioType,l=e.layout,c=e.proFieldProps,f=e.valueEnum,v=(0,i.Z)(e,g);return(0,d.jsx)(u.Z,(0,r.Z)((0,r.Z)({valueType:"button"===a?"radioButton":"radio",ref:t,valueEnum:(0,s.h)(f,void 0)},v),{},{fieldProps:(0,r.Z)({options:o,layout:l},n),proFieldProps:c,filedConfig:{customLightMode:!0}}))})),f=a.forwardRef((function(e,t){var n=e.fieldProps,i=e.children;return(0,d.jsx)(o.ZP,(0,r.Z)((0,r.Z)({},n),{},{ref:t,children:i}))})),v=(0,l.G)(f,{valuePropName:"checked",ignoreWidth:!0});v.Group=c,v.Button=o.ZP.Button,v.displayName="ProFormComponent",t.Z=v},25546:function(e,t,n){n.r(t),n.d(t,{default:function(){return ze}});var r=n(76711),i=n.n(r),s=n(44194),o=n(21600),a=n(4628),l=n(89957),u=n.n(l),d=n(90819),g=n.n(d),c=n(89933),f=n.n(c),v=n(73193),m=n.n(v),p=n(45332),b=n.n(p),h=n(81581),x=n(69533),M=n(30310),S=n(1282),k=n(83281),w=n(96955),j=n(90581),y=n(12461),T=n(43275),Z=n(27729),C=n(82878),R=n(29337),F=n(68779),P=n(90727),L=n(12322),A=n(58087),W=n(83910),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM304.8 524h50.7c3.7 0 6.8-3 6.8-6.8v-78.9c0-19.7 15.9-35.6 35.5-35.6h205.7v53.4c0 5.7 6.5 8.8 10.9 5.3l109.1-85.7c3.5-2.7 3.5-8 0-10.7l-109.1-85.7c-4.4-3.5-10.9-.3-10.9 5.3V338H397.7c-55.1 0-99.7 44.8-99.7 100.1V517c0 4 3 7 6.8 7zm-4.2 134.9l109.1 85.7c4.4 3.5 10.9.3 10.9-5.3v-53.4h205.7c55.1 0 99.7-44.8 99.7-100.1v-78.9c0-3.7-3-6.8-6.8-6.8h-50.7c-3.7 0-6.8 3-6.8 6.8v78.9c0 19.7-15.9 35.6-35.5 35.6H420.6V568c0-5.7-6.5-8.8-10.9-5.3l-109.1 85.7c-3.5 2.5-3.5 7.8 0 10.5z"}}]},name:"interaction",theme:"outlined"},U=n(54183),O=function(e,t){return s.createElement(U.Z,(0,W.Z)({},e,{ref:t,icon:E}))};var q=s.forwardRef(O),I=n(31806),V=n(34600),z=n(56482),N=n(94322),K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M740 161c-61.8 0-112 50.2-112 112 0 50.1 33.1 92.6 78.5 106.9v95.9L320 602.4V318.1c44.2-15 76-56.9 76-106.1 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 49.2 31.8 91 76 106.1V706c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-27.8l423.5-138.7a50.52 50.52 0 0034.9-48.2V378.2c42.9-15.8 73.6-57 73.6-105.2 0-61.8-50.2-112-112-112zm-504 51a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm96 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm408-491a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"branches",theme:"outlined"},D=function(e,t){return s.createElement(U.Z,(0,W.Z)({},e,{ref:t,icon:K}))};var J=s.forwardRef(D),B=n(10162),H=n(59304),Q=n(54881),G=n(47944),Y=n(4317),_=n(80556),X=n(55785),$=n(97135),ee=n(43388),te=n(11810),ne=n(74171),re=n(21850),ie=n(25553),se=n(94976),oe=n(39325),ae=n(95093),le=n(1596),ue=(n(94147),n(77500)),de=n(12608),ge=n(27501),ce=n(83610),fe=n(84895),ve=n(25780),me=n(42e3),pe=n(10154),be=n.n(pe),he=n(56862),xe=n(88722),Me=n(99036),Se=n(98907),ke=n(96695),we=n(59005),je=n(67242),ye=n(31549),Te=function(e){var t=e.variant,n=e.robotRoutingSettings,r=e.onRobotRoutingSettingsChange,i=Me.A.useForm(),o=b()(i,1)[0],a=(0,s.useRef)(!1),l=(0,s.useState)([]),u=b()(l,2),d=u[0],c=u[1],v=(0,ne.u)((function(e){return e.currentOrg})),m=(0,xe.Z)().translateString,p=(0,s.useMemo)((function(){var e;return null!==(e=null==n?void 0:n.draft)&&void 0!==e?e:null==n?void 0:n.live}),[n]);(0,s.useEffect)((function(){var e,n;if("workgroup"===t){var r=null!==(e=null==p?void 0:p.robotUid)&&void 0!==e?e:null==p||null===(n=p.robot)||void 0===n?void 0:n.uid;o.setFieldsValue({defaultRobot:null==p?void 0:p.defaultRobot,offlineRobot:null==p?void 0:p.offlineRobot,nonWorktimeRobot:null==p?void 0:p.nonWorktimeRobot,robotUid:r})}}),[t,p,o]);var h=function(){var e=f()(g()().mark((function e(){var t,n,r;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=3;break}return je.Z.debug("isLoading: 1",a.current),e.abrupt("return");case 3:return a.current=!0,ee.yw.loading("loading"),t={pageNumber:0,pageSize:50,type:se.f4h,orgUid:null==v?void 0:v.uid},e.next=8,(0,he.p0)(t);case 8:n=e.sent,je.Z.debug("queryRobotsByOrg: ",n),200===n.code?c(null==n||null===(r=n.data)||void 0===r?void 0:r.content):ee.yw.error(n.message),a.current=!1,ee.yw.destroy();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){h()}),[]);var x=function(){var e;null===(e=o.validateFields)||void 0===e||e.call(o,["robotUid"]).catch((function(){return null}))},M=function(e){return function(t){var n,i=!(null==t||null===(n=t.target)||void 0===n||!n.checked);null==r||r(be()({},e,i)),x()}};return(0,ye.jsx)(Me.A,{form:o,style:{marginLeft:"20px"},submitter:!1,children:"workgroup"===t&&(0,ye.jsxs)(ye.Fragment,{children:[(0,ye.jsx)(Se.Z,{name:"defaultRobot",width:"md",label:"默认启用机器人",fieldProps:{onChange:M("defaultRobot")}}),(0,ye.jsx)(Se.Z,{name:"offlineRobot",width:"md",label:"无客服在线时启用机器人",fieldProps:{onChange:M("offlineRobot")}}),(0,ye.jsx)(Se.Z,{name:"nonWorktimeRobot",width:"md",label:"非工作时间启用机器人",fieldProps:{onChange:M("nonWorktimeRobot")}}),(0,ye.jsx)(ke.Z,{name:["defaultRobot","offlineRobot","nonWorktimeRobot"],children:function(e){var t=e.defaultRobot,n=e.offlineRobot,i=e.nonWorktimeRobot,s=!!(t||n||i);return(0,ye.jsx)(we.Z,{name:"robotUid",label:"客服机器人",width:"md",options:d.map((function(e){return{value:e.uid,label:m(e.nickname)}})),rules:[{validator:function(e,t){return s&&!t?Promise.reject(new Error("请选择客服机器人")):Promise.resolve()}}],fieldProps:{allowClear:!0,placeholder:"请选择客服机器人",onChange:function(e){null==r||r({robotUid:null!=e?e:void 0}),x()}}})}})]})})},Ze=(n(92822),n(64587)),Ce=n(91825),Re=n(69705),Fe=function(){var e=Re.Z.useForm(),t=b()(e,1)[0],n=(0,a.useIntl)(),r=(0,oe.z)((function(e){return{currentWorkgroupSettings:e.currentWorkgroupSettings,setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings}})),i=r.currentWorkgroupSettings,o=r.setCurrentWorkgroupSettings,l=(0,s.useState)(se.vXk),u=b()(l,2),d=u[0],g=u[1];(0,s.useEffect)((function(){if(i){var e=i;g(e.routingMode),t.setFieldValue("routingMode",e.routingMode)}}),[i]);return(0,ye.jsx)("div",{children:(0,ye.jsxs)(Me.A,{form:t,submitter:!1,children:[(0,ye.jsx)(Ce.Z.Group,{name:"routingMode",label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.type",defaultMessage:"Route Type"}),options:[{label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.roundRobin",defaultMessage:"Round Robin"}),value:se.vXk},{label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.leastActive",defaultMessage:"Least Active"}),value:se.ZD$},{label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.random",defaultMessage:"Random"}),value:se.owQ},{label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.weightedRandom",defaultMessage:"Weighted Random"}),value:se.e2F},{label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.consistentHash",defaultMessage:"Consistent Hash"}),value:se.zWk},{label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.fastestResponse",defaultMessage:"Fastest Response"}),value:se.HQF},{label:(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.route.recent",defaultMessage:"Recent"}),value:se.WDq}],fieldProps:{value:d,onChange:function(e){var t;!function(e){console.log("radio checked",e.target.value),g(e.target.value)}(e),t=e.target.value,i&&o(m()(m()({},i),{},{routingMode:t}))}}}),(0,ye.jsxs)(Me.A.Item,{children:[d===se.vXk&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.roundRobin.desc"})}),d===se.ZD$&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.leastActive.desc"})}),d===se.owQ&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.random.desc"})}),d===se.e2F&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.weightedRandom.desc"})}),d===se.zWk&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.consistentHash.desc"})}),d===se.HQF&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.fastestResponse.desc"})}),d===se.JEC&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.broadcast.desc"})}),d===se.WDq&&(0,ye.jsx)("p",{children:n.formatMessage({id:"workgroup.route.recent.desc"})})]})]})})},Pe=n(58791),Le=n(66441),Ae=n(50628),We=n(86702),Ee=function(e){var t=e.robotToAgentSettings,n=e.onRobotToAgentSettingsChange,r=(0,a.useIntl)(),i=Me.A.useForm(),o=b()(i,1)[0],l=(0,s.useRef)(!1),u=(0,s.useMemo)((function(){return null!=t?t:{}}),[t]),d=(0,s.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==u?void 0:u.draft)&&void 0!==t?t:null==u?void 0:u.live)&&void 0!==e?e:void 0}),[null==u?void 0:u.draft,null==u?void 0:u.live]),g=r.formatMessage({id:"robot.to.agent.manual.label.default",defaultMessage:"转人工客服"}),c=(0,s.useCallback)((function(e){return Array.from(new Set((null!=e?e:[]).map((function(e){return(null!=e?e:"").trim()})).filter((function(e){return e.length>0}))))}),[]),f=(0,s.useCallback)((function(e){e&&0!==Object.keys(e).length&&(null==n||n(e))}),[n]);(0,s.useEffect)((function(){var e,t,n,r,i,s,a,u,c;l.current=!0,o.setFieldsValue({enabled:null===(e=null==d?void 0:d.enabled)||void 0===e||e,keywordTriggerEnabled:null===(t=null==d?void 0:d.keywordTriggerEnabled)||void 0===t||t,triggerKeywords:null!==(n=null==d?void 0:d.triggerKeywords)&&void 0!==n?n:[],minConfidence:null!==(r=null==d?void 0:d.minConfidence)&&void 0!==r?r:65,maxRobotRepliesBeforeTransfer:null!==(i=null==d?void 0:d.maxRobotRepliesBeforeTransfer)&&void 0!==i?i:3,autoTransferDelaySeconds:null!==(s=null==d?void 0:d.autoTransferDelaySeconds)&&void 0!==s?s:0,cooldownSeconds:null!==(a=null==d?void 0:d.cooldownSeconds)&&void 0!==a?a:90,allowVisitorManualTransfer:null===(u=null==d?void 0:d.allowVisitorManualTransfer)||void 0===u||u,manualTransferLabel:null!==(c=null==d?void 0:d.manualTransferLabel)&&void 0!==c?c:g}),l.current=!1}),[d,o,g]);var v=(0,s.useCallback)((function(e){if(!l.current){var t=m()({},e);if("triggerKeywords"in e){var n=c(e.triggerKeywords);t.triggerKeywords=n,n.length!==(e.triggerKeywords||[]).length&&(l.current=!0,o.setFieldsValue({triggerKeywords:n}),l.current=!1)}if("manualTransferLabel"in e&&"string"==typeof e.manualTransferLabel){var r=e.manualTransferLabel.trim();t.manualTransferLabel=r,r!==e.manualTransferLabel&&(l.current=!0,o.setFieldsValue({manualTransferLabel:r}),l.current=!1)}f(t)}}),[f,o,c]),p=(0,s.useCallback)((function(e){var t=e.keys;return(0,ye.jsx)(Le.Z,{type:"generic",keys:t,live:null==u?void 0:u.live,draft:null==u?void 0:u.draft})}),[null==u?void 0:u.draft,null==u?void 0:u.live]);return(0,ye.jsxs)(Me.A,{layout:"vertical",form:o,submitter:!1,style:{marginLeft:"20px",maxWidth:640},onValuesChange:v,children:[(0,ye.jsx)(Ae.Z,{width:"md",name:"enabled",label:(0,ye.jsxs)("span",{children:[r.formatMessage({id:"robot.to.agent.enabled",defaultMessage:"启用机器人转人工策略"}),(0,ye.jsx)(p,{keys:["enabled"]})]})}),(0,ye.jsx)(ke.Z,{name:["enabled"],children:function(e){var t=!1===e.enabled;return(0,ye.jsxs)(ye.Fragment,{children:[(0,ye.jsx)(Ae.Z,{width:"md",name:"keywordTriggerEnabled",label:(0,ye.jsxs)("span",{children:[r.formatMessage({id:"robot.to.agent.keyword.trigger",defaultMessage:"允许关键词触发"}),(0,ye.jsx)(p,{keys:["keywordTriggerEnabled"]})]}),tooltip:r.formatMessage({id:"robot.to.agent.keyword.trigger.tip",defaultMessage:"访客发送关键词时立即转人工"}),fieldProps:{disabled:t}}),(0,ye.jsx)(we.Z,{width:"lg",name:"triggerKeywords",label:(0,ye.jsxs)("span",{children:[r.formatMessage({id:"robot.to.agent.keywords",defaultMessage:"转人工关键词"}),(0,ye.jsx)(p,{keys:["triggerKeywords"]})]}),fieldProps:{mode:"tags",tokenSeparators:[",","，"," ",";","；","\n"],disabled:t||!1===o.getFieldValue("keywordTriggerEnabled"),placeholder:r.formatMessage({id:"robot.to.agent.keywords.placeholder",defaultMessage:"输入关键词并回车确认，可粘贴多个"})},extra:r.formatMessage({id:"robot.to.agent.keywords.extra",defaultMessage:"直接输入关键词，然后回车确认，可设置多个关键词"})}),(0,ye.jsx)(Ae.Z,{width:"md",name:"allowVisitorManualTransfer",label:(0,ye.jsxs)("span",{children:[r.formatMessage({id:"robot.to.agent.manual.transfer",defaultMessage:"允许访客手动转人工"}),(0,ye.jsx)(p,{keys:["allowVisitorManualTransfer"]})]}),fieldProps:{disabled:t}}),(0,ye.jsx)(ke.Z,{name:["allowVisitorManualTransfer"],children:function(e){return!1!==e.allowVisitorManualTransfer?(0,ye.jsx)(We.Z,{width:"lg",name:"manualTransferLabel",label:(0,ye.jsxs)("span",{children:[r.formatMessage({id:"robot.to.agent.manual.label",defaultMessage:"手动转人工按钮文案"}),(0,ye.jsx)(p,{keys:["manualTransferLabel"]})]}),fieldProps:{maxLength:20,disabled:t},placeholder:r.formatMessage({id:"robot.to.agent.manual.label.placeholder",defaultMessage:"如：转人工客服"})}):null}})]})}})]})},Ue=(n(92029),n(58620)),Oe=n(85977),qe="tips",Ie=function(){var e,t,n,r,l,d,c,v,p=(0,a.useIntl)(),W=(0,a.useAccess)(),E=(0,ne.u)((function(e){return e.currentOrg})),U=(0,re.Z)().leftSiderStyle,O=(0,ie.Z)().isDarkMode,K=(0,s.useState)(!1),D=b()(K,2),se=D[0],pe=D[1],be=(0,s.useState)([]),he=b()(be,2),xe=he[0],Me=he[1],Se=(0,s.useState)(),ke=b()(Se,2),we=ke[0],Ce=ke[1],Re=(0,s.useState)(""),Le=b()(Re,2),Ae=Le[0],We=Le[1],Ie=(0,s.useState)(qe),Ve=b()(Ie,2),ze=Ve[0],Ne=Ve[1],Ke=(0,s.useState)(!1),De=b()(Ke,2),Je=De[0],Be=De[1],He=(0,s.useState)(null),Qe=b()(He,2),Ge=Qe[0],Ye=Qe[1],_e=(0,s.useState)(!1),Xe=b()(_e,2),$e=Xe[0],et=Xe[1],tt=(0,s.useMemo)((function(){return xe.find((function(e){return e.uid===we}))||null}),[xe,we]),nt=(0,s.useState)(!1),rt=b()(nt,2),it=rt[0],st=rt[1],ot=(0,s.useState)(!1),at=b()(ot,2),lt=at[0],ut=at[1],dt=(0,s.useState)(!1),gt=b()(dt,2),ct=gt[0],ft=gt[1],vt=(0,s.useRef)(""),mt=(0,oe.z)((function(e){return{setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings,currentWorkgroupSettings:e.currentWorkgroupSettings}})),pt=mt.setCurrentWorkgroupSettings,bt=mt.currentWorkgroupSettings,ht=(0,s.useMemo)((function(){var e;return null!==(e=null!=bt?bt:tt)&&void 0!==e?e:null}),[bt,tt]),xt=(0,s.useMemo)((function(){var e;return null==W||null===(e=W.getModulePermission)||void 0===e?void 0:e.call(W,Oe.MY.WORKGROUP_SETTINGS)}),[W]),Mt=null!==(e=null==xt||null===(t=xt.canRead)||void 0===t?void 0:t.call(xt))&&void 0!==e&&e,St=null!==(n=null==xt||null===(r=xt.canCreate)||void 0===r?void 0:r.call(xt))&&void 0!==n&&n,kt=null!==(l=null==xt||null===(d=xt.canUpdate)||void 0===d?void 0:d.call(xt))&&void 0!==l&&l,wt=null!==(c=null==xt||null===(v=xt.canDelete)||void 0===v?void 0:v.call(xt))&&void 0!==c&&c,jt=(0,s.useRef)(!1),yt=(0,s.useCallback)((function(e,t){ee.yw.warning(p.formatMessage({id:e,defaultMessage:t}))}),[p]),Tt=(0,s.useCallback)((function(e){if(bt){var t=bt.draftServiceSettings||bt.serviceSettings||{};pt(m()(m()({},bt),{},{draftServiceSettings:m()(m()({},t),e)}))}}),[bt,pt]),Zt=(0,s.useCallback)((function(e){if(bt){var t=bt.draftTriggerSettings||bt.triggerSettings||{};pt(m()(m()({},bt),{},{draftTriggerSettings:m()(m()({},t),e)}))}}),[bt,pt]),Ct=(0,s.useCallback)((function(e){if(bt){var t=bt.draftInviteSettings||bt.inviteSettings||{};pt(m()(m()({},bt),{},{draftInviteSettings:m()(m()({},t),e)}))}}),[bt,pt]),Rt=(0,s.useCallback)((function(e){if(bt){var t=bt.draftIntentionSettings||bt.intentionSettings||{};pt(m()(m()({},bt),{},{draftIntentionSettings:m()(m()({},t),e)}))}}),[bt,pt]),Ft=(0,s.useCallback)((function(e){if(bt){var t=bt.draftEmotionSettings||bt.emotionSettings||{};pt(m()(m()({},bt),{},{draftEmotionSettings:m()(m()({},t),e)}))}}),[bt,pt]),Pt=((0,s.useCallback)((function(e){if(bt){var t=bt.draftSummarySettings||bt.summarySettings||{};pt(m()(m()({},bt),{},{draftSummarySettings:m()(m()({},t),e)}))}}),[bt,pt]),(0,s.useCallback)((function(e){if(bt){var t=bt.draftMessageLeaveSettings||bt.messageLeaveSettings||{};pt(m()(m()({},bt),{},{draftMessageLeaveSettings:m()(m()({},t),e)}))}}),[bt,pt])),Lt=(0,s.useCallback)((function(e){if(bt){var t=bt.draftWorktimeSettings||bt.worktimeSettings||{};pt(m()(m()({},bt),{},{draftWorktimeSettings:m()(m()({},t),e)}))}}),[bt,pt]),At=(0,s.useCallback)((function(e){if(bt){var t=bt.draftRobotRoutingSettings||bt.robotRoutingSettings||{};pt(m()(m()({},bt),{},{draftRobotRoutingSettings:m()(m()({},t),e)}))}}),[bt,pt]),Wt=(0,s.useCallback)((function(e){if(bt){var t=bt.draftQueueSettings||bt.queueSettings||{};pt(m()(m()({},bt),{},{draftQueueSettings:m()(m()({},t),e)}))}}),[bt,pt]),Et=(0,s.useCallback)((function(e){if(bt){var t=bt.draftRobotToAgentSettings||bt.robotToAgentSettings||{};pt(m()(m()({},bt),{},{draftRobotToAgentSettings:m()(m()({},t),e)}))}}),[bt,pt]),Ut=(0,s.useMemo)((function(){if(!Ae)return xe;var e=Ae.toLowerCase();return xe.filter((function(t){var n=(t.name||t.uid||"").toLowerCase(),r=(t.description||"").toLowerCase();return n.includes(e)||r.includes(e)}))}),[xe,Ae]),Ot=(0,s.useCallback)(function(){var e=f()(g()().mark((function e(t,n){var r,i,s,o,a;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=E&&E.uid){e.next=2;break}return e.abrupt("return");case 2:if(Mt){e.next=10;break}return jt.current||(jt.current=!0,yt("settings.no.permission.read","没有查看权限")),Me([]),Ce(void 0),pt(null),vt.current=JSON.stringify({}),ft(!1),e.abrupt("return");case 10:return pe(!0),e.prev=11,i=(null!=t?t:"").trim(),s={orgUid:E.uid,pageNumber:0,pageSize:100,searchText:i||void 0},e.next=16,(0,te.zc)(s);case 16:o=e.sent,je.Z.debug("加载工作组配置模板列表: ",null==o?void 0:o.data,s),a=(null==o||null===(r=o.data)||void 0===r?void 0:r.content)||[],Me(a),!(a.length>0)||we&&a.some((function(e){return e.uid===we}))||(Ce(a[0].uid),null!=n&&n.keepActive||Ne(qe));case 21:return e.prev=21,pe(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[11,,21,24]])})));return function(t,n){return e.apply(this,arguments)}}(),[Mt,null==E?void 0:E.uid,we,pt,yt]),qt=(0,s.useCallback)((function(e){Ot(null!=e?e:Ae)}),[Ot,Ae]);(0,s.useEffect)((function(){Ot(Ae)}),[null==E?void 0:E.uid]),(0,s.useEffect)((function(){tt?(pt(tt),vt.current=JSON.stringify(null!=tt?tt:{}),ft(!1)):(pt(null),vt.current=JSON.stringify({}),ft(!1))}),[tt]),(0,s.useEffect)((function(){if(tt)try{var e=JSON.stringify(null!=bt?bt:{});ft(e!==vt.current)}catch(e){ft(!0)}}),[bt,null==tt?void 0:tt.uid]);var It=function(){var e=f()(g()().mark((function e(t){var n,r,i;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(wt){e.next=3;break}return yt("settings.no.permission.delete","没有删除权限"),e.abrupt("return");case 3:if(null!=(n=null!=t?t:tt)&&n.uid){e.next=6;break}return e.abrupt("return");case 6:return r={uid:n.uid,orgUid:null==E?void 0:E.uid,pageNumber:0,pageSize:100},e.next=9,(0,te.zN)(r);case 9:(i=e.sent)&&200===i.code?(ee.yw.success(p.formatMessage({id:"common.deleted",defaultMessage:"删除成功"})),Ot(Ae)):ee.yw.error((null==i?void 0:i.message)||p.formatMessage({id:"delete.error",defaultMessage:"删除失败"}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vt=function(){var e=f()(g()().mark((function e(t,n){var r;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kt){e.next=3;break}return yt("settings.no.permission.update","没有更新权限"),e.abrupt("return");case 3:return e.prev=3,e.next=6,(0,te.Y2)({uid:t,orgUid:null==E?void 0:E.uid,enabled:n});case 6:(r=e.sent)&&200===r.code?(ee.yw.success(p.formatMessage({id:n?"common.enabled":"common.disabled",defaultMessage:n?"已启用":"已停用"})),Ot(Ae)):ee.yw.error((null==r?void 0:r.message)||p.formatMessage({id:"operation.failed",defaultMessage:"操作失败"})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("切换启用状态失败:",e.t0),ee.yw.error(p.formatMessage({id:"operation.failed",defaultMessage:"操作失败"}));case 14:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),zt=function(e,t){if(e){var n={};return t.forEach((function(t){void 0!==e[t]&&(n[t]=e[t])})),n}},Nt=function(e){return!e||"object"!==u()(e)||0===Object.keys(e).length},Kt=function(e){if(e){var t=zt(e,["language","autoPopup","showTopTip","topTip","topTipStart","topTipEnd","showRateBtn","autoInviteRate","inviteRateTip","rateMsgCount","showPreForm","preFormRequired","preForm","inputAssociationEnabled","inputPreviewEnabled","showHistory","showInputAssociation","showCaptcha","welcomeTip","welcomeFaqUids","welcomeKbUid","enableWorkflow","workflowUid","autoCloseMin","autoCloseTip","agentCloseTip","queueTip","leavemsgTip","showRightIframe","rightIframeUrl","showFaqs","faqUids","faqKbUid","showQuickButtons","quickButtonUids","showGuessFaqs","guessFaqUids","showHotFaqs","hotFaqUids","showShortcutFaqs","shortcutFaqUids","relatedQuestionGuide","showLogo","validateUntil","inputAssociationKbUid"]),n=function(e){if(e)return zt(e,["smile","image","file","rate","leavemsg","orderSelector","ticket","audio","video","tel","order"])}(e.toolbar);return m()(m()({},t),n?{toolbar:n}:{})}},Dt=function(e){if(e){var t=null==e?void 0:e.triggers;return Array.isArray(t)?{uid:null==e?void 0:e.uid,triggers:t.map((function(e){return{uid:null==e?void 0:e.uid,triggerKey:null==e?void 0:e.triggerKey,enabled:null==e?void 0:e.enabled,type:null==e?void 0:e.type,name:null==e?void 0:e.name,description:null==e?void 0:e.description,config:null==e?void 0:e.config}}))}:zt(e,["uid"])}},Jt=function(e){if(e)return zt(e,["name","description","defaultTemplate","show","text","icon","delay","loop","loopDelay","loopCount","messageList","targetedInvite","targetedInviteUrls","smartTrigger","pageStayTriggerSeconds","scrollTrigger","scrollTriggerPerceninviteSettinge","exitIntentTrigger","referrerTrigger","referrerPatterns","deviceTypes","visitorSegmentation","newVisitorMessage","returningVisitorMessage","vipVisitorMessage","inviteStyle","inviteAnimation","abTesting"])},Bt=function(e){if(e)return zt(e,["name","description","color","order","robotUid","enabled","executionTiming","triggerScope","triggerEveryNMessages","triggerCooldownSeconds","triggerCooldownOnly"])},Ht=function(e){if(e)return zt(e,["name","description","robotUid","enabled","executionTiming","triggerScope","triggerEveryNMessages","triggerCooldownSeconds","triggerCooldownOnly"])},Qt=function(e){if(e)return zt(e,["name","description","defaultTemplate","robotUid","enabled","executionTiming","triggerScope","triggerEveryNMessages","triggerCooldownSeconds","triggerCooldownOnly"])},Gt=function(e){if(e)return zt(e,["messageLeaveEnabled","messageLeaveTip","messageLeaveAgentUid","messageLeaveNotify","messageLeaveNotifyType","messageLeaveNotifyEmail","messageLeaveNotifyMobile","messageLeaveForm"])},Yt=function(e){if(e)return zt(e,["queueRobot","showQueuePosition","showEstimatedWaitTime","avgWaitTimePerPerson","maxWaiting","maxWaitTime","queueTip","queueReadyTip","queueNoticeBatchWindowMs"])},_t=function(e){if(e){var t=zt(e,["enabled","keywordTriggerEnabled","triggerKeywords","minConfidence","maxRobotRepliesBeforeTransfer","autoTransferDelaySeconds","cooldownSeconds","allowVisitorManualTransfer","manualTransferLabel"]),n=m()({},t);return Array.isArray(n.triggerKeywords)&&(n.triggerKeywords=Array.from(new Set(n.triggerKeywords.map((function(e){return(e||"").trim()})).filter((function(e){return e.length>0}))))),"string"==typeof n.manualTransferLabel&&(n.manualTransferLabel=n.manualTransferLabel.trim()),n}},Xt=function(e){var t,n;if(e){var r=zt(e,["defaultRobot","offlineRobot","nonWorktimeRobot"]),i=null!==(t=e.robotUid)&&void 0!==t?t:null===(n=e.robot)||void 0===n?void 0:n.uid;return m()(m()({},r),i?{robotUid:i}:{})}},$t=function(e){if(e)return zt(e,["enabled","regularWorktimes","specialWorktimes","holidays"])},en=function(){var e=f()(g()().mark((function e(){var t,n,r,i,s,o,a,l,u,d,c,f,v,b,h,x,M;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kt){e.next=3;break}return yt("settings.no.permission.update","没有更新权限"),e.abrupt("return");case 3:if(null!=tt&&tt.uid){e.next=6;break}return ee.yw.warning(p.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})),e.abrupt("return");case 6:return st(!0),e.prev=7,t=bt&&bt.uid===tt.uid?bt:tt,r=Kt((n=function(e,t){return m()(m()({},e||{}),t||{})})(null==t?void 0:t.serviceSettings,null==t?void 0:t.draftServiceSettings)),i=Dt(n(null==t?void 0:t.triggerSettings,null==t?void 0:t.draftTriggerSettings)),s=Jt(n(null==t?void 0:t.inviteSettings,null==t?void 0:t.draftInviteSettings)),o=Bt(n(null==t?void 0:t.intentionSettings,null==t?void 0:t.draftIntentionSettings)),a=Ht(n(null==t?void 0:t.emotionSettings,null==t?void 0:t.draftEmotionSettings)),l=Qt(n(null==t?void 0:t.summarySettings,null==t?void 0:t.draftSummarySettings)),u=Gt(n(null==t?void 0:t.messageLeaveSettings,null==t?void 0:t.draftMessageLeaveSettings)),d=$t(n(null==t?void 0:t.worktimeSettings,null==t?void 0:t.draftWorktimeSettings)),c=Xt(n(null==t?void 0:t.robotRoutingSettings,null==t?void 0:t.draftRobotRoutingSettings)),f=Yt(n(null==t?void 0:t.queueSettings,null==t?void 0:t.draftQueueSettings)),v=_t(n(null==t?void 0:t.robotToAgentSettings,null==t?void 0:t.draftRobotToAgentSettings)),b=m()(m()(m()(m()(m()(m()(m()(m()(m()(m()(m()({uid:tt.uid,orgUid:null==E?void 0:E.uid,name:null==t?void 0:t.name,description:null==t?void 0:t.description,isDefault:null==t?void 0:t.isDefault,enabled:null==t?void 0:t.enabled,routingMode:null==t?void 0:t.routingMode},Nt(r)?{}:{serviceSettings:r}),Nt(i)?{}:{triggerSettings:i}),Nt(s)?{}:{inviteSettings:s}),Nt(o)?{}:{intentionSettings:o}),Nt(a)?{}:{emotionSettings:a}),Nt(l)?{}:{summarySettings:l}),Nt(u)?{}:{messageLeaveSettings:u}),Nt(d)?{}:{worktimeSettings:d}),Nt(c)?{}:{robotRoutingSettings:c}),Nt(f)?{}:{queueSettings:f}),Nt(v)?{}:{robotToAgentSettings:v}),e.next=24,(0,te.Y2)(b);case 24:h=e.sent,console.log("保存工作组配置模板: ",h,b),h&&200===h.code?(ee.yw.success(p.formatMessage({id:"common.saved",defaultMessage:"保存成功"})),vt.current=JSON.stringify(null!==(x=null!==(M=null==h?void 0:h.data)&&void 0!==M?M:t)&&void 0!==x?x:{}),ft(!1),Ot(Ae,{keepActive:!0})):ee.yw.error((null==h?void 0:h.message)||p.formatMessage({id:"save.failed",defaultMessage:"保存失败"})),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(7),console.error("保存失败:",e.t0),ee.yw.error(p.formatMessage({id:"save.failed",defaultMessage:"保存失败"}));case 33:return e.prev=33,st(!1),e.finish(33);case 36:case"end":return e.stop()}}),e,null,[[7,29,33,36]])})));return function(){return e.apply(this,arguments)}}(),tn=function(){var e=f()(g()().mark((function e(){var t,n,r;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kt){e.next=3;break}return yt("settings.no.permission.publish","没有发布权限"),e.abrupt("return");case 3:if(null!=tt&&tt.uid){e.next=6;break}return ee.yw.warning(p.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})),e.abrupt("return");case 6:if(ut(!0),e.prev=7,!ct){e.next=11;break}return e.next=11,en();case 11:return t={uid:tt.uid,orgUid:null==E?void 0:E.uid},e.next=14,(0,te.Dm)(t);case 14:(n=e.sent)&&200===n.code?(ee.yw.success(p.formatMessage({id:"common.published",defaultMessage:"发布成功"})),vt.current=JSON.stringify(null!==(r=null==n?void 0:n.data)&&void 0!==r?r:{}),ft(!1),Ot(Ae)):ee.yw.error((null==n?void 0:n.message)||p.formatMessage({id:"publish.failed",defaultMessage:"发布失败"})),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),console.error("发布失败:",e.t0),ee.yw.error(p.formatMessage({id:"publish.failed",defaultMessage:"发布失败"}));case 22:return e.prev=22,ut(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[7,18,22,25]])})));return function(){return e.apply(this,arguments)}}(),nn=(0,s.useMemo)((function(){return null!=tt&&tt.uid?[{key:"tips",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(R.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.settings.service.tips",defaultMessage:"提示信息"})]}),children:(0,ye.jsx)(ce.Z,{variant:"workgroup",serviceSettings:{live:null==ht?void 0:ht.serviceSettings,draft:null==ht?void 0:ht.draftServiceSettings},onServiceSettingsChange:Tt})},{key:"service",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(F.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.settings.service",defaultMessage:"服务设置"})]}),children:(0,ye.jsx)(ge.Z,{variant:"workgroup",serviceSettings:{live:null==ht?void 0:ht.serviceSettings,draft:null==ht?void 0:ht.draftServiceSettings},onServiceSettingsChange:Tt})}].concat(i()((0,Ue.OJ)()?[{key:"inputAssociation",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(P.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.settings.input.association",defaultMessage:"输入联想"})]}),children:(0,ye.jsx)(ae.Z,{variant:"workgroup",serviceSettings:{live:null==ht?void 0:ht.serviceSettings,draft:null==ht?void 0:ht.draftServiceSettings},onServiceSettingsChange:Tt})}]:[]),i()((0,Ue.OJ)()?[{key:"rate",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(L.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"rate",defaultMessage:"Rate"})]}),children:(0,ye.jsx)(me.Z,{variant:"workgroup",serviceSettings:{live:null==ht?void 0:ht.serviceSettings,draft:null==ht?void 0:ht.draftServiceSettings},onServiceSettingsChange:Tt})}]:[]),[{key:"robot",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(A.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"robot",defaultMessage:"Robot"})]}),children:(0,ye.jsx)(Te,{variant:"workgroup",robotRoutingSettings:{live:null==ht?void 0:ht.robotRoutingSettings,draft:null==ht?void 0:ht.draftRobotRoutingSettings},onRobotRoutingSettingsChange:At})}],i()([]),i()((0,Ue.OJ)()?[{key:"robotToAgent",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(q,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"robotToAgent",defaultMessage:"Robot to Agent"})]}),children:(0,ye.jsx)(Ee,{variant:"workgroup",robotToAgentSettings:{live:null==ht?void 0:ht.robotToAgentSettings,draft:null==ht?void 0:ht.draftRobotToAgentSettings},onRobotToAgentSettingsChange:Et})}]:[]),i()((0,Ue.OJ)()?[{key:"messageLeave",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(I.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.settings.message.leave",defaultMessage:"Leave Message"})]}),children:(0,ye.jsx)(fe.Z,{variant:"workgroup",messageLeaveSettings:{live:null==ht?void 0:ht.messageLeaveSettings,draft:null==ht?void 0:ht.draftMessageLeaveSettings},onMessageLeaveSettingsChange:Pt})}]:[]),i()((0,Ue.OJ)()?[{key:"queue",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(Pe.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"workgroup.settings.queue",defaultMessage:"排队设置"})]}),children:(0,ye.jsx)(Ze.Z,{variant:"workgroup",queueSettings:{live:null==ht?void 0:ht.queueSettings,draft:null==ht?void 0:ht.draftQueueSettings},onQueueSettingsChange:Wt})}]:[]),i()([]),i()((0,Ue.OJ)()?[{key:"toolbar",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(V.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"toolbar",defaultMessage:"Toolbar"})]}),children:(0,ye.jsx)(de.Z,{variant:"workgroup",serviceSettings:{live:null==ht?void 0:ht.serviceSettings,draft:null==ht?void 0:ht.draftServiceSettings},settingsUid:tt.uid,isActive:"toolbar"===ze,onServiceSettingsChange:Tt})}]:[]),i()((0,Ue.OJ)()?[{key:"right",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(z.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"right",defaultMessage:"Right"})]}),children:(0,ye.jsx)(le.Z,{variant:"workgroup",serviceSettings:{live:null==ht?void 0:ht.serviceSettings,draft:null==ht?void 0:ht.draftServiceSettings},onServiceSettingsChange:Tt,settingsUid:tt.uid,isActive:"right"===ze})}]:[]),i()((0,Ue.OJ)()?[{key:"trigger",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(N.Z,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"trigger",defaultMessage:"Trigger"})]}),children:(0,ye.jsx)(ue.Z,{variant:"workgroup",triggerSettings:{live:null==ht?void 0:ht.triggerSettings,draft:null==ht?void 0:ht.draftTriggerSettings},onTriggerSettingsChange:Zt})}]:[]),[{key:"route",label:(0,ye.jsxs)("span",{children:[(0,ye.jsx)(J,{})," ",(0,ye.jsx)(a.FormattedMessage,{id:"pages.workgroup.tab.route",defaultMessage:"Route"})]}),children:(0,ye.jsx)(Fe,{})}],i()([])):[]}),[null==tt?void 0:tt.uid,ht,p,Tt,Zt,Ct,Pt,Rt,Ft,At,Et,Lt,Wt,ze]);return(0,ye.jsxs)(ye.Fragment,{children:[(0,ye.jsxs)(h.Z,{style:{minHeight:"calc(100vh - 160px)"},children:[(0,ye.jsx)(h.Z.Panel,{defaultSize:"20%",min:"14%",max:"40%",style:U,children:(0,ye.jsxs)($.Z,{title:p.formatMessage({id:"workgroup.settings.templates",defaultMessage:"模板列表"}),extra:St?(0,ye.jsx)(x.ZP,{size:"small",icon:(0,ye.jsx)(B.Z,{}),type:"primary",onClick:function(){St?(Ye(null),Be(!0)):yt("settings.no.permission.create","没有新建权限")},children:(0,ye.jsx)(a.FormattedMessage,{id:"common.new",defaultMessage:"新建"})}):null,bodyStyle:{padding:8},loading:se,children:[(0,ye.jsx)("div",{style:{margin:"0 0 8px 0"},children:(0,ye.jsxs)(M.Z.Compact,{style:{width:"100%"},children:[(0,ye.jsx)(S.Z,{placeholder:p.formatMessage({id:"workgroup.settings.template.search",defaultMessage:"搜索模板名称"}),value:Ae,onChange:function(e){return We(e.target.value)},onPressEnter:function(e){e.preventDefault();var t=e.currentTarget.value;We(t),qt(t)},allowClear:!0,size:"middle"}),(0,ye.jsx)(x.ZP,{type:"primary",icon:(0,ye.jsx)(P.Z,{}),"aria-label":p.formatMessage({id:"common.search",defaultMessage:"搜索"}),onClick:function(){return qt()}})]})}),(0,ye.jsx)("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 280px)"},children:(0,ye.jsx)(k.Z,{dataSource:Ut,locale:{emptyText:(0,ye.jsx)(w.Z,{description:p.formatMessage({id:"empty",defaultMessage:"暂无数据"}),image:w.Z.PRESENTED_IMAGE_SIMPLE})},renderItem:function(e){return(0,ye.jsx)(k.Z.Item,{style:we===e.uid?{backgroundColor:O?"#333333":"#dddddd",cursor:"pointer",borderRadius:6,marginBottom:8,padding:10}:{cursor:"pointer",borderRadius:6,marginBottom:8,padding:10},onClick:function(){return Ce(e.uid)},children:(0,ye.jsx)(k.Z.Item.Meta,{title:(0,ye.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ye.jsx)("div",{style:{fontWeight:500,flex:1},children:e.name||e.uid}),(0,ye.jsx)(M.Z,{size:4,children:e.isDefault?(0,ye.jsx)(j.Z,{color:"blue",children:(0,ye.jsx)(a.FormattedMessage,{id:"pages.common.default",defaultMessage:"默认"})}):null})]}),description:e.description?(0,ye.jsx)("div",{style:{color:O?"#aaa":"#999",fontSize:12},children:e.description}):null})},e.uid)}})})]})}),(0,ye.jsx)(h.Z.Panel,{children:tt?(0,ye.jsx)($.Z,{title:(0,ye.jsxs)(M.Z,{children:[(0,ye.jsxs)("span",{children:[p.formatMessage({id:"workgroup.settings.editing",defaultMessage:"编辑模板"}),": ",tt.name||tt.uid]}),(0,ye.jsx)(y.Z,{checked:!!tt.enabled,onChange:function(e){return Vt(tt.uid,e)},checkedChildren:p.formatMessage({id:"common.enabled",defaultMessage:"启用"}),unCheckedChildren:p.formatMessage({id:"common.disabled",defaultMessage:"停用"}),disabled:!kt}),kt?(0,ye.jsx)(x.ZP,{size:"small",icon:(0,ye.jsx)(H.Z,{}),onClick:function(e){var t;e.stopPropagation(),t=tt,kt?(Ye(null!=t?t:tt),Be(!0)):yt("settings.no.permission.update","没有更新权限")},children:(0,ye.jsx)(a.FormattedMessage,{id:"pages.common.edit",defaultMessage:"编辑"})}):null,wt?(0,ye.jsx)(T.Z,{title:p.formatMessage({id:"common.delete.confirm",defaultMessage:"确定要删除吗?"}),onConfirm:function(e){null==e||e.stopPropagation(),It(tt)},onCancel:function(e){return null==e?void 0:e.stopPropagation()},okText:p.formatMessage({id:"common.confirm",defaultMessage:"确定"}),cancelText:p.formatMessage({id:"common.cancel",defaultMessage:"取消"}),children:(0,ye.jsx)(x.ZP,{size:"small",danger:!0,icon:(0,ye.jsx)(Q.Z,{}),onClick:function(e){e.stopPropagation()},children:(0,ye.jsx)(a.FormattedMessage,{id:"pages.common.delete",defaultMessage:"删除"})})}):null,tt.isDefault?(0,ye.jsx)(j.Z,{color:"blue",children:(0,ye.jsx)(a.FormattedMessage,{id:"pages.common.default",defaultMessage:"默认"})}):null]}),extra:(0,ye.jsxs)(M.Z,{children:[(0,ye.jsx)(T.Z,{title:p.formatMessage({id:"settings.publish.online.title",defaultMessage:"发布到线上环境"}),description:p.formatMessage({id:"settings.publish.online.desc",defaultMessage:"只有发布之后，才会应用到线上环境"}),okText:p.formatMessage({id:"settings.publish.online.ok",defaultMessage:"继续发布"}),cancelText:p.formatMessage({id:"common.cancel",defaultMessage:"取消"}),onConfirm:function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),tn()},onCancel:function(e){var t;return null==e||null===(t=e.stopPropagation)||void 0===t?void 0:t.call(e)},children:(0,ye.jsx)(x.ZP,{onClick:function(e){return e.stopPropagation()},loading:lt,type:"default",icon:(0,ye.jsx)(G.Z,{}),disabled:!kt,children:(0,ye.jsx)(a.FormattedMessage,{id:"common.publish",defaultMessage:"发布"})})}),(0,ye.jsx)(x.ZP,{onClick:function(e){e.stopPropagation(),et(!0)},type:"default",icon:(0,ye.jsx)(Y.Z,{}),disabled:!kt,children:(0,ye.jsx)(a.FormattedMessage,{id:"settings.gray.publish",defaultMessage:"灰度发布"})}),(0,ye.jsx)(x.ZP,{onClick:function(){tt&&(pt(tt),vt.current=JSON.stringify(null!=tt?tt:{}),ft(!1))},disabled:!ct||!kt,icon:(0,ye.jsx)(_.Z,{}),children:(0,ye.jsx)(a.FormattedMessage,{id:"common.reset",defaultMessage:"重置"})}),(0,ye.jsx)(x.ZP,{type:"primary",loading:it,onClick:en,disabled:!ct||!kt,icon:(0,ye.jsx)(X.Z,{}),children:(0,ye.jsx)(a.FormattedMessage,{id:"common.save",defaultMessage:"保存"})})]}),children:(0,ye.jsx)(o.Z,{activeKey:ze,onChange:Ne,items:nn})}):(0,ye.jsx)($.Z,{children:(0,ye.jsx)(w.Z,{description:p.formatMessage({id:"workgroup.settings.template.select",defaultMessage:"请从左侧选择模板"})})})})]}),(0,ye.jsx)(ve.Z,{open:Je,onOpenChange:Be,orgUid:(null==E?void 0:E.uid)||"",record:Ge,onSuccess:function(){Be(!1),Ot(Ae)}}),(0,ye.jsxs)(Z.Z,{title:p.formatMessage({id:"settings.gray.publish.title",defaultMessage:"灰度发布说明"}),open:$e,onCancel:function(){return et(!1)},footer:[(0,ye.jsx)(x.ZP,{onClick:function(){return et(!1)},children:(0,ye.jsx)(a.FormattedMessage,{id:"common.close",defaultMessage:"关闭"})},"close"),(0,ye.jsx)(x.ZP,{type:"primary",onClick:function(){et(!1),a.history.push("/service/channel")},children:(0,ye.jsx)(a.FormattedMessage,{id:"settings.gray.publish.go.channel",defaultMessage:"前往渠道页面获取链接"})},"go")],children:[(0,ye.jsx)(C.Z.Paragraph,{children:(0,ye.jsx)(a.FormattedMessage,{id:"settings.gray.publish.p1",defaultMessage:"灰度发布用于测试当前草稿（draft）配置，点击保存，但未点击发布，不会影响线上环境。"})}),(0,ye.jsx)(C.Z.Paragraph,{children:(0,ye.jsx)(a.FormattedMessage,{id:"settings.gray.publish.p2",defaultMessage:"在渠道页面生成链接时勾选“灰度测试”，链接会追加 {draft1}；嵌入式脚本会在 {chatConfig} 中增加 {draftTrue}。",values:{draft1:(0,ye.jsx)(C.Z.Text,{code:!0,children:"draft=1"}),chatConfig:(0,ye.jsx)(C.Z.Text,{code:!0,children:"chatConfig"}),draftTrue:(0,ye.jsx)(C.Z.Text,{code:!0,children:"draft: true"})}})})]})]})},Ve=n(65669),ze=function(){var e,t,n,r,s,l,u=(0,a.useAccess)(),d=null!==(e=null==u||null===(t=u.hasAnyModulePermission)||void 0===t?void 0:t.call(u,Oe.MY.WORKGROUP))&&void 0!==e&&e,g=null!==(n=null==u||null===(r=u.hasAnyModulePermission)||void 0===r?void 0:r.call(u,Oe.MY.WORKGROUP_SETTINGS))&&void 0!==n&&n,c=[].concat(i()(d?[{key:"table",label:(0,ye.jsx)(a.FormattedMessage,{id:"menu.workgroup.table",defaultMessage:"Workgroup"}),children:(0,ye.jsx)(Ve.Z,{})}]:[]),i()(g?[{key:"settings",label:(0,ye.jsx)(a.FormattedMessage,{id:"menu.workgroup.settings",defaultMessage:"Workgroup Settings"}),children:(0,ye.jsx)(Ie,{})}]:[]));if(0===c.length)return null;var f=String(null!==(s=null===(l=c[0])||void 0===l?void 0:l.key)&&void 0!==s?s:"table");return(0,ye.jsx)(o.Z,{defaultActiveKey:f,style:{padding:"10px"},items:c})}}}]);