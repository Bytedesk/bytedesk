"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4693],{17455:function(e,t,r){var a=r(80627),s=r(93683),n=r(68422),i=r(44194),o=r(84729),d=r(69983),u=r(31549),l=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],g=function(e,t){var r=e.fieldProps,c=e.children,g=e.params,p=e.proFieldProps,f=e.mode,m=e.valueEnum,h=e.request,x=e.showSearch,M=e.options,v=(0,s.Z)(e,l),y=(0,i.useContext)(o.Z);return(0,u.jsx)(d.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(m),request:h,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:M,mode:f,showSearch:x,getPopupContainer:y.getPopupContainer},r),ref:t,proFieldProps:p},v),{},{children:c}))},p=i.forwardRef((function(e,t){var r=e.fieldProps,l=e.children,g=e.params,p=e.proFieldProps,f=e.mode,m=e.valueEnum,h=e.request,x=e.options,M=(0,s.Z)(e,c),v=(0,a.Z)({options:x,mode:f||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),y=(0,i.useContext)(o.Z);return(0,u.jsx)(d.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(m),request:h,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:y.getPopupContainer},v),ref:t,proFieldProps:p},M),{},{children:l}))})),f=i.forwardRef(g);f.SearchSelect=p,f.displayName="ProFormComponent",t.Z=f},74056:function(e,t,r){var a=r(80627),s=r(93683),n=r(44194),i=r(69983),o=r(31549),d=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],u=n.forwardRef((function(e,t){var r=e.fieldProps,n=e.unCheckedChildren,u=e.checkedChildren,l=e.proFieldProps,c=(0,s.Z)(e,d);return(0,o.jsx)(i.Z,(0,a.Z)({valueType:"switch",fieldProps:(0,a.Z)({unCheckedChildren:n,checkedChildren:u},r),ref:t,valuePropName:"checked",proFieldProps:l,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},c))}));t.Z=u},84362:function(e,t,r){r.r(t),r.d(t,{default:function(){return xe}});var a=r(51167),s=r(9592),n=r(8527),i=r(10820),o=r(73193),d=r.n(o),u=r(84176),l=r.n(u),c=r(90819),g=r.n(c),p=r(89933),f=r.n(p),m=r(45332),h=r.n(m),x=r(50884),M=r(54148),v=r(65468),y=r(6992),b=r(28031),w=r(77601),k=r(64724),j=r(46206),S=r(38623),Z=r(30235),I=r(70937),C=r(90883),F=r(44194),P=r(76711),A=r.n(P),R=r(28520),U=r(58709),T=r(16803),E=r(21002),z=r(97588),D=r(67186),O=r(74056),B=r(17455),q=r(69159),L=r(19058),N=r(2290),Y=r(31549),V=function(e){var t,r,a,s,n,i,o,d,u=e.isEdit,l=e.user,c=e.open,p=e.onClose,m=e.onSubmit,M=q.Z.useForm(),v=h()(M,1)[0],y=(0,N.useIntl)(),b=(0,R.u)((function(e){return e.currentOrg})),w=(0,T.L)((function(e){return e.userInfo})),k=(0,F.useState)(!1),S=h()(k,2),Z=S[0],I=S[1],P=(0,E.Z)().translateString,V=(0,U.Z)((function(e){return{roleResult:e.roleResult,roleResultPlatform:e.roleResultPlatform}})),H=V.roleResult,K=V.roleResultPlatform,G=((null==l?void 0:l.currentRoles)||[]).filter((function(e){return(null==e?void 0:e.uid)&&!0!==(null==e?void 0:e.system)})).map((function(e){return e.uid})).filter(Boolean),J=(n=null!==(t=null==H||null===(r=H.data)||void 0===r?void 0:r.content)&&void 0!==t?t:[],i=null!==(a=null==K||null===(s=K.data)||void 0===s?void 0:s.content)&&void 0!==a?a:[],o=[].concat(A()(n),A()(i)),d=new Set,o.filter((function(e){var t=null==e?void 0:e.uid;return!!t&&!d.has(t)&&(d.add(t),!0===(null==e?void 0:e.system))})).map((function(e){return{value:e.uid,label:P(e.name)}}))),W=null!=w&&w.superUser&&(null==w?void 0:w.email)||"",Q=null!=w&&w.superUser&&(null==w?void 0:w.mobile)||"";(0,F.useEffect)((function(){u?v.setFieldsValue({username:null==l?void 0:l.username,nickname:null==l?void 0:l.nickname,email:null==l?void 0:l.email,emailVerified:null==l?void 0:l.emailVerified,mobile:null==l?void 0:l.mobile,mobileVerified:null==l?void 0:l.mobileVerified,enabled:null==l?void 0:l.enabled,roleUids:((null==l?void 0:l.currentRoles)||[]).filter((function(e){return!0===(null==e?void 0:e.system)})).map((function(e){return e.uid})).filter(Boolean)}):(v.resetFields(),v.setFieldsValue({enabled:!0,roleUids:[]})),I(!1)}),[c]);var X,$;return(0,Y.jsx)(L.Z,{title:u?(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.edit",defaultMessage:"Edit User"}):(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.create",defaultMessage:"Create User"}),onClose:p,open:c,width:600,extra:(0,Y.jsxs)(j.Z,{children:[(0,Y.jsx)(C.ZP,{onClick:p,children:(0,Y.jsx)(N.FormattedMessage,{id:"pages.common.cancel"})}),(0,Y.jsx)(C.ZP,{onClick:function(){v.validateFields().then((function(e){if(null==l||!l.superUser||!1!==e.enabled&&!1!==e.mobileVerified&&!1!==e.emailVerified){var t={uid:null==l?void 0:l.uid,username:e.username,nickname:e.nickname,email:e.email,emailVerified:e.emailVerified,mobile:e.mobile,mobileVerified:e.mobileVerified,enabled:e.enabled,password:e.password,orgUid:null==b?void 0:b.uid,roleUids:Array.from(new Set([].concat(A()(e.roleUids||[]),A()(G))))};m(t)}else x.yw.error(y.formatMessage({id:"pages.user.superUser.notAllow"}))})).catch((function(e){console.log("Form errors:",e),((null==e?void 0:e.errorFields)||[]).some((function(e){return Array.isArray(null==e?void 0:e.name)&&e.name.includes("password")}))&&I(!0),x.yw.error(y.formatMessage({id:"pages.form.error"}))}))},type:"primary",children:(0,Y.jsx)(N.FormattedMessage,{id:"pages.common.save"})})]}),children:(0,Y.jsxs)(z.A,{name:"userDrawer",form:v,submitter:!1,children:[(0,Y.jsx)(D.Z,{name:"username",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.username"}),fieldProps:{autoComplete:"username"},rules:[{required:!0,message:y.formatMessage({id:"pages.user.username.required"})}]}),(0,Y.jsx)(D.Z,{name:"nickname",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.nickname"}),fieldProps:{autoComplete:"name"},rules:[{required:!0,message:y.formatMessage({id:"pages.user.nickname.required"})}]}),(0,Y.jsx)(D.Z,{name:"email",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.email"}),fieldProps:{autoComplete:"email"},rules:[{required:!0,message:y.formatMessage({id:"pages.user.email.required"})},{type:"email",message:y.formatMessage({id:"pages.user.email.invalid"})},{validator:($=f()(g()().mark((function e(t,r){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=2;break}return e.abrupt("return");case 2:if(r){e.next=4;break}return e.abrupt("return");case 4:if(!W||String(r).trim().toLowerCase()!==W.trim().toLowerCase()){e.next=6;break}throw new Error("邮箱为系统超级管理员保留，禁止使用");case 6:case"end":return e.stop()}}),e)}))),function(e,t){return $.apply(this,arguments)})}]}),(0,Y.jsx)(O.Z,{name:"emailVerified",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.email.verified"})}),(0,Y.jsx)(D.Z,{name:"mobile",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.mobile"}),fieldProps:{autoComplete:"tel"},rules:[{required:!0,message:y.formatMessage({id:"pages.user.mobile.required"})},{pattern:/^1[3-9]\d{9}$/,message:y.formatMessage({id:"pages.user.mobile.invalid"})},{validator:(X=f()(g()().mark((function e(t,r){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=2;break}return e.abrupt("return");case 2:if(r){e.next=4;break}return e.abrupt("return");case 4:if(!Q||String(r).trim()!==Q.trim()){e.next=6;break}throw new Error("手机号为系统超级管理员保留，禁止使用");case 6:case"end":return e.stop()}}),e)}))),function(e,t){return X.apply(this,arguments)})}]}),(0,Y.jsx)(O.Z,{name:"mobileVerified",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.mobile.verified"})}),(0,Y.jsx)(O.Z,{name:"enabled",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.enabled",defaultMessage:"Status"}),checkedChildren:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.status.enabled",defaultMessage:"启用"}),unCheckedChildren:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.status.disabled",defaultMessage:"禁用"})}),(null==l?void 0:l.superUser)&&(0,Y.jsx)("p",{children:"超级管理员拥有所有权限，禁止编辑角色"}),(0,Y.jsx)("div",{style:{marginBottom:16},children:(0,Y.jsx)(C.ZP,{type:"link",onClick:function(){return I(!Z)},style:{padding:0},children:Z?"隐藏高级设置":"高级设置"})}),Z&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(B.Z,{name:"roleUids",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.roles",defaultMessage:"Roles"}),width:"md",disabled:!0,options:J,fieldProps:{mode:"multiple",allowClear:!0,placeholder:y.formatMessage({id:"pages.user.roles.placeholder",defaultMessage:"请选择角色"})}}),(0,Y.jsx)(D.Z.Password,{name:"password",label:(0,Y.jsx)(N.FormattedMessage,{id:"pages.user.password"}),fieldProps:{autoComplete:"new-password"},rules:[{required:!u,message:y.formatMessage({id:"pages.user.password.required"})}]})]})]})})},H=r(7603),K=r(96596),G=r.n(K),J=r(27353),W=r(61476),Q=r(97765),X=["current","pageSize"],$=function(){var e=(0,N.useIntl)(),t=(0,F.useRef)(),r=(0,E.Z)().translateString,a=(0,F.useState)(!0),s=h()(a,2),n=s[0],i=s[1],o=(0,F.useState)(),u=h()(o,2),c=u[0],p=u[1],m=(0,F.useState)(!1),P=h()(m,2),A=P[0],T=P[1],z=(0,F.useState)(1),D=h()(z,2),O=D[0],B=D[1],q=(0,F.useState)(10),L=h()(q,2),K=L[0],$=L[1],_=(0,R.u)((function(e){return e.currentOrg})),ee=(0,U.Z)((function(e){return{setRoleResult:e.setRoleResult,setRoleResultPlatform:e.setRoleResultPlatform}})),te=ee.setRoleResult,re=ee.setRoleResultPlatform,ae=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:e.formatMessage({id:"pages.common.search",defaultMessage:"搜索"}),dataIndex:"searchText",hideInTable:!0,fieldProps:{placeholder:e.formatMessage({id:"pages.user.searchPlaceholder",defaultMessage:"搜索用户名/昵称/邮箱/手机号/组织"})}},{title:e.formatMessage({id:"uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:e.formatMessage({id:"pages.user.username"}),dataIndex:"username",copyable:!0},{title:e.formatMessage({id:"pages.user.nickname"}),dataIndex:"nickname",render:function(e,t){var a=r(t.nickname);return a?(0,Y.jsx)(k.Z.Text,{copyable:{text:a},children:a}):"-"}},{title:e.formatMessage({id:"pages.user.email"}),dataIndex:"email",width:300,render:function(t,r){return(0,Y.jsxs)(j.Z,{size:4,children:[r.email?(0,Y.jsx)(k.Z.Text,{copyable:{text:r.email},children:r.email}):(0,Y.jsx)("span",{children:"-"}),(0,Y.jsx)(S.Z,{color:r.emailVerified?"success":"default",children:r.emailVerified?e.formatMessage({id:"pages.user.email.verified.yes"}):e.formatMessage({id:"pages.user.email.verified.no"})})]})}},{title:e.formatMessage({id:"pages.user.mobile"}),dataIndex:"mobile",width:250,render:function(t,r){return(0,Y.jsxs)(j.Z,{size:4,children:[r.mobile?(0,Y.jsx)(k.Z.Text,{copyable:{text:r.mobile},children:r.mobile}):(0,Y.jsx)("span",{children:"-"}),(0,Y.jsx)(S.Z,{color:r.mobileVerified?"success":"default",children:r.mobileVerified?e.formatMessage({id:"pages.user.mobile.verified.yes"}):e.formatMessage({id:"pages.user.mobile.verified.no"})})]})}},{title:e.formatMessage({id:"pages.user.organization"}),dataIndex:"currentOrganization",render:function(e,t){var r,a=null===(r=t.currentOrganization)||void 0===r?void 0:r.name;return a?(0,Y.jsx)(k.Z.Text,{copyable:{text:a},children:(0,Y.jsx)(S.Z,{color:"blue",children:a})}):"-"},fieldProps:{placeholder:e.formatMessage({id:"pages.user.organization.searchPlaceholder",defaultMessage:"搜索组织名称"})}},{title:e.formatMessage({id:"pages.user.roles"}),dataIndex:"currentRoles",hideInSearch:!0,width:250,render:function(e,t){return t.currentRoles&&t.currentRoles.length>0?(0,Y.jsx)(j.Z,{wrap:!0,children:t.currentRoles.map((function(e,t){return(0,Y.jsx)(S.Z,{color:"green",children:r(e.name)},t)}))}):null}},{title:e.formatMessage({id:"pages.user.description"}),dataIndex:"description",hideInSearch:!0,hideInTable:!0},{title:e.formatMessage({id:"pages.user.enabled"}),dataIndex:"enabled",hideInSearch:!0,width:100,render:function(t,r){return r.enabled?e.formatMessage({id:"pages.user.status.enabled",defaultMessage:"启用"}):e.formatMessage({id:"pages.user.status.disabled",defaultMessage:"禁用"})},valueEnum:{true:{text:e.formatMessage({id:"pages.user.status.enabled",defaultMessage:"启用"}),status:"Success"},false:{text:e.formatMessage({id:"pages.user.status.disabled",defaultMessage:"禁用"}),status:"Error"}}},{title:e.formatMessage({id:"pages.user.superUser"}),dataIndex:"superUser",hideInSearch:!0,width:100,render:function(t,r){return r.superUser?e.formatMessage({id:"pages.user.superUser.yes",defaultMessage:"是"}):e.formatMessage({id:"pages.user.superUser.no",defaultMessage:"否"})},valueEnum:{true:{text:e.formatMessage({id:"pages.user.superUser.yes",defaultMessage:"是"}),status:"Success"},false:{text:e.formatMessage({id:"pages.user.superUser.no",defaultMessage:"否"}),status:"Default"}}},{title:e.formatMessage({id:"pages.user.sex",defaultMessage:"性别"}),dataIndex:"sex",hideInSearch:!0,width:80,render:function(t,r){var a={MALE:e.formatMessage({id:"pages.user.sex.male",defaultMessage:"男"}),FEMALE:e.formatMessage({id:"pages.user.sex.female",defaultMessage:"女"}),UNKNOWN:e.formatMessage({id:"pages.user.sex.unknown",defaultMessage:"未知"})};return r.sex?a[r.sex]||r.sex:"-"}},{title:e.formatMessage({id:"pages.user.registerSource",defaultMessage:"注册来源"}),dataIndex:"registerSource",hideInSearch:!0,width:120,render:function(t,r){var a={USERNAME:e.formatMessage({id:"pages.user.registerSource.username",defaultMessage:"用户名"}),EMAIL:e.formatMessage({id:"pages.user.registerSource.email",defaultMessage:"邮箱"}),MOBILE:e.formatMessage({id:"pages.user.registerSource.mobile",defaultMessage:"手机"}),GITHUB:"GitHub",WECHAT:e.formatMessage({id:"pages.user.registerSource.wechat",defaultMessage:"微信"}),GOOGLE:"Google",DINGTALK:e.formatMessage({id:"pages.user.registerSource.dingtalk",defaultMessage:"钉钉"}),FEISHU:e.formatMessage({id:"pages.user.registerSource.feishu",defaultMessage:"飞书"}),FACEBOOK:"Facebook",DOUYIN:e.formatMessage({id:"pages.user.registerSource.douyin",defaultMessage:"抖音"}),APPLE:"Apple",LDAP:"LDAP",OIDC:"OIDC",OPENID:"OpenID",CAS:"CAS",ADMIN:e.formatMessage({id:"pages.user.registerSource.admin",defaultMessage:"管理员创建"}),IMPORT:e.formatMessage({id:"pages.user.registerSource.import",defaultMessage:"导入"}),UNKNOWN:e.formatMessage({id:"pages.user.registerSource.unknown",defaultMessage:"未知"})};return r.registerSource?a[r.registerSource]||r.registerSource:"-"}},{title:e.formatMessage({id:"pages.user.createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.createdAt?G()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):""}},{title:e.formatMessage({id:"pages.user.updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.updatedAt?G()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):""}}],se=[].concat(ae,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:120,fixed:"right",render:function(t,r,a,s){return[(0,Y.jsx)("a",{onClick:function(){oe(r)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),!r.superUser&&(0,Y.jsxs)(F.Fragment,{children:[(0,Y.jsx)(Z.Z,{type:"vertical"},"divider"),(0,Y.jsx)(I.Z,{title:e.formatMessage({id:"pages.common.deleteConfirm",defaultMessage:"Are you sure to delete {name}?"},{name:r.nickname||r.username}),onConfirm:function(){return de(r)},okText:e.formatMessage({id:"pages.common.ok",defaultMessage:"OK"}),cancelText:e.formatMessage({id:"pages.common.cancel",defaultMessage:"Cancel"}),children:(0,Y.jsx)("a",{children:e.formatMessage({id:"pages.common.delete",defaultMessage:"Delete"})},"delete")},"delete")]},"delete-fragment")]}}]),ne=(0,H.v)((function(e){return e.currentCategory})),ie=function(){p(void 0),i(!1),T(!0)},oe=function(e){p(e),i(!0),T(!0)},de=function(){var a=f()(g()().mark((function a(s){var n,i;return g()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!s.superUser){a.next=3;break}return x.yw.error(e.formatMessage({id:"pages.user.superUser.notDelete"})),a.abrupt("return");case 3:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),a.prev=4,a.next=7,(0,M.h8)({uid:s.uid});case 7:n=a.sent,x.yw.destroy(),200===n.code?(x.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete successful"})),null===(i=t.current)||void 0===i||i.reloadAndRest()):x.yw.error(r(n.message)||e.formatMessage({id:"delete.error",defaultMessage:"Delete failed"})),a.next=17;break;case 12:a.prev=12,a.t0=a.catch(4),x.yw.destroy(),x.yw.error(e.formatMessage({id:"delete.error",defaultMessage:"Delete failed"})),console.error("Delete user error:",a.t0);case 17:case"end":return a.stop()}}),a,null,[[4,12]])})));return function(e){return a.apply(this,arguments)}}(),ue=function(){var r=f()(g()().mark((function r(a){var s,i;return g()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(Q.Z.debug("handleSubmitDrawer",a),n?x.yw.loading(e.formatMessage({id:"updating"})):x.yw.loading(e.formatMessage({id:"creating"})),!n){r.next=8;break}return r.next=5,(0,M.Nq)(a);case 5:r.t0=r.sent,r.next=11;break;case 8:return r.next=10,(0,M.r4)(a);case 10:r.t0=r.sent;case 11:s=r.t0,Q.Z.debug("createUser response:",a,s),200===s.code?(x.yw.destroy(),x.yw.loading(e.formatMessage({id:"create.success"})),T(!1),null===(i=t.current)||void 0===i||i.reloadAndRest()):(x.yw.destroy(),x.yw.error(s.message));case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),le=function(){var t=f()(g()().mark((function t(){var r,a;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading..."})),r={pageNumber:0,pageSize:100,orgUid:null==_?void 0:_.uid},t.next=4,(0,v.E9)(r);case 4:a=t.sent,Q.Z.debug("queryRolesByOrg response ",a),200===a.code?(x.yw.destroy(),te(a)):(x.yw.destroy(),x.yw.error(a.message));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ce=function(){var t=f()(g()().mark((function t(){var r,a;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading..."})),r={pageNumber:0,pageSize:100,level:J.Hxq},t.next=4,(0,v.E9)(r);case 4:a=t.sent,Q.Z.debug("queryRolesBySuper response ",a),200===a.code?(x.yw.destroy(),re(a)):(x.yw.destroy(),x.yw.error(a.message));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,F.useEffect)((function(){le(),ce()}),[]),(0,F.useEffect)((function(){var e;Q.Z.debug("currentCategory:",ne),null===(e=t.current)||void 0===e||e.reloadAndRest()}),[ne]);var ge=function(){var e=f()(g()().mark((function e(){var t;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Q.Z.debug("handleExportExcel",O,K),t=localStorage.getItem(J.LA8),window.open((0,W.kG)()+"/api/v1/user/export?"+new URLSearchParams({pageNumber:String(O-1),pageSize:String(K),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(w.Z,{columns:se,actionRef:t,cardBordered:!0,scroll:{x:2500},request:function(){var t=f()(g()().mark((function t(a,s,n){var i,o,u,c,p,f,m,h;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Q.Z.debug("request:",a,s,n),x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),i=a.current,o=a.pageSize,u=l()(a,X),B(i),$(o),c=void 0,p=void 0,s&&Object.keys(s).length>0&&(f=Object.keys(s)[0],c=f,p="ascend"===s[f]?"ascend":"descend"),m=d()({pageNumber:i-1,pageSize:o,superUser:!0,sortBy:c,sortDirection:p},u),t.next=11,(0,M._9)(m);case 11:return h=t.sent,Q.Z.debug("getAllUsers response:",m,h),x.yw.destroy(),200===h.code||x.yw.error(r(h.message)),t.abrupt("return",{data:null==h?void 0:h.data.content,success:!0,total:null==h?void 0:h.data.totalElements});case 16:case"end":return t.stop()}}),t)})));return function(e,r,a){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:K,showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){Q.Z.debug("pagination onChange:",e,t),B(e),$(t)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"pages.user.list",defaultMessage:"用户列表"}),toolBarRender:function(){return[(0,Y.jsx)(C.ZP,{icon:(0,Y.jsx)(y.Z,{}),type:"primary",onClick:ie,disabled:!(0,W.OJ)(),children:e.formatMessage({id:"pages.common.create",defaultMessage:"Create"})},"button"),(0,Y.jsx)(C.ZP,{icon:(0,Y.jsx)(b.Z,{}),type:"primary",onClick:ge,disabled:!(0,W.OJ)(),children:e.formatMessage({id:"export",defaultMessage:"Export"})},"button")]}}),A&&(0,Y.jsx)(V,{isEdit:n,open:A,user:c,onClose:function(){T(!1)},onSubmit:ue})]})},_=r(68445),ee=r(86222),te=r.n(ee),re=r(29496),ae=r(41881),se=r(91768),ne=r(80503),ie=r(35746),oe=r(56668),de=r(14986),ue=["current","pageSize"],le=function(e){var t=e.superUser,r=(0,N.useIntl)(),a=(0,F.useRef)(),s=(0,R.u)((function(e){return e.currentOrg})),n=(0,F.useState)(1),i=h()(n,2),o=i[0],u=i[1],c=(0,F.useState)(10),p=h()(c,2),m=p[0],M=p[1],v=(0,F.useState)({}),k=h()(v,2),j=k[0],S=k[1],Z=(0,F.useState)(0),P=h()(Z,2),A=P[0],U=P[1],T=(0,F.useState)([]),E=h()(T,2),z=E[0],D=E[1],O=(0,F.useState)([]),B=h()(O,2),q=B[0],L=B[1],V=(0,F.useState)(!1),H=h()(V,2),K=H[0],G=H[1],X=(0,F.useState)(),$=h()(X,2),_=$[0],ee=$[1],le=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(N.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.whiteIp.ip"}),dataIndex:"ip",copyable:!0,width:150,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.whiteIp.ip.tooltip"})},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.white.description"}),dataIndex:"description",copyable:!0,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.white.description.tooltip"})},{title:(0,Y.jsx)(N.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:180,sorter:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"message.createdAt.tooltip"})}],ce=[].concat(le,[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:120,fixed:"right",render:function(e,t,a,s){return[(0,Y.jsx)(C.ZP,{size:"small",type:"link",icon:(0,Y.jsx)(ae.Z,{}),onClick:function(){return fe(t)},children:r.formatMessage({id:"edit",defaultMessage:"编辑"})},"edit"),(0,Y.jsx)(I.Z,{title:r.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==t?void 0:t.ip,"】？"),onConfirm:function(){return pe(t)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),children:(0,Y.jsx)(C.ZP,{size:"small",type:"link",danger:!0,children:r.formatMessage({id:"visitor.whiteIp.delete",defaultMessage:"Delete"})})},"delete")]}}]),ge=function(){var e=f()(g()().mark((function e(r,a,n){var i,u;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Q.Z.debug("handleExportExcel",r,a,n),i=localStorage.getItem(J.LA8),u=d()({orgUid:t?"":null==s?void 0:s.uid,accessToken:i||"",exportType:r},j),"current"===r?(u.pageNumber=String(o-1),u.pageSize=String(m)):"all"===r?(u.pageNumber="0",u.pageSize="1000"):"range"===r&&void 0!==a&&void 0!==n&&(u.pageNumber=String(a),u.pageSize=String(n)),window.open((0,W.kG)()+"/api/v1/ip/white/export?"+new URLSearchParams(u).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),pe=function(){var e=f()(g()().mark((function e(t){var s,n;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,re.QE)(t.uid);case 3:s=e.sent,Q.Z.debug("delete response:",s),200===s.code?(null==a||null===(n=a.current)||void 0===n||n.reload(),x.yw.success(r.formatMessage({id:"delete.success"}))):x.yw.error(r.formatMessage({id:"delete.error"})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),x.yw.error(r.formatMessage({id:"delete.error"}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),fe=function(e){ee(e),G(!0)},me=function(){ee(void 0),G(!0)},he=function(){var e=f()(g()().mark((function e(){var t,s,n,i,o,d;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==q.length){e.next=3;break}return x.yw.warning(r.formatMessage({id:"batch.noselection",defaultMessage:"请选择需要处理的项目"})),e.abrupt("return");case 3:x.yw.loading(r.formatMessage({id:"processing",defaultMessage:"处理中..."})),s=0,n=0,i=te()(q),e.prev=7,i.s();case 9:if((o=i.n()).done){e.next=23;break}return d=o.value,e.prev=11,e.next=14,(0,re.QE)(d.uid);case 14:200===e.sent.code?s++:n++,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),n++;case 21:e.next=9;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(7),i.e(e.t1);case 28:return e.prev=28,i.f(),e.finish(28);case 31:x.yw.destroy(),0===n?x.yw.success(r.formatMessage({id:"batch.delete.success",defaultMessage:"成功删除 {count} 条白名单"},{count:s})):x.yw.warning(r.formatMessage({id:"batch.delete.partial",defaultMessage:"成功删除 {success} 条白名单，失败 {fail} 条"},{success:s,fail:n})),D([]),L([]),null===(t=a.current)||void 0===t||t.reloadAndRest();case 36:case"end":return e.stop()}}),e,null,[[7,25,28,31],[11,18]])})));return function(){return e.apply(this,arguments)}}(),xe=function(e){for(var t=[],r=1e3,a=Math.ceil(e/r),s=function(){var a=n,s=n*r+1,i=Math.min((n+1)*r,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(i," (").concat(i-s+1,"条)"),onClick:function(){return ge("range",a,r)}})},n=0;n<a;n++)s();return t},Me={selectedRowKeys:z,onChange:function(e,t){D(e),L(t)}};return(0,Y.jsxs)(F.Fragment,{children:[(0,Y.jsx)(w.Z,{columns:ce,actionRef:a,cardBordered:!0,rowSelection:Me,scroll:{x:800},request:function(){var e=f()(g()().mark((function e(r,a,n){var i,o,c,p,f,m,h,v;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.current,o=r.pageSize,c=l()(r,ue),u(i),M(o),S(c),p=void 0,f=void 0,a&&Object.keys(a).length>0&&(m=Object.keys(a)[0],p=m,f="ascend"===a[m]?"ascend":"descend"),h=d()(d()({pageNumber:r.current-1,pageSize:o,orgUid:null==s?void 0:s.uid},c),{},{sortBy:p,sortDirection:f,superUser:t}),e.next=10,(0,re.Fx)(h);case 10:return v=e.sent,Q.Z.debug("queryIpWhites response:",v,h),200===v.code?U(null==v?void 0:v.data.totalElements):x.yw.error(v.message),e.abrupt("return",{data:null==v?void 0:v.data.content,success:!0,total:null==v?void 0:v.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e,t){u(e),M(t),Q.Z.debug("page:",e,"size:",t)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"visitor.whiteIp.list"}),toolBarRender:function(){return function(){var e=[];e.push((0,Y.jsx)(C.ZP,{type:"primary",icon:(0,Y.jsx)(y.Z,{}),onClick:me,children:r.formatMessage({id:"visitor.whiteIp.add",defaultMessage:"添加白名单IP"})},"add"));var t=[];z.length>0&&(t.push({key:"batchDelete",icon:(0,Y.jsx)(se.Z,{}),danger:!0,label:r.formatMessage({id:"batch.delete",defaultMessage:"批量删除白名单"})+" (".concat(z.length,")"),onClick:function(){ie.Z.confirm({title:r.formatMessage({id:"batch.deleteTip",defaultMessage:"删除白名单确认"}),content:"".concat(r.formatMessage({id:"batch.deleteAffirm",defaultMessage:"确定要删除"})," ").concat(z.length," ").concat(r.formatMessage({id:"items",defaultMessage:"项"}),"?"),onOk:he,okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"})})}}),e.push((0,Y.jsx)(oe.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(C.ZP,{type:"primary",danger:!0,children:[r.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})," (",z.length,")",(0,Y.jsx)(ne.Z,{})]})},"batchOperations")));var a=[{key:"export-current",icon:(0,Y.jsx)(b.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return ge("current")}}];return A>0&&(A<=1e3?a.push({key:"export-all",icon:(0,Y.jsx)(b.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(A,"条)"),onClick:function(){return ge("all")}}):a.push({key:"export-range",icon:(0,Y.jsx)(b.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(A,"条)"),children:xe(A)})),e.push((0,Y.jsx)(oe.Z,{menu:{items:a},placement:"bottom",children:(0,Y.jsxs)(C.ZP,{type:"primary",icon:(0,Y.jsx)(b.Z,{}),children:[r.formatMessage({id:"export",defaultMessage:"导出"}),(0,Y.jsx)(ne.Z,{})]})},"exportOperations")),e}()}}),(0,Y.jsx)(de.Z,{visible:K,onClose:function(){return G(!1)},onSuccess:function(){var e;null===(e=a.current)||void 0===e||e.reload()},type:"white",editData:_,superUser:t})]})};function ce(e){return ge.apply(this,arguments)}function ge(){return(ge=f()(g()().mark((function e(t){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,N.request)("/api/v1/ip/access/query/org",{method:"GET",params:d()(d()({},t),{},{channel:J.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e){return fe.apply(this,arguments)}function fe(){return(fe=f()(g()().mark((function e(t){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,N.request)("/api/v1/ip/access/delete",{method:"POST",data:{uid:t,channel:J.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me=["current","pageSize"],he=function(e){var t=e.superUser,r=(0,N.useIntl)(),a=(0,F.useRef)(),s=(0,R.u)((function(e){return e.currentOrg})),n=(0,F.useState)(1),i=h()(n,2),o=i[0],u=i[1],c=(0,F.useState)(10),p=h()(c,2),m=p[0],M=p[1],v=(0,F.useState)({}),y=h()(v,2),k=y[0],j=y[1],S=(0,F.useState)(0),Z=h()(S,2),P=Z[0],A=Z[1],U=(0,F.useState)([]),T=h()(U,2),E=T[0],z=T[1],D=(0,F.useState)([]),O=h()(D,2),B=O[0],q=O[1],L=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(N.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.ip"}),dataIndex:"ip",copyable:!0,width:150,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.ip.tooltip"})},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.ipLocation"}),dataIndex:"ipLocation",width:200,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.ipLocation.tooltip"})},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.endpoint"}),dataIndex:"endpoint",tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.endpoint.tooltip"})},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.params"}),dataIndex:"params",tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.params.tooltip"}),ellipsis:!0},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.accessCount"}),dataIndex:"accessCount",width:100,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.accessCount.tooltip"})},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.accessTime"}),dataIndex:"accessTime",width:180,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.accessTime.tooltip"}),render:function(e){return e?G()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.lastAccessTime"}),dataIndex:"lastAccessTime",width:180,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"visitor.accessIp.lastAccessTime.tooltip"}),render:function(e){return e?G()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(N.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:180,sorter:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(N.FormattedMessage,{id:"message.createdAt.tooltip"}),render:function(e){return e?G()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"-"}}],V=[].concat(L,[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:120,fixed:"right",render:function(e,t,a,s){return[(0,Y.jsx)(I.Z,{title:r.formatMessage({id:"deleteTip",defaultMessage:"Delete Tip"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(null==t?void 0:t.ip,"】？"),onConfirm:function(){return K(t)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),children:(0,Y.jsx)(C.ZP,{size:"small",type:"link",danger:!0,children:r.formatMessage({id:"visitor.accessIp.delete",defaultMessage:"Delete"})})},"delete")]}}]),H=function(){var e=f()(g()().mark((function e(r,a,n){var i,u;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Q.Z.debug("handleExportExcel",r,a,n),i=localStorage.getItem(J.LA8),u=d()({orgUid:t?"":null==s?void 0:s.uid,accessToken:i||"",exportType:r},k),"current"===r?(u.pageNumber=String(o-1),u.pageSize=String(m)):"all"===r?(u.pageNumber="0",u.pageSize="1000"):"range"===r&&void 0!==a&&void 0!==n&&(u.pageNumber=String(a),u.pageSize=String(n)),window.open((0,W.kG)()+"/api/v1/ip/access/export?"+new URLSearchParams(u).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),K=function(){var e=f()(g()().mark((function e(t){var s,n;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pe(t.uid);case 3:s=e.sent,Q.Z.debug("delete response:",s),200===s.code?(null==a||null===(n=a.current)||void 0===n||n.reload(),x.yw.success(r.formatMessage({id:"delete.success"}))):x.yw.error(r.formatMessage({id:"delete.error"})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),x.yw.error(r.formatMessage({id:"delete.error"}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=f()(g()().mark((function e(){var t,s,n,i,o,d;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==B.length){e.next=3;break}return x.yw.warning(r.formatMessage({id:"batch.noselection",defaultMessage:"请选择需要处理的项目"})),e.abrupt("return");case 3:x.yw.loading(r.formatMessage({id:"processing",defaultMessage:"处理中..."})),s=0,n=0,i=te()(B),e.prev=7,i.s();case 9:if((o=i.n()).done){e.next=23;break}return d=o.value,e.prev=11,e.next=14,pe(d.uid);case 14:200===e.sent.code?s++:n++,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),n++;case 21:e.next=9;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(7),i.e(e.t1);case 28:return e.prev=28,i.f(),e.finish(28);case 31:x.yw.destroy(),0===n?x.yw.success(r.formatMessage({id:"batch.delete.success",defaultMessage:"成功删除 {count} 条访问记录"},{count:s})):x.yw.warning(r.formatMessage({id:"batch.delete.partial",defaultMessage:"成功删除 {success} 条访问记录，失败 {fail} 条"},{success:s,fail:n})),z([]),q([]),null===(t=a.current)||void 0===t||t.reloadAndRest();case 36:case"end":return e.stop()}}),e,null,[[7,25,28,31],[11,18]])})));return function(){return e.apply(this,arguments)}}(),$=function(e){for(var t=[],r=1e3,a=Math.ceil(e/r),s=function(){var a=n,s=n*r+1,i=Math.min((n+1)*r,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(i," (").concat(i-s+1,"条)"),onClick:function(){return H("range",a,r)}})},n=0;n<a;n++)s();return t},_={selectedRowKeys:E,onChange:function(e,t){z(e),q(t)}};return(0,Y.jsx)(w.Z,{columns:V,actionRef:a,cardBordered:!0,rowSelection:_,scroll:{x:2e3},request:function(){var e=f()(g()().mark((function e(r,a,n){var i,o,c,p,f,m,h,v;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.current,o=r.pageSize,c=l()(r,me),u(i),M(o),j(c),p=void 0,f=void 0,a&&Object.keys(a).length>0&&(m=Object.keys(a)[0],p=m,f="ascend"===a[m]?"ascend":"descend"),h=d()(d()({pageNumber:r.current-1,pageSize:o,orgUid:null==s?void 0:s.uid},c),{},{sortBy:p,sortDirection:f,superUser:t}),e.next=10,ce(h);case 10:return v=e.sent,Q.Z.debug("queryIpAccesses response:",v,h),200===v.code?A(null==v?void 0:v.data.totalElements):x.yw.error(v.message),e.abrupt("return",{data:null==v?void 0:v.data.content,success:!0,total:null==v?void 0:v.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e,t){u(e),M(t),Q.Z.debug("page:",e,"size:",t)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"visitor.accessIp.list"}),toolBarRender:function(){return function(){var e=[],t=[];E.length>0&&(t.push({key:"batchDelete",icon:(0,Y.jsx)(se.Z,{}),danger:!0,label:r.formatMessage({id:"batch.delete",defaultMessage:"批量删除访问记录"})+" (".concat(E.length,")"),onClick:function(){ie.Z.confirm({title:r.formatMessage({id:"batch.deleteTip",defaultMessage:"删除访问记录确认"}),content:"".concat(r.formatMessage({id:"batch.deleteAffirm",defaultMessage:"确定要删除"})," ").concat(E.length," ").concat(r.formatMessage({id:"items",defaultMessage:"项"}),"?"),onOk:X,okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"})})}}),e.push((0,Y.jsx)(oe.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(C.ZP,{type:"primary",danger:!0,children:[r.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})," (",E.length,")",(0,Y.jsx)(ne.Z,{})]})},"batchOperations")));var a=[{key:"export-current",icon:(0,Y.jsx)(b.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return H("current")}}];return P>0&&(P<=1e3?a.push({key:"export-all",icon:(0,Y.jsx)(b.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(P,"条)"),onClick:function(){return H("all")}}):a.push({key:"export-range",icon:(0,Y.jsx)(b.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(P,"条)"),children:$(P)})),e.push((0,Y.jsx)(oe.Z,{menu:{items:a},placement:"bottom",children:(0,Y.jsxs)(C.ZP,{type:"primary",icon:(0,Y.jsx)(b.Z,{}),children:[r.formatMessage({id:"export",defaultMessage:"导出"}),(0,Y.jsx)(ne.Z,{})]})},"exportOperations")),e}()}})},xe=function(){var e=(0,N.useIntl)(),t=[{key:"user",label:e.formatMessage({id:"user"}),children:(0,Y.jsx)($,{})},{key:"visitor",label:e.formatMessage({id:"visitor.tab.all"}),children:(0,Y.jsx)(n.Z,{superUser:!0})},{key:"browse",label:e.formatMessage({id:"browse.tab.all"}),children:(0,Y.jsx)(_.Z,{superUser:!0})}];return(0,W.OJ)()&&t.splice(2,0,{key:"black",label:e.formatMessage({id:"visitor.tab.black"}),children:(0,Y.jsx)(a.Z,{superUser:!0})},{key:"blackIp",label:e.formatMessage({id:"visitor.tab.blackIp"}),children:(0,Y.jsx)(s.Z,{superUser:!0})},{key:"whiteIp",label:e.formatMessage({id:"visitor.tab.whiteIp"}),children:(0,Y.jsx)(le,{superUser:!0})},{key:"accessIp",label:e.formatMessage({id:"visitor.tab.accessIp"}),children:(0,Y.jsx)(he,{superUser:!0})}),(0,Y.jsx)(i.Z,{defaultActiveKey:"user",items:t,style:{padding:"10px"}})}},7603:function(e,t,r){r.d(t,{v:function(){return f}});var a=r(86222),s=r.n(a),n=r(73193),i=r.n(n),o=r(76711),d=r.n(o),u=r(27353),l=r(26557),c=r(26407),g=r(20744),p=r(97765);var f=(0,l.Ue)()((0,c.mW)((0,c.tJ)((0,g.n)((function(e,t){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:u.zBg,name:u.zBg},setCategoryResult:function(t){var r=function(e){var t,r=[];return function e(t,a){t&&0!==t.length&&t.forEach((function(t){if(t&&t.uid&&t.uid!==u.zBg){var s=a?"".concat(a," / ").concat(t.name):t.name||"";r.push({label:s,value:t.uid}),t.children&&t.children.length>0&&e(t.children,s)}}))}((null==e||null===(t=e.data)||void 0===t?void 0:t.content)||[]),r}(t),a=function(e){var t,r=(null==e||null===(t=e.data)||void 0===t?void 0:t.content)||[],a=function e(t){var r={title:t.name||"",key:t.uid||""};return t.children&&t.children.length>0&&(r.children=t.children.map((function(t){return e(t)}))),r};return r.filter((function(e){return e&&e.uid&&e.uid!==u.zBg})).map((function(e){return a(e)}))}(t),s=[{title:u.zBg,key:u.zBg}].concat(d()(a)),n={uid:u.zBg,name:u.zBg},o=i()(i()({},t),{},{data:i()(i()({},t.data),{},{content:[n].concat(d()(t.data.content))})});e({categoryResult:o,categoryTreeOptions:s,categorySelectOptions:r}),0===t.data.content.length&&e({currentCategory:{uid:u.zBg,name:u.zBg}})},insertCategory:function(t){e((function(e){e.categoryResult.data.content.unshift(t)}))},upgradeCategory:function(t){e((function(e){var r=e.categoryResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));-1!==a?r[a]=t:console.warn("Category with uid ".concat(t.uid," not found."))}))},setCurrentCategory:function(t){e({currentCategory:t})},resetDefaultCategory:function(){p.Z.log("resetDefaultCategory"),e({currentCategory:{uid:u.zBg,name:u.zBg}})},setCurrentCategoryUid:function(r){if(r!==u.zBg){var a=function e(t,r){if(t&&0!==t.length){var a,n=s()(t);try{for(n.s();!(a=n.n()).done;){var i=a.value;if((null==i?void 0:i.uid)===r)return i;var o=e(null==i?void 0:i.children,r);if(o)return o}}catch(e){n.e(e)}finally{n.f()}}}(t().categoryResult.data.content,r);e({currentCategory:null!=a?a:{uid:u.zBg,name:u.zBg}})}else e({currentCategory:{uid:u.zBg,name:u.zBg}})},deleteCategoryCache:function(){return e({},!0)}}})),{name:u.OMm})))}}]);