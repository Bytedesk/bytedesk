"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[5256],{2077:function(e,t,r){r.d(t,{LE:function(){return u},W5:function(){return m},p0:function(){return p},zl:function(){return h}});var a=r(90819),n=r.n(a),s=r(73193),l=r.n(s),i=r(89933),d=r.n(i),o=r(14906);function u(e){return c.apply(this,arguments)}function c(){return(c=d()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/api/v1/workgroup/query/org",{method:"GET",params:l()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return x.apply(this,arguments)}function x(){return(x=d()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/api/v1/workgroup/create",{method:"POST",data:l()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return(f=d()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/api/v1/workgroup/update",{method:"POST",data:l()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return g.apply(this,arguments)}function g(){return(g=d()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/api/v1/workgroup/delete",{method:"POST",data:l()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},23216:function(e,t,r){r.r(t),r.d(t,{default:function(){return De}});var a=r(44194),n=r(67738),s=r(73193),l=r.n(s),i=r(84176),d=r.n(i),o=r(10154),u=r.n(o),c=r(90819),p=r.n(c),x=r(89933),m=r.n(x),f=r(45332),h=r.n(f),g=r(86895),j=r(66431),v=r(39487),M=r(82770),Z=r(63649),y=r(10162),b=r(80556),w=r(89246),k=r(14906),T=r(98830),I=r(19433),S=r(6203),E=r(42496),F=r(31549),A=function(e){var t=e.open,r=e.isEdit,a=void 0!==r&&r,n=e.email,s=e.loading,l=e.onClose,i=e.onSubmit;return(0,F.jsx)(E.Z,{type:"TICKET",isEdit:a,email:n,open:t,loading:s,onClose:l,onSubmit:i})},C=["current","pageSize","keyword"],R=function(){var e=(0,k.useIntl)(),t=(0,a.useRef)(),r=(0,T.u)((function(e){return e.currentOrg})),n=(0,a.useState)(!1),s=h()(n,2),i=s[0],o=s[1],c=(0,a.useState)(!1),x=h()(c,2),f=x[0],E=x[1],R=(0,a.useState)(void 0),P=h()(R,2),q=P[0],N=P[1],O=(0,a.useState)(!1),L=h()(O,2),D=L[0],H=L[1],W=function(){var e;return null===(e=t.current)||void 0===e?void 0:e.reload()},z=function(){E(!1),N(void 0),o(!0)},U=function(){var t=m()(p()().mark((function t(r,a,n){var s;return p()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,S.s)(u()({uid:r.uid},a,n));case 3:200===(s=t.sent).code?(I.yw.success(e.formatMessage({id:"update.success",defaultMessage:"更新成功"})),W()):I.yw.error(s.message||e.formatMessage({id:"request.error",defaultMessage:"请求失败"})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),I.yw.error(e.formatMessage({id:"request.error",defaultMessage:"请求失败"}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,a){return t.apply(this,arguments)}}(),B={QQ:{text:"QQ邮箱"},TENCENT_ENTERPRISE:{text:"腾讯企业邮箱"},SINA:{text:"新浪邮箱"},GMAIL:{text:"Gmail"},NETEASE_163:{text:"网易163邮箱"},NETEASE_ENTERPRISE:{text:"网易企业邮箱"},ALIYUN_ENTERPRISE:{text:"阿里云企业邮箱"},HOTMAIL:{text:"Hotmail/Outlook"},FEISHU_ENTERPRISE:{text:"飞书企业邮箱"},YAHOO:{text:"Yahoo邮箱"},OTHER:{text:"其他邮箱"}},K=(0,a.useMemo)((function(){return[{dataIndex:"index",valueType:"indexBorder",width:48,align:"center"},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.name",defaultMessage:"名称"}),dataIndex:"name",copyable:!0,ellipsis:!0},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.address",defaultMessage:"邮箱地址"}),dataIndex:"emailAddress",copyable:!0,ellipsis:!0},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.provider",defaultMessage:"服务提供商"}),dataIndex:"provider",width:160,valueType:"select",valueEnum:B},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.protocol",defaultMessage:"协议"}),dataIndex:"protocol",width:120,valueType:"select",hideInSearch:!0},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.enabled",defaultMessage:"启用"}),dataIndex:"enabled",width:100,render:function(e,t){return(0,F.jsx)(j.Z,{size:"small",checked:!!t.enabled,onChange:function(e){return U(t,"enabled",e)}})},search:!1},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.debug",defaultMessage:"调试"}),dataIndex:"debug",width:100,render:function(e,t){return(0,F.jsx)(j.Z,{size:"small",checked:!!t.debug,onChange:function(e){return U(t,"debug",e)}})},search:!1},{title:(0,F.jsx)(k.FormattedMessage,{id:"createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",valueType:"dateTime",width:180,search:!1},{title:(0,F.jsx)(k.FormattedMessage,{id:"updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",valueType:"dateTime",width:180,search:!1},{title:(0,F.jsx)(k.FormattedMessage,{id:"action",defaultMessage:"操作"}),key:"option",dataIndex:"option",hideInSearch:!0,width:220,fixed:"right",render:function(t,r){return(0,F.jsxs)(v.Z,{children:[(0,F.jsx)(M.ZP,{type:"link",onClick:function(){return function(e){E(!0),N(e),o(!0)}(r)},children:(0,F.jsx)(k.FormattedMessage,{id:"edit",defaultMessage:"编辑"})}),(0,F.jsx)(Z.Z,{title:e.formatMessage({id:"deleteTip",defaultMessage:"删除提示"}),description:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(r.name,"】?"),onConfirm:function(){return function(t){var r;g.Z.confirm({title:e.formatMessage({id:"deleteTip",defaultMessage:"删除确认"}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(t.name,"】？"),okText:e.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"cancel",defaultMessage:"取消"}),onOk:(r=m()(p()().mark((function r(){var a;return p()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return I.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"正在删除..."})),r.prev=1,r.next=4,(0,S.nd)({uid:t.uid});case 4:a=r.sent,I.yw.destroy(),200===a.code?(I.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"删除成功"})),W()):I.yw.error(a.message||e.formatMessage({id:"request.error",defaultMessage:"请求失败"})),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),I.yw.destroy(),I.yw.error(e.formatMessage({id:"request.error",defaultMessage:"请求失败"}));case 13:case"end":return r.stop()}}),r,null,[[1,9]])}))),function(){return r.apply(this,arguments)})})}(r)},okText:e.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,F.jsx)(M.ZP,{type:"link",danger:!0,children:(0,F.jsx)(k.FormattedMessage,{id:"delete",defaultMessage:"删除"})})})]})}}]}),[e]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(w.Z,{rowKey:"uid",actionRef:t,columns:K,cardBordered:!0,scroll:{x:1400},headerTitle:e.formatMessage({id:"email.list",defaultMessage:"邮箱应用列表"}),toolBarRender:function(){return[(0,F.jsx)(M.ZP,{type:"primary",icon:(0,F.jsx)(y.Z,{}),onClick:z,children:(0,F.jsx)(k.FormattedMessage,{id:"create",defaultMessage:"新建"})},"create"),(0,F.jsx)(M.ZP,{icon:(0,F.jsx)(b.Z,{}),onClick:W},"refresh")]},search:{labelWidth:"auto"},request:function(){var t=m()(p()().mark((function t(a){var n,s,i,o,u,c,x,m,f,h,g,j;return p()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=(s=a).current,o=s.pageSize,u=s.keyword,c=d()(s,C),x=(i||1)-1,m=o||10,f=l()({pageNumber:x,pageSize:m,orgUid:null==r?void 0:r.uid,searchText:(null==u||null===(n=u.trim)||void 0===n?void 0:n.call(u))||void 0},c),t.prev=4,t.next=7,(0,S.eg)(f);case 7:if(h=t.sent,console.log("queryEmailsByOrg resp:",h,f),200!==h.code){t.next=11;break}return t.abrupt("return",{data:(null===(g=h.data)||void 0===g?void 0:g.content)||[],success:!0,total:(null===(j=h.data)||void 0===j?void 0:j.totalElements)||0});case 11:return I.yw.error(h.message||e.formatMessage({id:"request.error",defaultMessage:"请求失败"})),t.abrupt("return",{data:[],success:!1});case 15:return t.prev=15,t.t0=t.catch(4),I.yw.error(e.formatMessage({id:"request.error",defaultMessage:"请求失败"})),t.abrupt("return",{data:[],success:!1});case 19:case"end":return t.stop()}}),t,null,[[4,15]])})));return function(e){return t.apply(this,arguments)}}(),pagination:{showSizeChanger:!0},options:{fullScreen:!1,setting:!0,reload:!1}}),i&&(0,F.jsx)(A,{open:i,isEdit:f,email:q,loading:D,onClose:function(){return o(!1)},onSubmit:function(){var t=m()(p()().mark((function t(r){var a;return p()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(H(!0),t.prev=1,!f){t.next=8;break}return t.next=5,(0,S.s)(l()(l()({},r),{},{uid:null==q?void 0:q.uid}));case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,(0,S.D$)(r);case 10:t.t0=t.sent;case 11:200===(a=t.t0).code?(I.yw.success(e.formatMessage({id:f?"update.success":"create.success",defaultMessage:f?"更新成功":"创建成功"})),o(!1),W()):I.yw.error(a.message||e.formatMessage({id:"request.error",defaultMessage:"请求失败"}));case 13:return t.prev=13,H(!1),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])})));return function(e){return t.apply(this,arguments)}}()})]})},P=r(32525),q=r(41196),N=r(13847),O=r(39497),L="/api/v1/email-template";function D(e){return H.apply(this,arguments)}function H(){return(H=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("".concat(L,"/query/org"),{method:"GET",params:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return z.apply(this,arguments)}function z(){return(z=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("".concat(L,"/create"),{method:"POST",data:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return B.apply(this,arguments)}function B(){return(B=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("".concat(L,"/update"),{method:"POST",data:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){return G.apply(this,arguments)}function G(){return(G=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("".concat(L,"/delete"),{method:"POST",data:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X=["current","pageSize","keyword"],Y=P.Z.TextArea,_=function(){var e=(0,k.useIntl)(),t=(0,a.useRef)(),r=(0,T.u)((function(e){return e.currentOrg})),n=q.Z.useForm(),s=h()(n,1)[0],i=(0,a.useState)(!1),o=h()(i,2),u=o[0],c=o[1],x=(0,a.useState)(!1),f=h()(x,2),S=f[0],E=f[1],A=(0,a.useState)(void 0),C=h()(A,2),R=C[0],O=C[1],L=(0,a.useState)(!1),H=h()(L,2),z=H[0],B=H[1],G=function(){var e;return null===(e=t.current)||void 0===e?void 0:e.reload()},_=function(){E(!1),O(void 0),s.resetFields(),c(!0)},J=(0,a.useMemo)((function(){return[{dataIndex:"index",valueType:"indexBorder",width:48,align:"center"},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.template.name",defaultMessage:"模板名称"}),dataIndex:"name",copyable:!0,ellipsis:!0},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.template.subject",defaultMessage:"邮件主题"}),dataIndex:"subject",ellipsis:!0},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.template.type",defaultMessage:"模板类型"}),dataIndex:"templateType",width:120,valueEnum:{TICKET_REPLY:{text:"工单回复"},MARKETING:{text:"营销"},NOTIFICATION:{text:"通知"},SYSTEM:{text:"系统"}}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.template.status",defaultMessage:"状态"}),dataIndex:"status",width:100,valueEnum:{DRAFT:{text:"草稿"},PUBLISHED:{text:"已发布"},ARCHIVED:{text:"已归档"}}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.template.enabled",defaultMessage:"启用"}),dataIndex:"enabled",width:80,valueType:"switch",render:function(e,t){return t.enabled?"是":"否"},search:!1},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.template.content",defaultMessage:"模板内容"}),dataIndex:"content",ellipsis:!0,render:function(e,t){return t.content||"-"}},{title:(0,F.jsx)(k.FormattedMessage,{id:"createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",valueType:"dateTime",width:180,search:!1},{title:(0,F.jsx)(k.FormattedMessage,{id:"updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",valueType:"dateTime",width:180,search:!1},{title:(0,F.jsx)(k.FormattedMessage,{id:"action",defaultMessage:"操作"}),key:"option",dataIndex:"option",hideInSearch:!0,width:220,fixed:"right",render:function(t,r){return(0,F.jsxs)(v.Z,{children:[(0,F.jsx)(M.ZP,{type:"link",onClick:function(){return function(e){E(!0),O(e),s.setFieldsValue({name:e.name,subject:e.subject,preheader:e.preheader,content:e.content,plainText:e.plainText,contentType:e.contentType,templateType:e.templateType,status:e.status,enabled:e.enabled}),c(!0)}(r)},children:(0,F.jsx)(k.FormattedMessage,{id:"edit",defaultMessage:"编辑"})}),(0,F.jsx)(Z.Z,{title:e.formatMessage({id:"deleteTip",defaultMessage:"删除提示"}),description:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(r.name,"】?"),onConfirm:function(){return function(t){var r;g.Z.confirm({title:e.formatMessage({id:"deleteTip",defaultMessage:"删除确认"}),content:"".concat(e.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(t.name,"】？"),okText:e.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"cancel",defaultMessage:"取消"}),onOk:(r=m()(p()().mark((function r(){var a;return p()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return I.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"正在删除..."})),r.prev=1,r.next=4,K({uid:t.uid});case 4:a=r.sent,I.yw.destroy(),200===a.code?(I.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"删除成功"})),G()):I.yw.error(a.message||e.formatMessage({id:"request.error",defaultMessage:"请求失败"})),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),I.yw.destroy(),I.yw.error(e.formatMessage({id:"request.error",defaultMessage:"请求失败"}));case 13:case"end":return r.stop()}}),r,null,[[1,9]])}))),function(){return r.apply(this,arguments)})})}(r)},okText:e.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,F.jsx)(M.ZP,{type:"link",danger:!0,children:(0,F.jsx)(k.FormattedMessage,{id:"delete",defaultMessage:"删除"})})})]})}}]}),[e]),V=function(){var t=m()(p()().mark((function t(){var a,n,i;return p()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.validateFields();case 2:if(a=t.sent,B(!0),t.prev=4,n=l()(l()({},a),{},{uid:S?null==R?void 0:R.uid:void 0,orgUid:null==r?void 0:r.uid}),!S){t.next=12;break}return t.next=9,U(n);case 9:t.t0=t.sent,t.next=15;break;case 12:return t.next=14,W(n);case 14:t.t0=t.sent;case 15:200===(i=t.t0).code?(I.yw.success(e.formatMessage({id:S?"update.success":"create.success",defaultMessage:S?"更新成功":"创建成功"})),c(!1),G()):I.yw.error(i.message||e.formatMessage({id:"request.error",defaultMessage:"请求失败"}));case 17:return t.prev=17,B(!1),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[4,,17,20]])})));return function(){return t.apply(this,arguments)}}();return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(w.Z,{rowKey:"uid",actionRef:t,columns:J,cardBordered:!0,scroll:{x:1e3},headerTitle:e.formatMessage({id:"email.template.list",defaultMessage:"邮件模板列表"}),toolBarRender:function(){return[(0,F.jsx)(M.ZP,{type:"primary",icon:(0,F.jsx)(y.Z,{}),onClick:_,children:(0,F.jsx)(k.FormattedMessage,{id:"create",defaultMessage:"新建"})},"create"),(0,F.jsx)(M.ZP,{icon:(0,F.jsx)(b.Z,{}),onClick:G},"refresh")]},search:{labelWidth:"auto"},request:function(){var t=m()(p()().mark((function t(a){var n,s,i,o,u,c,x,m,f,h,g,j;return p()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=(s=a).current,o=s.pageSize,u=s.keyword,c=d()(s,X),x=(i||1)-1,m=o||10,f=l()({pageNumber:x,pageSize:m,orgUid:null==r?void 0:r.uid,searchText:(null==u||null===(n=u.trim)||void 0===n?void 0:n.call(u))||void 0},c),t.prev=4,t.next=7,D(f);case 7:if(200!==(h=t.sent).code){t.next=10;break}return t.abrupt("return",{data:(null===(g=h.data)||void 0===g?void 0:g.content)||[],success:!0,total:(null===(j=h.data)||void 0===j?void 0:j.totalElements)||0});case 10:return I.yw.error(h.message||e.formatMessage({id:"request.error",defaultMessage:"请求失败"})),t.abrupt("return",{data:[],success:!1});case 14:return t.prev=14,t.t0=t.catch(4),I.yw.error(e.formatMessage({id:"request.error",defaultMessage:"请求失败"})),t.abrupt("return",{data:[],success:!1});case 18:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e){return t.apply(this,arguments)}}(),pagination:{showSizeChanger:!0},options:{fullScreen:!1,setting:!0,reload:!1}}),(0,F.jsx)(g.Z,{open:u,title:S?e.formatMessage({id:"edit",defaultMessage:"编辑"}):e.formatMessage({id:"create",defaultMessage:"新建"}),onCancel:function(){return c(!1)},onOk:V,confirmLoading:z,destroyOnClose:!0,okText:e.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:e.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,F.jsxs)(q.Z,{form:s,layout:"vertical",preserve:!1,initialValues:{name:"",subject:"",preheader:"",content:"",plainText:"",contentType:"HTML",templateType:"TICKET_REPLY",status:"DRAFT",enabled:!0},children:[(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.name",defaultMessage:"模板名称"}),name:"name",rules:[{required:!0,message:e.formatMessage({id:"name.required",defaultMessage:"请输入名称"})}],children:(0,F.jsx)(P.Z,{placeholder:e.formatMessage({id:"name.placeholder",defaultMessage:"请输入模板名称"})})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.subject",defaultMessage:"邮件主题"}),name:"subject",children:(0,F.jsx)(P.Z,{placeholder:e.formatMessage({id:"subject.placeholder",defaultMessage:"请输入邮件主题，可包含变量"})})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.preheader",defaultMessage:"预览文本"}),name:"preheader",children:(0,F.jsx)(P.Z,{placeholder:e.formatMessage({id:"preheader.placeholder",defaultMessage:"用于邮件客户端预览的简短文本"})})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.content",defaultMessage:"模板内容"}),name:"content",rules:[{required:!0,message:e.formatMessage({id:"content.required",defaultMessage:"请输入模板内容"})}],children:(0,F.jsx)(Y,{rows:6,placeholder:e.formatMessage({id:"content.placeholder",defaultMessage:"请输入模板HTML或文本内容"})})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.plainText",defaultMessage:"纯文本内容"}),name:"plainText",children:(0,F.jsx)(Y,{rows:4,placeholder:e.formatMessage({id:"plaintext.placeholder",defaultMessage:"可选：纯文本版本内容"})})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.contentType",defaultMessage:"内容类型"}),name:"contentType",children:(0,F.jsx)(N.Z,{options:[{value:"HTML",label:"HTML"},{value:"MARKDOWN",label:"MARKDOWN"},{value:"TEXT",label:"TEXT"}]})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.type",defaultMessage:"模板类型"}),name:"templateType",children:(0,F.jsx)(N.Z,{options:[{value:"TICKET_REPLY",label:"工单回复"},{value:"MARKETING",label:"营销"},{value:"NOTIFICATION",label:"通知"},{value:"SYSTEM",label:"系统"}]})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.status",defaultMessage:"状态"}),name:"status",children:(0,F.jsx)(N.Z,{options:[{value:"DRAFT",label:"草稿"},{value:"PUBLISHED",label:"已发布"},{value:"ARCHIVED",label:"已归档"}]})}),(0,F.jsx)(q.Z.Item,{label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.enabled",defaultMessage:"启用"}),name:"enabled",valuePropName:"checked",children:(0,F.jsx)(j.Z,{})})]})})]})},J=r(59533),V=r(78578),Q=r(81739),$=r(31806),ee=r(40209),te=r(15722),re=r(90297),ae=r(59145),ne=r(59304),se=r(54881),le=r(77647);function ie(e){return de.apply(this,arguments)}function de(){return(de=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("/api/v1/email/message/query/org",{method:"GET",params:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e){return ue.apply(this,arguments)}function ue(){return ue=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("/api/v1/email/message/create",{method:"POST",data:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)}))),ue.apply(this,arguments)}function ce(e){return pe.apply(this,arguments)}function pe(){return pe=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("/api/v1/email/message/update",{method:"POST",data:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}function xe(e){return me.apply(this,arguments)}function me(){return me=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("/api/v1/email/message/delete",{method:"POST",data:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)}))),me.apply(this,arguments)}function fe(e){return he.apply(this,arguments)}function he(){return he=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("/api/v1/email/message/send",{method:"POST",data:l()(l()({},t),{},{channel:O.XtJ})}));case 1:case"end":return e.stop()}}),e)}))),he.apply(this,arguments)}var ge=r(83001),je=r(82864),ve=r(34201),Me=r(79489),Ze=r(62640),ye=r(10938),be=P.Z.TextArea,we=N.Z.Option,ke=ge.Z.Title,Te=function(e){var t=e.open,r=e.onClose,n=e.onSuccess,s=(e.workgroupUid,e.replyToEmail),i=q.Z.useForm(),d=h()(i,1)[0],o=a.useState(!1),u=h()(o,2),c=u[0],x=u[1],f=(0,ye.n)((function(e){return e.currentEmail})),g=!!s,j=function(){var e=m()(p()().mark((function e(t){var a;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.prev=1,e.next=4,fe(l()(l()({},t),{},{emailConfigUid:null==f?void 0:f.uid}));case 4:200===(a=e.sent).code?(I.yw.success("邮件发送成功"),d.resetFields(),r(),null==n||n()):I.yw.error(a.message||"邮件发送失败"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),I.yw.error("邮件发送失败");case 11:return e.prev=11,x(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(){d.resetFields(),r()};return a.useEffect((function(){if(t&&g&&s){var e,r=null!==(e=s.subject)&&void 0!==e&&e.startsWith("Re:")?s.subject:"Re: ".concat(s.subject||""),a="\n\n---------- 原始邮件 ----------\n发件人: ".concat(s.fromName||""," <").concat(s.fromAddress||"",">\n发送时间: ").concat(s.emailDate?new Date(s.emailDate).toLocaleString():"","\n收件人: ").concat(s.toAddresses||"","\n主题: ").concat(s.subject||"","\n\n").concat(s.contentText||"");d.setFieldsValue({subject:r,toAddresses:s.fromAddress,textContent:a})}else t&&!g&&d.resetFields()}),[t,g,s,d]),(0,F.jsx)(je.Z,{title:(0,F.jsxs)(v.Z,{children:[g?(0,F.jsx)(ae.Z,{}):(0,F.jsx)(le.Z,{}),(0,F.jsx)(ke,{level:4,style:{margin:0},children:g?"回复邮件":"发送邮件"})]}),open:t,onClose:Z,width:600,extra:(0,F.jsxs)(v.Z,{children:[(0,F.jsx)(M.ZP,{onClick:Z,children:"取消"}),(0,F.jsx)(M.ZP,{type:"primary",icon:g?(0,F.jsx)(ae.Z,{}):(0,F.jsx)(le.Z,{}),loading:c,onClick:function(){return d.submit()},children:g?"回复":"发送"})]}),children:(0,F.jsxs)(q.Z,{form:d,layout:"vertical",onFinish:j,initialValues:{priority:3,requestReceipt:!1,encoding:"UTF-8"},children:[(0,F.jsx)(q.Z.Item,{label:"发送者邮箱",children:(0,F.jsx)(P.Z,{value:(null==f?void 0:f.emailAddress)||"未选择邮箱",readOnly:!0,disabled:!0,style:{backgroundColor:"#f5f5f5"}})}),(0,F.jsx)(q.Z.Item,{name:"subject",label:"邮件主题",rules:[{required:!0,message:"请输入邮件主题"}],children:(0,F.jsx)(P.Z,{placeholder:"请输入邮件主题"})}),(0,F.jsx)(q.Z.Item,{name:"toAddresses",label:"收件人",rules:[{required:!0,message:"请输入收件人邮箱"}],children:(0,F.jsx)(P.Z,{placeholder:"收件人邮箱地址，多个用逗号分隔"})}),(0,F.jsxs)(ve.Z,{gutter:16,children:[(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"ccAddresses",label:"抄送",children:(0,F.jsx)(P.Z,{placeholder:"抄送邮箱地址，多个用逗号分隔"})})}),(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"bccAddresses",label:"密送",children:(0,F.jsx)(P.Z,{placeholder:"密送邮箱地址，多个用逗号分隔"})})})]}),(0,F.jsx)(Ze.Z,{}),(0,F.jsx)(q.Z.Item,{name:"textContent",label:"邮件内容（文本）",rules:[{required:!0,message:"请输入邮件内容"}],children:(0,F.jsx)(be,{rows:8,placeholder:"请输入邮件文本内容",showCount:!0,maxLength:5e3})}),(0,F.jsx)(q.Z.Item,{name:"htmlContent",label:"邮件内容（HTML）",help:"可选，如果填写HTML内容，将以HTML格式发送",children:(0,F.jsx)(be,{rows:6,placeholder:"邮件HTML内容（可选）",showCount:!0,maxLength:1e4})}),(0,F.jsx)(Ze.Z,{}),(0,F.jsxs)(ve.Z,{gutter:16,children:[(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"priority",label:"优先级",children:(0,F.jsxs)(N.Z,{placeholder:"选择优先级",children:[(0,F.jsx)(we,{value:1,children:"高优先级"}),(0,F.jsx)(we,{value:3,children:"普通优先级"}),(0,F.jsx)(we,{value:5,children:"低优先级"})]})})}),(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"requestReceipt",label:"请求送达回执",children:(0,F.jsxs)(N.Z,{placeholder:"是否请求送达回执",children:[(0,F.jsx)(we,{value:!0,children:"是"}),(0,F.jsx)(we,{value:!1,children:"否"})]})})})]}),(0,F.jsx)(q.Z.Item,{name:"encoding",label:"邮件编码",children:(0,F.jsxs)(N.Z,{placeholder:"选择邮件编码",children:[(0,F.jsx)(we,{value:"UTF-8",children:"UTF-8"}),(0,F.jsx)(we,{value:"GBK",children:"GBK"}),(0,F.jsx)(we,{value:"ISO-8859-1",children:"ISO-8859-1"})]})})]})})},Ie=r(40122),Se=r(92354),Ee=function(e){var t=e.content,r=e.style,a=e.maxHeight,n=void 0===a?300:a,s=e.showBorder,i=void 0===s||s,d=e.className;if(!t||""===t.trim())return(0,F.jsx)("div",{className:d,style:l()({border:i?"1px solid #d9d9d9":"none",borderRadius:"6px",padding:"16px",minHeight:"60px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fafafa"},r),children:(0,F.jsx)(Se.Z,{description:"无内容",image:Se.Z.PRESENTED_IMAGE_SIMPLE,style:{margin:0}})});return(0,F.jsx)("div",{className:d,style:l()({border:i?"1px solid #d9d9d9":"none",borderRadius:"6px",padding:"12px",backgroundColor:"#fff",maxHeight:n,overflow:"auto"},r),children:(0,F.jsx)("div",{dangerouslySetInnerHTML:{__html:t},style:{lineHeight:1.6,fontSize:"14px",color:"#333",wordWrap:"break-word",wordBreak:"break-all"}})})},Fe=r(55785),Ae=P.Z.TextArea,Ce=N.Z.Option,Re=ge.Z.Title,Pe=ge.Z.Text,qe=function(e){var t=e.open,r=e.onClose,n=e.onSuccess,s=e.workgroupUid,i=e.editingRecord,d=e.mode,o=void 0===d?"view":d,u=q.Z.useForm(),c=h()(u,1)[0],x=a.useState(!1),f=h()(x,2),g=f[0],j=f[1],Z="view"===o,y="edit"===o,b="create"===o;a.useEffect((function(){t&&i?c.setFieldsValue(i):t&&b&&c.resetFields()}),[t,i,c,b]);var w,k,T=function(){var e=m()(p()().mark((function e(t){var r,a,d;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j(!0),e.prev=1,!y||!i){e.next=9;break}return e.next=5,ce(l()(l()({},t),{},{uid:i.uid,workgroupUid:s}));case 5:200===(a=e.sent).code&&J.ZP.success("更新成功"),e.next=14;break;case 9:if(!b){e.next=14;break}return e.next=12,oe(l()(l()({},t),{},{workgroupUid:s}));case 12:200===(a=e.sent).code&&J.ZP.success("创建成功");case 14:200===(null===(r=a)||void 0===r?void 0:r.code)?(I(),null==n||n()):J.ZP.error((null===(d=a)||void 0===d?void 0:d.message)||"操作失败"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),J.ZP.error("保存失败");case 20:return e.prev=20,j(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[1,17,20,23]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){c.resetFields(),r()};return(0,F.jsx)(je.Z,{title:(0,F.jsxs)(v.Z,{children:[Z?(0,F.jsx)(re.Z,{}):(0,F.jsx)(ne.Z,{}),(0,F.jsx)(Re,{level:4,style:{margin:0},children:Z?"邮件详情":y?"编辑邮件记录":b?"新增邮件记录":"邮件记录"})]}),open:t,onClose:I,width:700,extra:(0,F.jsxs)(v.Z,{children:[(0,F.jsx)(M.ZP,{onClick:I,children:"取消"}),!Z&&(0,F.jsx)(M.ZP,{type:"primary",icon:(0,F.jsx)(Fe.Z,{}),loading:g,onClick:function(){return c.submit()},children:"保存"})]}),children:Z?(0,F.jsx)("div",{children:(0,F.jsxs)(Ie.Z,{column:1,bordered:!0,children:[(0,F.jsx)(Ie.Z.Item,{label:"邮件主题",children:(0,F.jsxs)(v.Z,{children:[(0,F.jsx)($.Z,{}),(0,F.jsx)(Pe,{strong:!0,children:(null==i?void 0:i.subject)||"无主题"})]})}),(0,F.jsx)(Ie.Z.Item,{label:"邮件ID",children:(null==i?void 0:i.messageId)||"-"}),(0,F.jsx)(Ie.Z.Item,{label:"发件人",children:(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{children:(0,F.jsx)(Pe,{strong:!0,children:(null==i?void 0:i.fromName)||"未知"})}),(0,F.jsx)(Pe,{type:"secondary",children:null==i?void 0:i.fromAddress})]})}),(0,F.jsx)(Ie.Z.Item,{label:"收件人",children:(null==i?void 0:i.toAddresses)||"-"}),(0,F.jsx)(Ie.Z.Item,{label:"抄送",children:(null==i?void 0:i.ccAddresses)||"-"}),(0,F.jsx)(Ie.Z.Item,{label:"密送",children:(null==i?void 0:i.bccAddresses)||"-"}),(0,F.jsx)(Ie.Z.Item,{label:"状态",children:null!=i&&i.status?(w=i.status,k={SUCCESS:{color:"green",text:"成功"},FAILED:{color:"red",text:"失败"},PENDING:{color:"orange",text:"待发送"},RETRY:{color:"blue",text:"重试中"}}[w]||{color:"default",text:"未知"},(0,F.jsx)(Q.Z,{color:k.color,children:k.text})):"-"}),(0,F.jsx)(Ie.Z.Item,{label:"重要性",children:null!=i&&i.important?(0,F.jsx)(Q.Z,{color:"red",children:"重要"}):(0,F.jsx)(Q.Z,{children:"普通"})}),(0,F.jsx)(Ie.Z.Item,{label:"是否有附件",children:null!=i&&i.hasAttachments?(0,F.jsx)(Q.Z,{color:"blue",children:"有附件"}):(0,F.jsx)(Q.Z,{children:"无附件"})}),(0,F.jsx)(Ie.Z.Item,{label:"邮件时间",children:null!=i&&i.emailDate?new Date(i.emailDate).toLocaleString():"-"}),(0,F.jsx)(Ie.Z.Item,{label:"邮件大小",children:null!=i&&i.emailSize?"".concat((i.emailSize/1024).toFixed(1),"KB"):"-"}),(0,F.jsx)(Ie.Z.Item,{label:"邮件内容（文本）",children:(0,F.jsx)("div",{style:{maxHeight:"200px",overflow:"auto",whiteSpace:"pre-wrap",backgroundColor:"#f5f5f5",padding:"8px",borderRadius:"4px"},children:(null==i?void 0:i.contentText)||"无内容"})}),(null==i?void 0:i.contentHtml)&&(0,F.jsx)(Ie.Z.Item,{label:"邮件内容（HTML）",children:(0,F.jsx)(Ee,{content:i.contentHtml,maxHeight:300,style:{backgroundColor:"#f5f5f5"}})}),(null==i?void 0:i.errorMessage)&&(0,F.jsx)(Ie.Z.Item,{label:"错误信息",children:(0,F.jsx)(Pe,{type:"danger",children:i.errorMessage})})]})}):(0,F.jsxs)(q.Z,{form:c,layout:"vertical",onFinish:T,children:[(0,F.jsxs)(ve.Z,{gutter:16,children:[(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"subject",label:"邮件主题",rules:[{required:!0,message:"请输入邮件主题"}],children:(0,F.jsx)(P.Z,{placeholder:"请输入邮件主题"})})}),(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"messageId",label:"邮件ID",children:(0,F.jsx)(P.Z,{placeholder:"邮件唯一标识符"})})})]}),(0,F.jsxs)(ve.Z,{gutter:16,children:[(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"fromAddress",label:"发件人邮箱",rules:[{required:!0,message:"请输入发件人邮箱"},{type:"email",message:"请输入有效的邮箱地址"}],children:(0,F.jsx)(P.Z,{placeholder:"发件人邮箱地址"})})}),(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"fromName",label:"发件人姓名",children:(0,F.jsx)(P.Z,{placeholder:"发件人姓名"})})})]}),(0,F.jsx)(q.Z.Item,{name:"toAddresses",label:"收件人",rules:[{required:!0,message:"请输入收件人邮箱"}],children:(0,F.jsx)(P.Z,{placeholder:"收件人邮箱地址，多个用逗号分隔"})}),(0,F.jsxs)(ve.Z,{gutter:16,children:[(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"ccAddresses",label:"抄送",children:(0,F.jsx)(P.Z,{placeholder:"抄送邮箱地址，多个用逗号分隔"})})}),(0,F.jsx)(Me.Z,{span:12,children:(0,F.jsx)(q.Z.Item,{name:"bccAddresses",label:"密送",children:(0,F.jsx)(P.Z,{placeholder:"密送邮箱地址，多个用逗号分隔"})})})]}),(0,F.jsx)(Ze.Z,{}),(0,F.jsx)(q.Z.Item,{name:"contentText",label:"邮件内容（文本）",children:(0,F.jsx)(Ae,{rows:6,placeholder:"邮件文本内容",showCount:!0,maxLength:5e3})}),(0,F.jsx)(q.Z.Item,{name:"contentHtml",label:"邮件内容（HTML）",children:(0,F.jsx)(Ae,{rows:4,placeholder:"邮件HTML内容",showCount:!0,maxLength:1e4})}),(0,F.jsx)(Ze.Z,{}),(0,F.jsxs)(ve.Z,{gutter:16,children:[(0,F.jsx)(Me.Z,{span:8,children:(0,F.jsx)(q.Z.Item,{name:"status",label:"状态",children:(0,F.jsxs)(N.Z,{placeholder:"选择状态",children:[(0,F.jsx)(Ce,{value:"SUCCESS",children:"成功"}),(0,F.jsx)(Ce,{value:"FAILED",children:"失败"}),(0,F.jsx)(Ce,{value:"PENDING",children:"待发送"}),(0,F.jsx)(Ce,{value:"RETRY",children:"重试中"})]})})}),(0,F.jsx)(Me.Z,{span:8,children:(0,F.jsx)(q.Z.Item,{name:"important",label:"重要性",children:(0,F.jsxs)(N.Z,{placeholder:"选择重要性",children:[(0,F.jsx)(Ce,{value:!0,children:"重要"}),(0,F.jsx)(Ce,{value:!1,children:"普通"})]})})}),(0,F.jsx)(Me.Z,{span:8,children:(0,F.jsx)(q.Z.Item,{name:"hasAttachments",label:"是否有附件",children:(0,F.jsxs)(N.Z,{placeholder:"是否有附件",children:[(0,F.jsx)(Ce,{value:!0,children:"有"}),(0,F.jsx)(Ce,{value:!1,children:"无"})]})})})]}),(0,F.jsx)(q.Z.Item,{name:"errorMessage",label:"错误信息",children:(0,F.jsx)(Ae,{rows:2,placeholder:"错误信息"})})]})})},Ne=["current","pageSize","keyword"],Oe=ge.Z.Text,Le=function(e){var t=e.workgroupUid,r=(0,a.useRef)(),n=(0,a.useState)(!1),s=h()(n,2),i=s[0],o=s[1],u=(0,a.useState)("view"),c=h()(u,2),x=c[0],f=c[1],g=(0,a.useState)(!1),j=h()(g,2),y=j[0],I=j[1],S=(0,a.useState)(null),E=h()(S,2),A=E[0],C=E[1],R=(0,a.useState)(null),P=h()(R,2),q=P[0],N=P[1],O=(0,T.u)((function(e){return e.currentOrg})),L=(0,ye.n)((function(e){return e.currentEmail})),D=function(){C(null),I(!0)},H=function(){var e=m()(p()().mark((function e(t){var a;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe({uid:t.uid});case 3:200===e.sent.code&&(J.ZP.success("删除成功"),null===(a=r.current)||void 0===a||a.reload()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),J.ZP.error("删除失败");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),W=[{dataIndex:"index",valueType:"indexBorder",width:56,align:"center"},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.subject",defaultMessage:"主题"}),dataIndex:"subject",key:"subject",fixed:"left",width:260,ellipsis:!0,render:function(e,t){return(0,F.jsxs)(v.Z,{children:[(0,F.jsx)($.Z,{}),(0,F.jsx)(V.Z,{title:e,children:(0,F.jsx)(Oe,{strong:!t.read,children:e||"无主题"})}),t.hasAttachments&&(0,F.jsx)(ee.Z,{})]})}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.type",defaultMessage:"类型"}),dataIndex:"type",key:"type",width:100,render:function(e){var t={SENT:{color:"blue",text:"发送"},RECEIVED:{color:"green",text:"接收"},DRAFT:{color:"orange",text:"草稿"},REPLY:{color:"purple",text:"回复"},FORWARD:{color:"cyan",text:"转发"}}[e]||{color:"default",text:"未知"};return(0,F.jsx)(Q.Z,{color:t.color,children:t.text})}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.from",defaultMessage:"发件人"}),dataIndex:"fromAddress",key:"fromAddress",width:200,render:function(e,t){return(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{children:t.fromName||"未知"}),(0,F.jsx)(Oe,{type:"secondary",style:{fontSize:"12px"},children:e})]})}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.to",defaultMessage:"收件人"}),dataIndex:"toAddresses",key:"toAddresses",ellipsis:!0,width:200,render:function(e){return(0,F.jsx)(V.Z,{title:e,children:(0,F.jsx)(Oe,{children:e})})}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.cc",defaultMessage:"抄送"}),dataIndex:"ccAddresses",key:"ccAddresses",ellipsis:!0,width:200,render:function(e){return(0,F.jsx)(V.Z,{title:e,children:(0,F.jsx)(Oe,{children:e||"-"})})}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.status",defaultMessage:"状态"}),dataIndex:"status",key:"status",width:100,render:function(e){var t={SUCCESS:{color:"green",text:"成功"},FAILED:{color:"red",text:"失败"},PENDING:{color:"orange",text:"待发送"},RETRY:{color:"blue",text:"重试中"}}[e]||{color:"default",text:"未知"};return(0,F.jsx)(Q.Z,{color:t.color,children:t.text})}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.important",defaultMessage:"重要性"}),dataIndex:"important",key:"important",width:80,render:function(e){return e?(0,F.jsx)(te.Z,{style:{color:"red"}}):null}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.date",defaultMessage:"时间"}),dataIndex:"emailDate",key:"emailDate",valueType:"dateTime",width:180},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.size",defaultMessage:"大小"}),dataIndex:"emailSize",key:"emailSize",width:100,render:function(e){return e?"".concat((e/1024).toFixed(1),"KB"):"-"}},{title:(0,F.jsx)(k.FormattedMessage,{id:"email.message.preview",defaultMessage:"内容预览"}),dataIndex:"contentText",key:"contentText",width:300,ellipsis:!0,render:function(e,t){return(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{style:{marginBottom:"4px"},children:(0,F.jsx)(Q.Z,{color:"default",style:{fontSize:"10px",padding:"0 4px"},children:"TEXT"})}),(0,F.jsx)(V.Z,{title:e,children:(0,F.jsx)(Oe,{type:"secondary",style:{fontSize:"12px"},children:(null==e?void 0:e.substring(0,50))||"-"})})]})}},{title:(0,F.jsx)(k.FormattedMessage,{id:"action",defaultMessage:"操作"}),key:"action",dataIndex:"option",fixed:"right",width:220,hideInSearch:!0,render:function(e,t){return(0,F.jsxs)(v.Z,{size:"small",children:[(0,F.jsx)(V.Z,{title:"查看",children:(0,F.jsx)(M.ZP,{type:"text",icon:(0,F.jsx)(re.Z,{}),onClick:function(){N(t),f("view"),o(!0)}})}),(0,F.jsx)(V.Z,{title:"回复",children:(0,F.jsx)(M.ZP,{type:"text",icon:(0,F.jsx)(ae.Z,{}),onClick:function(){return function(e){C(e),I(!0)}(t)}})}),(0,F.jsx)(V.Z,{title:"编辑",children:(0,F.jsx)(M.ZP,{type:"text",icon:(0,F.jsx)(ne.Z,{}),onClick:function(){N(t),f("edit"),o(!0)}})}),(0,F.jsx)(Z.Z,{title:"确定删除这条邮件记录吗？",onConfirm:function(){return H(t)},okText:"确定",cancelText:"取消",children:(0,F.jsx)(M.ZP,{type:"text",danger:!0,icon:(0,F.jsx)(se.Z,{})})})]})}}];return(0,a.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.reload()}),[t,null==O?void 0:O.uid,null==L?void 0:L.emailAddress]),(0,F.jsxs)("div",{children:[(0,F.jsx)(w.Z,{rowKey:"uid",actionRef:r,columns:W,cardBordered:!0,scroll:{x:1800},headerTitle:(0,F.jsxs)("span",{children:[(0,F.jsx)($.Z,{})," 邮件消息管理"]}),toolBarRender:function(){return[(0,F.jsx)(M.ZP,{type:"primary",icon:(0,F.jsx)(le.Z,{}),onClick:D,children:"发送邮件"},"create"),(0,F.jsx)(M.ZP,{icon:(0,F.jsx)(b.Z,{}),onClick:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.reload()}},"refresh")]},search:{labelWidth:"auto"},request:function(){var e=m()(p()().mark((function e(t){var r,a,n,s,i,o,u,c,x,m,f,h;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).current,s=a.pageSize,i=a.keyword,o=d()(a,Ne),u=(n||1)-1,c=s||10,x=l()({pageNumber:u,pageSize:c,emailAddress:(null==L?void 0:L.emailAddress)||"",orgUid:null==O?void 0:O.uid,searchText:(null==i||null===(r=i.trim)||void 0===r?void 0:r.call(i))||void 0},o||{}),e.prev=4,e.next=7,ie(x);case 7:if(200!==(m=e.sent).code){e.next=10;break}return e.abrupt("return",{data:(null===(f=m.data)||void 0===f?void 0:f.content)||[],success:!0,total:(null===(h=m.data)||void 0===h?void 0:h.totalElements)||0});case 10:return J.ZP.error(m.message||"请求失败"),e.abrupt("return",{data:[],success:!1});case 14:return e.prev=14,e.t0=e.catch(4),J.ZP.error("请求失败"),e.abrupt("return",{data:[],success:!1});case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}(),pagination:{showSizeChanger:!0},options:{fullScreen:!1,setting:!0,reload:!1}}),(0,F.jsx)(qe,{open:i,onClose:function(){o(!1),N(null)},onSuccess:function(){var e;null===(e=r.current)||void 0===e||e.reload()},workgroupUid:t,editingRecord:q,mode:x}),(0,F.jsx)(Te,{open:y,onClose:function(){I(!1),C(null)},onSuccess:function(){var e;null===(e=r.current)||void 0===e||e.reload()},workgroupUid:t,replyToEmail:A})]})},De=function(){return(0,F.jsx)(n.Z,{defaultActiveKey:"table",items:[{key:"table",label:(0,F.jsx)(k.FormattedMessage,{id:"email.app.tab",defaultMessage:"邮箱应用"}),children:(0,F.jsx)(R,{})},{key:"message",label:(0,F.jsx)(k.FormattedMessage,{id:"email.message.tab",defaultMessage:"邮件消息"}),children:(0,F.jsx)(Le,{})},{key:"template",label:(0,F.jsx)(k.FormattedMessage,{id:"email.template.tab",defaultMessage:"邮件模板"}),children:(0,F.jsx)(_,{})}]})}},24388:function(e,t,r){r.d(t,{$:function(){return c}});var a=r(73193),n=r.n(a),s=r(76711),l=r.n(s),i=r(39497),d=r(58063),o=r(66266),u=r(31403),c=(0,d.Ue)()((0,o.mW)((0,o.tJ)((0,u.n)((function(e,t){return{workgroupResult:{data:{content:[]}},currentWorkgroup:{uid:"",nickname:"",avatar:"",description:"",orgUid:""},insertWorkgroup:function(t){e((function(e){e.workgroupResult.data.content.unshift(t)}))},updateWorkgroup:function(t){e((function(e){var r=e.workgroupResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));-1!==a?r[a]=t:console.warn("Workgroup with uid ".concat(t.uid," not found."))}))},deleteWorkgroup:function(t){e((function(e){var r=e.workgroupResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));-1!==a?r.splice(a,1):console.warn("Workgroup with uid ".concat(t.uid," not found."))}))},setWorkgroupResult:function(r){var a;(e({workgroupResult:r}),""===t().currentWorkgroup.uid)&&((null===(a=r.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.length)>0&&e({currentWorkgroup:r.data.content[0]}))},setCurrentWorkgroup:function(r){var a=t().workgroupResult.data.content,s=a.findIndex((function(e){return e.uid===r.uid}));if(-1!==s){var i=[].concat(l()(a.slice(0,s)),[r],l()(a.slice(s+1))),d=n()(n()({},t().workgroupResult),{},{data:{content:i}});e({workgroupResult:d,currentWorkgroup:r})}else console.warn("Workgroup with the specified uid not found."),e({currentWorkgroup:r})},deleteCurrentWorkgroup:function(r){var a=t().workgroupResult.data.content,s=a.findIndex((function(e){return e.uid===r}));-1!==s?e({workgroupResult:n()(n()({},t().workgroupResult),{},{data:{content:[].concat(l()(a.slice(0,s)),l()(a.slice(s+1)))}})}):console.warn("Workgroup not found in cache:",r),t().currentWorkgroup.uid===r&&e({currentWorkgroup:{uid:"",orgUid:""}})},deleteWorkgroupCache:function(){return e({},!0)}}})),{name:i.b6l})))}}]);