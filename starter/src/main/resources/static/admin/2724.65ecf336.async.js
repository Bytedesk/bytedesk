"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2724],{82724:function(e,t,n){n.d(t,{Z:function(){return ge}});var a=n(84176),r=n.n(a),s=n(76711),i=n.n(s),l=n(73193),o=n.n(l),u=n(86222),c=n.n(u),d=n(90819),p=n.n(d),f=n(89933),g=n.n(f),m=n(45332),h=n.n(m),y=n(43388),v=n(94976),x=n(4628);function b(e){return k.apply(this,arguments)}function k(){return(k=g()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/quickreply/query/org",{method:"GET",params:o()(o()({},t),{},{channel:v.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return w.apply(this,arguments)}function w(){return(w=g()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/quickreply/create",{method:"POST",data:o()(o()({},t),{},{channel:v.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return S.apply(this,arguments)}function S(){return(S=g()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/quickreply/update",{method:"POST",data:o()(o()({},t),{},{channel:v.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return C.apply(this,arguments)}function C(){return(C=g()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/quickreply/delete",{method:"POST",data:o()(o()({},t),{},{channel:v.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return U.apply(this,arguments)}function U(){return(U=g()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/quickreply/enable",{method:"POST",data:{uid:t.uid,enabled:t.enabled,channel:v.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=n(74171),T=n(10162),D=n(54881),P=n(93689),E=n(40439),A=n(30617),z=n(2484),I=n(34512),O=n(27729),R=n(90581),B=n(30310),Y=n(69533),L=n(43275),N=n(28508),K=n(44194),Q=n(1715),J=n(8732),X=n(99036),V=n(38106),_=n(59005),H=n(86702),G=n(30857),W=n(47710),$=n(42085),ee=n(96596),te=n.n(ee),ne=n(88722),ae=n(58620),re=n(66406),se=n(78112),ie=n(31549),le=W.Z.Dragger,oe=function(e){var t=e.isEdit,n=e.quickreply,a=e.open,r=e.onClose,s=e.onSubmit,i=X.A.useForm(),l=h()(i,1)[0],u=(0,K.useState)((null==n?void 0:n.content)||""),d=h()(u,2),p=d[0],f=d[1],g=(0,ne.Z)().translateString,m=(0,F.u)((function(e){return e.currentOrg})),x=(0,J.j)((function(e){return e.currentKbase})),b=(0,Q.v)((function(e){return e.categorySelectOptions})),k=(0,Q.v)((function(e){return e.categoryTreeOptions})),M=(0,K.useState)(),w=h()(M,2),j=w[0],S=w[1],q=(0,K.useState)(v.PYi),C=h()(q,2),Z=C[0],U=C[1],T=(0,K.useState)(".png,.jpg,.jpeg"),D=h()(T,2),P=D[0],E=D[1],A=(0,K.useState)({file:void 0,fileName:"test.pdf",fileType:"application/pdf",isAvatar:"false",kbType:"type",categoryUid:"",kbUid:(null==x?void 0:x.uid)||"",channel:v.XtJ}),z=h()(A,2),I=z[0],O=(z[1],function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=c()(n);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.key!==v.zBg)return r.key;var s=e(r.children||[]);if(s)return s}}catch(e){a.e(e)}finally{a.f()}return""});(0,K.useEffect)((function(){if(t)l.setFieldsValue({type:null==n?void 0:n.type,title:null==n?void 0:n.title,content:null==n?void 0:n.content,categoryUid:null==n?void 0:n.categoryUid,kbUid:null==x?void 0:x.uid}),f((null==n?void 0:n.content)||"");else{var e=O(k||[])||(b.length>0?b[0].value:"");l.resetFields(),l.setFieldsValue({type:v.PYi,title:"",content:"",categoryUid:e,kbUid:null==x?void 0:x.uid}),e&&S(e),f("")}}),[a,b,k]);var R={name:"file",accept:P,action:(0,ae.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(v.LA8)},data:I,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var t=te()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;I.file=e,I.fileName=t,I.fileType=e.type,I.kbType=v.YjS,I.categoryUid=j||"",I.kbUid=null==x?void 0:x.uid,console.log("beforeUpload",I)},onChange:function(e){if("uploading"===e.file.status&&y.yw.loading("".concat(e.file.name," 上传中")),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var t,n=null===(t=e.file.response)||void 0===t?void 0:t.data.fileUrl;f(n),y.yw.destroy(),y.yw.success("".concat(e.file.name," 上传成功"))}else y.yw.destroy(),y.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&y.yw.error("".concat(e.file.name," 上传失败"))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}};return(0,ie.jsx)(ie.Fragment,{children:(0,ie.jsx)(G.Z,{title:t?"修改快捷回复":"新建快捷回复",width:650,onClose:r,open:a,extra:(0,ie.jsxs)(B.Z,{children:[(0,ie.jsx)(Y.ZP,{onClick:r,children:"取消"}),(0,ie.jsx)(Y.ZP,{onClick:function(){console.log("handleSubmit"),l.validateFields().then((function(e){console.log(e),s(o()(o()(o()({},n),e),{},{kbUid:null==x?void 0:x.uid,orgUid:null==m?void 0:m.uid,content:p}))})).catch((function(e){console.log("Form errors:",e),y.yw.error("请检查表单填写")}))},type:"primary",children:"保存"})]}),children:(0,ie.jsxs)(X.A,{form:l,initialValues:o()({},n),submitter:{render:function(){return null}},children:[(0,ie.jsx)(V.Z,{label:"分类",name:"categoryUid",rules:[{required:!0,message:"请选择分类"}],fieldProps:{allowClear:!0,placeholder:"请选择分类",onChange:function(e){console.log("category selected ".concat(e)),S(e)},treeData:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter((function(e){return e.key!==v.zBg})).map((function(t){return o()(o()({},t),{},{title:g(t.title),children:e(t.children||[])})}))}(k||[]),showSearch:!0,treeDefaultExpandAll:!1,fieldNames:{label:"title",value:"key",children:"children"}}}),(0,ie.jsx)(_.Z,{label:"类型",name:"type",rules:[{required:!0,message:"请选择类型"}],options:[{label:"文本",value:v.PYi}],fieldProps:{allowClear:!0,placeholder:"请选择类型",onChange:function(e){console.log("type selected ".concat(e)),U(e),e===v.Qm?E(".png,.jpg,.jpeg,.gif,.bmp"):e===v.tVi?E(".mp4,.avi,.mov,.wmv"):e===v.Yu1?E(".mp3,.wav,.flac"):e===v.Qn&&E(".doc,.xls,.ppt,.pdf,.docx,.txt,.csv,.xlsx,.rtf,.zip,.7z,.tar,.gz,.rar,.iso")}}}),(0,ie.jsx)(H.Z,{label:"标题",name:"title",rules:[{required:!0,message:"请输入标题"}]}),(0,ie.jsx)(X.A.Item,{name:"content",label:"回复",rules:[{required:!0,message:"请输入回复"}],children:(0,ie.jsx)(re.Z,{placeholder:"content content..",value:p,toolbarKeys:(0,se.eD)(),style:{height:"200px",width:"600px"},maxLength:200,onChange:function(e,t){f(e)}})}),Z!=v.PYi&&(0,ie.jsxs)(le,o()(o()({},R),{},{children:[(0,ie.jsx)("p",{className:"ant-upload-drag-icon",children:(0,ie.jsx)($.Z,{})}),(0,ie.jsx)("p",{className:"ant-upload-text",children:"点击或拖拽上传文件"})]}))]})})})},ue=n(54974),ce=n(78069),de=n(16658),pe=n(85977),fe=["current","pageSize"],ge=function(e){var t,n,a,s,l,u,d,f,m,k,w=e.superUser,S=(0,x.useIntl)(),C=(0,x.useAccess)(),U=(0,K.useRef)(),X=(0,K.useMemo)((function(){var e;return null==C||null===(e=C.getModulePermission)||void 0===e?void 0:e.call(C,pe.MY.QUICK_REPLY)}),[C]),V=w||null!==(t=null==X||null===(n=X.canRead)||void 0===n?void 0:n.call(X))&&void 0!==t&&t,_=w||null!==(a=null==X||null===(s=X.canCreate)||void 0===s?void 0:s.call(X))&&void 0!==a&&a,H=w||null!==(l=null==X||null===(u=X.canUpdate)||void 0===u?void 0:u.call(X))&&void 0!==l&&l,G=w||null!==(d=null==X||null===(f=X.canDelete)||void 0===f?void 0:f.call(X))&&void 0!==d&&d,W=w||null!==(m=null==X||null===(k=X.canExport)||void 0===k?void 0:k.call(X))&&void 0!==m&&m,$=(0,K.useRef)(!1),ee=function(e,t){y.yw.warning(S.formatMessage({id:e,defaultMessage:t}))},te=(0,K.useState)(!0),re=h()(te,2),se=re[0],le=re[1],ge=(0,K.useState)(!1),me=h()(ge,2),he=me[0],ye=me[1],ve=(0,ne.Z)().translateString,xe=(0,K.useState)(1),be=h()(xe,2),ke=be[0],Me=be[1],we=(0,K.useState)(10),je=h()(we,2),Se=je[0],qe=je[1],Ce=(0,F.u)((function(e){return e.currentOrg})),Ze=(0,J.j)((function(e){return e.currentKbase})),Ue=(0,Q.v)((function(e){return e.currentCategory})),Fe=(0,Q.v)((function(e){return e.categorySelectOptions})),Te=(0,K.useState)(!1),De=h()(Te,2),Pe=De[0],Ee=De[1],Ae=(0,K.useState)(),ze=h()(Ae,2),Ie=ze[0],Oe=ze[1],Re=(0,K.useState)([]),Be=h()(Re,2),Ye=Be[0],Le=Be[1],Ne=(0,K.useState)([]),Ke=h()(Ne,2),Qe=Ke[0],Je=Ke[1],Xe=O.Z.useModal(),Ve=h()(Xe,2),_e=(Ve[0],Ve[1]),He=(0,K.useState)({}),Ge=h()(He,2),We=Ge[0],$e=Ge[1],et=(0,K.useState)(0),tt=h()(et,2),nt=tt[0],at=tt[1],rt=function(){var e=g()(p()().mark((function e(t){var n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G){e.next=3;break}return ee("quickreply.permission.delete.denied","无权限：删除快捷回复"),e.abrupt("return");case 3:return console.log(t),e.next=6,q(t);case 6:n=e.sent,console.log("delete response:",n),200===n.code?(null==U||U.current.reload(),y.yw.success(S.formatMessage({id:"delete.success",defaultMessage:"Delete Success"}))):y.yw.error(S.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),st=function(){var e=g()(p()().mark((function e(){var t,n,a,r,s,i;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G){e.next=3;break}return ee("quickreply.permission.batchDelete.denied","无权限：批量删除快捷回复"),e.abrupt("return");case 3:if(0!==Qe.length){e.next=6;break}return y.yw.warning(S.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 6:y.yw.loading(S.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),n=0,a=0,r=c()(Qe),e.prev=10,r.s();case 12:if((s=r.n()).done){e.next=26;break}return i=s.value,e.prev=14,e.next=17,q(i);case 17:200===e.sent.code?n++:a++,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(14),a++;case 24:e.next=12;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(10),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:y.yw.destroy(),0===a?y.yw.success(S.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:n})):y.yw.warning(S.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:n,fail:a})),Le([]),Je([]),null===(t=U.current)||void 0===t||t.reloadAndRest();case 39:case"end":return e.stop()}}),e,null,[[10,28,31,34],[14,21]])})));return function(){return e.apply(this,arguments)}}(),it=function(){var e=g()(p()().mark((function e(t){var n,a,r,s,i,l;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H){e.next=3;break}return ee("quickreply.permission.update.denied","无权限：启用/禁用快捷回复"),e.abrupt("return");case 3:if(0!==Qe.length){e.next=6;break}return y.yw.warning(S.formatMessage({id:"batch.noselection",defaultMessage:"Please select items to process"})),e.abrupt("return");case 6:y.yw.loading(t?S.formatMessage({id:"enabling",defaultMessage:"Enabling..."}):S.formatMessage({id:"disabling",defaultMessage:"Disabling..."})),a=0,r=0,s=c()(Qe),e.prev=10,s.s();case 12:if((i=s.n()).done){e.next=26;break}return l=i.value,e.prev=14,e.next=17,Z({uid:l.uid,enabled:t});case 17:200===e.sent.code?a++:r++,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(14),r++;case 24:e.next=12;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(10),s.e(e.t1);case 31:return e.prev=31,s.f(),e.finish(31);case 34:y.yw.destroy(),0===r?y.yw.success(t?S.formatMessage({id:"batch.enable.success",defaultMessage:"Successfully enabled {count} items"},{count:a}):S.formatMessage({id:"batch.disable.success",defaultMessage:"Successfully disabled {count} items"},{count:a})):y.yw.warning(t?S.formatMessage({id:"batch.enable.partial",defaultMessage:"Enabled {success} items, failed to enable {fail} items"},{success:a,fail:r}):S.formatMessage({id:"batch.disable.partial",defaultMessage:"Disabled {success} items, failed to disable {fail} items"},{success:a,fail:r})),Le([]),Je([]),null===(n=U.current)||void 0===n||n.reloadAndRest();case 39:case"end":return e.stop()}}),e,null,[[10,28,31,34],[14,21]])})));return function(t){return e.apply(this,arguments)}}(),lt=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.title.field",defaultMessage:"Title"}),dataIndex:"title",copyable:!0,fixed:"left",width:200,ellipsis:!0,search:!0,render:function(e,t){return ve(null==t?void 0:t.title)},tooltip:S.formatMessage({id:"quickreply.title.tooltip",defaultMessage:"快捷回复的标题或名称"})},{title:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.content",defaultMessage:"Content"}),dataIndex:"content",copyable:!0,width:300,ellipsis:!0,search:!0,render:function(e,t){return ve(null==t?void 0:t.content)},tooltip:S.formatMessage({id:"quickreply.content.tooltip",defaultMessage:"快捷回复的具体内容"})},{title:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.type",defaultMessage:"Type"}),dataIndex:"type",width:100,render:function(e,t){return(0,de.OI)(t.type)},valueEnum:{text:{text:S.formatMessage({id:"quickreply.type.text"})},image:{text:S.formatMessage({id:"quickreply.type.image"})},video:{text:S.formatMessage({id:"quickreply.type.video"})},file:{text:S.formatMessage({id:"quickreply.type.file"})}},tooltip:S.formatMessage({id:"quickreply.type.tooltip",defaultMessage:"快捷回复的内容类型"})},{title:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.shortcut",defaultMessage:"Shortcut"}),dataIndex:"shortCut",width:120,ellipsis:!0,search:!0,tooltip:S.formatMessage({id:"quickreply.shortcut.tooltip",defaultMessage:"用于快速触发的快捷键"})},{title:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.enabled",defaultMessage:"Status"}),dataIndex:"enabled",width:100,valueEnum:{true:{text:S.formatMessage({id:"quickreply.enabled.true"}),status:"Success"},false:{text:S.formatMessage({id:"quickreply.enabled.false"}),status:"Error"}},tooltip:S.formatMessage({id:"quickreply.enabled.tooltip",defaultMessage:"快捷回复是否启用"})},{title:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.category",defaultMessage:"Category"}),dataIndex:"categoryUid",hideInSearch:!0,width:120,render:function(e,t){var n=Fe.find((function(e){return e.value===(null==t?void 0:t.categoryUid)}));return(0,ie.jsx)(R.Z,{color:"blue",children:(null==n?void 0:n.label)||"-"})},filters:Fe.map((function(e){return{text:e.label,value:e.value}})),filterMode:"tree",tooltip:S.formatMessage({id:"quickreply.category.tooltip",defaultMessage:"快捷回复的分类"})},{title:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.updatedAt",defaultMessage:"Updated At"}),dataIndex:"updatedAt",width:160,valueType:"dateTime",sorter:!0,hideInSearch:!0,tooltip:S.formatMessage({id:"quickreply.updatedAt.tooltip",defaultMessage:"最后更新的时间"})},{title:(0,ie.jsx)(x.FormattedMessage,{id:"pages.common.actions",defaultMessage:"Actions"}),valueType:"option",fixed:"right",width:150,render:function(e,t){return(0,ie.jsxs)(B.Z,{children:[H?(0,ie.jsx)(Y.ZP,{type:"link",size:"small",onClick:function(){return ut(t)},children:(0,ie.jsx)(x.FormattedMessage,{id:"pages.common.edit",defaultMessage:"Edit"})}):null,G?(0,ie.jsx)(L.Z,{title:(0,ie.jsx)(x.FormattedMessage,{id:"pages.common.deleteTip",defaultMessage:"Delete Confirmation"}),description:S.formatMessage({id:"pages.common.deleteConfirm"},{name:t.title}),onConfirm:function(){return rt(t)},okText:(0,ie.jsx)(x.FormattedMessage,{id:"pages.common.ok"}),cancelText:(0,ie.jsx)(x.FormattedMessage,{id:"pages.common.cancel"}),children:(0,ie.jsx)(Y.ZP,{type:"link",danger:!0,size:"small",children:(0,ie.jsx)(x.FormattedMessage,{id:"pages.common.delete"})})}):null]})}}],ot=function(){_?(Oe(void 0),le(!1),ye(!0)):ee("quickreply.permission.create.denied","无权限：新建快捷回复")},ut=function(e){H?(Oe(e),le(!0),ye(!0)):ee("quickreply.permission.update.denied","无权限：编辑快捷回复")},ct=function(){var e=g()(p()().mark((function e(t){var n,a;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleSubmitDrawer",t),!se||H){e.next=4;break}return ee("quickreply.permission.update.denied","无权限：编辑快捷回复"),e.abrupt("return");case 4:if(se||_){e.next=7;break}return ee("quickreply.permission.create.denied","无权限：新建快捷回复"),e.abrupt("return");case 7:if(se?y.yw.loading(S.formatMessage({id:"updating"})):y.yw.loading(S.formatMessage({id:"creating"})),!se){e.next=14;break}return e.next=11,j(t);case 11:e.t0=e.sent,e.next=17;break;case 14:return e.next=16,M(t);case 16:e.t0=e.sent;case 17:n=e.t0,console.log("createQuickreply response:",t,n),200===n.code?(y.yw.destroy(),y.yw.loading(S.formatMessage({id:"create.success"})),ye(!1),null===(a=U.current)||void 0===a||a.reloadAndRest()):(y.yw.destroy(),y.yw.error(n.message));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),dt=function(){var e=g()(p()().mark((function e(){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_){e.next=3;break}return ee("quickreply.permission.import.denied","无权限：导入快捷回复"),e.abrupt("return");case 3:Ee(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pt=function(){var e=g()(p()().mark((function e(t,n,a){var r,s;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleExportExcel",t,n,a),W){e.next=4;break}return ee("quickreply.permission.export.denied","无权限：导出快捷回复"),e.abrupt("return");case 4:r=localStorage.getItem(v.LA8),s=o()({categoryUid:(null==Ue?void 0:Ue.uid)===v.zBg?"":null==Ue?void 0:Ue.uid,kbUid:null==Ze?void 0:Ze.uid,orgUid:(null==Ce?void 0:Ce.uid)||"",accessToken:r||"",exportType:t},We),"current"===t?(s.pageNumber=String(ke-1),s.pageSize=String(Se)):"all"===t?(s.pageNumber="0",s.pageSize="1000"):"range"===t&&void 0!==n&&void 0!==a&&(s.pageNumber=String(n),s.pageSize=String(a)),window.open((0,ae.kG)()+"/api/v1/quickreply/export?"+new URLSearchParams(s).toString());case 8:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ft=function(e){for(var t=[],n=1e3,a=Math.ceil(e/n),r=function(){var a=s,r=s*n+1,i=Math.min((s+1)*n,e);t.push({key:"export-".concat(s),label:"".concat(r,"-").concat(i," (").concat(i-r+1,"条)"),onClick:function(){return pt("range",a,n)}})},s=0;s<a;s++)r();return t};(0,K.useEffect)((function(){var e;null===(e=U.current)||void 0===e||e.reloadAndRest()}),[Ze,Ue]);var gt=function(){var e=g()(p()().mark((function e(){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ce.HK)(v._FS,null==Ce?void 0:Ce.uid,null==Ze?void 0:Ze.uid,v.whQ,{showLoading:!0,loadingMessage:S.formatMessage({id:"loading"}),errorMessage:S.formatMessage({id:"fetch.categories.error",defaultMessage:"Failed to fetch categories"})});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),mt=G?{selectedRowKeys:Ye,onChange:function(e,t){Le(e),Je(t)}}:void 0,ht=function(){var e=[_?(0,ie.jsx)(Y.ZP,{icon:(0,ie.jsx)(T.Z,{}),type:"primary",onClick:ot,children:(0,ie.jsx)(x.FormattedMessage,{id:"quickreply.action.create",defaultMessage:"Create Quick Reply"})},"create"):null].filter(Boolean),t=[];Ye.length>0&&(G||H)&&t.push(G?{key:"batchDelete",icon:(0,ie.jsx)(D.Z,{}),danger:!0,label:S.formatMessage({id:"batch.delete"})+" (".concat(Ye.length,")"),onClick:function(){O.Z.confirm({title:S.formatMessage({id:"batch.deleteTip"}),content:"".concat(S.formatMessage({id:"batch.deleteAffirm"})," ").concat(Ye.length," ").concat(S.formatMessage({id:"items"}),"?"),onOk:st,okText:S.formatMessage({id:"ok"}),cancelText:S.formatMessage({id:"cancel"})})}}:null,H?{key:"batchEnable",icon:(0,ie.jsx)(P.Z,{}),label:S.formatMessage({id:"batch.enable"})+" (".concat(Ye.length,")"),onClick:function(){return it(!0)}}:null,H?{key:"batchDisable",icon:(0,ie.jsx)(E.Z,{}),label:S.formatMessage({id:"batch.disable"})+" (".concat(Ye.length,")"),onClick:function(){return it(!1)}}:null);var n,a=t.filter(Boolean),r=[_?{key:"import",icon:(0,ie.jsx)(A.Z,{}),label:S.formatMessage({id:"quickreply.action.import",defaultMessage:"导入快捷回复"}),onClick:dt}:null].concat(i()(W?(n=[{key:"export-current",label:S.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return pt("current")}}],nt>0&&(nt<=1e3?n.push({key:"export-all",label:S.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(nt,"条)"),onClick:function(){return pt("all")}}):n.push({key:"export-range",label:S.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(nt,"条)"),children:ft(nt)})),n.push({key:"download",label:S.formatMessage({id:"download.template",defaultMessage:"下载模板"}),onClick:function(){return(0,ae.os)()}}),n):[])).filter(Boolean);return r.length>0&&e.push((0,ie.jsx)(N.Z,{menu:{items:r},placement:"bottomRight",children:(0,ie.jsxs)(Y.ZP,{type:"primary",children:[(0,ie.jsx)(x.FormattedMessage,{id:"import.export",defaultMessage:"导入导出"}),(0,ie.jsx)(z.Z,{})]})},"importExport")),a.length>0&&e.push((0,ie.jsx)(N.Z,{menu:{items:a},placement:"bottomRight",children:(0,ie.jsxs)(Y.ZP,{type:"primary",danger:!0,children:[S.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})," (",Ye.length,")",(0,ie.jsx)(z.Z,{})]})},"batchOperations")),e};return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(I.Z,{columns:lt,actionRef:U,cardBordered:!0,rowSelection:mt,request:function(){var e=g()(p()().mark((function e(t,n,a){var s,i,l,u,c,d,f,g,m,h;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("request:",t,n,a),V){e.next=4;break}return $.current||($.current=!0,ee("quickreply.permission.read.denied","无权限：查看快捷回复")),e.abrupt("return",{data:[],success:!0,total:0});case 4:return y.yw.loading(S.formatMessage({id:"loading",defaultMessage:"Loading"})),s=t.current,i=t.pageSize,l=r()(t,fe),Me(s),qe(i),$e(l),u=void 0,c=void 0,n&&Object.keys(n).length>0&&(d=Object.keys(n)[0],u=d,c="ascend"===n[d]?"ascend":"descend"),f=w?void 0:(null==Ue?void 0:Ue.uid)===v.zBg?"":null==Ue?void 0:Ue.uid,g=w||null==Ze?void 0:Ze.uid,m=o()(o()({pageNumber:s-1,pageSize:i,categoryUid:f,kbUid:g,orgUid:null==Ce?void 0:Ce.uid,superUser:w},l),{},{sortBy:u,sortDirection:c}),e.next=17,b(m);case 17:return h=e.sent,console.log("queryQuickRepliesByOrg response:",m,h),y.yw.destroy(),200===h.code?at(null==h?void 0:h.data.totalElements):y.yw.error(h.message),e.abrupt("return",{data:null==h?void 0:h.data.content,success:!0,total:null==h?void 0:h.data.totalElements});case 22:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),scroll:{x:1800},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:10,onChange:function(e,t){Me(e),qe(t)}},dateFormatter:"string",headerTitle:ve(null==Ze?void 0:Ze.name)+" - "+S.formatMessage({id:"quickreply.title",defaultMessage:"快捷回复"}),tooltip:{title:S.formatMessage({id:"quickreply.tooltip",defaultMessage:"客服->一对一->高级设置->快捷回复"}),placement:"top"},toolBarRender:function(){return w?[]:ht()},columnsState:{persistenceKey:"quickreply-table",defaultValue:{tagList:{show:!0},startDate:{show:!1},endDate:{show:!1},level:{show:!0},enabled:{show:!0}}}}),(0,ie.jsx)(oe,{isEdit:se,open:he,quickreply:Ie,onClose:function(){return ye(!1)},onSubmit:ct}),Pe&&(0,ie.jsx)(ue.Z,{type:v._FS,acceptType:".xlsx,.xls,.csv",isModalOpen:Pe,handleSubmit:function(e){console.log("handleUploadDragSubmit",e),Ee(!1),null==U||U.current.reload(),gt()},handleCancel:function(){console.log("handleUploadDragCancel"),Ee(!1),null==U||U.current.reload()}}),_e]})}}}]);