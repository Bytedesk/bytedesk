"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9368],{85954:function(e,t,a){var n=a(17082),r=a(73457),s=a(82308),o=a(99749),i=a(44194),l=a(69088),c=a(35175),u=a(31549),d=["options","fieldProps","proFieldProps","valueEnum"],g=i.forwardRef((function(e,t){var a=e.options,o=e.fieldProps,i=e.proFieldProps,l=e.valueEnum,g=(0,r.Z)(e,d);return(0,u.jsx)(c.Z,(0,n.Z)({ref:t,valueType:"checkbox",valueEnum:(0,s.h)(l,void 0),fieldProps:(0,n.Z)({options:a},o),lightProps:(0,n.Z)({labelFormatter:function(){return(0,u.jsx)(c.Z,(0,n.Z)({ref:t,valueType:"checkbox",mode:"read",valueEnum:(0,s.h)(l,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:a},o),proFieldProps:i},g))}},g.lightProps),proFieldProps:i},g))})),p=i.forwardRef((function(e,t){var a=e.fieldProps,r=e.children;return(0,u.jsx)(o.Z,(0,n.Z)((0,n.Z)({ref:t},a),{},{children:r}))})),f=(0,l.G)(p,{valuePropName:"checked"});f.Group=g,t.Z=f},84881:function(e,t,a){var n=a(17082),r=a(73457),s=a(82308),o=a(44194),i=a(63653),l=a(35175),c=a(31549),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],g=function(e,t){var a=e.fieldProps,d=e.children,g=e.params,p=e.proFieldProps,f=e.mode,h=e.valueEnum,m=e.request,v=e.showSearch,x=e.options,y=(0,r.Z)(e,u),w=(0,o.useContext)(i.Z);return(0,c.jsx)(l.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:m,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:x,mode:f,showSearch:v,getPopupContainer:w.getPopupContainer},a),ref:t,proFieldProps:p},y),{},{children:d}))},p=o.forwardRef((function(e,t){var a=e.fieldProps,u=e.children,g=e.params,p=e.proFieldProps,f=e.mode,h=e.valueEnum,m=e.request,v=e.options,x=(0,r.Z)(e,d),y=(0,n.Z)({options:v,mode:f||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},a),w=(0,o.useContext)(i.Z);return(0,c.jsx)(l.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:m,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:w.getPopupContainer},y),ref:t,proFieldProps:p},x),{},{children:u}))})),f=o.forwardRef(g);f.SearchSelect=p,f.displayName="ProFormComponent",t.Z=f},88678:function(e,t,a){a.d(t,{Z:function(){return y}});var n=a(90819),r=a.n(n),s=a(89933),o=a.n(s),i=a(45332),l=a.n(i),c=a(55735),u=a(30921);function d(){return g.apply(this,arguments)}function g(){return(g=o()(r()().mark((function e(){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/kaptcha/api/v1/get",{method:"GET",params:{client:c.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){return f.apply(this,arguments)}function f(){return(f=o()(r()().mark((function e(t,a){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/kaptcha/api/v1/check",{method:"POST",data:{captchaUid:t,captchaCode:a,client:c.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=a(58087),m=a(52288),v=a(44194),x=a(31549),y=function(e){var t=e.onKaptchaChange,a=e.onKaptchaCheck,n=(0,u.useIntl)(),s=(0,v.useState)(),i=l()(s,2),c=i[0],g=i[1],f=(0,v.useState)(),y=l()(f,2),w=y[0],b=y[1],M=function(){var e=o()(r()().mark((function e(){var t;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:200===(t=e.sent).code&&(g(t.data.captchaUid),b(t.data.captchaImage));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=o()(r()().mark((function e(t,n){var s;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t,n);case 2:s=e.sent,console.log("checkCaptcha response",s),200===s.code?a&&a(!0):a&&a(!1);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){M()}),[]);return(0,x.jsx)(x.Fragment,{children:w&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(m.Z,{onChange:function(e){t&&(t(c,e.target.value),e.target.value&&""!==e.target.value&&4===e.target.value.trim().length?k(c,e.target.value):a&&a(!1))},prefix:(0,x.jsx)(h.Z,{}),placeholder:n.formatMessage({id:"captcha",defaultMessage:"captcha"}),style:{width:"65%",float:"left",height:40},allowClear:!0}),(0,x.jsx)("img",{src:w,alt:"captcha",onClick:M})]})})}},76750:function(e,t,a){var n=a(55735),r=a(65461),s=a(30921);t.Z=function(){var e=(0,s.useIntl)();return{translateString:function(t){return null==t?t:t&&(null!=t&&t.startsWith(n.VoP)||null!=t&&t.startsWith("ROLE_"))?e.formatMessage({id:t,defaultMessage:t}):t},translateStringTranct:function(t){return null==t?t:null!=t&&t.startsWith(n.VoP)||null!=t&&t.startsWith("ROLE_")?(0,r.aS)(e.formatMessage({id:t,defaultMessage:t}),10):(0,r.aS)(t,10)}}}},44040:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var n=a(73193),r=a.n(n),s=a(90819),o=a.n(s),i=a(89933),l=a.n(i),c=a(45332),u=a.n(c),d=a(45739),g=a(69169),p=a(60183),f=a(65821),h=a(57245),m=a(93769),v=a(30921),x=a(42540),y=a(8247),w=a(75365),b=a(96839),M=a(98094),k=a(44194),j=a(56321),C=a(51239),Z=a(86803),S=a(98240),P=a(23864),F=a(55735),U=a(88678),I=a(10022),T=a(26978),E=a(4499),L=a(31549),z=function(e){var t=e.loginType,a=e.onKaptchaChange,n=e.onKaptchaCheck,r=(0,v.useIntl)(),s=function(){var e=l()(o()().mark((function e(t,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&a(t,n);case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),i=function(){var e=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&n(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,L.jsx)(L.Fragment,{children:"account"===t&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(E.Z,{name:"username",fieldProps:{size:"large",prefix:(0,L.jsx)(I.Z,{})},placeholder:r.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"用户名/邮箱"}),rules:[{required:!0,message:(0,L.jsx)(v.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"请输入用户名/邮箱!"})}]}),(0,L.jsx)(E.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,L.jsx)(T.Z,{})},placeholder:r.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"密码"}),rules:[{required:!0,message:(0,L.jsx)(v.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"请输入密码！"})}]}),(0,L.jsx)(g.A.Item,{name:"captchaCode",rules:[{required:!0,message:r.formatMessage({id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],children:(0,L.jsx)(U.Z,{onKaptchaChange:s,onKaptchaCheck:i})})]})})},q=a(76750),R=a(65461),K=a(40795),V=a(84881),D=a(59129),N=a(88201),A=a(5602),B=a(32943),W=function(e){var t=e.loginType,a=e.onKaptchaChange,n=e.onKaptchaCheck,r=(0,v.useIntl)(),s=(0,q.Z)().translateString,i=(0,k.useRef)(),c=(0,k.useState)(""),p=u()(c,2),f=p[0],h=p[1],m=(0,k.useState)(""),x=u()(m,2),y=x[0],w=x[1],b=(0,k.useState)(!1),M=u()(b,2),j=M[0],S=M[1],P=(0,C.L)((function(e){return{deviceUid:e.deviceUid,setDeviceUid:e.setDeviceUid}})),I=P.deviceUid,z=P.setDeviceUid,W=function(){var e=l()(o()().mark((function e(t,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(t),w(n),a&&a(t,n);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),H=function(){var e=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(t),n&&n(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,k.useEffect)((function(){void 0!==I&&""!==I||z((0,R.Zx)())}),[]);var Q=[{label:r.formatMessage({id:"pages.login.country.china"}),value:"86",icon:"🇨🇳",code:"CN"},{label:r.formatMessage({id:"pages.login.country.hongkong"}),value:"852",icon:"🇭🇰",code:"HK"},{label:r.formatMessage({id:"pages.login.country.taiwan"}),value:"886",icon:"🇹🇼",code:"TW"},{label:r.formatMessage({id:"pages.login.country.macao"}),value:"853",icon:"🇲🇴",code:"MO"},{label:r.formatMessage({id:"pages.login.country.japan"}),value:"81",icon:"🇯🇵",code:"JP"},{label:r.formatMessage({id:"pages.login.country.korea"}),value:"82",icon:"🇰🇷",code:"KR"},{label:r.formatMessage({id:"pages.login.country.singapore"}),value:"65",icon:"🇸🇬",code:"SG"},{label:r.formatMessage({id:"pages.login.country.malaysia"}),value:"60",icon:"🇲🇾",code:"MY"},{label:r.formatMessage({id:"pages.login.country.thailand"}),value:"66",icon:"🇹🇭",code:"TH"},{label:r.formatMessage({id:"pages.login.country.vietnam"}),value:"84",icon:"🇻🇳",code:"VN"},{label:r.formatMessage({id:"pages.login.country.philippines"}),value:"63",icon:"🇵🇭",code:"PH"},{label:r.formatMessage({id:"pages.login.country.indonesia"}),value:"62",icon:"🇮🇩",code:"ID"},{label:r.formatMessage({id:"pages.login.country.usa"}),value:"1-us",icon:"🇺🇸",code:"US"},{label:r.formatMessage({id:"pages.login.country.canada"}),value:"1-ca",icon:"🇨🇦",code:"CA"},{label:r.formatMessage({id:"pages.login.country.uk"}),value:"44",icon:"🇬🇧",code:"GB"},{label:r.formatMessage({id:"pages.login.country.germany"}),value:"49",icon:"🇩🇪",code:"DE"},{label:r.formatMessage({id:"pages.login.country.france"}),value:"33",icon:"🇫🇷",code:"FR"},{label:r.formatMessage({id:"pages.login.country.italy"}),value:"39",icon:"🇮🇹",code:"IT"},{label:r.formatMessage({id:"pages.login.country.spain"}),value:"34",icon:"🇪🇸",code:"ES"},{label:r.formatMessage({id:"pages.login.country.russia"}),value:"7",icon:"🇷🇺",code:"RU"},{label:r.formatMessage({id:"pages.login.country.australia"}),value:"61",icon:"🇦🇺",code:"AU"},{label:r.formatMessage({id:"pages.login.country.newzealand"}),value:"64",icon:"🇳🇿",code:"NZ"}];return(0,L.jsx)(L.Fragment,{children:"mobile"===t&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(N.Z,{gutter:16,children:[(0,L.jsx)(A.Z,{span:10,children:(0,L.jsx)(V.Z,{name:"country",options:Q,fieldProps:{size:"large",placeholder:r.formatMessage({id:"pages.login.country.placeholder",defaultMessage:"选择国家/地区"}),optionLabelProp:"label",optionItemRender:function(e){var t=e.value.includes("-")?e.value.split("-")[0]:e.value;return(0,L.jsxs)("div",{children:[(0,L.jsx)("span",{role:"img","aria-label":e.label,style:{marginRight:8},children:e.icon}),e.label," (+",t,")"]})}},initialValue:"86"})}),(0,L.jsx)(A.Z,{span:14,children:(0,L.jsx)(E.Z,{fieldProps:{size:"large",prefix:(0,L.jsx)(K.Z,{})},name:"mobile",placeholder:r.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"手机号"}),rules:[{required:!0,message:(0,L.jsx)(v.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"请输入手机号！"})},{pattern:/^1\d{10}$/,message:(0,L.jsx)(v.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"手机号格式错误！"})}]})})]}),(0,L.jsx)(g.A.Item,{name:"captchaCode",rules:[{required:!0,message:r.formatMessage({id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],children:(0,L.jsx)(U.Z,{onKaptchaChange:W,onKaptchaCheck:H})}),(0,L.jsx)(D.Z,{fieldProps:{size:"large",prefix:(0,L.jsx)(T.Z,{})},captchaProps:{size:"large",disabled:!j},placeholder:r.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"请输入验证码"}),captchaTextRender:function(e,t){return e?"".concat(t," ").concat(r.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"获取验证码"})):r.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"获取验证码"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,L.jsx)(v.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],fieldRef:i,onGetCaptcha:function(){var e=l()(o()().mark((function e(t){var a,n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("mobile:",t),!t||11!==t.length){e.next=13;break}return a={mobile:t,type:F.UUF,captchaUid:f,captchaCode:y,deviceUid:I,platform:F.iw8},e.next=5,(0,d.Y7)(a);case 5:if(200===(n=e.sent).code){e.next=10;break}return Z.yw.error(s(n.message)),setTimeout((function(){var e;console.log("endCaptchaTiming"),null===(e=i.current)||void 0===e||e.endTiming()}),2),e.abrupt("return");case 10:Z.yw.success(s(n.message)),e.next=14;break;case 13:Z.yw.error("手机号格式错误");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),(0,L.jsx)(B.Z,{message:(0,L.jsx)(v.FormattedMessage,{id:"pages.login.auto.register",defaultMessage:"Mobile will auto register"}),type:"info"})]})})},H=a(70185),Q=a(36310),G=a(99749),O=a(11757),_={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},Y=a(54183),J=function(e,t){return k.createElement(Y.Z,(0,O.Z)({},e,{ref:t,icon:_}))};var X=k.forwardRef(J),$=a(85954),ee=function(){var e=x.Z.useToken().token,t=(0,k.useContext)(H.I),a=t.isCustomServer,n=t.setIsCustomServer,r=g.A.useForm(),s=u()(r,1)[0],o=(0,k.useState)(!1),i=u()(o,2),l=i[0],c=i[1],d=(0,k.useState)(""),p=u()(d,2),f=p[0],h=p[1],m=(0,k.useState)(""),v=u()(m,2),y=(v[0],v[1]);(0,k.useEffect)((function(){f&&f.length>0&&(s.setFieldsValue({apiUrl:f}),console.log("apiUrl:",f))}),[f]),(0,k.useEffect)((function(){if(a){var e=localStorage.getItem(F.Ss2);"true"===e&&(c(!0),s.setFieldsValue({isCustomServerEnabled:!0})),console.log("isCustomServer customEnabled:",e);var t=localStorage.getItem(F.DuM);t&&s.setFieldsValue({apiUrl:(0,R.Qj)(t)});var n=localStorage.getItem(F.sZT);n&&s.setFieldsValue({websocketUrl:(0,R.Qj)(n)})}}),[a]);return(0,L.jsx)("div",{className:"ant-pro-form-server-container",style:{backgroundColor:e.colorBgContainer,display:"flex",justifyContent:"center",flexDirection:"column",height:"100%",width:"80%",marginLeft:"10%"},children:(0,L.jsxs)(g.A,{className:"ant-pro-form-server-main",form:s,submitter:{render:function(e,t){return console.log("props:",e,t),(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"8px"},children:[(0,L.jsx)(w.ZP,{icon:(0,L.jsx)(X,{}),onClick:function(){console.log("switch server"),n((function(e){return!e}))},children:"返回"},"back"),(0,L.jsx)(w.ZP,{type:"primary",onClick:function(){var t=e.form.getFieldValue("apiUrl");t=(0,R.Qj)(t.trim());var a=e.form.getFieldValue("websocketUrl");a=(0,R.Qj)(a.trim()),t&&t.trim().length>0&&a&&a.trim().length>0?(localStorage.setItem(F.DuM,t),localStorage.setItem(F.sZT,a),localStorage.setItem(F.Ss2,"true"),Z.yw.success("保存成功")):Z.yw.error("请输入正确的服务器地址")},children:"保存"},"submit"),(0,L.jsx)(w.ZP,{onClick:function(){var t;null===(t=e.form)||void 0===t||t.resetFields(),h(""),localStorage.setItem(F.Ss2,"false"),localStorage.setItem(F.DuM,""),localStorage.setItem(F.sZT,""),Z.yw.success("重置成功，已恢复默认云服务器")},children:"重置"},"reset"),(0,L.jsx)(w.ZP,{onClick:function(){window.open("https://www.weiyuai.cn/docs/zh-CN/docs/manual/agent/auth/login")},children:"帮助"},"help")]})}},children:[(0,L.jsx)($.Z,{name:"isCustomServerEnabled",fieldProps:{onChange:function(e){console.log("e:",e),function(e){if(console.log("handleCustomServerChange e:",e),c(e.target.checked),e.target.checked){var t=localStorage.getItem(F.DuM);t&&s.setFieldsValue({apiUrl:(0,R.Qj)(t)});var a=localStorage.getItem(F.sZT);a&&s.setFieldsValue({websocketUrl:(0,R.Qj)(a)}),console.log("initData apiUrl:",t,"websocketUrl:",a)}else localStorage.setItem(F.Ss2,"false")}(e)}},children:"是否启用自定义服务器"}),l&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(E.Z,{name:"apiUrl",label:"API 服务器地址（例如：http://127.0.0.1:9003 或 https://api.bytedesk.com）",fieldProps:{disabled:!l,placeholder:"http://127.0.0.1:9003",onChange:function(e){return h(e.target.value)}}}),(0,L.jsx)(E.Z,{name:"websocketUrl",label:"WebSocket 服务器地址（例如：ws://127.0.0.1:9885/websocket 或 wss://api.bytedesk.com/websocket）",fieldProps:{disabled:!l,placeholder:"ws://127.0.0.1:9885/websocket",onChange:function(e){return y(e.target.value)}}})]})]})})},te=a(11184),ae=a(40288),ne=x.Z.defaultAlgorithm,re=x.Z.darkAlgorithm,se=function(){var e=(0,m.l)((function(e){var t=e.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:t.borderRadius,":hover":{backgroundColor:t.colorBgTextHover}}}));return(0,L.jsx)("div",{className:e,"data-lang":!0,children:v.SelectLang&&(0,L.jsx)(v.SelectLang,{})})},oe=function(){var e=(0,v.useIntl)(),t=(0,q.Z)().translateString,a=g.A.useForm(),n=u()(a,1)[0],s=x.Z.useToken().token,i=(0,P.Z)().isDarkMode,c=(0,te.M)(),m=c.config,b=c.updateConfig,M=((0,k.useContext)(H.I).isLoggedIn,(0,k.useState)("https://kf.gxzgt.com:9003/assets/images/logos/zhiguitong.png")),U=u()(M,2),I=U[0],T=U[1],E=(0,k.useState)(""),K=u()(E,2),V=K[0],D=K[1],N=(0,k.useState)(""),A=u()(N,2),B=A[0],O=A[1],_=(0,S.t)((function(e){return e.setAccessToken})),Y=(0,k.useContext)(H.I),J=Y.isCustomServer,X=(Y.setIsCustomServer,(0,k.useState)("mobile")),$=u()(X,2),ne=$[0],re=$[1],oe=(0,v.useModel)("@@initialState").setInitialState,ie=(0,k.useState)(!1),le=u()(ie,2),ce=le[0],ue=(le[1],(0,C.L)((function(e){return{deviceUid:e.deviceUid,setDeviceUid:e.setDeviceUid,setUserInfo:e.setUserInfo}}))),de=ue.deviceUid,ge=ue.setDeviceUid,pe=ue.setUserInfo,fe=(0,k.useState)(!1),he=u()(fe,2),me=he[0],ve=he[1],xe=(0,k.useState)(""),ye=u()(xe,2),we=ye[0],be=ye[1],Me=function(){var e=l()(o()().mark((function e(t,a){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:be(t),n.setFieldValue("captchaCode",a);case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ke=function(){var e=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleKaptchaCheck:",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=[{key:"account",label:e.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"账户密码登录"}),children:(0,L.jsx)(z,{loginType:ne,onKaptchaChange:Me,onKaptchaCheck:ke})},{key:"mobile",label:e.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"手机号登录"}),children:(0,L.jsx)(W,{loginType:ne,onKaptchaChange:Me,onKaptchaCheck:ke})}];(0,p.uK)(s.colorTextBase,.2);var Ce=function(){var t=l()(o()().mark((function t(){var a,n,r,s,i,l,c,u,d;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0!==de&&""!==de||ge((0,R.Zx)()),t.next=3,(0,Q.Xs)();case 3:null!=(n=t.sent)&&null!==(a=n.custom)&&void 0!==a&&a.enabled&&!(0,Q._p)()?(null!=n&&null!==(r=n.custom)&&void 0!==r&&r.logo?T(null==n||null===(c=n.custom)||void 0===c?void 0:c.logo):T("https://kf.gxzgt.com:9003/assets/images/logos/zhiguitong.png"),null!=n&&null!==(s=n.custom)&&void 0!==s&&s.name?D(null==n||null===(u=n.custom)||void 0===u?void 0:u.name):D(e.formatMessage({id:"app.title"})),null!=n&&null!==(i=n.custom)&&void 0!==i&&i.description?O(null==n||null===(d=n.custom)||void 0===d?void 0:d.description):O(e.formatMessage({id:"pages.layouts.userLayout.title"})),null!=n&&null!==(l=n.custom)&&void 0!==l&&l.showRightCornerChat||b({bubbleConfig:{show:!1},buttonConfig:{show:!1}})):(T("https://kf.gxzgt.com:9003/assets/images/logos/zhiguitong.png"),D(e.formatMessage({id:"app.title"})),O(e.formatMessage({id:"pages.layouts.userLayout.title"}))),(0,Q.ME)();case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,k.useEffect)((function(){(0,R.pr)(),Ce()}),[]);var Ze=function(){var e=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(0,j.flushSync)((function(){oe((function(e){return r()(r()({},e),{},{userInfo:t})}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var a=l()(o()().mark((function a(n){var s;return o()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,me){a.next=4;break}return Z.yw.error("请阅读并同意隐私协议"),a.abrupt("return");case 4:return Z.yw.loading(e.formatMessage({id:"logging",defaultMessage:"logging..."})),a.next=7,(0,d.x4)(r()({},n));case 7:s=a.sent,console.log("LoginResult:",s),200===s.code?(Z.yw.destroy(),Z.yw.success(e.formatMessage({id:"login.success",defaultMessage:"login success"})),_(s.data.accessToken),Ze(s.data.user),pe(s.data.user),v.history.push("/")):(Z.yw.destroy(),Z.yw.error(t(s.message))),a.next=16;break;case 12:a.prev=12,a.t0=a.catch(0),console.log(a.t0),Z.yw.error(e.formatMessage({id:"login.error",defaultMessage:"login failed"}));case 16:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(e){return a.apply(this,arguments)}}(),Pe=function(){var t=l()(o()().mark((function t(a){var n,s,i;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,me){t.next=4;break}return Z.yw.error("请阅读并同意隐私协议"),t.abrupt("return");case 4:return Z.yw.loading(e.formatMessage({id:"logging",defaultMessage:"logging..."})),t.next=7,(0,d.N9)(r()({},a));case 7:n=t.sent,console.log("LoginMobileResult:",n),200===n.code?(Z.yw.destroy(),Z.yw.success(e.formatMessage({id:"login.success",defaultMessage:"login success"})),_(null==n?void 0:n.data.accessToken),Ze(null==n||null===(s=n.data)||void 0===s?void 0:s.user),pe(null==n||null===(i=n.data)||void 0===i?void 0:i.user),v.history.push("/")):(Z.yw.destroy(),Z.yw.error(e.formatMessage({id:n.message,defaultMessage:n.message}))),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),Z.yw.error(e.formatMessage({id:"login.error",defaultMessage:"login failed"}));case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}();return(0,L.jsxs)(f._Y,{hashed:!1,dark:i,children:[(0,L.jsx)(se,{}),(0,L.jsxs)("div",{style:{backgroundColor:s.colorBgContainer,textAlign:"center",height:"100%",backgroundImage:"url('/admin/assets/images/bg-wide.png')"},children:[!J&&(0,L.jsxs)(h.U,{form:n,contentStyle:{minWidth:400,maxWidth:"75vw"},logo:(0,L.jsx)("img",{alt:"logo",src:I}),title:V,subTitle:B,actions:ce&&!1,onFinish:function(){var e=l()(o()().mark((function e(t){var a,n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("login values:",t),"account"!==ne){e.next=8;break}return a={username:t.username,password:t.password,captchaUid:we,captchaCode:t.captchaCode,deviceUid:de,platform:F.iw8},console.log("login info:",a),e.next=6,Se(a);case 6:e.next=12;break;case 8:return n={mobile:t.mobile,code:t.code,captchaUid:we,captchaCode:t.captchaCode,deviceUid:de,platform:F.iw8},console.log("login mobile info:",n),e.next=12,Pe(n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,L.jsx)(y.Z,{activeKey:ne,onChange:re,centered:!0,items:je}),(0,L.jsx)("div",{style:{marginTop:14,marginBottom:14},children:(0,L.jsxs)("div",{style:{float:"right",marginBottom:24},children:[(0,L.jsx)(G.Z,{onChange:function(e){console.log("checked = ".concat(e.target.checked)),ve(e.target.checked)},children:(0,L.jsx)(w.ZP,{size:"small",type:"link",onClick:function(){window.open("https://zgtapp.zwfw.gxzf.gov.cn/zgt-h5/userProtocol/index.html")},children:"同意《用户隐私&协议》"})}),ce&&(0,L.jsx)(v.Link,{to:"/auth/register",children:(0,L.jsx)(v.FormattedMessage,{id:"pages.login.registerAccount",defaultMessage:"注册 "})}),!1]})})]}),J&&(0,L.jsx)(ee,{}),(0,L.jsx)(ae.Q,r()(r()({},m),{},{onInit:function(){console.log("ByteDesk initialized admin")}}))]})]})},ie=function(){var e=(0,P.Z)().isDarkMode;return(0,L.jsx)(H.w,{children:(0,L.jsx)(b.ZP,{theme:{algorithm:e?re:ne},children:(0,L.jsxs)(M.Z,{style:{height:"100%"},children:[(0,L.jsx)(Z.ZP,{}),(0,L.jsx)(oe,{})]})})})}}}]);