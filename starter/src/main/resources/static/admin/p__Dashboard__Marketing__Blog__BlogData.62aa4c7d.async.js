"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2647],{83381:function(e,n,r){r.d(n,{Z:function(){return u}});var t=r(38404),i=r(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},l=r(5901),a=function(e,n){return i.createElement(l.Z,(0,t.Z)({},e,{ref:n,icon:o}))};var u=i.forwardRef(a)},80503:function(e,n,r){r.d(n,{Z:function(){return u}});var t=r(38404),i=r(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},l=r(5901),a=function(e,n){return i.createElement(l.Z,(0,t.Z)({},e,{ref:n,icon:o}))};var u=i.forwardRef(a)},17455:function(e,n,r){var t=r(80627),i=r(93683),o=r(68422),l=r(44194),a=r(84729),u=r(69983),d=r(31549),s=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,n){var r=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,h=e.mode,v=e.valueEnum,g=e.request,m=e.showSearch,x=e.options,Z=(0,i.Z)(e,s),w=(0,l.useContext)(a.Z);return(0,d.jsx)(u.Z,(0,t.Z)((0,t.Z)({valueEnum:(0,o.h)(v),request:g,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,t.Z)({options:x,mode:h,showSearch:m,getPopupContainer:w.getPopupContainer},r),ref:n,proFieldProps:f},Z),{},{children:c}))},f=l.forwardRef((function(e,n){var r=e.fieldProps,s=e.children,p=e.params,f=e.proFieldProps,h=e.mode,v=e.valueEnum,g=e.request,m=e.options,x=(0,i.Z)(e,c),Z=(0,t.Z)({options:m,mode:h||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),w=(0,l.useContext)(a.Z);return(0,d.jsx)(u.Z,(0,t.Z)((0,t.Z)({valueEnum:(0,o.h)(v),request:g,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,t.Z)({getPopupContainer:w.getPopupContainer},Z),ref:n,proFieldProps:f},x),{},{children:s}))})),h=l.forwardRef(p);h.SearchSelect=f,h.displayName="ProFormComponent",n.Z=h},67186:function(e,n,r){var t=r(29552),i=r(80627),o=r(93683),l=r(92032),a=r(69159),u=r(43928),d=r(21762),s=r(44194),c=r(69983),p=r(31549),f=["fieldProps","proFieldProps"],h=["fieldProps","proFieldProps"],v="text",g=function(e){var n=(0,l.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,t.Z)(n,2),o=r[0],d=r[1];return(0,p.jsx)(a.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(n){var r,t=n.getFieldValue(e.name||[]);return(0,p.jsx)(u.Z,(0,i.Z)((0,i.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return d(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,t),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:o,children:e.children}))}})},m=function(e){var n=e.fieldProps,r=e.proFieldProps,t=(0,o.Z)(e,f);return(0,p.jsx)(c.Z,(0,i.Z)({valueType:v,fieldProps:n,filedConfig:{valueType:v},proFieldProps:r},t))};m.Password=function(e){var n=e.fieldProps,r=e.proFieldProps,l=(0,o.Z)(e,h),a=(0,s.useState)(!1),u=(0,t.Z)(a,2),f=u[0],m=u[1];return null!=n&&n.statusRender&&l.name?(0,p.jsx)(g,{name:l.name,statusRender:null==n?void 0:n.statusRender,popoverProps:null==n?void 0:n.popoverProps,strengthText:null==n?void 0:n.strengthText,open:f,onOpenChange:m,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,i.Z)({valueType:"password",fieldProps:(0,i.Z)((0,i.Z)({},(0,d.Z)(n,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==n||null===(r=n.onBlur)||void 0===r||r.call(n,e),m(!1)},onClick:function(e){var r;null==n||null===(r=n.onClick)||void 0===r||r.call(n,e),m(!0)}}),proFieldProps:r,filedConfig:{valueType:v}},l))})}):(0,p.jsx)(c.Z,(0,i.Z)({valueType:"password",fieldProps:n,proFieldProps:r,filedConfig:{valueType:v}},l))},m.displayName="ProFormComponent",n.Z=m},90938:function(e,n,r){var t=r(96775);n.Z=function(){var e=(0,t.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},83431:function(e,n,r){r.r(n),r.d(n,{default:function(){return E}});var t=r(90938),i=r(15911),o=r(90819),l=r.n(o),a=r(89933),u=r.n(a),d=r(50884),s=r(73193),c=r.n(s),p=r(27353),f=r(2290);function h(e){return v.apply(this,arguments)}function v(){return(v=u()(l()().mark((function e(n){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.request)("/api/v1/blog/query/org",{method:"GET",params:c()(c()({},n),{},{channel:p.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=u()(l()().mark((function e(n){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.request)("/api/v1/blog/delete",{method:"POST",data:c()(c()({},n),{},{channel:p.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=r(7603),Z=r(28520),w=r(64967),y=r(61476),P=r(97765),b=r(6992),j=r(43837),S=r(35911),C=r(77601),k=r(38623),T=r(46206),F=r(70937),I=r(90883),R=r(44194),B=r(27318),M=r(31549),q=function(){var e,n,r,t,i,o,a,s,c=(0,R.useRef)(),v=(0,Z.u)((function(e){return e.currentOrg})),m=(0,w.j)((function(e){return e.currentKbase})),q=(0,x.v)((function(e){return e.currentCategory})),z=(0,x.v)((function(e){return e.categorySelectOptions})),E=(0,f.useIntl)(),L=(0,f.useAccess)(),O=(0,R.useMemo)((function(){var e;return null==L||null===(e=L.getModulePermission)||void 0===e?void 0:e.call(L,B.MY.BLOG)}),[L]),U=null!==(e=null==O||null===(n=O.canRead)||void 0===n?void 0:n.call(O))&&void 0!==e&&e,A=null!==(r=null==O||null===(t=O.canCreate)||void 0===t?void 0:t.call(O))&&void 0!==r&&r,N=null!==(i=null==O||null===(o=O.canUpdate)||void 0===o?void 0:o.call(O))&&void 0!==i&&i,V=null!==(a=null==O||null===(s=O.canDelete)||void 0===s?void 0:s.call(O))&&void 0!==a&&a,D=(0,R.useRef)(!1),J=function(e,n){d.yw.warning(E.formatMessage({id:e,defaultMessage:n}))},G=function(){A?null!=m&&m.uid?window.open((0,y.Dt)(m.uid)):d.yw.error("请先选择知识库"):J("blog.permission.create.denied","无权限：新建博客")},K=function(e){U?null!=e&&e.uid&&window.open((0,y.Er)(e.uid)):J("blog.permission.read.denied","无权限：查看博客")},W=function(){var e=u()(l()().mark((function e(n){var r,t,i;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V){e.next=3;break}return J("blog.permission.delete.denied","无权限：删除博客"),e.abrupt("return");case 3:return d.yw.loading("删除中..."),e.next=6,g({uid:n.uid});case 6:r=e.sent,d.yw.destroy(),200===(null==r?void 0:r.code)?(d.yw.success("删除成功"),null===(t=c.current)||void 0===t||null===(i=t.reloadAndRest)||void 0===i||i.call(t)):d.yw.error((null==r?void 0:r.message)||"删除失败");case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),X=function(){P.Z.debug("handlePreviewBlog"),U?null!=m&&m.uid?window.open("/blog/".concat(m.uid)):d.yw.error("请先选择知识库"):J("blog.permission.read.denied","无权限：查看博客")};(0,R.useEffect)((function(){var e,n;null===(e=c.current)||void 0===e||null===(n=e.reloadAndRest)||void 0===n||n.call(e)}),[null==q?void 0:q.uid,null==m?void 0:m.uid]);var H=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:"标题",dataIndex:"name",copyable:!0,ellipsis:!0,width:220,fixed:"left",render:function(e,n){return(0,M.jsx)("a",{onClick:function(){return K(n)},children:n.name})}},{title:"摘要",dataIndex:"description",ellipsis:!0,width:260,hideInSearch:!0},{title:"分类",dataIndex:"categoryUid",hideInSearch:!0,width:140,render:function(e,n){var r=null!=(null==n?void 0:n.categoryUid)?String(n.categoryUid):"",t=z.find((function(e){return String(e.value)===r}));return(0,M.jsx)(k.Z,{color:"blue",children:(null==t?void 0:t.label)||"-"})}},{title:"标签",dataIndex:"tagList",hideInSearch:!0,width:220,render:function(e,n){var r=(null==n?void 0:n.tagList)||[];return r.length?(0,M.jsx)(T.Z,{size:4,wrap:!0,children:r.slice(0,5).map((function(e){return(0,M.jsx)(k.Z,{children:e},e)}))}):"-"}},{title:"发布",dataIndex:"published",hideInSearch:!0,width:80,render:function(e,n){return(0,M.jsx)(k.Z,{color:n.published?"success":"default",children:n.published?"已发布":"未发布"})}},{title:"置顶",dataIndex:"top",hideInSearch:!0,width:80,render:function(e,n){return(0,M.jsx)(k.Z,{color:n.top?"orange":"default",children:n.top?"置顶":"普通"})}},{title:"更新时间",dataIndex:"updatedAt",hideInSearch:!0,width:170,sorter:!0},{title:"操作",valueType:"option",width:160,fixed:"right",render:function(e,n){var r=[];return N&&r.push((0,M.jsx)("a",{onClick:function(){return function(e){N?null!=e&&e.uid&&window.open((0,y.LB)(e.uid)):J("blog.permission.update.denied","无权限：编辑博客")}(n)},children:"编辑"},"edit")),U&&r.push((0,M.jsx)("a",{onClick:function(){return K(n)},children:"预览"},"preview")),V&&r.push((0,M.jsx)(F.Z,{title:"确认删除？",onConfirm:function(){return W(n)},children:(0,M.jsx)("a",{children:"删除"})},"delete")),r}}];return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(C.Z,{columns:H,actionRef:c,cardBordered:!0,scroll:{x:"max-content"},request:function(){var e=u()(l()().mark((function e(n){var r,t,i,o,a;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=3;break}return D.current||(D.current=!0,J("blog.permission.read.denied","无权限：查看博客")),e.abrupt("return",{data:[],success:!0,total:0});case 3:if(i=null==m?void 0:m.uid){e.next=6;break}return e.abrupt("return",{data:[],success:!0,total:0});case 6:return o={pageNumber:(n.current||1)-1,pageSize:n.pageSize,orgUid:null==v?void 0:v.uid,kbUid:i,categoryUid:(null==q?void 0:q.uid)===p.zBg?"":null==q?void 0:q.uid,name:n.name},e.next=9,h(o);case 9:return a=e.sent,P.Z.debug("BlogTable queryBlogsByOrg resp:",a,o),e.abrupt("return",{data:(null==a||null===(r=a.data)||void 0===r?void 0:r.content)||[],success:!0,total:(null==a||null===(t=a.data)||void 0===t?void 0:t.totalElements)||0});case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0},dateFormatter:"string",headerTitle:"博客内容",toolBarRender:function(){var e=[];return A&&e.push((0,M.jsx)(I.ZP,{icon:(0,M.jsx)(b.Z,{}),type:"primary",onClick:G,children:"新建"},"create")),U&&e.push((0,M.jsx)(I.ZP,{type:"primary",icon:(0,M.jsx)(j.Z,{}),onClick:X,children:(0,M.jsx)(f.FormattedMessage,{id:"pages.blog.preview",defaultMessage:"预览博客"})},"preview")),e.push((0,M.jsx)(I.ZP,{icon:(0,M.jsx)(S.Z,{}),onClick:function(){var e,n;return null===(e=c.current)||void 0===e||null===(n=e.reloadAndRest)||void 0===n?void 0:n.call(e)},children:"刷新"},"refresh")),e}})})},z=r(16049),E=function(){var e=(0,t.Z)(),n=e.leftSiderStyle,r=e.contentStyle;return(0,M.jsx)("div",{children:(0,M.jsxs)(i.Z,{style:{height:"100%"},children:[(0,M.jsx)(i.Z.Panel,{defaultSize:"20%",min:"10%",max:"40%",style:n,children:(0,M.jsx)(z.Z,{type:p.qAy})}),(0,M.jsx)(i.Z.Panel,{style:r,children:(0,M.jsx)(q,{})})]})})}}}]);