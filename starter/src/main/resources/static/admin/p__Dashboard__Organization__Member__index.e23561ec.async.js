"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[557],{91159:function(se,z,a){a.r(z),a.d(z,{default:function(){return n}});var Z=a(90518),D=a(34886),I=a(52983),p=a(90819),S=a.n(p),O=a(89933),R=a.n(O),G=a(45332),w=a.n(G),b=a(13664),W=a(41900),g=a(77159),P=a(3206),A=a(45312),J=a(29263),C=a(64116),H=a(97596),s=a(97458),k=function(){var v=g.Z.useForm(),h=w()(v,1),d=h[0],M=(0,I.useState)(!1),$=w()(M,2),Q=$[0],E=$[1],f=(0,Z.u)(function(i){return{depCurrent:i.depCurrent,depOptions:i.depOptions,createMem:i.createMem,setDepCurrent:i.setDepCurrent}}),N=f.depCurrent,Y=f.depOptions,F=f.createMem,K=f.setDepCurrent,q=function(){E(!0)},_=function(){var i=R()(S()().mark(function y(){var j,T,x,ne,ae,L,le,oe;return S()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(j=d.getFieldValue("jobNo"),T=d.getFieldValue("realname"),x=d.getFieldValue("seatNo"),ne=d.getFieldValue("telephone"),ae=d.getFieldValue("mobile"),L=d.getFieldValue("email"),le=N.did,console.log("realname",T),N.did!==""){te.next=11;break}return P.ZP.error("please choose a department"),te.abrupt("return");case 11:T?(oe={jobNo:j,realname:T,seatNo:x,telephone:ne,mobile:ae,email:L,dep_did:le},F(oe),E(!1)):P.ZP.error("name should not be null");case 12:case"end":return te.stop()}},y)}));return function(){return i.apply(this,arguments)}}(),ee=function(){E(!1)},re=function(){console.log("new mem"),q()},V=function(y){console.log("select checked",y),K(y)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Z,{title:"\u6DFB\u52A0\u6210\u5458",open:Q,onOk:_,onCancel:ee,children:(0,s.jsxs)(g.Z,{form:d,name:"memForm",initialValues:{dep_did:N.did},children:[(0,s.jsx)(g.Z.Item,{label:"\u90E8\u95E8",name:"dep_did",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8!"}],children:(0,s.jsx)(J.Z,{options:Y,onChange:V})}),(0,s.jsx)(g.Z.Item,{label:"\u59D3\u540D",name:"realname",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D!"}],children:(0,s.jsx)(C.Z,{})}),(0,s.jsx)(g.Z.Item,{label:"\u624B\u673A\u53F7",name:"mobile",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7!"}],children:(0,s.jsx)(C.Z,{})}),(0,s.jsx)(g.Z.Item,{label:"\u5DE5\u53F7",name:"jobNo",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u5DE5\u53F7!"}],children:(0,s.jsx)(C.Z,{})}),(0,s.jsx)(g.Z.Item,{label:"\u5EA7\u4F4D\u53F7",name:"seatNo",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u5EA7\u4F4D\u53F7!"}],children:(0,s.jsx)(C.Z,{})}),(0,s.jsx)(g.Z.Item,{label:"\u5206\u673A\u53F7",name:"telephone",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u5206\u673A\u53F7!"}],children:(0,s.jsx)(C.Z,{})}),(0,s.jsx)(g.Z.Item,{label:"\u90AE\u7BB1",name:"email",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1!"}],children:(0,s.jsx)(C.Z,{})})]})}),(0,s.jsx)(H.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(b.Z,{}),onClick:re,children:"create user"}),(0,s.jsx)(W.Rs,{rowKey:"id",headerTitle:N.name,dataSource:N.members,showActions:"hover",editable:{onSave:function(){var i=R()(S()().mark(function j(T,x,ne){return S()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return console.log(T,x,ne),L.abrupt("return",!0);case 2:case"end":return L.stop()}},j)}));function y(j,T,x){return i.apply(this,arguments)}return y}()},metas:{title:{dataIndex:"realname"},avatar:{dataIndex:"user.avatar",editable:!1},description:{dataIndex:"user.description",render:function(y){return(0,s.jsx)("div",{children:y})}},actions:{render:function(y,j,T,x){return[(0,s.jsx)("a",{onClick:function(){x==null||x.startEditable(j.mid)},children:"\u7F16\u8F91"},"link")]}}}})]})},B=k,U=a(35456),X=a(23598),c=function(){var v=g.Z.useForm(),h=w()(v,1),d=h[0],M=(0,I.useState)(!1),$=w()(M,2),Q=$[0],E=$[1],f=(0,Z.u)(function(i){return{depCurrent:i.depCurrent,departments:i.departments,createDep:i.createDep,setDepCurrent:i.setDepCurrent}}),N=f.depCurrent,Y=f.departments,F=f.createDep,K=f.setDepCurrent,q=function(){E(!0)},_=function(){var i=R()(S()().mark(function y(){var j;return S()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:j=d.getFieldValue("nickname"),console.log("nickname",j),j?(F(j),E(!1)):P.ZP.error("\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A");case 3:case"end":return x.stop()}},y)}));return function(){return i.apply(this,arguments)}}(),ee=function(){E(!1)},re=function(){console.log("new dep"),q()},V=function(y){K(y.key)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(U.Z,{gap:"small",wrap:"wrap",children:(0,s.jsx)(H.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(b.Z,{}),onClick:re,children:"create dep"})}),(0,s.jsx)(X.Z,{onClick:V,defaultSelectedKeys:[N.did],mode:"inline",items:Y}),(0,s.jsx)(A.Z,{title:"\u521B\u5EFA\u90E8\u95E8",open:Q,onOk:_,onCancel:ee,children:(0,s.jsx)(g.Z,{form:d,name:"depForm",style:{maxWidth:400},children:(0,s.jsx)(g.Z.Item,{label:"\u90E8\u95E8\u540D\u79F0",name:"nickname",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0!"}],children:(0,s.jsx)(C.Z,{})})})})]})},u=c,m=D.Z.Sider,o=D.Z.Content,e={margin:"10px",minHeight:120,backgroundColor:"#EEFAE0"},r={margin:"10px",backgroundColor:"#EEFAE0",borderRight:"1px solid #ccc"},t=function(){var v=(0,Z.u)(function(h){return h.queryOrgs});return(0,I.useEffect)(function(){v()},[]),(0,s.jsxs)(D.Z,{children:[(0,s.jsx)(m,{style:r,children:(0,s.jsx)(u,{})}),(0,s.jsx)(D.Z,{children:(0,s.jsx)(o,{style:e,children:(0,s.jsx)(B,{})})})]})},n=t},90518:function(se,z,a){a.d(z,{u:function(){return X}});var Z=a(76711),D=a.n(Z),I=a(90819),p=a.n(I),S=a(89933),O=a.n(S),R=a(73193),G=a(77108);function w(c){return b.apply(this,arguments)}function b(){return b=O()(p()().mark(function c(u){return p()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,G.request)("/api/org",{method:"POST",data:{nickname:u,client:"web"}}));case 1:case"end":return o.stop()}},c)})),b.apply(this,arguments)}function W(c,u,m){return g.apply(this,arguments)}function g(){return g=O()(p()().mark(function c(u,m,o){return p()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,G.request)("/api/v1/dep/create",{method:"POST",data:{nickname:u,parent_did:m,org_oid:o,client:"web"}}));case 1:case"end":return r.stop()}},c)})),g.apply(this,arguments)}function P(c){return A.apply(this,arguments)}function A(){return A=O()(p()().mark(function c(u){return p()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,G.request)("/api/v1/mem/create",{method:"POST",data:{jobNo:u.jobNo,realname:u.realname,seatNo:u.seatNo,telephone:u.telephone,mobile:u.mobile,email:u.email,dep_did:u.dep_did,client:"web"}}));case 1:case"end":return o.stop()}},c)})),A.apply(this,arguments)}function J(c,u){return C.apply(this,arguments)}function C(){return C=O()(p()().mark(function c(u,m){return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,G.request)("/api/v1/org/query",{method:"GET",params:{pageNumber:u,pageSize:m,client:"web"}}));case 1:case"end":return e.stop()}},c)})),C.apply(this,arguments)}function H(c){return s.apply(this,arguments)}function s(){return s=_asyncToGenerator(_regeneratorRuntime().mark(function c(u){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",request("/api/org",_objectSpread({method:"GET",params:{client:"web"}},u||{})));case 1:case"end":return o.stop()}},c)})),s.apply(this,arguments)}var k=a(14618),B=a(58472),U=a(53083),X=(0,k.Ue)()((0,B.mW)((0,B.tJ)((0,U.n)(function(c,u){return{orgCurrent:{oid:"",name:"",avatar:"",description:""},depOptions:[],depCurrent:{did:""},departments:[],createOrg:function(){var m=O()(p()().mark(function e(r){var t;return p()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,w(r);case 2:t=l.sent,console.log("createOrg:",t),t.statusCode==200&&u().transferOrgToTree(t.data);case 5:case"end":return l.stop()}},e)}));function o(e){return m.apply(this,arguments)}return o}(),createDep:function(){var m=O()(p()().mark(function e(r){var t,n,l,v;return p()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return t=u().orgCurrent.oid,d.next=3,W(r,"",t);case 3:n=d.sent,console.log("createDep:",n),n.statusCode==200&&(l={label:n.data.name,key:n.data.did},v={label:n.data.name,value:n.data.did},c({depOptions:[].concat(D()(u().depOptions),[v]),departments:[].concat(D()(u().departments),[l])}));case 6:case"end":return d.stop()}},e)}));function o(e){return m.apply(this,arguments)}return o}(),setDepCurrent:function(o){for(var e=u().orgCurrent.departments,r=0;r<e.length;r++){var t=e[r];t.did===o&&c({depCurrent:t})}},createMem:function(){var m=O()(p()().mark(function e(r){var t,n,l,v,h;return p()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,P(r);case 2:if(t=M.sent,console.log("createMem:",r.dep_did,t),t.statusCode==200){for(n=u().orgCurrent,l=n.departments,v=0;v<l.length;v++)h=l[v],h.did===r.dep_did&&(h.members=[t.data].concat(D()(h.members))),l[v]=h;n.departments=l,c({orgCurrent:n})}case 5:case"end":return M.stop()}},e)}));function o(e){return m.apply(this,arguments)}return o}(),queryOrgs:function(){var m=O()(p()().mark(function e(){var r,t;return p()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,J(0,10);case 2:if(r=l.sent,console.log("refresh orgs:",r),r.data.content.length!=0){l.next=6;break}return l.abrupt("return");case 6:t=r.data.content[0],u().transferOrgToTree(t);case 8:case"end":return l.stop()}},e)}));function o(){return m.apply(this,arguments)}return o}(),transferOrgToTree:function(o){for(var e=[],r=[],t=0;t<o.departments.length;t++){var n=o.departments[t],l={label:n.name,key:n.did};r.push(l);var v={label:n.name,value:n.did};e.push(v)}c({orgCurrent:o,depOptions:e,departments:r})},deleteOrgCache:function(){return c({},!0)}}}),{name:"ORGANIZTION_STORE"})))},35456:function(se,z,a){a.d(z,{Z:function(){return o}});var Z=a(52983),D=a(51865),I=a.n(D),p=a(71010),S=a(10053),O=a(40637),R=a(5153),G=a(52715);const w=["wrap","nowrap","wrap-reverse"],b=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],W=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],g=(e,r)=>{const t={};return w.forEach(n=>{t[`${e}-wrap-${n}`]=r.wrap===n}),t},P=(e,r)=>{const t={};return W.forEach(n=>{t[`${e}-align-${n}`]=r.align===n}),t[`${e}-align-stretch`]=!r.align&&!!r.vertical,t},A=(e,r)=>{const t={};return b.forEach(n=>{t[`${e}-justify-${n}`]=r.justify===n}),t};function J(e,r){return I()(Object.assign(Object.assign(Object.assign({},g(e,r)),P(e,r)),A(e,r)))}var C=J;const H=e=>{const{componentCls:r}=e;return{[r]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},s=e=>{const{componentCls:r}=e;return{[r]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},k=e=>{const{componentCls:r}=e,t={};return w.forEach(n=>{t[`${r}-wrap-${n}`]={flexWrap:n}}),t},B=e=>{const{componentCls:r}=e,t={};return W.forEach(n=>{t[`${r}-align-${n}`]={alignItems:n}}),t},U=e=>{const{componentCls:r}=e,t={};return b.forEach(n=>{t[`${r}-justify-${n}`]={justifyContent:n}}),t},X=()=>({});var c=(0,R.I$)("Flex",e=>{const{paddingXS:r,padding:t,paddingLG:n}=e,l=(0,G.TS)(e,{flexGapSM:r,flexGap:t,flexGapLG:n});return[H(l),s(l),k(l),B(l),U(l)]},X,{resetStyle:!1}),u=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(e);l<n.length;l++)r.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(t[n[l]]=e[n[l]]);return t},o=Z.forwardRef((e,r)=>{const{prefixCls:t,rootClassName:n,className:l,style:v,flex:h,gap:d,children:M,vertical:$=!1,component:Q="div"}=e,E=u(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:f,direction:N,getPrefixCls:Y}=Z.useContext(O.E_),F=Y("flex",t),[K,q,_]=c(F),ee=$!=null?$:f==null?void 0:f.vertical,re=I()(l,n,f==null?void 0:f.className,F,q,_,C(F,e),{[`${F}-rtl`]:N==="rtl",[`${F}-gap-${d}`]:(0,S.n)(d),[`${F}-vertical`]:ee}),V=Object.assign(Object.assign({},f==null?void 0:f.style),v);return h&&(V.flex=h),d&&!(0,S.n)(d)&&(V.gap=d),K(Z.createElement(Q,Object.assign({ref:r,className:re,style:V},(0,p.Z)(E,["justify","wrap","align"])),M))})}}]);
