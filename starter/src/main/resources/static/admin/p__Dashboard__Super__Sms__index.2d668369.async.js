"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6898],{77098:function(e,r,t){t.d(r,{JP:function(){return g},Nf:function(){return h},PA:function(){return b},Z_:function(){return d},cG:function(){return m},k2:function(){return w},kO:function(){return Z},sc:function(){return j}});var s=t(90819),n=t.n(s),a=t(73193),i=t.n(a),o=t(89933),u=t.n(o),c=t(39497),l=t(14906);function d(){return p.apply(this,arguments)}function p(){return(p=u()(n()().mark((function e(){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/email",{method:"GET",params:{channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return(f=u()(n()().mark((function e(r){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/email",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=u()(n()().mark((function e(r){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/email/test",{method:"POST",params:{testEmail:r,channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return x.apply(this,arguments)}function x(){return(x=u()(n()().mark((function e(){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/sms",{method:"GET",params:{channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return M.apply(this,arguments)}function M(){return(M=u()(n()().mark((function e(r){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/sms",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return y.apply(this,arguments)}function y(){return(y=u()(n()().mark((function e(r){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/sms/test",{method:"POST",params:{testMobile:r,channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return k.apply(this,arguments)}function k(){return(k=u()(n()().mark((function e(){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/ticket-center",{method:"GET",params:{channel:c.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return P.apply(this,arguments)}function P(){return(P=u()(n()().mark((function e(r){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/settings/platform/ticket-center",{method:"POST",data:i()(i()({},r),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},75112:function(e,r,t){var s=t(14597);r.Z=function(){var e=(0,s.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},71398:function(e,r,t){t.r(r),t.d(r,{default:function(){return G}});var s=t(90819),n=t.n(s),a=t(89933),i=t.n(a),o=t(45332),u=t.n(o),c=t(44194),l=t(13847),d=t(41196),p=t(59533),m=t(65207),f=t(40110),h=t(39487),v=t(82770),g=t(70635),x=t(66431),b=t(62640),M=t(81739),Z=t(40122),y=t(86895),j=t(32525),k=t(80556),w=t(77647),P=t(55785),S=t(77098),C=t(73193),I=t.n(C),T=t(39497),q=t(14906);function E(e){return J.apply(this,arguments)}function J(){return(J=i()(n()().mark((function e(r){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,q.request)("/api/v1/sms_provider/query/org",{method:"GET",params:I()(I()({},r),{},{channel:T.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return O.apply(this,arguments)}function O(){return(O=i()(n()().mark((function e(r){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,q.request)("/api/v1/sms_provider/query/uid",{method:"GET",params:I()(I()({},r),{},{channel:T.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=t(75112),X=t(31549),L=l.Z.Option,N={ALIYUN:"super.sms.provider.type.aliyun",TENCENT:"super.sms.provider.type.tencent",HUAWEI:"super.sms.provider.type.huawei",CUSTOM:"super.sms.provider.type.custom"},G=function(){var e=d.Z.useForm(),r=u()(e,1)[0],t=(0,c.useState)(!1),s=u()(t,2),a=s[0],o=s[1],C=(0,c.useState)(!1),I=u()(C,2),T=I[0],J=I[1],O=(0,c.useState)(!1),G=u()(O,2),_=G[0],z=G[1],A=(0,c.useState)(!1),H=u()(A,2),B=H[0],K=H[1],R=(0,c.useState)(""),V=u()(R,2),W=V[0],D=V[1],Y=(0,c.useState)([]),$=u()(Y,2),Q=$[0],ee=$[1],re=(0,c.useState)(!1),te=u()(re,2),se=te[0],ne=te[1],ae=(0,c.useState)(null),ie=u()(ae,2),oe=ie[0],ue=ie[1],ce=(0,U.Z)().contentStyle,le=(0,q.useIntl)(),de=function(e){if(!e)return"";var r=N[e];return r?le.formatMessage({id:r}):e},pe=function(){var e=i()(n()().mark((function e(){var t,s;return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,(0,S.JP)();case 4:200===(null==(t=e.sent)?void 0:t.code)&&t.data&&(r.setFieldsValue({smsProviderUid:t.data.smsProviderUid,smsEnabled:null!==(s=t.data.smsEnabled)&&void 0!==s&&s,description:t.data.description}),t.data.smsProviderUid&&me(t.data.smsProviderUid)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("加载短信配置失败:",e.t0),p.ZP.error(le.formatMessage({id:"super.sms.message.loadSettingsFailed"}));case 12:return e.prev=12,o(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=i()(n()().mark((function e(r){var t;return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F({uid:r});case 3:200===(null==(t=e.sent)?void 0:t.code)&&t.data&&ue(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("加载短信服务商详情失败:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r){return e.apply(this,arguments)}}(),fe=function(){var e=i()(n()().mark((function e(){var r,t;return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ne(!0),e.prev=1,e.next=4,E({orgUid:"df_org_uid",pageNumber:0,pageSize:100});case 4:200===(null==(t=e.sent)?void 0:t.code)&&null!==(r=t.data)&&void 0!==r&&r.content&&ee(t.data.content),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("加载短信服务商列表失败:",e.t0),p.ZP.error(le.formatMessage({id:"super.sms.message.loadProvidersFailed"}));case 12:return e.prev=12,ne(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){pe(),fe()}),[]);var he=function(){var e=i()(n()().mark((function e(){var t,s;return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.validateFields();case 3:return t=e.sent,J(!0),e.next=7,(0,S.PA)({smsProviderUid:t.smsProviderUid,smsEnabled:t.smsEnabled,description:t.description});case 7:200===(null==(s=e.sent)?void 0:s.code)?(p.ZP.success(le.formatMessage({id:"super.sms.message.saveSuccess"})),pe()):p.ZP.error((null==s?void 0:s.message)||le.formatMessage({id:"super.sms.message.saveFailed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("保存短信配置失败:",e.t0),p.ZP.error(le.formatMessage({id:"super.sms.message.saveFailed"}));case 15:return e.prev=15,J(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=i()(n()().mark((function e(){var r;return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W){e.next=3;break}return p.ZP.warning(le.formatMessage({id:"super.sms.message.testMobileRequired"})),e.abrupt("return");case 3:if(/^1[3-9]\d{9}$/.test(W)){e.next=6;break}return p.ZP.warning(le.formatMessage({id:"super.sms.message.testMobileInvalid"})),e.abrupt("return");case 6:return z(!0),e.prev=7,e.next=10,(0,S.kO)(W);case 10:200===(null==(r=e.sent)?void 0:r.code)?(p.ZP.success((null==r?void 0:r.data)||le.formatMessage({id:"super.sms.message.testSuccess"})),K(!1),D("")):p.ZP.error((null==r?void 0:r.message)||le.formatMessage({id:"super.sms.message.testFailed"})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.error("测试短信发送失败:",e.t0),p.ZP.error(le.formatMessage({id:"super.sms.message.testFailed"}));case 18:return e.prev=18,z(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[7,14,18,21]])})));return function(){return e.apply(this,arguments)}}();return(0,X.jsxs)("div",{style:ce,children:[(0,X.jsx)(m.Z,{spinning:a,children:(0,X.jsxs)(f.Z,{title:le.formatMessage({id:"super.sms.title"}),extra:(0,X.jsxs)(h.Z,{children:[(0,X.jsx)(v.ZP,{icon:(0,X.jsx)(k.Z,{}),onClick:function(){pe(),fe()},children:le.formatMessage({id:"super.common.refresh"})}),(0,X.jsx)(v.ZP,{icon:(0,X.jsx)(w.Z,{}),onClick:function(){return K(!0)},disabled:!oe,children:le.formatMessage({id:"super.common.test"})}),(0,X.jsx)(v.ZP,{type:"primary",icon:(0,X.jsx)(P.Z,{}),loading:T,onClick:he,children:le.formatMessage({id:"super.common.save"})})]}),children:[(0,X.jsx)(g.Z,{message:le.formatMessage({id:"super.common.alert.title"}),description:(0,X.jsxs)("div",{children:[(0,X.jsx)("p",{children:le.formatMessage({id:"super.sms.alert.desc1"})}),(0,X.jsx)("p",{children:le.formatMessage({id:"super.sms.alert.desc2"})})]}),type:"info",showIcon:!0,style:{marginBottom:24}}),(0,X.jsxs)(d.Z,{form:r,layout:"vertical",initialValues:{smsEnabled:!1},children:[(0,X.jsx)(d.Z.Item,{name:"smsEnabled",label:le.formatMessage({id:"super.common.enableConfig"}),valuePropName:"checked",children:(0,X.jsx)(x.Z,{checkedChildren:le.formatMessage({id:"super.common.enabled"}),unCheckedChildren:le.formatMessage({id:"super.common.disabled"})})}),(0,X.jsx)(b.Z,{orientation:"left",children:le.formatMessage({id:"super.sms.divider.provider"})}),(0,X.jsx)(d.Z.Item,{name:"smsProviderUid",label:le.formatMessage({id:"super.sms.form.provider.label"}),rules:[{required:!0,message:le.formatMessage({id:"super.sms.form.provider.required"})}],tooltip:le.formatMessage({id:"super.sms.form.provider.tooltip"}),extra:(0,X.jsxs)(h.Z,{style:{marginTop:8},children:[(0,X.jsx)("span",{children:le.formatMessage({id:"super.sms.provider.count"},{count:Q.length})}),(0,X.jsx)(v.ZP,{type:"link",size:"small",onClick:fe,loading:se,children:le.formatMessage({id:"super.common.refreshList"})})]}),children:(0,X.jsx)(l.Z,{placeholder:le.formatMessage({id:"super.sms.form.provider.placeholder"}),loading:se,showSearch:!0,optionFilterProp:"children",onChange:function(e){var r=Q.find((function(r){return r.uid===e}));ue(r||null)},filterOption:function(e,r){var t;return null==r||null===(t=r.children)||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase())},children:Q.map((function(e){return(0,X.jsx)(L,{value:e.uid,children:(0,X.jsxs)(h.Z,{children:[(0,X.jsx)("span",{children:e.name}),e.enabled?(0,X.jsx)(M.Z,{color:"green",children:le.formatMessage({id:"super.common.enabled"})}):(0,X.jsx)(M.Z,{color:"default",children:le.formatMessage({id:"super.common.disabled"})}),(0,X.jsx)(M.Z,{color:"blue",children:de(e.providerType)})]})},e.uid)}))})}),oe&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(b.Z,{orientation:"left",children:le.formatMessage({id:"super.sms.detail.title"})}),(0,X.jsx)(f.Z,{size:"small",style:{marginBottom:24},children:(0,X.jsxs)(Z.Z,{column:2,size:"small",children:[(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.name"}),children:oe.name}),(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.type"}),children:de(oe.providerType)}),(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.accessKeyId"}),children:oe.accessKeyId}),(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.signName"}),children:oe.signName}),(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.templateCode"}),children:oe.templateCode}),(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.region"}),children:oe.region}),(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.status"}),children:oe.enabled?(0,X.jsx)(M.Z,{color:"green",children:le.formatMessage({id:"super.common.enabled"})}):(0,X.jsx)(M.Z,{color:"red",children:le.formatMessage({id:"super.common.disabled"})})}),(0,X.jsx)(Z.Z.Item,{label:le.formatMessage({id:"super.sms.detail.description"}),children:oe.description})]})})]})]})]})}),(0,X.jsx)(y.Z,{title:le.formatMessage({id:"super.sms.testModal.title"}),open:B,onOk:ve,onCancel:function(){K(!1),D("")},confirmLoading:_,okText:le.formatMessage({id:"super.common.modal.send"}),cancelText:le.formatMessage({id:"cancel"}),children:(0,X.jsx)(d.Z,{layout:"vertical",children:(0,X.jsx)(d.Z.Item,{label:le.formatMessage({id:"super.sms.testModal.mobileLabel"}),required:!0,help:le.formatMessage({id:"super.sms.testModal.mobileHelp"}),children:(0,X.jsx)(j.Z,{value:W,onChange:function(e){return D(e.target.value)},placeholder:le.formatMessage({id:"super.sms.testModal.placeholder"}),maxLength:11})})})})]})}}}]);