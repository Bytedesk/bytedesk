"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[5669],{60224:function(e,t,n){n.d(t,{Lr:function(){return v},_t:function(){return d},sE:function(){return m},x_:function(){return f}});var r=n(90819),a=n.n(r),s=n(73193),u=n.n(s),i=n(89933),o=n.n(i),l=n(94976),c=n(4628);function d(e){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/agent/query/org",{method:"GET",params:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/agent/create",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/agent/update",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return w.apply(this,arguments)}function w(){return(w=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/agent/delete",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},79658:function(e,t,n){n.d(t,{LE:function(){return c},W5:function(){return g},p0:function(){return p},zl:function(){return h}});var r=n(90819),a=n.n(r),s=n(73193),u=n.n(s),i=n(89933),o=n.n(i),l=n(4628);function c(e){return d.apply(this,arguments)}function d(){return(d=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/workgroup/query/org",{method:"GET",params:u()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/workgroup/create",{method:"POST",data:u()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/workgroup/update",{method:"POST",data:u()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/workgroup/delete",{method:"POST",data:u()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},11810:function(e,t,n){n.d(t,{Dm:function(){return k},Y2:function(){return m},jT:function(){return f},zN:function(){return v},zc:function(){return d}});var r=n(90819),a=n.n(r),s=n(73193),u=n.n(s),i=n(89933),o=n.n(i),l=n(94976),c=n(4628);function d(e){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/settings/query/org",{method:"GET",params:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/settings/create",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/settings/update",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return w.apply(this,arguments)}function w(){return(w=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/settings/delete",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return(x=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/settings/publish",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},54038:function(e,t,n){n.d(t,{Bg:function(){return d},Ch:function(){return m},Gv:function(){return k},bD:function(){return f},mE:function(){return M},nQ:function(){return b},nU:function(){return v},oX:function(){return S}});var r=n(90819),a=n.n(r),s=n(73193),u=n.n(s),i=n(89933),o=n.n(i),l=n(4628),c=n(94976);function d(e){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/query/org",{method:"GET",params:u()(u()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=o()(a()().mark((function e(t){var n,r,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.orgUid,r=t.workgroupUid,s=t.type,e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/orgs/".concat(n,"/workgroups/").concat(r),{method:"GET",params:{channel:c.XtJ,type:s}}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/publish",{method:"POST",data:u()(u()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return w.apply(this,arguments)}function w(){return(w=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/delete",{method:"POST",data:u()(u()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return(x=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/create",{method:"POST",data:u()(u()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return y.apply(this,arguments)}function y(){return(y=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/update",{method:"POST",data:u()(u()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return j.apply(this,arguments)}function j(){return(j=o()(a()().mark((function e(t,n){var r,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.uid,s=t.orgUid,e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/".concat(r,"/orgs/").concat(s,"/bindings"),{method:"POST",data:u()(u()({},n),{},{channel:c.XtJ})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return C.apply(this,arguments)}function C(){return(C=o()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ticket/settings/bindings",{method:"GET",params:u()(u()({},t),{},{channel:c.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},25780:function(e,t,n){var r=n(90819),a=n.n(r),s=n(73193),u=n.n(s),i=n(89933),o=n.n(i),l=n(45332),c=n.n(l),d=n(44194),p=n(69705),f=n(27729),g=n(1282),m=n(12461),h=n(4628),v=n(43388),w=n(11810),k=n(31549);t.Z=function(e){var t=e.open,n=e.onOpenChange,r=e.orgUid,s=e.record,i=e.onSuccess,l=(0,h.useIntl)(),x=p.Z.useForm(),M=c()(x,1)[0];(0,d.useEffect)((function(){var e,n;t&&(s?M.setFieldsValue({name:s.name||"",description:s.description||"",enabled:null===(e=s.enabled)||void 0===e||e,isDefault:null!==(n=s.isDefault)&&void 0!==n&&n}):(M.resetFields(),M.setFieldsValue({enabled:!0,isDefault:!1})))}),[t,s,M]);var y=function(){var e=o()(a()().mark((function e(){var t,o,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.validateFields();case 3:if(t=e.sent,o=u()(u()({},t),{},{orgUid:r,uid:null==s?void 0:s.uid}),null==s||!s.uid){e.next=11;break}return e.next=8,(0,w.Y2)(o);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,(0,w.jT)(o);case 13:e.t0=e.sent;case 14:(c=e.t0)&&200===c.code?(v.yw.success(l.formatMessage({id:null!=s&&s.uid?"common.updated":"common.created",defaultMessage:null!=s&&s.uid?"更新成功":"创建成功"})),null==i||i(),n(!1)):v.yw.error((null==c?void 0:c.message)||"操作失败"),e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),console.error("Error saving workgroup settings:",e.t1);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return(0,k.jsx)(f.Z,{title:(0,k.jsx)(h.FormattedMessage,{id:null!=s&&s.uid?"workgroup.settings.template.edit":"workgroup.settings.template.create",defaultMessage:null!=s&&s.uid?"编辑模板":"新建模板"}),open:t,onOk:y,onCancel:function(){return n(!1)},okText:(0,k.jsx)(h.FormattedMessage,{id:"common.save",defaultMessage:"保存"}),cancelText:(0,k.jsx)(h.FormattedMessage,{id:"common.cancel",defaultMessage:"取消"}),destroyOnHidden:!0,width:600,children:(0,k.jsxs)(p.Z,{form:M,layout:"vertical",preserve:!1,children:[(0,k.jsx)(p.Z.Item,{name:"name",label:(0,k.jsx)(h.FormattedMessage,{id:"workgroup.settings.template.name",defaultMessage:"模板名称"}),rules:[{required:!0,message:l.formatMessage({id:"required",defaultMessage:"此项为必填项"})}],children:(0,k.jsx)(g.Z,{placeholder:l.formatMessage({id:"workgroup.settings.template.name.placeholder",defaultMessage:"请输入模板名称"})})}),(0,k.jsx)(p.Z.Item,{name:"description",label:(0,k.jsx)(h.FormattedMessage,{id:"description",defaultMessage:"描述"}),children:(0,k.jsx)(g.Z.TextArea,{rows:3,placeholder:l.formatMessage({id:"workgroup.settings.template.description.placeholder",defaultMessage:"请输入模板描述"})})}),(0,k.jsx)(p.Z.Item,{name:"enabled",label:(0,k.jsx)(h.FormattedMessage,{id:"enabled",defaultMessage:"启用"}),valuePropName:"checked",children:(0,k.jsx)(m.Z,{})})]})})}},65669:function(e,t,n){n.d(t,{Z:function(){return Y}});var r=n(10154),a=n.n(r),s=n(73193),u=n.n(s),i=n(86222),o=n.n(i),l=n(90819),c=n.n(l),d=n(89933),p=n.n(d),f=n(45332),g=n.n(f),m=n(44194),h=n(4628),v=n(34512),w=n(28582),k=n(92351),x=n(90581),M=n(43275),y=n(69533),b=n(43388),j=n(79658),S=n(54038),C=n(74171),Z=n(94976),I=n(48470),A=n(59005),T=n(99036),U=n(86702),O=n(60241),q=n(11810),F=n(25780),P=n(30310),E=n(10162),B=n(60224),D=n(1395),z=n(88722),J=n(31549),X=function(e){var t,n,r,a=e.open,s=e.record,i=e.onClose,o=e.onSuccess,l=(0,h.useIntl)(),d=(0,z.Z)().translateString,f=(0,C.u)((function(e){return e.currentOrg})),v=(0,m.useMemo)((function(){return!(null==s||!s.uid)}),[s]),w=(0,m.useState)(!1),k=g()(w,2),x=k[0],M=k[1],S=(0,m.useState)([]),Z=g()(S,2),X=Z[0],W=Z[1],R=(0,m.useState)(!1),L=g()(R,2),N=L[0],V=L[1],G=(0,m.useState)(0),Y=g()(G,2),_=Y[0],H=Y[1],K=(0,m.useRef)(),Q=(0,D.E)((function(e){return e.agentResult})),$=(0,D.E)((function(e){return e.setAgentResult})),ee=(0,m.useCallback)(function(){var e=p()(c()().mark((function e(t){var n,r,a,s;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V(!0),e.prev=1,r={pageNumber:0,pageSize:50,enabled:!0,orgUid:null==f?void 0:f.uid,searchText:t||""},e.next=5,(0,q.zc)(r);case 5:return a=e.sent,s=(null==a||null===(n=a.data)||void 0===n?void 0:n.content)||[],W(s),e.abrupt("return",s.map((function(e){return{label:"".concat(e.name||e.uid).concat(e.isDefault?" (默认)":"").concat(e.enabled?"":" (已停用)"),value:e.uid}})));case 9:return e.prev=9,V(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,,9,12]])})));return function(t){return e.apply(this,arguments)}}(),[null==f?void 0:f.uid]);return(0,m.useEffect)((function(){var e=function(){var e=p()(c()().mark((function e(){var t,n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&null!=f&&f.uid){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={pageNumber:0,pageSize:100,sortDirection:"ascend",orgUid:f.uid},e.next=6,(0,B._t)(t);case 6:200===(null==(n=e.sent)?void 0:n.code)?$(n):null!=n&&n.message&&b.yw.warning(n.message),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();e()}),[a,null==f?void 0:f.uid,$]),(0,J.jsxs)(I.a,{open:a,onOpenChange:function(e){e||i()},title:v?l.formatMessage({id:"workgroup.edit",defaultMessage:"编辑工作组"}):l.formatMessage({id:"workgroup.new",defaultMessage:"新建工作组"}),width:520,formRef:K,initialValues:v?{nickname:null==s?void 0:s.nickname,description:null==s?void 0:s.description,settingsUid:null==s||null===(t=s.settings)||void 0===t?void 0:t.uid,agents:(null==s||null===(n=s.agents)||void 0===n?void 0:n.map((function(e){return e.uid})))||[]}:{},autoFocusFirstInput:!0,drawerProps:{destroyOnHidden:!0,maskClosable:!0},submitter:{searchConfig:{submitText:l.formatMessage({id:"save",defaultMessage:"保存"}),resetText:l.formatMessage({id:"cancel",defaultMessage:"取消"})},resetButtonProps:{onClick:function(){return i()}}},onFinish:function(){var e=p()(c()().mark((function e(t){var n,r,a,d,p;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b.yw.loading(l.formatMessage({id:v?"updating":"creating",defaultMessage:v?"Updating":"Creating"})),!v){e.next=9;break}return a=u()(u()(u()({},s),t),{},{agentUids:t.agents}),e.next=6,(0,j.W5)(a);case 6:r=e.sent,e.next=13;break;case 9:return d={nickname:t.nickname,description:t.description,settingsUid:t.settingsUid,orgUid:null==f?void 0:f.uid,agentUids:t.agents},e.next=12,(0,j.p0)(d);case 12:r=e.sent;case 13:if(b.yw.destroy(),200!==(null===(n=r)||void 0===n?void 0:n.code)){e.next=21;break}return b.yw.success(l.formatMessage({id:"save.success",defaultMessage:"保存成功"})),null==o||o(r.data),i(),e.abrupt("return",!0);case 21:return b.yw.error((null===(p=r)||void 0===p?void 0:p.message)||l.formatMessage({id:"save.failed",defaultMessage:"保存失败"})),e.abrupt("return",!1);case 23:e.next=30;break;case 25:return e.prev=25,e.t0=e.catch(0),b.yw.destroy(),b.yw.error(l.formatMessage({id:"save.error",defaultMessage:"保存出错"})),e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(t){return e.apply(this,arguments)}}(),children:[(0,J.jsx)(A.Z,{name:"agents",label:l.formatMessage({id:"workgroup.members",defaultMessage:"成员"}),placeholder:l.formatMessage({id:"workgroup.members.placeholder",defaultMessage:"请选择成员"}),options:((null==Q||null===(r=Q.data)||void 0===r?void 0:r.content)||[]).map((function(e){return{value:e.uid,label:d(e.nickname)}})),fieldProps:{mode:"multiple",allowClear:!0}}),(0,J.jsx)(T.A.Item,{label:l.formatMessage({id:"workgroup.settings",defaultMessage:"工作组配置"}),children:(0,J.jsxs)(P.Z.Compact,{style:{width:"100%"},children:[(0,J.jsx)("div",{style:{flex:1},children:(0,J.jsx)(A.Z,{name:"settingsUid",label:!1,placeholder:l.formatMessage({id:"workgroup.settings.placeholder",defaultMessage:"请选择工作组配置"}),rules:[{required:!0,message:l.formatMessage({id:"workgroup.settings.required",defaultMessage:"请选择工作组配置"})}],showSearch:!0,debounceTime:300,params:{reloadStamp:_},request:function(){var e=p()(c()().mark((function e(t){var n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.keyWords,e.abrupt("return",ee(n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fieldProps:{style:{width:"100%"},filterOption:!1,loading:N,notFoundContent:0===X.length?(0,J.jsxs)("div",{style:{textAlign:"center",padding:"12px 0"},children:[(0,J.jsx)("div",{style:{marginBottom:8,color:"#999"},children:l.formatMessage({id:"workgroup.settings.empty",defaultMessage:"暂无配置模板"})}),(0,J.jsx)(y.ZP,{size:"small",type:"primary",icon:(0,J.jsx)(E.Z,{}),onClick:function(){return M(!0)},children:l.formatMessage({id:"workgroup.settings.create",defaultMessage:"创建配置"})})]}):void 0}})}),(0,J.jsx)(y.ZP,{size:"small",icon:(0,J.jsx)(E.Z,{}),onClick:function(){return M(!0)},title:l.formatMessage({id:"workgroup.settings.create",defaultMessage:"创建配置"}),children:l.formatMessage({id:"common.new",defaultMessage:"新建"})})]})}),(0,J.jsx)(U.Z,{name:"nickname",label:l.formatMessage({id:"workgroup.info.nickname",defaultMessage:"名称"}),rules:[{required:!0,message:l.formatMessage({id:"workgroup.info.nickname.required",defaultMessage:"请输入名称"})}]}),(0,J.jsx)(O.Z,{name:"description",label:l.formatMessage({id:"workgroup.info.description",defaultMessage:"描述"})}),(0,J.jsx)(F.Z,{open:x,onOpenChange:M,orgUid:(null==f?void 0:f.uid)||"",record:null,onSuccess:function(){M(!1),H((function(e){return e+1}))}})]})},W=n(27729),R=n(69174),L=function(e){var t,n=e.open,r=e.onClose,a=e.onSubmit,s=(0,h.useIntl)(),u=T.A.useForm(),i=g()(u,1)[0],o=(0,z.Z)().translateString,l=(0,C.u)((function(e){return e.currentOrg})),d=(0,D.E)((function(e){return e.agentResult})),f=(0,D.E)((function(e){return e.setAgentResult})),v=(0,m.useState)([]),w=g()(v,2),k=w[0],x=w[1],M=(0,m.useState)(!1),j=g()(M,2),S=j[0],Z=j[1],I=(0,m.useState)(!1),O=g()(I,2),X=O[0],L=O[1],N=(0,m.useState)(0),V=g()(N,2),G=V[0],Y=V[1],_=(0,m.useState)([]),H=g()(_,2),K=H[0],Q=H[1],$=(0,m.useState)([]),ee=g()($,2),te=ee[0],ne=ee[1];(0,m.useEffect)((function(){n&&(i.setFieldsValue({nickname:"",agents:[]}),x([]))}),[n]);var re=(0,m.useCallback)(function(){var e=p()(c()().mark((function e(t){var n,r,a,s,u;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),e.prev=1,r={pageNumber:0,pageSize:50,enabled:!0,orgUid:null==l?void 0:l.uid,searchText:t||""},e.next=5,(0,q.zc)(r);case 5:return a=e.sent,console.log("queryWorkgroupSettingsByOrg response:",a,r),s=(null==a||null===(n=a.data)||void 0===n?void 0:n.content)||[],Q(s),!i.getFieldValue("settingsUid")&&s.length>0&&i.setFieldsValue({settingsUid:s[0].uid}),u=s.map((function(e){return{label:"".concat(e.name||e.uid).concat(e.isDefault?" (默认)":"").concat(e.enabled?"":" (已停用)"),value:e.uid}})),ne(u),e.abrupt("return",u);case 13:return e.prev=13,L(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,,13,16]])})));return function(t){return e.apply(this,arguments)}}(),[null==l?void 0:l.uid,i]);(0,m.useEffect)((function(){n&&re()}),[n,G,re]),(0,m.useEffect)((function(){var e=function(){var e=p()(c()().mark((function e(){var t,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&null!=l&&l.uid){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={pageNumber:0,pageSize:100,sortDirection:"ascend",orgUid:l.uid},e.next=6,(0,B._t)(t);case 6:200===(null==(r=e.sent)?void 0:r.code)?f(r):null!=r&&r.message&&b.yw.warning(r.message),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();e()}),[n,null==l?void 0:l.uid,f]);return(0,J.jsx)("div",{children:(0,J.jsxs)(W.Z,{title:s.formatMessage({id:"workgroup.new",defaultMessage:"新建工作组"}),open:n,forceRender:!0,onOk:function(){console.log("handleOk"),i.validateFields().then((function(e){console.log("form values:",e);var t={nickname:i.getFieldValue("nickname"),agentUids:i.getFieldValue("agents"),settingsUid:i.getFieldValue("settingsUid"),orgUid:null==l?void 0:l.uid};console.log("workgroup:",t),a(t)})).catch((function(e){console.log("Form errors:",e)}))},onCancel:function(){console.log("handleCancel"),r()},children:[(0,J.jsxs)(T.A,{form:i,name:"wgForm",submitter:{render:function(e,t){return(0,J.jsx)(J.Fragment,{})}},children:[(0,J.jsx)(T.A.Item,{label:s.formatMessage({id:"workgroup.settings",defaultMessage:"工作组配置"}),name:"settingsUid",rules:[{required:!0,message:s.formatMessage({id:"workgroup.settings.required",defaultMessage:"请选择工作组配置"})}],children:(0,J.jsxs)(P.Z.Compact,{block:!0,children:[(0,J.jsx)(R.Z,{showSearch:!0,allowClear:!0,placeholder:s.formatMessage({id:"workgroup.settings.placeholder",defaultMessage:"请选择工作组配置"}),options:te,loading:X,filterOption:!1,onSearch:function(e){return re(e)},onFocus:function(){return re()},notFoundContent:0===K.length?(0,J.jsxs)("div",{style:{textAlign:"center",padding:"12px 0"},children:[(0,J.jsx)("div",{style:{marginBottom:8,color:"#999"},children:s.formatMessage({id:"workgroup.settings.empty",defaultMessage:"暂无配置模板"})}),(0,J.jsx)(y.ZP,{size:"small",type:"primary",icon:(0,J.jsx)(E.Z,{}),onClick:function(){return Z(!0)},children:s.formatMessage({id:"workgroup.settings.create",defaultMessage:"创建配置"})})]}):void 0}),(0,J.jsx)(y.ZP,{size:"small",icon:(0,J.jsx)(E.Z,{}),onClick:function(){return Z(!0)},title:s.formatMessage({id:"workgroup.settings.create",defaultMessage:"创建配置"}),children:s.formatMessage({id:"common.new",defaultMessage:"新建"})})]})}),(0,J.jsx)(U.Z,{label:s.formatMessage({id:"workgroup.info.nickname",defaultMessage:"名称"}),name:"nickname",rules:[{required:!0,message:s.formatMessage({id:"workgroup.info.nickname.required",defaultMessage:"请输入名称"})}]}),(0,J.jsx)(A.Z,{name:"agents",label:s.formatMessage({id:"workgroup.members",defaultMessage:"成员"}),options:((null==d||null===(t=d.data)||void 0===t?void 0:t.content)||[]).map((function(e){return{value:e.uid,label:o(e.nickname)}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:s.formatMessage({id:"workgroup.members.placeholder",defaultMessage:"请选择成员"}),value:k,onChange:function(e){console.log("selected ".concat(e)),x(e)}}})]}),(0,J.jsx)(F.Z,{open:S,onOpenChange:Z,orgUid:(null==l?void 0:l.uid)||"",record:null,onSuccess:function(){Z(!1),Y((function(e){return e+1}))}})]})})},N=function(e){var t=e.open,n=e.orgUid,r=e.workgroup,a=e.onClose,s=e.onSuccess,u=(0,h.useIntl)(),i=(0,m.useState)([]),o=g()(i,2),l=o[0],d=o[1],f=(0,m.useState)(),v=g()(f,2),w=v[0],k=v[1],x=(0,m.useState)(!1),M=g()(x,2),y=M[0],j=M[1];(0,m.useEffect)((function(){var e=function(){var e=p()(c()().mark((function e(){var a,s,u,i,o,l,p,f,g;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,s={orgUid:n,pageNumber:0,pageSize:200,enabled:!0,type:Z.dCh},e.next=6,(0,S.Bg)(s);case 6:if(u=e.sent,console.log("Ticket settings response:",u,s),i=(null==u||null===(a=u.data)||void 0===a?void 0:a.content)||[],o=i.filter((function(e){return!(null==e||!e.enabled)})),l=o.map((function(e){return{label:e.name||e.uid,value:e.uid}})),d(l),null==r||!r.uid){e.next=20;break}return e.next=15,(0,S.bD)({orgUid:n,workgroupUid:r.uid,type:Z.dCh});case 15:f=e.sent,g=null==f||null===(p=f.data)||void 0===p?void 0:p.uid,k(g||void 0),e.next=21;break;case 20:k(void 0);case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(2),d([]);case 26:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(){return e.apply(this,arguments)}}();e()}),[t,n,null==r?void 0:r.uid]);var C=function(){var e=p()(c()().mark((function e(){var t,a;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&null!=r&&r.uid&&w){e.next=2;break}return e.abrupt("return");case 2:return j(!0),e.prev=3,e.next=6,(0,S.nQ)({uid:w,orgUid:n},{workgroupUids:[r.uid]});case 6:200===(null==(t=e.sent)?void 0:t.code)?(b.yw.success(u.formatMessage({id:"ticket.settings.bind.success",defaultMessage:"绑定已更新"})),a=l.find((function(e){return e.value===w})),s({uid:w,name:(null==a?void 0:a.label)||w})):b.yw.error((null==t?void 0:t.message)||u.formatMessage({id:"ticket.settings.bind.failed",defaultMessage:"绑定失败"}));case 8:return e.prev=8,j(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(W.Z,{title:u.formatMessage({id:"workgroup.ticket.template.modal.title",defaultMessage:"设置工单配置模板"}),open:t,onCancel:a,onOk:C,okButtonProps:{loading:y},destroyOnHidden:!0,children:[(0,J.jsx)("div",{style:{marginBottom:8},children:u.formatMessage({id:"workgroup.ticket.template.tip",defaultMessage:"请选择已启用的工单配置模板"})}),(0,J.jsx)(R.Z,{style:{width:"100%"},placeholder:u.formatMessage({id:"workgroup.ticket.template.placeholder",defaultMessage:"选择模板"}),options:l,value:w,onChange:k,showSearch:!0,filterOption:function(e,t){return((null==t?void 0:t.label)||"").toLowerCase().includes(e.toLowerCase())}})]})},V=n(67242),G=n(85977),Y=function(e){var t,n,r,s,i,l,d,f,I,A,T=e.superUser,U=(0,h.useIntl)(),O=(0,m.useRef)(),q=(0,C.u)((function(e){return e.currentOrg})),F=(0,m.useState)(!1),P=g()(F,2),E=P[0],B=P[1],D=(0,m.useState)(!1),z=g()(D,2),W=z[0],R=z[1],Y=(0,m.useState)(null),_=g()(Y,2),H=_[0],K=_[1],Q=(0,m.useState)(!1),$=g()(Q,2),ee=$[0],te=$[1],ne=(0,m.useState)(null),re=g()(ne,2),ae=re[0],se=re[1],ue=(0,m.useState)({}),ie=g()(ue,2),oe=ie[0],le=ie[1],ce=(0,h.useAccess)(),de=(0,m.useMemo)((function(){var e;return null==ce||null===(e=ce.getModulePermission)||void 0===e?void 0:e.call(ce,G.MY.WORKGROUP)}),[ce]),pe=null!==(t=null==de||null===(n=de.canRead)||void 0===n?void 0:n.call(de))&&void 0!==t&&t,fe=null!==(r=null==de||null===(s=de.canCreate)||void 0===s?void 0:s.call(de))&&void 0!==r&&r,ge=null!==(i=null==de||null===(l=de.canUpdate)||void 0===l?void 0:l.call(de))&&void 0!==i&&i,me=null!==(d=null==de||null===(f=de.canDelete)||void 0===f?void 0:f.call(de))&&void 0!==d&&d,he=(I=null==de||null===(A=de.canExport)||void 0===A?void 0:A.call(de),function(e,t){b.yw.warning(U.formatMessage({id:e,defaultMessage:t}))}),ve=(0,m.useRef)({}),we=(0,m.useRef)(!1),ke=function(){var e=p()(c()().mark((function e(t){var n,r,a,s,i;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe){e.next=2;break}return e.abrupt("return");case 2:if(null!=q&&q.uid&&Array.isArray(t)&&0!==t.length){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,Promise.all(t.map(function(){var e=p()(c()().mark((function e(t){var n,r,a;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.uid){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,(0,S.bD)({orgUid:q.uid,workgroupUid:t.uid,type:Z.dCh});case 5:if(n=e.sent,r=null==n?void 0:n.data,a=null==r?void 0:r.name,!(null==r?void 0:r.uid)||!a){e.next=11;break}return e.abrupt("return",[t.uid,a]);case 11:e.next=15;break;case 13:e.prev=13,e.t0=e.catch(2);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}()));case 7:n=e.sent,r={},a=o()(n);try{for(a.s();!(s=a.n()).done;)(i=s.value)&&(r[i[0]]=i[1])}catch(e){a.e(e)}finally{a.f()}Object.keys(r).length>0&&le((function(e){return u()(u()({},e),r)})),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(4);case 16:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}(),xe=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:U.formatMessage({id:"nickname",defaultMessage:"Nickname"}),dataIndex:"nickname",copyable:!0,ellipsis:!0,fixed:"left",hideInSearch:!0},{title:U.formatMessage({id:"avatar",defaultMessage:"Avatar"}),dataIndex:"avatar",width:64,hideInSearch:!0,render:function(e,t){return(0,J.jsx)(w.Z,{src:null==t?void 0:t.avatar})}},{title:U.formatMessage({id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",copyable:!0,width:220,hideInSearch:!0},{title:U.formatMessage({id:"workgroup.members",defaultMessage:"客服"}),dataIndex:"agents",width:420,hideInSearch:!0,ellipsis:!0,render:function(e,t){var n=(null==t?void 0:t.agents)||[];if(null==n||!n.length)return(0,J.jsx)("span",{style:{color:"#999"},children:U.formatMessage({id:"workgroup.members.empty",defaultMessage:"暂无客服"})});var r=function(e){switch(e){case"AVAILABLE":return"blue";case"BUSY":return"red";case"AWAY":return"orange";default:return"default"}},a=function(e){switch(e){case"AVAILABLE":return U.formatMessage({id:"agent.status.available",defaultMessage:"空闲"});case"BUSY":return U.formatMessage({id:"agent.status.busy",defaultMessage:"忙碌"});case"AWAY":return U.formatMessage({id:"agent.status.away",defaultMessage:"离开"});case"OFFLINE":return U.formatMessage({id:"agent.status.offline",defaultMessage:"离线"});default:return e||U.formatMessage({id:"unknown",defaultMessage:"未知"})}};return(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4,minWidth:0},children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[(0,J.jsx)(w.Z.Group,{max:{count:5},size:"small",children:n.map((function(e){var t;return(0,J.jsx)(k.Z,{title:null==e?void 0:e.nickname,children:(0,J.jsx)(w.Z,{src:null==e?void 0:e.avatar,children:null===(t=(null==e?void 0:e.nickname)||(null==e?void 0:e.uid)||"?")||void 0===t?void 0:t.slice(0,1)})},null==e?void 0:e.uid)}))}),(0,J.jsx)("span",{style:{color:"#666",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.map((function(e){return null==e?void 0:e.nickname})).filter(Boolean).join("、")})]}),(0,J.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:[n.slice(0,12).map((function(e){var t=null==e?void 0:e.connected;return(0,J.jsxs)(x.Z,{color:t?"green":r(null==e?void 0:e.status),style:{margin:0},children:[(null==e?void 0:e.nickname)||(null==e?void 0:e.uid)||"?"," ",t?U.formatMessage({id:"agent.online",defaultMessage:"在线"}):U.formatMessage({id:"agent.offline",defaultMessage:"离线"})," / ",a(null==e?void 0:e.status)]},(null==e?void 0:e.uid)+"_tag")})),n.length>12&&(0,J.jsxs)(x.Z,{color:"purple",style:{margin:0},children:["+",n.length-12]},"more")]})]})}},{title:U.formatMessage({id:"workgroup.connected.count",defaultMessage:"在线客服数"}),dataIndex:"connectedAgentCount",width:100,hideInSearch:!0,render:function(e,t){var n;return(0,J.jsx)(x.Z,{color:"green",children:null!==(n=null==t?void 0:t.connectedAgentCount)&&void 0!==n?n:0})}},{title:U.formatMessage({id:"workgroup.available.count",defaultMessage:"可接待客服数"}),dataIndex:"availableAgentCount",width:120,hideInSearch:!0,render:function(e,t){var n;return(0,J.jsx)(x.Z,{color:"blue",children:null!==(n=null==t?void 0:t.availableAgentCount)&&void 0!==n?n:0})}},{title:U.formatMessage({id:"workgroup.connectedAndAvailable.count",defaultMessage:"在线并可接待客服数"}),dataIndex:"connectedAndAvailableAgentCount",width:150,hideInSearch:!0,render:function(e,t){var n;return(0,J.jsx)(x.Z,{color:"blue",children:null!==(n=null==t?void 0:t.connectedAndAvailableAgentCount)&&void 0!==n?n:0})}},{title:U.formatMessage({id:"workgroup.busy.count",defaultMessage:"忙碌客服数"}),dataIndex:"busyAgentCount",width:100,hideInSearch:!0,render:function(e,t){var n;return(0,J.jsx)(x.Z,{color:"red",children:null!==(n=null==t?void 0:t.busyAgentCount)&&void 0!==n?n:0})}},{title:U.formatMessage({id:"workgroup.away.count",defaultMessage:"离开客服数"}),dataIndex:"awayAgentCount",width:100,hideInSearch:!0,render:function(e,t){var n;return(0,J.jsx)(x.Z,{color:"orange",children:null!==(n=null==t?void 0:t.awayAgentCount)&&void 0!==n?n:0})}},{title:U.formatMessage({id:"workgroup.offline.count",defaultMessage:"离线客服数"}),dataIndex:"offlineAgentCount",width:100,hideInSearch:!0,render:function(e,t){var n;return(0,J.jsx)(x.Z,{children:null!==(n=null==t?void 0:t.offlineAgentCount)&&void 0!==n?n:0})}},{title:U.formatMessage({id:"workgroup.settings",defaultMessage:"工作组配置"}),dataIndex:"settings",width:200,hideInSearch:!0,render:function(e,t){var n=function(){ge?(K(t),B(!0)):he("workgroup.permission.update.denied","无权限：编辑工作组")};return null!=t&&t.settings?(0,J.jsx)("a",{onClick:n,children:t.settings.name||U.formatMessage({id:"workgroup.settings.configured",defaultMessage:"已配置"})}):(0,J.jsx)("a",{style:{color:"#ff4d4f"},onClick:n,children:U.formatMessage({id:"workgroup.settings.unconfigured",defaultMessage:"未配置，点击配置"})})}},{title:U.formatMessage({id:"workgroup.ticket.template",defaultMessage:"工单配置模板"}),dataIndex:"ticketTemplate",width:220,hideInSearch:!0,render:function(e,t){var n=oe[t.uid],r=n?void 0:{color:"#ff4d4f"};return(0,J.jsx)("a",{onClick:function(){return e=t,void(ge?null!=q&&q.uid&&null!=e&&e.uid&&(se(e),te(!0)):he("workgroup.permission.update.denied","无权限：修改工作组"));var e},style:r,children:n||U.formatMessage({id:"workgroup.ticket.template.choose",defaultMessage:"设置/修改模板"})})}},{title:U.formatMessage({id:"description",defaultMessage:"Description"}),dataIndex:"description",ellipsis:!0,hideInSearch:!0},{title:U.formatMessage({id:"createdAt",defaultMessage:"Created At"}),dataIndex:"createdAt",width:180,sorter:!0,hideInSearch:!0},{title:U.formatMessage({id:"updatedAt",defaultMessage:"Updated At"}),dataIndex:"updatedAt",width:180,sorter:!0,hideInSearch:!0},{title:U.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:260,fixed:"right",render:function(e,t){var n=[];return pe&&n.push((0,J.jsx)("a",{onClick:function(){return function(e){var t;if(pe)if(null!=e&&e.uid){var n={chatConfig:{org:null==q?void 0:q.uid,t:Z.I$6,sid:e.uid}};null===(t=window.bytedesk)||void 0===t||t.showChat(n)}else b.yw.error(U.formatMessage({id:"workgroup.invalid",defaultMessage:"无效的工作组"}));else he("workgroup.permission.read.denied","无权限：查看工作组")}(t)},children:U.formatMessage({id:"chat.test",defaultMessage:"测试"})},"test")),pe&&n.push((0,J.jsx)("a",{onClick:function(){return h.history.push("/service/channel")},children:U.formatMessage({id:"workgroup.get.code",defaultMessage:"获取工作组代码"})},"code")),ge&&n.push((0,J.jsx)("a",{onClick:function(){K(t),B(!0)},children:U.formatMessage({id:"edit",defaultMessage:"编辑"})},"edit")),me&&n.push((0,J.jsx)(M.Z,{title:U.formatMessage({id:"deleteTip",defaultMessage:"删除确认"}),description:"".concat(U.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(null==t?void 0:t.nickname,"】？"),onConfirm:p()(c()().mark((function e(){var n,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(me){e.next=3;break}return he("workgroup.permission.delete.denied","无权限：删除工作组"),e.abrupt("return");case 3:return b.yw.loading(U.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),e.prev=4,e.next=7,(0,j.zl)(t);case 7:n=e.sent,b.yw.destroy(),200===(null==n?void 0:n.code)?(b.yw.success(U.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),null===(r=O.current)||void 0===r||r.reload()):b.yw.error((null==n?void 0:n.message)||"Delete failed"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),b.yw.destroy(),b.yw.error("Delete error");case 16:case"end":return e.stop()}}),e,null,[[4,12]])}))),okText:U.formatMessage({id:"ok",defaultMessage:"OK"}),cancelText:U.formatMessage({id:"cancel",defaultMessage:"Cancel"}),children:(0,J.jsx)("a",{children:U.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")),n}},{title:U.formatMessage({id:"search",defaultMessage:"Search"}),dataIndex:"searchText",valueType:"text",hideInTable:!0,hideInSearch:!1}];return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(v.Z,{columns:xe,actionRef:O,rowKey:"uid",cardBordered:!0,scroll:{x:"max-content"},search:{labelWidth:"auto"},onLoad:function(e){ke(e||[])},toolBarRender:function(){var e=[];return fe&&e.push((0,J.jsx)(y.ZP,{type:"primary",onClick:function(){fe?(K(null),R(!0)):he("workgroup.permission.create.denied","无权限：创建工作组")},children:U.formatMessage({id:"pages.robot.new",defaultMessage:"New"})},"new")),e},request:function(){var e=p()(c()().mark((function e(t,n){var r,a,s,i,o,l,d,p,f,m,h,v,w,k,x,M,y,b,S,C,Z,I;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe){e.next=3;break}return we.current||(we.current=!0,he("workgroup.permission.read.denied","无权限：查看工作组")),e.abrupt("return",{data:[],total:0,success:!1});case 3:return i=(null!==(r=null==t?void 0:t.current)&&void 0!==r?r:1)-1,o=null!==(a=null==t?void 0:t.pageSize)&&void 0!==a?a:10,l=null!==(s=null==t?void 0:t.searchText)&&void 0!==s?s:"",(f=Object.entries(n||{})).length>0&&(m=f[0],h=g()(m,2),v=h[0],(w=h[1])&&(d=v,p="ascend"===w?"ascend":"descend")),k=u()(u()({pageNumber:i,pageSize:o,orgUid:null==q?void 0:q.uid,searchText:l,superUser:T},d?{sortBy:d}:{}),p?{sortDirection:p}:{}),ve.current={searchText:l,sortBy:d,sortDirection:p},e.prev=10,e.next=13,(0,j.LE)(k);case 13:if(x=e.sent,V.Z.debug("WorkgroupTable queryWorkgroupsByOrg",x,k),200!==(null==x?void 0:x.code)){e.next=19;break}return Z=(null==x||null===(M=x.data)||void 0===M?void 0:M.content)||[],I=null!==(y=null!==(b=null==x||null===(S=x.data)||void 0===S?void 0:S.totalElements)&&void 0!==b?b:null==x||null===(C=x.data)||void 0===C?void 0:C.numberOfElements)&&void 0!==y?y:Z.length,e.abrupt("return",{data:Z,total:I,success:!0});case 19:return e.abrupt("return",{data:[],total:0,success:!1});case 22:return e.prev=22,e.t0=e.catch(10),V.Z.error("WorkgroupTable queryWorkgroupsByOrg error",e.t0,k),e.abrupt("return",{data:[],total:0,success:!1});case 26:case"end":return e.stop()}}),e,null,[[10,22]])})));return function(t,n){return e.apply(this,arguments)}}(),pagination:{showQuickJumper:!0},dateFormatter:"string",headerTitle:U.formatMessage({id:"workgroup",defaultMessage:"Workgroup"})}),E&&(0,J.jsx)(X,{open:E,record:H,onClose:function(){return B(!1)},onSuccess:function(){var e;return null===(e=O.current)||void 0===e?void 0:e.reload()}}),W&&(0,J.jsx)(L,{open:W,onClose:function(){return R(!1)},onSubmit:function(){var e=p()(c()().mark((function e(t){var n,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(fe){e.next=3;break}return he("workgroup.permission.create.denied","无权限：创建工作组"),e.abrupt("return");case 3:return b.yw.loading(U.formatMessage({id:"saving",defaultMessage:"Saving..."})),e.prev=4,e.next=7,(0,j.p0)(t);case 7:n=e.sent,b.yw.destroy(),200===(null==n?void 0:n.code)?(b.yw.success(U.formatMessage({id:"create.success",defaultMessage:"Create success"})),R(!1),null===(r=O.current)||void 0===r||r.reload()):b.yw.error((null==n?void 0:n.message)||U.formatMessage({id:"create.fail",defaultMessage:"Create failed"})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),b.yw.destroy(),b.yw.error(U.formatMessage({id:"create.fail",defaultMessage:"Create failed"}));case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}()}),(0,J.jsx)(N,{open:ee,orgUid:null==q?void 0:q.uid,workgroup:ae,onClose:function(){te(!1),se(null)},onSuccess:function(e){var t=e.name;ge?(null!=ae&&ae.uid&&le((function(e){return u()(u()({},e),{},a()({},ae.uid,t))})),te(!1),se(null)):he("workgroup.permission.update.denied","无权限：修改工作组")}})]})}}}]);