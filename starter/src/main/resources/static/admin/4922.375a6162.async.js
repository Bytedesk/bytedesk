"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4922],{50989:function(e,t,n){n.d(t,{IH:function(){return g},RB:function(){return y},SJ:function(){return m},Xy:function(){return q},iO:function(){return w},u9:function(){return c},wU:function(){return v}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),l=n(6844),d=n(19736);function c(e){return f.apply(this,arguments)}function f(){return(f=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/agent/settings/query/org",{method:"GET",params:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return p.apply(this,arguments)}function p(){return(p=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/agent/settings/create",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/agent/settings/update",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/agent/settings/delete",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return x.apply(this,arguments)}function x(){return(x=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/agent/settings/enable",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/agent/settings/disable",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return S.apply(this,arguments)}function S(){return(S=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/agent/settings/publish",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},64484:function(e,t,n){n.d(t,{Dm:function(){return y},Y2:function(){return v},jT:function(){return g},zN:function(){return m},zc:function(){return c}});var r=n(90819),i=n.n(r),a=n(73193),s=n.n(a),o=n(89933),u=n.n(o),l=n(6844),d=n(19736);function c(e){return f.apply(this,arguments)}function f(){return(f=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/workgroup/settings/query/org",{method:"GET",params:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return p.apply(this,arguments)}function p(){return(p=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/workgroup/settings/create",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/workgroup/settings/update",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/workgroup/settings/delete",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return x.apply(this,arguments)}function x(){return(x=u()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/workgroup/settings/publish",{method:"POST",data:s()(s()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},47460:function(e,t,n){n(90819),n(89933),n(73193),n(45332),n(46219),n(73268),n(14281),n(6844),n(19736),n(44194),n(5719),n(74341),n(31549)},21914:function(e,t,n){var r=n(90819),i=n.n(r),a=n(89933),s=n.n(a),o=n(45332),u=n.n(o),l=(n(90104),n(30064)),d=n(93312),c=n(19736),f=n(44194),g=(n(53816),n(44679)),p=n(31549);t.Z=function(e){e.variant;var t=e.serviceSettings,n=e.onServiceSettingsChange,r=(0,c.useIntl)(),a=l.A.useForm(),o=u()(a,1)[0],v=(0,g.Z)().translateString,h=(0,f.useState)(!1),m=u()(h,2),b=(m[0],m[1]),y=(0,f.useState)(""),x=u()(y,2),w=(x[0],x[1]),k=(0,f.useMemo)((function(){var e,n;return null!==(e=null!==(n=null==t?void 0:t.draft)&&void 0!==n?n:null==t?void 0:t.live)&&void 0!==e?e:void 0}),[null==t?void 0:t.draft,null==t?void 0:t.live]);(0,f.useEffect)((function(){var e=!(null==k||!k.showRateBtn),t=v(null==k?void 0:k.inviteRateTip)||"";o.setFieldsValue({showRateBtn:null==k?void 0:k.showRateBtn,autoInviteRate:null==k?void 0:k.autoInviteRate}),b(e),w(t)}),[k,o,v]);var q=function(){var e=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onFinish:",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRating handleChange autoInviteRate",t),o.setFieldValue("autoInviteRate",t),null==n||n({autoInviteRate:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)(l.A,{form:o,onFinish:q,submitter:!1,style:{marginLeft:"20px"},children:[(0,p.jsx)(d.Z,{width:"md",name:"autoInviteRate",label:r.formatMessage({id:"rate.auto.invite.rate"}),tooltip:r.formatMessage({id:"rate.auto.invite.rate.tooltip"}),fieldProps:{onChange:S}}),!1]})})}},2061:function(e,t,n){var r=n(73193),i=n.n(r),a=n(90819),s=n.n(a),o=n(89933),u=n.n(o),l=n(45332),d=n.n(l),c=n(93527),f=n(50989),g=n(29195),p=n(64484),v=n(11591),h=n(67559),m=n(46219),b=n(73268),y=n(14281),x=n(61952),w=n(14888),k=n(44679),q=n(6844),S=n(30064),j=n(93312),C=n(86684),M=n(68263),U=n(19736),F=n(44194),T=n(85255),R=n(31167),Z=n(29589),A=n(94323),I=n(44929),P=n(40795),K=n(65819),O=n(74341),E=n(43590),V=n(35912),X=n(16581),W=n(31549);t.Z=function(e){var t,n,r,a,o,l,L,N,J=e.variant,Q=e.serviceSettings,B=e.onServiceSettingsChange,z=e.settingsUid,D=e.isActive,_=void 0===D||D,Y=(0,U.useIntl)(),$=S.A.useForm(),H=d()($,1)[0],G=(0,w.u)((function(e){return e.currentOrg})),ee=(0,k.Z)().translateString,te=null==Q?void 0:Q.live,ne=null==Q?void 0:Q.draft,re=(0,F.useMemo)((function(){var e;return null!==(e=null!=ne?ne:te)&&void 0!==e?e:{}}),[ne,te]),ie="robot"===J,ae="agent"===J?q.Njn:ie?q._X4:q.aZD,se=(0,F.useState)(),oe=d()(se,2),ue=oe[0],le=oe[1],de=(0,F.useState)(),ce=d()(de,2),fe=ce[0],ge=ce[1],pe=(0,F.useState)(),ve=d()(pe,2),he=ve[0],me=ve[1],be=(0,F.useState)("iframe"),ye=d()(be,2),xe=ye[0],we=ye[1],ke=(0,F.useState)(0),qe=d()(ke,2),Se=qe[0],je=qe[1],Ce=(0,F.useState)(!1),Me=d()(Ce,2),Ue=Me[0],Fe=Me[1],Te=(0,F.useRef)(Promise.resolve()),Re=(0,F.useState)("desktop"),Ze=d()(Re,2),Ae=Ze[0],Ie=Ze[1],Pe=(0,F.useState)(),Ke=d()(Pe,2),Oe=Ke[0],Ee=Ke[1],Ve=(0,F.useState)(),Xe=d()(Ve,2),We=Xe[0],Le=Xe[1],Ne=(0,F.useState)(),Je=d()(Ne,2),Qe=Je[0],Be=Je[1],ze=(0,F.useCallback)((function(){var e=(null==G?void 0:G.uid)||"unknown";return"admin.preview.selected.".concat(J,".").concat(e)}),[null==G?void 0:G.uid,J]),De=(0,F.useCallback)((function(){try{return localStorage.getItem(ze())||void 0}catch(e){return}}),[ze]),_e=(0,F.useCallback)((function(e){try{var t=ze();e?localStorage.setItem(t,e):localStorage.removeItem(t)}catch(e){}}),[ze]),Ye=(0,b.V)((function(e){return{robotResult:e.robotResult,setRobotResult:e.setRobotResult}})),$e=Ye.robotResult,He=Ye.setRobotResult,Ge=(0,m.E)((function(e){return{agentResult:e.agentResult,setAgentResult:e.setAgentResult}})),et=Ge.agentResult,tt=Ge.setAgentResult,nt=(0,y.$)((function(e){return{workgroupResult:e.workgroupResult,setWorkgroupResult:e.setWorkgroupResult}})),rt=nt.workgroupResult,it=nt.setWorkgroupResult,at=(0,x.z)((function(e){return{currentRobotSettings:e.currentRobotSettings,currentAgentSettings:e.currentAgentSettings,currentWorkgroupSettings:e.currentWorkgroupSettings}})),st=at.currentRobotSettings,ot=at.currentAgentSettings,ut=at.currentWorkgroupSettings,lt=(0,F.useMemo)((function(){if(ae===q._X4){var e,t=Oe||(null==$e||null===(e=$e.data)||void 0===e||null===(e=e.content)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.uid)||"";return{chatType:q.ACv,chatSid:t}}if(ae===q.Njn){var n,r=We||(null==et||null===(n=et.data)||void 0===n||null===(n=n.content)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.uid)||"";return{chatType:q._0X,chatSid:r}}if(ae===q.aZD){var i,a=Qe||(null==rt||null===(i=rt.data)||void 0===i||null===(i=i.content)||void 0===i||null===(i=i[0])||void 0===i?void 0:i.uid)||"";return{chatType:q.I$6,chatSid:a}}return{chatType:q.ACv,chatSid:""}}),[ae,Oe,null==$e||null===(t=$e.data)||void 0===t?void 0:t.content,We,null==et||null===(n=et.data)||void 0===n?void 0:n.content,Qe,null==rt||null===(r=rt.data)||void 0===r?void 0:r.content]),dt=lt.chatType,ct=lt.chatSid,ft=(0,F.useCallback)(function(){var e=u()(s()().mark((function e(t){var n,r,i,a,o,u,l,d;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||he){e.next=4;break}return console.log("TabRight: 没有选择知识库，无法获取FAQ"),le(void 0),e.abrupt("return");case 4:return c.yw.loading(Y.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:100,orgUid:null==G?void 0:G.uid,kbUid:t||he},e.prev=6,e.next=9,(0,v.pf)(n);case 9:r=e.sent,console.log("TabRight.getFaqs response:",n,r),c.yw.destroy(),200===r.code?(i={code:r.code,message:r.message,data:{content:null==r?void 0:r.data.content.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer,kbUid:e.kbUid,orgUid:e.orgUid}})),totalElements:null==r?void 0:r.data.totalElements,totalPages:null==r?void 0:r.data.totalPages,number:null==r?void 0:r.data.number}},le(i),a=t||he,o=H.getFieldValue("faqUids")||[],a&&o.length>0&&(l=(null==i||null===(u=i.data.content)||void 0===u?void 0:u.map((function(e){return e.uid})))||[],(d=o.filter((function(e){return l.includes(e)}))).length!==o.length&&H.setFieldValue("faqUids",d))):c.yw.error(r.message),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(6),c.yw.destroy(),console.error("TabRight 获取FAQ失败:",e.t0),c.yw.error("获取FAQ失败");case 20:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}(),[null==G?void 0:G.uid,H,Y,he]),gt=(0,F.useCallback)(u()(s()().mark((function e(){var t,n,r,i,a;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(Y.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:q.QPQ,orgUid:null==G?void 0:G.uid},e.prev=2,e.next=5,(0,h.AP)(t);case 5:n=e.sent,console.log("TabRight.getKbases response:",t,n),c.yw.destroy(),200===n.code?(i={code:n.code,message:n.message,data:{content:null==n?void 0:n.data.content.map((function(e){return{uid:e.uid,name:e.name,type:e.type,orgUid:e.orgUid}})),totalElements:null==n?void 0:n.data.totalElements,totalPages:null==n?void 0:n.data.totalPages,number:null==n?void 0:n.data.number}},ge(i),null!=ne&&ne.faqKbUid?a=ne.faqKbUid:null!=te&&te.faqKbUid?a=te.faqKbUid:(null==i||null===(r=i.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&(a=null==i?void 0:i.data.content[0].uid),a&&(me(a),H.setFieldValue("faqKbUid",a),ft(a))):c.yw.error(n.message),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),c.yw.destroy(),console.error("TabRight 获取知识库失败:",e.t0),c.yw.error("获取知识库失败");case 16:case"end":return e.stop()}}),e,null,[[2,11]])}))),[null==G?void 0:G.uid,H,ft,Y,null==ne?void 0:ne.faqKbUid,null==te?void 0:te.faqKbUid]);(0,F.useEffect)((function(){var e=Array.isArray(null==re?void 0:re.faqs)?(null==re?void 0:re.faqs).map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[];H.setFieldsValue({showRightIframe:null==re?void 0:re.showRightIframe,rightIframeUrl:null==re?void 0:re.rightIframeUrl,showFaqs:null==re?void 0:re.showFaqs,faqKbUid:null==re?void 0:re.faqKbUid,faqUids:Array.isArray(null==re?void 0:re.faqUids)?null==re?void 0:re.faqUids:e}),null!=re&&re.faqKbUid&&re.faqKbUid!==he&&(me(re.faqKbUid),ft(re.faqKbUid))}),[H,ft,re,he]),(0,F.useEffect)((function(){null!=G&&G.uid&&gt()}),[null==G?void 0:G.uid,gt]),(0,F.useEffect)((function(){var e=function(){var e=u()(s()().mark((function e(){var t,n,r,i,a,o,u,l,d,c,f,g,p,v,h,m,b,y,x,w,k;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=G&&G.uid){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,ae!==q.Njn){e.next=11;break}return t={pageNumber:0,pageSize:100,orgUid:G.uid},e.next=7,(0,E._t)(t);case 7:200===(n=e.sent).code&&(tt(n),i=(null===(r=n.data)||void 0===r?void 0:r.content)||[],a=De(),(o=a?i.find((function(e){return(null==e?void 0:e.uid)===a})):void 0)?Le(o.uid):!We&&i.length&&(u=i[0],Le(null==u?void 0:u.uid),_e(null==u?void 0:u.uid))),e.next=25;break;case 11:if(ae!==q._X4){e.next=19;break}return l={pageNumber:0,pageSize:100,level:q.whQ,type:q.f4h,orgUid:G.uid},e.next=15,(0,V.p0)(l);case 15:200===(d=e.sent).code&&(He(d),f=(null===(c=d.data)||void 0===c?void 0:c.content)||[],g=De(),(p=g?f.find((function(e){return(null==e?void 0:e.uid)===g})):void 0)?Ee(p.uid):!Oe&&f.length&&(v=f[0],Ee(null==v?void 0:v.uid),_e(null==v?void 0:v.uid))),e.next=25;break;case 19:if(ae!==q.aZD){e.next=25;break}return h={pageNumber:0,pageSize:100,orgUid:G.uid},e.next=23,(0,X.LE)(h);case 23:200===(m=e.sent).code&&(it(m),y=(null===(b=m.data)||void 0===b?void 0:b.content)||[],x=De(),(w=x?y.find((function(e){return(null==e?void 0:e.uid)===x})):void 0)?Be(w.uid):!Qe&&y.length&&(k=y[0],Be(null==k?void 0:k.uid),_e(null==k?void 0:k.uid)));case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(2),console.warn("加载预览实体失败(忽略):",e.t0);case 30:case"end":return e.stop()}}),e,null,[[2,27]])})));return function(){return e.apply(this,arguments)}}();e()}),[null==G?void 0:G.uid,ae,tt,He,it,We,Oe,Qe,De,_e]),(0,F.useEffect)((function(){void 0!==z&&vt("switch-settings")}),[z]);var pt=function(){var e=u()(s()().mark((function e(){var t,n,r,a,o,u;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ae===q.Njn?null==ot?void 0:ot.uid:ae===q._X4?null==st?void 0:st.uid:null==ut?void 0:ut.uid){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,H.validateFields();case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),c.yw.warning(Y.formatMessage({id:"form.validate.failed",defaultMessage:"请先修正表单校验错误"})),e.abrupt("return",!1);case 12:if(t=H.getFieldsValue(),n={showRightIframe:t.showRightIframe,rightIframeUrl:t.rightIframeUrl,showFaqs:t.showFaqs,faqKbUid:t.faqKbUid,faqUids:Array.isArray(t.faqUids)?t.faqUids:void 0},e.prev=14,Fe(!0),r=function(e,t,n){return i()(i()(i()({},e||{}),t||{}),n||{})},ae!==q.Njn||!ot){e.next=23;break}return a=r(ot.serviceSettings,ot.draftServiceSettings,n),e.next=21,(0,f.wU)({uid:ot.uid,serviceSettings:a});case 21:case 27:e.next=33;break;case 23:if(ae!==q._X4||!st){e.next=29;break}return o=r(st.serviceSettings,st.draftServiceSettings,n),e.next=27,(0,g.sK)({uid:st.uid,serviceSettings:o});case 29:if(ae!==q.aZD||!ut){e.next=33;break}return u=r(ut.serviceSettings,ut.draftServiceSettings,n),e.next=33,(0,p.Y2)({uid:ut.uid,serviceSettings:u});case 33:return e.abrupt("return",!0);case 36:return e.prev=36,e.t1=e.catch(14),console.warn("保存右侧配置失败(忽略刷新):",e.t1),c.yw.error(Y.formatMessage({id:"save.failed",defaultMessage:"保存失败"})),e.abrupt("return",!1);case 41:return e.prev=41,Fe(!1),e.finish(41);case 44:case"end":return e.stop()}}),e,null,[[3,8],[14,36,41,44]])})));return function(){return e.apply(this,arguments)}}(),vt=function(){var e=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Te.current;case 2:if(!Ue){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,pt();case 6:e.sent&&_&&je((function(e){return e+1}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ht=function(){var e=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onFinish:",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mt=function(){var e=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showRightIframe",t),H.setFieldValue("showRightIframe",t),null==B||B({showRightIframe:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bt=function(){var e=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabRight handleChange showFaqs",t),H.setFieldValue("showFaqs",t),null==B||B({showFaqs:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yt=(0,F.useMemo)((function(){return z||(ae===q.Njn?null==ot?void 0:ot.uid:ae===q._X4?null==st?void 0:st.uid:ae===q.aZD?null==ut?void 0:ut.uid:void 0)}),[z,ae,null==ot?void 0:ot.uid,null==st?void 0:st.uid,null==ut?void 0:ut.uid]);(0,F.useEffect)((function(){_&&vt("tab-activated")}),[_]);var xt=(0,F.useMemo)((function(){if(!_)return"";var e=(0,K.Cn)(),t=new URLSearchParams({org:(null==G?void 0:G.uid)||"",t:dt,sid:ct,debug:"1",k:String(Se)});yt&&t.set("settingsUid",yt);var n="".concat(e,"?").concat(t.toString());return console.log("Chat Preview URL Right:",n),n}),[null==G?void 0:G.uid,dt,ct,Se,yt,_]),wt=(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(j.Z,{width:"md",name:"showRightIframe",label:(0,W.jsxs)("span",{children:[Y.formatMessage({id:"showRightIframe"}),(0,W.jsx)(O.Z,{type:"service",keys:["showRightIframe"],live:te,draft:ne})]}),fieldProps:{onChange:mt,disabled:Ue}}),(0,W.jsx)(C.Z,{width:"md",name:"rightIframeUrl",label:(0,W.jsxs)("span",{children:[Y.formatMessage({id:"rightIframeUrl"}),(0,W.jsx)(O.Z,{type:"service",keys:["rightIframeUrl"],live:te,draft:ne})]}),placeholder:Y.formatMessage({id:"rightIframeUrl.placeholder",defaultMessage:"请输入以 http:// 或 https:// 开头的URL"}),rules:[{type:"url",message:Y.formatMessage({id:"rightIframeUrl.invalid",defaultMessage:"请输入有效的URL地址"})},{pattern:/^https?:\/\/[^\s]+$/i,message:Y.formatMessage({id:"rightIframeUrl.scheme.required",defaultMessage:"必须以 http:// 或 https:// 开头"})}],fieldProps:{type:"url",inputMode:"url",allowClear:!0,disabled:Ue}})]}),kt=(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(j.Z,{width:"md",name:"showFaqs",label:(0,W.jsxs)("span",{children:[Y.formatMessage({id:"faq.show.faqs"}),(0,W.jsx)(O.Z,{type:"service",keys:["showFaqs"],live:te,draft:ne})]}),fieldProps:{onChange:bt,disabled:Ue}}),(0,W.jsx)(M.Z,{name:"faqKbUid",width:"md",label:(0,W.jsxs)("span",{children:[Y.formatMessage({id:"faq.kbase.select",defaultMessage:"选择侧边栏常见问题知识库"}),(0,W.jsx)(O.Z,{type:"service",keys:["faqKbUid"],live:te,draft:ne})]}),options:null==fe||null===(a=fe.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.map((function(e){return{label:ee(e.name),value:e.uid}})),fieldProps:{onChange:function(e){console.log("TabRight selected kbase:",e),me(e),H.setFieldValue("faqUids",[]),ft(e),null==B||B({faqKbUid:e,faqUids:[]})},allowClear:!0,placeholder:Y.formatMessage({id:"choose",defaultMessage:"Choose"}),disabled:Ue}}),(0,W.jsx)(M.Z,{name:"faqUids",width:"md",label:(0,W.jsxs)("span",{children:[Y.formatMessage({id:"menu.kbase.faq"}),(0,W.jsx)(O.Z,{type:"service",keys:["faqUids"],live:te,draft:ne})]}),options:null==ue||null===(o=ue.data)||void 0===o||null===(o=o.content)||void 0===o?void 0:o.map((function(e){return{label:ee(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:Y.formatMessage({id:"choose",defaultMessage:"Choose"}),disabled:Ue}})]});return(0,W.jsxs)(T.Z,{children:[(0,W.jsx)(T.Z.Panel,{defaultSize:"30%",min:"20%",max:"50%",children:(0,W.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,W.jsx)(S.A,{form:H,onFinish:ht,onValuesChange:function(e,t){var n={};Object.prototype.hasOwnProperty.call(e,"rightIframeUrl")&&(n.rightIframeUrl=t.rightIframeUrl),Object.prototype.hasOwnProperty.call(e,"faqUids")&&(n.faqUids=t.faqUids),Object.prototype.hasOwnProperty.call(e,"faqKbUid")&&(n.faqKbUid=t.faqKbUid),Object.keys(n).length>0&&(null==B||B(n))},submitter:!1,children:(0,W.jsx)(R.Z,{activeKey:xe,onChange:we,items:[{key:"iframe",label:Y.formatMessage({id:"showRightIframe",defaultMessage:"右侧iframe"}),children:wt},{key:"faq",label:Y.formatMessage({id:"faq.show.faqs",defaultMessage:"常见问题"}),children:kt}]})})})}),(0,W.jsx)(T.Z.Panel,{children:(0,W.jsxs)("div",{style:{height:"100%",padding:"16px",background:"#f0f2f5",display:"flex",flexDirection:"column"},children:[(0,W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8,gap:12},children:[ae===q.Njn&&(0,W.jsx)(Z.Z,{style:{minWidth:220},value:We,placeholder:Y.formatMessage({id:"preview.select.agent",defaultMessage:"选择预览客服"}),options:((null==et||null===(l=et.data)||void 0===l?void 0:l.content)||[]).map((function(e){return{value:e.uid,label:ee(e.nickname)}})),onChange:function(e){Le(e),_e(e),vt("switch-agent")},allowClear:!0,disabled:Ue}),ae===q._X4&&(0,W.jsx)(Z.Z,{style:{minWidth:220},value:Oe,placeholder:Y.formatMessage({id:"preview.select.robot",defaultMessage:"选择预览机器人"}),options:((null==$e||null===(L=$e.data)||void 0===L?void 0:L.content)||[]).map((function(e){return{value:e.uid,label:ee(e.nickname)}})),onChange:function(e){Ee(e),_e(e),vt("switch-robot")},allowClear:!0,disabled:Ue}),ae===q.aZD&&(0,W.jsx)(Z.Z,{style:{minWidth:220},value:Qe,placeholder:Y.formatMessage({id:"preview.select.workgroup",defaultMessage:"选择预览工作组"}),options:((null==rt||null===(N=rt.data)||void 0===N?void 0:N.content)||[]).map((function(e){return{value:e.uid,label:ee(e.nickname)}})),onChange:function(e){Be(e),_e(e),vt("switch-workgroup")},allowClear:!0,disabled:Ue}),(0,W.jsx)(A.Z,{value:Ae,onChange:function(e){return Ie(e)},options:[{value:"desktop",icon:(0,W.jsx)(I.Z,{})},{value:"mobile",icon:(0,W.jsx)(P.Z,{})}],disabled:Ue})]}),(0,W.jsx)("div",{style:{flex:1,minHeight:720,display:"flex",justifyContent:"center"},children:(0,W.jsx)("div",{style:{width:"mobile"===Ae?390:"100%",height:"100%",border:"1px solid #d9d9d9",borderRadius:4,overflow:"hidden",background:"#fff"},children:(0,W.jsx)("iframe",{src:xt,style:{width:"100%",height:"100%",border:"none"},title:"Chat Preview"},Se)})})]})})]})}},23312:function(e,t,n){var r=n(73193),i=n.n(r),a=n(45332),s=n.n(a),o=n(74341),u=n(61952),l=n(6844),d=n(30064),c=n(69438),f=n(19736),g=n(9428),p=n(48769),v=n(44194),h=n(31549);t.Z=function(e){var t,n=d.A.useForm(),r=s()(n,1)[0],a=(0,f.useIntl)(),m={width:320},b=(0,u.z)((function(e){return{currentRobotSettings:e.currentRobotSettings,currentAgentSettings:e.currentAgentSettings,currentWorkgroupSettings:e.currentWorkgroupSettings,setCurrentRobotSettings:e.setCurrentRobotSettings,setCurrentAgentSettings:e.setCurrentAgentSettings,setCurrentWorkgroupSettings:e.setCurrentWorkgroupSettings}})),y=b.currentRobotSettings,x=b.currentAgentSettings,w=b.currentWorkgroupSettings,k=b.setCurrentRobotSettings,q=b.setCurrentAgentSettings,S=b.setCurrentWorkgroupSettings,j=void 0!==e.variant,C=j?e:null,M=j?C.variant:(t=e.type)===l.Njn?"agent":t===l._X4?"robot":"workgroup",U=(0,v.useMemo)((function(){var e;return j?null!==(e=null==C?void 0:C.serviceSettings)&&void 0!==e?e:{}:"agent"===M?{live:null==x?void 0:x.serviceSettings,draft:null==x?void 0:x.draftServiceSettings}:"robot"===M?{live:null==y?void 0:y.serviceSettings,draft:null==y?void 0:y.draftServiceSettings}:{live:null==w?void 0:w.serviceSettings,draft:null==w?void 0:w.draftServiceSettings}}),[j,C,M,x,y,w]),F=(0,v.useMemo)((function(){return"agent"!==M?null:j?null!==(e=null==C?void 0:C.agentMeta)&&void 0!==e?e:null:{maxThreadCount:null==x?void 0:x.maxThreadCount,timeoutRemindTime:null==x?void 0:x.timeoutRemindTime};var e}),[M,j,C,x]),T=(0,v.useCallback)((function(e){"agent"===M&&x?q(i()(i()({},x),{},{serviceSettings:i()(i()({},x.serviceSettings),e),draftServiceSettings:i()(i()({},x.draftServiceSettings||{}),e)})):"robot"===M&&y?k(i()(i()({},y),{},{serviceSettings:i()(i()({},y.serviceSettings),e),draftServiceSettings:i()(i()({},y.draftServiceSettings||{}),e)})):"workgroup"===M&&w&&S(i()(i()({},w),{},{serviceSettings:i()(i()({},w.serviceSettings),e),draftServiceSettings:i()(i()({},w.draftServiceSettings||{}),e)}))}),[M,x,y,w,q,k,S]),R=(0,v.useCallback)((function(e){"agent"===M&&x&&q(i()(i()({},x),e))}),[M,x,q]),Z=(0,v.useCallback)((function(e){var t;j?null==C||null===(t=C.onServiceSettingsChange)||void 0===t||t.call(C,e):T(e)}),[j,C,T]),A=(0,v.useCallback)((function(e){var t;"agent"===M&&(j?null==C||null===(t=C.onAgentMetaChange)||void 0===t||t.call(C,e):R(e))}),[M,j,C,R]),I=(0,v.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==U?void 0:U.draft)&&void 0!==t?t:null==U?void 0:U.live)&&void 0!==e?e:void 0}),[U]);return(0,v.useEffect)((function(){r.setFieldsValue({autoCloseMin:null==I?void 0:I.autoCloseMin,showLogo:null==I?void 0:I.showLogo})}),[r,I]),(0,v.useEffect)((function(){"agent"===M&&r.setFieldsValue({maxThreadCount:null==F?void 0:F.maxThreadCount,timeoutRemindTime:null==F?void 0:F.timeoutRemindTime})}),[r,M,null==F?void 0:F.maxThreadCount,null==F?void 0:F.timeoutRemindTime]),(0,h.jsxs)(d.A,{form:r,submitter:!1,style:{marginLeft:"20px"},children:["agent"===M&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.Z,{width:"md",name:"maxThreadCount",label:a.formatMessage({id:"agent.settings.max.thread"}),tooltip:a.formatMessage({id:"agent.settings.max.thread.tooltip",defaultMessage:"超出此设置数量会自动进入排队队列，需要手动接入"}),min:0,formItemProps:{style:m},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&A({maxThreadCount:e})}}}),(0,h.jsx)(d.A.Item,{label:a.formatMessage({id:"agent.settings.timeout.remind",defaultMessage:"超时提醒时间"}),tooltip:a.formatMessage({id:"agent.settings.timeout.remind.tooltip",defaultMessage:"超过设定时间未回复客户将收到提醒"}),style:m,children:(0,h.jsxs)(g.Z.Compact,{block:!0,children:[(0,h.jsx)(c.Z,{formItemProps:{noStyle:!0},width:"md",name:"timeoutRemindTime",min:1,fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&A({timeoutRemindTime:e})}}}),(0,h.jsx)(p.Z,{disabled:!0,value:a.formatMessage({id:"time.minute",defaultMessage:"分钟"}),style:{width:72,textAlign:"center"},readOnly:!0,tabIndex:-1})]})})]}),(0,h.jsx)(c.Z,{width:"md",name:"autoCloseMin",label:(0,h.jsxs)("span",{children:[a.formatMessage({id:"agent.settings.auto.close.time"}),(0,h.jsx)(o.Z,{type:"service",keys:["autoCloseMin"],live:null==U?void 0:U.live,draft:null==U?void 0:U.draft})]}),tooltip:a.formatMessage({id:"agent.settings.auto.close.time.tooltip"}),min:1,formItemProps:{style:m},fieldProps:{style:{width:"100%"},onChange:function(e){"number"==typeof e&&Z({autoCloseMin:e})}}})]})}},1725:function(e,t,n){var r=n(45332),i=n.n(r),a=n(74341),s=n(44679),o=n(90104),u=n(30064),l=n(22576),d=n(19736),c=n(44194),f=n(53816),g=n(31549);t.Z=function(e){var t=u.A.useForm(),n=i()(t,1)[0],r=(0,d.useIntl)(),p=(0,s.Z)().translateString,v=e.variant,h=e.serviceSettings,m=e.onServiceSettingsChange,b=(0,c.useState)(!1),y=i()(b,2),x=y[0],w=y[1],k=(0,c.useState)(""),q=i()(k,2),S=q[0],j=q[1],C=(0,c.useState)(""),M=i()(C,2),U=M[0],F=M[1],T=(0,c.useState)(""),R=i()(T,2),Z=R[0],A=R[1],I=(0,c.useRef)({topTip:"",agentCloseTip:"",autoCloseTip:""}),P=(0,c.useMemo)((function(){return null!=h?h:{}}),[h]),K=(0,c.useCallback)((function(e){null==m||m(e)}),[m]),O=(0,c.useMemo)((function(){var e,t;return null!==(e=null!==(t=null==P?void 0:P.draft)&&void 0!==t?t:null==P?void 0:P.live)&&void 0!==e?e:void 0}),[P]);(0,c.useEffect)((function(){var e=!(null==O||!O.showTopTip);x!==e&&(w(e),n.setFieldValue("showTopTip",e));var t=function(e,t){var r=p(t)||"";I.current[e]!==r&&(I.current[e]=r,"topTip"===e?j(r):"agentCloseTip"===e?F(r):"autoCloseTip"===e&&A(r),n.setFieldValue(e,r))};O?(t("topTip",O.topTip),t("agentCloseTip",O.agentCloseTip),t("autoCloseTip",O.autoCloseTip)):(t("topTip",""),t("agentCloseTip",""),t("autoCloseTip",""))}),[O,n,x,p,v]);var E=(0,c.useCallback)((function(e){I.current.topTip=e,j(e),n.setFieldValue("topTip",e),K({topTip:e})}),[n,K]),V=(0,c.useCallback)((function(e){I.current.agentCloseTip=e,F(e),n.setFieldValue("agentCloseTip",e),K({agentCloseTip:e})}),[n,K]),X=(0,c.useCallback)((function(e){I.current.autoCloseTip=e,A(e),n.setFieldValue("autoCloseTip",e),K({autoCloseTip:e})}),[n,K]);return(0,g.jsxs)(u.A,{form:n,submitter:!1,style:{marginLeft:"20px"},children:[(0,g.jsx)(l.Z,{name:"showTopTip",width:"md",label:(0,g.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.show.top.tip"}),(0,g.jsx)(a.Z,{type:"service",keys:["showTopTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),fieldProps:{onChange:function(e){w(e.target.checked),e.target.checked&&j(p(null==O?void 0:O.topTip)),K({showTopTip:e.target.checked})}}}),x&&(0,g.jsx)(u.A.Item,{name:"topTip",label:(0,g.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.top.tip"}),(0,g.jsx)(a.Z,{type:"service",keys:["topTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.top.tip.required"})}],children:(0,g.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.top.tip.placeholder"}),value:S,toolbarKeys:(0,o.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return E(e)}},"topTipEditor")}),"agent"===v&&(0,g.jsx)(u.A.Item,{name:"agentCloseTip",label:(0,g.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.agent.close.tip"}),(0,g.jsx)(a.Z,{type:"service",keys:["agentCloseTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),tooltip:r.formatMessage({id:"agent.settings.agent.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.agent.close.tip.required"})}],children:(0,g.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.agent.close.tip.placeholder"}),value:U,toolbarKeys:(0,o.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return V(e)}},"agentCloseTipEditor")}),(0,g.jsx)(u.A.Item,{name:"autoCloseTip",label:(0,g.jsxs)("span",{children:[r.formatMessage({id:"agent.settings.auto.close.tip"}),(0,g.jsx)(a.Z,{type:"service",keys:["autoCloseTip"],live:null==P?void 0:P.live,draft:null==P?void 0:P.draft})]}),tooltip:r.formatMessage({id:"agent.settings.auto.close.tip.tooltip"}),rules:[{required:!0,message:r.formatMessage({id:"agent.settings.auto.close.tip.required"})}],children:(0,g.jsx)(f.Z,{placeholder:r.formatMessage({id:"agent.settings.auto.close.tip.placeholder"}),value:Z,toolbarKeys:(0,o.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:function(e){return X(e)}},"autoCloseTipEditor")})]})}},42670:function(e,t,n){var r=n(90819),i=n.n(r),a=n(89933),s=n.n(a),o=n(73193),u=n.n(o),l=n(45332),d=n.n(l),c=n(93527),f=n(14888),g=n(6844),p=n(30064),v=n(93312),h=n(68263),m=n(19736),b=n(44194),y=n(98986),x=n(96123),w=n(31167),k=n(11591),q=n(67559),S=n(44679),j=n(74341),C=n(31549),M=["smile","image","file","rate","leavemsg"];t.Z=function(e){var t,n,r=e.serviceSettings,a=e.onServiceSettingsChange,o=(0,m.useIntl)(),l=p.A.useForm(),U=d()(l,1)[0],F=(0,S.Z)().translateString,T=(0,f.u)((function(e){return e.currentOrg})),R=(0,b.useRef)(!1),Z=(0,b.useState)("toolbar"),A=d()(Z,2),I=A[0],P=A[1],K=((0,b.useMemo)((function(){return new Set(["orderSelector","ticket","audio","video","tel"])}),[]),(0,b.useState)()),O=d()(K,2),E=O[0],V=O[1],X=(0,b.useState)(),W=d()(X,2),L=W[0],N=W[1],J=(0,b.useState)(),Q=d()(J,2),B=Q[0],z=Q[1],D=null==r?void 0:r.live,_=null==r?void 0:r.draft,Y=(0,b.useMemo)((function(){return null!=_?_:D}),[_,D]),$=(0,b.useCallback)(s()(i()().mark((function e(){var t,n,r,a,s,u;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(o.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:g.QPQ,orgUid:null==T?void 0:T.uid},e.next=4,(0,q.AP)(t);case 4:n=e.sent,c.yw.destroy(),200===n.code?(N(n),s=null==_?void 0:_.quickFaqKbUid,u=null==D?void 0:D.quickFaqKbUid,s?a=s:u?a=u:(null==n||null===(r=n.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&(a=null==n?void 0:n.data.content[0].uid),a&&(z(a),U.setFieldValue("quickFaqKbUid",a),H(a))):c.yw.error(n.message);case 7:case"end":return e.stop()}}),e)}))),[null==T?void 0:T.uid,o,null==_?void 0:_.quickFaqKbUid,null==D?void 0:D.quickFaqKbUid]),H=(0,b.useCallback)(function(){var e=s()(i()().mark((function e(t){var n,r,a,s,u;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||B){e.next=3;break}return V(void 0),e.abrupt("return");case 3:return c.yw.loading(o.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:50,orgUid:null==T?void 0:T.uid,kbUid:t||B},e.next=7,(0,k.pf)(n);case 7:r=e.sent,c.yw.destroy(),200===r.code?(V(r),(a=U.getFieldValue("quickFaqUids")||[]).length>0&&(s=null==r?void 0:r.data.content.map((function(e){return e.uid})),(u=a.filter((function(e){return s.includes(e)}))).length!==a.length&&U.setFieldValue("quickFaqUids",u))):c.yw.error(r.message);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[null==T?void 0:T.uid,B]),G=(0,b.useCallback)((function(e){z(e),U.setFieldValue("quickFaqUids",[]),H(e),null==a||a({quickFaqKbUid:e,quickFaqUids:[]})}),[U,H,a]);(0,b.useEffect)((function(){null!=T&&T.uid&&!R.current&&($(),R.current=!0)}),[null==T?void 0:T.uid,$]),(0,b.useEffect)((function(){var e,t,n,r,i,a,s,o,u,l;if(Y){var d=Y.toolbar||{},c=null==Y?void 0:Y.quickFaqs;U.setFieldsValue({smile:null===(e=d.smile)||void 0===e||e,image:null===(t=d.image)||void 0===t||t,file:null===(n=d.file)||void 0===n||n,rate:null===(r=d.rate)||void 0===r||r,leavemsg:null===(i=d.leavemsg)||void 0===i||i,orderSelector:null===(a=d.orderSelector)||void 0===a||a,ticket:null===(s=d.ticket)||void 0===s||s,audio:null===(o=d.audio)||void 0===o||o,video:null===(u=d.video)||void 0===u||u,tel:null===(l=d.tel)||void 0===l||l,toolbarOrder:Array.isArray(d.order)&&d.order.length>0?d.order:[].concat(M),showQuickFaqs:Y.showQuickFaqs,quickFaqKbUid:Y.quickFaqKbUid,quickFaqUids:Array.isArray(Y.quickFaqUids)?Y.quickFaqUids:Array.isArray(c)?c.map((function(e){return null==e?void 0:e.uid})).filter(Boolean):[]});var f=Y.quickFaqKbUid;f&&f!==B&&(z(f),H(f))}}),[Y,B,H]);var ee=function(){var e=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=(0,b.useCallback)(function(){var e=s()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U.setFieldValue("showQuickFaqs",t),null==a||a({showQuickFaqs:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[U,a]),ne=(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(y.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,C.jsx)(x.Z,{span:12,children:(0,C.jsx)(v.Z,{name:"smile",label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"chat.toolbar.emoji",defaultMessage:"Emoji"}),(0,C.jsx)(j.Z,{type:"service",keys:["toolbar"],live:D,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),(0,C.jsx)(x.Z,{span:12,children:(0,C.jsx)(v.Z,{name:"image",label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"chat.toolbar.image",defaultMessage:"Image"}),(0,C.jsx)(j.Z,{type:"service",keys:["toolbar"],live:D,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),(0,C.jsx)(x.Z,{span:12,children:(0,C.jsx)(v.Z,{name:"file",label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"chat.toolbar.file",defaultMessage:"File"}),(0,C.jsx)(j.Z,{type:"service",keys:["toolbar"],live:D,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),(0,C.jsx)(x.Z,{span:12,children:(0,C.jsx)(v.Z,{name:"rate",label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"chat.toolbar.rate",defaultMessage:"Rate"}),(0,C.jsx)(j.Z,{type:"service",keys:["toolbar"],live:D,draft:_})]}),formItemProps:{style:{marginBottom:8}}})}),(0,C.jsx)(x.Z,{span:12,children:(0,C.jsx)(v.Z,{name:"leavemsg",label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"chat.toolbar.leaveMsg",defaultMessage:"Leave Msg"}),(0,C.jsx)(j.Z,{type:"service",keys:["toolbar"],live:D,draft:_})]}),formItemProps:{style:{marginBottom:8}}})})]})}),re=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(v.Z,{label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"faq.show.quick.buttons"}),(0,C.jsx)(j.Z,{type:"service",keys:["showQuickFaqs"],live:D,draft:_})]}),name:"showQuickFaqs",width:"md",fieldProps:{onChange:te}}),(0,C.jsx)(h.Z,{name:"quickFaqKbUid",width:"lg",label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"quick.kbase.select",defaultMessage:"选择输入框上方的快捷按钮知识库"}),(0,C.jsx)(j.Z,{type:"service",keys:["quickFaqKbUid"],live:D,draft:_})]}),options:null==L||null===(t=L.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return{label:F(e.name),value:e.uid}})),fieldProps:{onChange:G,allowClear:!0,placeholder:(0,C.jsx)(m.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}}),(0,C.jsx)(h.Z,{name:"quickFaqUids",width:"lg",label:(0,C.jsxs)("span",{children:[o.formatMessage({id:"menu.kbase.quickbutton"}),(0,C.jsx)(j.Z,{type:"service",keys:["quickFaqUids"],live:D,draft:_})]}),options:null==E||null===(n=E.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.map((function(e){return{label:F(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:(0,C.jsx)(m.FormattedMessage,{id:"choose",defaultMessage:"Choose"}),onChange:function(e){null==a||a({quickFaqUids:e})}}})]});return(0,C.jsx)("div",{style:{padding:"0 16px",height:"100%",overflowY:"auto"},children:(0,C.jsx)(p.A,{form:U,onFinish:ee,onValuesChange:function(e,t){var n={};["smile","image","file","rate","leavemsg"].forEach((function(r){Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=t[r])}));var r=Object.prototype.hasOwnProperty.call(e,"toolbarOrder"),i={},s=u()(u()({},(null==D?void 0:D.toolbar)||{}),(null==_?void 0:_.toolbar)||{});Object.keys(n).length>0&&(i.toolbar=u()(u()({},s),n)),r&&(i.toolbar=u()(u()({},i.toolbar||s),{},{order:t.toolbarOrder||[]})),["showQuickFaqs","quickFaqKbUid","quickFaqUids"].forEach((function(n){Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=t[n])})),0!==Object.keys(i).length&&(null==a||a(i))},submitter:!1,children:(0,C.jsx)(w.Z,{activeKey:I,onChange:P,items:[{key:"toolbar",label:o.formatMessage({id:"chat.toolbar.settings",defaultMessage:"工具栏设置"}),children:ne},{key:"quickButton",label:o.formatMessage({id:"quick.faq.settings",defaultMessage:"快捷按钮设置"}),children:re}]})})})}},15012:function(e,t,n){n(73193),n(45332),n(89957),n(74341),n(19736),n(44194),n(31549)},74341:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(73193),i=n.n(r),a=n(44194),s=n(1691),o=n(66810),u=n(86222),l=n.n(u),d=n(89957),c=n.n(d),f=["welcomeFaqUids","faqUids","quickFaqUids","guessFaqUids","hotFaqUids","shortcutFaqUids","proactiveFaqUids"],g=["welcomeFaqs","faqs","quickFaqs","guessFaqs","hotFaqs","shortcutFaqs","proactiveFaqs"];function p(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e,t){if(!e)return e;if(!t||0===t.length)return e;var n={};return t.forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})),n}function h(e){var t=e&&p(e)?i()({},e):{};return g.forEach((function(e){t[e]&&(t[e.replace(/s$/,"Uids")]=function(e){if(Array.isArray(e))return e.map((function(e){return null==e?void 0:e.uid})).filter(Boolean).map(String)}(t[e]),delete t[e])})),f.forEach((function(e){t[e]&&(t[e]=function(e){if(!Array.isArray(e))return e;var t=e.slice();return t.every((function(e){return["string","number","boolean"].includes(c()(e))}))?t.map((function(e){return"string"==typeof e?e:String(e)})).sort():t}(t[e]))})),t}function m(e){return e&&p(e)?i()({},e):{}}function b(e){var t=new WeakSet;return JSON.stringify(function e(n){if(null===n||"object"!==c()(n))return n;if(!t.has(n)){if(t.add(n),Array.isArray(n))return n.map((function(t){return e(t)}));var r,i=Object.keys(n).sort(),a={},s=l()(i);try{for(s.s();!(r=s.n()).done;){var o=r.value;a[o]=e(n[o])}}catch(e){s.e(e)}finally{s.f()}return a}}(e))}function y(e,t){return b(e)===b(t)}var x=n(31549),w=function(e){var t=e.hasDiff,n=e.type,r=void 0===n?"service":n,u=e.live,l=e.draft,d=e.keys,c=e.text,f=void 0===c?"草稿未发布":c,g=e.style;return(0,a.useMemo)((function(){if("boolean"==typeof t)return t;if(!u&&!l)return!1;switch(r){case"service":return function(e,t,n){return!y(v(h(e),n),v(h(t),n))}(u,l,d);case"messageLeave":return function(e,t,n){return!y(v(m(e),n),v(m(t),n))}(u,l,d);default:return function(e,t,n){return!y(v(e||{},n),v(t||{},n))}(u,l,d)}}),[t,r,u,l,d])?(0,x.jsx)(s.Z,{title:"string"==typeof f?f:"草稿与线上不一致",children:(0,x.jsx)(o.Z,{color:"orange",style:i()({marginLeft:8,height:20,lineHeight:"18px"},g),children:"Draft"})}):null}},61952:function(e,t,n){n.d(t,{z:function(){return o}});var r=n(6844),i=n(26557),a=n(26407),s=n(20744),o=(0,i.Ue)()((0,a.mW)((0,a.tJ)((0,s.n)((function(e){return{currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null,setCurrentAgentSettings:function(t){return e({currentAgentSettings:t})},setCurrentRobotSettings:function(t){return e({currentRobotSettings:t})},setCurrentWorkgroupSettings:function(t){return e({currentWorkgroupSettings:t})},clear:function(){return e({currentAgentSettings:null,currentRobotSettings:null,currentWorkgroupSettings:null})}}})),{name:r.rpR})))}}]);