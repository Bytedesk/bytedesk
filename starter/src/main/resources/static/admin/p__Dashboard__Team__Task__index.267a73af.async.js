"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8804],{11090:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(83910),a=r(44194),i={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},s=r(54183),u=function(e,t){return a.createElement(s.Z,(0,n.Z)({},e,{ref:t,icon:i}))};var o=a.forwardRef(u)},62304:function(e,t,r){var n=r(94433),a=r(38956),i=r(44194),s=r(45441),u=r(9953),o=r(31549),l=["fieldProps","proFieldProps"],c="dateTime",d=i.forwardRef((function(e,t){var r=e.fieldProps,d=e.proFieldProps,p=(0,a.Z)(e,l),f=(0,i.useContext)(s.Z);return(0,o.jsx)(u.Z,(0,n.Z)({ref:t,fieldProps:(0,n.Z)({getPopupContainer:f.getPopupContainer},r),valueType:c,proFieldProps:d,filedConfig:{valueType:c,customLightMode:!0}},p))}));t.Z=d},50628:function(e,t,r){var n=r(94433),a=r(38956),i=r(44194),s=r(9953),u=r(31549),o=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],l=i.forwardRef((function(e,t){var r=e.fieldProps,i=e.unCheckedChildren,l=e.checkedChildren,c=e.proFieldProps,d=(0,a.Z)(e,o);return(0,u.jsx)(s.Z,(0,n.Z)({valueType:"switch",fieldProps:(0,n.Z)({unCheckedChildren:i,checkedChildren:l},r),ref:t,valuePropName:"checked",proFieldProps:c,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},d))}));t.Z=l},86702:function(e,t,r){var n=r(32906),a=r(94433),i=r(38956),s=r(81424),u=r(69705),o=r(65641),l=r(34573),c=r(44194),d=r(9953),p=r(31549),f=["fieldProps","proFieldProps"],m=["fieldProps","proFieldProps"],v="text",h=function(e){var t=(0,s.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,n.Z)(t,2),i=r[0],l=r[1];return(0,p.jsx)(u.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var r,n=t.getFieldValue(e.name||[]);return(0,p.jsx)(o.Z,(0,a.Z)((0,a.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return l(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,n),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:i,children:e.children}))}})},x=function(e){var t=e.fieldProps,r=e.proFieldProps,n=(0,i.Z)(e,f);return(0,p.jsx)(d.Z,(0,a.Z)({valueType:v,fieldProps:t,filedConfig:{valueType:v},proFieldProps:r},n))};x.Password=function(e){var t=e.fieldProps,r=e.proFieldProps,s=(0,i.Z)(e,m),u=(0,c.useState)(!1),o=(0,n.Z)(u,2),f=o[0],x=o[1];return null!=t&&t.statusRender&&s.name?(0,p.jsx)(h,{name:s.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:x,children:(0,p.jsx)("div",{children:(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:(0,a.Z)((0,a.Z)({},(0,l.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==t||null===(r=t.onBlur)||void 0===r||r.call(t,e),x(!1)},onClick:function(e){var r;null==t||null===(r=t.onClick)||void 0===r||r.call(t,e),x(!0)}}),proFieldProps:r,filedConfig:{valueType:v}},s))})}):(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:v}},s))},x.displayName="ProFormComponent",t.Z=x},60241:function(e,t,r){var n=r(94433),a=r(38956),i=r(44194),s=r(9953),u=r(31549),o=["fieldProps","proFieldProps"],l=function(e,t){var r=e.fieldProps,i=e.proFieldProps,l=(0,a.Z)(e,o);return(0,u.jsx)(s.Z,(0,n.Z)({ref:t,valueType:"textarea",fieldProps:r,proFieldProps:i},l))};t.Z=i.forwardRef(l)},21850:function(e,t,r){var n=r(25553);t.Z=function(){var e=(0,n.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},64699:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ze}});var n=r(73193),a=r.n(n),i=r(45332),s=r.n(i),u=r(21850),o=r(2134),l=r(21600),c=r(44194),d=r(90819),p=r.n(d),f=r(89933),m=r.n(f),v=r(76711),h=r.n(v),x=r(43388),k=r(94976),b=r(4628);function y(e){return g.apply(this,arguments)}function g(){return(g=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/list/query/org",{method:"GET",params:a()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return j.apply(this,arguments)}function j(){return(j=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/list/create",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return P.apply(this,arguments)}function P(){return(P=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/list/update",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return q.apply(this,arguments)}function q(){return(q=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/list/delete",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=r(74171),T=r(58620),M=r(85977),C=r(10162),I=r(11090),A=r(98792),R=r(86702),U=r(60241),O=r(34512),N=r(69533),D=r(43275),F=r(31549),J=function(){var e,t,r,n,i,u,o,l,d,f,v=(0,z.u)((function(e){return e.currentOrg})),g=(0,b.useIntl)(),j=(0,b.useAccess)(),P=(0,c.useRef)(),q=function(e,t){return g.formatMessage({id:e,defaultMessage:t})},J=(0,c.useMemo)((function(){var e;return null==j||null===(e=j.getModulePermission)||void 0===e?void 0:e.call(j,M.MY.TASK_LIST)}),[j]),B=null!==(e=null==J||null===(t=J.canRead)||void 0===t?void 0:t.call(J))&&void 0!==e&&e,E=null!==(r=null==J||null===(n=J.canCreate)||void 0===n?void 0:n.call(J))&&void 0!==r&&r,L=null!==(i=null==J||null===(u=J.canUpdate)||void 0===u?void 0:u.call(J))&&void 0!==i&&i,X=null!==(o=null==J||null===(l=J.canDelete)||void 0===l?void 0:l.call(J))&&void 0!==o&&o,Y=null!==(d=null==J||null===(f=J.canExport)||void 0===f?void 0:f.call(J))&&void 0!==d&&d,_=function(e,t){return x.yw.warning(q(e,t))},G=(0,c.useState)(1),K=s()(G,2),V=K[0],Q=K[1],W=(0,c.useState)(10),H=s()(W,2),$=H[0],ee=H[1],te=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:q("common.name","名称"),dataIndex:"name",copyable:!0,width:180},{title:q("common.description","描述"),dataIndex:"description",ellipsis:!0,width:240},{title:q("team.task.uid","UID"),dataIndex:"uid",copyable:!0,hideInSearch:!0,width:200,ellipsis:!0},{title:q("createdAt","创建时间"),dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:q("updatedAt","更新时间"),dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180,fixed:"right"}],re=[].concat(te,h()(L||X?[{title:q("actions","操作"),valueType:"option",key:"option",width:160,fixed:"right",render:function(e,t){return[].concat(h()(L?[(0,F.jsxs)(A.Y,{title:q("team.task.list.edit.title","编辑清单"),trigger:(0,F.jsx)(N.ZP,{size:"small",type:"link",children:q("edit","编辑")}),initialValues:t,modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(r){var n,i;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L){e.next=3;break}return _("team.task.list.permission.denied.update","无权限：更新待办清单"),e.abrupt("return",!1);case 3:return e.next=5,Z(a()(a()({},r),{},{uid:t.uid,orgUid:null==v?void 0:v.uid}));case 5:if(200!==(n=e.sent).code){e.next=10;break}return x.yw.success(q("update.success","更新成功")),null===(i=P.current)||void 0===i||i.reload(),e.abrupt("return",!0);case 10:return x.yw.error(n.message||q("update.failed","更新失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"name",label:q("common.name","名称"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:q("common.description","描述")}),(0,F.jsx)(R.Z,{name:"type",label:q("team.task.field.type","类型")})]},"edit")]:[]),h()(X?[(0,F.jsx)(D.Z,{title:q("team.task.list.delete.confirm","确认删除该清单？"),onConfirm:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X){e.next=3;break}return _("team.task.list.permission.denied.delete","无权限：删除待办清单"),e.abrupt("return");case 3:return e.next=5,S({uid:t.uid,orgUid:null==v?void 0:v.uid});case 5:200===(r=e.sent).code?(x.yw.success(q("delete.success","删除成功")),null===(n=P.current)||void 0===n||n.reload()):x.yw.error(r.message||q("delete.error","删除失败"));case 7:case"end":return e.stop()}}),e)}))),okText:g.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:g.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,F.jsx)(N.ZP,{size:"small",type:"link",danger:!0,children:q("delete","删除")})},"delete")]:[]))}}]:[])),ne=function(){var e=m()(p()().mark((function e(){var t;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y){e.next=3;break}return _("team.task.list.permission.denied.export","无权限：导出待办清单"),e.abrupt("return");case 3:t=localStorage.getItem(k.LA8),window.open((0,T.kG)()+"/api/v1/task/list/export?"+new URLSearchParams({orgUid:(null==v?void 0:v.uid)||"",pageNumber:String(V-1),pageSize:String($),accessToken:t||""}).toString());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,F.jsx)(O.Z,{columns:re,cardBordered:!0,actionRef:P,rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0},scroll:{x:"max-content"},tableLayout:"fixed",toolBarRender:function(){return[].concat(h()(E?[(0,F.jsxs)(A.Y,{title:q("team.task.list.create.title","新建清单"),trigger:(0,F.jsx)(N.ZP,{type:"primary",icon:(0,F.jsx)(C.Z,{}),children:q("common.new","新建")}),modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(t){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E){e.next=3;break}return _("team.task.list.permission.denied.create","无权限：创建待办清单"),e.abrupt("return",!1);case 3:return e.next=5,w(a()(a()({},t),{},{orgUid:null==v?void 0:v.uid}));case 5:if(200!==(r=e.sent).code){e.next=10;break}return x.yw.success(q("create.success","创建成功")),null===(n=P.current)||void 0===n||n.reload(),e.abrupt("return",!0);case 10:return x.yw.error(r.message||q("create.failed","创建失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"name",label:q("common.name","名称"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:q("common.description","描述")}),(0,F.jsx)(R.Z,{name:"type",label:q("team.task.field.type","类型")})]},"create")]:[]),h()(Y?[(0,F.jsx)(N.ZP,{icon:(0,F.jsx)(I.Z,{}),onClick:ne,children:q("export","导出")},"export")]:[]))},request:function(){var e=m()(p()().mark((function e(t,r){var n,i,s,u,o,l;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=3;break}return _("team.task.list.permission.denied.read","无权限：查看待办清单"),e.abrupt("return",{data:[],success:!0,total:0});case 3:return s=Object.keys(r||{})[0],u=s?r[s]:void 0,Q(t.current||1),ee(t.pageSize||10),delete(o=a()(a()({pageNumber:t.current?t.current-1:0,pageSize:t.pageSize,orgUid:null==v?void 0:v.uid},t),{},{sortBy:s,sortDirection:u})).current,e.next=11,y(o);case 11:return 200!==(l=e.sent).code&&x.yw.error(l.message),e.abrupt("return",{data:(null==l||null===(n=l.data)||void 0===n?void 0:n.content)||[],success:!0,total:(null==l||null===(i=l.data)||void 0===i?void 0:i.totalElements)||0});case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()})};function B(e){return E.apply(this,arguments)}function E(){return(E=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/query/org",{method:"GET",params:a()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return X.apply(this,arguments)}function X(){return(X=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/create",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return _.apply(this,arguments)}function _(){return(_=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/update",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){return K.apply(this,arguments)}function K(){return(K=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/task/delete",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V=function(){var e,t,r,n,i,u,o,l,d,f,v=(0,z.u)((function(e){return e.currentOrg})),y=(0,b.useIntl)(),g=(0,b.useAccess)(),w=(0,c.useRef)(),j=function(e,t){return y.formatMessage({id:e,defaultMessage:t})},Z=(0,c.useMemo)((function(){var e;return null==g||null===(e=g.getModulePermission)||void 0===e?void 0:e.call(g,M.MY.TASK)}),[g]),P=null!==(e=null==Z||null===(t=Z.canRead)||void 0===t?void 0:t.call(Z))&&void 0!==e&&e,S=null!==(r=null==Z||null===(n=Z.canCreate)||void 0===n?void 0:n.call(Z))&&void 0!==r&&r,q=null!==(i=null==Z||null===(u=Z.canUpdate)||void 0===u?void 0:u.call(Z))&&void 0!==i&&i,J=null!==(o=null==Z||null===(l=Z.canDelete)||void 0===l?void 0:l.call(Z))&&void 0!==o&&o,E=null!==(d=null==Z||null===(f=Z.canExport)||void 0===f?void 0:f.call(Z))&&void 0!==d&&d,X=function(e,t){return x.yw.warning(j(e,t))},_=(0,c.useState)(1),K=s()(_,2),V=K[0],Q=K[1],W=(0,c.useState)(10),H=s()(W,2),$=H[0],ee=H[1],te=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:j("common.name","名称"),dataIndex:"name",copyable:!0,width:180},{title:j("common.description","描述"),dataIndex:"description",ellipsis:!0,width:240},{title:j("team.task.uid","UID"),dataIndex:"uid",copyable:!0,hideInSearch:!0,width:200,ellipsis:!0},{title:j("createdAt","创建时间"),dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:j("updatedAt","更新时间"),dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180,fixed:"right"}],re=[].concat(te,h()(q||J?[{title:j("actions","操作"),valueType:"option",key:"option",width:160,fixed:"right",render:function(e,t){return[].concat(h()(q?[(0,F.jsxs)(A.Y,{title:j("team.task.todo.edit.title","编辑任务"),trigger:(0,F.jsx)(N.ZP,{size:"small",type:"link",children:j("edit","编辑")}),initialValues:t,modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(r){var n,i;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=3;break}return X("team.task.todo.permission.denied.update","无权限：更新待办任务"),e.abrupt("return",!1);case 3:return e.next=5,Y(a()(a()({},r),{},{uid:t.uid,orgUid:null==v?void 0:v.uid}));case 5:if(200!==(n=e.sent).code){e.next=10;break}return x.yw.success(j("update.success","更新成功")),null===(i=w.current)||void 0===i||i.reload(),e.abrupt("return",!0);case 10:return x.yw.error(n.message||j("update.failed","更新失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"name",label:j("common.name","名称"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:j("common.description","描述")}),(0,F.jsx)(R.Z,{name:"type",label:j("team.task.field.type","类型")})]},"edit")]:[]),h()(J?[(0,F.jsx)(D.Z,{title:j("team.task.todo.delete.confirm","确认删除该任务？"),onConfirm:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J){e.next=3;break}return X("team.task.todo.permission.denied.delete","无权限：删除待办任务"),e.abrupt("return");case 3:return e.next=5,G({uid:t.uid,orgUid:null==v?void 0:v.uid});case 5:200===(r=e.sent).code?(x.yw.success(j("delete.success","删除成功")),null===(n=w.current)||void 0===n||n.reload()):x.yw.error(r.message||j("delete.error","删除失败"));case 7:case"end":return e.stop()}}),e)}))),okText:y.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:y.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,F.jsx)(N.ZP,{size:"small",type:"link",danger:!0,children:j("delete","删除")})},"delete")]:[]))}}]:[])),ne=function(){var e=m()(p()().mark((function e(){var t;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E){e.next=3;break}return X("team.task.todo.permission.denied.export","无权限：导出待办任务"),e.abrupt("return");case 3:t=localStorage.getItem(k.LA8),window.open((0,T.kG)()+"/api/v1/task/export?"+new URLSearchParams({orgUid:(null==v?void 0:v.uid)||"",pageNumber:String(V-1),pageSize:String($),accessToken:t||""}).toString());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,F.jsx)(O.Z,{columns:re,cardBordered:!0,actionRef:w,rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0},scroll:{x:"max-content"},tableLayout:"fixed",toolBarRender:function(){return[].concat(h()(S?[(0,F.jsxs)(A.Y,{title:j("team.task.todo.create.title","新建任务"),trigger:(0,F.jsx)(N.ZP,{type:"primary",icon:(0,F.jsx)(C.Z,{}),children:j("common.new","新建")}),modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(t){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=3;break}return X("team.task.todo.permission.denied.create","无权限：创建待办任务"),e.abrupt("return",!1);case 3:return e.next=5,L(a()(a()({},t),{},{orgUid:null==v?void 0:v.uid}));case 5:if(200!==(r=e.sent).code){e.next=10;break}return x.yw.success(j("create.success","创建成功")),null===(n=w.current)||void 0===n||n.reload(),e.abrupt("return",!0);case 10:return x.yw.error(r.message||j("create.failed","创建失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"name",label:j("common.name","名称"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:j("common.description","描述")}),(0,F.jsx)(R.Z,{name:"type",label:j("team.task.field.type","类型")})]},"create")]:[]),h()(E?[(0,F.jsx)(N.ZP,{icon:(0,F.jsx)(I.Z,{}),onClick:ne,children:j("export","导出")},"export")]:[]))},request:function(){var e=m()(p()().mark((function e(t,r){var n,i,s,u,o,l;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=3;break}return X("team.task.todo.permission.denied.read","无权限：查看待办任务"),e.abrupt("return",{data:[],success:!0,total:0});case 3:return s=Object.keys(r||{})[0],u=s?r[s]:void 0,Q(t.current||1),ee(t.pageSize||10),delete(o=a()(a()({pageNumber:t.current?t.current-1:0,pageSize:t.pageSize,orgUid:null==v?void 0:v.uid},t),{},{sortBy:s,sortDirection:u})).current,e.next=11,B(o);case 11:return 200!==(l=e.sent).code&&x.yw.error(l.message),e.abrupt("return",{data:(null==l||null===(n=l.data)||void 0===n?void 0:n.content)||[],success:!0,total:(null==l||null===(i=l.data)||void 0===i?void 0:i.totalElements)||0});case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()})};function Q(e){return W.apply(this,arguments)}function W(){return(W=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/calendar/query/org",{method:"GET",params:a()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return $.apply(this,arguments)}function $(){return($=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/calendar/create",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/calendar/update",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e){return ne.apply(this,arguments)}function ne(){return(ne=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/calendar/delete",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ae=r(62304),ie=r(50628),se=function(){var e,t,r,n,i,u,o,l,d,f,v=(0,z.u)((function(e){return e.currentOrg})),y=(0,b.useIntl)(),g=(0,b.useAccess)(),w=(0,c.useRef)(),j=function(e,t){return y.formatMessage({id:e,defaultMessage:t})},Z=(0,c.useMemo)((function(){var e;return null==g||null===(e=g.getModulePermission)||void 0===e?void 0:e.call(g,M.MY.CALENDAR)}),[g]),P=null!==(e=null==Z||null===(t=Z.canRead)||void 0===t?void 0:t.call(Z))&&void 0!==e&&e,S=null!==(r=null==Z||null===(n=Z.canCreate)||void 0===n?void 0:n.call(Z))&&void 0!==r&&r,q=null!==(i=null==Z||null===(u=Z.canUpdate)||void 0===u?void 0:u.call(Z))&&void 0!==i&&i,J=null!==(o=null==Z||null===(l=Z.canDelete)||void 0===l?void 0:l.call(Z))&&void 0!==o&&o,B=null!==(d=null==Z||null===(f=Z.canExport)||void 0===f?void 0:f.call(Z))&&void 0!==d&&d,E=function(e,t){return x.yw.warning(j(e,t))},L=(0,c.useState)(1),X=s()(L,2),Y=X[0],_=X[1],G=(0,c.useState)(10),K=s()(G,2),V=K[0],W=K[1],$=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:j("common.name","名称"),dataIndex:"name",copyable:!0,width:180},{title:j("common.status","状态"),dataIndex:"status",width:120,ellipsis:!0},{title:j("team.task.calendar.field.startAt","开始时间"),dataIndex:"startAt",hideInSearch:!0,width:180},{title:j("team.task.calendar.field.endAt","结束时间"),dataIndex:"endAt",hideInSearch:!0,width:180},{title:j("team.task.calendar.field.location","地点"),dataIndex:"location",ellipsis:!0,width:200},{title:j("common.description","描述"),dataIndex:"description",ellipsis:!0,width:240},{title:j("team.task.uid","UID"),dataIndex:"uid",copyable:!0,hideInSearch:!0,width:200,ellipsis:!0},{title:j("createdAt","创建时间"),dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:j("updatedAt","更新时间"),dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180,fixed:"right"}],te=[].concat($,h()(q||J?[{title:j("actions","操作"),valueType:"option",key:"option",width:160,fixed:"right",render:function(e,t){return[].concat(h()(q?[(0,F.jsxs)(A.Y,{title:j("team.task.calendar.edit.title","编辑日程"),trigger:(0,F.jsx)(N.ZP,{size:"small",type:"link",children:j("edit","编辑")}),initialValues:t,modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(r){var n,i;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=3;break}return E("team.task.calendar.permission.denied.update","无权限：更新日程"),e.abrupt("return",!1);case 3:return e.next=5,ee(a()(a()({},r),{},{uid:t.uid,orgUid:null==v?void 0:v.uid}));case 5:if(200!==(n=e.sent).code){e.next=10;break}return x.yw.success(j("update.success","更新成功")),null===(i=w.current)||void 0===i||i.reload(),e.abrupt("return",!0);case 10:return x.yw.error(n.message||j("update.failed","更新失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"name",label:j("common.name","名称"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:j("common.description","描述")}),(0,F.jsx)(R.Z,{name:"type",label:j("team.task.field.type","类型")}),(0,F.jsx)(ae.Z,{name:"startAt",label:j("team.task.calendar.field.startAt","开始时间")}),(0,F.jsx)(ae.Z,{name:"endAt",label:j("team.task.calendar.field.endAt","结束时间")}),(0,F.jsx)(ie.Z,{name:"allDay",label:j("team.task.calendar.field.allDay","全天")}),(0,F.jsx)(R.Z,{name:"location",label:j("team.task.calendar.field.location","地点")}),(0,F.jsx)(R.Z,{name:"status",label:j("common.status","状态")})]},"edit")]:[]),h()(J?[(0,F.jsx)(D.Z,{title:j("team.task.calendar.delete.confirm","确认删除该日程？"),onConfirm:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J){e.next=3;break}return E("team.task.calendar.permission.denied.delete","无权限：删除日程"),e.abrupt("return");case 3:return e.next=5,re({uid:t.uid,orgUid:null==v?void 0:v.uid});case 5:200===(r=e.sent).code?(x.yw.success(j("delete.success","删除成功")),null===(n=w.current)||void 0===n||n.reload()):x.yw.error(r.message||j("delete.error","删除失败"));case 7:case"end":return e.stop()}}),e)}))),okText:y.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:y.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,F.jsx)(N.ZP,{size:"small",type:"link",danger:!0,children:j("delete","删除")})},"delete")]:[]))}}]:[])),ne=function(){var e=m()(p()().mark((function e(){var t;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=3;break}return E("team.task.calendar.permission.denied.export","无权限：导出日程"),e.abrupt("return");case 3:t=localStorage.getItem(k.LA8),window.open((0,T.kG)()+"/api/v1/calendar/export?"+new URLSearchParams({orgUid:(null==v?void 0:v.uid)||"",pageNumber:String(Y-1),pageSize:String(V),accessToken:t||""}).toString());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,F.jsx)(O.Z,{columns:te,cardBordered:!0,actionRef:w,rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0},scroll:{x:"max-content"},tableLayout:"fixed",toolBarRender:function(){return[].concat(h()(S?[(0,F.jsxs)(A.Y,{title:j("team.task.calendar.create.title","新建日程"),trigger:(0,F.jsx)(N.ZP,{type:"primary",icon:(0,F.jsx)(C.Z,{}),children:j("common.new","新建")}),modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(t){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=3;break}return E("team.task.calendar.permission.denied.create","无权限：创建日程"),e.abrupt("return",!1);case 3:return e.next=5,H(a()(a()({},t),{},{orgUid:null==v?void 0:v.uid}));case 5:if(200!==(r=e.sent).code){e.next=10;break}return x.yw.success(j("create.success","创建成功")),null===(n=w.current)||void 0===n||n.reload(),e.abrupt("return",!0);case 10:return x.yw.error(r.message||j("create.failed","创建失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"name",label:j("common.name","名称"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:j("common.description","描述")}),(0,F.jsx)(R.Z,{name:"type",label:j("team.task.field.type","类型")}),(0,F.jsx)(ae.Z,{name:"startAt",label:j("team.task.calendar.field.startAt","开始时间")}),(0,F.jsx)(ae.Z,{name:"endAt",label:j("team.task.calendar.field.endAt","结束时间")}),(0,F.jsx)(ie.Z,{name:"allDay",label:j("team.task.calendar.field.allDay","全天")}),(0,F.jsx)(R.Z,{name:"location",label:j("team.task.calendar.field.location","地点")}),(0,F.jsx)(R.Z,{name:"status",label:j("common.status","状态")})]},"create")]:[]),h()(B?[(0,F.jsx)(N.ZP,{icon:(0,F.jsx)(I.Z,{}),onClick:ne,children:j("export","导出")},"export")]:[]))},request:function(){var e=m()(p()().mark((function e(t,r){var n,i,s,u,o,l;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=3;break}return E("team.task.calendar.permission.denied.read","无权限：查看日程"),e.abrupt("return",{data:[],success:!0,total:0});case 3:return s=Object.keys(r||{})[0],u=s?r[s]:void 0,_(t.current||1),W(t.pageSize||10),delete(o=a()(a()({pageNumber:t.current?t.current-1:0,pageSize:t.pageSize,orgUid:null==v?void 0:v.uid},t),{},{sortBy:s,sortDirection:u})).current,e.next=11,Q(o);case 11:return 200!==(l=e.sent).code&&x.yw.error(l.message),e.abrupt("return",{data:(null==l||null===(n=l.data)||void 0===n?void 0:n.content)||[],success:!0,total:(null==l||null===(i=l.data)||void 0===i?void 0:i.totalElements)||0});case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()})};function ue(e){return oe.apply(this,arguments)}function oe(){return(oe=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/query/org",{method:"GET",params:a()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e){return ce.apply(this,arguments)}function ce(){return(ce=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/create",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return pe.apply(this,arguments)}function pe(){return(pe=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/update",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e){return me.apply(this,arguments)}function me(){return(me=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/delete",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){return he.apply(this,arguments)}function he(){return(he=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/startJob",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e){return ke.apply(this,arguments)}function ke(){return(ke=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/pauseJob",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return ye.apply(this,arguments)}function ye(){return(ye=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/resumeJob",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e){return we.apply(this,arguments)}function we(){return(we=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/api/v1/quartz_task/deleteJob",{method:"POST",data:a()(a()({},t),{},{channel:k.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=function(){var e,t,r,n,i,u,o,l,d,f,v=(0,z.u)((function(e){return e.currentOrg})),y=(0,c.useRef)(),g=(0,b.useAccess)(),w=(0,b.useIntl)(),j=function(e,t){return w.formatMessage({id:e,defaultMessage:t})},Z=(0,c.useMemo)((function(){var e;return null==g||null===(e=g.getModulePermission)||void 0===e?void 0:e.call(g,M.MY.QUARTZ_TASK)}),[g]),P=null!==(e=null==Z||null===(t=Z.canRead)||void 0===t?void 0:t.call(Z))&&void 0!==e&&e,S=null!==(r=null==Z||null===(n=Z.canCreate)||void 0===n?void 0:n.call(Z))&&void 0!==r&&r,q=null!==(i=null==Z||null===(u=Z.canUpdate)||void 0===u?void 0:u.call(Z))&&void 0!==i&&i,J=null!==(o=null==Z||null===(l=Z.canDelete)||void 0===l?void 0:l.call(Z))&&void 0!==o&&o,B=null!==(d=null==Z||null===(f=Z.canExport)||void 0===f?void 0:f.call(Z))&&void 0!==d&&d,E=function(e,t){return x.yw.warning(j(e,t))},L=(0,c.useState)(1),X=s()(L,2),Y=X[0],_=X[1],G=(0,c.useState)(10),K=s()(G,2),V=K[0],Q=K[1],W=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:j("team.task.quartz.field.jobName","任务名称"),dataIndex:"jobName",copyable:!0,width:180},{title:j("team.task.quartz.field.jobGroup","任务组"),dataIndex:"jobGroup",copyable:!0,width:160},{title:j("team.task.quartz.field.jobMethodName","方法"),dataIndex:"jobMethodName",ellipsis:!0,width:160},{title:"Cron",dataIndex:"cronExpression",copyable:!0,ellipsis:!0,width:200},{title:j("common.status","状态"),dataIndex:"triggerState",width:140},{title:j("updatedAt","更新时间"),dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180},{title:j("actions","操作"),valueType:"option",key:"option",width:360,fixed:"right",render:function(e,t){return[].concat(h()(q?[(0,F.jsxs)(A.Y,{title:j("team.task.quartz.edit.title","编辑定时任务"),trigger:(0,F.jsx)(N.ZP,{size:"small",type:"link",children:j("edit","编辑")}),initialValues:t,modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(r){var n,i;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=3;break}return E("team.task.quartz.permission.denied.update","无权限：更新定时任务"),e.abrupt("return",!1);case 3:return e.next=5,de(a()(a()({},r),{},{uid:t.uid,orgUid:null==v?void 0:v.uid}));case 5:if(200!==(n=e.sent).code){e.next=10;break}return x.yw.success(j("update.success","更新成功")),null===(i=y.current)||void 0===i||i.reload(),e.abrupt("return",!0);case 10:return x.yw.error(n.message||j("update.failed","更新失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"jobName",label:j("team.task.quartz.field.jobName","任务名称"),rules:[{required:!0}]}),(0,F.jsx)(R.Z,{name:"jobGroup",label:j("team.task.quartz.field.jobGroup","任务组"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:j("common.description","描述")}),(0,F.jsx)(R.Z,{name:"jobClassName",label:j("team.task.quartz.field.jobClassName","类名")}),(0,F.jsx)(R.Z,{name:"jobMethodName",label:j("team.task.quartz.field.jobMethodName","方法")}),(0,F.jsx)(R.Z,{name:"cronExpression",label:"Cron"}),(0,F.jsx)(ie.Z,{name:"durable",label:j("team.task.quartz.field.durable","Durable")}),(0,F.jsx)(ie.Z,{name:"nonconcurrent",label:j("team.task.quartz.field.nonconcurrent","Nonconcurrent")}),(0,F.jsx)(ie.Z,{name:"updateData",label:j("team.task.quartz.field.updateData","UpdateData")})]},"edit")]:[]),h()(q?[(0,F.jsx)(N.ZP,{size:"small",onClick:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=3;break}return E("team.task.quartz.permission.denied.update","无权限：更新定时任务"),e.abrupt("return");case 3:return e.next=5,ve(t);case 5:200===(r=e.sent).code?(x.yw.success(j("team.task.quartz.start.success","启动成功")),null===(n=y.current)||void 0===n||n.reload()):x.yw.error(r.message||j("team.task.quartz.start.failed","启动失败"));case 7:case"end":return e.stop()}}),e)}))),children:j("team.task.quartz.action.start","启动")},"start"),(0,F.jsx)(N.ZP,{size:"small",onClick:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=3;break}return E("team.task.quartz.permission.denied.update","无权限：更新定时任务"),e.abrupt("return");case 3:return e.next=5,xe(t);case 5:200===(r=e.sent).code?(x.yw.success(j("team.task.quartz.pause.success","暂停成功")),null===(n=y.current)||void 0===n||n.reload()):x.yw.error(r.message||j("team.task.quartz.pause.failed","暂停失败"));case 7:case"end":return e.stop()}}),e)}))),children:j("team.task.quartz.action.pause","停止")},"pause"),(0,F.jsx)(N.ZP,{size:"small",onClick:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=3;break}return E("team.task.quartz.permission.denied.update","无权限：更新定时任务"),e.abrupt("return");case 3:return e.next=5,be(t);case 5:200===(r=e.sent).code?(x.yw.success(j("team.task.quartz.resume.success","重启成功")),null===(n=y.current)||void 0===n||n.reload()):x.yw.error(r.message||j("team.task.quartz.resume.failed","重启失败"));case 7:case"end":return e.stop()}}),e)}))),children:j("team.task.quartz.action.resume","重启")},"resume")]:[]),h()(J?[(0,F.jsx)(D.Z,{title:j("team.task.quartz.delete.record.confirm","确认删除该定时任务记录？"),onConfirm:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J){e.next=3;break}return E("team.task.quartz.permission.denied.delete","无权限：删除定时任务"),e.abrupt("return");case 3:return e.next=5,fe({uid:t.uid,orgUid:null==v?void 0:v.uid});case 5:200===(r=e.sent).code?(x.yw.success(j("delete.success","删除成功")),null===(n=y.current)||void 0===n||n.reload()):x.yw.error(r.message||j("delete.error","删除失败"));case 7:case"end":return e.stop()}}),e)}))),okText:w.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:w.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,F.jsx)(N.ZP,{size:"small",type:"link",danger:!0,children:j("delete","删除")},"delete_record")},"delete"),(0,F.jsx)(N.ZP,{size:"small",danger:!0,onClick:m()(p()().mark((function e(){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J){e.next=3;break}return E("team.task.quartz.permission.denied.delete","无权限：删除定时任务"),e.abrupt("return");case 3:return e.next=5,ge(t);case 5:200===(r=e.sent).code?(x.yw.success(j("delete.success","删除成功")),null===(n=y.current)||void 0===n||n.reload()):x.yw.error(r.message||j("delete.error","删除失败"));case 7:case"end":return e.stop()}}),e)}))),children:j("team.task.quartz.action.removeSchedule","移除调度")},"delete_job")]:[]))}}],H=function(){var e=m()(p()().mark((function e(){var t;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=3;break}return E("team.task.quartz.permission.denied.export","无权限：导出定时任务"),e.abrupt("return");case 3:t=localStorage.getItem(k.LA8),window.open((0,T.kG)()+"/api/v1/quartz_task/export?"+new URLSearchParams({orgUid:(null==v?void 0:v.uid)||"",pageNumber:String(Y-1),pageSize:String(V),accessToken:t||""}).toString());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,F.jsx)(O.Z,{columns:W,actionRef:y,cardBordered:!0,rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0},scroll:{x:"max-content"},tableLayout:"fixed",toolBarRender:function(){return[].concat(h()(S?[(0,F.jsxs)(A.Y,{title:j("team.task.quartz.create.title","新建定时任务"),trigger:(0,F.jsx)(N.ZP,{type:"primary",icon:(0,F.jsx)(C.Z,{}),children:j("common.new","新建")}),modalProps:{destroyOnClose:!0},onFinish:function(){var e=m()(p()().mark((function e(t){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=3;break}return E("team.task.quartz.permission.denied.create","无权限：创建定时任务"),e.abrupt("return",!1);case 3:return e.next=5,le(a()(a()({},t),{},{orgUid:null==v?void 0:v.uid}));case 5:if(200!==(r=e.sent).code){e.next=10;break}return x.yw.success(j("create.success","创建成功")),null===(n=y.current)||void 0===n||n.reload(),e.abrupt("return",!0);case 10:return x.yw.error(r.message||j("create.failed","创建失败")),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[(0,F.jsx)(R.Z,{name:"jobName",label:j("team.task.quartz.field.jobName","任务名称"),rules:[{required:!0}]}),(0,F.jsx)(R.Z,{name:"jobGroup",label:j("team.task.quartz.field.jobGroup","任务组"),rules:[{required:!0}]}),(0,F.jsx)(U.Z,{name:"description",label:j("common.description","描述")}),(0,F.jsx)(R.Z,{name:"jobClassName",label:j("team.task.quartz.field.jobClassName","类名")}),(0,F.jsx)(R.Z,{name:"jobMethodName",label:j("team.task.quartz.field.jobMethodName","方法")}),(0,F.jsx)(R.Z,{name:"cronExpression",label:"Cron"}),(0,F.jsx)(ie.Z,{name:"durable",label:j("team.task.quartz.field.durable","Durable")}),(0,F.jsx)(ie.Z,{name:"nonconcurrent",label:j("team.task.quartz.field.nonconcurrent","Nonconcurrent")}),(0,F.jsx)(ie.Z,{name:"updateData",label:j("team.task.quartz.field.updateData","UpdateData")})]},"create")]:[]),h()(B?[(0,F.jsx)(N.ZP,{icon:(0,F.jsx)(I.Z,{}),onClick:H,children:j("export","导出")},"export")]:[]))},request:function(){var e=m()(p()().mark((function e(t,r){var n,i,s,u,o,l;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=3;break}return E("team.task.quartz.permission.denied.read","无权限：查看定时任务"),e.abrupt("return",{data:[],success:!0,total:0});case 3:return s=Object.keys(r||{})[0],u=s?r[s]:void 0,_(t.current||1),Q(t.pageSize||10),delete(o=a()(a()({pageNumber:t.current?t.current-1:0,pageSize:t.pageSize,orgUid:null==v?void 0:v.uid},t),{},{sortBy:s,sortDirection:u})).current,e.next=11,ue(o);case 11:return 200!==(l=e.sent).code&&x.yw.error(l.message),e.abrupt("return",{data:(null==l||null===(n=l.data)||void 0===n?void 0:n.content)||[],success:!0,total:(null==l||null===(i=l.data)||void 0===i?void 0:i.totalElements)||0});case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()})},Ze=function(){var e,t,r,n,i,d,p,f,m,v=(0,u.Z)().contentStyle,h=(0,b.useAccess)(),x=(0,b.useIntl)(),k=function(e,t){return x.formatMessage({id:e,defaultMessage:t})},y=(0,c.useMemo)((function(){var e;return null==h||null===(e=h.getModulePermission)||void 0===e?void 0:e.call(h,M.MY.CALENDAR)}),[h]),g=(0,c.useMemo)((function(){var e;return null==h||null===(e=h.getModulePermission)||void 0===e?void 0:e.call(h,M.MY.TASK_LIST)}),[h]),w=(0,c.useMemo)((function(){var e;return null==h||null===(e=h.getModulePermission)||void 0===e?void 0:e.call(h,M.MY.TASK)}),[h]),j=(0,c.useMemo)((function(){var e;return null==h||null===(e=h.getModulePermission)||void 0===e?void 0:e.call(h,M.MY.QUARTZ_TASK)}),[h]),Z=null!==(e=null==y||null===(t=y.canRead)||void 0===t?void 0:t.call(y))&&void 0!==e&&e,P=null!==(r=null==g||null===(n=g.canRead)||void 0===n?void 0:n.call(g))&&void 0!==r&&r,S=null!==(i=null==w||null===(d=w.canRead)||void 0===d?void 0:d.call(w))&&void 0!==i&&i,q=null!==(p=null==j||null===(f=j.canRead)||void 0===f?void 0:f.call(j))&&void 0!==p&&p,z=(0,c.useMemo)((function(){var e=[];return Z&&e.push({key:"calendar",label:k("team.task.tab.calendar","日程安排"),children:(0,F.jsx)(se,{})}),P&&e.push({key:"list",label:k("team.task.tab.list","待办清单"),children:(0,F.jsx)(J,{})}),S&&e.push({key:"todo",label:k("team.task.tab.todo","待办任务"),children:(0,F.jsx)(V,{})}),q&&e.push({key:"quartz",label:k("team.task.tab.quartz","定时任务"),children:(0,F.jsx)(je,{})}),e}),[Z,P,S,q,k]),T=(0,c.useState)(),C=s()(T,2),I=C[0],A=C[1];return(0,c.useEffect)((function(){var e,t=null==z||null===(e=z[0])||void 0===e?void 0:e.key;t&&(I&&z.some((function(e){return e.key===I}))||A(t))}),[z,I]),z.length?(0,F.jsx)("div",{style:a()(a()({},v),{},{height:"100%"}),children:(0,F.jsx)(l.Z,{items:z,activeKey:null!=I?I:null==z||null===(m=z[0])||void 0===m?void 0:m.key,onChange:function(e){return A(e)}})}):(0,F.jsx)("div",{style:a()(a()({},v),{},{height:"100%",padding:12}),children:(0,F.jsx)(o.ZP,{status:"403",title:k("team.task.noAccess.title","无权限访问"),subTitle:k("team.task.noAccess.subtitle","请联系管理员开通任务/清单/日程/定时任务权限。")})})}}}]);