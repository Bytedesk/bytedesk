"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[7646],{93689:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(83910),r=a(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},u=a(54183),i=function(e,t){return r.createElement(u.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var s=r.forwardRef(i)},40439:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(83910),r=a(44194),o={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},u=a(54183),i=function(e,t){return r.createElement(u.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var s=r.forwardRef(i)},2484:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(83910),r=a(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},u=a(54183),i=function(e,t){return r.createElement(u.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var s=r.forwardRef(i)},59005:function(e,t,a){var n=a(94433),r=a(38956),o=a(57343),u=a(44194),i=a(45441),s=a(9953),l=a(31549),d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var a=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,h=e.request,v=e.showSearch,b=e.options,y=(0,r.Z)(e,d),k=(0,u.useContext)(i.Z);return(0,l.jsx)(s.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,o.h)(g),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:b,mode:m,showSearch:v,getPopupContainer:k.getPopupContainer},a),ref:t,proFieldProps:f},y),{},{children:c}))},f=u.forwardRef((function(e,t){var a=e.fieldProps,d=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,h=e.request,v=e.options,b=(0,r.Z)(e,c),y=(0,n.Z)({options:v,mode:m||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},a),k=(0,u.useContext)(i.Z);return(0,l.jsx)(s.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,o.h)(g),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:k.getPopupContainer},y),ref:t,proFieldProps:f},b),{},{children:d}))})),m=u.forwardRef(p);m.SearchSelect=f,m.displayName="ProFormComponent",t.Z=m},50628:function(e,t,a){var n=a(94433),r=a(38956),o=a(44194),u=a(9953),i=a(31549),s=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],l=o.forwardRef((function(e,t){var a=e.fieldProps,o=e.unCheckedChildren,l=e.checkedChildren,d=e.proFieldProps,c=(0,r.Z)(e,s);return(0,i.jsx)(u.Z,(0,n.Z)({valueType:"switch",fieldProps:(0,n.Z)({unCheckedChildren:o,checkedChildren:l},a),ref:t,valuePropName:"checked",proFieldProps:d,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},c))}));t.Z=l},86702:function(e,t,a){var n=a(32906),r=a(94433),o=a(38956),u=a(81424),i=a(69705),s=a(65641),l=a(34573),d=a(44194),c=a(9953),p=a(31549),f=["fieldProps","proFieldProps"],m=["fieldProps","proFieldProps"],g="text",h=function(e){var t=(0,u.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),a=(0,n.Z)(t,2),o=a[0],l=a[1];return(0,p.jsx)(i.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var a,n=t.getFieldValue(e.name||[]);return(0,p.jsx)(s.Z,(0,r.Z)((0,r.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return l(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(a=e.statusRender)||void 0===a?void 0:a.call(e,n),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:o,children:e.children}))}})},v=function(e){var t=e.fieldProps,a=e.proFieldProps,n=(0,o.Z)(e,f);return(0,p.jsx)(c.Z,(0,r.Z)({valueType:g,fieldProps:t,filedConfig:{valueType:g},proFieldProps:a},n))};v.Password=function(e){var t=e.fieldProps,a=e.proFieldProps,u=(0,o.Z)(e,m),i=(0,d.useState)(!1),s=(0,n.Z)(i,2),f=s[0],v=s[1];return null!=t&&t.statusRender&&u.name?(0,p.jsx)(h,{name:u.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:v,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,r.Z)({valueType:"password",fieldProps:(0,r.Z)((0,r.Z)({},(0,l.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var a;null==t||null===(a=t.onBlur)||void 0===a||a.call(t,e),v(!1)},onClick:function(e){var a;null==t||null===(a=t.onClick)||void 0===a||a.call(t,e),v(!0)}}),proFieldProps:a,filedConfig:{valueType:g}},u))})}):(0,p.jsx)(c.Z,(0,r.Z)({valueType:"password",fieldProps:t,proFieldProps:a,filedConfig:{valueType:g}},u))},v.displayName="ProFormComponent",t.Z=v},60241:function(e,t,a){var n=a(94433),r=a(38956),o=a(44194),u=a(9953),i=a(31549),s=["fieldProps","proFieldProps"],l=function(e,t){var a=e.fieldProps,o=e.proFieldProps,l=(0,r.Z)(e,s);return(0,i.jsx)(u.Z,(0,n.Z)({ref:t,valueType:"textarea",fieldProps:a,proFieldProps:o},l))};t.Z=o.forwardRef(l)},84553:function(e,t,a){a.d(t,{Bv:function(){return Z},L0:function(){return j},QB:function(){return q},RF:function(){return x},YO:function(){return F},YQ:function(){return U},Yg:function(){return v},kh:function(){return f},kv:function(){return y},pf:function(){return c},y:function(){return g}});var n=a(90819),r=a.n(n),o=a(73193),u=a.n(o),i=a(89933),s=a.n(i),l=a(94976),d=a(4628);function c(e){return p.apply(this,arguments)}function p(){return(p=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/query/org",{method:"GET",params:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/create",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return(h=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/update",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/delete",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/enable",{method:"POST",data:{uid:t.uid,enabled:t.enabled,channel:l.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return M.apply(this,arguments)}function M(){return(M=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/deleteAll",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return w.apply(this,arguments)}function w(){return(w=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateIndex",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return P.apply(this,arguments)}function P(){return(P=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateVectorIndex",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return S.apply(this,arguments)}function S(){return(S=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateAllIndex",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return C.apply(this,arguments)}function C(){return(C=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/faq/updateAllVectorIndex",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return O.apply(this,arguments)}function O(){return(O=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/robot/agent/text/faq-similar-questions",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},13845:function(e,t,a){a.d(t,{AP:function(){return c},_J:function(){return v},t5:function(){return g},v_:function(){return f}});var n=a(90819),r=a.n(n),o=a(73193),u=a.n(o),i=a(89933),s=a.n(i),l=a(94976),d=a(4628);function c(e){return p.apply(this,arguments)}function p(){return(p=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/query/org",{method:"GET",params:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/create",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return(h=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/update",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=s()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/kbase/delete",{method:"POST",data:u()(u()({},t),{},{channel:l.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},18299:function(e,t,a){a.d(t,{Ck:function(){return v},dv:function(){return q},pw:function(){return y},qL:function(){return f},z4:function(){return g}});var n=a(90819),r=a.n(n),o=a(89933),u=a.n(o),i=a(73193),s=a.n(i),l=a(94976),d=a(4628),c="/api/v1/quickbutton";function p(e){var t;return s()(s()({},e),{},{channel:null!==(t=null==e?void 0:e.channel)&&void 0!==t?t:l.XtJ})}function f(e){return m.apply(this,arguments)}function m(){return(m=u()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/query/org"),{method:"GET",params:p(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return(h=u()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/create"),{method:"POST",data:p(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=u()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/update"),{method:"POST",data:p(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=u()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/delete"),{method:"POST",data:p(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return M.apply(this,arguments)}function M(){return(M=u()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("".concat(c,"/enable"),{method:"POST",data:p(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},21850:function(e,t,a){var n=a(25553);t.Z=function(){var e=(0,n.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},74001:function(e,t,a){a.r(t),a.d(t,{default:function(){return pe}});var n=a(76711),r=a.n(n),o=a(21850),u=a(44194),i=a(6853),s=a(21600),l=a(4628),d=a(84176),c=a.n(d),p=a(73193),f=a.n(p),m=a(86222),g=a.n(m),h=a(90819),v=a.n(h),b=a(89933),y=a.n(b),k=a(45332),q=a.n(k),M=a(43388),x=a(18299),w=a(88722),F=a(74171),P=a(44565),j=a(27729),S=a(30310),Z=a(92351),C=a(12461),U=a(69533),O=a(28508),E=a(93689),A=a(40439),T=a(54881),R=a(10162),Q=a(2484),D=a(94976),I="/api/v1/goods";function B(e){var t;return f()(f()({},e),{},{channel:null!==(t=null==e?void 0:e.channel)&&void 0!==t?t:D.XtJ})}function L(e){return z.apply(this,arguments)}function z(){return(z=y()(v()().mark((function e(t){return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(I,"/query/org"),{method:"GET",params:B(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N="/api/v1/order";function G(e){var t;return f()(f()({},e),{},{channel:null!==(t=null==e?void 0:e.channel)&&void 0!==t?t:D.XtJ})}function J(e){return V.apply(this,arguments)}function V(){return(V=y()(v()().mark((function e(t){return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(N,"/query/org"),{method:"GET",params:G(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X=a(84553),_=a(13845),H=a(99036),K=a(59005),Y=a(86702),W=a(60241),$=a(50628),ee=a(30857),te=a(31549),ae=["URL","FAQ","FORM","IMAGE","PHONE","EMAIL","ORDER","GOODS"],ne=["URL","FAQ"],re=ne[0]||"URL",oe=function(e){var t,a,n=e.open,o=e.isEdit,i=e.quickbutton,s=e.onClose,d=e.onSubmit,c=H.A.useForm(),p=q()(c,1)[0],f=(0,l.useIntl)(),m=(0,u.useState)(re),g=q()(m,2),h=g[0],b=g[1],k=(0,F.u)((function(e){return e.currentOrg})),x=(0,w.Z)().translateString,P=(0,u.useState)([]),j=q()(P,2),Z=j[0],C=j[1],O=(0,u.useState)([]),E=q()(O,2),A=E[0],T=E[1],R=(0,u.useState)([]),Q=q()(R,2),I=Q[0],B=Q[1],z=(0,u.useState)([]),N=q()(z,2),G=N[0],V=N[1],oe=(0,u.useState)(!1),ue=q()(oe,2),ie=ue[0],se=ue[1],le=(0,u.useState)(!1),de=q()(le,2),ce=de[0],pe=de[1],fe=(0,u.useState)(!1),me=q()(fe,2),ge=me[0],he=me[1],ve=(0,u.useState)(!1),be=q()(ve,2),ye=be[0],ke=be[1],qe=(0,u.useState)(),Me=q()(qe,2),xe=Me[0],we=Me[1],Fe=(0,u.useMemo)((function(){return ae.map((function(e){return{value:e,label:f.formatMessage({id:"quickbutton.type.".concat(e),defaultMessage:e}),disabled:!ne.includes(e)&&(null==i?void 0:i.type)!==e}}))}),[f,null==i?void 0:i.type]),Pe=(0,u.useCallback)((function(){var e,t,a,r,o,u,s,l,d,c,f,m,g,h,v,y,k,q;if(!n)return p.resetFields(),b(re),we(void 0),C([]),T([]),B([]),void V([]);var M=(null==i?void 0:i.type)||re;b(M);var x="FAQ"===M?null==i?void 0:i.kbUid:void 0;if(we(x),"FAQ"!==M)T([]);else{var w,F,P,j=null==i||null===(w=i.payload)||void 0===w?void 0:w.faqUid;if(j)T([{uid:j,question:null==i||null===(F=i.payload)||void 0===F?void 0:F.faqQuestion,answer:null==i||null===(P=i.payload)||void 0===P?void 0:P.faqAnswer}]);else T([])}p.setFieldsValue({title:null==i?void 0:i.title,subtitle:null==i?void 0:i.subtitle,description:null==i?void 0:i.description,icon:null==i?void 0:i.icon,color:null==i?void 0:i.color,badge:null==i?void 0:i.badge,code:null==i?void 0:i.code,imageUrl:null==i?void 0:i.imageUrl,content:null==i?void 0:i.content,type:M,orderIndex:null!==(e=null==i?void 0:i.orderIndex)&&void 0!==e?e:0,highlight:null!==(t=null==i?void 0:i.highlight)&&void 0!==t&&t,enabled:null===(a=null==i?void 0:i.enabled)||void 0===a||a,kbUid:x,payloadFaqUid:null==i||null===(r=i.payload)||void 0===r?void 0:r.faqUid,payloadFaqQuestion:null==i||null===(o=i.payload)||void 0===o?void 0:o.faqQuestion,payloadFaqAnswer:null==i||null===(u=i.payload)||void 0===u?void 0:u.faqAnswer,payloadUrl:null==i||null===(s=i.payload)||void 0===s?void 0:s.url,payloadUrlTarget:null!==(l=null==i||null===(d=i.payload)||void 0===d?void 0:d.urlTarget)&&void 0!==l?l:"_blank",payloadFormSchema:null==i||null===(c=i.payload)||void 0===c?void 0:c.formSchema,payloadImageUrl:null==i||null===(f=i.payload)||void 0===f?void 0:f.imageUrl,payloadPhoneNumber:null==i||null===(m=i.payload)||void 0===m?void 0:m.phoneNumber,payloadEmailAddress:null==i||null===(g=i.payload)||void 0===g?void 0:g.emailAddress,payloadEmailSubject:null==i||null===(h=i.payload)||void 0===h?void 0:h.emailSubject,payloadEmailBody:null==i||null===(v=i.payload)||void 0===v?void 0:v.emailBody,payloadCustomCode:null==i||null===(y=i.payload)||void 0===y?void 0:y.customCode,payloadGoodsUid:null==i||null===(k=i.payload)||void 0===k?void 0:k.goodsUid,payloadOrderUid:null==i||null===(q=i.payload)||void 0===q?void 0:q.orderUid})}),[p,n,i]);(0,u.useEffect)((function(){Pe()}),[Pe]);var je=(0,u.useCallback)(y()(v()().mark((function e(){var t,a,n,o;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=k&&k.uid){e.next=3;break}return C([]),e.abrupt("return");case 3:return se(!0),e.prev=4,e.next=7,(0,_.AP)({pageNumber:0,pageSize:100,orgUid:k.uid,type:D.QPQ});case 7:200===(t=e.sent).code?(n=r()((null==t||null===(a=t.data)||void 0===a?void 0:a.content)||[]),(o=p.getFieldValue("kbUid"))&&!n.some((function(e){return(null==e?void 0:e.uid)===o}))&&n.push({uid:o,name:f.formatMessage({id:"quickbutton.kbase.missingOption",defaultMessage:"已删除知识库 ({uid})"},{uid:o})}),C(n)):M.yw.error(t.message||f.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("QuickButtonDrawer.loadKbases",e.t0),M.yw.error(f.formatMessage({id:"quickbutton.kbase.loadError",defaultMessage:"知识库加载失败"}));case 15:return e.prev=15,se(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,11,15,18]])}))),[null==k?void 0:k.uid,p,f]),Se=(0,u.useCallback)(function(){var e=y()(v()().mark((function e(t){var a,n,r,o,u,s;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&null!=k&&k.uid){e.next=3;break}return T([]),e.abrupt("return");case 3:return pe(!0),e.prev=4,e.next=7,(0,X.pf)({pageNumber:0,pageSize:200,orgUid:k.uid,kbUid:t});case 7:200===(a=e.sent).code?(r=((null==a||null===(n=a.data)||void 0===n?void 0:n.content)||[]).filter((function(e){return Boolean(null==e?void 0:e.uid)})).map((function(e){return{uid:e.uid,question:e.question,answer:e.answer}})),(o=p.getFieldValue("payloadFaqUid"))&&!r.some((function(e){return e.uid===o}))&&r.push({uid:o,question:(null==i||null===(u=i.payload)||void 0===u?void 0:u.faqQuestion)||f.formatMessage({id:"quickbutton.faq.missingOption",defaultMessage:"已删除常见问题 ({uid})"},{uid:o}),answer:null==i||null===(s=i.payload)||void 0===s?void 0:s.faqAnswer}),T(r)):M.yw.error(a.message||f.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("QuickButtonDrawer.loadFaqs",e.t0),M.yw.error(f.formatMessage({id:"quickbutton.faq.loadError",defaultMessage:"常见问题加载失败"}));case 15:return e.prev=15,pe(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,11,15,18]])})));return function(t){return e.apply(this,arguments)}}(),[null==k?void 0:k.uid,p,f,null==i||null===(t=i.payload)||void 0===t?void 0:t.faqAnswer,null==i||null===(a=i.payload)||void 0===a?void 0:a.faqQuestion]);(0,u.useEffect)((function(){n&&"FAQ"===h&&je()}),[je,n,h]);var Ze=(0,u.useCallback)(y()(v()().mark((function e(){var t,a,n,o;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=k&&k.uid){e.next=3;break}return B([]),e.abrupt("return");case 3:return he(!0),e.prev=4,e.next=7,L({pageNumber:0,pageSize:200,orgUid:k.uid});case 7:200===(t=e.sent).code?(n=r()((null==t||null===(a=t.data)||void 0===a?void 0:a.content)||[]),(o=p.getFieldValue("payloadGoodsUid"))&&!n.some((function(e){return(null==e?void 0:e.uid)===o}))&&n.push({uid:o,title:f.formatMessage({id:"quickbutton.goods.missingOption",defaultMessage:"已删除商品 ({uid})"},{uid:o})}),B(n.map((function(e){return{uid:e.uid,title:e.title}})))):M.yw.error(t.message||f.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("QuickButtonDrawer.loadGoods",e.t0),M.yw.error(f.formatMessage({id:"quickbutton.goods.loadError",defaultMessage:"商品加载失败"}));case 15:return e.prev=15,he(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,11,15,18]])}))),[null==k?void 0:k.uid,p,f]),Ce=(0,u.useCallback)(y()(v()().mark((function e(){var t,a,n,o;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=k&&k.uid){e.next=3;break}return V([]),e.abrupt("return");case 3:return ke(!0),e.prev=4,e.next=7,J({pageNumber:0,pageSize:200,orgUid:k.uid});case 7:200===(t=e.sent).code?(n=r()((null==t||null===(a=t.data)||void 0===a?void 0:a.content)||[]),(o=p.getFieldValue("payloadOrderUid"))&&!n.some((function(e){return(null==e?void 0:e.uid)===o}))&&n.push({uid:o,title:f.formatMessage({id:"quickbutton.order.missingOption",defaultMessage:"已删除订单 ({uid})"},{uid:o})}),V(n.map((function(e){return{uid:e.uid,title:e.title}})))):M.yw.error(t.message||f.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("QuickButtonDrawer.loadOrders",e.t0),M.yw.error(f.formatMessage({id:"quickbutton.order.loadError",defaultMessage:"订单加载失败"}));case 15:return e.prev=15,ke(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,11,15,18]])}))),[null==k?void 0:k.uid,p,f]);(0,u.useEffect)((function(){n&&"FAQ"===h&&(xe?Se(xe):T([]))}),[Se,n,xe,h]);return(0,te.jsx)(ee.Z,{title:o?f.formatMessage({id:"quickbutton.drawer.title.edit",defaultMessage:"Edit Quick Button"}):f.formatMessage({id:"quickbutton.drawer.title.create",defaultMessage:"Create Quick Button"}),width:720,open:n,onClose:s,destroyOnClose:!0,extra:(0,te.jsxs)(S.Z,{children:[(0,te.jsx)(U.ZP,{onClick:s,children:(0,te.jsx)(te.Fragment,{children:f.formatMessage({id:"pages.common.cancel",defaultMessage:"Cancel"})})}),(0,te.jsx)(U.ZP,{type:"primary",onClick:function(){p.validateFields().then((function(e){var t,a,n,r,o,u,s=(e.title||"").trim();if(s){var l,c=e.payloadFaqUid&&"FAQ"===h?A.find((function(t){return t.uid===e.payloadFaqUid}))||((null==i||null===(t=i.payload)||void 0===t?void 0:t.faqUid)===e.payloadFaqUid?{question:null==i||null===(a=i.payload)||void 0===a?void 0:a.faqQuestion,answer:null==i||null===(n=i.payload)||void 0===n?void 0:n.faqAnswer}:void 0):void 0;switch(h){case"FAQ":l={faqUid:e.payloadFaqUid,faqQuestion:null==c?void 0:c.question,faqAnswer:null==c?void 0:c.answer};break;case"URL":l={url:e.payloadUrl,urlTarget:e.payloadUrlTarget||"_blank"};break;case"FORM":l={formSchema:e.payloadFormSchema};break;case"IMAGE":l={imageUrl:e.payloadImageUrl};break;case"PHONE":l={phoneNumber:e.payloadPhoneNumber};break;case"EMAIL":l={emailAddress:e.payloadEmailAddress,emailSubject:e.payloadEmailSubject,emailBody:e.payloadEmailBody};break;case"GOODS":l={goodsUid:e.payloadGoodsUid};break;case"ORDER":l={orderUid:e.payloadOrderUid};break;default:l=void 0}var p=l?Object.entries(l).filter((function(e){var t=q()(e,2)[1];return null!=t&&""!==t})):[],m=p.length>0?Object.fromEntries(p):void 0;d({uid:null==i?void 0:i.uid,title:s,subtitle:e.subtitle,description:e.description,icon:e.icon,color:e.color,badge:e.badge,code:e.code,imageUrl:e.imageUrl,content:e.content,type:h,orderIndex:null!==(r=e.orderIndex)&&void 0!==r?r:0,highlight:null!==(o=e.highlight)&&void 0!==o&&o,enabled:null===(u=e.enabled)||void 0===u||u,kbUid:"FAQ"===h?e.kbUid:void 0,payload:m})}else M.yw.error(f.formatMessage({id:"quickbutton.title.required",defaultMessage:"Please enter a title"}))})).catch((function(){M.yw.error(f.formatMessage({id:"form.validation.error",defaultMessage:"Please check the form inputs."}))}))},children:(0,te.jsx)(te.Fragment,{children:f.formatMessage({id:"pages.common.save",defaultMessage:"Save"})})})]}),children:(0,te.jsxs)(H.A,{form:p,layout:"vertical",submitter:!1,children:[(0,te.jsx)(K.Z,{name:"type",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.type",defaultMessage:"Type"}),options:Fe,rules:[{required:!0,message:f.formatMessage({id:"quickbutton.type.required",defaultMessage:"Please choose a type"})}],fieldProps:{onChange:function(e){b(e),"FAQ"!==e&&(we(void 0),T([]),p.setFieldsValue({kbUid:void 0,payloadFaqUid:void 0,payloadFaqQuestion:void 0,payloadFaqAnswer:void 0})),"GOODS"!==e&&p.setFieldsValue({payloadGoodsUid:void 0}),"ORDER"!==e&&p.setFieldsValue({payloadOrderUid:void 0}),"URL"===e&&p.setFieldsValue({payloadUrl:void 0,payloadUrlTarget:"_blank"})}}}),(0,te.jsx)(Y.Z,{name:"title",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.title",defaultMessage:"Title"}),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.title.required",defaultMessage:"Please enter a title"})}]}),"FAQ"===h&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(K.Z,{name:"kbUid",label:(0,te.jsx)(l.FormattedMessage,{id:"faq.kbase.select",defaultMessage:"选择常见问题知识库"}),options:Z.filter((function(e){return Boolean(null==e?void 0:e.uid)})).map((function(e){return{label:x(e.name)||e.name||e.uid,value:e.uid}})),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.faq.kb.required",defaultMessage:"请选择知识库"})}],fieldProps:{showSearch:!0,allowClear:!0,loading:ie,optionFilterProp:"label",placeholder:f.formatMessage({id:"quickbutton.payload.faq.kb.placeholder",defaultMessage:"Select a knowledge base"}),onChange:function(e){we(e),p.setFieldsValue({kbUid:e,payloadFaqUid:void 0,payloadFaqQuestion:void 0,payloadFaqAnswer:void 0})},disabled:!(null!=k&&k.uid)}}),(0,te.jsx)(K.Z,{name:"payloadFaqUid",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.faq.uid",defaultMessage:"FAQ Identifier"}),options:A.map((function(e){return{label:x(e.question)||e.question||e.uid,value:e.uid}})),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.faq.uid.required",defaultMessage:"请选择常见问题"})}],fieldProps:{showSearch:!0,allowClear:!0,loading:ce,optionFilterProp:"label",placeholder:f.formatMessage({id:"quickbutton.payload.faq.uid.placeholder",defaultMessage:"Select FAQ"}),onChange:function(e){return function(e){if(e){var t=A.find((function(t){return t.uid===e}));p.setFieldsValue({payloadFaqUid:e,payloadFaqQuestion:null==t?void 0:t.question,payloadFaqAnswer:null==t?void 0:t.answer})}else p.setFieldsValue({payloadFaqUid:void 0,payloadFaqQuestion:void 0,payloadFaqAnswer:void 0})}(e)},disabled:!xe}})]}),"URL"===h&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Y.Z,{name:"payloadUrl",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.url",defaultMessage:"URL"}),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.url.required",defaultMessage:"Please input URL"})}]}),(0,te.jsx)(K.Z,{name:"payloadUrlTarget",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.urlTarget",defaultMessage:"Open link in"}),options:[{label:f.formatMessage({id:"quickbutton.payload.urlTarget.blank",defaultMessage:"New window"}),value:"_blank"}],fieldProps:{disabled:!0}})]}),"FORM"===h&&(0,te.jsx)(W.Z,{name:"payloadFormSchema",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.form",defaultMessage:"Form Schema"}),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.form.required",defaultMessage:"Please input schema"})}],fieldProps:{rows:3}}),"IMAGE"===h&&(0,te.jsx)(Y.Z,{name:"payloadImageUrl",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.image",defaultMessage:"Image URL"}),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.image.required",defaultMessage:"Please input image url"})}]}),"PHONE"===h&&(0,te.jsx)(Y.Z,{name:"payloadPhoneNumber",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.phone",defaultMessage:"Phone"}),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.phone.required",defaultMessage:"Please input phone"})}]}),"EMAIL"===h&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Y.Z,{name:"payloadEmailAddress",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.email",defaultMessage:"Email"}),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.email.required",defaultMessage:"Please input email"})}]}),(0,te.jsx)(Y.Z,{name:"payloadEmailSubject",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.email.subject",defaultMessage:"Email Subject"})}),(0,te.jsx)(W.Z,{name:"payloadEmailBody",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.email.body",defaultMessage:"Email Body"}),fieldProps:{rows:3}})]}),"GOODS"===h&&(0,te.jsx)(K.Z,{name:"payloadGoodsUid",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.goods.uid",defaultMessage:"选择商品"}),options:I.filter((function(e){return Boolean(null==e?void 0:e.uid)})).map((function(e){return{label:x(e.title)||e.title||e.uid,value:e.uid}})),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.goods.uid.required",defaultMessage:"请选择商品"})}],fieldProps:{showSearch:!0,allowClear:!0,loading:ge,optionFilterProp:"label",placeholder:f.formatMessage({id:"quickbutton.payload.goods.uid.placeholder",defaultMessage:"Select goods"}),disabled:!(null!=k&&k.uid),onDropdownVisibleChange:function(e){e&&Ze()}}}),"ORDER"===h&&(0,te.jsx)(K.Z,{name:"payloadOrderUid",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload.order.uid",defaultMessage:"选择订单"}),options:G.filter((function(e){return Boolean(null==e?void 0:e.uid)})).map((function(e){return{label:x(e.title)||e.title||e.uid,value:e.uid}})),rules:[{required:!0,message:f.formatMessage({id:"quickbutton.payload.order.uid.required",defaultMessage:"请选择订单"})}],fieldProps:{showSearch:!0,allowClear:!0,loading:ye,optionFilterProp:"label",placeholder:f.formatMessage({id:"quickbutton.payload.order.uid.placeholder",defaultMessage:"Select order"}),disabled:!(null!=k&&k.uid),onDropdownVisibleChange:function(e){e&&Ce()}}}),(0,te.jsx)($.Z,{name:"enabled",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.enabled",defaultMessage:"Enabled"})})]})})},ue=a(67242),ie=["current","pageSize"],se=["FAQ","URL","FORM","IMAGE","PHONE","EMAIL","ORDER","GOODS"],le=function(){var e=(0,l.useIntl)(),t=(0,u.useRef)(),a=(0,w.Z)().translateString,n=(0,F.u)((function(e){return e.currentOrg})),r=(0,u.useState)(!1),o=q()(r,2),i=o[0],s=o[1],d=(0,u.useState)(!1),p=q()(d,2),m=p[0],h=p[1],b=(0,u.useState)(),k=q()(b,2),D=k[0],I=k[1],B=(0,u.useState)([]),L=q()(B,2),z=L[0],N=L[1],G=(0,u.useState)([]),J=q()(G,2),V=J[0],X=J[1],_=(0,u.useMemo)((function(){return se.reduce((function(t,a){return t[a]={text:e.formatMessage({id:"quickbutton.type.".concat(a),defaultMessage:a})},t}),{})}),[e]),H=(0,u.useCallback)((function(){N([]),X([])}),[]),K=(0,u.useCallback)((function(){I(void 0),h(!1),s(!0)}),[]),Y=(0,u.useCallback)((function(e){I(e),h(!0),s(!0)}),[]),W=(0,u.useCallback)((function(n){var r;j.Z.confirm({title:e.formatMessage({id:"pages.common.deleteTip",defaultMessage:"Delete Confirmation"}),content:e.formatMessage({id:"pages.common.deleteConfirm"},{name:a(n.title)||n.uid}),okText:e.formatMessage({id:"pages.common.ok",defaultMessage:"OK"}),cancelText:e.formatMessage({id:"pages.common.cancel",defaultMessage:"Cancel"}),onOk:(r=y()(v()().mark((function a(){var r,o,u;return v()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=M.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),a.next=3,(0,x.pw)({uid:n.uid});case 3:o=a.sent,null==r||r(),200===o.code?(M.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete Success"})),H(),null===(u=t.current)||void 0===u||u.reloadAndRest()):M.yw.error(o.message||e.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}));case 6:case"end":return a.stop()}}),a)}))),function(){return r.apply(this,arguments)})})}),[e,H,a]),$=(0,u.useCallback)(function(){var a=y()(v()().mark((function a(n,r){var o,u;return v()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.dv)({uid:n.uid,enabled:r});case 2:200===(o=a.sent).code?(M.yw.success(r?e.formatMessage({id:"enable.success",defaultMessage:"Enabled"}):e.formatMessage({id:"disable.success",defaultMessage:"Disabled"})),null===(u=t.current)||void 0===u||u.reload()):M.yw.error(o.message||e.formatMessage({id:"request.failed",defaultMessage:"Request failed"}));case 4:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),[e]),ee=(0,u.useCallback)(function(){var a=y()(v()().mark((function a(n){var r,o,u,i,s,l;return v()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==V.length){a.next=2;break}return a.abrupt("return");case 2:o=M.yw.loading(n?e.formatMessage({id:"enabling",defaultMessage:"Enabling"}):e.formatMessage({id:"disabling",defaultMessage:"Disabling"})),u=0,i=g()(V),a.prev=5,i.s();case 7:if((s=i.n()).done){a.next=15;break}return l=s.value,a.next=11,(0,x.dv)({uid:l.uid,enabled:n});case 11:200===a.sent.code&&(u+=1);case 13:a.next=7;break;case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(5),i.e(a.t0);case 20:return a.prev=20,i.f(),a.finish(20);case 23:null==o||o(),M.yw.success(e.formatMessage({id:n?"quickbutton.batch.enable.result":"quickbutton.batch.disable.result",defaultMessage:n?"Enabled {success}/{total}":"Disabled {success}/{total}"},{success:u,total:V.length})),H(),null===(r=t.current)||void 0===r||r.reloadAndRest();case 27:case"end":return a.stop()}}),a,null,[[5,17,20,23]])})));return function(e){return a.apply(this,arguments)}}(),[e,H,V]),ae=(0,u.useCallback)((function(){var a;0!==V.length&&j.Z.confirm({title:e.formatMessage({id:"batch.deleteTip",defaultMessage:"Delete Selected"}),content:e.formatMessage({id:"batch.deleteAffirm"},{count:V.length}),okText:e.formatMessage({id:"pages.common.ok",defaultMessage:"OK"}),cancelText:e.formatMessage({id:"pages.common.cancel",defaultMessage:"Cancel"}),onOk:(a=y()(v()().mark((function a(){var n,r,o,u,i;return v()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=M.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting"})),o=g()(V),a.prev=2,o.s();case 4:if((u=o.n()).done){a.next=10;break}return i=u.value,a.next=8,(0,x.pw)({uid:i.uid});case 8:a.next=4;break;case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(2),o.e(a.t0);case 15:return a.prev=15,o.f(),a.finish(15);case 18:null==r||r(),H(),null===(n=t.current)||void 0===n||n.reloadAndRest();case 21:case"end":return a.stop()}}),a,null,[[2,12,15,18]])}))),function(){return a.apply(this,arguments)})})}),[e,V,H]),ne=(0,u.useCallback)(function(){var a=y()(v()().mark((function a(r){var o,u,i,l;return v()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(null!=n&&n.uid){a.next=3;break}return M.yw.error(e.formatMessage({id:"quickbutton.notice.needOrg",defaultMessage:"Please select an organization first."})),a.abrupt("return");case 3:if(o=f()(f()({},r),{},{orgUid:n.uid}),u=M.yw.loading(e.formatMessage({id:m?"updating":"creating"})),!m){a.next=11;break}return a.next=8,(0,x.Ck)(o);case 8:a.t0=a.sent,a.next=14;break;case 11:return a.next=13,(0,x.z4)(o);case 13:a.t0=a.sent;case 14:i=a.t0,null==u||u(),200===i.code?(M.yw.success(e.formatMessage({id:m?"update.success":"create.success"})),s(!1),null===(l=t.current)||void 0===l||l.reloadAndRest()):M.yw.error(i.message||e.formatMessage({id:"request.failed",defaultMessage:"Request failed"}));case 17:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[null==n?void 0:n.uid,e,m]),re=(0,u.useCallback)((function(t){var n=(t.type||"FAQ").toUpperCase(),r=t.payload||{};if("FAQ"===n){var o=a(r.faqQuestion)||r.faqQuestion||r.faqUid||"-",u=a(r.faqAnswer)||r.faqAnswer,i=(0,te.jsxs)(S.Z,{direction:"vertical",size:4,children:[(0,te.jsx)("span",{children:o}),u&&(0,te.jsx)("span",{style:{color:"#999"},children:u})]});return(0,te.jsx)(Z.Z,{title:i,styles:{body:{maxWidth:360}},placement:"topLeft",children:(0,te.jsx)("span",{children:o})})}return"URL"===n?(0,te.jsx)(S.Z,{direction:"vertical",size:4,children:r.url?(0,te.jsx)("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",children:r.url}):(0,te.jsx)("span",{children:"-"})}):"FORM"===n?(0,te.jsx)("span",{children:r.formSchema?e.formatMessage({id:"quickbutton.payload.form",defaultMessage:"Form schema"}):"-"}):"IMAGE"===n?(0,te.jsx)("span",{children:r.imageUrl||"-"}):"PHONE"===n?(0,te.jsx)("span",{children:r.phoneNumber||"-"}):"EMAIL"===n?(0,te.jsxs)(S.Z,{direction:"vertical",size:4,children:[(0,te.jsx)("span",{children:r.emailAddress||"-"}),r.emailSubject&&(0,te.jsx)("span",{style:{color:"#666"},children:r.emailSubject})]}):"GOODS"===n?(0,te.jsx)("span",{children:r.goodsUid||"-"}):"ORDER"===n?(0,te.jsx)("span",{children:r.orderUid||"-"}):(0,te.jsx)("span",{children:"-"})}),[e,a]),le=[{dataIndex:"index",valueType:"indexBorder"},{title:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.title",defaultMessage:"Title"}),dataIndex:"title",render:function(e,t){return a(t.title)||t.title||"-"},copyable:!0},{title:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.type",defaultMessage:"Type"}),dataIndex:"type",valueType:"select",valueEnum:_},{title:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.enabled",defaultMessage:"Enabled"}),dataIndex:"enabled",valueType:"select",search:!1,valueEnum:{true:{text:e.formatMessage({id:"quickreply.enabled.true",defaultMessage:"Enabled"}),status:"Success"},false:{text:e.formatMessage({id:"quickreply.enabled.false",defaultMessage:"Disabled"}),status:"Error"}},render:function(e,t){return(0,te.jsx)(C.Z,{size:"small",checked:t.enabled,onChange:function(e){return $(t,e)}})}},{title:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.payload",defaultMessage:"Payload"}),dataIndex:"payload",search:!1,render:function(e,t){return re(t)},width:240},{title:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.updatedAt",defaultMessage:"Updated"}),dataIndex:"updatedAt",valueType:"dateTime",sorter:!0,width:180,search:!1},{title:(0,te.jsx)(l.FormattedMessage,{id:"pages.common.actions",defaultMessage:"Actions"}),valueType:"option",fixed:"right",width:160,render:function(e,t){return(0,te.jsxs)(S.Z,{children:[(0,te.jsx)(U.ZP,{type:"link",size:"small",onClick:function(){return Y(t)},children:(0,te.jsx)(l.FormattedMessage,{id:"pages.common.edit",defaultMessage:"Edit"})}),(0,te.jsx)(U.ZP,{type:"link",danger:!0,size:"small",onClick:function(){return W(t)},children:(0,te.jsx)(l.FormattedMessage,{id:"pages.common.delete",defaultMessage:"Delete"})})]})}}],de={selectedRowKeys:z,onChange:function(e,t){N(e),X(t)}},ce=[{key:"batchEnable",icon:(0,te.jsx)(E.Z,{}),label:e.formatMessage({id:"quickbutton.action.batch.enable",defaultMessage:"Enable Selected"})+" (".concat(z.length,")"),onClick:function(){return ee(!0)}},{key:"batchDisable",icon:(0,te.jsx)(A.Z,{}),label:e.formatMessage({id:"quickbutton.action.batch.disable",defaultMessage:"Disable Selected"})+" (".concat(z.length,")"),onClick:function(){return ee(!1)}},{key:"batchDelete",icon:(0,te.jsx)(T.Z,{}),danger:!0,label:e.formatMessage({id:"quickbutton.action.batch.delete",defaultMessage:"Delete Selected"})+" (".concat(z.length,")"),onClick:ae}];return(0,u.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.reloadAndRest()}),[null==n?void 0:n.uid]),(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(P.Z,{columns:le,actionRef:t,rowKey:"uid",cardBordered:!0,rowSelection:de,search:{labelWidth:"auto"},request:function(){var t=y()(v()().mark((function t(a,r){var o,u,i,s,l,d,p,m,g,h,b;return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n&&n.uid){t.next=2;break}return t.abrupt("return",{data:[],success:!0,total:0});case 2:return i=a.current,s=void 0===i?1:i,l=a.pageSize,d=void 0===l?10:l,p=c()(a,ie),m=r?Object.keys(r)[0]:void 0,g=f()({pageNumber:s-1,pageSize:d,orgUid:n.uid},p),m&&(g.sortBy=m,g.sortDirection="ascend"===r[m]?"ascend":"descend"),t.next=8,(0,x.qL)(g);case 8:if(h=t.sent,ue.Z.debug("QuickButtonTable queryQuickbuttonsByOrg response:",null==h?void 0:h.data,g),200===h.code){t.next=13;break}return M.yw.error(h.message||e.formatMessage({id:"request.failed",defaultMessage:"Request failed"})),t.abrupt("return",{data:[],success:!1,total:0});case 13:return b=(null==h||null===(o=h.data)||void 0===o?void 0:o.content)||[],t.abrupt("return",{data:b,success:!0,total:(null==h||null===(u=h.data)||void 0===u?void 0:u.totalElements)||0});case 15:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),toolBarRender:function(){var e=[(0,te.jsx)(U.ZP,{type:"primary",icon:(0,te.jsx)(R.Z,{}),onClick:K,children:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.action.create",defaultMessage:"Create Quick Button"})},"create")];return z.length>0&&e.push((0,te.jsx)(O.Z,{menu:{items:ce},placement:"bottomRight",children:(0,te.jsx)(U.ZP,{icon:(0,te.jsx)(Q.Z,{}),children:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.action.batch",defaultMessage:"Batch Actions"})})},"batch")),e},headerTitle:e.formatMessage({id:"quickbutton.list",defaultMessage:"快捷按钮列表"}),tooltip:{title:e.formatMessage({id:"quickbutton.tooltip",defaultMessage:"Create buttons shown above the chat input toolbar."}),placement:"top"},dateFormatter:"string"}),i&&(0,te.jsx)(oe,{open:i,isEdit:m,quickbutton:D,onClose:function(){return s(!1)},onSubmit:ne})]})},de=a(85977),ce=i.Z.Content,pe=function(){var e,t,a,n,u,d,c,p,f=(0,o.Z)().contentStyle,m=(0,l.useAccess)(),g=null!==(e=null==m||null===(t=m.hasAnyModulePermission)||void 0===t?void 0:t.call(m,de.MY.QUICK_BUTTON))&&void 0!==e&&e,h=(a=null==m||null===(n=m.hasAnyModulePermission)||void 0===n?void 0:n.call(m,de.MY.ORDER),u=null==m||null===(d=m.hasAnyModulePermission)||void 0===d?void 0:d.call(m,de.MY.GOODS),[].concat(r()(g?[{key:"quickbuttons",label:(0,te.jsx)(l.FormattedMessage,{id:"quickbutton.tab.quickbuttons",defaultMessage:"QuickButton"}),children:(0,te.jsx)(le,{})}]:[]),r()([]),r()([])));if(0===h.length)return null;var v=String(null!==(c=null===(p=h[0])||void 0===p?void 0:p.key)&&void 0!==c?c:"quickbuttons");return(0,te.jsx)(i.Z,{children:(0,te.jsx)(ce,{style:f,children:(0,te.jsx)(s.Z,{defaultActiveKey:v,items:h})})})}}}]);