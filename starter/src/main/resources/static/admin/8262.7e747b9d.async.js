"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8262],{58262:function(e,t,a){a.d(t,{Z:function(){return ue}});var n=a(84176),r=a.n(n),s=a(76711),o=a.n(s),i=a(73193),l=a.n(i),d=a(86222),u=a.n(d),c=a(90819),f=a.n(c),g=a(89933),p=a.n(g),m=a(45332),h=a.n(m),b=a(50884),y=a(27353),x=a(2290);function v(e){return M.apply(this,arguments)}function M(){return(M=p()(f()().mark((function e(t){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/taboo/query/org",{method:"GET",params:l()(l()({},t),{},{channel:y.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=p()(f()().mark((function e(t){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/taboo/create",{method:"POST",data:l()(l()({},t),{},{channel:y.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return S.apply(this,arguments)}function S(){return(S=p()(f()().mark((function e(t){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/taboo/update",{method:"POST",data:l()(l()({},t),{},{channel:y.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return C.apply(this,arguments)}function C(){return(C=p()(f()().mark((function e(t){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/taboo/delete",{method:"POST",data:l()(l()({},t),{},{channel:y.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return F.apply(this,arguments)}function F(){return(F=p()(f()().mark((function e(t){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.request)("/api/v1/taboo/enable",{method:"POST",data:{uid:t.uid,enabled:t.enabled,channel:y.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=a(28520),E=a(6992),U=a(91768),I=a(16829),R=a(38722),B=a(17194),O=a(80503),P=a(77601),z=a(35746),A=a(38623),L=a(46206),q=a(90883),Y=a(70937),K=a(56668),H=a(44194),J=a(7603),N=a(21002),X=a(64967),V=a(97588),G=a(28869),W=a(83788),Q=a(19058),$=a(48518),_=a(31461),ee=a(31549),te=function(e){var t=e.isEdit,a=e.taboo,n=e.open,r=e.onClose,s=e.onSubmit,i=V.A.useForm(),d=h()(i,1)[0],c=(0,x.useIntl)(),f=(0,T.u)((function(e){return e.currentOrg})),g=(0,X.j)((function(e){return e.currentKbase})),p=(0,J.v)((function(e){return e.categorySelectOptions})),m=(0,J.v)((function(e){return e.categoryTreeOptions})),v=function e(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=u()(a);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.key!==y.zBg)return r.key;var s=e(r.children||[]);if(s)return s}}catch(e){n.e(e)}finally{n.f()}return""},M=(0,H.useState)([]),w=h()(M,2),k=w[0],j=w[1],S=(0,H.useState)(!1),Z=h()(S,2),C=Z[0],D=Z[1],F=(0,H.useState)(""),U=h()(F,2),I=U[0],R=U[1],B=(0,H.useRef)(null),O=(0,H.useState)([]),P=h()(O,2),z=P[0],Y=P[1],K=(0,H.useState)(!1),N=h()(K,2),te=N[0],ae=N[1],ne=(0,H.useState)(""),re=h()(ne,2),se=re[0],oe=re[1],ie=(0,H.useRef)(null);(0,H.useEffect)((function(){if(t)d.setFieldsValue({content:null==a?void 0:a.content,reply:null==a?void 0:a.reply,categoryUid:null==a?void 0:a.categoryUid,kbUid:null==g?void 0:g.uid}),j((null==a?void 0:a.synonymList)||[]),Y((null==a?void 0:a.tagList)||[]);else{var e=v(m||[])||(p.length>0?p[0].value:"");d.resetFields(),d.setFieldsValue({content:"",reply:"您的这个问题我不能回答，请提问其他问题。",categoryUid:e,kbUid:null==g?void 0:g.uid}),j([]),Y([])}}),[n,p,m]);(0,H.useEffect)((function(){var e,t;C&&(null===(e=B.current)||void 0===e||e.focus());te&&(null===(t=ie.current)||void 0===t||t.focus())}),[C,te]);var le=function(){I&&-1===k.indexOf(I)&&j([].concat(o()(k),[I])),D(!1),R("")},de=function(){se&&-1===z.indexOf(se)&&Y([].concat(o()(z),[se])),ae(!1),oe("")};return(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsx)(Q.Z,{title:t?"修改":"新建",onClose:r,open:n,width:500,extra:(0,ee.jsxs)(L.Z,{children:[(0,ee.jsx)(q.ZP,{onClick:r,children:"取消"}),(0,ee.jsx)(q.ZP,{onClick:function(){console.log("handleSubmit"),d.validateFields().then((function(e){console.log(e),s(l()(l()(l()({},a),e),{},{synonymList:k,tagList:z,kbUid:null==g?void 0:g.uid,orgUid:null==f?void 0:f.uid}))})).catch((function(e){console.log("Form errors:",e),b.yw.error("请检查表单填写")}))},type:"primary",children:"保存"})]}),children:(0,ee.jsxs)(V.A,{form:d,initialValues:l()({},a),submitter:{render:function(){return null}},children:[(0,ee.jsx)(G.Z,{label:"分类",name:"categoryUid",rules:[{required:!0,message:"请选择分类"}],fieldProps:{allowClear:!0,placeholder:"请选择分类",onChange:function(e){console.log("category selected ".concat(e))},treeData:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter((function(e){return e.key!==y.zBg})).map((function(t){return l()(l()({},t),{},{children:e(t.children)})}))}(m||[]),showSearch:!0,treeDefaultExpandAll:!1,fieldNames:{label:"title",value:"key",children:"children"}}}),(0,ee.jsx)(W.Z,{label:"内容",name:"content"}),(0,ee.jsx)(W.Z,{label:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.reply",defaultMessage:"回复内容"}),name:"reply",placeholder:c.formatMessage({id:"taboo.reply.placeholder",defaultMessage:"当用户输入包含敏感词的内容时，系统将返回此回复"}),rules:[{required:!0,message:c.formatMessage({id:"taboo.reply.required",defaultMessage:"请输入回复内容"})}]}),(0,ee.jsxs)("div",{style:{marginBottom:16},children:[(0,ee.jsxs)("div",{style:{marginBottom:8},children:[(0,ee.jsx)("label",{style:{marginRight:8},children:"同义词列表："}),(0,ee.jsx)($.Z,{title:"添加同义词，方便系统识别不同表达的相同意思",children:(0,ee.jsx)("span",{style:{color:"rgba(0, 0, 0, 0.45)",fontSize:12},children:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.synonym.tooltip",defaultMessage:"不同表达的相同意思"})})})]}),(0,ee.jsx)("div",{style:{marginBottom:8},children:k.map((function(e){return(0,ee.jsx)(A.Z,{closable:!0,onClose:function(){return t=e,a=k.filter((function(e){return e!==t})),void j(a);var t,a},style:{marginBottom:4},children:e},e)}))}),C?(0,ee.jsx)(_.Z,{ref:B,type:"text",size:"small",value:I,onChange:function(e){R(e.target.value)},onBlur:le,onPressEnter:le,style:{width:200}}):(0,ee.jsxs)(A.Z,{onClick:function(){D(!0)},style:{background:"#fff",borderStyle:"dashed"},children:[(0,ee.jsx)(E.Z,{})," ",(0,ee.jsx)(x.FormattedMessage,{id:"taboo.synonym.add",defaultMessage:"添加同义词"})]})]}),(0,ee.jsxs)("div",{style:{marginBottom:16},children:[(0,ee.jsxs)("div",{style:{marginBottom:8},children:[(0,ee.jsxs)("label",{style:{marginRight:8},children:[(0,ee.jsx)(x.FormattedMessage,{id:"taboo.tags",defaultMessage:"标签"}),"："]}),(0,ee.jsx)($.Z,{title:"添加标签，便于分类和搜索",children:(0,ee.jsx)("span",{style:{color:"rgba(0, 0, 0, 0.45)",fontSize:12},children:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.tags.tooltip",defaultMessage:"便于分类和搜索"})})})]}),(0,ee.jsx)("div",{style:{marginBottom:8},children:z.map((function(e){return(0,ee.jsx)(A.Z,{closable:!0,color:"green",onClose:function(){return t=e,a=z.filter((function(e){return e!==t})),void Y(a);var t,a},style:{marginBottom:4},children:e},e)}))}),te?(0,ee.jsx)(_.Z,{ref:ie,type:"text",size:"small",value:se,onChange:function(e){oe(e.target.value)},onBlur:de,onPressEnter:de,style:{width:200}}):(0,ee.jsxs)(A.Z,{onClick:function(){ae(!0)},style:{background:"#fff",borderStyle:"dashed"},children:[(0,ee.jsx)(E.Z,{})," ",(0,ee.jsx)(x.FormattedMessage,{id:"taboo.tags.add",defaultMessage:"添加标签"})]})]})]})})})},ae=a(54227),ne=a(61476),re=a(27403),se=a(96596),oe=a.n(se),ie=a(1670),le=a(27318),de=["current","pageSize"],ue=function(e){var t,a,n,s,i,d,c,g,m,M,k=e.level,S=e.superUser,C=(0,x.useIntl)(),F=(0,N.Z)().translateString,V=(0,x.useAccess)(),G=(0,H.useRef)(),W=(0,H.useState)(!0),Q=h()(W,2),$=Q[0],_=Q[1],se=(0,H.useState)(),ue=h()(se,2),ce=ue[0],fe=ue[1],ge=(0,H.useState)(!1),pe=h()(ge,2),me=pe[0],he=pe[1],be=(0,H.useState)(1),ye=h()(be,2),xe=ye[0],ve=ye[1],Me=(0,H.useState)(10),we=h()(Me,2),ke=we[0],je=we[1],Se=(0,T.u)((function(e){return e.currentOrg})),Ze=(0,X.j)((function(e){return e.currentKbase})),Ce=(0,J.v)((function(e){return e.currentCategory})),De=(0,J.v)((function(e){return e.categorySelectOptions})),Fe=(0,H.useState)(!1),Te=h()(Fe,2),Ee=Te[0],Ue=Te[1],Ie=(0,H.useState)([]),Re=h()(Ie,2),Be=Re[0],Oe=Re[1],Pe=(0,H.useState)([]),ze=h()(Pe,2),Ae=ze[0],Le=ze[1],qe=(0,H.useState)(0),Ye=h()(qe,2),Ke=Ye[0],He=Ye[1],Je=(0,H.useState)({}),Ne=h()(Je,2),Xe=Ne[0],Ve=Ne[1],Ge=z.Z.useModal(),We=h()(Ge,2),Qe=(We[0],We[1]),$e=(0,H.useMemo)((function(){var e;return null==V||null===(e=V.getModulePermission)||void 0===e?void 0:e.call(V,le.MY.TABOO)}),[V]),_e=(S||(t=null==$e||null===(a=$e.canRead)||void 0===a?void 0:a.call($e)),S||null!==(n=null==$e||null===(s=$e.canCreate)||void 0===s?void 0:s.call($e))&&void 0!==n&&n),et=S||null!==(i=null==$e||null===(d=$e.canUpdate)||void 0===d?void 0:d.call($e))&&void 0!==i&&i,tt=S||null!==(c=null==$e||null===(g=$e.canDelete)||void 0===g?void 0:g.call($e))&&void 0!==c&&c,at=S||null!==(m=null==$e||null===(M=$e.canExport)||void 0===M?void 0:M.call($e))&&void 0!==m&&m,nt=((0,H.useRef)(!1),function(e,t){b.yw.warning(C.formatMessage({id:e,defaultMessage:t}))}),rt=function(){var e=p()(f()().mark((function e(t){var a;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(tt){e.next=3;break}return nt("taboo.permission.delete.denied","无权限：删除敏感词"),e.abrupt("return");case 3:return console.log(t),e.next=6,Z(t);case 6:a=e.sent,console.log("delete response:",a),200===a.code?(null==G||G.current.reload(),b.yw.success(C.formatMessage({id:"delete.success",defaultMessage:"Delete Success"}))):b.yw.error(C.formatMessage({id:"delete.failed",defaultMessage:"Delete Error"}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),st=function(){var e=p()(f()().mark((function e(){var t,a,n,r,s,o;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(tt){e.next=3;break}return nt("taboo.permission.delete.denied","无权限：批量删除敏感词"),e.abrupt("return");case 3:if(0!==Ae.length){e.next=6;break}return b.yw.warning(C.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 6:b.yw.loading(C.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),a=0,n=0,r=u()(Ae),e.prev=10,r.s();case 12:if((s=r.n()).done){e.next=26;break}return o=s.value,e.prev=14,e.next=17,Z(o);case 17:200===e.sent.code?a++:n++,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(14),n++;case 24:e.next=12;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(10),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:b.yw.destroy(),0===n?b.yw.success(C.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:a})):b.yw.warning(C.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:a,fail:n})),Oe([]),Le([]),null===(t=G.current)||void 0===t||t.reloadAndRest();case 39:case"end":return e.stop()}}),e,null,[[10,28,31,34],[14,21]])})));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=p()(f()().mark((function e(t){var a,n,r,s,o,i;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(et){e.next=3;break}return nt("taboo.permission.update.denied","无权限：更新敏感词"),e.abrupt("return");case 3:if(0!==Ae.length){e.next=6;break}return b.yw.warning(C.formatMessage({id:"batch.noselection",defaultMessage:"Please select items to process"})),e.abrupt("return");case 6:b.yw.loading(t?C.formatMessage({id:"enabling",defaultMessage:"Enabling..."}):C.formatMessage({id:"disabling",defaultMessage:"Disabling..."})),n=0,r=0,s=u()(Ae),e.prev=10,s.s();case 12:if((o=s.n()).done){e.next=26;break}return i=o.value,e.prev=14,e.next=17,D({uid:i.uid,enabled:t});case 17:200===e.sent.code?n++:r++,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(14),r++;case 24:e.next=12;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(10),s.e(e.t1);case 31:return e.prev=31,s.f(),e.finish(31);case 34:b.yw.destroy(),0===r?b.yw.success(t?C.formatMessage({id:"batch.enable.success",defaultMessage:"Successfully enabled {count} items"},{count:n}):C.formatMessage({id:"batch.disable.success",defaultMessage:"Successfully disabled {count} items"},{count:n})):b.yw.warning(t?C.formatMessage({id:"batch.enable.partial",defaultMessage:"Enabled {success} items, failed to enable {fail} items"},{success:n,fail:r}):C.formatMessage({id:"batch.disable.partial",defaultMessage:"Disabled {success} items, failed to disable {fail} items"},{success:n,fail:r})),Oe([]),Le([]),null===(a=G.current)||void 0===a||a.reloadAndRest();case 39:case"end":return e.stop()}}),e,null,[[10,28,31,34],[14,21]])})));return function(t){return e.apply(this,arguments)}}(),it=function(e){for(var t=[],a=1e3,n=Math.ceil(e/a),r=function(){var n=s,r=s*a+1,o=Math.min((s+1)*a,e);t.push({key:"export-".concat(s),label:"".concat(r,"-").concat(o," (").concat(o-r+1,"条)"),onClick:function(){return lt("range",n,a)}})},s=0;s<n;s++)r();return t},lt=function(){var e=p()(f()().mark((function e(){var t,a,n,r,s,o=arguments;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:"current",a=o.length>1?o[1]:void 0,n=o.length>2?o[2]:void 0,at){e.next=6;break}return nt("taboo.permission.export.denied","无权限：导出敏感词"),e.abrupt("return");case 6:console.log("handleExportExcel",t,a,n),r=localStorage.getItem(y.LA8),s=l()({categoryUid:(null==Ce?void 0:Ce.uid)===y.zBg?"":null==Ce?void 0:Ce.uid,kbUid:null==Ze?void 0:Ze.uid,orgUid:(null==Se?void 0:Se.uid)||"",accessToken:r||"",exportType:t},Xe),"current"===t?(s.pageNumber=String(xe-1),s.pageSize=String(ke)):"all"===t?(s.pageNumber="0",s.pageSize="1000"):"range"===t&&void 0!==a&&void 0!==n&&(s.pageNumber=String(a),s.pageSize=String(n)),window.open((0,ne.kG)()+"/api/v1/taboo/export?"+new URLSearchParams(s).toString());case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),dt=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.content",defaultMessage:"Content"}),dataIndex:"content",copyable:!0,fixed:"left",ellipsis:!0,search:!0,tooltip:C.formatMessage({id:"taboo.content.tooltip",defaultMessage:"敏感词内容，被检测和过滤的关键词"}),render:function(e,t){return F(null==t?void 0:t.content)}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.synonym",defaultMessage:"Synonyms"}),dataIndex:"synonymList",width:200,ellipsis:!0,hideInSearch:!0,tooltip:C.formatMessage({id:"taboo.synonym.tooltip",defaultMessage:"同义词列表，与敏感词有相同含义的词语"}),render:function(e,t){return t.synonymList&&0!==t.synonymList.length?t.synonymList.map((function(e){return(0,ee.jsx)(A.Z,{color:"orange",children:e.trim()},e)})):"-"}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.reply",defaultMessage:"Reply"}),dataIndex:"reply",copyable:!0,ellipsis:!0,width:200,hideInSearch:!0,tooltip:C.formatMessage({id:"taboo.reply.tooltip",defaultMessage:"被触发时的回复内容"}),render:function(e,t){return F((null==t?void 0:t.reply)||"您的这个问题我不能回答，请提问其他问题。")}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.type",defaultMessage:"Type"}),dataIndex:"type",width:100,tooltip:C.formatMessage({id:"taboo.type.tooltip",defaultMessage:"敏感词类型，包括文本、图片、视频或文件"}),render:function(e,t){return(0,ie.OI)(t.type)},valueEnum:{text:{text:C.formatMessage({id:"taboo.type.text"})},image:{text:C.formatMessage({id:"taboo.type.image"})},video:{text:C.formatMessage({id:"taboo.type.video"})},file:{text:C.formatMessage({id:"taboo.type.file"})}}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.enabled",defaultMessage:"Status"}),dataIndex:"enabled",width:100,tooltip:C.formatMessage({id:"taboo.enabled.tooltip",defaultMessage:"敏感词是否启用"}),valueEnum:{true:{text:C.formatMessage({id:"common.enabled"}),status:"Success"},false:{text:C.formatMessage({id:"common.disabled"}),status:"Error"}}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.category",defaultMessage:"Category"}),dataIndex:"categoryUid",hideInSearch:!0,width:120,tooltip:C.formatMessage({id:"taboo.category.tooltip",defaultMessage:"敏感词所属分类"}),render:function(e,t){var a=De.find((function(e){return e.value===(null==t?void 0:t.categoryUid)}));return(0,ee.jsx)(A.Z,{color:"blue",children:(null==a?void 0:a.label)||"-"})},filters:De.map((function(e){return{text:e.label,value:e.value}})),filterMode:"tree"},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.tags",defaultMessage:"Tags"}),dataIndex:"tags",width:150,ellipsis:!0,hideInSearch:!0,tooltip:C.formatMessage({id:"taboo.tags.tooltip",defaultMessage:"敏感词标签，用于分组和筛选"}),render:function(e,t){var a;return null!=t&&t.tagList?null==t||null===(a=t.tagList)||void 0===a?void 0:a.map((function(e){return(0,ee.jsx)(A.Z,{color:"green",children:e.trim()},e)})):"-"}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.startDate",defaultMessage:"Start Date"}),dataIndex:"startDate",width:160,valueType:"dateTime",hideInSearch:!0,tooltip:C.formatMessage({id:"taboo.startDate.tooltip",defaultMessage:"敏感词生效的开始日期"}),render:function(e,t){return t.startDate?oe()(t.startDate).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.endDate",defaultMessage:"End Date"}),dataIndex:"endDate",width:160,valueType:"dateTime",hideInSearch:!0,tooltip:C.formatMessage({id:"taboo.endDate.tooltip",defaultMessage:"敏感词失效的结束日期"}),render:function(e,t){return t.endDate?oe()(t.endDate).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.updatedAt",defaultMessage:"Updated At"}),dataIndex:"updatedAt",width:160,valueType:"dateTime",sorter:!0,hideInSearch:!0,tooltip:C.formatMessage({id:"taboo.updatedAt.tooltip",defaultMessage:"敏感词最后更新时间"})},{title:(0,ee.jsx)(x.FormattedMessage,{id:"pages.common.actions",defaultMessage:"Actions"}),valueType:"option",fixed:"right",width:120,render:function(e,t){return(0,ee.jsxs)(L.Z,{children:[et&&(0,ee.jsx)(q.ZP,{type:"link",size:"small",onClick:function(){return ct(t)},children:(0,ee.jsx)(x.FormattedMessage,{id:"pages.common.edit",defaultMessage:"Edit"})}),tt&&(0,ee.jsx)(Y.Z,{title:(0,ee.jsx)(x.FormattedMessage,{id:"pages.common.deleteTip",defaultMessage:"Delete Confirmation"}),description:C.formatMessage({id:"pages.common.deleteConfirm"},{name:t.content}),onConfirm:function(){return rt(t)},okText:(0,ee.jsx)(x.FormattedMessage,{id:"pages.common.ok"}),cancelText:(0,ee.jsx)(x.FormattedMessage,{id:"pages.common.cancel"}),children:(0,ee.jsx)(q.ZP,{type:"link",danger:!0,size:"small",children:(0,ee.jsx)(x.FormattedMessage,{id:"pages.common.delete"})})})]})}}],ut=function(){_e?(fe(void 0),_(!1),he(!0)):nt("taboo.permission.create.denied","无权限：创建敏感词")},ct=function(e){et?(fe(e),_(!0),he(!0)):nt("taboo.permission.update.denied","无权限：更新敏感词")},ft=function(){var e=p()(f()().mark((function e(t){var a,n;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleSubmitDrawer",t),!$||et){e.next=4;break}return nt("taboo.permission.update.denied","无权限：更新敏感词"),e.abrupt("return");case 4:if($||_e){e.next=7;break}return nt("taboo.permission.create.denied","无权限：创建敏感词"),e.abrupt("return");case 7:if($?b.yw.loading(C.formatMessage({id:"updating"})):b.yw.loading(C.formatMessage({id:"creating"})),!$){e.next=14;break}return e.next=11,j(t);case 11:e.t0=e.sent,e.next=17;break;case 14:return e.next=16,w(t);case 16:e.t0=e.sent;case 17:a=e.t0,console.log("createTaboo response:",t,a),200===a.code?(b.yw.destroy(),b.yw.success(C.formatMessage({id:"create.success",defaultMessage:"create success"})),he(!1),null===(n=G.current)||void 0===n||n.reloadAndRest()):(b.yw.destroy(),b.yw.error(a.message));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gt=function(){var e=p()(f()().mark((function e(){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_e){e.next=3;break}return nt("taboo.permission.create.denied","无权限：导入敏感词"),e.abrupt("return");case 3:Ue(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pt=function(){var e=p()(f()().mark((function e(){return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,re.HK)(y.R8f,null==Se?void 0:Se.uid,null==Ze?void 0:Ze.uid,k,{showLoading:!0,loadingMessage:C.formatMessage({id:"loading"}),errorMessage:C.formatMessage({id:"fetch.categories.error",defaultMessage:"Failed to fetch categories"})});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),mt={selectedRowKeys:Be,onChange:function(e,t){Oe(e),Le(t)}},ht=function(){var e=[];!S&&_e&&e.push((0,ee.jsx)(q.ZP,{icon:(0,ee.jsx)(E.Z,{}),type:"primary",onClick:ut,children:(0,ee.jsx)(x.FormattedMessage,{id:"taboo.action.create",defaultMessage:"Create Taboo"})},"create"));var t=[],a=Be.length;a>0&&t.push({key:"batchDelete",icon:(0,ee.jsx)(U.Z,{}),danger:!0,label:C.formatMessage({id:"batch.delete"})+" (".concat(a,")"),onClick:function(){z.Z.confirm({title:C.formatMessage({id:"batch.deleteTip"}),content:"".concat(C.formatMessage({id:"batch.deleteAffirm"})," ").concat(a," ").concat(C.formatMessage({id:"items"}),"?"),onOk:st,okText:C.formatMessage({id:"ok"}),cancelText:C.formatMessage({id:"cancel"})})}},{key:"batchEnable",icon:(0,ee.jsx)(I.Z,{}),label:C.formatMessage({id:"batch.enable"})+" (".concat(a,")"),onClick:function(){return ot(!0)}},{key:"batchDisable",icon:(0,ee.jsx)(R.Z,{}),label:C.formatMessage({id:"batch.disable"})+" (".concat(a,")"),onClick:function(){return ot(!1)}});var n,r=[{key:"import",icon:(0,ee.jsx)(B.Z,{}),label:C.formatMessage({id:"taboo.action.import",defaultMessage:"导入敏感词"}),onClick:gt}].concat(o()((n=[{key:"export-current",label:C.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return lt("current")}}],Ke>0&&(Ke<=1e3?n.push({key:"export-all",label:C.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(Ke,"条)"),onClick:function(){return lt("all")}}):n.push({key:"export-range",label:C.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(Ke,"条)"),children:it(Ke)})),n.push({key:"download",label:C.formatMessage({id:"download.template",defaultMessage:"下载模板"}),onClick:function(){return(0,ne.R1)()}}),n)));return e.push((0,ee.jsx)(K.Z,{menu:{items:r},placement:"bottomRight",children:(0,ee.jsxs)(q.ZP,{type:"primary",children:[(0,ee.jsx)(x.FormattedMessage,{id:"import.export",defaultMessage:"导入导出"}),(0,ee.jsx)(O.Z,{})]})},"importExport")),e.push((0,ee.jsx)(K.Z,{menu:{items:t},placement:"bottomRight",children:(0,ee.jsxs)(q.ZP,{type:"primary",danger:!0,disabled:0===a||0===t.length,children:[C.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})," (",a,")",(0,ee.jsx)(O.Z,{})]})},"batchOperations")),e};return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(P.Z,{columns:dt,actionRef:G,cardBordered:!0,rowSelection:mt,scroll:{x:1800},request:function(){var e=p()(f()().mark((function e(t,a,n){var s,o,i,d,u,c,g,p,m,h;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request:",t,a,n),b.yw.loading(C.formatMessage({id:"loading",defaultMessage:"Loading"})),s=t.current,o=t.pageSize,i=r()(t,de),ve(s),je(o),Ve(i),d=void 0,u=void 0,a&&Object.keys(a).length>0&&(c=Object.keys(a)[0],d=c,u="ascend"===a[c]?"ascend":"descend"),g=S?void 0:(null==Ce?void 0:Ce.uid)===y.zBg?"":null==Ce?void 0:Ce.uid,p=S||null==Ze?void 0:Ze.uid,m=l()(l()({pageNumber:s-1,pageSize:o,categoryUid:g,kbUid:p,orgUid:null==Se?void 0:Se.uid,superUser:S},i),{},{sortBy:d,sortDirection:u}),e.next=14,v(m);case 14:return h=e.sent,console.log("getAllTaboos response:",m,h),b.yw.destroy(),200===h.code?He(null==h?void 0:h.data.totalElements):b.yw.error(h.message),e.abrupt("return",{data:null==h?void 0:h.data.content,success:!0,total:null==h?void 0:h.data.totalElements});case 19:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:10,onChange:function(e,t){ve(e),je(t)}},dateFormatter:"string",headerTitle:F(null==Ze?void 0:Ze.name)+" - "+C.formatMessage({id:"taboo.title",defaultMessage:"敏感词"}),tooltip:{title:C.formatMessage({id:"taboo.tooltip",defaultMessage:"客服->一对一->高级设置->敏感词"}),placement:"top"},toolBarRender:function(){return ht()},columnsState:{persistenceKey:"taboo-table",defaultValue:{tags:{show:!0},startDate:{show:!1},endDate:{show:!1},level:{show:!0},enabled:{show:!0}}}}),me&&(0,ee.jsx)(te,{isEdit:$,open:me,taboo:ce,onClose:function(){return he(!1)},onSubmit:ft}),Ee&&(0,ee.jsx)(ae.Z,{type:y.R8f,acceptType:".xlsx,.xls,.csv",isModalOpen:Ee,handleSubmit:function(e){console.log("handleUploadDragSubmit",e),Ue(!1),null==G||G.current.reload(),pt()},handleCancel:function(){console.log("handleUploadDragCancel"),Ue(!1),null==G||G.current.reload()}}),Qe]})}}}]);