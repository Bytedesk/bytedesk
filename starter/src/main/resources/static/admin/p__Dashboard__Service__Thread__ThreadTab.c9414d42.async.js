"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[3868],{60215:function(e,t,r){r.r(t),r.d(t,{default:function(){return G}});var a=r(8247),n=r(21182),s=r(73193),d=r.n(s),i=r(84176),o=r.n(i),u=r(90819),c=r.n(u),l=r(89933),p=r.n(l),g=r(45332),f=r.n(g),h=r(86803),m=r(30921);function x(e){return v.apply(this,arguments)}function v(){return(v=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/thread/invite/query/org",{method:"GET",params:d()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=r(76750),M=r(40612),S=r(55735),w=r(44521),b=r(11090),k=r(81947),I=r(53530),j=r(75365),A=r(44194),F=r(28977),T=r.n(F),q=r(31549),R=["current","pageSize"],Z=function(){var e=(0,m.useIntl)(),t=(0,A.useRef)(),r=(0,A.useState)(1),a=f()(r,2),n=a[0],s=a[1],i=(0,A.useState)(10),u=f()(i,2),l=u[0],g=u[1],v=(0,M.u)((function(e){return e.currentOrg})),F=(0,y.Z)().translateString,Z=I.Z.useModal(),z=f()(Z,2),C=(z[0],z[1]),E=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,q.jsx)(m.FormattedMessage,{id:"sender",defaultMessage:"Sender"}),dataIndex:"sender",copyable:!0,render:function(e,t,r,a){var n;return F(null===(n=t.sender)||void 0===n?void 0:n.nickname)}},{title:(0,q.jsx)(m.FormattedMessage,{id:"receiver",defaultMessage:"Receiver"}),dataIndex:"receiverNickname",copyable:!0,render:function(e,t,r,a){var n;return F(null===(n=t.receiver)||void 0===n?void 0:n.nickname)}},{title:(0,q.jsx)(m.FormattedMessage,{id:"note",defaultMessage:"Note"}),dataIndex:"note",hideInSearch:!0,copyable:!0},{title:(0,q.jsx)(m.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0,copyable:!0},{title:(0,q.jsx)(m.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInSearch:!0,copyable:!0},{title:(0,q.jsx)(m.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,render:function(e,t,r,a){return T()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss")}}],Y=[].concat(E),N=function(){var e=p()(c()().mark((function e(){var t;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",n,l),t=localStorage.getItem(S.LA8),window.open((0,w.kG)()+"/api/v1/thread/transfer/export?"+new URLSearchParams({orgUid:(null==v?void 0:v.uid)||"",pageNumber:String(n-1),pageSize:String(l),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(k.Z,{columns:Y,actionRef:t,cardBordered:!0,request:function(){var e=p()(c()().mark((function e(t,r,a){var n,i,u,l,p;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request:",t,r,a),n=t.current,i=t.pageSize,u=o()(t,R),s(n),g(i),l=d()({pageNumber:n-1,pageSize:i,orgUid:null==v?void 0:v.uid},u),e.next=7,x(l);case 7:return p=e.sent,console.log("getAllThreadInvites response:",p,l),200===p.code||h.yw.error(p.message),e.abrupt("return",{data:p.data.content,success:!0,total:p.data.totalElements});case 11:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"thread",defaultMessage:"ThreadInvite"}),toolBarRender:function(){return[(0,q.jsx)(j.ZP,{icon:(0,q.jsx)(b.Z,{}),type:"primary",onClick:N,children:e.formatMessage({id:"export",defaultMessage:"Export"})},"button")]}}),C]})};function z(e){return C.apply(this,arguments)}function C(){return(C=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/thread/transfer/query/org",{method:"GET",params:d()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=["current","pageSize"],Y=function(){var e=(0,m.useIntl)(),t=(0,A.useRef)(),r=(0,A.useState)(1),a=f()(r,2),n=a[0],s=a[1],i=(0,A.useState)(10),u=f()(i,2),l=u[0],g=u[1],x=(0,M.u)((function(e){return e.currentOrg})),v=(0,y.Z)().translateString,F=I.Z.useModal(),R=f()(F,2),Z=(R[0],R[1]),C=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,q.jsx)(m.FormattedMessage,{id:"sender",defaultMessage:"Sender"}),dataIndex:"senderNickname",copyable:!0,render:function(e,t,r,a){var n;return v(null===(n=t.sender)||void 0===n?void 0:n.nickname)}},{title:(0,q.jsx)(m.FormattedMessage,{id:"receiver",defaultMessage:"Receiver"}),dataIndex:"receiverNickname",copyable:!0,render:function(e,t,r,a){var n;return v(null===(n=t.receiver)||void 0===n?void 0:n.nickname)}},{title:(0,q.jsx)(m.FormattedMessage,{id:"note",defaultMessage:"Note"}),dataIndex:"note",hideInSearch:!0,copyable:!0},{title:(0,q.jsx)(m.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0,copyable:!0},{title:(0,q.jsx)(m.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInSearch:!0,copyable:!0},{title:(0,q.jsx)(m.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,render:function(e,t,r,a){return T()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss")}}],Y=[].concat(C),N=function(){var e=p()(c()().mark((function e(){var t;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",n,l),t=localStorage.getItem(S.LA8),window.open((0,w.kG)()+"/api/v1/thread/transfer/export?"+new URLSearchParams({orgUid:(null==x?void 0:x.uid)||"",pageNumber:String(n-1),pageSize:String(l),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(k.Z,{columns:Y,actionRef:t,cardBordered:!0,request:function(){var e=p()(c()().mark((function e(t,r,a){var n,i,u,l,p;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request:",t,r,a),n=t.current,i=t.pageSize,u=o()(t,E),s(n),g(i),l=d()({pageNumber:n-1,pageSize:i,orgUid:null==x?void 0:x.uid},u),e.next=7,z(l);case 7:return p=e.sent,console.log("getAllThreadTransfers response:",p,l),200===p.code||h.yw.error(p.message),e.abrupt("return",{data:p.data.content,success:!0,total:p.data.totalElements});case 11:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"thread",defaultMessage:"ThreadTransfer"}),toolBarRender:function(){return[(0,q.jsx)(j.ZP,{icon:(0,q.jsx)(b.Z,{}),type:"primary",onClick:N,children:e.formatMessage({id:"export",defaultMessage:"Export"})},"button")]}}),Z]})};function N(e){return U.apply(this,arguments)}function U(){return(U=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/v1/thread/rating/query/org",{method:"GET",params:d()(d()({},t),{},{client:S.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=["current","pageSize"],H=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,q.jsx)(m.FormattedMessage,{id:"agent",defaultMessage:"Agent"}),dataIndex:"agent",hideInSearch:!0,render:function(e,t,r,a){var n;return null==t||null===(n=t.agent)||void 0===n?void 0:n.nickname}},{title:(0,q.jsx)(m.FormattedMessage,{id:"user",defaultMessage:"User"}),dataIndex:"user",hideInSearch:!0,render:function(e,t,r,a){var n;return null==t||null===(n=t.user)||void 0===n?void 0:n.nickname}},{title:(0,q.jsx)(m.FormattedMessage,{id:"score",defaultMessage:"Score"}),dataIndex:"score"},{title:(0,q.jsx)(m.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"comment",copyable:!0},{title:(0,q.jsx)(m.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,render:function(e,t,r,a){return T()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss")}}],D=function(){var e=(0,m.useIntl)(),t=(0,A.useRef)(),r=(0,A.useState)(1),a=f()(r,2),n=(a[0],a[1]),s=(0,A.useState)(10),i=f()(s,2),u=(i[0],i[1]),l=(0,M.u)((function(e){return e.currentOrg})),g=[].concat(H,[{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:50,render:function(t,r,a,n){return[(0,q.jsx)("a",{onClick:function(){x(r)},children:e.formatMessage({id:"view",defaultMessage:"View"})},"editable")]}}]),x=function(e){var t;console.log("handleShowChatHistory",e);var r={chatConfig:{org:null==l?void 0:l.uid,t:S.IUl,sid:null==e?void 0:e.threadUid}};null===(t=window.bytedesk)||void 0===t||t.showChat(r)};return(0,q.jsx)("div",{style:{padding:"16px"},children:(0,q.jsx)(k.Z,{columns:g,actionRef:t,cardBordered:!0,request:function(){var e=p()(c()().mark((function e(t,r,a){var s,i,p,g,f;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.current,i=t.pageSize,p=o()(t,B),n(s),u(i),g=d()({pageNumber:s-1,pageSize:i,orgUid:null==l?void 0:l.uid},p),e.next=6,N(g);case 6:return f=e.sent,console.log("queryRatesByOrgUid response:",f.data,g),200===f.code||h.yw.error(f.message),e.abrupt("return",{data:f.data.content,success:!0,total:f.data.totalElements});case 10:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"评价记录"})})},G=function(){var e=(0,m.useIntl)(),t=[{key:"thread",label:e.formatMessage({id:"thread.tab.all"}),children:(0,q.jsx)(n.Z,{type:S.Nqz})},{key:"rate",label:e.formatMessage({id:"thread.tab.rate"}),children:(0,q.jsx)(D,{})},{key:"transfer",label:e.formatMessage({id:"thread.tab.transfer"}),children:(0,q.jsx)(Y,{})},{key:"invite",label:e.formatMessage({id:"thread.tab.invite"}),children:(0,q.jsx)(Z,{})}];return(0,q.jsx)(a.Z,{defaultActiveKey:"thread",items:t})}}}]);