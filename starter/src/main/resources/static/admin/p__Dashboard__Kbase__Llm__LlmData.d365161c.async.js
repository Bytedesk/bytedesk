"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2255],{93689:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(i)},58275:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(i)},47944:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(i)},61353:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M573 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40zm-280 0c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}},{tag:"path",attrs:{d:"M894 345a343.92 343.92 0 00-189-130v.1c-17.1-19-36.4-36.5-58-52.1-163.7-119-393.5-82.7-513 81-96.3 133-92.2 311.9 6 439l.8 132.6c0 3.2.5 6.4 1.5 9.4a31.95 31.95 0 0040.1 20.9L309 806c33.5 11.9 68.1 18.7 102.5 20.6l-.5.4c89.1 64.9 205.9 84.4 313 49l127.1 41.4c3.2 1 6.5 1.6 9.9 1.6 17.7 0 32-14.3 32-32V753c88.1-119.6 90.4-284.9 1-408zM323 735l-12-5-99 31-1-104-8-9c-84.6-103.2-90.2-251.9-11-361 96.4-132.2 281.2-161.4 413-66 132.2 96.1 161.5 280.6 66 412-80.1 109.9-223.5 150.5-348 102zm505-17l-8 10 1 104-98-33-12 5c-56 20.8-115.7 22.5-171 7l-.2-.1A367.31 367.31 0 00729 676c76.4-105.3 88.8-237.6 44.4-350.4l.6.4c23 16.5 44.1 37.1 62 62 72.6 99.6 68.5 235.2-8 330z"}},{tag:"path",attrs:{d:"M433 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}}]},name:"comment",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(i)},15722:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(i)},42085:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(i)},2484:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11757),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},s=n(54183),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(i)},79907:function(e,t,n){var r=n(17082),a=n(73457),o=n(44194),s=n(35175),i=n(31549),l=["fieldProps","min","proFieldProps","max"],c=function(e,t){var n=e.fieldProps,o=e.min,c=e.proFieldProps,u=e.max,d=(0,a.Z)(e,l);return(0,i.jsx)(s.Z,(0,r.Z)({valueType:"digit",fieldProps:(0,r.Z)({min:o,max:u},n),ref:t,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:c},d))},u=o.forwardRef(c);t.Z=u},65895:function(e,t,n){var r=n(17082),a=n(73457),o=n(82308),s=n(67402),i=n(44194),l=n(69088),c=n(35175),u=n(31549),d=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],f=i.forwardRef((function(e,t){var n=e.fieldProps,s=e.options,i=e.radioType,l=e.layout,f=e.proFieldProps,p=e.valueEnum,g=(0,a.Z)(e,d);return(0,u.jsx)(c.Z,(0,r.Z)((0,r.Z)({valueType:"button"===i?"radioButton":"radio",ref:t,valueEnum:(0,o.h)(p,void 0)},g),{},{fieldProps:(0,r.Z)({options:s,layout:l},n),proFieldProps:f,filedConfig:{customLightMode:!0}}))})),p=i.forwardRef((function(e,t){var n=e.fieldProps,a=e.children;return(0,u.jsx)(s.ZP,(0,r.Z)((0,r.Z)({},n),{},{ref:t,children:a}))})),g=(0,l.G)(p,{valuePropName:"checked",ignoreWidth:!0});g.Group=f,g.Button=s.ZP.Button,g.displayName="ProFormComponent",t.Z=g},48708:function(e,t,n){var r=n(17082),a=n(73457),o=n(44194),s=n(35175),i=n(31549),l=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],c=o.forwardRef((function(e,t){var n=e.fieldProps,o=e.unCheckedChildren,c=e.checkedChildren,u=e.proFieldProps,d=(0,a.Z)(e,l);return(0,i.jsx)(s.Z,(0,r.Z)({valueType:"switch",fieldProps:(0,r.Z)({unCheckedChildren:o,checkedChildren:c},n),ref:t,valuePropName:"checked",proFieldProps:u,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},d))}));t.Z=c},4499:function(e,t,n){var r=n(42601),a=n(17082),o=n(73457),s=n(46015),i=n(57178),l=n(98036),c=n(36490),u=n(44194),d=n(35175),f=n(31549),p=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],m="text",h=function(e){var t=(0,s.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),n=(0,r.Z)(t,2),o=n[0],c=n[1];return(0,f.jsx)(i.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var n,r=t.getFieldValue(e.name||[]);return(0,f.jsx)(l.Z,(0,a.Z)((0,a.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return c(e)},content:(0,f.jsxs)("div",{style:{padding:"4px 0"},children:[null===(n=e.statusRender)||void 0===n?void 0:n.call(e,r),e.strengthText?(0,f.jsx)("div",{style:{marginTop:10},children:(0,f.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:o,children:e.children}))}})},v=function(e){var t=e.fieldProps,n=e.proFieldProps,r=(0,o.Z)(e,p);return(0,f.jsx)(d.Z,(0,a.Z)({valueType:m,fieldProps:t,filedConfig:{valueType:m},proFieldProps:n},r))};v.Password=function(e){var t=e.fieldProps,n=e.proFieldProps,s=(0,o.Z)(e,g),i=(0,u.useState)(!1),l=(0,r.Z)(i,2),p=l[0],v=l[1];return null!=t&&t.statusRender&&s.name?(0,f.jsx)(h,{name:s.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:p,onOpenChange:v,children:(0,f.jsx)("div",{children:(0,f.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:(0,a.Z)((0,a.Z)({},(0,c.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var n;null==t||null===(n=t.onBlur)||void 0===n||n.call(t,e),v(!1)},onClick:function(e){var n;null==t||null===(n=t.onClick)||void 0===n||n.call(t,e),v(!0)}}),proFieldProps:n,filedConfig:{valueType:m}},s))})}):(0,f.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:t,proFieldProps:n,filedConfig:{valueType:m}},s))},v.displayName="ProFormComponent",t.Z=v},32350:function(e,t,n){var r=n(17082),a=n(73457),o=n(44194),s=n(35175),i=n(31549),l=["fieldProps","proFieldProps"],c=function(e,t){var n=e.fieldProps,o=e.proFieldProps,c=(0,a.Z)(e,l);return(0,i.jsx)(s.Z,(0,r.Z)({ref:t,valueType:"textarea",fieldProps:n,proFieldProps:o},c))};t.Z=o.forwardRef(c)},92053:function(e,t,n){n.d(t,{G9:function(){return w},J$:function(){return k},N6:function(){return x},VM:function(){return c},c8:function(){return d},gF:function(){return m},rg:function(){return p},sF:function(){return v}});var r=n(90819),a=n.n(r),o=n(89933),s=n.n(o),i=n(55735),l=n(30921);function c(){return u.apply(this,arguments)}function u(){return(u=s()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/ping",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return f.apply(this,arguments)}function f(){return(f=s()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/local-models",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return g.apply(this,arguments)}function g(){return(g=s()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/models",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/library/models/"+t+"/details",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/models/"+t+"/details",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return y.apply(this,arguments)}function y(){return(y=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/models/pull",{method:"POST",params:{client:i.bVn},data:{model:t}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return M.apply(this,arguments)}function M(){return(M=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/models/delete",{method:"POST",params:{client:i.bVn},data:{model:t}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return j.apply(this,arguments)}function j(){return(j=s()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/ollama4j/embedding-model/exists",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},76750:function(e,t,n){var r=n(55735),a=n(65461),o=n(30921);t.Z=function(){var e=(0,o.useIntl)();return{translateString:function(t){return null==t?t:t&&(null!=t&&t.startsWith(r.VoP)||null!=t&&t.startsWith("ROLE_"))?e.formatMessage({id:t,defaultMessage:t}):t},translateStringTranct:function(t){return null==t?t:null!=t&&t.startsWith(r.VoP)||null!=t&&t.startsWith("ROLE_")?(0,a.aS)(e.formatMessage({id:t,defaultMessage:t}),10):(0,a.aS)(t,10)}}}},80876:function(e,t,n){var r=n(45332),a=n.n(r),o=n(40612),s=n(55735),i=n(69169),l=n(4499),c=n(84881),u=n(30921),d=n(53530),f=n(44194),p=n(31549);t.Z=function(e){var t=e.open,n=e.onClose,r=e.onSubmit,g=(0,u.useIntl)(),m=i.A.useForm(),h=a()(m,1)[0],v=(0,o.u)((function(e){return e.currentOrg})),b=function(){console.log("handleSaveRobot"),h.validateFields().then((function(e){console.log("handleSaveRobot values:",e);var t={name:e.nickname,nickname:e.nickname,type:e.type,serviceSettings:{showQuickFaqs:!1,quickFaqs:[],showFaqs:!1,faqs:[],showGuessFaqs:!1,guessFaqs:[],showHotFaqs:!1,hotFaqs:[],showShortcutFaqs:!1,shortcutFaqs:[]},kbEnabled:!1,orgUid:null==v?void 0:v.uid};console.log("robotObject:",t),r(t),h.resetFields()})).catch((function(e){console.log("Form errors:",e)}))};return(0,f.useEffect)((function(){console.log("RobotForm useEffect"),t&&(h.resetFields(),h.setFieldsValue({type:s.f4h}))}),[t,h]),(0,p.jsx)("div",{children:(0,p.jsx)(d.Z,{title:g.formatMessage({id:"pages.robot.new",defaultMessage:"New"}),open:t,forceRender:!0,okText:g.formatMessage({id:"save",defaultMessage:"Save"}),onOk:b,onCancel:function(){h.resetFields(),n()},children:(0,p.jsxs)(i.A,{form:h,name:"basic",style:{maxWidth:400},submitter:!1,children:[(0,p.jsx)(l.Z,{label:g.formatMessage({id:"nickname",defaultMessage:"Nickname"}),name:"nickname",rules:[{required:!0,message:g.formatMessage({id:"nickname",defaultMessage:"Nickname"})}],fieldProps:{onPressEnter:function(){return b()}}}),(0,p.jsx)(c.Z,{label:g.formatMessage({id:"type",defaultMessage:"Type"}),name:["type"],options:[{label:g.formatMessage({id:s.f4h,defaultMessage:"Service"}),value:s.f4h}],rules:[{required:!0,message:g.formatMessage({id:"choose",defaultMessage:"Choose"})}],fieldProps:{placeholder:g.formatMessage({id:"choose",defaultMessage:"Choose"}),onChange:function(e){console.log("onTreeSelectChange:",e)},allowClear:!0}})]})})})}},39249:function(e,t,n){n.r(t),n.d(t,{default:function(){return He}});var r=n(96865),a=n(75574),o=n(55735),s=n(95160),i=n(44194),l=n(8247),c=n(30921),u=n(73193),d=n.n(u),f=n(84176),p=n.n(f),g=n(86222),m=n.n(g),h=n(90819),v=n.n(h),b=n(89933),x=n.n(b),y=n(45332),w=n.n(y);var M=n(76750),k=n(6397),j=n(40612),Z=(n(51239),n(44521)),C=n(31549),S=n(90838),P=(n(69114),n(28977)),E=n.n(P),q=n(27650),F=n(28425),I=n(72608),T=n(32943),L=n(53530),U=n(92053),O=function(e){var t=e.onModelStatusChange,n=(0,c.useIntl)(),r=(0,i.useState)(!1),a=w()(r,2),o=a[0],s=a[1],l=(0,i.useState)(!1),u=w()(l,2),d=u[0],f=u[1],p=(0,i.useState)(!1),g=w()(p,2),m=(g[0],g[1],function(){var e=x()(v()().mark((function e(){var n;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f(!0),null==t||t(!1),e.next=5,(0,U.J$)();case 5:n=e.sent,console.log("Embedding model check response:",n),200===n.code?(s(n.data),null==t||t(n.data)):(s(!1),null==t||t(!1)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("检查嵌入式模型失败:",e.t0),s(!1),null==t||t(!1);case 15:return e.prev=15,f(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,10,15,18]])})));return function(){return e.apply(this,arguments)}}());return(0,i.useEffect)((function(){m()}),[]),d?(0,C.jsx)(T.Z,{type:"info",showIcon:!0,message:n.formatMessage({id:"embedding.model.checking",defaultMessage:"正在检查Embedding向量模型..."}),style:{marginBottom:16}}):o?null:(0,C.jsx)(T.Z,{type:"warning",showIcon:!0,message:(0,C.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:(0,C.jsx)("span",{children:n.formatMessage({id:"embedding.model.missing.title",defaultMessage:"嵌入式模型缺失"})})}),description:n.formatMessage({id:"embedding.model.missing.content",defaultMessage:"请拉取Embedding向量模型bge-m3:latest，用于知识库向量检索"}),style:{marginBottom:16}})},$=n(76711),R=n.n($),D=n(86803),z=n(75365),A=n(61353),B=n(66916),H=n(80876),N=n(10162),V=n(80601),Y=n(44781),G=n(38775),W="CREATE_NEW_ROBOT",K=function(e){var t=e.visible,n=e.loading,r=e.robotList,a=e.selectedRobotUid,o=e.currentKbaseUid,s=e.onOk,i=e.onCancel,l=e.onChange,u=(0,c.useIntl)();return console.log("RobotSelectModal rendering with:",{robotList:r,selectedRobotUid:a,currentKbaseUid:o}),(0,C.jsx)(L.Z,{title:u.formatMessage({id:"robot.select.title",defaultMessage:"选择机器人"}),open:t,onOk:s,onCancel:i,okText:u.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:u.formatMessage({id:"cancel",defaultMessage:"取消"}),okButtonProps:{disabled:!a},children:(0,C.jsx)(V.Z,{spinning:n,children:(0,C.jsxs)("div",{style:{marginBottom:16},children:[(0,C.jsx)("p",{children:u.formatMessage({id:"robot.select.desc",defaultMessage:"选择一个机器人并绑定到当前知识库"})}),(0,C.jsxs)(Y.Z,{style:{width:"100%"},placeholder:u.formatMessage({id:"robot.select.placeholder",defaultMessage:"请选择一个机器人"}),value:a,onChange:l,optionLabelProp:"label",children:[r.map((function(e){console.log("Robot ".concat(e.name||e.nickname,": kbUid=").concat(e.kbUid,", currentKbaseUid=").concat(o));var t=!!e.kbUid&&""!==e.kbUid.trim(),n=t&&e.kbUid===o,r=e.name||e.nickname||e.uid;return t&&(r="".concat(r,n?" (已绑定当前知识库)":" (已绑定其他知识库)")),(0,C.jsx)(Y.Z.Option,{value:e.uid,label:r,children:r},e.uid)})),r.length>0&&(0,C.jsx)(Y.Z.Option,{value:"divider",disabled:!0,children:(0,C.jsx)(G.Z,{style:{margin:"4px 0"}})}),(0,C.jsx)(Y.Z.Option,{value:W,label:u.formatMessage({id:"robot.create.new",defaultMessage:"创建新机器人"}),children:(0,C.jsxs)("div",{style:{color:"#1890ff"},children:[(0,C.jsx)(N.Z,{})," ",u.formatMessage({id:"robot.create.new",defaultMessage:"创建新机器人"})]})})]})]})})})},Q=function(e){var t=e.currentKbase,n=e.currentOrg,r=e.embeddingModelExists,a=e.checkingEmbeddingModel,s=(0,c.useIntl)(),l=(0,i.useState)(!1),u=w()(l,2),f=u[0],p=u[1],g=(0,i.useState)(!1),m=w()(g,2),h=m[0],b=m[1],y=(0,i.useState)(!1),M=w()(y,2),k=M[0],j=M[1],Z=(0,i.useState)(),S=w()(Z,2),P=(S[0],S[1]),E=(0,i.useState)([]),q=w()(E,2),F=q[0],T=q[1],U=(0,i.useState)(""),O=w()(U,2),$=O[0],N=O[1],V=function(){var e=x()(v()().mark((function e(r){var a,i,l,c;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,a={pageNumber:0,pageSize:100,kbEnabled:!0,kbUid:r?null==t?void 0:t.uid:"",categoryUid:"",level:o.whQ,type:o.f4h,orgUid:null==n?void 0:n.uid},console.log("Fetching robots with params:",a),e.next=6,(0,B.p0)(a);case 6:if(i=e.sent,console.log("queryRobotsByOrg response:",i),200!==i.code){e.next=16;break}return l=i.data.content||[],c=l.map((function(e){return console.log("Processing robot: ".concat(e.name||e.nickname,", kbUid: ").concat(e.kbUid)),e})),T(c),r&&c.length>0&&P(c[0]),e.abrupt("return",c);case 16:return D.yw.error(i.message),e.abrupt("return",[]);case 18:e.next=25;break;case 20:return e.prev=20,e.t0=e.catch(1),console.error("获取机器人失败:",e.t0),D.yw.error(s.formatMessage({id:"fetch.robot.error",defaultMessage:"获取机器人失败"})),e.abrupt("return",[]);case 25:return e.prev=25,j(!1),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[1,20,25,28]])})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=x()(v()().mark((function e(){var n,r,a;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($&&null!=t&&t.uid){e.next=3;break}return D.yw.error(s.formatMessage({id:"robot.select.required",defaultMessage:"请先选择一个机器人"})),e.abrupt("return",!1);case 3:return D.yw.loading(s.formatMessage({id:"updating",defaultMessage:"更新中..."})),n={uid:$,kbEnabled:!0,kbUid:null==t?void 0:t.uid},e.prev=5,e.next=8,(0,B.Xd)(n);case 8:if(r=e.sent,console.log("updateRobotKbUid response:",r),200!==r.code){e.next=18;break}return D.yw.destroy(),D.yw.success(s.formatMessage({id:"update.success",defaultMessage:"更新成功"})),a=r.data,P(a),e.abrupt("return",!0);case 18:return D.yw.destroy(),D.yw.error(r.message),e.abrupt("return",!1);case 21:e.next=29;break;case 23:return e.prev=23,e.t0=e.catch(5),D.yw.destroy(),D.yw.error(s.formatMessage({id:"update.failed",defaultMessage:"更新失败"})),console.error("更新机器人知识库失败:",e.t0),e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,null,[[5,23]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=x()(v()().mark((function e(){var n;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleChatKb"),t){e.next=4;break}return D.yw.error(s.formatMessage({id:"kb.select.required",defaultMessage:"请先选择一个知识库"})),e.abrupt("return");case 4:return D.yw.loading(s.formatMessage({id:"loading",defaultMessage:"加载中..."})),e.next=7,V(!0);case 7:if(n=e.sent,D.yw.destroy(),!(n.length>0)){e.next=13;break}n.length>1?(T(n),N(""),p(!0)):Q(n[0]),e.next=21;break;case 13:return e.next=15,V(!1);case 15:if(0!==e.sent.length){e.next=19;break}return D.yw.info(s.formatMessage({id:"robot.none",defaultMessage:"没有可用的机器人，请先创建机器人"})),e.abrupt("return");case 19:N(""),p(!0);case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(e){var t;if(e&&e.uid){var r={chatConfig:{org:null==n?void 0:n.uid,t:o.xtN,sid:e.uid}};null===(t=window.bytedesk)||void 0===t||t.showChat(r)}else D.yw.error(s.formatMessage({id:"robot.invalid",defaultMessage:"无效的机器人"}))},_=function(){var e=x()(v()().mark((function e(){var n;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($){e.next=3;break}return D.yw.error(s.formatMessage({id:"robot.select.required",defaultMessage:"请先选择一个机器人"})),e.abrupt("return");case 3:if(null==(n=F.find((function(e){return e.uid===$})))||!n.kbUid||n.kbUid===(null==t?void 0:t.uid)){e.next=7;break}return L.Z.confirm({title:s.formatMessage({id:"robot.already.bound",defaultMessage:"机器人已绑定知识库"}),content:s.formatMessage({id:"robot.rebind.confirm",defaultMessage:"该机器人已绑定其他知识库，是否更换绑定到当前知识库？"}),okText:s.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:s.formatMessage({id:"cancel",defaultMessage:"取消"}),onOk:function(){var e=x()(v()().mark((function e(){return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:e.sent&&(p(!1),Q(n));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),e.abrupt("return");case 7:return e.next=9,Y();case 9:e.sent&&(p(!1),n&&Q(n));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=x()(v()().mark((function e(n){var r,a,o,i;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D.yw.loading(s.formatMessage({id:"creating",defaultMessage:"创建中..."})),console.log("Current Kbase info:",t),r=d()(d()({},n),{},{kbEnabled:!0,kbUid:null==t?void 0:t.uid}),console.log("Creating robot with data:",r),e.next=7,(0,B.lg)(r);case 7:if(a=e.sent,console.log("Create robot response:",a),200!==a.code){e.next=29;break}if(D.yw.destroy(),D.yw.success(s.formatMessage({id:"create.success",defaultMessage:"创建成功"})),b(!1),o=a.data,console.log("New robot data:",o),null==o||!o.uid){e.next=23;break}N(o.uid),P(o),T((function(e){var t=[o].concat(R()(e));return console.log("Updated robot list:",t),t})),p(!1),Q(o),e.next=27;break;case 23:return e.next=25,V(!1);case 25:i=e.sent,console.log("Fetched all robots after creation:",i);case 27:e.next=31;break;case 29:D.yw.destroy(),D.yw.error(a.message||s.formatMessage({id:"create.failed",defaultMessage:"创建失败"}));case 31:e.next=38;break;case 33:e.prev=33,e.t0=e.catch(0),D.yw.destroy(),D.yw.error(s.formatMessage({id:"create.error",defaultMessage:"创建过程发生错误"})),console.error("创建机器人错误:",e.t0);case 38:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(t){return e.apply(this,arguments)}}();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(z.ZP,{icon:(0,C.jsx)(A.Z,{}),type:"primary",onClick:function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n?I.ZP.info("正在检查模型状态，请稍后再试"):t?e():L.Z.warning({title:"嵌入式模型缺失",content:"请首先拉取Embedding向量模型bge-m3:latest，用于知识库向量检索",okText:"确定"})}(G,r,a)},disabled:a,children:s.formatMessage({id:"chat.test"})}),(0,C.jsx)(K,{visible:f,loading:k,robotList:F,selectedRobotUid:$,currentKbaseUid:null==t?void 0:t.uid,onOk:_,onCancel:function(){return p(!1)},onChange:function(e){e===W?(b(!0),N("")):N(e)}}),h&&(0,C.jsx)(H.Z,{open:h,onClose:function(){return b(!1)},onSubmit:X})]})};var _=n(99885),X=n(54881),J=n(93689),ee=n(40439),te=n(58275),ne=n(30617),re=n(11090),ae=n(61107),oe=n(2484),se=n(81947),ie=n(29266),le=n(61355),ce=n(88996),ue=n(96485),de=n(69169),fe=n(84881),pe=n(4499),ge=n(62577),me=n(39755),he=n(79907),ve=n(32350),be=n(65895),xe=n(17082),ye=n(73457),we=n(42965),Me=n(63653),ke=n(35175),je=["fieldProps","proFieldProps"],Ze="dateRange",Ce=i.forwardRef((function(e,t){var n=e.fieldProps,r=e.proFieldProps,a=(0,ye.Z)(e,je),o=(0,i.useContext)(Me.Z);return(0,C.jsx)(ke.Z,(0,xe.Z)({ref:t,fieldProps:(0,xe.Z)({getPopupContainer:o.getPopupContainer},n),valueType:Ze,proFieldProps:r,filedConfig:{valueType:Ze,customLightMode:!0,lightFilterLabelFormatter:function(e){return(0,we.c)(e,(null==n?void 0:n.format)||"YYYY-MM-DD")}}},a))})),Se=n(48708),Pe=n(73442),Ee=n(3849),qe=n(30348),Fe=n(43409),Ie=n(62673),Te=n(52288),Le=n(65461),Ue=n(51990),Oe=["key"],$e=function(e){var t=e.isEdit,n=e.faq,r=e.open,a=e.onClose,s=e.onSubmit,l=de.A.useForm(),c=w()(l,1)[0],u=((0,M.Z)().translateString,(0,i.useState)("")),f=w()(u,2),g=f[0],m=f[1],h=(0,i.useState)(""),b=w()(h,2),y=b[0],P=b[1],q=(0,i.useState)(""),F=w()(q,2),I=F[0],T=F[1],U=(0,j.u)((function(e){return e.currentOrg})),O=(0,k.j)((function(e){return e.currentKbase})),$=(0,S.v)((function(e){return e.categorySelectOptions})),A=(0,S.v)((function(e){return e.currentCategory})),B=(0,i.useState)(),H=w()(B,2),V=(H[0],H[1]),Y=(0,i.useState)([]),W=w()(Y,2),K=W[0],Q=W[1],X=(0,i.useState)(!1),J=w()(X,2),ee=J[0],te=J[1],ne=(0,i.useState)(""),re=w()(ne,2),ae=re[0],oe=re[1],se=(0,i.useRef)(null),le=(0,i.useState)([]),ce=w()(le,2),ue=(ce[0],ce[1]),xe=(0,i.useState)([]),ye=w()(xe,2),we=ye[0],Me=ye[1],ke=(0,i.useState)(!0),je=w()(ke,2),Ze=je[0],$e=je[1],Re=(0,i.useState)("permanent"),De=w()(Re,2),ze=De[0],Ae=De[1],Be=(0,i.useState)([]),He=w()(Be,2),Ne=He[0],Ve=He[1],Ye=(0,i.useState)(!1),Ge=w()(Ye,2),We=(Ge[0],Ge[1],(0,i.useState)([])),Ke=w()(We,2),Qe=Ke[0],_e=Ke[1],Xe=(0,i.useState)([]),Je=w()(Xe,2),et=Je[0],tt=Je[1],nt=(0,i.useState)(!1),rt=w()(nt,2),at=rt[0],ot=rt[1],st=(0,i.useState)(""),it=w()(st,2),lt=it[0],ct=it[1],ut=(0,i.useState)(""),dt=w()(ut,2),ft=dt[0],pt=dt[1],gt=(0,i.useState)([]),mt=w()(gt,2),ht=mt[0],vt=mt[1],bt=(0,i.useState)([]),xt=w()(bt,2),yt=xt[0],wt=xt[1];(0,i.useEffect)((function(){var e=function(){var e=x()(v()().mark((function e(){var t,r,a;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D.yw.loading("正在加载常见问题列表..."),t={pageNumber:0,pageSize:100,categoryUid:(null==A?void 0:A.uid)===o.zBg?"":null==A?void 0:A.uid,kbUid:null==O?void 0:O.uid,orgUid:null==U?void 0:U.uid},e.next=5,(0,_.pf)(t);case 5:r=e.sent,console.log("获取FAQ列表响应:",t,r),D.yw.destroy(),200===r.code?(a=r.data.content.map((function(e){return{label:e.question,value:e.uid}})),Me(a.filter((function(e){return e.value!==(null==n?void 0:n.uid)})))):D.yw.error(r.message||"加载常见问题失败"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),D.yw.destroy(),D.yw.error("加载常见问题列表失败"),console.error("获取FAQ列表出错:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();r&&e()}),[r,null==O?void 0:O.uid,null==U?void 0:U.uid,null==A?void 0:A.uid,null==n?void 0:n.uid]),(0,i.useEffect)((function(){if(t){var e,r,a,o,s,i=Array.isArray(null==n?void 0:n.questionList)?n.questionList.map((function(e){return"string"==typeof e?e:String(e)})).filter((function(e){return""!==e.trim()})):[];if(c.setFieldsValue({question:null==n?void 0:n.question,questionList:i,answer:null==n?void 0:n.answer,categoryUid:null==n?void 0:n.categoryUid,kbUid:null==O?void 0:O.uid,answerList:(null==n?void 0:n.answerList)||[],enabled:!1!==(null==n?void 0:n.enabled),relatedFaqUids:(null==n||null===(e=n.relatedFaqs)||void 0===e?void 0:e.map((function(e){return e.uid})))||[],dateType:"permanent",dateRange:null!=n&&n.startDate&&null!=n&&n.endDate?[E()(n.startDate),E()(n.endDate)]:void 0}),m((null==n?void 0:n.answer)||""),P((null==n?void 0:n.answerHtml)||""),T((null==n?void 0:n.answerMarkdown)||""),Q((null==n||null===(r=n.tagList)||void 0===r?void 0:r.filter((function(e){return e&&""!==e.trim()})))||[]),ue((null==n||null===(a=n.relatedFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})))||[]),$e(!1!==(null==n?void 0:n.enabled)),Ve(i),null!=n&&null!==(o=n.images)&&void 0!==o&&o.length&&n.images.some((function(e){return e&&""!==e.trim()}))){var l=n.images.filter((function(e){return e&&""!==e.trim()})),u=l.map((function(e,t){return{uid:"-".concat(t+1),name:"image_".concat(t+1,".jpg"),status:"done",url:e,thumbUrl:e}}));_e(u),tt(l)}else _e([]),tt([]);if(null!=n&&null!==(s=n.attachments)&&void 0!==s&&s.length&&n.attachments.some((function(e){return e&&""!==e.trim()}))){var d=n.attachments.filter((function(e){return e&&""!==e.trim()})),f=d.map((function(e,t){var n=e.substring(e.lastIndexOf("/")+1);return{uid:"-".concat(t+1),name:n||"attachment_".concat(t+1),status:"done",url:e}}));vt(f),wt(d)}else vt([]),wt([])}else{var p=$.length>0?$[0].value:"";c.setFieldsValue({question:"",questionList:[],answer:"",categoryUid:p,kbUid:null==O?void 0:O.uid,answerList:[],enabled:!0,relatedFaqUids:[],dateType:"permanent",dateRange:void 0,autoSyncLlmQa:!1,llmQaKbUid:""}),p&&V(p),m(""),P(""),T(""),Q([]),ue([]),$e(!0),Ve([]),_e([]),tt([]),vt([]),wt([])}}),[n,r,$]),(0,i.useEffect)((function(){var e;ee&&(null===(e=se.current)||void 0===e||e.focus())}),[ee]);var Mt=function(){ae&&-1===K.indexOf(ae)&&Q([].concat(R()(K),[ae])),te(!1),oe("")},kt=function(){var e=x()(v()().mark((function e(t){return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ct(t.url||t.thumbUrl),ot(!0),pt(t.name||t.url.substring(t.url.lastIndexOf("/")+1));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),jt=(0,C.jsx)(z.ZP,{icon:(0,C.jsx)(N.Z,{}),children:"上传图片"}),Zt={name:"file",accept:"image/*",action:(0,Z.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(o.LA8)},listType:"picture-card",fileList:Qe,onPreview:kt,onChange:function(e){var t=R()(e.fileList);if("done"===e.file.status)if(200===e.file.response.code){var n=e.file.response.data.fileUrl;tt((function(e){return[].concat(R()(e),[n])})),D.yw.success("上传 ".concat(e.file.name," 成功"))}else D.yw.error("上传 ".concat(e.file.name," 失败: ").concat(e.file.response.message));else"error"===e.file.status&&D.yw.error("上传 ".concat(e.file.name," 失败"));t=t.map((function(e){return e.response&&200===e.response.code?d()(d()({},e),{},{url:e.response.data.fileUrl,thumbUrl:e.response.data.fileUrl}):e})),_e(t)},data:function(e){return{file:e,fileName:E()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,fileType:e.type,isAvatar:"false",kbType:o.IrL,categoryUid:c.getFieldValue("categoryUid")||"",kbUid:(null==O?void 0:O.uid)||"",client:o.bVn}},onRemove:function(e){return e.url&&tt((function(t){return t.filter((function(t){return t!==e.url}))})),!0}},Ct={name:"file",action:(0,Z.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(o.LA8)},fileList:ht,onChange:function(e){var t=R()(e.fileList);if("done"===e.file.status)if(200===e.file.response.code){var n=e.file.response.data.fileUrl;wt((function(e){return[].concat(R()(e),[n])})),D.yw.success("上传 ".concat(e.file.name," 成功"))}else D.yw.error("上传 ".concat(e.file.name," 失败: ").concat(e.file.response.message));else"error"===e.file.status&&D.yw.error("上传 ".concat(e.file.name," 失败"));t=t.map((function(e){return e.response&&200===e.response.code?d()(d()({},e),{},{url:e.response.data.fileUrl}):e})),vt(t)},data:function(e){return{file:e,fileName:E()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name,fileType:e.type,isAvatar:"false",kbType:o.IrL,categoryUid:c.getFieldValue("categoryUid")||"",kbUid:(null==O?void 0:O.uid)||"",client:o.bVn}},onRemove:function(e){return e.url&&wt((function(t){return t.filter((function(t){return t!==e.url}))})),!0}};return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(Pe.Z,{title:t?"修改常见问题":"新建常见问题",width:650,onClose:a,open:r,extra:(0,C.jsxs)(Ee.Z,{children:[(0,C.jsx)(z.ZP,{onClick:a,children:"取消"}),(0,C.jsx)(z.ZP,{onClick:function(){var e=Ne.map((function(e){return null==e?void 0:e.trim()})).filter((function(e){return e&&""!==e}));c.setFieldValue("questionList",e),c.validateFields().then((function(e){var t,r;if(console.log("handleSubmit values:",e),"permanent"===e.dateType)t=E()().format("YYYY-MM-DDTHH:mm:ss"),r=E()().add(100,"years").format("YYYY-MM-DDTHH:mm:ss");else{var a=e.dateRange;t=null!=a&&a[0]?a[0].format("YYYY-MM-DDTHH:mm:ss"):void 0,r=null!=a&&a[1]?a[1].format("YYYY-MM-DDTHH:mm:ss"):void 0}var i=Ne.map((function(e){return null==e?void 0:e.trim()})).filter((function(e){return e&&""!==e})),l=et.filter((function(e){return e&&""!==e.trim()})),c=yt.filter((function(e){return e&&""!==e.trim()})),u=K.filter((function(e){return e&&""!==e.trim()})),f=d()(d()(d()({},n),e),{},{type:o.PYi,kbUid:null==O?void 0:O.uid,orgUid:null==U?void 0:U.uid,answer:g,answerHtml:y,answerMarkdown:I,questionList:i,answerList:e.answerList||[],tagList:u,relatedFaqUids:e.relatedFaqUids||[],startDate:t,endDate:r,images:l,attachments:c});s(f)})).catch((function(e){console.log("Form errors:",e),D.yw.error("请检查表单填写")}))},type:"primary",children:"保存"})]}),children:(0,C.jsxs)(de.A,{form:c,submitter:{render:function(){return null}},children:[(0,C.jsx)(fe.Z,{label:"分类",name:"categoryUid",rules:[{required:!0,message:"请选择分类"}],options:$,fieldProps:{allowClear:!0,placeholder:"请选择分类",onChange:function(e){console.log("category selected ".concat(e)),V(e)}}}),(0,C.jsx)(pe.Z,{label:"问题",name:"question",rules:[{required:!0,message:"请输入问题"}]}),(0,C.jsx)(ge.u,{name:"questionList",label:"相似问法",creatorButtonProps:{creatorButtonText:"添加相似问法",icon:(0,C.jsx)(N.Z,{}),type:"dashed",block:!0,onClick:function(){var e=[].concat(R()(Ne),[""]);Ve(e),c.setFieldValue("questionList",e)}},copyIconProps:!1,min:0,style:{width:"100%"},initialValue:[],onAfterAdd:function(e,t,n){var r=c.getFieldValue("questionList")||[],a=Array.isArray(r)?r.map((function(e){return"string"==typeof e?e:""})):R()(Ne);Ve(a)},onAfterRemove:function(e,t){var n=c.getFieldValue("questionList")||[],r=Array.isArray(n)?n.map((function(e){return"string"==typeof e?e:""})):[];Ve(r)},actionRender:function(e,t,n){return[(0,C.jsx)(z.ZP,{type:"link",danger:!0,onClick:function(){var n=e.name,r=R()(Ne);r.splice(n,1),Ve(r),t.remove(e.name)},children:"删除"},"delete")]},children:function(e,t,n){var r=e.key,a=p()(e,Oe);return(0,C.jsx)(pe.Z,d()(d()({},a),{},{placeholder:"请输入相似问法",rules:[{required:!0,message:"请输入相似问法"}],width:"xl",fieldProps:{maxLength:500,autoComplete:"off",value:Ne[t]||"",onChange:function(e){var n=R()(Ne);n[t]=e.target.value,Ve(n),c.setFieldValue(["questionList",t],e.target.value)}}}),r)}}),(0,C.jsx)(de.A.Item,{name:"answer",label:"文本答案",children:(0,C.jsx)(Ue.Z,{defaultValue:g,toolbarKeys:(0,Le.eD)(),style:{height:"200px",width:"600px"},onChange:function(e,t,n){console.log("Editor content changed:",e,t,n),m(n),P(e),T(t)}})}),(0,C.jsxs)(de.A.Item,{label:"图片",tooltip:"可以上传多张图片作为回复内容",children:[(0,C.jsx)(qe.Z,d()(d()({},Zt),{},{children:jt})),(0,C.jsx)(L.Z,{open:at,title:ft,footer:null,onCancel:function(){return ot(!1)},children:(0,C.jsx)(Fe.Z,{alt:"预览图片",style:{width:"100%"},src:lt})})]}),(0,C.jsx)(de.A.Item,{label:"附件",tooltip:"可以上传多个附件作为回复内容",children:(0,C.jsx)(qe.Z,d()(d()({},Ct),{},{children:(0,C.jsx)(z.ZP,{icon:(0,C.jsx)(N.Z,{}),children:"上传附件"})}))}),(0,C.jsxs)(G.Z,{orientation:"left",children:["扩展答案列表",(0,C.jsx)(z.ZP,{type:"link",onClick:function(){window.open("https://www.weiyuai.cn/docs/zh-CN/docs/manual/admin/kbase/viplevel")},children:"使用说明"})]}),(0,C.jsx)(ge.u,{name:"answerList",creatorButtonProps:{creatorButtonText:"添加答案",icon:(0,C.jsx)(N.Z,{}),type:"dashed",block:!0},itemRender:function(e,t){var n=e.listDom,r=e.action,a=t.index;return(0,C.jsx)(Ie.Z,{size:"small",style:{marginBottom:16},extra:r,children:n},a)},initialValue:[],copyIconProps:!1,itemContainerRender:function(e){return(0,C.jsx)("div",{children:e})},children:(0,C.jsxs)(me.UW,{children:[(0,C.jsx)(he.Z,{name:"vipLevel",label:"VIP等级",rules:[{required:!0,message:"请输入VIP等级"}],placeholder:"输入VIP等级",min:1}),(0,C.jsx)(ve.Z,{name:"answer",label:"答案内容",rules:[{required:!0,message:"请输入答案内容"}],placeholder:"输入答案内容",fieldProps:{rows:3}})]})}),(0,C.jsx)(fe.Z,{name:"relatedFaqUids",label:"相关问题",mode:"multiple",options:we,fieldProps:{placeholder:"请选择相关问题"}}),(0,C.jsx)(de.A.Item,{label:"标签",children:(0,C.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[K.map((function(e){return(0,C.jsx)(ie.Z,{closable:!0,onClose:function(){return t=e,n=K.filter((function(e){return e!==t})),void Q(n);var t,n},children:e},e)})),ee?(0,C.jsx)(Te.Z,{ref:se,type:"text",size:"small",style:{width:78},value:ae,onChange:function(e){oe(e.target.value)},onBlur:Mt,onPressEnter:Mt}):(0,C.jsxs)(ie.Z,{onClick:function(){te(!0)},style:{borderStyle:"dashed",cursor:"pointer"},children:[(0,C.jsx)(N.Z,{})," 新标签"]})]})}),(0,C.jsx)(be.Z.Group,{name:"dateType",label:"有效期设置",options:[{label:"永久有效",value:"permanent"},{label:"自定义日期",value:"custom"}],fieldProps:{onChange:function(e){Ae(e.target.value),"permanent"===e.target.value&&c.setFieldValue("dateRange",void 0)},value:ze}}),"custom"===ze&&(0,C.jsx)(Ce,{name:"dateRange",label:"有效日期",rules:[{required:"custom"===ze,message:"请选择有效日期范围"}],fieldProps:{style:{width:"100%"}}}),(0,C.jsx)(Se.Z,{name:"enabled",label:"是否启用",fieldProps:{checked:Ze,onChange:function(e){$e(e)}}})]})})})},Re=["current","pageSize"],De=function(){var e=(0,c.useIntl)(),t=(0,M.Z)().translateString,n=(0,i.useRef)(),r=(0,i.useState)(!0),a=w()(r,2),s=a[0],l=a[1],u=(0,i.useState)(),f=w()(u,2),g=f[0],h=f[1],b=(0,i.useState)(!1),y=w()(b,2),P=y[0],I=y[1],T=(0,i.useState)(1),U=w()(T,2),$=U[0],R=U[1],A=(0,i.useState)(10),B=w()(A,2),H=B[0],V=B[1],Y=(0,j.u)((function(e){return e.currentOrg})),G=(0,k.j)((function(e){return e.currentKbase})),W=(0,S.v)((function(e){return e.currentCategory})),K=(0,S.v)((function(e){return e.categorySelectOptions})),de=(0,i.useState)(!1),fe=w()(de,2),pe=fe[0],ge=fe[1],me=(0,i.useState)([]),he=w()(me,2),ve=he[0],be=he[1],xe=(0,i.useState)([]),ye=w()(xe,2),we=ye[0],Me=ye[1],ke=(0,i.useState)(0),je=w()(ke,2),Ze=je[0],Ce=je[1],Se=(0,i.useState)(!1),Pe=w()(Se,2),Ee=Pe[0],qe=Pe[1],Fe=(0,i.useState)(!1),Ie=w()(Fe,2),Te=Ie[0],Le=Ie[1],Ue=(0,i.useState)({}),Oe=w()(Ue,2),De=Oe[0],ze=Oe[1],Ae=function(){var t=x()(v()().mark((function t(r){var a;return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(r),t.next=3,(0,_.Yg)(r);case 3:a=t.sent,console.log("delete response:",a),200===a.code?(null==n||n.current.reload(),D.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete Success"}))):D.yw.error(e.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Be=function(){var t=x()(v()().mark((function t(){var r,a,o,s,i,l;return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==we.length){t.next=3;break}return D.yw.warning(e.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),t.abrupt("return");case 3:D.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),a=0,o=0,s=m()(we),t.prev=7,s.s();case 9:if((i=s.n()).done){t.next=23;break}return l=i.value,t.prev=11,t.next=14,(0,_.Yg)(l);case 14:200===t.sent.code?a++:o++,t.next=21;break;case 18:t.prev=18,t.t0=t.catch(11),o++;case 21:t.next=9;break;case 23:t.next=28;break;case 25:t.prev=25,t.t1=t.catch(7),s.e(t.t1);case 28:return t.prev=28,s.f(),t.finish(28);case 31:D.yw.destroy(),0===o?D.yw.success(e.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:a})):D.yw.warning(e.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:a,fail:o})),be([]),Me([]),null===(r=n.current)||void 0===r||r.reloadAndRest();case 36:case"end":return t.stop()}}),t,null,[[7,25,28,31],[11,18]])})));return function(){return t.apply(this,arguments)}}(),He=function(){var t=x()(v()().mark((function t(r){var a,o,s,i,l,c;return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==we.length){t.next=3;break}return D.yw.warning(e.formatMessage({id:"batch.noselection",defaultMessage:"Please select items to process"})),t.abrupt("return");case 3:D.yw.loading(r?e.formatMessage({id:"enabling",defaultMessage:"Enabling..."}):e.formatMessage({id:"disabling",defaultMessage:"Disabling..."})),o=0,s=0,i=m()(we),t.prev=7,i.s();case 9:if((l=i.n()).done){t.next=23;break}return c=l.value,t.prev=11,t.next=14,(0,_.kv)({uid:c.uid,enabled:r});case 14:200===t.sent.code?o++:s++,t.next=21;break;case 18:t.prev=18,t.t0=t.catch(11),s++;case 21:t.next=9;break;case 23:t.next=28;break;case 25:t.prev=25,t.t1=t.catch(7),i.e(t.t1);case 28:return t.prev=28,i.f(),t.finish(28);case 31:D.yw.destroy(),0===s?D.yw.success(r?e.formatMessage({id:"batch.enable.success",defaultMessage:"Successfully enabled {count} items"},{count:o}):e.formatMessage({id:"batch.disable.success",defaultMessage:"Successfully disabled {count} items"},{count:o})):D.yw.warning(r?e.formatMessage({id:"batch.enable.partial",defaultMessage:"Enabled {success} items, failed to enable {fail} items"},{success:o,fail:s}):e.formatMessage({id:"batch.disable.partial",defaultMessage:"Disabled {success} items, failed to disable {fail} items"},{success:o,fail:s})),be([]),Me([]),null===(a=n.current)||void 0===a||a.reloadAndRest();case 36:case"end":return t.stop()}}),t,null,[[7,25,28,31],[11,18]])})));return function(e){return t.apply(this,arguments)}}(),Ne=function(){var t=x()(v()().mark((function t(){var r,a,s;return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==Ze){t.next=3;break}return D.yw.warning(e.formatMessage({id:"deleteAll.nodata",defaultMessage:"没有数据可删除"})),t.abrupt("return");case 3:return D.yw.loading(e.formatMessage({id:"deleting.all",defaultMessage:"正在删除所有数据..."})),t.prev=4,r={categoryUid:(null==W?void 0:W.uid)===o.zBg?"":null==W?void 0:W.uid,kbUid:null==G?void 0:G.uid,orgUid:null==Y?void 0:Y.uid},t.next=8,(0,_.QB)(r);case 8:200===(a=t.sent).code?(D.yw.destroy(),D.yw.success(e.formatMessage({id:"deleteAll.success",defaultMessage:"成功删除所有数据"})),null===(s=n.current)||void 0===s||s.reloadAndRest()):(D.yw.destroy(),D.yw.error(a.message||e.formatMessage({id:"deleteAll.failed",defaultMessage:"删除失败"}))),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(4),D.yw.destroy(),D.yw.error(e.formatMessage({id:"deleteAll.error",defaultMessage:"删除过程发生错误"})),console.error("删除全部数据错误:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(){return t.apply(this,arguments)}}(),Ve=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.question"}),dataIndex:"question",copyable:!0,fixed:"left",width:100,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"faq.question.tooltip",defaultMessage:"常见问题的问题内容"})},{title:(0,C.jsx)(c.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0,width:100,tooltip:e.formatMessage({id:"faq.status.tooltip",defaultMessage:"处理状态"}),render:function(t,n){var r=n.status||"",a="";return"SUCCESS"===r?a="success":"ERROR"===r?a="error":"NEW"!==r&&"PROCESSING"!==r||(a="processing"),(0,C.jsx)(ie.Z,{color:a,children:e.formatMessage({id:"llm.status.".concat(r.toLowerCase())})})}},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.similar.questions",defaultMessage:"相似问法"}),dataIndex:"questionList",width:200,ellipsis:!0,search:!1,tooltip:e.formatMessage({id:"faq.similar.questions.tooltip",defaultMessage:"表达相同意思的其他问法"}),render:function(e,t){if(!t.questionList||0===t.questionList.length)return"-";var n=t.questionList.length>3,r=t.questionList.slice(0,3);return(0,C.jsxs)("div",{children:[r.map((function(e,t){return(0,C.jsx)(ie.Z,{color:"blue",style:{marginBottom:4},children:e},t)})),n&&(0,C.jsxs)(ie.Z,{color:"orange",children:["+",t.questionList.length-3]})]})}},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.answer"}),dataIndex:"answer",width:200,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"faq.answer.tooltip",defaultMessage:"常见问题的回答内容"})},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.clickCount"}),dataIndex:"clickCount",width:100,hideInSearch:!0,sorter:!0,tooltip:e.formatMessage({id:"faq.clickCount.tooltip",defaultMessage:"问题被点击的次数"})},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.upCount"}),dataIndex:"upCount",width:100,hideInSearch:!0,sorter:!0,tooltip:e.formatMessage({id:"faq.upCount.tooltip",defaultMessage:"问题被点赞的次数"})},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.downCount"}),dataIndex:"downCount",width:100,hideInSearch:!0,sorter:!0,tooltip:e.formatMessage({id:"faq.downCount.tooltip",defaultMessage:"问题被踩的次数"})},{title:(0,C.jsx)(c.FormattedMessage,{id:"category"}),dataIndex:"categoryUid",hideInSearch:!0,width:120,tooltip:e.formatMessage({id:"faq.category.tooltip",defaultMessage:"问题所属的分类"}),render:function(e,t){var n=K.find((function(e){return e.value===(null==t?void 0:t.categoryUid)}));return(0,C.jsx)(ie.Z,{color:"blue",children:(null==n?void 0:n.label)||"-"})},filters:K.map((function(e){return{text:e.label,value:e.value}})),filterMode:"tree"},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.tags",defaultMessage:"标签"}),dataIndex:"tagList",width:150,hideInSearch:!0,tooltip:e.formatMessage({id:"faq.tags.tooltip",defaultMessage:"用于分类和搜索的标签"}),render:function(e,t){if(!t.tagList||0===t.tagList.length)return"-";var n=t.tagList.length>3,r=t.tagList.slice(0,3);return(0,C.jsxs)("div",{children:[r.map((function(e,t){return(0,C.jsx)(ie.Z,{color:"green",style:{marginBottom:4},children:e},t)})),n&&(0,C.jsxs)(ie.Z,{color:"orange",children:["+",t.tagList.length-3]})]})}},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.isValid"}),dataIndex:"enabled",width:100,hideInSearch:!0,tooltip:e.formatMessage({id:"faq.isValid.tooltip",defaultMessage:"问题是否有效可用"}),valueEnum:{true:{text:"有效",status:"Success"},false:{text:"无效",status:"Error"}}},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.startDate"}),dataIndex:"startDate",width:160,valueType:"dateTime",hideInSearch:!0,tooltip:e.formatMessage({id:"faq.startDate.tooltip",defaultMessage:"问题生效的开始时间"}),render:function(e,t){return t.startDate?E()(t.startDate).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.endDate"}),dataIndex:"endDate",width:160,valueType:"dateTime",hideInSearch:!0,tooltip:e.formatMessage({id:"faq.endDate.tooltip",defaultMessage:"问题失效的结束时间"}),render:function(e,t){return t.endDate?E()(t.endDate).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,C.jsx)(c.FormattedMessage,{id:"faq.updatedAt"}),dataIndex:"updatedAt",width:160,valueType:"dateTime",sorter:!0,hideInSearch:!0,tooltip:e.formatMessage({id:"faq.updatedAt.tooltip",defaultMessage:"最后更新的时间"})},{title:e.formatMessage({id:"actions"}),valueType:"option",key:"option",width:120,fixed:"right",render:function(t,n,r,a){return[(0,C.jsx)("a",{onClick:function(){Ge(n)},children:e.formatMessage({id:"edit"})},"editable"),(0,C.jsx)(le.Z,{title:e.formatMessage({id:"deleteTip"}),description:"".concat(e.formatMessage({id:"deleteAffirm"}),"【").concat(null==n?void 0:n.question,"】？"),onConfirm:function(){return Ae(n)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"}),children:(0,C.jsx)(z.ZP,{size:"small",type:"link",danger:!0,children:e.formatMessage({id:"delete"})})},"delete")]}}],Ye=function(){Ee?Te?D.yw.info("正在检查模型状态，请稍后再试"):(h(void 0),l(!1),I(!0)):L.Z.warning({title:"嵌入式模型缺失",content:"请首先拉取Embedding向量模型bge-m3:latest，用于知识库向量检索",okText:"确定"})},Ge=function(e){console.log("showEditDrawer",e),h(e),l(!0),I(!0)},We=function(){var t=x()(v()().mark((function t(r){var a,o;return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("handleSubmitDrawer",r),s?D.yw.loading(e.formatMessage({id:"updating"})):D.yw.loading(e.formatMessage({id:"creating"})),!s){t.next=8;break}return t.next=5,(0,_.y)(r);case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,(0,_.kh)(r);case 10:t.t0=t.sent;case 11:a=t.t0,console.log("createFaq response:",r,a),200===a.code?(D.yw.destroy(),D.yw.success(e.formatMessage({id:"create.success",defaultMessage:"create success"})),I(!1),null===(o=n.current)||void 0===o||o.reloadAndRest()):(D.yw.destroy(),D.yw.error(a.message));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ke=function(){var e=x()(v()().mark((function e(){return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ee){e.next=3;break}return L.Z.warning({title:"嵌入式模型缺失",content:"请首先拉取Embedding向量模型bge-m3:latest，用于知识库向量检索",okText:"确定"}),e.abrupt("return");case 3:if(!Te){e.next=6;break}return D.yw.info("正在检查模型状态，请稍后再试"),e.abrupt("return");case 6:ge(!0);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.reloadAndRest()}),[G,W]);var Qe=function(){var t=x()(v()().mark((function t(){return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,F.HK)(o.QPQ,null==Y?void 0:Y.uid,null==G?void 0:G.uid,{showLoading:!0,loadingMessage:e.formatMessage({id:"loading"}),errorMessage:e.formatMessage({id:"fetch.categories.error",defaultMessage:"Failed to fetch categories"})});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_e=function(){var e=x()(v()().mark((function e(t,n,r){var a,s;return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",t,n,r),a=localStorage.getItem(o.LA8),s=d()({categoryUid:(null==W?void 0:W.uid)===o.zBg?"":null==W?void 0:W.uid,kbUid:null==G?void 0:G.uid,orgUid:(null==Y?void 0:Y.uid)||"",accessToken:a||"",exportType:t},De),"current"===t?(s.pageNumber=String($-1),s.pageSize=String(H)):"all"===t?(s.pageNumber="0",s.pageSize="1000"):"range"===t&&void 0!==n&&void 0!==r&&(s.pageNumber=String(n),s.pageSize=String(r)),window.open((0,Z.kG)()+"/api/v1/faq/export?"+new URLSearchParams(s).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Xe={selectedRowKeys:ve,onChange:function(e,t){be(e),Me(t)}},Je=function(){var t=x()(v()().mark((function t(n,r,a){var s,i,l,c,u;return v()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",n,r,a),D.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),s=n.current,i=n.pageSize,l=p()(n,Re),R(s),V(i),ze(l),c=d()({pageNumber:s-1,pageSize:i,categoryUid:(null==W?void 0:W.uid)===o.zBg?"":null==W?void 0:W.uid,kbUid:null==G?void 0:G.uid,orgUid:null==Y?void 0:Y.uid},l),t.next=9,(0,_.pf)(c);case 9:return u=t.sent,console.log("queryFaqsByOrg response:",c,u),D.yw.destroy(),200===u.code?Ce(u.data.totalElements):D.yw.error(u.message),t.abrupt("return",{data:u.data.content,success:!0,total:u.data.totalElements});case 14:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),et=function(e){for(var t=[],n=1e3,r=Math.ceil(e/n),a=function(){var r=o,a=o*n+1,s=Math.min((o+1)*n,e);t.push({key:"export-".concat(o),label:"".concat(a,"-").concat(s," (").concat(s-a+1,"条)"),onClick:function(){return _e("range",r,n)}})},o=0;o<r;o++)a();return t};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(O,{onModelStatusChange:function(e){qe(e),Le(!1)}}),(0,C.jsx)(se.Z,{columns:Ve,actionRef:n,cardBordered:!0,rowSelection:Xe,request:Je,scroll:{x:1800},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:10,onChange:function(e,t){R(e),V(t)}},dateFormatter:"string",headerTitle:t(null==G?void 0:G.name)+" - 常见问题",tooltip:Te?"正在检查嵌入式模型...":Ee?"所添加FAQ内容会自动添加到 '拆分' 列表中 ":"请首先拉取Embedding向量模型bge-m3:latest",toolBarRender:function(){return function(){var t=[(0,C.jsx)(z.ZP,{icon:(0,C.jsx)(N.Z,{}),type:"primary",onClick:Ye,disabled:Te||!Ee,children:e.formatMessage({id:"create"})},"create"),(0,C.jsx)(ce.Z,{title:e.formatMessage({id:"chat.test.tooltip",defaultMessage:"请确认上传内容状态为：处理成功"}),children:(0,C.jsx)(Q,{currentKbase:G,currentOrg:Y,embeddingModelExists:Ee,checkingEmbeddingModel:Te||!Ee})},"chat")],n=[];ve.length>0&&n.push({key:"batchDelete",icon:(0,C.jsx)(X.Z,{}),danger:!0,label:e.formatMessage({id:"batch.delete"})+" (".concat(ve.length,")"),onClick:function(){L.Z.confirm({title:e.formatMessage({id:"batch.deleteTip"}),content:"".concat(e.formatMessage({id:"batch.deleteAffirm"})," ").concat(ve.length," ").concat(e.formatMessage({id:"items"}),"?"),onOk:Be,okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})}},{key:"batchEnable",icon:(0,C.jsx)(J.Z,{}),label:e.formatMessage({id:"batch.enable",defaultMessage:"Enable"})+" (".concat(ve.length,")"),onClick:function(){return He(!0)}},{key:"batchDisable",icon:(0,C.jsx)(ee.Z,{}),label:e.formatMessage({id:"batch.disable",defaultMessage:"Disable"})+" (".concat(ve.length,")"),onClick:function(){return He(!1)}}),n.push({key:"deleteAll",icon:(0,C.jsx)(te.Z,{}),danger:!0,label:e.formatMessage({id:"deleteAll",defaultMessage:"删除所有"}),onClick:function(){L.Z.confirm({title:e.formatMessage({id:"deleteAll.tip",defaultMessage:"删除确认"}),content:e.formatMessage({id:"deleteAll.confirm",defaultMessage:"确定要删除所有问答对数据吗？此操作不可恢复!"}),onOk:Ne,okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})}});var r=[{key:"import",icon:(0,C.jsx)(ne.Z,{}),label:e.formatMessage({id:"import"}),onClick:Ke,disabled:Te||!Ee},{key:"export-current",icon:(0,C.jsx)(re.Z,{}),label:e.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return _e("current")}}];return Ze>0&&(Ze<=1e3?r.push({key:"export-all",icon:(0,C.jsx)(re.Z,{}),label:e.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(Ze,"条)"),onClick:function(){return _e("all")}}):r.push({key:"export-range",icon:(0,C.jsx)(re.Z,{}),label:e.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(Ze,"条)"),children:et(Ze)})),r.push({key:"download",icon:(0,C.jsx)(ae.Z,{}),label:e.formatMessage({id:"download.template"}),onClick:function(){return(0,Z.IY)()}}),t.push((0,C.jsx)(ue.Z,{menu:{items:r},placement:"bottom",children:(0,C.jsxs)(z.ZP,{type:"primary",children:[e.formatMessage({id:"import.export",defaultMessage:"导入导出"}),(0,C.jsx)(oe.Z,{})]})},"importExport")),n.length>0&&t.push((0,C.jsx)(ue.Z,{menu:{items:n},placement:"bottom",children:(0,C.jsxs)(z.ZP,{type:ve.length>0?"primary":"default",danger:ve.length>0,children:[ve.length>0?e.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})+" (".concat(ve.length,")"):e.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,C.jsx)(oe.Z,{})]})},"batchOperations")),t}()}}),(0,C.jsx)($e,{isEdit:s,open:P,faq:g,onClose:function(){return I(!1)},onSubmit:We}),pe&&(0,C.jsx)(q.Z,{type:o.hqx,acceptType:".xlsx,.xls,.csv",isModalOpen:pe,handleSubmit:function(e){console.log("handleUploadDragSubmit",e),ge(!1),null==n||n.current.reload(),Qe()},handleCancel:function(){console.log("handleUploadDragCancel"),ge(!1),null==n||n.current.reload()}})]})},ze=function(){var e=(0,c.useIntl)(),t=(0,i.useMemo)((function(){return[{key:"faq",label:e.formatMessage({id:"pages.robot.kb.faq",defaultMessage:"Q&A"}),children:(0,C.jsx)(De,{})}]}),[e]);return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(l.Z,{items:t})})},Ae=a.Z.Sider,Be=a.Z.Content,He=function(){var e=(0,r.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,C.jsx)("div",{children:(0,C.jsxs)(a.Z,{children:[(0,C.jsx)(Ae,{style:t,children:(0,C.jsx)(s.Z,{type:o.QPQ})}),(0,C.jsx)(a.Z,{children:(0,C.jsx)(Be,{style:n,children:(0,C.jsx)(ze,{})})})]})})}},32943:function(e,t,n){n.d(t,{Z:function(){return $}});var r=n(44194),a=n(58644),o=n(92520),s=n(14377),i=n(64985),l=n(18701),c=n(51865),u=n.n(c),d=n(77588),f=n(67762),p=n(34221),g=n(79145),m=n(37167),h=n(47825),v=n(88874),b=n(65759);const x=(e,t,n,r,a)=>({background:e,border:`${(0,h.bf)(r.lineWidth)} ${r.lineType} ${t}`,[`${a}-icon`]:{color:n}}),y=e=>{const{componentCls:t,motionDurationSlow:n,marginXS:r,marginSM:a,fontSize:o,fontSizeLG:s,lineHeight:i,borderRadiusLG:l,motionEaseInOutCirc:c,withDescriptionIconSize:u,colorText:d,colorTextHeading:f,withDescriptionPadding:p,defaultPadding:g}=e;return{[t]:Object.assign(Object.assign({},(0,v.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:g,wordWrap:"break-word",borderRadius:l,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:o,lineHeight:i},"&-message":{color:f},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${c}, opacity ${n} ${c},\n        padding-top ${n} ${c}, padding-bottom ${n} ${c},\n        margin-bottom ${n} ${c}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${t}-with-description`]:{alignItems:"flex-start",padding:p,[`${t}-icon`]:{marginInlineEnd:a,fontSize:u,lineHeight:0},[`${t}-message`]:{display:"block",marginBottom:r,color:f,fontSize:s},[`${t}-description`]:{display:"block",color:d}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},w=e=>{const{componentCls:t,colorSuccess:n,colorSuccessBorder:r,colorSuccessBg:a,colorWarning:o,colorWarningBorder:s,colorWarningBg:i,colorError:l,colorErrorBorder:c,colorErrorBg:u,colorInfo:d,colorInfoBorder:f,colorInfoBg:p}=e;return{[t]:{"&-success":x(a,r,n,e,t),"&-info":x(p,f,d,e,t),"&-warning":x(i,s,o,e,t),"&-error":Object.assign(Object.assign({},x(u,c,l,e,t)),{[`${t}-description > pre`]:{margin:0,padding:0}})}}},M=e=>{const{componentCls:t,iconCls:n,motionDurationMid:r,marginXS:a,fontSizeIcon:o,colorIcon:s,colorIconHover:i}=e;return{[t]:{"&-action":{marginInlineStart:a},[`${t}-close-icon`]:{marginInlineStart:a,padding:0,overflow:"hidden",fontSize:o,lineHeight:(0,h.bf)(o),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:s,transition:`color ${r}`,"&:hover":{color:i}}},"&-close-text":{color:s,transition:`color ${r}`,"&:hover":{color:i}}}}};var k=(0,b.I$)("Alert",(e=>[y(e),w(e),M(e)]),(e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}))),j=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const Z={success:a.Z,info:l.Z,error:o.Z,warning:i.Z},C=e=>{const{icon:t,prefixCls:n,type:a}=e,o=Z[a]||null;return t?(0,g.wm)(t,r.createElement("span",{className:`${n}-icon`},t),(()=>({className:u()(`${n}-icon`,t.props.className)}))):r.createElement(o,{className:`${n}-icon`})},S=e=>{const{isClosable:t,prefixCls:n,closeIcon:a,handleClose:o,ariaProps:i}=e,l=!0===a||void 0===a?r.createElement(s.Z,null):a;return t?r.createElement("button",Object.assign({type:"button",onClick:o,className:`${n}-close-icon`,tabIndex:0},i),l):null},P=r.forwardRef(((e,t)=>{const{description:n,prefixCls:a,message:o,banner:s,className:i,rootClassName:l,style:c,onMouseEnter:g,onMouseLeave:h,onClick:v,afterClose:b,showIcon:x,closable:y,closeText:w,closeIcon:M,action:Z,id:P}=e,E=j(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[q,F]=r.useState(!1);const I=r.useRef(null);r.useImperativeHandle(t,(()=>({nativeElement:I.current})));const{getPrefixCls:T,direction:L,alert:U}=r.useContext(m.E_),O=T("alert",a),[$,R,D]=k(O),z=t=>{var n;F(!0),null===(n=e.onClose)||void 0===n||n.call(e,t)},A=r.useMemo((()=>void 0!==e.type?e.type:s?"warning":"info"),[e.type,s]),B=r.useMemo((()=>!("object"!=typeof y||!y.closeIcon)||(!!w||("boolean"==typeof y?y:!1!==M&&null!=M||!!(null==U?void 0:U.closable)))),[w,M,y,null==U?void 0:U.closable]),H=!(!s||void 0!==x)||x,N=u()(O,`${O}-${A}`,{[`${O}-with-description`]:!!n,[`${O}-no-icon`]:!H,[`${O}-banner`]:!!s,[`${O}-rtl`]:"rtl"===L},null==U?void 0:U.className,i,l,D,R),V=(0,f.Z)(E,{aria:!0,data:!0}),Y=r.useMemo((()=>{var e,t;return"object"==typeof y&&y.closeIcon?y.closeIcon:w||(void 0!==M?M:"object"==typeof(null==U?void 0:U.closable)&&(null===(e=null==U?void 0:U.closable)||void 0===e?void 0:e.closeIcon)?null===(t=null==U?void 0:U.closable)||void 0===t?void 0:t.closeIcon:null==U?void 0:U.closeIcon)}),[M,y,w,null==U?void 0:U.closeIcon]),G=r.useMemo((()=>{const e=null!=y?y:null==U?void 0:U.closable;if("object"==typeof e){const{closeIcon:t}=e;return j(e,["closeIcon"])}return{}}),[y,null==U?void 0:U.closable]);return $(r.createElement(d.ZP,{visible:!q,motionName:`${O}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:b},((t,a)=>{let{className:s,style:i}=t;return r.createElement("div",Object.assign({id:P,ref:(0,p.sQ)(I,a),"data-show":!q,className:u()(N,s),style:Object.assign(Object.assign(Object.assign({},null==U?void 0:U.style),c),i),onMouseEnter:g,onMouseLeave:h,onClick:v,role:"alert"},V),H?r.createElement(C,{description:n,icon:e.icon,prefixCls:O,type:A}):null,r.createElement("div",{className:`${O}-content`},o?r.createElement("div",{className:`${O}-message`},o):null,n?r.createElement("div",{className:`${O}-description`},n):null),Z?r.createElement("div",{className:`${O}-action`},Z):null,r.createElement(S,{isClosable:B,prefixCls:O,closeIcon:Y,handleClose:z,ariaProps:G}))})))}));var E=P,q=n(74592),F=n(32099),I=n(67019),T=n(14755);let L=function(e){function t(){var e;return(0,q.Z)(this,t),(e=(0,I.Z)(this,t,arguments)).state={error:void 0,info:{componentStack:""}},e}return(0,T.Z)(t,e),(0,F.Z)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){const{message:e,description:t,id:n,children:a}=this.props,{error:o,info:s}=this.state,i=(null==s?void 0:s.componentStack)||null,l=void 0===e?(o||"").toString():e,c=void 0===t?i:t;return o?r.createElement(E,{id:n,type:"error",message:l,description:r.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},c)}):a}}])}(r.Component);var U=L;const O=E;O.ErrorBoundary=U;var $=O},27487:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(44194),a=n(51865),o=n.n(a),s=n(97859),i=n(90899),l=n(37167),c=n(65759),u=n(77167);const d=["wrap","nowrap","wrap-reverse"],f=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],p=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"];var g=function(e,t){return o()(Object.assign(Object.assign(Object.assign({},((e,t)=>{const n=!0===t.wrap?"wrap":t.wrap;return{[`${e}-wrap-${n}`]:n&&d.includes(n)}})(e,t)),((e,t)=>{const n={};return p.forEach((r=>{n[`${e}-align-${r}`]=t.align===r})),n[`${e}-align-stretch`]=!t.align&&!!t.vertical,n})(e,t)),((e,t)=>{const n={};return f.forEach((r=>{n[`${e}-justify-${r}`]=t.justify===r})),n})(e,t)))};const m=e=>{const{componentCls:t}=e;return{[t]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},h=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},v=e=>{const{componentCls:t}=e,n={};return d.forEach((e=>{n[`${t}-wrap-${e}`]={flexWrap:e}})),n},b=e=>{const{componentCls:t}=e,n={};return p.forEach((e=>{n[`${t}-align-${e}`]={alignItems:e}})),n},x=e=>{const{componentCls:t}=e,n={};return f.forEach((e=>{n[`${t}-justify-${e}`]={justifyContent:e}})),n};var y=(0,c.I$)("Flex",(e=>{const{paddingXS:t,padding:n,paddingLG:r}=e,a=(0,u.IX)(e,{flexGapSM:t,flexGap:n,flexGapLG:r});return[m(a),h(a),v(a),b(a),x(a)]}),(()=>({})),{resetStyle:!1}),w=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const M=r.forwardRef(((e,t)=>{const{prefixCls:n,rootClassName:a,className:c,style:u,flex:d,gap:f,children:p,vertical:m=!1,component:h="div"}=e,v=w(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:b,direction:x,getPrefixCls:M}=r.useContext(l.E_),k=M("flex",n),[j,Z,C]=y(k),S=null!=m?m:null==b?void 0:b.vertical,P=o()(c,a,null==b?void 0:b.className,k,Z,C,g(k,e),{[`${k}-rtl`]:"rtl"===x,[`${k}-gap-${f}`]:(0,i.n)(f),[`${k}-vertical`]:S}),E=Object.assign(Object.assign({},null==b?void 0:b.style),u);return d&&(E.flex=d),f&&!(0,i.n)(f)&&(E.gap=f),j(r.createElement(h,Object.assign({ref:t,className:P,style:E},(0,s.Z)(v,["justify","wrap","align"])),p))}));var k=M},67019:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(42885),a=n(19567),o=n(27842);function s(e,t,n){return t=(0,r.Z)(t),(0,o.Z)(e,(0,a.Z)()?Reflect.construct(t,n||[],(0,r.Z)(e).constructor):t.apply(e,n))}}}]);