"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2522],{82863:function(e,t,n){n.d(t,{Jr:function(){return p},LF:function(){return d},Oh:function(){return h},WS:function(){return g}});var r=n(90819),o=n.n(r),a=n(73193),s=n.n(a),i=n(89933),u=n.n(i),l=n(55735),c=n(30921);function d(e){return f.apply(this,arguments)}function f(){return(f=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/model/query/org",{method:"GET",params:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/model/create",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/model/update",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/model/delete",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},36605:function(e,t,n){n.d(t,{HH:function(){return h},T:function(){return p},fx:function(){return g},mK:function(){return d}});var r=n(90819),o=n.n(r),a=n(73193),s=n.n(a),i=n(89933),u=n.n(i),l=n(55735),c=n(30921);function d(e){return f.apply(this,arguments)}function f(){return(f=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/query/org",{method:"GET",params:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/create",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/update",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/provider/delete",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},92053:function(e,t,n){n.d(t,{G9:function(){return w},N6:function(){return b},VM:function(){return l},c8:function(){return d},gF:function(){return g},rg:function(){return p},sF:function(){return h}});var r=n(90819),o=n.n(r),a=n(89933),s=n.n(a),i=n(55735),u=n(30921);function l(){return c.apply(this,arguments)}function c(){return(c=s()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/ollama4j/ping",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return f.apply(this,arguments)}function f(){return(f=s()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/ollama4j/local-models",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return m.apply(this,arguments)}function m(){return(m=s()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/ollama4j/models",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=s()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/ollama4j/library/models/"+t+"/details",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=s()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/ollama4j/models/"+t+"/details",{method:"GET",params:{client:i.bVn}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=s()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/ollama4j/models/pull",{method:"POST",params:{client:i.bVn},data:{model:t}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return C.apply(this,arguments)}function C(){return(C=s()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/ollama4j/models/delete",{method:"POST",params:{client:i.bVn},data:{model:t}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},27522:function(e,t,n){n.d(t,{AP:function(){return d},_J:function(){return h},t5:function(){return g},v_:function(){return p}});var r=n(90819),o=n.n(r),a=n(73193),s=n.n(a),i=n(89933),u=n.n(i),l=n(55735),c=n(30921);function d(e){return f.apply(this,arguments)}function f(){return(f=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/query/org",{method:"GET",params:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/create",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/update",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=u()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/kbase/delete",{method:"POST",data:s()(s()({},t),{},{client:l.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},91903:function(e,t,n){n.r(t),n.d(t,{default:function(){return Le}});var r=n(75574),o=n(44194),a=n(90819),s=n.n(a),i=n(89933),u=n.n(i),l=n(45332),c=n.n(l),d=n(66310),f=n(53530),p=n(27487),m=n(75365),g=n(9452),v=n(84288),h=n(15722),x=n(82669),b=n(30921),y=n(23864),w=n(40612),C=n(55735),M=n(69169),j=n(4499),k=n(84881),q=n(31549),Z=function(e){var t=e.open,n=e.onClose,r=e.onSubmit,a=(0,b.useIntl)(),s=M.A.useForm(),i=c()(s,1)[0],u=(0,w.u)((function(e){return e.currentOrg})),l=function(){console.log("handleSaveRobot"),i.validateFields().then((function(e){console.log("handleSaveRobot values:",e);var t={name:e.nickname,nickname:e.nickname,type:e.type,serviceSettings:{showQuickFaqs:!1,quickFaqs:[],showFaqs:!1,faqs:[],showGuessFaqs:!1,guessFaqs:[],showHotFaqs:!1,hotFaqs:[],showShortcutFaqs:!1,shortcutFaqs:[]},orgUid:null==u?void 0:u.uid};console.log("robotObject:",t),r(t)})).catch((function(e){console.log("Form errors:",e)}))};return(0,o.useEffect)((function(){console.log("RobotForm useEffect"),i.setFieldsValue({type:C.f4h})}),[]),(0,q.jsx)("div",{children:(0,q.jsx)(f.Z,{title:a.formatMessage({id:"pages.robot.new",defaultMessage:"New"}),open:t,forceRender:!0,okText:a.formatMessage({id:"save",defaultMessage:"Save"}),onOk:l,onCancel:function(){n()},children:(0,q.jsxs)(M.A,{form:i,name:"basic",style:{maxWidth:400},submitter:!1,children:[(0,q.jsx)(j.Z,{label:a.formatMessage({id:"nickname",defaultMessage:"Nickname"}),name:"nickname",rules:[{required:!0,message:a.formatMessage({id:"nickname",defaultMessage:"Nickname"})}],fieldProps:{onPressEnter:function(){return l()}}}),(0,q.jsx)(k.Z,{label:a.formatMessage({id:"type",defaultMessage:"Type"}),name:["type"],options:[{label:a.formatMessage({id:C.f4h,defaultMessage:"Service"}),value:C.f4h}],rules:[{required:!0,message:a.formatMessage({id:"choose",defaultMessage:"Choose"})}],fieldProps:{placeholder:a.formatMessage({id:"choose",defaultMessage:"Choose"}),onChange:function(e){console.log("onTreeSelectChange:",e)},allowClear:!0}})]})})})},S=n(66916),F=n(86803),T=n(76750),R=function(){var e=(0,y.Z)().isDarkMode,t=(0,b.useIntl)(),n=((0,o.useRef)(!1),(0,T.Z)()),r=n.translateString,a=n.translateStringTranct,i=(0,d.V)((function(e){return{robotResult:e.robotResult,currentRobot:e.currentRobot,insertRobot:e.insertRobot,deleteCurrentRobot:e.deleteCurrentRobot,setRobotResult:e.setRobotResult,setCurrentRobot:e.setCurrentRobot}})),l=i.robotResult,M=i.currentRobot,j=i.insertRobot,k=i.deleteCurrentRobot,R=i.setRobotResult,P=i.setCurrentRobot,V=(0,w.u)((function(e){return e.currentOrg})),U=f.Z.useModal(),A=c()(U,2),O=A[0],L=A[1],E=function(){var e=u()(s()().mark((function e(n){var r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("delete robot",n),F.yw.loading(t.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=4,(0,S.gf)(n);case 4:r=e.sent,console.log("delete robot response",r),200===r.code?(F.yw.destroy(),F.yw.success(t.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),k(n.uid)):(F.yw.destroy(),F.yw.error(r.message));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=u()(s()().mark((function e(){var t,n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F.yw.loading("loading"),t={pageNumber:0,pageSize:100,categoryUid:"",level:C.whQ,type:C.f4h,orgUid:null==V?void 0:V.uid},e.next=4,(0,S.p0)(t);case 4:n=e.sent,console.log("queryRobotsByOrg: ",n,t),200===n.code?(F.yw.destroy(),R(n),!M&&n.data.content.length>0&&P(n.data.content[0])):(F.yw.destroy(),F.yw.error(n.message));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){I()}),[]);var N=(0,o.useState)(!1),z=c()(N,2),W=z[0],B=z[1],G=function(){var e=u()(s()().mark((function e(n){var r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F.yw.loading(t.formatMessage({id:"creating",defaultMessage:"Creating"})),e.next=3,(0,S.lg)(n);case 3:r=e.sent,console.log("handleSaveRobot response:",r),200===r.code?(F.yw.destroy(),F.yw.success(t.formatMessage({id:"create.success"})),j(r.data),B(!1)):(F.yw.destroy(),B(!1),F.yw.error(r.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){return t.formatMessage({id:null==e?void 0:e.type,defaultMessage:null==e?void 0:e.type})};return(0,q.jsxs)("div",{children:[(0,q.jsx)("div",{style:{margin:10},children:(0,q.jsxs)(p.Z,{gap:"small",align:"flex-start",children:[(0,q.jsx)(m.ZP,{size:"small",type:"primary",icon:(0,q.jsx)(x.Z,{}),onClick:function(){B(!0)},children:t.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,q.jsx)(m.ZP,{size:"small",onClick:I,children:t.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,q.jsx)(m.ZP,{onClick:function(){return function(e){O.confirm({title:t.formatMessage({id:"deleteTip"}),icon:(0,q.jsx)(h.Z,{}),content:"".concat(t.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(r(e.nickname),"】？"),onOk:function(){E(e)},onCancel:function(){},okText:t.formatMessage({id:"ok"}),cancelText:t.formatMessage({id:"cancel"})})}(M)},size:"small",style:{float:"right"},danger:!0,disabled:""===(null==M?void 0:M.uid),children:t.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]})}),(0,q.jsx)(g.Z,{itemLayout:"horizontal",dataSource:l.data.content,renderItem:function(t,n){return(0,q.jsx)(g.Z.Item,{style:(null==M?void 0:M.uid)===t.uid?{backgroundColor:e?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){P(t)},children:(0,q.jsx)(g.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,q.jsx)(v.C,{src:t.avatar}),title:(0,q.jsx)(q.Fragment,{children:a(null==t?void 0:t.nickname)}),description:Q(t)})})}}),W&&(0,q.jsx)(Z,{open:W,onClose:function(){B(!1)},onSubmit:G}),L]})},P=n(8247),V=n(80690),U=n(73193),A=n.n(U),O=n(6631),L=n(59908),E=n(32350),I=n(57178),N=(n(26286),function(){var e,t=M.A.useForm(),n=c()(t,1)[0],r=(0,b.useIntl)(),a=(0,T.Z)().translateString,i=(0,d.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),l=i.currentRobot,f=i.setCurrentRobot,p=(0,o.useState)(""),g=c()(p,2),h=g[0],x=g[1],y=(0,o.useState)(a(null==l||null===(e=l.serviceSettings)||void 0===e?void 0:e.welcomeTip)||""),w=c()(y,2),C=w[0],k=w[1];(0,o.useEffect)((function(){var e;l&&(n.setFieldValue("nickname",a(null==l?void 0:l.nickname)),k(a(null==l||null===(e=l.serviceSettings)||void 0===e?void 0:e.welcomeTip)),n.setFieldValue("description",a(null==l?void 0:l.description)))}),[l]);var Z=function(){var e=u()(s()().mark((function e(t){var n,o,a,i,u,c,d,p;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish:",t),F.yw.loading(r.formatMessage({id:"updating"})),d=A()(A()({},l),{},{serviceSettings:A()(A()({},l.serviceSettings),{},{welcomeTip:C,welcomeFaqUids:null==l||null===(n=l.serviceSettings)||void 0===n||null===(n=n.welcomeFaqs)||void 0===n?void 0:n.map((function(e){return e.uid})),quickFaqUids:null==l||null===(o=l.serviceSettings)||void 0===o||null===(o=o.quickFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),faqUids:null==l||null===(a=l.serviceSettings)||void 0===a||null===(a=a.faqs)||void 0===a?void 0:a.map((function(e){return e.uid})),guessFaqUids:null==l||null===(i=l.serviceSettings)||void 0===i||null===(i=i.guessFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),hotFaqUids:null==l||null===(u=l.serviceSettings)||void 0===u||null===(u=u.hotFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),shortcutFaqUids:null==l||null===(c=l.serviceSettings)||void 0===c||null===(c=c.shortcutFaqs)||void 0===c?void 0:c.map((function(e){return e.uid}))}),nickname:t.nickname,description:t.description,avatar:h}),console.log("robotObject:",d),e.next=6,(0,S.$l)(d);case 6:p=e.sent,console.log("updateRobot response:",p),200===p.code?(F.yw.success(r.formatMessage({id:"update.success"})),f(p.data)):F.yw.error(p.message),F.yw.destroy();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=u()(s()().mark((function e(t){var n,o;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleUploadSuccess:",t),x(t),n=A()(A()({},l),{},{avatar:t}),e.next=5,(0,S.n1)(n);case 5:o=e.sent,console.log("updateAvatar response:",o),200===o.code?(F.yw.success(r.formatMessage({id:"update.success"})),f(o.data)):F.yw.error(o.message);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){x(null==l?void 0:l.avatar)}),[l]),(0,q.jsxs)(M.A,{form:n,style:{marginLeft:"20px"},onFinish:Z,children:[(0,q.jsx)(I.Z.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:null==e?void 0:e.fileList},label:r.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,q.jsxs)(O.G,{onSuccess:R,onError:function(e){console.log("handleUploadError:",e)},children:[(0,q.jsx)(v.C,{src:h}),(0,q.jsx)(m.ZP,{icon:(0,q.jsx)(L.Z,{}),children:r.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,q.jsx)(j.Z,{width:"md",name:"nickname",label:r.formatMessage({id:"agent.info.nickname"}),rules:[{required:!0,message:r.formatMessage({id:"agent.info.nickname.required"})}]}),(0,q.jsx)(E.Z,{width:"md",name:"description",label:r.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),tooltip:r.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),placeholder:r.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),rules:[{required:!0,message:r.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"})}]})]})}),z=n(27522),W=n(5651),B=function(){var e=(0,b.useIntl)(),t=(0,b.useNavigate)(),n=M.A.useForm(),r=c()(n,1)[0],a=(0,T.Z)().translateString,i=(0,o.useState)(),l=c()(i,2),f=l[0],p=l[1],g=(0,w.u)((function(e){return e.currentOrg})),v=(0,d.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),h=v.currentRobot,x=v.setCurrentRobot,y=function(){var t=u()(s()().mark((function t(){var n,r;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return F.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:50,type:C.QPQ,orgUid:null==g?void 0:g.uid},t.next=4,(0,z.AP)(n);case 4:r=t.sent,console.log("getKeywordBase response:",n,r),F.yw.destroy(),200===r.code?p(r):F.yw.error(r.message);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,o.useEffect)((function(){y()}),[]),(0,o.useEffect)((function(){r.setFieldValue("kbUid",null==h?void 0:h.kbUid)}),[h]);var j=function(){var t=u()(s()().mark((function t(n){var r,o,a,i,u,l,c;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onFinish values:",n),l=A()(A()({},h),{},{serviceSettings:A()(A()({},h.serviceSettings),{},{faqUids:null==h||null===(r=h.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),quickFaqUids:null==h||null===(o=h.serviceSettings)||void 0===o||null===(o=o.quickFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),guessFaqUids:null==h||null===(a=h.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),hotFaqUids:null==h||null===(i=h.serviceSettings)||void 0===i||null===(i=i.hotFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),shortcutFaqUids:null==h||null===(u=h.serviceSettings)||void 0===u||null===(u=u.shortcutFaqs)||void 0===u?void 0:u.map((function(e){return e.uid}))}),kbUid:n.kbUid}),console.log("robotObject:",l),t.next=5,(0,S.$l)(l);case 5:c=t.sent,console.log("updateRobot response:",c),200===c.code?(F.yw.destroy(),F.yw.success(e.formatMessage({id:"update.success"})),x(c.data)):(F.yw.destroy(),F.yw.error(c.message));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,q.jsx)("div",{children:(0,q.jsxs)(M.A,{form:r,onFinish:j,children:[(0,q.jsx)(k.Z,{width:"md",name:"kbUid",label:"知识库",options:null==f?void 0:f.data.content.map((function(e){return{value:e.uid,label:a(e.name)}})),fieldProps:{onChange:function(e){console.log("kbUid:",e)}}}),(0,q.jsx)(M.A.Item,{children:(0,q.jsx)(m.ZP,{icon:(0,q.jsx)(W.Z,{}),onClick:function(){t("/kb/llm/data")},children:"添加大模型知识库"},"github")})]})})},G=n(43705),Q=n(71469),_=n(50796),K=n(10154),X=n.n(K),D=n(36605),H=n(82863),J=n(48708),$=n(79907),Y=n(32327),ee=n(62673),te=n(92053),ne=n(88721),re=n(40269),oe=n(3849),ae=n(73442),se=Y.Z.Text,ie=o.memo((function(e){var t,n=e.visible,r=e.onCancel,a=e.onOk,i=e.initialProvider,l=e.initialModel,d=e.initialModelLabel,f=e.providers,p=e.currentOrgUid,g=e.existingProviderModels,v=void 0===g?{}:g,h=e.onModelsLoaded,x=e.allowedModelTypes,y=void 0===x?[]:x,w=(0,b.useIntl)(),M=(0,T.Z)().translateString,j=(0,o.useState)(i||""),k=c()(j,2),Z=k[0],S=k[1],R=(0,o.useState)(v),V=c()(R,2),U=V[0],O=V[1],L=(0,o.useState)(i||""),E=c()(L,2),I=E[0],N=E[1],z=(0,o.useState)(l||""),W=c()(z,2),B=W[0],G=W[1],Q=(0,o.useState)(d||""),_=c()(Q,2),K=_[0],D=_[1],J=(0,o.useState)(!1),$=c()(J,2),ie=$[0],ue=$[1];(0,o.useEffect)((function(){N(i),G(l),D(d),S(i)}),[i,l,d,n]),(0,o.useEffect)((function(){if(n&&Z&&!U[Z]&&!ie){ue(!0),F.yw.loading({content:w.formatMessage({id:"loading"}),key:"modelLoading"});var e=f.find((function(e){return e.name===Z}));e&&("ollama"===e.name?de():pe(e))}}),[n,Z,f]);var le=(0,o.useCallback)((function(){I&&B&&a(I,B,K)}),[I,B,K,a]),ce=(0,o.useCallback)((function(e){return y&&0!==y.length?e.filter((function(e){return!e.type||y.includes(e.type)})):e}),[y]),de=function(){var e=u()(s()().mark((function e(){var t;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,te.VM)();case 3:200===(t=e.sent).code&&t.data?fe():(F.yw.error(t.message),F.yw.destroy("modelLoading"),ue(!1)),e.next=13;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to check Ollama status:",e.t0),F.yw.error(w.formatMessage({id:"error"})),F.yw.destroy("modelLoading"),ue(!1);case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=u()(s()().mark((function e(){var t,n,r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,te.c8)();case 3:200===(t=e.sent).code?(n=t.data.map((function(e){return{value:e.name,label:e.name,providerName:"ollama"}})),r=ce(n),O((function(e){return A()(A()({},e),{},{ollama:r})})),h&&h("ollama",r)):F.yw.error(t.message),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to fetch local models:",e.t0),F.yw.error(w.formatMessage({id:"error"}));case 11:return e.prev=11,F.yw.destroy("modelLoading"),ue(!1),e.finish(11);case 15:case"end":return e.stop()}}),e,null,[[0,7,11,15]])})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=u()(s()().mark((function e(t){var n,r,o,a;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={pageNumber:0,pageSize:50,providerUid:null==t?void 0:t.uid,orgUid:p,level:C.whQ},e.next=4,(0,H.LF)(n);case 4:200===(r=e.sent).code?(o=r.data.content.map((function(e){return{value:e.name,label:e.nickname,description:e.description,type:e.type,providerName:t.name}})),a=ce(o),O((function(e){return A()(A()({},e),{},X()({},t.name,a))})),h&&h(t.name,a)):F.yw.error(r.message),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch models:",e.t0),F.yw.error(w.formatMessage({id:"error"}));case 12:return e.prev=12,F.yw.destroy("modelLoading"),ue(!1),e.finish(12);case 16:case"end":return e.stop()}}),e,null,[[0,8,12,16]])})));return function(t){return e.apply(this,arguments)}}(),me=(0,o.useCallback)((function(e,t){N(e),G(t.value),D(t.label)}),[]),ge=(0,o.useCallback)((function(e){if(S(e),!U[e]&&!ie){ue(!0),F.yw.loading({content:w.formatMessage({id:"loading"}),key:"modelLoading"});var t=f.find((function(t){return t.name===e}));t&&("ollama"===t.name?de():pe(t))}}),[f,U,ie]),ve=o.memo((function(e){var t=e.model,n=e.providerName;return(0,q.jsxs)(ee.Z,{hoverable:!0,style:{cursor:"pointer",border:B===t.value&&I===n?"2px solid #1890ff":"1px solid #e8e8e8"},onClick:function(){return me(n,t)},children:[(0,q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,q.jsx)(Y.Z.Title,{level:5,style:{margin:0},children:t.label}),(0,q.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[t.type&&(0,q.jsx)("div",{style:{marginBottom:8},children:(0,ne.Rb)(t.type)}),B===t.value&&I===n&&(0,q.jsx)(re.Z,{status:"processing",text:"已选"})]})]}),t.description&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Y.Z.Text,{type:"secondary",children:null==t?void 0:t.value}),(0,q.jsx)(Y.Z.Paragraph,{ellipsis:{rows:2},type:"secondary",style:{marginTop:8},children:t.description})]})]},t.value)}),(function(e,t){return e.model.value===t.model.value&&e.providerName===t.providerName&&(B===e.model.value&&I===e.providerName)===(B===t.model.value&&I===t.providerName)})),he=(0,o.useMemo)((function(){return f.map((function(e){var t,n;return{key:e.name,label:M(e.nickname),children:(0,q.jsx)("div",{style:{minHeight:"400px",width:"100%"},children:(0,q.jsxs)(oe.Z,{direction:"vertical",style:{width:"100%"},children:[ie&&Z===e.name&&!U[e.name]?(0,q.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,q.jsx)(se,{type:"secondary",children:"加载模型中..."})}):(!U[e.name]||0===(null===(t=U[e.name])||void 0===t?void 0:t.length))&&(0,q.jsx)(se,{type:"secondary",children:"暂无可用模型"}),(0,q.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px"},children:null===(n=U[e.name])||void 0===n?void 0:n.map((function(t){return(0,q.jsx)(ve,{model:t,providerName:e.name},t.value)}))})]})})}}))}),[f,U,Z,ie,B,I,M]);return(0,q.jsx)(ae.Z,{title:"选择AI模型",open:n,onClose:r,width:700,destroyOnClose:!1,footer:(0,q.jsxs)("div",{style:{textAlign:"right"},children:[(0,q.jsx)(m.ZP,{onClick:r,style:{marginRight:8},children:"取消"}),(0,q.jsx)(m.ZP,{onClick:le,type:"primary",children:"确定"})]}),children:f.length>0&&(0,q.jsx)(P.Z,{activeKey:Z||(null===(t=f[0])||void 0===t?void 0:t.name),onChange:ge,items:he,destroyInactiveTabPane:!1})})}),(function(e,t){return e.visible===t.visible&&e.initialProvider===t.initialProvider&&e.initialModel===t.initialModel&&e.initialModelLabel===t.initialModelLabel})),ue=ie,le=(Y.Z.Text,function(){var e,t=(0,b.useIntl)(),n=M.A.useForm(),r=c()(n,1)[0],a=(0,T.Z)().translateString,i=(0,w.u)((function(e){return e.currentOrg})),l=(0,o.useState)([]),f=c()(l,2),p=f[0],g=f[1],v=(0,o.useState)({}),h=c()(v,2),x=h[0],y=h[1],j=(0,o.useState)(!1),Z=c()(j,2),R=Z[0],P=Z[1],V=(0,o.useState)(""),U=c()(V,2),O=U[0],L=U[1],I=(0,o.useState)(""),N=c()(I,2),z=N[0],W=N[1],B=(0,o.useState)(""),G=c()(B,2),Q=G[0],_=G[1],K=(0,d.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),ne=K.currentRobot,re=K.setCurrentRobot;(0,o.useEffect)((function(){var e,t,n,o,s,i,u,l,c,d;r.setFieldValue("enabled",null==ne||null===(e=ne.llm)||void 0===e?void 0:e.enabled),r.setFieldValue("topK",null==ne||null===(t=ne.llm)||void 0===t?void 0:t.topK),r.setFieldValue("scoreThreshold",null==ne||null===(n=ne.llm)||void 0===n?void 0:n.scoreThreshold),r.setFieldValue("provider",null==ne||null===(o=ne.llm)||void 0===o?void 0:o.provider),r.setFieldValue("model",null==ne||null===(s=ne.llm)||void 0===s?void 0:s.model),r.setFieldValue("temperature",null==ne||null===(i=ne.llm)||void 0===i?void 0:i.temperature),r.setFieldValue("prompt",a(null==ne||null===(u=ne.llm)||void 0===u?void 0:u.prompt)),r.setFieldValue("contextMsgCount",null==ne||null===(l=ne.llm)||void 0===l?void 0:l.contextMsgCount);var f=(null==ne||null===(c=ne.llm)||void 0===c?void 0:c.provider)||"",p=(null==ne||null===(d=ne.llm)||void 0===d?void 0:d.model)||"";L(f),W(p),p&&!Q&&_(p)}),[ne]),(0,o.useEffect)((function(){var e=O,t=z;if(e&&t&&x[e]){var n=x[e].find((function(e){return e.value===t}));n&&_(n.label)}}),[x,O,z]);var oe=function(){var e=u()(s()().mark((function e(){var t,n,r,o,a,u;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={pageNumber:0,pageSize:100,orgUid:null==i?void 0:i.uid,level:C.whQ},e.next=4,(0,D.mK)(t);case 4:n=e.sent,console.log("queryLlmProvidersByOrg: ",n.data,t),200===n.code?(o=n.data.content||[],g(o),(a=null==ne||null===(r=ne.llm)||void 0===r?void 0:r.provider)&&(u=o.find((function(e){return e.name===a})))&&("ollama"===u.name?fe():me(u))):F.yw.error(n.message),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to fetch providers:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){oe()}),[]);var ae=(0,o.useCallback)((function(){P(!0)}),[]),se=(0,o.useCallback)((function(){P(!1)}),[]),ie=(0,o.useCallback)((function(e,t,n){L(e),W(t),_(n),r.setFieldValue("provider",e),r.setFieldValue("model",t),P(!1),r.submit()}),[r]),le=(0,o.useCallback)((function(e,t){y((function(n){return A()(A()({},n),{},X()({},e,t))}))}),[]),ce=function(){var e=u()(s()().mark((function e(n){var r,o,a,i,u,l,c,d;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F.yw.loading(t.formatMessage({id:"updating"})),c=A()(A()({},ne),{},{serviceSettings:A()(A()({},ne.serviceSettings),{},{welcomeFaqUids:null==ne||null===(r=ne.serviceSettings)||void 0===r||null===(r=r.welcomeFaqs)||void 0===r?void 0:r.map((function(e){return e.uid})),faqUids:null===(o=ne.serviceSettings)||void 0===o||null===(o=o.faqs)||void 0===o?void 0:o.map((function(e){return e.uid})),quickFaqUids:null==ne||null===(a=ne.serviceSettings)||void 0===a||null===(a=a.quickFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),guessFaqUids:null==ne||null===(i=ne.serviceSettings)||void 0===i||null===(i=i.guessFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),hotFaqUids:null==ne||null===(u=ne.serviceSettings)||void 0===u||null===(u=u.hotFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),shortcutFaqUids:null==ne||null===(l=ne.serviceSettings)||void 0===l||null===(l=l.shortcutFaqs)||void 0===l?void 0:l.map((function(e){return e.uid}))}),llm:A()(A()({},ne.llm),{},{enabled:n.enabled,topK:n.topK,scoreThreshold:n.scoreThreshold,provider:n.provider,model:n.model,temperature:n.temperature,prompt:n.prompt,contextMsgCount:n.contextMsgCount})}),e.next=4,(0,S.$l)(c);case 4:200===(d=e.sent).code?(F.yw.destroy(),F.yw.success(t.formatMessage({id:"update.success"})),re(d.data)):(F.yw.destroy(),F.yw.error(d.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=(0,o.useCallback)((function(e,t){return[(0,q.jsx)(m.ZP,{type:"default",onClick:function(){var t;null===(t=e.form)||void 0===t||t.resetFields()},children:"重置"},"reset"),(0,q.jsx)(m.ZP,{type:"primary",onClick:function(){var t;null===(t=e.form)||void 0===t||t.submit()},children:"保存"},"submit")]}),[]),fe=function(){var e=u()(s()().mark((function e(){var n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,te.VM)();case 3:200===(n=e.sent).code&&n.data?pe():F.yw.error(n.message),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to check Ollama status:",e.t0),F.yw.error(t.formatMessage({id:"error"}));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=u()(s()().mark((function e(){var n,r,o;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,te.c8)();case 3:n=e.sent,console.log("getOllamaLocalModels: ",n.data),200===n.code?(r=n.data.map((function(e){return{value:e.name,label:e.name,providerName:"ollama"}})),y((function(e){return A()(A()({},e),{},{ollama:r})})),"ollama"===O&&z&&(o=r.find((function(e){return e.value===z})))&&_(o.label)):F.yw.error(n.message),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch local models:",e.t0),F.yw.error(t.formatMessage({id:"error"}));case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=u()(s()().mark((function e(n){var o,a,u,l;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={pageNumber:0,pageSize:50,providerName:null==n?void 0:n.name,orgUid:null==i?void 0:i.uid,level:C.whQ},e.next=4,(0,H.LF)(o);case 4:a=e.sent,console.log("queryLlmModelsByOrg: ",a.data,o),200===a.code?(u=a.data.content.map((function(e){return{value:e.name,label:e.nickname,description:e.description,providerName:n.name}})),y((function(e){return A()(A()({},e),{},X()({},n.name,u))})),n.name===r.getFieldValue("provider")&&z&&(l=u.find((function(e){return e.value===z})))&&_(l.label)):F.yw.error(a.message),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to fetch models:",e.t0),F.yw.error(t.formatMessage({id:"error"}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(M.A,{form:r,size:"large",submitter:{render:de,submitButtonProps:{size:"large",htmlType:"button"}},onFinish:ce,children:[(0,q.jsx)(J.Z,{width:"lg",name:"enabled",label:"启用大模型",tooltip:"启用大模型后，将会关闭关键词。用户在发送消息时，将会直接请求大模型。",fieldProps:{onChange:function(e){setTimeout((function(){r.submit()}),100)}}}),(0,q.jsx)(E.Z,{width:"lg",name:"prompt",label:"提示词",placeholder:"请输入提示词",rules:[{required:!0,message:"请输入提示词"}]}),(0,q.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,q.jsx)(Y.Z.Text,{strong:!0,style:{marginRight:"8px"},children:"AI 模型选择："}),(0,q.jsx)("div",{style:{display:"flex",alignItems:"center",marginTop:"8px"},children:(0,q.jsx)(ee.Z,{size:"small",style:{width:"100%",maxWidth:"500px",cursor:"pointer",border:"1px solid #d9d9d9"},onClick:ae,children:O&&z?(0,q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,q.jsxs)("div",{children:[(0,q.jsx)(Y.Z.Text,{type:"secondary",children:"供应商："}),(0,q.jsx)(Y.Z.Text,{strong:!0,children:a((null===(e=p.find((function(e){return e.name===O})))||void 0===e?void 0:e.nickname)||O)}),(0,q.jsx)("br",{}),(0,q.jsx)(Y.Z.Text,{type:"secondary",children:"模型："}),(0,q.jsx)(Y.Z.Text,{strong:!0,children:Q||z})]}),(0,q.jsx)(m.ZP,{type:"primary",children:"更换模型"})]}):(0,q.jsx)("div",{style:{textAlign:"center"},children:(0,q.jsx)(m.ZP,{type:"primary",children:"选择AI模型"})})})}),(0,q.jsxs)("div",{style:{display:"none"},children:[(0,q.jsx)(k.Z,{name:"provider",width:"lg"}),(0,q.jsx)(k.Z,{name:"model",width:"lg"})]})]}),(0,q.jsx)($.Z,{width:"lg",label:"温度",name:"temperature",min:0,max:1,fieldProps:{precision:1,step:.1},rules:[{required:!0,message:"请输入温度"}]}),(0,q.jsx)($.Z,{width:"lg",label:"上下文消息数",name:"contextMsgCount",min:0,max:10,fieldProps:{precision:0,step:1},rules:[{required:!0,message:"请输入上下文消息数"}]})]}),(0,q.jsx)(ue,{visible:R,onCancel:se,onOk:ie,initialProvider:O,initialModel:z,initialModelLabel:Q,providers:p,currentOrgUid:null==i?void 0:i.uid,existingProviderModels:x,onModelsLoaded:le,allowedModelTypes:[C.JiM]})]})}),ce=(n(40058),n(75808)),de=n(40836),fe=n(98473),pe=n(23635),me=function(){var e=(0,b.useIntl)(),t=(0,o.useMemo)((function(){return[{key:"kb",label:(0,q.jsx)(b.FormattedMessage,{id:"pages.robot.tab.kb",defaultMessage:"Knowledge Base"}),children:(0,q.jsx)(B,{})},{key:"faq",label:(0,q.jsx)(b.FormattedMessage,{id:"menu.kbase.faq",defaultMessage:"FAQ"}),children:(0,q.jsx)(G.Z,{type:C._X4})},{key:"quickFaqs",label:(0,q.jsx)(b.FormattedMessage,{id:"menu.kbase.quickbutton",defaultMessage:"Quick Button"}),children:(0,q.jsx)(Q.Z,{type:C._X4})},{key:"llm",label:(0,q.jsx)(b.FormattedMessage,{id:"llm",defaultMessage:"LLM"}),children:(0,q.jsx)(le,{})},{key:"rate",label:(0,q.jsx)(b.FormattedMessage,{id:"rate",defaultMessage:"Rate"}),children:(0,q.jsx)(pe.Z,{type:C._X4})},{key:"right",label:(0,q.jsx)(b.FormattedMessage,{id:"right",defaultMessage:"Right"}),children:(0,q.jsx)(de.Z,{type:C._X4})},{key:"popup",label:(0,q.jsx)(b.FormattedMessage,{id:"popup",defaultMessage:"Popup"}),children:(0,q.jsx)(ce.Z,{type:C._X4})},{key:"trigger",label:(0,q.jsx)(b.FormattedMessage,{id:"trigger",defaultMessage:"Trigger"}),children:(0,q.jsx)(fe.Z,{type:C._X4})},{key:"inputassociation",label:(0,q.jsx)(b.FormattedMessage,{id:"inputassociation",defaultMessage:"Input Association"}),children:(0,q.jsx)(_.Z,{type:C._X4})}]}),[e]);return(0,q.jsx)(P.Z,{tabPosition:"left",items:t})},ge=n(14238),ve=n(87491),he=n(88996),xe=n(80601),be=n(88201),ye=n(5602),we=n(59485),Ce=n(38775),Me=n(80556),je=n(40074),ke=n(58791),qe=n(61353),Ze=n(16852),Se=n(40439),Fe=n(59145),Te=n(58087),Re=n(70185),Pe=function(){var e=(0,b.useIntl)(),t=(0,o.useContext)(Re.I).isDarkMode,n=(0,d.V)((function(e){return e.currentRobot})),r=(0,w.u)((function(e){return e.currentOrg})),a=(0,o.useState)(!1),i=c()(a,2),l=i[0],f=i[1],p=(0,o.useState)({totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0}),g=c()(p,2),v=g[0],h=g[1],x=function(){var t=u()(s()().mark((function t(){var o,a,i,u,l,c,d,p,m,g,v,x,b;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("requestQueue"),f(!0),F.yw.info(e.formatMessage({id:"refresh",defaultMessage:"正在刷新队列数据..."})),t.prev=3,o={pageNumber:0,pageSize:100,agentUid:null==n?void 0:n.uid,orgUid:null==r?void 0:r.uid},t.next=7,(0,ve.Wq)(o);case 7:a=t.sent,console.log("queryQueuesByOrg response:",a.data),200==(null==a?void 0:a.code)?(F.yw.destroy(),null!=a&&null!==(i=a.data)&&void 0!==i&&i.content&&a.data.content.length>0?(b=a.data.content.reduce((function(e,t){return e.totalCount+=t.totalCount||0,e.queuingCount+=t.queuingCount||0,e.chattingCount+=t.chattingCount||0,e.offlineCount+=t.offlineCount||0,e.closedCount+=t.closedCount||0,e.leaveMsgCount+=t.leaveMsgCount||0,e.robotToAgentCount+=t.robotToAgentCount||0,e.avgWaitTime=t.avgWaitTime,e.avgResolveTime=t.avgResolveTime,e}),{totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0}),h({totalCount:null!==(u=b.totalCount)&&void 0!==u?u:0,queuingCount:null!==(l=b.queuingCount)&&void 0!==l?l:0,chattingCount:null!==(c=b.chattingCount)&&void 0!==c?c:0,offlineCount:null!==(d=b.offlineCount)&&void 0!==d?d:0,closedCount:null!==(p=b.closedCount)&&void 0!==p?p:0,leaveMsgCount:null!==(m=b.leaveMsgCount)&&void 0!==m?m:0,robotToAgentCount:null!==(g=b.robotToAgentCount)&&void 0!==g?g:0,avgWaitTime:null!==(v=b.avgWaitTime)&&void 0!==v?v:0,avgResolveTime:null!==(x=b.avgResolveTime)&&void 0!==x?x:0})):h({totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0})):F.yw.error(null==a?void 0:a.message);case 10:return t.prev=10,f(!1),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[3,,10,13]])})));return function(){return t.apply(this,arguments)}}();(0,o.useEffect)((function(){x()}),[n]);var y={boxShadow:t?"0 4px 8px rgba(255,255,255,0.05)":"0 4px 8px rgba(0,0,0,0.1)",borderRadius:"8px",height:"100%",transition:"transform 0.3s",cursor:"pointer"},C={totalCount:{bg:t?"#0a2642":"#e6f7ff",valueColor:"#1890ff"},queuingCount:{bg:t?"#3b2500":"#fff7e6",valueColor:"#fa8c16"},chattingCount:{bg:t?"#162312":"#f6ffed",valueColor:"#52c41a"},offlineCount:{bg:t?"#1f1f1f":"#fcfcfc",valueColor:t?"#d9d9d9":"#8c8c8c"},closedCount:{bg:t?"#2a0e0d":"#fff1f0",valueColor:"#ff4d4f"},leaveMsgCount:{bg:t?"#230e2c":"#f9f0ff",valueColor:"#722ed1"},robotToAgentCount:{bg:t?"#102039":"#e6fffb",valueColor:"#13c2c2"},avgWaitTime:{bg:t?"#273010":"#fcffe6",valueColor:"#a0d911"},avgResolveTime:{bg:t?"#172b4d":"#f0f5ff",valueColor:"#2f54eb"}};return(0,q.jsxs)("div",{style:{padding:"4px"},children:[(0,q.jsx)("div",{style:{marginBottom:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,q.jsx)(he.Z,{title:e.formatMessage({id:"refresh",defaultMessage:"刷新数据"}),children:(0,q.jsx)(m.ZP,{type:"primary",icon:(0,q.jsx)(Me.Z,{}),loading:l,onClick:x,size:"small",children:e.formatMessage({id:"refresh",defaultMessage:"刷新"})})})}),(0,q.jsxs)(xe.Z,{spinning:l,children:[(0,q.jsxs)(be.Z,{gutter:[16,16],children:[(0,q.jsx)(ye.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,q.jsx)(ee.Z,{style:A()(A()({},y),{},{backgroundColor:C.totalCount.bg}),hoverable:!0,children:(0,q.jsx)(we.Z,{title:e.formatMessage({id:"queue.totalCount",defaultMessage:"总会话"}),value:v.totalCount,prefix:(0,q.jsx)(je.Z,{}),valueStyle:{color:"#1890ff"}})})}),(0,q.jsx)(ye.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,q.jsx)(ee.Z,{style:A()(A()({},y),{},{backgroundColor:C.queuingCount.bg}),hoverable:!0,children:(0,q.jsx)(we.Z,{title:e.formatMessage({id:"queue.queuingCount",defaultMessage:"排队中"}),value:v.queuingCount,prefix:(0,q.jsx)(ke.Z,{}),valueStyle:{color:"#fa8c16"}})})}),(0,q.jsx)(ye.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,q.jsx)(ee.Z,{style:A()(A()({},y),{},{backgroundColor:C.chattingCount.bg}),hoverable:!0,children:(0,q.jsx)(we.Z,{title:e.formatMessage({id:"queue.chattingCount",defaultMessage:"会话中"}),value:v.chattingCount,prefix:(0,q.jsx)(qe.Z,{}),valueStyle:{color:"#52c41a"}})})}),(0,q.jsx)(ye.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,q.jsx)(ee.Z,{style:A()(A()({},y),{},{backgroundColor:C.offlineCount.bg}),hoverable:!0,children:(0,q.jsx)(we.Z,{title:e.formatMessage({id:"queue.offlineCount",defaultMessage:"离线留言"}),value:v.offlineCount,prefix:(0,q.jsx)(Ze.Z,{}),valueStyle:{color:"#8c8c8c"}})})}),(0,q.jsx)(ye.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,q.jsx)(ee.Z,{style:A()(A()({},y),{},{backgroundColor:C.closedCount.bg}),hoverable:!0,children:(0,q.jsx)(we.Z,{title:e.formatMessage({id:"queue.closedCount",defaultMessage:"已关闭"}),value:v.closedCount,prefix:(0,q.jsx)(Se.Z,{}),valueStyle:{color:"#ff4d4f"}})})}),(0,q.jsx)(ye.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,q.jsx)(ee.Z,{style:A()(A()({},y),{},{backgroundColor:C.leaveMsgCount.bg}),hoverable:!0,children:(0,q.jsx)(we.Z,{title:e.formatMessage({id:"queue.leaveMsgCount",defaultMessage:"留言数"}),value:v.leaveMsgCount,prefix:(0,q.jsx)(Fe.Z,{}),valueStyle:{color:C.leaveMsgCount.valueColor}})})})]}),(0,q.jsx)(Ce.Z,{style:{margin:"16px 0",fontSize:"14px"},children:e.formatMessage({id:"queue.additionalStats",defaultMessage:"更多统计"})}),(0,q.jsx)(be.Z,{gutter:[16,16],children:(0,q.jsx)(ye.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,q.jsx)(ee.Z,{style:A()(A()({},y),{},{backgroundColor:C.robotToAgentCount.bg}),hoverable:!0,children:(0,q.jsx)(we.Z,{title:e.formatMessage({id:"queue.robotToAgentCount",defaultMessage:"转人工数"}),value:v.robotToAgentCount,prefix:(0,q.jsx)(Te.Z,{}),valueStyle:{color:C.robotToAgentCount.valueColor}})})})})]})]})},Ve=function(){var e=(0,b.useIntl)(),t=(0,o.useMemo)((function(){return[{key:"basic",label:e.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,q.jsx)(N,{})},{key:"serviceSettings",label:e.formatMessage({id:"pages.agent.service.settings",defaultMessage:"Service Settings"}),children:(0,q.jsx)(ge.Z,{type:C._X4})},{key:"advanced",label:e.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,q.jsx)(me,{})},{key:"monitor",label:e.formatMessage({id:"queue.dashboard.title",defaultMessage:"Monitor"}),children:(0,q.jsx)(Pe,{})},{key:"channel",label:e.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,q.jsx)(V.Z,{type:C._X4})}]}),[e]);return(0,q.jsx)(P.Z,{defaultActiveKey:"basic",items:t})},Ue=n(96865),Ae=r.Z.Sider,Oe=r.Z.Content,Le=function(){var e=(0,Ue.Z)(),t=e.leftSiderStyle,n=e.leftSiderWidth,o=e.contentStyle;return(0,q.jsxs)(r.Z,{children:[(0,q.jsx)(Ae,{width:n,style:t,children:(0,q.jsx)(R,{})}),(0,q.jsx)(r.Z,{children:(0,q.jsx)(Oe,{style:o,children:(0,q.jsx)(Ve,{})})})]})}}}]);