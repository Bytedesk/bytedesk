"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2148],{11090:function(e,t,a){a.d(t,{Z:function(){return d}});var r=a(83910),s=a(44194),n={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},o=a(54183),i=function(e,t){return s.createElement(o.Z,(0,r.Z)({},e,{ref:t,icon:n}))};var d=s.forwardRef(i)},2484:function(e,t,a){a.d(t,{Z:function(){return d}});var r=a(83910),s=a(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},o=a(54183),i=function(e,t){return s.createElement(o.Z,(0,r.Z)({},e,{ref:t,icon:n}))};var d=s.forwardRef(i)},92950:function(e,t,a){a.d(t,{XS:function(){return c},k4:function(){return m},uu:function(){return x},yr:function(){return f}});var r=a(90819),s=a.n(r),n=a(73193),o=a.n(n),i=a(89933),d=a.n(i),u=a(39497),l=a(14906);function c(e){return g.apply(this,arguments)}function g(){return(g=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/category/query/org",{method:"GET",params:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/category/create",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/category/update",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return M.apply(this,arguments)}function M(){return(M=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/category/delete",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},4112:function(e,t,a){a.d(t,{Wq:function(){return c}});var r=a(90819),s=a.n(r),n=a(73193),o=a.n(n),i=a(89933),d=a.n(i),u=a(39497),l=a(14906);function c(e){return g.apply(this,arguments)}function g(){return(g=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/queue/query/org",{method:"GET",params:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},30901:function(e,t,a){a.d(t,{nV:function(){return l}});var r=a(90819),s=a.n(r),n=a(73193),o=a.n(n),i=a(89933),d=a.n(i),u=(a(39497),a(14906));function l(e){return c.apply(this,arguments)}function c(){return(c=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/queue/member/query/org",{method:"GET",params:o()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},41245:function(e,t,a){a.d(t,{D$:function(){return m},EP:function(){return x},hS:function(){return f},z_:function(){return c}});var r=a(90819),s=a.n(r),n=a(73193),o=a.n(n),i=a(89933),d=a.n(i),u=a(39497),l=a(14906);function c(e){return g.apply(this,arguments)}function g(){return(g=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/member/query/org",{method:"GET",params:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/member/create",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/member/update",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return M.apply(this,arguments)}function M(){return(M=d()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/member/delete",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},57898:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ie}});var r=a(67738),s=a(20993),n=a(84176),o=a.n(n),i=a(73193),d=a.n(i),u=a(86222),l=a.n(u),c=a(90819),g=a.n(c),m=a(89933),p=a.n(m),f=a(45332),h=a.n(f),x=a(19433),M=a(14906);function y(e){return b.apply(this,arguments)}function b(){return(b=p()(g()().mark((function e(t){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/thread/invite/query/org",{method:"GET",params:d()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=a(91361),j=a(98830),F=a(39497),w=a(5932),k=a(54881),S=a(11090),I=a(2484),A=a(89246),q=a(86895),T=a(81739),C=a(63649),R=a(2907),Z=a(82770),D=a(44194),Y=a(31549),L=["current","pageSize"],E={INVITE_PENDING:{text:"invite.status.pending",defaultMessage:"邀请待处理",color:"blue"},INVITE_ACCEPTED:{text:"invite.status.accepted",defaultMessage:"接受邀请",color:"green"},INVITE_REJECTED:{text:"invite.status.rejected",defaultMessage:"拒绝邀请",color:"red"},INVITE_TIMEOUT:{text:"invite.status.timeout",defaultMessage:"邀请超时",color:"orange"},INVITE_CANCELED:{text:"invite.status.canceled",defaultMessage:"取消邀请",color:"gray"}},N=function(e){var t=e.superUser,a=(0,M.useIntl)(),r=(0,D.useRef)(),s=(0,D.useState)(1),n=h()(s,2),i=n[0],u=n[1],c=(0,D.useState)(10),m=h()(c,2),f=m[0],b=m[1],N=(0,j.u)((function(e){return e.currentOrg})),H=(0,v.Z)().translateString,z=q.Z.useModal(),O=h()(z,2),U=(O[0],O[1]),P=(0,D.useState)([]),B=h()(P,2),G=B[0],J=B[1],_=(0,D.useState)([]),V=h()(_,2),K=V[0],Q=V[1],W=(0,D.useState)(0),X=h()(W,2),$=X[0],ee=X[1],te=(0,D.useState)({}),ae=h()(te,2),re=ae[0],se=ae[1],ne=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:(0,Y.jsx)(M.FormattedMessage,{id:"sender",defaultMessage:"Sender"}),dataIndex:"sender",copyable:!0,ellipsis:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"invite.sender.tooltip"}),render:function(e,t,a,r){var s;return H(null===(s=t.sender)||void 0===s?void 0:s.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"receiver",defaultMessage:"Receiver"}),dataIndex:"receiverNickname",copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"invite.receiver.tooltip"}),render:function(e,t,a,r){var s;return H(null===(s=t.receiver)||void 0===s?void 0:s.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"note",defaultMessage:"Note"}),dataIndex:"note",hideInSearch:!0,copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"invite.note.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0,copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"invite.status.tooltip"}),render:function(e,t){var a=t.status,r=E[a]||{text:"invite.status.unknown",defaultMessage:"未知状态",color:"default"};return(0,Y.jsx)(T.Z,{color:r.color,children:(0,Y.jsx)(M.FormattedMessage,{id:r.text,defaultMessage:r.defaultMessage})})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180}],oe=[].concat(ne,[{title:a.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,fixed:"right",render:function(e,t,r,s){return[(0,Y.jsx)("a",{onClick:function(){ie(t)},children:a.formatMessage({id:"view",defaultMessage:"View"})},"editable"),(0,Y.jsx)(C.Z,{title:a.formatMessage({id:"deleteTip"}),description:"".concat(a.formatMessage({id:"deleteAffirm"}),"【").concat(null==t?void 0:t.uid,"】？"),onConfirm:function(){return de(t)},okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"}),children:(0,Y.jsx)("a",{style:{color:"red",marginLeft:8},children:a.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")]}}]),ie=function(e){var t,a;console.log("handleShowChatHistory",e);var r={chatConfig:{org:null==N?void 0:N.uid,t:F.CCt,sid:null==e||null===(t=e.thread)||void 0===t?void 0:t.uid}};null===(a=window.bytedesk)||void 0===a||a.showChat(r)},de=function(){var e=p()(g()().mark((function e(t){var s;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteConfirm",t),x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."}));try{x.yw.destroy(),x.yw.success(a.formatMessage({id:"delete.success",defaultMessage:"Delete Success"})),null==r||null===(s=r.current)||void 0===s||s.reload()}catch(e){x.yw.destroy(),x.yw.error(a.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}))}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=p()(g()().mark((function e(){var t,s,n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==K.length){e.next=3;break}return x.yw.warning(a.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 3:x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),0,s=0,n=l()(K);try{for(n.s();!(o=n.n()).done;)o.value}catch(e){n.e(e)}finally{n.f()}x.yw.destroy(),0===s?x.yw.success(a.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:0})):x.yw.warning(a.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:0,fail:s})),J([]),Q([]),null===(t=r.current)||void 0===t||t.reloadAndRest();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=p()(g()().mark((function e(t,a,r){var s,n;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",t,a,r),s=localStorage.getItem(F.LA8),n=d()({orgUid:(null==N?void 0:N.uid)||"",accessToken:s||"",exportType:t},re),"current"===t?(n.pageNumber=String(i-1),n.pageSize=String(f)):"all"===t?(n.pageNumber="0",n.pageSize="1000"):"range"===t&&void 0!==a&&void 0!==r&&(n.pageNumber=String(a),n.pageSize=String(r)),window.open((0,w.kG)()+"/api/v1/thread/invite/export?"+new URLSearchParams(n).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),ce=function(e){for(var t=[],a=1e3,r=Math.ceil(e/a),s=function(){var r=n,s=n*a+1,o=Math.min((n+1)*a,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return le("range",r,a)}})},n=0;n<r;n++)s();return t},ge={selectedRowKeys:G,onChange:function(e,t){J(e),Q(t)}};return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(A.Z,{columns:oe,actionRef:r,cardBordered:!0,rowSelection:ge,scroll:{x:"max-content"},request:function(){var e=p()(g()().mark((function e(a,r,s){var n,i,l,c,m,p,f,h;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.current,i=a.pageSize,l=o()(a,L),u(n),b(i),se(l),c=void 0,m=void 0,r&&Object.keys(r).length>0&&(p=Object.keys(r)[0],c=p,m="ascend"===r[p]?"ascend":"descend"),f=d()(d()({pageNumber:n-1,pageSize:i,orgUid:null==N?void 0:N.uid,superUser:t},l),{},{sortBy:c,sortDirection:m}),e.next=10,y(f);case 10:return h=e.sent,console.log("getAllThreadInvites response:",h,f),200===h.code?ee(h.data.totalElements):x.yw.error(h.message),e.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:a.formatMessage({id:"thread.tab.invite",defaultMessage:"ThreadInvite"}),toolBarRender:function(){return function(){var e=[],t=[];G.length>0&&t.push({key:"batchDelete",icon:(0,Y.jsx)(k.Z,{}),danger:!0,label:a.formatMessage({id:"batch.delete"})+" (".concat(G.length,")"),onClick:function(){q.Z.confirm({title:a.formatMessage({id:"batch.deleteTip"}),content:"".concat(a.formatMessage({id:"batch.deleteAffirm"})," ").concat(G.length," ").concat(a.formatMessage({id:"items"}),"?"),onOk:ue,okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"})})}});var r=[{key:"export-current",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return le("current")}}];return $>0&&($<=1e3?r.push({key:"export-all",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat($,"条)"),onClick:function(){return le("all")}}):r.push({key:"export-range",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat($,"条)"),children:ce($)})),e.push((0,Y.jsx)(R.Z,{menu:{items:r},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",children:[a.formatMessage({id:"export",defaultMessage:"Export"}),(0,Y.jsx)(I.Z,{})]},"button")},"export")),t.length>0&&e.push((0,Y.jsx)(R.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{type:G.length>0?"primary":"default",danger:G.length>0,children:[G.length>0?a.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})+" (".concat(G.length,")"):a.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,Y.jsx)(I.Z,{})]})},"batchOperations")),e}()}}),U]})};function H(e){return z.apply(this,arguments)}function z(){return(z=p()(g()().mark((function e(t){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/thread/transfer/query/org",{method:"GET",params:d()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=a(96596),U=a.n(O),P=["current","pageSize"],B={TRANSFER_PENDING:{text:"transfer.status.pending",defaultMessage:"转接待处理",color:"blue"},TRANSFER_ACCEPTED:{text:"transfer.status.accepted",defaultMessage:"接受转接",color:"green"},TRANSFER_REJECTED:{text:"transfer.status.rejected",defaultMessage:"拒绝转接",color:"red"},TRANSFER_TIMEOUT:{text:"transfer.status.timeout",defaultMessage:"转接超时",color:"orange"},TRANSFER_CANCELED:{text:"transfer.status.canceled",defaultMessage:"取消转接",color:"gray"}},G={AGENT_TO_AGENT:{text:"transfer.type.agent_to_agent",defaultMessage:"人工转人工",color:"purple"},ROBOT_TO_AGENT:{text:"transfer.type.robot_to_agent",defaultMessage:"机器人转人工",color:"cyan"}},J=function(e){var t=e.superUser,a=(0,M.useIntl)(),r=(0,D.useRef)(),s=(0,D.useState)(1),n=h()(s,2),i=n[0],u=n[1],c=(0,D.useState)(10),m=h()(c,2),f=m[0],y=m[1],b=(0,j.u)((function(e){return e.currentOrg})),L=(0,v.Z)().translateString,E=q.Z.useModal(),N=h()(E,2),z=(N[0],N[1]),O=(0,D.useState)([]),J=h()(O,2),_=J[0],V=J[1],K=(0,D.useState)([]),Q=h()(K,2),W=Q[0],X=Q[1],$=(0,D.useState)(0),ee=h()($,2),te=ee[0],ae=ee[1],re=(0,D.useState)({}),se=h()(re,2),ne=se[0],oe=se[1],ie=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,ellipsis:!0,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"sender",defaultMessage:"Sender"}),dataIndex:"senderNickname",copyable:!0,ellipsis:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.sender.tooltip"}),render:function(e,t,a,r){var s;return L(null===(s=t.sender)||void 0===s?void 0:s.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"receiver",defaultMessage:"Receiver"}),dataIndex:"receiverNickname",copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.receiver.tooltip"}),render:function(e,t,a,r){var s;return L(null===(s=t.receiver)||void 0===s?void 0:s.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"note",defaultMessage:"Note"}),dataIndex:"note",hideInSearch:!0,copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.note.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0,copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.status.tooltip"}),render:function(e,t){var a=t.status,r=B[a]||{text:"transfer.status.unknown",defaultMessage:"未知状态",color:"default"};return(0,Y.jsx)(T.Z,{color:r.color,children:(0,Y.jsx)(M.FormattedMessage,{id:r.text,defaultMessage:r.defaultMessage})})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInSearch:!0,copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.type.tooltip"}),render:function(e,t){var a=t.type,r=G[a]||{text:"transfer.type.unknown",defaultMessage:"未知类型",color:"default"};return(0,Y.jsx)(T.Z,{color:r.color,children:(0,Y.jsx)(M.FormattedMessage,{id:r.text,defaultMessage:r.defaultMessage})})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.transferAt",defaultMessage:"转接时间"}),dataIndex:"transferAt",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.transferAt.tooltip"}),render:function(e,t){return t.transferAt?U()(t.transferAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.acceptAt",defaultMessage:"接受时间"}),dataIndex:"acceptAt",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.acceptAt.tooltip"}),render:function(e,t){return t.acceptAt?U()(t.acceptAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.cancelAt",defaultMessage:"取消时间"}),dataIndex:"cancelAt",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.cancelAt.tooltip"}),render:function(e,t){return t.cancelAt?U()(t.cancelAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.rejectAt",defaultMessage:"拒绝时间"}),dataIndex:"rejectAt",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.rejectAt.tooltip"}),render:function(e,t){return t.rejectAt?U()(t.rejectAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.expireAt",defaultMessage:"超时时间"}),dataIndex:"expireAt",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"transfer.expireAt.tooltip"}),render:function(e,t){return t.expireAt?U()(t.expireAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180}],de=[].concat(ie,[{title:a.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,fixed:"right",render:function(e,t,r,s){return[(0,Y.jsx)("a",{onClick:function(){ue(t)},children:a.formatMessage({id:"view",defaultMessage:"View"})},"editable"),(0,Y.jsx)(C.Z,{title:a.formatMessage({id:"delete.tip",defaultMessage:"删除确认"}),description:a.formatMessage({id:"delete.confirm",defaultMessage:"确定要删除此转接记录吗？此操作不可恢复!"}),onConfirm:function(){return le(t)},okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"}),children:(0,Y.jsx)("a",{style:{color:"red",marginLeft:8},children:a.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")]}}]),ue=function(e){var t,a;console.log("handleShowChatHistory",e);var r={chatConfig:{org:null==b?void 0:b.uid,t:F.CCt,sid:null==e||null===(t=e.thread)||void 0===t?void 0:t.uid}};null===(a=window.bytedesk)||void 0===a||a.showChat(r)},le=function(){var e=p()(g()().mark((function e(t){var s;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteConfirm",t),x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."}));try{x.yw.destroy(),x.yw.success(a.formatMessage({id:"delete.success",defaultMessage:"Delete Success"})),null==r||null===(s=r.current)||void 0===s||s.reload()}catch(e){x.yw.destroy(),x.yw.error(a.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}))}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=p()(g()().mark((function e(){var t,s,n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==W.length){e.next=3;break}return x.yw.warning(a.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 3:x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),0,s=0,n=l()(W);try{for(n.s();!(o=n.n()).done;)o.value}catch(e){n.e(e)}finally{n.f()}x.yw.destroy(),0===s?x.yw.success(a.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:0})):x.yw.warning(a.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:0,fail:s})),V([]),X([]),null===(t=r.current)||void 0===t||t.reloadAndRest();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=p()(g()().mark((function e(t,a,r){var s,n;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",t,a,r),s=localStorage.getItem(F.LA8),n=d()({orgUid:(null==b?void 0:b.uid)||"",accessToken:s||"",exportType:t},ne),"current"===t?(n.pageNumber=String(i-1),n.pageSize=String(f)):"all"===t?(n.pageNumber="0",n.pageSize="1000"):"range"===t&&void 0!==a&&void 0!==r&&(n.pageNumber=String(a),n.pageSize=String(r)),window.open((0,w.kG)()+"/api/v1/thread/transfer/export?"+new URLSearchParams(n).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),me=function(e){for(var t=[],a=1e3,r=Math.ceil(e/a),s=function(){var r=n,s=n*a+1,o=Math.min((n+1)*a,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return ge("range",r,a)}})},n=0;n<r;n++)s();return t},pe={selectedRowKeys:_,onChange:function(e,t){V(e),X(t)}};return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(A.Z,{columns:de,actionRef:r,cardBordered:!0,rowSelection:pe,scroll:{x:"max-content"},request:function(){var e=p()(g()().mark((function e(a,r,s){var n,i,l,c,m,p,f,h;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.current,i=a.pageSize,l=o()(a,P),u(n),y(i),oe(l),c=void 0,m=void 0,r&&Object.keys(r).length>0&&(p=Object.keys(r)[0],c=p,m="ascend"===r[p]?"ascend":"descend"),f=d()(d()({pageNumber:n-1,pageSize:i,orgUid:null==b?void 0:b.uid,superUser:t},l),{},{sortBy:c,sortDirection:m}),e.next=10,H(f);case 10:return h=e.sent,console.log("getAllThreadTransfers response:",h,f),200===h.code?ae(h.data.totalElements):x.yw.error(h.message),e.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:a.formatMessage({id:"thread.tab.transfer",defaultMessage:"ThreadTransfer"}),toolBarRender:function(){return function(){var e=[],t=[];_.length>0&&t.push({key:"batchDelete",icon:(0,Y.jsx)(k.Z,{}),danger:!0,label:a.formatMessage({id:"batch.delete"})+" (".concat(_.length,")"),onClick:function(){q.Z.confirm({title:a.formatMessage({id:"batch.deleteTip"}),content:"".concat(a.formatMessage({id:"batch.deleteAffirm"})," ").concat(_.length," ").concat(a.formatMessage({id:"items"}),"?"),onOk:ce,okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"})})}});var r=[{key:"export-current",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return ge("current")}}];return te>0&&(te<=1e3?r.push({key:"export-all",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(te,"条)"),onClick:function(){return ge("all")}}):r.push({key:"export-range",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(te,"条)"),children:me(te)})),e.push((0,Y.jsx)(R.Z,{menu:{items:r},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",children:[a.formatMessage({id:"export",defaultMessage:"Export"}),(0,Y.jsx)(I.Z,{})]},"button")},"export")),t.length>0&&e.push((0,Y.jsx)(R.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{type:_.length>0?"primary":"default",danger:_.length>0,children:[_.length>0?a.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})+" (".concat(_.length,")"):a.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,Y.jsx)(I.Z,{})]})},"batchOperations")),e}()}}),z]})},_=a(39487);function V(e){return K.apply(this,arguments)}function K(){return(K=p()(g()().mark((function e(t){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/thread/summary/query/org",{method:"GET",params:d()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=a(92950),W=["current","pageSize"],X=function(e){var t=e.superUser,a=(0,M.useIntl)(),r=(0,D.useRef)(),s=(0,D.useState)(1),n=h()(s,2),i=n[0],u=n[1],c=(0,D.useState)(10),m=h()(c,2),f=m[0],y=m[1],b=(0,j.u)((function(e){return e.currentOrg})),L=(0,v.Z)().translateString,E=q.Z.useModal(),N=h()(E,2),H=(N[0],N[1]),z=(0,D.useState)([]),O=h()(z,2),U=(O[0],O[1]),P=(0,D.useState)({}),B=h()(P,2),G=B[0],J=B[1],K=(0,D.useState)([]),X=h()(K,2),$=X[0],ee=X[1],te=(0,D.useState)([]),ae=h()(te,2),re=ae[0],se=ae[1],ne=(0,D.useState)(0),oe=h()(ne,2),ie=oe[0],de=oe[1],ue=(0,D.useState)({}),le=h()(ue,2),ce=le[0],ge=le[1],me=function(){var e=p()(g()().mark((function e(){var t,r,s,n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={pageNumber:0,pageSize:100,type:F.ics,orgUid:null==b?void 0:b.uid},e.next=4,(0,Q.XS)(r);case 4:s=e.sent,console.log("queryCategoriesByOrg response:",s.data,r),200===(null==s?void 0:s.code)&&null!==(t=s.data)&&void 0!==t&&t.content&&(n=s.data.content,U(n),o={},n.forEach((function(e){o[e.uid]=e.name})),J(o)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Fetch categories error:",e.t0),x.yw.error(a.formatMessage({id:"ticket.category.load.error"}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,D.useEffect)((function(){null!=b&&b.uid&&me()}),[null==b?void 0:b.uid]);var pe=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:(0,Y.jsx)(M.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"title",copyable:!0,ellipsis:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"summary.title.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"content",copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"summary.content.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"solution",defaultMessage:"Solution"}),dataIndex:"solution",copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"summary.solution.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"category",defaultMessage:"Category"}),dataIndex:"categoryUid",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"summary.category.tooltip"}),render:function(e,t){var a=G[t.categoryUid]||t.categoryUid;return L(a)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",hideInSearch:!0,copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"summary.status.tooltip"}),render:function(e,t){var r="",s="";switch(t.status){case F.kA8:r="orange",s=a.formatMessage({id:"summary.status.pending",defaultMessage:"待处理"});break;case F.zvK:r="blue",s=a.formatMessage({id:"summary.status.processing",defaultMessage:"处理中"});break;case F.fuK:r="green",s=a.formatMessage({id:"summary.status.resolved",defaultMessage:"已解决"});break;case F.cin:r="gray",s=a.formatMessage({id:"summary.status.closed",defaultMessage:"已关闭"});break;default:r="default",s=e}return(0,Y.jsx)(T.Z,{color:r,children:s})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"tags",defaultMessage:"Tags"}),hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"summary.tags.tooltip"}),render:function(e,t){var a;return null!=t&&t.tagList&&Array.isArray(null==t?void 0:t.tagList)&&0!==(null==t?void 0:t.tagList.length)?(0,Y.jsx)(_.Z,{size:[0,4],wrap:!0,children:null==t||null===(a=t.tagList)||void 0===a?void 0:a.map((function(e){return(0,Y.jsx)(T.Z,{color:"blue",children:e},e)}))}):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180}],fe=[].concat(pe,[{title:a.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,fixed:"right",render:function(e,t,r,s){return[(0,Y.jsx)("a",{onClick:function(){he(t)},children:a.formatMessage({id:"view",defaultMessage:"View"})},"editable"),(0,Y.jsx)(C.Z,{title:a.formatMessage({id:"delete.tip",defaultMessage:"删除确认"}),description:a.formatMessage({id:"delete.confirm",defaultMessage:"确定要删除此总结记录吗？此操作不可恢复!"}),onConfirm:function(){return xe(t)},okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"}),children:(0,Y.jsx)("a",{style:{color:"red",marginLeft:8},children:a.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")]}}]),he=function(e){var t;console.log("handleShowChatHistory",e);var a={chatConfig:{org:null==b?void 0:b.uid,t:F.CCt,sid:null==e?void 0:e.threadUid}};null===(t=window.bytedesk)||void 0===t||t.showChat(a)},xe=function(){var e=p()(g()().mark((function e(t){var s;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteConfirm",t),x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."}));try{x.yw.destroy(),x.yw.success(a.formatMessage({id:"delete.success",defaultMessage:"Delete Success"})),null==r||null===(s=r.current)||void 0===s||s.reload()}catch(e){x.yw.destroy(),x.yw.error(a.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}))}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=p()(g()().mark((function e(){var t,s,n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==re.length){e.next=3;break}return x.yw.warning(a.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 3:x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),0,s=0,n=l()(re);try{for(n.s();!(o=n.n()).done;)o.value}catch(e){n.e(e)}finally{n.f()}x.yw.destroy(),0===s?x.yw.success(a.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:0})):x.yw.warning(a.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:0,fail:s})),ee([]),se([]),null===(t=r.current)||void 0===t||t.reloadAndRest();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=p()(g()().mark((function e(t,a,r){var s,n;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",t,a,r),s=localStorage.getItem(F.LA8),n=d()({orgUid:(null==b?void 0:b.uid)||"",accessToken:s||"",exportType:t},ce),"current"===t?(n.pageNumber=String(i-1),n.pageSize=String(f)):"all"===t?(n.pageNumber="0",n.pageSize="1000"):"range"===t&&void 0!==a&&void 0!==r&&(n.pageNumber=String(a),n.pageSize=String(r)),window.open((0,w.kG)()+"/api/v1/thread/summary/export?"+new URLSearchParams(n).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),be=function(e){for(var t=[],a=1e3,r=Math.ceil(e/a),s=function(){var r=n,s=n*a+1,o=Math.min((n+1)*a,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return ye("range",r,a)}})},n=0;n<r;n++)s();return t},ve={selectedRowKeys:$,onChange:function(e,t){ee(e),se(t)}};return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(A.Z,{columns:fe,actionRef:r,cardBordered:!0,rowSelection:ve,scroll:{x:"max-content"},request:function(){var e=p()(g()().mark((function e(a,r,s){var n,i,l,c,m,p,f,h;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.current,i=a.pageSize,l=o()(a,W),u(n),y(i),ge(l),c=void 0,m=void 0,r&&Object.keys(r).length>0&&(p=Object.keys(r)[0],c=p,m="ascend"===r[p]?"ascend":"descend"),f=d()(d()({pageNumber:n-1,pageSize:i,orgUid:null==b?void 0:b.uid,superUser:t},l),{},{sortBy:c,sortDirection:m}),e.next=10,V(f);case 10:return h=e.sent,console.log("queryThreadSummariesByOrg response:",h,f),200===h.code?de(h.data.totalElements):x.yw.error(h.message),e.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:a.formatMessage({id:"thread.tab.summary",defaultMessage:"ThreadSummary"}),toolBarRender:function(){return function(){var e=[],t=[];$.length>0&&t.push({key:"batchDelete",icon:(0,Y.jsx)(k.Z,{}),danger:!0,label:a.formatMessage({id:"batch.delete"})+" (".concat($.length,")"),onClick:function(){q.Z.confirm({title:a.formatMessage({id:"batch.deleteTip"}),content:"".concat(a.formatMessage({id:"batch.deleteAffirm"})," ").concat($.length," ").concat(a.formatMessage({id:"items"}),"?"),onOk:Me,okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"})})}});var r=[{key:"export-current",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return ye("current")}}];return ie>0&&(ie<=1e3?r.push({key:"export-all",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(ie,"条)"),onClick:function(){return ye("all")}}):r.push({key:"export-range",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(ie,"条)"),children:be(ie)})),e.push((0,Y.jsx)(R.Z,{menu:{items:r},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",children:[a.formatMessage({id:"export",defaultMessage:"Export"}),(0,Y.jsx)(I.Z,{})]},"button")},"export")),t.length>0&&e.push((0,Y.jsx)(R.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{type:$.length>0?"primary":"default",danger:$.length>0,children:[$.length>0?a.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})+" (".concat($.length,")"):a.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,Y.jsx)(I.Z,{})]})},"batchOperations")),e}()}}),H]})};function $(e){return ee.apply(this,arguments)}function ee(){return(ee=p()(g()().mark((function e(t){return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/thread/rating/query/org",{method:"GET",params:d()(d()({},t),{},{channel:F.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te=["current","pageSize"],ae=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",ellipsis:!0},{title:(0,Y.jsx)(M.FormattedMessage,{id:"nickname",defaultMessage:"Nickname"}),dataIndex:"userNickname",hideInSearch:!0,ellipsis:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"rating.user.tooltip"}),render:function(e,t,a,r){var s;return null==t||null===(s=t.thread)||void 0===s||null===(s=s.user)||void 0===s?void 0:s.nickname}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agent",defaultMessage:"Nickname"}),dataIndex:"agentNickname",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"rating.agent.tooltip"}),render:function(e,t,a,r){var s;return null==t||null===(s=t.thread)||void 0===s||null===(s=s.agentProtobuf)||void 0===s?void 0:s.nickname}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"score",defaultMessage:"Score"}),dataIndex:"score",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"rating.score.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"comment",copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"rating.comment.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180}],re=function(e){var t=e.superUser,a=(0,M.useIntl)(),r=(0,D.useRef)(),s=(0,D.useState)(1),n=h()(s,2),i=n[0],u=n[1],c=(0,D.useState)(10),m=h()(c,2),f=m[0],y=m[1],b=(0,j.u)((function(e){return e.currentOrg})),v=(0,D.useState)([]),T=h()(v,2),L=T[0],E=T[1],N=(0,D.useState)([]),H=h()(N,2),z=H[0],O=H[1],U=(0,D.useState)(0),P=h()(U,2),B=P[0],G=P[1],J=(0,D.useState)({}),_=h()(J,2),V=_[0],K=_[1],Q=[].concat(ae,[{title:a.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,fixed:"right",render:function(e,t,r,s){return[(0,Y.jsx)("a",{onClick:function(){W(t)},children:a.formatMessage({id:"view",defaultMessage:"View"})},"editable"),(0,Y.jsx)(C.Z,{title:a.formatMessage({id:"deleteTip"}),description:"".concat(a.formatMessage({id:"deleteAffirm"}),"【").concat(null==t?void 0:t.uid,"】？"),onConfirm:function(){return X(t)},okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"}),children:(0,Y.jsx)("a",{style:{color:"red",marginLeft:8},children:a.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")]}}]),W=function(e){var t,a;console.log("handleShowChatHistory",e);var r={chatConfig:{org:null==b?void 0:b.uid,t:F.CCt,sid:null==e||null===(t=e.thread)||void 0===t?void 0:t.uid}};null===(a=window.bytedesk)||void 0===a||a.showChat(r)},X=function(){var e=p()(g()().mark((function e(t){var s;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteConfirm",t),x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."}));try{x.yw.destroy(),x.yw.success(a.formatMessage({id:"delete.success",defaultMessage:"Delete Success"})),null==r||null===(s=r.current)||void 0===s||s.reload()}catch(e){x.yw.destroy(),x.yw.error(a.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}))}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=p()(g()().mark((function e(){var t,s,n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==z.length){e.next=3;break}return x.yw.warning(a.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 3:x.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),0,s=0,n=l()(z);try{for(n.s();!(o=n.n()).done;)o.value}catch(e){n.e(e)}finally{n.f()}x.yw.destroy(),0===s?x.yw.success(a.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:0})):x.yw.warning(a.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:0,fail:s})),E([]),O([]),null===(t=r.current)||void 0===t||t.reloadAndRest();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=p()(g()().mark((function e(t,a,r){var s,n;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",t,a,r),s=localStorage.getItem(F.LA8),n=d()({orgUid:(null==b?void 0:b.uid)||"",accessToken:s||"",exportType:t},V),"current"===t?(n.pageNumber=String(i-1),n.pageSize=String(f)):"all"===t?(n.pageNumber="0",n.pageSize="1000"):"range"===t&&void 0!==a&&void 0!==r&&(n.pageNumber=String(a),n.pageSize=String(r)),window.open((0,w.kG)()+"/api/v1/thread/rating/export?"+new URLSearchParams(n).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),se=function(e){for(var t=[],a=1e3,r=Math.ceil(e/a),s=function(){var r=n,s=n*a+1,o=Math.min((n+1)*a,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return re("range",r,a)}})},n=0;n<r;n++)s();return t},ne={selectedRowKeys:L,onChange:function(e,t){E(e),O(t)}};return(0,Y.jsx)(Y.Fragment,{children:(0,Y.jsx)(A.Z,{columns:Q,actionRef:r,cardBordered:!0,rowSelection:ne,scroll:{x:"max-content"},request:function(){var e=p()(g()().mark((function e(a,r,s){var n,i,l,c,m,p,f,h;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.current,i=a.pageSize,l=o()(a,te),u(n),y(i),K(l),c=void 0,m=void 0,r&&Object.keys(r).length>0&&(p=Object.keys(r)[0],c=p,m="ascend"===r[p]?"ascend":"descend"),f=d()(d()({pageNumber:n-1,pageSize:i,orgUid:null==b?void 0:b.uid,superUser:t},l),{},{sortBy:c,sortDirection:m}),e.next=10,$(f);case 10:return h=e.sent,console.log("queryRatesByOrgUid response:",h.data,f),200===h.code?G(h.data.totalElements):x.yw.error(h.message),e.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:"评价记录",toolBarRender:function(){return function(){var e=[],t=[];L.length>0&&t.push({key:"batchDelete",icon:(0,Y.jsx)(k.Z,{}),danger:!0,label:a.formatMessage({id:"batch.delete"})+" (".concat(L.length,")"),onClick:function(){q.Z.confirm({title:a.formatMessage({id:"batch.deleteTip"}),content:"".concat(a.formatMessage({id:"batch.deleteAffirm"})," ").concat(L.length," ").concat(a.formatMessage({id:"items"}),"?"),onOk:ee,okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"})})}});var r=[{key:"export-current",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return re("current")}}];return B>0&&(B<=1e3?r.push({key:"export-all",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(B,"条)"),onClick:function(){return re("all")}}):r.push({key:"export-range",icon:(0,Y.jsx)(S.Z,{}),label:a.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(B,"条)"),children:se(B)})),e.push((0,Y.jsx)(R.Z,{menu:{items:r},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",children:[a.formatMessage({id:"export",defaultMessage:"Export"}),(0,Y.jsx)(I.Z,{})]},"button")},"export")),t.length>0&&e.push((0,Y.jsx)(R.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{type:L.length>0?"primary":"default",danger:L.length>0,children:[L.length>0?a.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})+" (".concat(L.length,")"):a.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,Y.jsx)(I.Z,{})]})},"batchOperations")),e}()}})})},se=a(94389),ne=a(8538),oe=["current","pageSize"],ie=function(e){var t=e.type,a=e.superUser,r=(0,M.useIntl)(),s=(0,D.useRef)(),n=(0,D.useState)(1),i=h()(n,2),u=i[0],c=i[1],m=(0,D.useState)(10),f=h()(m,2),y=f[0],b=f[1],v=(0,j.u)((function(e){return e.currentOrg})),T=q.Z.useModal(),L=h()(T,2),E=(L[0],L[1]),N=(0,D.useState)([]),H=h()(N,2),z=H[0],O=H[1],U=(0,D.useState)([]),P=h()(U,2),B=P[0],G=P[1],J=(0,D.useState)(0),_=h()(J,2),V=_[0],K=_[1],Q=(0,D.useState)({}),W=h()(Q,2),X=W[0],$=W[1],ee=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.index.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,ellipsis:!0,fixed:"left",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.uid.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"nickname",defaultMessage:"Nickname"}),dataIndex:"userNickname",copyable:!0,ellipsis:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.userNickname.tooltip"}),render:function(e,t){var a;return(0,Y.jsx)(Y.Fragment,{children:null==t||null===(a=t.user)||void 0===a?void 0:a.nickname})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"state",defaultMessage:"state"}),dataIndex:"status",copyable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.status.tooltip"}),render:function(e,t){switch(null==t?void 0:t.status){case F.ach:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.new"});case F.j0C:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.roboting"});case F.Q7C:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.offline"});case F.v1N:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.queuing"});case F.hl2:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.chatting"});case F.V1n:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.closed"});default:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.status.unknown"})}}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"channel"}),dataIndex:"client",width:120,copyable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.channel.tooltip"}),render:function(e,t){return(0,ne.YG)(t.channel)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",copyable:!0,hideInTable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.type.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"topic",defaultMessage:"Topic"}),dataIndex:"topic",ellipsis:!0,copyable:!0,hideInTable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.topic.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"owner",defaultMessage:"Owner"}),dataIndex:"owner",hideInTable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.owner.tooltip"}),render:function(e,t){var a;return(0,Y.jsx)(Y.Fragment,{children:null==t||null===(a=t.owner)||void 0===a?void 0:a.nickname})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"tagList",defaultMessage:"Tags"}),dataIndex:"tagList",hideInTable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.tagList.tooltip"}),render:function(e,t){var a;return null==t||null===(a=t.tagList)||void 0===a?void 0:a.map((function(e,t){return(0,Y.jsxs)("span",{style:{marginRight:4},children:["#",e]},t)}))}}],te=[].concat(ee,[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,fixed:"right",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.actions.tooltip"}),render:function(e,t,a,s){return[(0,Y.jsx)("a",{onClick:function(){ae(t)},children:r.formatMessage({id:"view",defaultMessage:"View"})},"editable"),(0,Y.jsx)(C.Z,{title:r.formatMessage({id:"delete.tip",defaultMessage:"删除确认"}),description:r.formatMessage({id:"delete.confirm",defaultMessage:"确定要删除此群组记录吗？此操作不可恢复!"}),onConfirm:function(){return re(t)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),children:(0,Y.jsx)("a",{style:{color:"red",marginLeft:8},children:r.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")]}}]),ae=function(e){var t;console.log("handleShowChatHistory",e);var a={chatConfig:{org:null==v?void 0:v.uid,t:F.CCt,sid:null==e?void 0:e.uid}};null===(t=window.bytedesk)||void 0===t||t.showChat(a)},re=function(){var e=p()(g()().mark((function e(t){var a;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteConfirm",t),x.yw.loading(r.formatMessage({id:"deleting",defaultMessage:"Deleting..."}));try{x.yw.destroy(),x.yw.success(r.formatMessage({id:"delete.success",defaultMessage:"Delete Success"})),null==s||null===(a=s.current)||void 0===a||a.reload()}catch(e){x.yw.destroy(),x.yw.error(r.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}))}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=p()(g()().mark((function e(){var t,a,n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==B.length){e.next=3;break}return x.yw.warning(r.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 3:x.yw.loading(r.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),0,a=0,n=l()(B);try{for(n.s();!(o=n.n()).done;)o.value}catch(e){n.e(e)}finally{n.f()}x.yw.destroy(),0===a?x.yw.success(r.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:0})):x.yw.warning(r.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:0,fail:a})),O([]),G([]),null===(t=s.current)||void 0===t||t.reloadAndRest();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=p()(g()().mark((function e(a,r,s){var n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",a,r,s),n=localStorage.getItem(F.LA8),o=d()({componentType:t,orgUid:(null==v?void 0:v.uid)||"",accessToken:n||"",exportType:a,type:F.H_O},X),"current"===a?(o.pageNumber=String(u-1),o.pageSize=String(y)):"all"===a?(o.pageNumber="0",o.pageSize="1000"):"range"===a&&void 0!==r&&void 0!==s&&(o.pageNumber=String(r),o.pageSize=String(s)),window.open((0,w.kG)()+"/api/v1/thread/export?"+new URLSearchParams(o).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),ue=function(e){for(var t=[],a=1e3,r=Math.ceil(e/a),s=function(){var r=n,s=n*a+1,o=Math.min((n+1)*a,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return de("range",r,a)}})},n=0;n<r;n++)s();return t},le={selectedRowKeys:z,onChange:function(e,t){O(e),G(t)}};return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(A.Z,{columns:te,actionRef:s,cardBordered:!0,rowSelection:le,scroll:{x:"max-content"},request:function(){var e=p()(g()().mark((function e(t,r,s){var n,i,u,l,m,p,f,h;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.current,i=t.pageSize,u=o()(t,oe),c(n),b(i),$(u),l=void 0,m=void 0,r&&Object.keys(r).length>0&&(p=Object.keys(r)[0],l=p,m="ascend"===r[p]?"ascend":"descend"),f=d()(d()({pageNumber:n-1,pageSize:i,componentType:"",type:F.H_O,orgUid:null==v?void 0:v.uid,mergeByTopic:!1,superUser:a},u),{},{sortBy:l,sortDirection:m}),e.next=10,(0,se.fk)(f);case 10:return h=e.sent,console.log("getAllThreads response:",h,f),200===h.code?K(h.data.totalElements):x.yw.error(h.message),e.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"thread",defaultMessage:"Thread"}),toolBarRender:function(){return function(){var e=[],t=[];z.length>0&&t.push({key:"batchDelete",icon:(0,Y.jsx)(k.Z,{}),danger:!0,label:r.formatMessage({id:"batch.delete"})+" (".concat(z.length,")"),onClick:function(){q.Z.confirm({title:r.formatMessage({id:"batch.deleteTip"}),content:"".concat(r.formatMessage({id:"batch.deleteAffirm"})," ").concat(z.length," ").concat(r.formatMessage({id:"items"}),"?"),onOk:ie,okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"})})}});var a=[{key:"export-current",icon:(0,Y.jsx)(S.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return de("current")}}];return V>0&&(V<=1e3?a.push({key:"export-all",icon:(0,Y.jsx)(S.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(V,"条)"),onClick:function(){return de("all")}}):a.push({key:"export-range",icon:(0,Y.jsx)(S.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(V,"条)"),children:ue(V)})),e.push((0,Y.jsx)(R.Z,{menu:{items:a},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",children:[r.formatMessage({id:"export",defaultMessage:"Export"}),(0,Y.jsx)(I.Z,{})]},"button")},"export")),t.length>0&&e.push((0,Y.jsx)(R.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{type:z.length>0?"primary":"default",danger:z.length>0,children:[z.length>0?r.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})+" (".concat(z.length,")"):r.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,Y.jsx)(I.Z,{})]})},"batchOperations")),e}()}}),E]})},de=["current","pageSize"],ue=function(e){var t=e.type,a=e.superUser,r=(0,M.useIntl)(),s=(0,D.useRef)(),n=(0,D.useState)(1),i=h()(n,2),u=i[0],c=i[1],m=(0,D.useState)(10),f=h()(m,2),y=f[0],b=f[1],v=(0,j.u)((function(e){return e.currentOrg})),T=q.Z.useModal(),L=h()(T,2),E=(L[0],L[1]),N=(0,D.useState)([]),H=h()(N,2),z=H[0],O=H[1],U=(0,D.useState)([]),P=h()(U,2),B=P[0],G=P[1],J=(0,D.useState)(0),_=h()(J,2),V=_[0],K=_[1],Q=(0,D.useState)({}),W=h()(Q,2),X=W[0],$=W[1],ee=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.index.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,ellipsis:!0,fixed:"left",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.uid.tooltip"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"nickname",defaultMessage:"Nickname"}),dataIndex:"userNickname",copyable:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.userNickname.tooltip"}),render:function(e,t){var a;return(0,Y.jsx)(Y.Fragment,{children:null==t||null===(a=t.user)||void 0===a?void 0:a.nickname})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"state",defaultMessage:"state"}),dataIndex:"status",copyable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.status.tooltip"}),render:function(e,t){switch(null==t?void 0:t.status){case F.ach:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.new"});case F.j0C:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.roboting"});case F.Q7C:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.offline"});case F.v1N:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.queuing"});case F.hl2:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.chatting"});case F.V1n:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.closed"});default:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.status.unknown"})}}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"channel"}),dataIndex:"client",width:120,copyable:!0,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.channel.tooltip"}),render:function(e,t){return(0,ne.YG)(t.channel)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180},{title:(0,Y.jsx)(M.FormattedMessage,{id:"type",defaultMessage:"Type"}),dataIndex:"type",copyable:!0,hideInTable:!0,hideInSearch:!0},{title:(0,Y.jsx)(M.FormattedMessage,{id:"topic",defaultMessage:"Topic"}),dataIndex:"topic",ellipsis:!0,copyable:!0,hideInTable:!0,hideInSearch:!0},{title:(0,Y.jsx)(M.FormattedMessage,{id:"owner",defaultMessage:"Owner"}),dataIndex:"owner",hideInTable:!0,hideInSearch:!0,render:function(e,t){var a;return(0,Y.jsx)(Y.Fragment,{children:null==t||null===(a=t.owner)||void 0===a?void 0:a.nickname})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"tagList",defaultMessage:"Tags"}),dataIndex:"tagList",hideInTable:!0,hideInSearch:!0,render:function(e,t){var a;return null==t||null===(a=t.tagList)||void 0===a?void 0:a.map((function(e,t){return(0,Y.jsxs)("span",{style:{marginRight:4},children:["#",e]},t)}))}}],te=[].concat(ee,[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,fixed:"right",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"thread.actions.tooltip"}),render:function(e,t,a,s){return[(0,Y.jsx)("a",{onClick:function(){ae(t)},children:r.formatMessage({id:"view",defaultMessage:"View"})},"editable"),(0,Y.jsx)(C.Z,{title:r.formatMessage({id:"deleteTip"}),description:"".concat(r.formatMessage({id:"deleteAffirm"}),"【").concat(null==t?void 0:t.uid,"】？"),onConfirm:function(){return re(t)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),children:(0,Y.jsx)("a",{style:{color:"red",marginLeft:8},children:r.formatMessage({id:"delete",defaultMessage:"删除"})})},"delete")]}}]),ae=function(e){var t;console.log("handleShowChatHistory",e);var a={chatConfig:{org:null==v?void 0:v.uid,t:F.CCt,sid:null==e?void 0:e.uid}};null===(t=window.bytedesk)||void 0===t||t.showChat(a)},re=function(){var e=p()(g()().mark((function e(t){var a;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleDeleteConfirm",t),x.yw.loading(r.formatMessage({id:"deleting",defaultMessage:"Deleting..."}));try{x.yw.destroy(),x.yw.success(r.formatMessage({id:"delete.success",defaultMessage:"Delete Success"})),null==s||null===(a=s.current)||void 0===a||a.reload()}catch(e){x.yw.destroy(),x.yw.error(r.formatMessage({id:"delete.error",defaultMessage:"Delete Error"}))}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=p()(g()().mark((function e(){var t,a,n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==B.length){e.next=3;break}return x.yw.warning(r.formatMessage({id:"batch.delete.noselection",defaultMessage:"Please select items to delete"})),e.abrupt("return");case 3:x.yw.loading(r.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),0,a=0,n=l()(B);try{for(n.s();!(o=n.n()).done;)o.value}catch(e){n.e(e)}finally{n.f()}x.yw.destroy(),0===a?x.yw.success(r.formatMessage({id:"batch.delete.success",defaultMessage:"Successfully deleted {count} items"},{count:0})):x.yw.warning(r.formatMessage({id:"batch.delete.partial",defaultMessage:"Deleted {success} items, failed to delete {fail} items"},{success:0,fail:a})),O([]),G([]),null===(t=s.current)||void 0===t||t.reloadAndRest();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=p()(g()().mark((function e(a,r,s){var n,o;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",a,r,s),n=localStorage.getItem(F.LA8),o=d()({componentType:t,orgUid:(null==v?void 0:v.uid)||"",accessToken:n||"",exportType:a,type:F.n4F},X),"current"===a?(o.pageNumber=String(u-1),o.pageSize=String(y)):"all"===a?(o.pageNumber="0",o.pageSize="1000"):"range"===a&&void 0!==r&&void 0!==s&&(o.pageNumber=String(r),o.pageSize=String(s)),window.open((0,w.kG)()+"/api/v1/thread/export?"+new URLSearchParams(o).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),ue=function(e){for(var t=[],a=1e3,r=Math.ceil(e/a),s=function(){var r=n,s=n*a+1,o=Math.min((n+1)*a,e);t.push({key:"export-".concat(n),label:"".concat(s,"-").concat(o," (").concat(o-s+1,"条)"),onClick:function(){return ie("range",r,a)}})},n=0;n<r;n++)s();return t},le={selectedRowKeys:z,onChange:function(e,t){O(e),G(t)}};return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(A.Z,{columns:te,actionRef:s,cardBordered:!0,rowSelection:le,scroll:{x:"max-content"},request:function(){var e=p()(g()().mark((function e(t,r,s){var n,i,u,l,m,p,f,h;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.current,i=t.pageSize,u=o()(t,de),c(n),b(i),$(u),l=void 0,m=void 0,r&&Object.keys(r).length>0&&(p=Object.keys(r)[0],l=p,m="ascend"===r[p]?"ascend":"descend"),f=d()(d()({pageNumber:n-1,pageSize:i,componentType:"",type:F.n4F,orgUid:null==v?void 0:v.uid,mergeByTopic:!1,superUser:a},u),{},{sortBy:l,sortDirection:m}),e.next=10,(0,se.fk)(f);case 10:return h=e.sent,console.log("getAllThreads response:",h,f),200===h.code?K(h.data.totalElements):x.yw.error(h.message),e.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 14:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"thread",defaultMessage:"Thread"}),toolBarRender:function(){return function(){var e=[],t=[];z.length>0&&t.push({key:"batchDelete",icon:(0,Y.jsx)(k.Z,{}),danger:!0,label:r.formatMessage({id:"batch.delete"})+" (".concat(z.length,")"),onClick:function(){q.Z.confirm({title:r.formatMessage({id:"batch.deleteTip"}),content:"".concat(r.formatMessage({id:"batch.deleteAffirm"})," ").concat(z.length," ").concat(r.formatMessage({id:"items"}),"?"),onOk:oe,okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"})})}});var a=[{key:"export-current",icon:(0,Y.jsx)(S.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return ie("current")}}];return V>0&&(V<=1e3?a.push({key:"export-all",icon:(0,Y.jsx)(S.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(V,"条)"),onClick:function(){return ie("all")}}):a.push({key:"export-range",icon:(0,Y.jsx)(S.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(V,"条)"),children:ue(V)})),e.push((0,Y.jsx)(R.Z,{menu:{items:a},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",children:[r.formatMessage({id:"export",defaultMessage:"Export"}),(0,Y.jsx)(I.Z,{})]},"button")},"export")),t.length>0&&e.push((0,Y.jsx)(R.Z,{menu:{items:t},placement:"bottom",children:(0,Y.jsxs)(Z.ZP,{type:z.length>0?"primary":"default",danger:z.length>0,children:[z.length>0?r.formatMessage({id:"batch.operations",defaultMessage:"批量操作"})+" (".concat(z.length,")"):r.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,Y.jsx)(I.Z,{})]})},"batchOperations")),e}()}}),E]})},le=a(30901),ce=a(41245),ge=a(50246),me=a(80556),pe=a(82864),fe=a(65207),he=a(96509),xe=a(92354),Me=function(e){var t=e.thread,a=e.drawerOpen,r=void 0!==a&&a,s=e.onClose,n=(0,M.useIntl)();return(0,Y.jsx)(pe.Z,{title:n.formatMessage({id:"thread.process.steps.title",defaultMessage:"会话处理流程"}),placement:"right",closable:!0,onClose:s,open:r,width:500,children:(0,Y.jsx)(ye,{thread:t,isDrawer:!0})})},ye=function(e){var t=e.thread,a=e.isDrawer,r=void 0!==a&&a,s=(0,j.u)((function(e){return e.currentOrg})),n=(0,D.useState)([]),o=h()(n,2),i=o[0],d=o[1],u=(0,D.useState)(!1),l=h()(u,2),c=l[0],m=l[1];(0,M.useIntl)();console.log("currentThread",t,c);var f=(0,ge.Z)(),y=f.memberResult,b=f.setMemberResult,v=function(){var e=p()(g()().mark((function e(){var a,r;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,m(!0),a={pageNumber:0,pageSize:100,uid:null==t?void 0:t.uid},e.next=7,(0,se.bN)(a);case 7:r=e.sent,console.log("queryThreadProcessHistoryActivity response:",r.data),200===r.code?d(r.data||[]):(console.log("queryThreadProcessHistoryActivity error:",r.data),x.yw.error(r.message)),m(!1),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(2),console.error("Fetch thread history error:",e.t0),x.yw.error("获取工单历史记录失败"),m(!1);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=p()(g()().mark((function e(){var t,a;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.yw.loading("loading"),t={pageNumber:0,pageSize:100,orgUid:null==s?void 0:s.uid},e.next=4,(0,ce.z_)(t);case 4:200===(a=e.sent).code?(x.yw.destroy(),b(a)):x.yw.destroy();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,D.useEffect)((function(){w()}),[t]);var w=function(){v(),F()},k=function(e){if(!e)return"-";var t=y.data.content.find((function(t){return t.uid===e}));return(null==t?void 0:t.nickname)||""},S=r?{}:{maxHeight:"400px",overflowY:"auto"};return(0,Y.jsx)(Y.Fragment,{children:(0,Y.jsx)(fe.Z,{spinning:c,children:(0,Y.jsxs)("div",{style:S,children:[(0,Y.jsx)(Z.ZP,{type:"primary",shape:"circle",icon:(0,Y.jsx)(me.Z,{}),size:"small",onClick:w,style:{position:"absolute",top:"10px",right:"10px",zIndex:1},title:"刷新"}),(0,Y.jsx)(he.Z,{direction:"vertical",size:"small",current:i.length-1,style:{padding:"16px"},items:i.map((function(e,t){var a,r;return{title:(r=null==e?void 0:e.activityName,r||"活动"),description:(0,Y.jsxs)("div",{children:[(null==e?void 0:e.assignee)&&(0,Y.jsxs)("div",{children:["处理人: ",k(null==e?void 0:e.assignee)||(null==e?void 0:e.assignee)]}),(0,Y.jsxs)("div",{children:["处理时间: ",(null===(a=e.startTime)||void 0===a?void 0:a.toLocaleString())||"-"]})]}),status:t===i.length-1?"process":"finish"}}))}),0===i.length&&(0,Y.jsx)(xe.Z,{description:"请选择工单查看流转过程"})]})})})},be=["current","pageSize"],ve=function(){var e=(0,M.useIntl)(),t=(0,D.useRef)(),a=(0,v.Z)().translateString,r=(0,D.useState)(1),s=h()(r,2),n=s[0],i=s[1],u=(0,D.useState)(10),l=h()(u,2),c=l[0],m=l[1],f=(0,j.u)((function(e){return e.currentOrg})),y=(0,D.useState)(!1),b=h()(y,2),k=b[0],I=b[1],q=(0,D.useState)(),C=h()(q,2),R=C[0],L=(C[1],[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.nickname"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.nickname.tooltip"}),dataIndex:"visitorNickname",width:180,copyable:!0,render:function(e,t){var r;return a(null==t||null===(r=t.thread)||void 0===r||null===(r=r.user)||void 0===r?void 0:r.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.number"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.number.tooltip"}),dataIndex:"queueNumber",hideInSearch:!0},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.queueNickname"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.nickname.tooltip"}),dataIndex:"queueNickname",copyable:!0,width:120,hideInSearch:!0,render:function(e,t){var r;return a(null==t||null===(r=t.queue)||void 0===r?void 0:r.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robot"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robot.tooltip"}),dataIndex:"robotNickname",copyable:!0,render:function(e,t){var r,s=null==t||null===(r=t.thread)||void 0===r?void 0:r.robotProtobuf;return a(null==s?void 0:s.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.waitTime"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.waitTime.tooltip"}),dataIndex:"waitLength",hideInSearch:!0,render:function(e,t){if(!t.waitLength&&0!==t.waitLength)return"-";var a=Math.floor(t.waitLength/60),r=t.waitLength%60;return a>0?"".concat(a,"分").concat(r,"秒"):"".concat(r,"秒")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorPriority"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorPriority.tooltip"}),dataIndex:"visitorPriority",hideInSearch:!0,render:function(e,t){return t.visitorPriority||0}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorFirstMessageAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorFirstMessageAt.tooltip"}),dataIndex:"visitorFirstMessageAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.visitorFirstMessageAt?U()(null==t?void 0:t.visitorFirstMessageAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorLastMessageAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorLastMessageAt.tooltip"}),dataIndex:"visitorLastMessageAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.visitorLastMessageAt?U()(null==t?void 0:t.visitorLastMessageAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorLeavedAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorLeavedAt.tooltip"}),dataIndex:"visitorLeavedAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.visitorLeavedAt?U()(null==t?void 0:t.visitorLeavedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.enqueueTime"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.enqueueTime.tooltip"}),dataIndex:"visitorEnqueueAt",hideInSearch:!0,render:function(e,t){return U()(null==t?void 0:t.visitorEnqueueAt).format("YYYY-MM-DD HH:mm:ss")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.status"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.status.tooltip"}),dataIndex:"status",hideInSearch:!0,render:function(e,t){var a;switch(null==t||null===(a=t.thread)||void 0===a?void 0:a.status){case F.ach:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.new"});case F.j0C:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.roboting"});case F.Q7C:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.offline"});case F.v1N:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.queuing"});case F.hl2:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.chatting"});case F.V1n:return(0,Y.jsx)(M.FormattedMessage,{id:"thread.process.status.closed"});default:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.status.unknown"})}}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotAcceptType"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotAcceptType.tooltip"}),dataIndex:"robotAcceptType",hideInSearch:!0,render:function(e,t){switch(null==t?void 0:t.robotAcceptType){case"AUTO":return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.auto"});case"MANUAL":return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.manual"});case"ROBOT":return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.robot"});default:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.unknown"})}}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotAcceptTime"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotAcceptTime.tooltip"}),dataIndex:"robotAcceptedAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotAcceptedAt?U()(null==t?void 0:t.robotAcceptedAt).format("YYYY-MM-DD HH:mm:ss"):"未接入"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotFirstResponse"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotFirstResponse.tooltip"}),dataIndex:"robotFirstResponse",hideInSearch:!0,render:function(e,t){return t.robotFirstResponse?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotFirstResponse.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotFirstResponse.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotFirstResponseAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotFirstResponseAt.tooltip"}),dataIndex:"robotFirstResponseAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotFirstResponseAt?U()(null==t?void 0:t.robotFirstResponseAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotLastResponseAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotLastResponseAt.tooltip"}),dataIndex:"robotLastResponseAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotLastResponseAt?U()(null==t?void 0:t.robotLastResponseAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotClosedAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotClosedAt.tooltip"}),dataIndex:"robotClosedAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotClosedAt?U()(null==t?void 0:t.robotClosedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotToAgent"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotToAgent.tooltip"}),dataIndex:"robotToAgent",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotToAgent?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.offline.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.offline.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotToAgentTime"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotToAgentTime.tooltip"}),dataIndex:"robotToAgentAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotToAgent?U()(null==t?void 0:t.robotToAgentAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotAvgResponseLength"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotAvgResponseLength.tooltip"}),dataIndex:"robotAvgResponseLength",hideInSearch:!0,render:function(e,t){if(!t.robotAvgResponseLength&&0!==t.robotAvgResponseLength)return"-";var a=Math.floor(t.robotAvgResponseLength/60),r=t.robotAvgResponseLength%60;return a>0?"".concat(a,"分").concat(r,"秒"):"".concat(r,"秒")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotMaxResponseLength"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotMaxResponseLength.tooltip"}),dataIndex:"robotMaxResponseLength",hideInSearch:!0,render:function(e,t){if(!t.robotMaxResponseLength&&0!==t.robotMaxResponseLength)return"-";var a=Math.floor(t.robotMaxResponseLength/60),r=t.robotMaxResponseLength%60;return a>0?"".concat(a,"分").concat(r,"秒"):"".concat(r,"秒")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotTimeout"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotTimeout.tooltip"}),dataIndex:"robotTimeout",hideInSearch:!0,render:function(e,t){return t.robotTimeout?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotTimeout.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotTimeout.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotTimeoutAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotTimeoutAt.tooltip"}),dataIndex:"robotTimeoutAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotTimeoutAt?U()(null==t?void 0:t.robotTimeoutAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agent"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agent.tooltip"}),dataIndex:"agentNickname",copyable:!0,render:function(e,t){var r,s=JSON.parse((null==t||null===(r=t.thread)||void 0===r?void 0:r.agent)||"{}");return a(null==s?void 0:s.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.offline"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.offline.tooltip"}),dataIndex:"agentOffline",hideInSearch:!0,render:function(e,t){return null!=t&&t.robotToAgent?null!=t&&t.agentOffline?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.offline.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.offline.no"}):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentAcceptType"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentAcceptType.tooltip"}),dataIndex:"agentAcceptType",hideInSearch:!0,render:function(e,t){switch(null==t?void 0:t.agentAcceptType){case"AUTO":return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.auto"});case"MANUAL":return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.manual"});case"ROBOT":return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.robot"});default:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.acceptType.unknown"})}}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentAcceptTime"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentAcceptTime.tooltip"}),dataIndex:"agentAcceptedAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.agentAcceptedAt?U()(null==t?void 0:t.agentAcceptedAt).format("YYYY-MM-DD HH:mm:ss"):"未接入"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponse"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponse.tooltip"}),dataIndex:"agentFirstResponse",hideInSearch:!0,render:function(e,t){return t.agentFirstResponse?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponse.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponse.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponseLength"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponseLength.tooltip"}),dataIndex:"agentFirstResponseLength",hideInSearch:!0,render:function(e,t){if(!t.agentFirstResponseLength&&0!==t.agentFirstResponseLength)return"-";var a=Math.floor(t.agentFirstResponseLength/60),r=t.agentFirstResponseLength%60;return a>0?"".concat(a,"分").concat(r,"秒"):"".concat(r,"秒")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponseAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentFirstResponseAt.tooltip"}),dataIndex:"agentFirstResponseAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.agentFirstResponseAt?U()(null==t?void 0:t.agentFirstResponseAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentLastResponseAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentLastResponseAt.tooltip"}),dataIndex:"agentLastResponseAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.agentLastResponseAt?U()(null==t?void 0:t.agentLastResponseAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentClosedAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentClosedAt.tooltip"}),dataIndex:"agentClosedAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.agentClosedAt?U()(null==t?void 0:t.agentClosedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.solved"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.solved.tooltip"}),dataIndex:"resolved",hideInSearch:!0,render:function(e,t){return t.resolved?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.solved.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.solved.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rated"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rated.tooltip"}),dataIndex:"rated",hideInSearch:!0,render:function(e,t){return t.rated?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rated.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rated.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rateScore"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rateScore.tooltip"}),dataIndex:"rateScore",hideInSearch:!0},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rateAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.rateAt.tooltip"}),dataIndex:"rateAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.rateAt?U()(null==t?void 0:t.rateAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.qualityChecked"}),dataIndex:"qualityChecked",key:"qualityChecked",width:150,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.qualityChecked.tooltip"}),valueEnum:{true:{text:"已质检",status:"Success"},false:{text:"待质检",status:"Processing"}},render:function(e,t){return(0,Y.jsx)(T.Z,{color:t.qualityChecked?"green":"blue",children:t.qualityChecked?"已质检":"待质检"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.qualityCheckScore"}),dataIndex:"qualityCheckScore",key:"qualityCheckScore",width:100,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.qualityCheckScore.tooltip"}),render:function(e,t){return(0,Y.jsxs)(T.Z,{color:t.qualityCheckScore>=90?"green":t.qualityCheckScore>=80?"orange":"red",children:[t.qualityCheckScore||0,"分"]})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.qualityCheckedAt"}),dataIndex:"qualityCheckedAt",key:"qualityCheckedAt",valueType:"dateTime",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.qualityCheckedAt.tooltip"}),render:function(e,t){return t.qualityCheckedAt||"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.summarized"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.summarized.tooltip"}),dataIndex:"summarized",hideInSearch:!0,render:function(e,t){return t.summarized?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.summarized.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.summarized.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorMessageCount"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.visitorMessageCount.tooltip"}),dataIndex:"visitorMessageCount",hideInSearch:!0,render:function(e,t){return t.visitorMessageCount||0}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentMessageCount"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentMessageCount.tooltip"}),dataIndex:"agentMessageCount",hideInSearch:!0,render:function(e,t){return t.agentMessageCount||0}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentAvgResponseLength"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentAvgResponseLength.tooltip"}),dataIndex:"agentAvgResponseLength",hideInSearch:!0,render:function(e,t){if(!t.agentAvgResponseLength&&0!==t.agentAvgResponseLength)return"-";var a=Math.floor(t.agentAvgResponseLength/60),r=t.agentAvgResponseLength%60;return a>0?"".concat(a,"分").concat(r,"秒"):"".concat(r,"秒")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentMaxResponseLength"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentMaxResponseLength.tooltip"}),dataIndex:"agentMaxResponseLength",hideInSearch:!0,render:function(e,t){if(!t.agentMaxResponseLength&&0!==t.agentMaxResponseLength)return"-";var a=Math.floor(t.agentMaxResponseLength/60),r=t.agentMaxResponseLength%60;return a>0?"".concat(a,"分").concat(r,"秒"):"".concat(r,"秒")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeout"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeout.tooltip"}),dataIndex:"agentTimeout",hideInSearch:!0,render:function(e,t){return t.agentTimeout?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeout.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeout.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeoutAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeoutAt.tooltip"}),dataIndex:"agentTimeoutAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.agentTimeoutAt?U()(null==t?void 0:t.agentTimeoutAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeoutCount"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentTimeoutCount.tooltip"}),dataIndex:"agentTimeoutCount",hideInSearch:!0,render:function(e,t){return t.agentTimeoutCount||0}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentClose"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentClose.tooltip"}),dataIndex:"agentClose",hideInSearch:!0,render:function(e,t){return t.agentClose?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentClose.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.agentClose.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemFirstResponseAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemFirstResponseAt.tooltip"}),dataIndex:"systemFirstResponseAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.systemFirstResponseAt?U()(null==t?void 0:t.systemFirstResponseAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemLastResponseAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemLastResponseAt.tooltip"}),dataIndex:"systemLastResponseAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.systemLastResponseAt?U()(null==t?void 0:t.systemLastResponseAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemClosedAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemClosedAt.tooltip"}),dataIndex:"systemClosedAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.systemClosedAt?U()(null==t?void 0:t.systemClosedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemClose"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemClose.tooltip"}),dataIndex:"systemClose",hideInSearch:!0,render:function(e,t){return t.systemClose?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemClose.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemClose.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemMessageCount"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.systemMessageCount.tooltip"}),dataIndex:"systemMessageCount",hideInSearch:!0,render:function(e,t){return t.systemMessageCount||0}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.messageLeaveAt"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.messageLeaveAt.tooltip"}),dataIndex:"messageLeaveAt",hideInSearch:!0,render:function(e,t){return null!=t&&t.messageLeaveAt?U()(null==t?void 0:t.messageLeaveAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotMessageCount"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.robotMessageCount.tooltip"}),dataIndex:"robotMessageCount",hideInSearch:!0,render:function(e,t){return t.robotMessageCount||0}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.leaveMsg"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.leaveMsg.tooltip"}),dataIndex:"messageLeave",hideInSearch:!0,render:function(e,t){return t.messageLeave?(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.leaveMsg.yes"}):(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.leaveMsg.no"})}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"channel"}),tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.channel.tooltip"}),dataIndex:"channel",copyable:!0,hideInSearch:!0,render:function(e,t){var a;return(0,ne.YG)(null==t||null===(a=t.thread)||void 0===a?void 0:a.channel)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:180,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.tooltip.createdAt"}),render:function(e,t,a,r){return U()(t.createdAt).format("YYYY-MM-DD HH:mm:ss")}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",width:180,hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.tooltip.updatedAt"}),render:function(e,t,a,r){return U()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss")}}]);L.push({title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:100,fixed:"right",render:function(t,a,r,s){return[(0,Y.jsx)("a",{onClick:function(){E(a)},children:e.formatMessage({id:"view",defaultMessage:"View"})},"view")]}});var E=function(e){var t,a;console.log("handleShowChatHistory",e);var r={chatConfig:{org:null==f?void 0:f.uid,t:F.CCt,sid:null==e||null===(t=e.thread)||void 0===t?void 0:t.uid}};null===(a=window.bytedesk)||void 0===a||a.showChat(r)},N=function(){var e=p()(g()().mark((function e(){var t;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",n,c),t=localStorage.getItem(F.LA8),window.open((0,w.kG)()+"/api/v1/queue/member/export?"+new URLSearchParams({orgUid:(null==f?void 0:f.uid)||"",pageNumber:String(n-1),pageSize:String(c),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(A.Z,{columns:L,actionRef:t,cardBordered:!0,scroll:{x:"max-content"},request:function(){var t=p()(g()().mark((function t(a,r,s){var n,u,l,c,p;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),n=a.current,u=a.pageSize,l=o()(a,be),i(n),m(u),c=d()({pageNumber:n-1,pageSize:u,orgUid:null==f?void 0:f.uid},l),t.next=7,(0,le.nV)(c);case 7:return p=t.sent,console.log("queryQueueMembersByOrg response:",c,p),x.yw.destroy(),200===p.code||x.yw.error(p.message),t.abrupt("return",{data:p.data.content,success:!0,total:p.data.totalElements});case 12:case"end":return t.stop()}}),t)})));return function(e,a,r){return t.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"queue.member.list"}),toolBarRender:function(){return[(0,Y.jsx)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",onClick:N,children:(0,Y.jsx)(M.FormattedMessage,{id:"queue.member.export"})},"button")]},columnsState:{persistenceKey:"queue-member-table",defaultValue:{}},options:{setting:{draggable:!0,checkable:!0,checkedReset:!0,extra:[(0,Y.jsx)("a",{onClick:function(){var e,a;null===(e=t.current)||void 0===e||null===(a=e.reset)||void 0===a||a.call(e)},children:(0,Y.jsx)(M.FormattedMessage,{id:"table.columns.reset"})},"reset")]}}}),(0,Y.jsx)(Me,{thread:R,drawerOpen:k,onClose:function(){return I(!1)}})]})},je=a(4112),Fe=a(40110),we=a(71194),ke=["current","pageSize"],Se=function(){var e=(0,M.useIntl)(),t=(0,D.useRef)(),a=(0,v.Z)().translateString,r=(0,D.useState)(1),s=h()(r,2),n=s[0],i=s[1],u=(0,D.useState)(10),c=h()(u,2),m=c[0],f=c[1],y=(0,j.u)((function(e){return e.currentOrg})),b=(0,D.useState)([]),k=h()(b,2),I=k[0],q=k[1],T=(0,D.useState)([]),C=h()(T,2),R=C[0],L=C[1],E=(0,D.useState)(!1),N=h()(E,2),H=N[0],z=N[1],O=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"uid",defaultMessage:"Uid"}),dataIndex:"uid",hideInSearch:!0,fixed:"left"},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.nickname"}),dataIndex:"nickname",copyable:!0,width:150,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.nickname.tooltip",defaultMessage:"客服或工作组的名称"}),render:function(e,t){return a(null==t?void 0:t.nickname)}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.type"}),dataIndex:"type",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.type.tooltip",defaultMessage:"接待类型：工作组、客服或机器人"}),render:function(e,t){switch(t.type){case F.VXt:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.type.workgroup"});case F.BOH:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.type.agent"});case F.aOw:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.type.robot"});default:return(0,Y.jsx)(M.FormattedMessage,{id:"queue.type.unknown"})}}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.day"}),dataIndex:"day",valueType:"date",tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.day.tooltip",defaultMessage:"统计的日期"}),search:{transform:function(e){return U()(e).format("YYYY-MM-DD")}}},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.totalCount"}),dataIndex:"totalCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.totalCount.tooltip",defaultMessage:"今日请求服务总人数"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.robotingCount"}),dataIndex:"robotingCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.robotingCount.tooltip",defaultMessage:"机器人服务中人次"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.offlineCount"}),dataIndex:"offlineCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.offlineCount.tooltip",defaultMessage:"客服离线人次"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.leaveMsgCount"}),dataIndex:"leaveMsgCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.leaveMsgCount.tooltip",defaultMessage:"访客留言数量"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.robotToAgentCount"}),dataIndex:"robotToAgentCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.robotToAgentCount.tooltip",defaultMessage:"从机器人转人工的次数"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.queuingCount"}),dataIndex:"queuingCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.queuingCount.tooltip",defaultMessage:"当前排队中人数"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.chattingCount"}),dataIndex:"chattingCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.chattingCount.tooltip",defaultMessage:"正在服务中人数"})},{title:(0,Y.jsx)(M.FormattedMessage,{id:"queue.closedCount"}),dataIndex:"closedCount",hideInSearch:!0,tooltip:(0,Y.jsx)(M.FormattedMessage,{id:"queue.closedCount.tooltip",defaultMessage:"已结束会话数量"})}],P=function(){var e=p()(g()().mark((function e(){var t;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",n,m),t=localStorage.getItem(F.LA8),window.open((0,w.kG)()+"/api/v1/queue/export?"+new URLSearchParams({orgUid:(null==y?void 0:y.uid)||"",pageNumber:String(n-1),pageSize:String(m),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(A.Z,{columns:O,actionRef:t,cardBordered:!0,scroll:{x:"max-content"},request:function(){var t=p()(g()().mark((function t(r,s,n){var u,c,m,p,h,M,b,v,j,F;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),z(!0),u=r.current,c=r.pageSize,m=o()(r,ke),i(u),f(c),p=d()({pageNumber:u-1,pageSize:c,orgUid:null==y?void 0:y.uid},m),t.next=8,(0,je.Wq)(p);case 8:if(h=t.sent,console.log("queryQueuesByOrg response:",p,h),x.yw.destroy(),z(!1),200!==h.code){t.next=37;break}(M=h.data.content.map((function(e){return{day:e.day,totalCount:e.totalCount,nickname:a(e.nickname)}}))).sort((function(e,t){return U()(e.day).diff(U()(t.day))})),q(M),b=[],v=l()(h.data.content),t.prev=18,F=g()().mark((function e(){var t,r,s;return g()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=j.value).threadsCountByHour&&t.threadsCountByHour.length>0&&(r=a(t.nickname),s=t.day||"",t.threadsCountByHour.forEach((function(e,t){b.push({hour:String(t)+"点",count:e,nickname:r,day:s})})));case 2:case"end":return e.stop()}}),e)})),v.s();case 21:if((j=v.n()).done){t.next=25;break}return t.delegateYield(F(),"t0",23);case 23:t.next=21;break;case 25:t.next=30;break;case 27:t.prev=27,t.t1=t.catch(18),v.e(t.t1);case 30:return t.prev=30,v.f(),t.finish(30);case 33:L(b),console.log("Hourly chart data sample:",b.slice(0,3)),t.next=38;break;case 37:x.yw.error(h.message);case 38:return t.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 39:case"end":return t.stop()}}),t,null,[[18,27,30,33]])})));return function(e,a,r){return t.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"queue.list"}),toolBarRender:function(){return[(0,Y.jsx)(Z.ZP,{icon:(0,Y.jsx)(S.Z,{}),type:"primary",onClick:P,children:(0,Y.jsx)(M.FormattedMessage,{id:"queue.export"})},"button")]}}),(0,Y.jsx)(Fe.Z,{title:e.formatMessage({id:"queue.totalCount.trend",defaultMessage:"总数趋势"}),style:{marginTop:16},children:(0,Y.jsx)(fe.Z,{spinning:H,children:I.length>0?(0,Y.jsx)(we.Z,{data:I,xField:"day",yField:"totalCount",seriesField:"nickname",colorField:"nickname",tooltip:function(e){return{name:e.nickname,title:e.day,value:e.totalCount}}}):(0,Y.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:e.formatMessage({id:"noData",defaultMessage:"暂无数据"})})})}),(0,Y.jsx)(Fe.Z,{title:e.formatMessage({id:"queue.hourly.trend",defaultMessage:"24小时接待人数趋势"}),style:{marginTop:16},children:(0,Y.jsx)(fe.Z,{spinning:H,children:R.length>0?(0,Y.jsx)(we.Z,d()(d()({},{smooth:!0,animation:!1,lineStyle:{lineWidth:100},point:{size:5,style:{lineWidth:15}},state:{active:{style:{shadowBlur:4,stroke:"#000",fill:"red"}}},tooltip:{shared:!0}}),{},{data:R,xField:"hour",yField:"count",seriesField:"nickname",colorField:"nickname",tooltip:function(e){return{name:e.nickname,title:"".concat(e.hour,":00"),value:"".concat(e.count).concat(e.day?" (".concat(e.day,")"):"")}}})):(0,Y.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:e.formatMessage({id:"noData",defaultMessage:"暂无数据"})})})})]})},Ie=function(){var e=(0,M.useIntl)(),t=[{key:"thread",label:e.formatMessage({id:"thread.tab.all"}),children:(0,Y.jsx)(s.Z,{type:F.Nqz})}];return(0,w.OJ)()&&t.push({key:"queue",label:e.formatMessage({id:"queue.tab.list"}),children:(0,Y.jsx)(Se,{})},{key:"queue_member",label:e.formatMessage({id:"queue.tab.member"}),children:(0,Y.jsx)(ve,{})},{key:"rate",label:e.formatMessage({id:"thread.tab.rate"}),children:(0,Y.jsx)(re,{})},{key:"transfer",label:e.formatMessage({id:"thread.tab.transfer"}),children:(0,Y.jsx)(J,{})},{key:"invite",label:e.formatMessage({id:"thread.tab.invite"}),children:(0,Y.jsx)(N,{})},{key:"summary",label:e.formatMessage({id:"thread.tab.summary"}),children:(0,Y.jsx)(X,{})}),(0,w.Ox)()||t.push({key:"thread.group",label:e.formatMessage({id:"thread.tab.group"}),children:(0,Y.jsx)(ie,{type:F.Nqz})},{key:"thread.member",label:e.formatMessage({id:"thread.tab.member"}),children:(0,Y.jsx)(ue,{type:F.Nqz})}),(0,Y.jsx)(r.Z,{defaultActiveKey:"thread",items:t,style:{padding:"10px"}})}},50246:function(e,t,a){a.d(t,{Z:function(){return i}});var r=a(39497),s=a(58063),n=a(66266),o=a(31403),i=(0,s.Ue)()((0,n.mW)((0,n.tJ)((0,o.n)((function(e,t){return{memberResult:{data:{content:[],totalElements:0}},insertMember:function(t){e((function(e){e.memberResult.data.content.unshift(t)}))},updateMember:function(t){e((function(e){var a=e.memberResult.data.content,r=a.findIndex((function(e){return e.uid===t.uid}));-1!==r?a[r]=t:console.warn("Member with uid ".concat(t.uid," not found."))}))},deleteMember:function(t){e((function(e){var a=e.memberResult.data.content,r=a.findIndex((function(e){return e.uid===t.uid}));-1!==r?a.splice(r,1):console.warn("Member with uid ".concat(t.uid," not found."))}))},setMemberResult:function(t){e({memberResult:t})},deleteMemberCache:function(){return e({},!0)}}})),{name:r.PQL})))}}]);