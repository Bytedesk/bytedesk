"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8166],{77519:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var r=a(31699),s=a(8247),n=a(55735),o=a(73193),l=a.n(o),i=a(84176),c=a.n(i),d=a(90819),u=a.n(d),g=a(89933),p=a.n(g),m=a(45332),f=a.n(m),x=a(86803),b=a(76750),v=a(40612),h=a(44521),y=a(11090),k=a(81947),M=a(30921),C=a(75365),w=a(44194);function j(e){return S.apply(this,arguments)}function S(){return(S=p()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/robot/message/query/org",{method:"GET",params:l()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=a(31549),I=["current","pageSize"],$=function(){var e=(0,M.useIntl)(),t=(0,w.useRef)(),a=(0,b.Z)().translateString,r=(0,v.u)((function(e){return e.currentOrg})),s=(0,w.useState)(1),o=f()(s,2),i=o[0],d=o[1],g=(0,w.useState)(10),m=f()(g,2),S=m[0],$=m[1],O=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,F.jsx)(M.FormattedMessage,{id:"nickname",defaultMessage:"Nickname"}),dataIndex:"userNickname",width:120,fixed:"left",render:function(e,t){var r;return(0,F.jsx)(F.Fragment,{children:a(null==t||null===(r=t.user)||void 0===r?void 0:r.nickname)})}},{title:(0,F.jsx)(M.FormattedMessage,{id:"queue.member.robot",defaultMessage:"robotNickname"}),dataIndex:"robotNickname",width:120,fixed:"left",render:function(e,t){var r;return(0,F.jsx)(F.Fragment,{children:a(null==t||null===(r=t.robot)||void 0===r?void 0:r.nickname)})}},{title:(0,F.jsx)(M.FormattedMessage,{id:"question",defaultMessage:"Question"}),dataIndex:"content",ellipsis:!0},{title:(0,F.jsx)(M.FormattedMessage,{id:"answer",defaultMessage:"Answer"}),dataIndex:"answer",width:300,ellipsis:!0},{title:(0,F.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",width:180,sorter:!0,hideInSearch:!0},{title:e.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",width:80,fixed:"right",render:function(t,a,r,s){return[(0,F.jsx)("a",{onClick:function(){E(a)},children:e.formatMessage({id:"view",defaultMessage:"View"})},"editable")]}}],E=function(e){var t;console.log("handleShowChatHistory",e);var a={chatConfig:{org:null==r?void 0:r.uid,t:n.IUl,sid:null==e?void 0:e.threadUid}};null===(t=window.bytedesk)||void 0===t||t.showChat(a)},B=function(){var e=p()(u()().mark((function e(){var t;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",i,S),t=localStorage.getItem(n.LA8),window.open((0,h.kG)()+"/api/v1/robot/message/export?"+new URLSearchParams({orgUid:(null==r?void 0:r.uid)||"",pageNumber:String(i-1),pageSize:String(S),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,F.jsx)(k.Z,{columns:O,actionRef:t,cardBordered:!0,scroll:{x:"max-content"},request:function(){var e=p()(u()().mark((function e(t,a,s){var n,o,i,g,p;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request:",t,a,s),n=t.current,o=t.pageSize,i=c()(t,I),d(n),$(o),g=l()({pageNumber:n-1,pageSize:o,orgUid:null==r?void 0:r.uid},i),e.next=7,j(g);case 7:return p=e.sent,console.log("getAllRobotMessages response:",g,p),200===p.code||x.yw.error(p.message),e.abrupt("return",{data:p.data.content,success:!0,total:p.data.totalElements});case 11:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",toolBarRender:function(){return[(0,F.jsx)(C.ZP,{icon:(0,F.jsx)(y.Z,{}),type:"primary",onClick:B,children:e.formatMessage({id:"export",defaultMessage:"Export"})},"button")]}})},O=a(10154),E=a.n(O);function B(e){return N.apply(this,arguments)}function N(){return(N=p()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/leavemsg/query/org",{method:"GET",params:l()(l()({},t),{},{client:n.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=a(29266),P=a(28977),z=a.n(P),A=["current","pageSize"],R=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:(0,F.jsx)(M.FormattedMessage,{id:"contact",defaultMessage:"Contact"}),dataIndex:"contact",copyable:!0},{title:(0,F.jsx)(M.FormattedMessage,{id:"content",defaultMessage:"Content"}),dataIndex:"content",copyable:!0},{title:(0,F.jsx)(M.FormattedMessage,{id:"images",defaultMessage:"Images"}),dataIndex:"images",copyable:!0,hideInSearch:!0,render:function(e,t,a,r){return t.images.map((function(e,t){return(0,F.jsx)("img",{src:e,alt:"image",style:{width:"60px",height:"60px",objectFit:"cover",cursor:"pointer"},onClick:function(){return function(e){window.open(e,"_blank")}(e)}},t)}))}},{title:(0,F.jsx)(M.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",copyable:!0,valueType:"select",valueEnum:E()(E()(E()(E()(E()(E()(E()(E()(E()({},n.d23,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.pending",defaultMessage:"待处理"}),status:"default"}),n.m7i,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.processing",defaultMessage:"处理中"}),status:"processing"}),n.d3_,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.read",defaultMessage:"已读"}),status:"default"}),n.oLW,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.replied",defaultMessage:"已回复"}),status:"success"}),n.KBB,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.transferred",defaultMessage:"已转接"}),status:"warning"}),n.v3R,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.escalated",defaultMessage:"已升级"}),status:"warning"}),n.uke,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.closed",defaultMessage:"已关闭"}),status:"success"}),n.fEl,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.spam",defaultMessage:"垃圾留言"}),status:"error"}),n.K0y,{text:(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.invalid",defaultMessage:"无效留言"}),status:"error"}),render:function(e,t){var a="default",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.unknown",defaultMessage:"未知状态"});switch(null==t?void 0:t.status){case n.d23:a="default",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.pending",defaultMessage:"待处理"});break;case n.m7i:a="processing",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.processing",defaultMessage:"处理中"});break;case n.d3_:a="blue",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.read",defaultMessage:"已读"});break;case n.oLW:a="success",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.replied",defaultMessage:"已回复"});break;case n.KBB:a="warning",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.transferred",defaultMessage:"已转接"});break;case n.v3R:a="warning",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.escalated",defaultMessage:"已升级"});break;case n.uke:a="success",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.closed",defaultMessage:"已关闭"});break;case n.fEl:a="error",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.spam",defaultMessage:"垃圾留言"});break;case n.K0y:a="error",r=(0,F.jsx)(M.FormattedMessage,{id:"leave.msg.status.invalid",defaultMessage:"无效留言"})}return(0,F.jsx)(T.Z,{color:a,children:r})}},{title:(0,F.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,render:function(e,t,a,r){return z()(t.createdAt).format("YYYY-MM-DD HH:mm:ss")}}],q=function(){var e=(0,M.useIntl)(),t=(0,w.useRef)(),a=(0,w.useState)(1),r=f()(a,2),s=r[0],o=r[1],i=(0,w.useState)(10),d=f()(i,2),g=d[0],m=d[1],b=(0,v.u)((function(e){return e.currentOrg})),j=[].concat(R),S=function(){var e=p()(u()().mark((function e(){var t;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",s,g),t=localStorage.getItem(n.LA8),window.open((0,h.kG)()+"/api/v1/leavemsg/export?"+new URLSearchParams({orgUid:(null==b?void 0:b.uid)||"",pageNumber:String(s-1),pageSize:String(g),accessToken:t||""}).toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,F.jsx)(k.Z,{columns:j,actionRef:t,cardBordered:!0,request:function(){var e=p()(u()().mark((function e(t,a,r){var s,n,i,d,g;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.current,n=t.pageSize,i=c()(t,A),o(s),m(n),d=l()({pageNumber:s-1,pageSize:n,orgUid:null==b?void 0:b.uid},i),e.next=6,B(d);case 6:return g=e.sent,console.log("queryLeaveMsgsByOrg response:",g,d),200===g.code||x.yw.error(g.message),e.abrupt("return",{data:g.data.content,success:!0,total:g.data.totalElements});case 10:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),editable:{type:"multiple"},rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",toolBarRender:function(){return[(0,F.jsx)(C.ZP,{icon:(0,F.jsx)(y.Z,{}),type:"primary",onClick:S,children:e.formatMessage({id:"export",defaultMessage:"Export"})},"button")]}})},Z=function(){var e=(0,M.useIntl)().formatMessage,t=[{key:"message",label:e({id:"message.tab.all"}),children:(0,F.jsx)(r.Z,{type:n.Nqz})},{key:"robotMessage",label:e({id:"message.tab.robot"}),children:(0,F.jsx)($,{})},{key:"messageLeave",label:e({id:"message.tab.leave"}),children:(0,F.jsx)(q,{})}];return(0,F.jsx)(F.Fragment,{children:(0,F.jsx)(s.Z,{defaultActiveKey:"message",items:t})})}},29266:function(e,t,a){a.d(t,{Z:function(){return O}});var r=a(44194),s=a(51865),n=a.n(s),o=a(97859),l=a(63125),i=a(80314),c=a(79145),d=a(18011),u=a(37167),g=a(47825),p=a(87471),m=a(88874),f=a(77167),x=a(65759);const b=e=>{const{lineWidth:t,fontSizeIcon:a,calc:r}=e,s=e.fontSizeSM;return(0,f.IX)(e,{tagFontSize:s,tagLineHeight:(0,g.bf)(r(e.lineHeightSM).mul(s).equal()),tagIconSize:r(a).sub(r(t).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},v=e=>({defaultBg:new p.t(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var h=(0,x.I$)("Tag",(e=>(e=>{const{paddingXXS:t,lineWidth:a,tagPaddingHorizontal:r,componentCls:s,calc:n}=e,o=n(r).sub(a).equal(),l=n(t).sub(a).equal();return{[s]:Object.assign(Object.assign({},(0,m.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:o,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,g.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${s}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${s}-close-icon`]:{marginInlineStart:l,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${s}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${s}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:o}}),[`${s}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}})(b(e))),v),y=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(a[r[s]]=e[r[s]])}return a};const k=r.forwardRef(((e,t)=>{const{prefixCls:a,style:s,className:o,checked:l,onChange:i,onClick:c}=e,d=y(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:g,tag:p}=r.useContext(u.E_),m=g("tag",a),[f,x,b]=h(m),v=n()(m,`${m}-checkable`,{[`${m}-checkable-checked`]:l},null==p?void 0:p.className,o,x,b);return f(r.createElement("span",Object.assign({},d,{ref:t,style:Object.assign(Object.assign({},s),null==p?void 0:p.style),className:v,onClick:e=>{null==i||i(!l),null==c||c(e)}})))}));var M=k,C=a(85772);var w=(0,x.bk)(["Tag","preset"],(e=>(e=>(0,C.Z)(e,((t,a)=>{let{textColor:r,lightBorderColor:s,lightColor:n,darkColor:o}=a;return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:r,background:n,borderColor:s,"&-inverse":{color:e.colorTextLightSolid,background:o,borderColor:o},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}})))(b(e))),v);const j=(e,t,a)=>{const r="string"!=typeof(s=a)?s:s.charAt(0).toUpperCase()+s.slice(1);var s;return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:e[`color${a}`],background:e[`color${r}Bg`],borderColor:e[`color${r}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var S=(0,x.bk)(["Tag","status"],(e=>{const t=b(e);return[j(t,"success","Success"),j(t,"processing","Info"),j(t,"error","Error"),j(t,"warning","Warning")]}),v),F=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(a[r[s]]=e[r[s]])}return a};const I=r.forwardRef(((e,t)=>{const{prefixCls:a,className:s,rootClassName:g,style:p,children:m,icon:f,color:x,onClose:b,bordered:v=!0,visible:y}=e,k=F(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:M,direction:C,tag:j}=r.useContext(u.E_),[I,$]=r.useState(!0),O=(0,o.Z)(k,["closeIcon","closable"]);r.useEffect((()=>{void 0!==y&&$(y)}),[y]);const E=(0,l.o2)(x),B=(0,l.yT)(x),N=E||B,T=Object.assign(Object.assign({backgroundColor:x&&!N?x:void 0},null==j?void 0:j.style),p),P=M("tag",a),[z,A,R]=h(P),q=n()(P,null==j?void 0:j.className,{[`${P}-${x}`]:N,[`${P}-has-color`]:x&&!N,[`${P}-hidden`]:!I,[`${P}-rtl`]:"rtl"===C,[`${P}-borderless`]:!v},s,g,A,R),Z=e=>{e.stopPropagation(),null==b||b(e),e.defaultPrevented||$(!1)},[,L]=(0,i.Z)((0,i.w)(e),(0,i.w)(j),{closable:!1,closeIconRender:e=>{const t=r.createElement("span",{className:`${P}-close-icon`,onClick:Z},e);return(0,c.wm)(e,t,(e=>({onClick:t=>{var a;null===(a=null==e?void 0:e.onClick)||void 0===a||a.call(e,t),Z(t)},className:n()(null==e?void 0:e.className,`${P}-close-icon`)})))}}),H="function"==typeof k.onClick||m&&"a"===m.type,U=f||null,W=U?r.createElement(r.Fragment,null,U,m&&r.createElement("span",null,m)):m,K=r.createElement("span",Object.assign({},O,{ref:t,className:q,style:T}),W,L,E&&r.createElement(w,{key:"preset",prefixCls:P}),B&&r.createElement(S,{key:"status",prefixCls:P}));return z(H?r.createElement(d.Z,{component:"Tag"},K):K)})),$=I;$.CheckableTag=M;var O=$}}]);