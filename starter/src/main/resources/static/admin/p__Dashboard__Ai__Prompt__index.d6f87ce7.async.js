"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1466],{28031:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(83910),a=n(44194),o={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},i=n(5901),s=function(e,t){return a.createElement(i.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(s)},22014:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(83910),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},i=n(5901),s=function(e,t){return a.createElement(i.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(s)},26608:function(e,t,n){var r=n(94433),a=n(38956),o=n(44194),i=n(46659),s=n(31549),l=["fieldProps","proFieldProps"],d=function(e,t){var n=e.fieldProps,o=e.proFieldProps,d=(0,a.Z)(e,l);return(0,s.jsx)(i.Z,(0,r.Z)({ref:t,valueType:"textarea",fieldProps:n,proFieldProps:o},d))};t.Z=o.forwardRef(d)},94571:function(e,t,n){n.d(t,{$l:function(){return h},JT:function(){return y},Xd:function(){return b},gf:function(){return j},lg:function(){return f},p0:function(){return c},s9:function(){return m}});var r=n(90819),a=n.n(r),o=n(73193),i=n.n(o),s=n(89933),l=n.n(s),d=n(68992),u=n(62395);function c(e){return p.apply(this,arguments)}function p(){return(p=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/query/org",{method:"GET",params:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/create",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/create/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return M.apply(this,arguments)}function M(){return(M=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/kbUid",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return S.apply(this,arguments)}function S(){return(S=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/delete",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},65041:function(e,t,n){n.d(t,{G:function(){return f}});var r=n(73193),a=n.n(r),o=(n(44194),n(2348)),i=n(68992),s=n(45634),l=n.n(s),d=n(46130),u=n(61489),c=n(87005),p=n(31549),f=function(e){var t=e.children,n=e.onSuccess,r=e.onError,s={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:i.IrL,categoryUid:"",kbUid:"",channel:i.XtJ},f={name:"file",accept:"image/*",action:(0,c.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(i.LA8)},data:s,showUploadList:!1,beforeUpload:function(e){d.Z.log("beforeUpload",e);var t=l()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return s.file=e,s.fileName=t,s.fileType=e.type,d.Z.log("beforeUpload",s),!0},onChange:function(e){if("uploading"!==e.file.status&&d.Z.log("not uploading:",e.file),"done"===e.file.status)if(d.Z.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data.fileUrl;n(t),u.yw.success("".concat(e.file.name," 上传成功"))}else r(e.file),u.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(u.yw.error("".concat(e.file.name," 上传失败")),r(e.file))}};return(0,p.jsx)(o.Z,a()(a()({},f),{},{children:t}))}},14766:function(e,t,n){n.r(t),n.d(t,{default:function(){return se}});var r=n(88130),a=n(38552),o=n(68992),i=n(84176),s=n.n(i),l=n(73193),d=n.n(l),u=n(90819),c=n.n(u),p=n(89933),f=n.n(p),g=n(45332),m=n.n(g),v=n(44194),h=n(35068),x=n(72264),y=n(62954),M=n(77902),b=n(6237),w=n(61489),j=n(94571),S=n(62395),k=n(77643),Z=n(10154),P=n.n(Z),I=n(77686),U=n(89007),T=n(50447),C=n(47268),E=n(26608),A=n(69650),z=n(41059),O=n(89654),B=n(27401),F=n(63052),q=n(65041),H=n(22014),D=n(99754),Y=n(41558),J=n(16743),L=n(31549),V=A.Z.Text,K=function(e){var t,n,r,a=e.isEdit,i=e.robot,s=e.open,l=e.level,u=e.onClose,p=e.onSubmit,g=U.A.useForm(),h=m()(g,1)[0],y=(0,S.useIntl)(),M=(0,I.u)((function(e){return e.currentOrg})),b=(0,v.useState)("https://cdn.weiyuai.cn/assets/images/llm/provider/zhipu.png"),j=m()(b,2),Z=j[0],A=(j[1],(0,v.useState)()),K=m()(A,2),R=K[0],X=K[1],N=(0,k.v)((function(e){return e.categoryResult})),Q=(0,D.Z)(),_=Q.translateString,G=(Q.translateStringTranct,(0,v.useState)(!1)),W=m()(G,2),$=W[0],ee=W[1],te=(0,v.useState)([]),ne=m()(te,2),re=ne[0],ae=ne[1],oe=(0,v.useState)({}),ie=m()(oe,2),se=ie[0],le=ie[1],de=(0,v.useState)(!1),ue=m()(de,2),ce=ue[0],pe=ue[1],fe=(0,v.useState)(""),ge=m()(fe,2),me=ge[0],ve=ge[1],he=(0,v.useState)(""),xe=m()(he,2),ye=xe[0],Me=xe[1],be=(0,v.useState)(""),we=m()(be,2),je=we[0],Se=we[1],ke=(0,v.useState)(""),Ze=m()(ke,2),Pe=Ze[0],Ie=Ze[1];(0,v.useEffect)((function(){if(a&&i&&h){var e,t,n,r,o,s,l;h.setFieldsValue({uid:null==i?void 0:i.uid,nickname:null==i?void 0:i.nickname,name:null==i?void 0:i.name,prompt:null==i||null===(e=i.settings)||void 0===e||null===(e=e.llm)||void 0===e?void 0:e.prompt,description:null==i?void 0:i.description,categoryUid:null==i?void 0:i.categoryUid,provider:null==i||null===(t=i.settings)||void 0===t||null===(t=t.llm)||void 0===t?void 0:t.textProvider,model:null==i||null===(n=i.settings)||void 0===n||null===(n=n.llm)||void 0===n?void 0:n.textModel});var d=null==N||null===(r=N.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.find((function(e){return e.uid===(null==i?void 0:i.categoryUid)}));X(d),ve((null==i||null===(o=i.settings)||void 0===o||null===(o=o.llm)||void 0===o?void 0:o.textProvider)||""),Me((null==i||null===(s=i.settings)||void 0===s||null===(s=s.llm)||void 0===s?void 0:s.textProviderUid)||""),Se((null==i||null===(l=i.settings)||void 0===l||null===(l=l.llm)||void 0===l?void 0:l.textModel)||""),ee((null==i?void 0:i.system)||!1)}else console.log("form resetFields"),h.resetFields(),ve(""),Se(""),Ie(""),ee(!1);Ue()}),[i]);var Ue=function(){var e=f()(c()().mark((function e(){var t,n,r,s,l,d,u;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={pageNumber:0,pageSize:100,sortBy:"createdAt",sortDirection:"ascend",orgUid:null==M?void 0:M.uid,level:o.whQ},e.next=4,(0,J.mK)(t);case 4:200===(n=e.sent).code?(r=n.data.content||[],ae(r),a&&i&&(!(d=null==i||null===(s=i.settings)||void 0===s||null===(s=s.llm)||void 0===s?void 0:s.textProviderUid)&&null!=i&&null!==(l=i.settings)&&void 0!==l&&null!==(l=l.llm)&&void 0!==l&&l.textProvider?(u=r.find((function(e){return e.type===i.settings.llm.textProvider})))&&Me(u.uid):d&&Me(d))):w.yw.error(n.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch providers:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Te=(0,v.useCallback)((function(){pe(!0)}),[]),Ce=(0,v.useCallback)((function(){pe(!1)}),[]),Ee=(0,v.useCallback)((function(e,t,n){var r=re.find((function(t){return t.uid===e})),a=r?r.type:e;ve(a),Me(e),Se(t),Ie(n),h.setFieldValue("provider",a),h.setFieldValue("model",t),pe(!1)}),[h,re]),Ae=(0,v.useCallback)((function(e,t){le((function(n){return d()(d()({},n),{},P()({},e,t))}))}),[]);(0,v.useEffect)((function(){var e=ye,t=je;if(e&&t&&se[e]){var n=se[e].find((function(e){return e.value===t}));n&&Ie(n.label)}}),[se,ye,je]);(0,v.useEffect)((function(){}),[i]);return(0,L.jsx)("div",{children:(0,L.jsxs)(z.Z,{title:a?"编辑提示语":"新建提示语",width:650,onClose:u,open:s,extra:(0,L.jsxs)(O.Z,{children:[(0,L.jsx)(x.ZP,{onClick:u,children:"取消"}),(0,L.jsx)(x.ZP,{onClick:function(){console.log("handleSubmit"),h.validateFields().then((function(e){var t;console.log("Form values:",e);var n=re.find((function(e){return e.uid===ye}))||re.find((function(t){return t.type===e.provider})),r=(null==n?void 0:n.type)||e.provider,s=ye||(null==n?void 0:n.uid)||"",u={uid:a?null==i?void 0:i.uid:"",nickname:e.nickname,name:e.name,avatar:Z,categoryUid:null==R?void 0:R.uid,description:e.description,type:o.Qeb,level:l,orgUid:null==M?void 0:M.uid},c={uid:null==i||null===(t=i.settings)||void 0===t?void 0:t.uid,llm:{prompt:e.prompt,textProvider:r,textProviderUid:s,textModel:e.model}};console.log("robotObject:",u,"settingsObject:",c),p(d()(d()({},u),{},{__settings__:c}))})).catch((function(e){console.log("Form errors:",e)}))},type:"primary",children:"保存"})]}),children:[(0,L.jsxs)(U.A,{form:h,name:"model",submitter:!1,children:[(0,L.jsx)(T.Z,{label:"类别",name:"categoryUid",required:!0,options:null==N||null===(t=N.data)||void 0===t||null===(t=t.content)||void 0===t||null===(t=t.filter((function(e){return e.uid!==o.zBg})))||void 0===t?void 0:t.map((function(e){return{label:_(null==e?void 0:e.name),value:null==e?void 0:e.uid}})),fieldProps:{allowClear:!0,onChange:function(e){var t;console.log("handleChange:",e),X(null==N||null===(t=N.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.find((function(t){return t.uid===e})))}}}),(0,L.jsx)(C.Z,{label:"昵称",name:"nickname",required:!0,tooltip:"显示给用户的名称"}),(0,L.jsx)(C.Z,{label:"名称",name:"name",tooltip:"内部识别使用的名称",disabled:$,fieldProps:{placeholder:$?"系统代理不可修改名称":"请输入名称"}}),$&&(0,L.jsx)("div",{style:{color:"#ff4d4f",fontSize:"12px",marginTop:"-20px",marginBottom:"10px"},children:"系统内置代理，无法修改名称"}),(0,L.jsx)(U.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:y.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,L.jsxs)(q.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e)},onError:function(e){console.log("handleUploadError:",e),w.yw.error(e)},children:[(0,L.jsx)(B.Z,{src:Z}),(0,L.jsx)(x.ZP,{icon:(0,L.jsx)(H.Z,{}),children:y.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,L.jsxs)("div",{children:[(0,L.jsx)(V,{style:{marginBottom:"8px",display:"block"},children:"文字对话模型提供商"}),(0,L.jsx)(F.Z,{size:"small",style:{width:"100%",cursor:"pointer",border:"1px solid #d9d9d9",marginBottom:"16px"},onClick:Te,children:(ye||me)&&je?(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(V,{type:"secondary",children:"供应商："}),(0,L.jsx)(V,{strong:!0,children:_((null===(n=re.find((function(e){return e.uid===ye})))||void 0===n?void 0:n.nickname)||(null===(r=re.find((function(e){return e.type===me})))||void 0===r?void 0:r.nickname)||me)}),(0,L.jsx)("br",{}),(0,L.jsx)(V,{type:"secondary",children:"模型："}),(0,L.jsx)(V,{strong:!0,children:Pe||je})]}),(0,L.jsx)(x.ZP,{type:"primary",children:"更换模型"})]}):(0,L.jsx)("div",{style:{textAlign:"center"},children:(0,L.jsx)(x.ZP,{type:"primary",children:"选择AI模型"})})}),(0,L.jsxs)("div",{style:{display:"none"},children:[(0,L.jsx)(T.Z,{name:"provider",width:"lg"}),(0,L.jsx)(T.Z,{name:"model",width:"lg"})]})]}),(0,L.jsx)(E.Z,{label:"提示语Prompt",name:"prompt",required:!0}),(0,L.jsx)(E.Z,{label:"简介描述",name:"description"})]}),(0,L.jsx)(Y.Z,{visible:ce,onCancel:Ce,onOk:Ee,initialProvider:ye||me,initialModel:je,initialModelLabel:Pe,providers:re,currentOrgUid:null==M?void 0:M.uid,existingProviderModels:se,onModelsLoaded:Ae,allowedModelTypes:[o.l55,o.xZ8,"CHAT"]})]})})},R=n(32164),X=n(41881),N=n(83381),Q=n(91768),_=n(6992),G=n(28031),W=n(80503),$=n(54596),ee=n(45634),te=n.n(ee),ne=n(87005),re=n(62134),ae=["current","pageSize","prompt"],oe=function(e){var t=e.level,n=(e.type,(0,v.useRef)()),r=(0,S.useIntl)(),a=(0,v.useState)(!0),i=m()(a,2),l=i[0],u=i[1],p=(0,D.Z)().translateString,g=(0,v.useState)(1),Z=m()(g,2),P=Z[0],U=Z[1],T=(0,v.useState)(10),C=m()(T,2),E=C[0],A=C[1],z=(0,v.useState)(!1),O=m()(z,2),B=O[0],F=O[1],q=(0,v.useState)([]),H=m()(q,2),Y=(H[0],H[1]),J=(0,v.useState)({}),V=m()(J,2),ee=V[0],oe=V[1],ie=(0,k.v)((function(e){return e.currentCategory})),se=(0,I.u)((function(e){return e.currentOrg})),le=(0,v.useState)(0),de=m()(le,2),ue=de[0],ce=de[1],pe=(0,v.useState)({}),fe=m()(pe,2),ge=fe[0],me=fe[1],ve=function(){var e=f()(c()().mark((function e(t){var a,o;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.yw.loading(r.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=3,(0,j.gf)(t);case 3:200===(a=e.sent).code?(w.yw.destroy(),w.yw.success(r.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),null===(o=n.current)||void 0===o||o.reload()):(w.yw.destroy(),w.yw.error(a.message));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=f()(c()().mark((function e(t){var a,o,i,s;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=8;break}return w.yw.loading(r.formatMessage({id:"updating",defaultMessage:"Updating"})),e.next=4,(0,j.JT)(t);case 4:200===(a=e.sent).code?(w.yw.success(r.formatMessage({id:"update.success",defaultMessage:"update success"})),null===(o=n.current)||void 0===o||o.reload(),F(!1)):w.yw.error(a.message),e.next=13;break;case 8:return w.yw.loading(r.formatMessage({id:"creating",defaultMessage:"Creating"})),e.next=11,(0,j.s9)(t);case 11:200===(i=e.sent).code?(w.yw.success(r.formatMessage({id:"create.success",defaultMessage:"create success"})),null===(s=n.current)||void 0===s||s.reload(),F(!1)):w.yw.error(i.message);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.reload()}),[ie]);var xe=function(){var e=f()(c()().mark((function e(n,r,a){var i,s,l;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",n,r,a),i=localStorage.getItem(o.LA8),s=d()({categoryUid:(null==ie?void 0:ie.uid)===o.zBg?"":null==ie?void 0:ie.uid,orgUid:t===o.Hxq?"":null==se?void 0:se.uid,level:t,type:o.Qeb,accessToken:i||"",exportType:n},ge),"current"===n?(s.pageNumber=String(P-1),s.pageSize=String(E)):"all"===n?(s.pageNumber="0",s.pageSize="1000"):"range"===n&&void 0!==r&&void 0!==a&&(s.pageNumber=String(r),s.pageSize=String(a)),l=Object.fromEntries(Object.entries(s).filter((function(e){var t=m()(e,2),n=(t[0],t[1]);return null!=n})).map((function(e){var t=m()(e,2),n=t[0],r=t[1];return[n,String(r)]}))),window.open((0,ne.kG)()+"/api/v1/robot/export?"+new URLSearchParams(l).toString());case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),ye=function(e){for(var t=[],n=1e3,r=Math.ceil(e/n),a=function(){var r=o,a=o*n+1,i=Math.min((o+1)*n,e);t.push({key:"export-".concat(o),label:"".concat(a,"-").concat(i," (").concat(i-a+1,"条)"),onClick:function(){return xe("range",r,n)}})},o=0;o<r;o++)a();return t},Me=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:r.formatMessage({id:"pages.prompt.uid",defaultMessage:"UID"}),dataIndex:"uid",hideInSearch:!0,fixed:"left"},{title:r.formatMessage({id:"pages.prompt.nickname",defaultMessage:"昵称"}),dataIndex:"nickname",hideInSearch:!1,fixed:"left",width:150,copyable:!0,ellipsis:!0,tooltip:r.formatMessage({id:"pages.prompt.nickname.tooltip",defaultMessage:"代理的昵称，用于展示"})},{title:r.formatMessage({id:"pages.prompt.name",defaultMessage:"名称"}),dataIndex:"name",width:200,copyable:!0,ellipsis:!0,tooltip:r.formatMessage({id:"pages.prompt.name.tooltip",defaultMessage:"代理的名称，用于内部识别"})},{title:r.formatMessage({id:"pages.prompt.description",defaultMessage:"描述"}),dataIndex:"description",width:200,copyable:!0,ellipsis:!0,tooltip:r.formatMessage({id:"pages.prompt.description.tooltip",defaultMessage:"代理的功能描述"})},{title:r.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),dataIndex:"prompt",ellipsis:!0,hideInSearch:!1,copyable:!0,width:250,tooltip:r.formatMessage({id:"pages.prompt.prompt.tooltip",defaultMessage:"传递给模型的指令和上下文"}),render:function(e,t){var n,a=(null===(n=t.settings)||void 0===n||null===(n=n.llm)||void 0===n?void 0:n.prompt)||"-",o=function(){var e=f()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,re.TE)(t);case 2:e.sent.success?w.yw.success(r.formatMessage({id:"copy.success",defaultMessage:"复制成功"})):w.yw.error(r.formatMessage({id:"copy.failed",defaultMessage:"复制失败"}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,L.jsx)(h.Z,{content:(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,L.jsx)("span",{children:r.formatMessage({id:"pages.prompt.prompt.content",defaultMessage:"提示词内容"})}),(0,L.jsx)(x.ZP,{type:"text",icon:(0,L.jsx)(R.Z,{}),onClick:function(e){e.stopPropagation(),o(a)},title:r.formatMessage({id:"copy.to.clipboard",defaultMessage:"复制到剪贴板"})})]}),(0,L.jsx)("div",{style:{maxWidth:"600px",maxHeight:"400px",overflow:"auto",whiteSpace:"pre-wrap"},children:a})]}),title:r.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),trigger:"hover",overlayStyle:{maxWidth:"800px"},children:(0,L.jsx)("span",{style:{cursor:"pointer"},children:a})})}},{title:r.formatMessage({id:"pages.prompt.textProvider",defaultMessage:"文本模型提供商"}),dataIndex:["settings","llm","textProvider"],hideInSearch:!0,width:150,tooltip:r.formatMessage({id:"pages.prompt.textProvider.tooltip",defaultMessage:"文本模型提供商"})},{title:r.formatMessage({id:"pages.prompt.textProviderUid",defaultMessage:"文本模型提供商UID"}),dataIndex:["settings","llm","textProviderUid"],hideInSearch:!0,width:160,tooltip:r.formatMessage({id:"pages.prompt.textProvider.tooltip",defaultMessage:"文本模型提供商Uid"}),render:function(e,t){var n,r=null===(n=t.settings)||void 0===n||null===(n=n.llm)||void 0===n?void 0:n.textProviderUid;return r||(0,L.jsx)("span",{style:{color:"#ff4d4f",fontWeight:600},children:"需要填写"})}},{title:r.formatMessage({id:"pages.prompt.model",defaultMessage:"模型"}),dataIndex:["settings","llm","textModel"],hideInSearch:!0,width:150,tooltip:r.formatMessage({id:"pages.prompt.model.tooltip",defaultMessage:"使用的大语言模型"})},{title:r.formatMessage({id:"pages.prompt.temperature",defaultMessage:"温度"}),dataIndex:["settings","llm","temperature"],hideInSearch:!0,width:80,tooltip:r.formatMessage({id:"pages.prompt.temperature.tooltip",defaultMessage:"控制输出的随机性，值越高输出越随机创新"}),render:function(e,t){var n,r;return 0===(null===(n=t.settings)||void 0===n||null===(n=n.llm)||void 0===n?void 0:n.temperature)?"0":(null===(r=t.settings)||void 0===r||null===(r=r.llm)||void 0===r?void 0:r.temperature)||"-"}},{title:r.formatMessage({id:"pages.prompt.topK",defaultMessage:"Top K"}),dataIndex:["settings","llm","topK"],hideInSearch:!0,width:80,tooltip:r.formatMessage({id:"pages.prompt.topK.tooltip",defaultMessage:"检索时返回的相关文档数量"}),render:function(e,t){var n;return(null===(n=t.settings)||void 0===n||null===(n=n.llm)||void 0===n?void 0:n.topK)||"-"}},{title:r.formatMessage({id:"pages.prompt.system",defaultMessage:"系统"}),dataIndex:"system",hideInSearch:!0,width:80,tooltip:r.formatMessage({id:"pages.prompt.system.tooltip",defaultMessage:"是否为系统内置代理"}),render:function(e,t){return t.system?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.kbEnabled",defaultMessage:"知识库启用"}),dataIndex:["settings","kbEnabled"],hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.kbEnabled.tooltip",defaultMessage:"是否启用知识库增强功能"}),render:function(e,t){var n;return null!==(n=t.settings)&&void 0!==n&&n.kbEnabled?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.flowEnabled",defaultMessage:"流程启用"}),dataIndex:"flowEnabled",hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.flowEnabled.tooltip",defaultMessage:"是否启用流程控制功能"}),render:function(e,t){return t.flowEnabled?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",valueType:"dateTime",sorter:!0,width:160,hideInSearch:!0,tooltip:r.formatMessage({id:"pages.prompt.createdAt.tooltip",defaultMessage:"代理创建的时间"}),render:function(e,t){return t.createdAt?te()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:r.formatMessage({id:"pages.prompt.updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",valueType:"dateTime",sorter:!0,hideInSearch:!0,width:160,tooltip:r.formatMessage({id:"pages.prompt.updatedAt.tooltip",defaultMessage:"代理最后更新的时间"}),render:function(e,t){return t.updatedAt?te()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:r.formatMessage({id:"actions",defaultMessage:"操作"}),dataIndex:"option",valueType:"option",width:120,fixed:"right",tooltip:r.formatMessage({id:"pages.prompt.actions.tooltip",defaultMessage:"可进行的操作"}),render:function(e,t){var n;return[(0,L.jsx)(y.Z,{title:r.formatMessage({id:"edit",defaultMessage:"编辑"}),children:(0,L.jsx)(x.ZP,{type:"text",size:"small",icon:(0,L.jsx)(X.Z,{}),onClick:function(){return function(e){u(!0),oe(e),F(!0)}(t)}})},"edit"),!(null!=t&&null!==(n=t.uid)&&void 0!==n&&n.includes("void_agent"))&&(0,L.jsx)(M.Z,{title:r.formatMessage({id:"deleteTip",defaultMessage:"删除确认"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(p(t.nickname),"】？"),onConfirm:function(){return ve(t)},okText:r.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:r.formatMessage({id:"cancel",defaultMessage:"取消"}),icon:(0,L.jsx)(N.Z,{style:{color:"red"}}),children:(0,L.jsx)(y.Z,{title:r.formatMessage({id:"delete",defaultMessage:"删除"}),children:(0,L.jsx)(x.ZP,{type:"text",size:"small",danger:!0,icon:(0,L.jsx)(Q.Z,{})})})},"delete")]}}],be=function(){var e=f()(c()().mark((function e(n,a,i){var l,u,p,f,g,m,v,h,x;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.yw.loading(r.formatMessage({id:"loading",defaultMessage:"Loading"})),l=n.current,u=n.pageSize,p=n.prompt,f=s()(n,ae),U(l),A(u),me(d()(d()({},f),{},{prompt:p})),g=void 0,m=void 0,a&&Object.keys(a).length>0&&(v=Object.keys(a)[0],g=v,m="ascend"===a[v]?"ascend":"descend"),h=d()(d()({pageNumber:l-1,pageSize:u,nickname:"",orgUid:t===o.Hxq?"":null==se?void 0:se.uid,categoryUid:(null==ie?void 0:ie.uid)===o.zBg?"":null==ie?void 0:ie.uid,type:o.Qeb,level:t},f),{},{prompt:p,sortBy:g,sortDirection:m}),e.next=11,(0,j.p0)(h);case 11:if(x=e.sent,console.log("queryRobotsByOrg response:",x,h),200!==x.code){e.next=20;break}return w.yw.destroy(),Y(x.data.content),ce(x.data.totalElements),e.abrupt("return",{data:x.data.content,success:!0,total:x.data.totalElements});case 20:return w.yw.destroy(),w.yw.error(x.message),e.abrupt("return",{data:[],success:!1,total:0});case 23:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)($.Z,{columns:Me,actionRef:n,cardBordered:!0,rowKey:"uid",scroll:{x:2400},search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,pageSize:10,onChange:function(e,t){U(e),A(t)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"pages.prompt.list",defaultMessage:"提示语列表"}),toolBarRender:function(){var e=[(0,L.jsx)(x.ZP,{type:"primary",onClick:function(){u(!1),oe({}),F(!0)},icon:(0,L.jsx)(_.Z,{}),children:r.formatMessage({id:"pages.prompt.create",defaultMessage:"添加提示语"})},"create")],t=[{key:"export-current",icon:(0,L.jsx)(G.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return xe("current")}}];return ue>0&&(ue<=1e3?t.push({key:"export-all",icon:(0,L.jsx)(G.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(ue,"条)"),onClick:function(){return xe("all")}}):t.push({key:"export-range",icon:(0,L.jsx)(G.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(ue,"条)"),children:ye(ue)})),e.push((0,L.jsx)(b.Z,{menu:{items:t},placement:"bottom",children:(0,L.jsxs)(x.ZP,{type:"primary",icon:(0,L.jsx)(G.Z,{}),children:[r.formatMessage({id:"export",defaultMessage:"导出"}),(0,L.jsx)(W.Z,{})]})},"export")),e},request:be}),B&&(0,L.jsx)(K,{isEdit:l,robot:ee,level:t,open:B,onClose:function(){return F(!1)},onSubmit:he})]})},ie=n(92066),se=function(){var e=(0,a.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,L.jsxs)(r.Z,{style:{height:"100%"},children:[(0,L.jsx)(r.Z.Panel,{defaultSize:"20%",min:"10%",max:"40%",style:t,children:(0,L.jsx)(ie.Z,{type:o.Kvk,level:o.whQ,showKbase:!1})}),(0,L.jsx)(r.Z.Panel,{style:n,children:(0,L.jsx)(oe,{level:o.whQ})})]})}}}]);