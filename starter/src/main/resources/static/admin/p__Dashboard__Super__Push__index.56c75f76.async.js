"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[5159],{2250:function(e,t,s){var a=s(94433),r=s(38956),n=s(51997),u=s(44194),o=s(80228),i=s(35074),l=s(31549),d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var s=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,g=e.mode,h=e.valueEnum,m=e.request,M=e.showSearch,v=e.options,y=(0,r.Z)(e,d),E=(0,u.useContext)(o.Z);return(0,l.jsx)(i.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(h),request:m,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:v,mode:g,showSearch:M,getPopupContainer:E.getPopupContainer},s),ref:t,proFieldProps:f},y),{},{children:c}))},f=u.forwardRef((function(e,t){var s=e.fieldProps,d=e.children,p=e.params,f=e.proFieldProps,g=e.mode,h=e.valueEnum,m=e.request,M=e.options,v=(0,r.Z)(e,c),y=(0,a.Z)({options:M,mode:g||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},s),E=(0,u.useContext)(o.Z);return(0,l.jsx)(i.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(h),request:m,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:E.getPopupContainer},y),ref:t,proFieldProps:f},v),{},{children:d}))})),g=u.forwardRef(p);g.SearchSelect=f,g.displayName="ProFormComponent",t.Z=g},89965:function(e,t,s){var a=s(32906),r=s(94433),n=s(38956),u=s(81424),o=s(41196),i=s(63924),l=s(34573),d=s(44194),c=s(35074),p=s(31549),f=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],h="text",m=function(e){var t=(0,u.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),s=(0,a.Z)(t,2),n=s[0],l=s[1];return(0,p.jsx)(o.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var s,a=t.getFieldValue(e.name||[]);return(0,p.jsx)(i.Z,(0,r.Z)((0,r.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return l(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(s=e.statusRender)||void 0===s?void 0:s.call(e,a),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:n,children:e.children}))}})},M=function(e){var t=e.fieldProps,s=e.proFieldProps,a=(0,n.Z)(e,f);return(0,p.jsx)(c.Z,(0,r.Z)({valueType:h,fieldProps:t,filedConfig:{valueType:h},proFieldProps:s},a))};M.Password=function(e){var t=e.fieldProps,s=e.proFieldProps,u=(0,n.Z)(e,g),o=(0,d.useState)(!1),i=(0,a.Z)(o,2),f=i[0],M=i[1];return null!=t&&t.statusRender&&u.name?(0,p.jsx)(m,{name:u.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:M,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,r.Z)({valueType:"password",fieldProps:(0,r.Z)((0,r.Z)({},(0,l.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var s;null==t||null===(s=t.onBlur)||void 0===s||s.call(t,e),M(!1)},onClick:function(e){var s;null==t||null===(s=t.onClick)||void 0===s||s.call(t,e),M(!0)}}),proFieldProps:s,filedConfig:{valueType:h}},u))})}):(0,p.jsx)(c.Z,(0,r.Z)({valueType:"password",fieldProps:t,proFieldProps:s,filedConfig:{valueType:h}},u))},M.displayName="ProFormComponent",t.Z=M},80953:function(e,t,s){var a=s(94433),r=s(38956),n=s(44194),u=s(35074),o=s(31549),i=["fieldProps","proFieldProps"],l=function(e,t){var s=e.fieldProps,n=e.proFieldProps,l=(0,r.Z)(e,i);return(0,o.jsx)(u.Z,(0,a.Z)({ref:t,valueType:"textarea",fieldProps:s,proFieldProps:n},l))};t.Z=n.forwardRef(l)},75112:function(e,t,s){var a=s(14597);t.Z=function(){var e=(0,a.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},5405:function(e,t,s){s.r(t),s.d(t,{default:function(){return H}});var a=s(44194),r=s(73193),n=s.n(r),u=s(84176),o=s.n(u),i=s(90819),l=s.n(i),d=s(89933),c=s.n(d),p=s(45332),f=s.n(p),g=s(19433),h=s(14906);function m(e){return M.apply(this,arguments)}function M(){return(M=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/query/org",{method:"GET",params:n()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return y.apply(this,arguments)}function y(){return(y=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/create",{method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return x.apply(this,arguments)}function x(){return(x=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/update",{method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return S.apply(this,arguments)}function S(){return(S=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/delete",{method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return C.apply(this,arguments)}function C(){return(C=c()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.request)("/api/v1/push/resend",{method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=s(10162),w=s(89246),b=s(82770),Z=s(98830),T=s(25784),L=s(2250),O=s(89965),A=s(80953),_=s(41196),N=s(82864),F=s(39487),k=s(31549),B=function(e){var t=e.isEdit,s=e.push,r=e.open,u=e.onClose,o=e.onSubmit,i=_.Z.useForm(),l=f()(i,1)[0],d=(0,Z.u)((function(e){return e.currentOrg})),c=(0,h.useIntl)();(0,a.useEffect)((function(){t&&s?l.setFieldsValue({type:s.type,receiver:s.receiver,content:s.content}):l.resetFields()}),[r]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(N.Z,{title:t?c.formatMessage({id:"pages.push.edit",defaultMessage:"Edit Push"}):c.formatMessage({id:"pages.push.create",defaultMessage:"Create Push"}),onClose:u,open:r,extra:(0,k.jsxs)(F.Z,{children:[(0,k.jsx)(b.ZP,{onClick:u,children:c.formatMessage({id:"pages.push.cancel",defaultMessage:"Cancel"})}),(0,k.jsx)(b.ZP,{onClick:function(){console.log("handleSubmit"),l.validateFields().then((function(e){console.log(e),o(n()(n()({},e),{},{uid:null==s?void 0:s.uid,orgUid:null==d?void 0:d.uid}))})).catch((function(e){console.log("Form errors:",e),g.yw.error(c.formatMessage({id:"pages.form.error",defaultMessage:"Please check the form inputs"}))}))},type:"primary",children:c.formatMessage({id:"pages.push.submit",defaultMessage:"Submit"})})]}),children:(0,k.jsxs)(T.A,{form:l,initialValues:n()({},s),submitter:{render:function(){return null}},children:[(0,k.jsx)(L.Z,{label:c.formatMessage({id:"pages.push.type",defaultMessage:"Type"}),name:"type",rules:[{required:!0,message:c.formatMessage({id:"pages.push.type",defaultMessage:"Type"})}],options:[{label:"MOBILE_REGISTER",value:"MOBILE_REGISTER"},{label:"MOBILE_LOGIN",value:"MOBILE_LOGIN"},{label:"MOBILE_RESET",value:"MOBILE_RESET"},{label:"MOBILE_VERIFY",value:"MOBILE_VERIFY"},{label:"EMAIL_REGISTER",value:"EMAIL_REGISTER"},{label:"EMAIL_LOGIN",value:"EMAIL_LOGIN"},{label:"EMAIL_RESET",value:"EMAIL_RESET"},{label:"EMAIL_VERIFY",value:"EMAIL_VERIFY"},{label:"USERNAME_REGISTER",value:"USERNAME_REGISTER"},{label:"USERNAME_LOGIN",value:"USERNAME_LOGIN"},{label:"USERNAME_RESET",value:"USERNAME_RESET"},{label:"USERNAME_VERIFY",value:"USERNAME_VERIFY"},{label:"SCAN_LOGIN",value:"SCAN_LOGIN"}],fieldProps:{allowClear:!0,placeholder:c.formatMessage({id:"pages.push.type",defaultMessage:"Type"})}}),(0,k.jsx)(O.Z,{label:c.formatMessage({id:"pages.push.receiver",defaultMessage:"Receiver"}),name:"receiver",rules:[{required:!0,message:c.formatMessage({id:"pages.push.receiver",defaultMessage:"Receiver"})}]}),(0,k.jsx)(A.Z,{label:c.formatMessage({id:"pages.push.content",defaultMessage:"Content"}),name:"content",rules:[{required:!0,message:c.formatMessage({id:"pages.push.content",defaultMessage:"Content"})}]})]})})})},j=s(26138),G=s(96596),U=s.n(G),z=s(55722),V=["current"],q=function(){var e=(0,h.useIntl)(),t=(0,a.useRef)(),s=(0,a.useState)(!0),r=f()(s,2),u=r[0],i=r[1],d=(0,a.useState)(),p=f()(d,2),M=p[0],y=p[1],x=(0,a.useState)(!1),S=f()(x,2),C=S[0],T=S[1],L=(0,Z.u)((function(e){return e.currentOrg})),O=(0,z.L)((function(e){return e.userInfo})),A=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:e.formatMessage({id:"pages.push.sender",defaultMessage:"Sender"}),dataIndex:"sender",copyable:!0,hideInSearch:!0},{title:e.formatMessage({id:"pages.push.content",defaultMessage:"Content"}),dataIndex:"content",copyable:!0},{title:e.formatMessage({id:"pages.push.receiver",defaultMessage:"Receiver"}),dataIndex:"receiver",copyable:!0},{title:e.formatMessage({id:"pages.push.type",defaultMessage:"Type"}),dataIndex:"type",valueType:"select",initialValue:"MOBILE_LOGIN",valueEnum:{MOBILE_REGISTER:{text:e.formatMessage({id:"pages.push.type.mobileRegister",defaultMessage:"手机号注册"})},MOBILE_LOGIN:{text:e.formatMessage({id:"pages.push.type.mobileLogin",defaultMessage:"手机号登录"})},MOBILE_RESET:{text:e.formatMessage({id:"pages.push.type.mobileReset",defaultMessage:"手机号重置"})},MOBILE_VERIFY:{text:e.formatMessage({id:"pages.push.type.mobileVerify",defaultMessage:"手机号验证"})},EMAIL_REGISTER:{text:e.formatMessage({id:"pages.push.type.emailRegister",defaultMessage:"邮箱注册"})},EMAIL_LOGIN:{text:e.formatMessage({id:"pages.push.type.emailLogin",defaultMessage:"邮箱登录"})},EMAIL_RESET:{text:e.formatMessage({id:"pages.push.type.emailReset",defaultMessage:"邮箱重置"})},EMAIL_VERIFY:{text:e.formatMessage({id:"pages.push.type.emailVerify",defaultMessage:"邮箱验证"})},USERNAME_REGISTER:{text:e.formatMessage({id:"pages.push.type.usernameRegister",defaultMessage:"用户名注册"})},USERNAME_LOGIN:{text:e.formatMessage({id:"pages.push.type.usernameLogin",defaultMessage:"用户名登录"})},USERNAME_RESET:{text:e.formatMessage({id:"pages.push.type.usernameReset",defaultMessage:"用户名重置"})},USERNAME_VERIFY:{text:e.formatMessage({id:"pages.push.type.usernameVerify",defaultMessage:"用户名验证"})},SCAN_LOGIN:{text:e.formatMessage({id:"pages.push.type.scanLogin",defaultMessage:"扫码登录"})}}},{title:e.formatMessage({id:"pages.push.status",defaultMessage:"Status"}),dataIndex:"status",valueType:"select",valueEnum:{PENDING:{text:e.formatMessage({id:"pages.push.status.pending",defaultMessage:"待处理"}),status:"Processing"},SCANNED:{text:e.formatMessage({id:"pages.push.status.scanned",defaultMessage:"已扫描"}),status:"Warning"},CONFIRMED:{text:e.formatMessage({id:"pages.push.status.confirmed",defaultMessage:"已确认"}),status:"Success"},EXPIRED:{text:e.formatMessage({id:"pages.push.status.expired",defaultMessage:"已过期"}),status:"Default"},SUCCESS:{text:e.formatMessage({id:"pages.push.status.success",defaultMessage:"成功"}),status:"Success"},ERROR:{text:e.formatMessage({id:"pages.push.status.failure",defaultMessage:"失败"}),status:"Error"}}},{title:e.formatMessage({id:"pages.push.sendSuccess",defaultMessage:"Send Status"}),dataIndex:"sendSuccess",valueType:"select",hideInSearch:!0,width:120,valueEnum:{true:{text:e.formatMessage({id:"pages.push.send.success",defaultMessage:"发送成功"}),status:"Success"},false:{text:e.formatMessage({id:"pages.push.send.failure",defaultMessage:"发送失败"}),status:"Error"}}},{title:e.formatMessage({id:"pages.push.sendMessage",defaultMessage:"Send Message"}),dataIndex:"sendMessage",hideInSearch:!0,ellipsis:!0,width:200},{title:e.formatMessage({id:"pages.push.createdAt",defaultMessage:"Created At"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.createdAt?U()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):""}},{title:e.formatMessage({id:"actions"}),valueType:"option",key:"option",width:180,render:function(s,a,r,n){return[!1===a.sendSuccess&&(0,k.jsx)("a",{style:{color:"#1890ff"},onClick:c()(l()().mark((function s(){var r,n,u;return l()().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(a.uid){s.next=2;break}return s.abrupt("return");case 2:return g.yw.loading(e.formatMessage({id:"pages.push.resending",defaultMessage:"Resending..."})),s.next=5,I({uid:a.uid});case 5:r=s.sent,g.yw.destroy(),200===r.code?(g.yw.success(e.formatMessage({id:"pages.push.resend.success",defaultMessage:"Resend successful"})),null===(n=t.current)||void 0===n||null===(u=n.reloadAndRest)||void 0===u||u.call(n)):g.yw.error(r.message||e.formatMessage({id:"pages.push.resend.error",defaultMessage:"Resend failed"}));case 8:case"end":return s.stop()}}),s)}))),children:e.formatMessage({id:"pages.push.resend",defaultMessage:"Resend"})},"resend"),(0,k.jsx)("a",{onClick:function(){F(a)},children:e.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,k.jsx)("a",{style:{color:"#ff4d4f",marginLeft:8},onClick:c()(l()().mark((function s(){var r,n,u;return l()().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(a.uid){s.next=2;break}return s.abrupt("return");case 2:return g.yw.loading(e.formatMessage({id:"deleting",defaultMessage:"Deleting..."})),s.next=5,R({uid:a.uid});case 5:r=s.sent,g.yw.destroy(),200===r.code?(g.yw.success(e.formatMessage({id:"delete.success",defaultMessage:"Delete successful"})),null===(n=t.current)||void 0===n||null===(u=n.reloadAndRest)||void 0===u||u.call(n)):g.yw.error(r.message||e.formatMessage({id:"delete.error",defaultMessage:"Delete failed"}));case 8:case"end":return s.stop()}}),s)}))),children:e.formatMessage({id:"delete",defaultMessage:"Delete"})},"delete")]}}],_=(0,j.v)((function(e){return e.currentCategory})),N=function(){y(void 0),i(!1),T(!0)},F=function(e){y(e),i(!0),T(!0)},G=function(){var s=c()(l()().mark((function s(a){var r,n,o;return l()().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(u?g.yw.loading(e.formatMessage({id:"updating",defaultMessage:"Updating..."})):g.yw.loading(e.formatMessage({id:"creating",defaultMessage:"Creating..."})),!u){s.next=7;break}return s.next=4,E(a);case 4:s.t0=s.sent,s.next=10;break;case 7:return s.next=9,v(a);case 9:s.t0=s.sent;case 10:r=s.t0,g.yw.destroy(),200===r.code?(g.yw.success(e.formatMessage({id:u?"update.success":"create.success",defaultMessage:u?"Update successful":"Create successful"})),T(!1),null===(n=t.current)||void 0===n||null===(o=n.reloadAndRest)||void 0===o||o.call(n)):g.yw.error(r.message||e.formatMessage({id:u?"update.error":"create.error",defaultMessage:u?"Update failed":"Create failed"}));case 13:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}();return(0,a.useEffect)((function(){var e;console.log("currentCategory:",_),null===(e=t.current)||void 0===e||e.reloadAndRest()}),[_]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(w.Z,{columns:A,actionRef:t,cardBordered:!0,request:function(){var t=c()(l()().mark((function t(s,a,r){var u,i,d;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",s,a,r),g.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),s.current,u=o()(s,V),i=n()({pageNumber:(s.current||1)-1,pageSize:s.pageSize,orgUid:null==L?void 0:L.uid,superUser:null==O?void 0:O.superUser},u),t.next=6,m(i);case 6:return d=t.sent,console.log("getAllPushs response:",i,d),g.yw.destroy(),200===d.code||g.yw.error(d.message),t.abrupt("return",{data:d.data.content,success:!0,total:d.data.totalElements});case 11:case"end":return t.stop()}}),t)})));return function(e,s,a){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e){console.log("page:",e)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"pages.push.list",defaultMessage:"Push Records"}),toolBarRender:function(){return[(0,k.jsx)(b.ZP,{icon:(0,k.jsx)(P.Z,{}),type:"primary",onClick:N,children:e.formatMessage({id:"create",defaultMessage:"Create"})},"button")]}}),(0,k.jsx)(B,{isEdit:u,open:C,push:M,onClose:function(){T(!1)},onSubmit:G})]})},D=s(21563),Y=s(75112),W=D.Z.Content,H=function(){var e=(0,Y.Z)().contentStyle;return(0,k.jsx)(D.Z,{children:(0,k.jsx)(W,{style:e,children:(0,k.jsx)(q,{})})})}},26138:function(e,t,s){s.d(t,{v:function(){return g}});var a=s(86222),r=s.n(a),n=s(73193),u=s.n(n),o=s(76711),i=s.n(o),l=s(39497),d=s(58063),c=s(66266),p=s(31403),f=s(23753);var g=(0,d.Ue)()((0,c.mW)((0,c.tJ)((0,p.n)((function(e,t){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:l.zBg,name:l.zBg},setCategoryResult:function(t){var s=function(e){var t=[];return e.data.content.forEach((function(e){var s={label:e.name,value:e.uid};t.push(s)})),t}(t),a=function(e){var t,s=(null==e||null===(t=e.data)||void 0===t?void 0:t.content)||[],a=function e(t){var s={title:t.name||"",key:t.uid||""};return t.children&&t.children.length>0&&(s.children=t.children.map((function(t){return e(t)}))),s};return s.filter((function(e){return e&&e.uid&&e.uid!==l.zBg})).map((function(e){return a(e)}))}(t),r=[{title:l.zBg,key:l.zBg}].concat(i()(a)),n={uid:l.zBg,name:l.zBg},o=u()(u()({},t),{},{data:u()(u()({},t.data),{},{content:[n].concat(i()(t.data.content))})});e({categoryResult:o,categoryTreeOptions:r,categorySelectOptions:s}),0===t.data.content.length&&e({currentCategory:{uid:l.zBg,name:l.zBg}})},insertCategory:function(t){e((function(e){e.categoryResult.data.content.unshift(t)}))},upgradeCategory:function(t){e((function(e){var s=e.categoryResult.data.content,a=s.findIndex((function(e){return e.uid===t.uid}));-1!==a?s[a]=t:console.warn("Category with uid ".concat(t.uid," not found."))}))},setCurrentCategory:function(t){e({currentCategory:t})},resetDefaultCategory:function(){f.Z.log("resetDefaultCategory"),e({currentCategory:{uid:l.zBg,name:l.zBg}})},setCurrentCategoryUid:function(s){if(s!==l.zBg){var a=function e(t,s){if(t&&0!==t.length){var a,n=r()(t);try{for(n.s();!(a=n.n()).done;){var u=a.value;if((null==u?void 0:u.uid)===s)return u;var o=e(null==u?void 0:u.children,s);if(o)return o}}catch(e){n.e(e)}finally{n.f()}}}(t().categoryResult.data.content,s);e({currentCategory:null!=a?a:{uid:l.zBg,name:l.zBg}})}else e({currentCategory:{uid:l.zBg,name:l.zBg}})},deleteCategoryCache:function(){return e({},!0)}}})),{name:l.OMm})))}}]);