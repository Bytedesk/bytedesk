"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[362],{69842:function(e,t,n){n.d(t,{H:function(){return c}});var i=n(90819),o=n.n(i),s=n(73193),r=n.n(s),a=n(89933),l=n.n(a),d=n(55735),u=n(30921);function c(e){return g.apply(this,arguments)}function g(){return(g=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/vip/invoice/query/org",{method:"GET",params:r()(r()({},t),{},{client:d.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},43705:function(e,t,n){var i=n(76711),o=n.n(i),s=n(73193),r=n.n(s),a=n(90819),l=n.n(a),d=n(89933),u=n.n(d),c=n(45332),g=n.n(c),v=n(86803),f=n(99885),m=n(66916),p=n(76750),h=n(66310),w=n(40612),b=n(90297),x=n(69169),y=n(48708),q=n(84881),S=n(30921),k=n(3849),F=n(75365),U=n(44194),C=n(1902),j=n(95490),M=n(55735),R=n(24170),T=n(72614),Z=n(11184),I=n(27522),P=n(31549);t.Z=function(e){var t,n,i=e.type,s=x.A.useForm(),a=g()(s,1)[0],d=(0,S.useIntl)(),c=((0,S.useNavigate)(),(0,p.Z)().translateString),A=(0,Z.M)(),K=A.config,V=A.updateConfig,L=(0,w.u)((function(e){return e.currentOrg})),W=(0,U.useState)(),B=g()(W,2),_=B[0],N=B[1],D=(0,U.useState)(),E=g()(D,2),O=E[0],X=E[1],z=(0,U.useState)(),Q=g()(z,2),$=Q[0],G=Q[1],H=(0,h.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),Y=H.currentRobot,J=H.setCurrentRobot,ee=(0,C.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),te=ee.currentAgent,ne=ee.setCurrentAgent,ie=(0,j.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),oe=ie.currentWorkgroup,se=ie.setCurrentWorkgroup,re=(0,U.useMemo)((function(){return i===M._X4?{chatType:M.xtN,chatSid:Y.uid}:i===M.Njn?{chatType:M.scI,chatSid:te.uid}:i===M.aZD?{chatType:M.vPY,chatSid:oe.uid}:{chatType:M.xtN,chatSid:""}}),[i,Y,te,oe]),ae=re.chatType,le=re.chatSid,de=function(){var e=u()(l()().mark((function e(){var t,n,o,s,r,u,c,g;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v.yw.loading(d.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:M.QPQ,orgUid:null==L?void 0:L.uid},e.prev=2,e.next=5,(0,I.AP)(t);case 5:n=e.sent,console.log("getKbases response:",t,n),v.yw.destroy(),200===n.code?(c={code:n.code,message:n.message,data:{content:n.data.content.map((function(e){return{uid:e.uid,name:e.name,type:e.type,orgUid:e.orgUid}})),totalElements:n.data.totalElements,totalPages:n.data.totalPages,number:n.data.number}},X(c),i===M._X4&&null!=Y&&null!==(o=Y.serviceSettings)&&void 0!==o&&o.faqKbUid?g=Y.serviceSettings.faqKbUid:i===M.Njn&&null!=te&&null!==(s=te.serviceSettings)&&void 0!==s&&s.faqKbUid?g=te.serviceSettings.faqKbUid:i===M.aZD&&null!=oe&&null!==(r=oe.serviceSettings)&&void 0!==r&&r.faqKbUid?g=oe.serviceSettings.faqKbUid:(null===(u=c.data)||void 0===u||null===(u=u.content)||void 0===u?void 0:u.length)>0&&(g=c.data.content[0].uid),g&&(G(g),a.setFieldValue("faqKbUid",g),ue(g))):v.yw.error(n.message),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),v.yw.destroy(),console.error("获取知识库失败:",e.t0),v.yw.error("获取知识库失败");case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=u()(l()().mark((function e(t){var n,i,o,s,r,u;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||$){e.next=4;break}return console.log("没有选择知识库，无法获取FAQ"),N(void 0),e.abrupt("return");case 4:return v.yw.loading(d.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:100,orgUid:null==L?void 0:L.uid,kbUid:t||$},e.prev=6,e.next=9,(0,f.pf)(n);case 9:i=e.sent,console.log("getFaqs response:",n,i),v.yw.destroy(),200===i.code?(o={code:i.code,message:i.message,data:{content:i.data.content.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer,kbUid:e.kbUid,orgUid:e.orgUid}})),totalElements:i.data.totalElements,totalPages:i.data.totalPages,number:i.data.number}},N(o),t||$,(s=a.getFieldValue("faqUids")||[]).length>0&&(r=o.data.content.map((function(e){return e.uid})),(u=s.filter((function(e){return r.includes(e)}))).length!==s.length&&a.setFieldValue("faqUids",u))):v.yw.error(i.message),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(6),v.yw.destroy(),console.error("获取FAQ失败:",e.t0),v.yw.error("获取FAQ失败");case 20:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}();(0,U.useEffect)((function(){null!=L&&L.uid&&de()}),[null==L?void 0:L.uid,i]),(0,U.useEffect)((function(){var e;if(i===M._X4&&Y){var t,n,o,s={showFaqs:null==Y||null===(t=Y.serviceSettings)||void 0===t?void 0:t.showFaqs,faqKbUid:null==Y||null===(n=Y.serviceSettings)||void 0===n?void 0:n.faqKbUid,faqUids:(null==Y||null===(o=Y.serviceSettings)||void 0===o||null===(o=o.faqs)||void 0===o?void 0:o.map((function(e){return e.uid})))||[]};a.setFieldsValue({showFaqs:s.showFaqs,faqKbUid:s.faqKbUid,faqUids:s.faqUids}),e=s.faqKbUid,V(s.showFaqs?r()(r()({},K),{},{window:r()(r()({},K.window),{},{width:680}),chatConfig:r()(r()({},K.chatConfig),{},{org:null==L?void 0:L.uid,t:ae,sid:le})}):r()(r()({},K),{},{window:r()(r()({},K.window),{},{width:380}),chatConfig:r()(r()({},K.chatConfig),{},{org:null==L?void 0:L.uid,t:ae,sid:le})}))}else if(i===M.Njn&&te){var l,d,u,c={showFaqs:null==te||null===(l=te.serviceSettings)||void 0===l?void 0:l.showFaqs,faqKbUid:null==te||null===(d=te.serviceSettings)||void 0===d?void 0:d.faqKbUid,faqUids:(null==te||null===(u=te.serviceSettings)||void 0===u||null===(u=u.faqs)||void 0===u?void 0:u.map((function(e){return e.uid})))||[]};a.setFieldsValue({showFaqs:c.showFaqs,faqKbUid:c.faqKbUid,faqUids:c.faqUids}),e=c.faqKbUid,V(c.showFaqs?r()(r()({},K),{},{window:r()(r()({},K.window),{},{width:680}),chatConfig:r()(r()({},K.chatConfig),{},{org:null==L?void 0:L.uid,t:ae,sid:le})}):r()(r()({},K),{},{window:r()(r()({},K.window),{},{width:380}),chatConfig:r()(r()({},K.chatConfig),{},{org:null==L?void 0:L.uid,t:ae,sid:le})}))}else if(i===M.aZD&&oe){var g,v,f,m={showFaqs:null==oe||null===(g=oe.serviceSettings)||void 0===g?void 0:g.showFaqs,faqKbUid:null==oe||null===(v=oe.serviceSettings)||void 0===v?void 0:v.faqKbUid,faqUids:(null==oe||null===(f=oe.serviceSettings)||void 0===f||null===(f=f.faqs)||void 0===f?void 0:f.map((function(e){return e.uid})))||[]};a.setFieldsValue({showFaqs:m.showFaqs,faqKbUid:m.faqKbUid,faqUids:m.faqUids}),e=m.faqKbUid,V(m.showFaqs?r()(r()({},K),{},{window:r()(r()({},K.window),{},{width:680}),chatConfig:r()(r()({},K.chatConfig),{},{org:null==L?void 0:L.uid,t:ae,sid:le})}):r()(r()({},K),{},{window:r()(r()({},K.window),{},{width:380}),chatConfig:r()(r()({},K.chatConfig),{},{org:null==L?void 0:L.uid,t:ae,sid:le})}))}e&&e!==$&&(console.log("知识库ID变化，更新FAQ列表:",e),G(e),ue(e))}),[Y,te,oe,i,ae,le,null==L?void 0:L.uid]);var ce=function(){var e=u()(l()().mark((function e(t){var n,s,a,u,c,g,f,p,h,w,b,x,y,q,S,k;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onFinish",t),e.prev=1,i!==M._X4){e.next=13;break}return n={showFaqs:t.showFaqs,faqKbUid:t.faqKbUid,faqUids:Array.isArray(t.faqUids)?o()(t.faqUids):[]},s={uid:Y.uid,name:Y.name,avatar:Y.avatar,description:Y.description,serviceSettings:n},console.log("robotObject:",s),e.next=8,(0,m.$l)(s);case 8:a=e.sent,console.log("updateRobot response:",a),200===a.code?(v.yw.destroy(),v.yw.success(d.formatMessage({id:"update.success"})),c=r()(r()({},a.data),{},{serviceSettings:r()(r()({},a.data.serviceSettings),{},{faqs:(null===(u=a.data.serviceSettings.faqs)||void 0===u?void 0:u.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer}})))||[]})}),J(c)):(v.yw.destroy(),v.yw.error(a.message)),e.next=33;break;case 13:if(i!==M.Njn){e.next=24;break}return g={showFaqs:t.showFaqs,faqKbUid:t.faqKbUid,faqUids:Array.isArray(t.faqUids)?o()(t.faqUids):[]},f={uid:te.uid,nickname:te.nickname,avatar:te.avatar,status:te.status,serviceSettings:g,messageLeaveSettings:{},robotSettings:{},autoReplySettings:{}},console.log("agentObject:",f),e.next=19,(0,R.sE)(f);case 19:p=e.sent,console.log("updateAgent response:",p),200===p.code?(v.yw.destroy(),v.yw.success(d.formatMessage({id:"update.success"})),w=r()(r()({},p.data),{},{serviceSettings:r()(r()({},p.data.serviceSettings),{},{faqs:(null===(h=p.data.serviceSettings.faqs)||void 0===h?void 0:h.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer}})))||[]})}),ne(w)):(v.yw.destroy(),v.yw.error(p.message)),e.next=33;break;case 24:if(i!==M.aZD){e.next=33;break}return x={showFaqs:t.showFaqs,faqKbUid:t.faqKbUid,faqUids:Array.isArray(t.faqUids)?o()(t.faqUids):[]},y={uid:null==oe?void 0:oe.uid,nickname:null==oe?void 0:oe.nickname,avatar:null==oe?void 0:oe.avatar,status:null==oe?void 0:oe.status,serviceSettings:x,robotSettings:{},messageLeaveSettings:{},agentUids:(null===(b=oe.agents)||void 0===b?void 0:b.map((function(e){return e.uid})))||[]},console.log("workgroupObject:",y),e.next=30,(0,T.W5)(y);case 30:q=e.sent,console.log("updateWorkGroup response:",q),200===q.code?(v.yw.destroy(),v.yw.success(d.formatMessage({id:"update.success"})),k=r()(r()({},q.data),{},{serviceSettings:r()(r()({},q.data.serviceSettings),{},{faqs:(null===(S=q.data.serviceSettings.faqs)||void 0===S?void 0:S.map((function(e){return{uid:e.uid,question:e.question,answer:e.answer}})))||[]})}),se(k)):(v.yw.destroy(),v.yw.error(q.message));case 33:e.next=40;break;case 35:e.prev=35,e.t0=e.catch(1),v.yw.destroy(),console.error("提交失败:",e.t0),v.yw.error("提交失败");case 40:case"end":return e.stop()}}),e,null,[[1,35]])})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=u()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabFaqs handleChange",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,P.jsx)("div",{children:(0,P.jsxs)(x.A,{form:a,layout:"vertical",onFinish:ce,submitter:{render:function(e,t){return(0,P.jsxs)(k.Z,{children:[t,(0,P.jsx)(F.ZP,{color:"danger",variant:"outlined",icon:(0,P.jsx)(b.Z,{}),onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:d.formatMessage({id:"preview",defaultMessage:"Preview"})})]})}},children:[(0,P.jsx)(y.Z,{label:d.formatMessage({id:"faq.show.faqs"}),name:"showFaqs",fieldProps:{onChange:ge}}),(0,P.jsx)(q.Z,{name:"faqKbUid",width:"md",label:d.formatMessage({id:"menu.kbase.select",defaultMessage:"选择知识库"}),options:null==O||null===(t=O.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return{label:c(e.name),value:e.uid}})),fieldProps:{onChange:function(e){console.log("selected kbase:",e),G(e),a.setFieldValue("faqUids",[]),ue(e)},allowClear:!0,placeholder:(0,P.jsx)(S.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}}),(0,P.jsx)(q.Z,{name:"faqUids",width:"md",label:d.formatMessage({id:"menu.kbase.faq"}),options:null==_||null===(n=_.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.map((function(e){return{label:c(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:(0,P.jsx)(S.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}})]})})}},71469:function(e,t,n){var i=n(73193),o=n.n(i),s=n(90819),r=n.n(s),a=n(89933),l=n.n(a),d=n(45332),u=n.n(d),c=n(86803),g=n(99885),v=n(66916),f=n(76750),m=n(66310),p=n(40612),h=n(90297),w=n(69169),b=n(48708),x=n(84881),y=n(30921),q=n(3849),S=n(75365),k=n(44194),F=n(1902),U=n(95490),C=n(55735),j=n(24170),M=n(72614),R=n(11184),T=n(27522),Z=n(31549);t.Z=function(e){var t,n,i=e.type,s=w.A.useForm(),a=u()(s,1)[0],d=(0,y.useIntl)(),I=((0,y.useNavigate)(),(0,f.Z)().translateString),P=(0,R.M)(),A=P.config,K=P.updateConfig,V=(0,p.u)((function(e){return e.currentOrg})),L=(0,k.useState)(),W=u()(L,2),B=W[0],_=W[1],N=(0,k.useState)(),D=u()(N,2),E=D[0],O=D[1],X=(0,k.useState)(),z=u()(X,2),Q=z[0],$=z[1],G=(0,m.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),H=G.currentRobot,Y=G.setCurrentRobot,J=(0,F.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),ee=J.currentAgent,te=J.setCurrentAgent,ne=(0,U.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),ie=ne.currentWorkgroup,oe=ne.setCurrentWorkgroup,se=(0,k.useMemo)((function(){return i===C._X4?{chatType:C.xtN,chatSid:H.uid}:i===C.Njn?{chatType:C.scI,chatSid:ee.uid}:i===C.aZD?{chatType:C.vPY,chatSid:ie.uid}:{chatType:C.xtN,chatSid:""}}),[i,H,ee,ie]),re=se.chatType,ae=se.chatSid,le=function(){var e=l()(r()().mark((function e(){var t,n,o,s,l,u,g;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(d.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:C.QPQ,orgUid:null==V?void 0:V.uid},e.next=4,(0,T.AP)(t);case 4:n=e.sent,console.log("getKbases response:",t,n),c.yw.destroy(),200===n.code?(O(n),i===C._X4&&null!=H&&null!==(o=H.serviceSettings)&&void 0!==o&&o.quickFaqKbUid?g=H.serviceSettings.quickFaqKbUid:i===C.Njn&&null!=ee&&null!==(s=ee.serviceSettings)&&void 0!==s&&s.quickFaqKbUid?g=ee.serviceSettings.quickFaqKbUid:i===C.aZD&&null!=ie&&null!==(l=ie.serviceSettings)&&void 0!==l&&l.quickFaqKbUid?g=ie.serviceSettings.quickFaqKbUid:(null===(u=n.data)||void 0===u||null===(u=u.content)||void 0===u?void 0:u.length)>0&&(g=n.data.content[0].uid),g&&($(g),a.setFieldValue("quickFaqKbUid",g),de(g))):c.yw.error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=l()(r()().mark((function e(t){var n,i,o,s,l;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||Q){e.next=4;break}return console.log("没有选择知识库，无法获取FAQ"),_(void 0),e.abrupt("return");case 4:return c.yw.loading(d.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:50,orgUid:null==V?void 0:V.uid,kbUid:t||Q},e.next=8,(0,g.pf)(n);case 8:i=e.sent,console.log("getFaqs response:",n,i),c.yw.destroy(),200===i.code?(_(i),t||Q,(o=a.getFieldValue("quickFaqUids")||[]).length>0&&(s=i.data.content.map((function(e){return e.uid})),(l=o.filter((function(e){return s.includes(e)}))).length!==o.length&&a.setFieldValue("quickFaqUids",l))):c.yw.error(i.message);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,k.useEffect)((function(){null!=V&&V.uid&&le()}),[V]),(0,k.useEffect)((function(){var e,t,n,s,r;if(i===C._X4&&H)a.setFieldsValue({showQuickFaqs:null==H||null===(t=H.serviceSettings)||void 0===t?void 0:t.showQuickFaqs,quickFaqKbUid:null==H||null===(n=H.serviceSettings)||void 0===n?void 0:n.quickFaqKbUid,quickFaqUids:null==H||null===(s=H.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid}))}),e=null==H||null===(r=H.serviceSettings)||void 0===r?void 0:r.quickFaqKbUid,K(o()(o()({},A),{},{chatConfig:o()(o()({},A.chatConfig),{},{org:null==V?void 0:V.uid,t:re,sid:ae})}));else if(i===C.Njn&&ee){var l,d,u,c;a.setFieldsValue({showQuickFaqs:null==ee||null===(l=ee.serviceSettings)||void 0===l?void 0:l.showQuickFaqs,quickFaqKbUid:null==ee||null===(d=ee.serviceSettings)||void 0===d?void 0:d.quickFaqKbUid,quickFaqUids:null==ee||null===(u=ee.serviceSettings)||void 0===u||null===(u=u.quickFaqs)||void 0===u?void 0:u.map((function(e){return e.uid}))}),e=null==ee||null===(c=ee.serviceSettings)||void 0===c?void 0:c.quickFaqKbUid,K(o()(o()({},A),{},{chatConfig:o()(o()({},A.chatConfig),{},{org:null==V?void 0:V.uid,t:re,sid:ae})}))}else if(i===C.aZD&&ie){var g,v,f,m;a.setFieldsValue({showQuickFaqs:null==ie||null===(g=ie.serviceSettings)||void 0===g?void 0:g.showQuickFaqs,quickFaqKbUid:null==ie||null===(v=ie.serviceSettings)||void 0===v?void 0:v.quickFaqKbUid,quickFaqUids:null==ie||null===(f=ie.serviceSettings)||void 0===f||null===(f=f.quickFaqs)||void 0===f?void 0:f.map((function(e){return e.uid}))}),e=null==ie||null===(m=ie.serviceSettings)||void 0===m?void 0:m.quickFaqKbUid,K(o()(o()({},A),{},{chatConfig:o()(o()({},A.chatConfig),{},{org:null==V?void 0:V.uid,t:re,sid:ae})}))}e&&e!==Q&&(console.log("快捷回复知识库ID变化，更新FAQ列表:",e),$(e),de(e))}),[H,ee,ie,i,re,ae,null==V?void 0:V.uid]);var ue=function(){var e=l()(r()().mark((function e(t){var n,s,a,l,u,g,f,m,p,h,w,b,x,y,q,S,k,F,U,R,T,Z,I,P,A;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onFinish",t),i!==C._X4){e.next=11;break}return g=o()(o()({},H),{},{serviceSettings:o()(o()({},H.serviceSettings),{},{showQuickFaqs:t.showQuickFaqs,quickFaqKbUid:t.quickFaqKbUid,quickFaqUids:t.quickFaqUids,welcomeFaqUids:null==H||null===(n=H.serviceSettings)||void 0===n||null===(n=n.welcomeFaqs)||void 0===n?void 0:n.map((function(e){return e.uid})),faqUids:null==H||null===(s=H.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),guessFaqUids:null==H||null===(a=H.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),hotFaqUids:null==H||null===(l=H.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),shortcutFaqUids:null==H||null===(u=H.serviceSettings)||void 0===u||null===(u=u.shortcutFaqs)||void 0===u?void 0:u.map((function(e){return e.uid}))})}),console.log("robotObject:",g),e.next=6,(0,v.$l)(g);case 6:f=e.sent,console.log("updateRobot response:",f),200===f.code?(c.yw.destroy(),c.yw.success(d.formatMessage({id:"update.success"})),Y(f.data)):(c.yw.destroy(),c.yw.error(f.message)),e.next=29;break;case 11:if(i!==C.Njn){e.next=21;break}return q=o()(o()({},ee),{},{serviceSettings:o()(o()({},null==ee?void 0:ee.serviceSettings),{},{showQuickFaqs:t.showQuickFaqs,quickFaqKbUid:t.quickFaqKbUid,quickFaqUids:t.quickFaqUids,welcomeFaqUids:null==ee||null===(m=ee.serviceSettings)||void 0===m||null===(m=m.welcomeFaqs)||void 0===m?void 0:m.map((function(e){return e.uid})),faqUids:null==ee||null===(p=ee.serviceSettings)||void 0===p||null===(p=p.faqs)||void 0===p?void 0:p.map((function(e){return e.uid})),guessFaqUids:null==ee||null===(h=ee.serviceSettings)||void 0===h||null===(h=h.guessFaqs)||void 0===h?void 0:h.map((function(e){return e.uid})),hotFaqUids:null==ee||null===(w=ee.serviceSettings)||void 0===w||null===(w=w.hotFaqs)||void 0===w?void 0:w.map((function(e){return e.uid})),shortcutFaqUids:null==ee||null===(b=ee.serviceSettings)||void 0===b||null===(b=b.shortcutFaqs)||void 0===b?void 0:b.map((function(e){return e.uid}))}),robotSettings:o()(o()({},ee.robotSettings),{},{robotUid:null==ee||null===(x=ee.robotSettings)||void 0===x||null===(x=x.robot)||void 0===x?void 0:x.uid}),messageLeaveSettings:o()(o()({},ee.messageLeaveSettings),{},{worktimeUids:null==ee||null===(y=ee.messageLeaveSettings)||void 0===y||null===(y=y.worktimes)||void 0===y?void 0:y.map((function(e){return e.uid}))}),autoReplySettings:o()({},ee.autoReplySettings)}),console.log("agentObject:",q),e.next=16,(0,j.sE)(q);case 16:S=e.sent,console.log("updateAgent response:",S),200===S.code?(c.yw.destroy(),c.yw.success(d.formatMessage({id:"update.success"})),te(S.data)):(c.yw.destroy(),c.yw.error(S.message)),e.next=29;break;case 21:if(i!==C.aZD){e.next=29;break}return P=o()(o()({},ie),{},{serviceSettings:o()(o()({},ie.serviceSettings),{},{showQuickFaqs:t.showQuickFaqs,quickFaqKbUid:t.quickFaqKbUid,quickFaqUids:t.quickFaqUids,welcomeFaqUids:null==ie||null===(k=ie.serviceSettings)||void 0===k||null===(k=k.welcomeFaqs)||void 0===k?void 0:k.map((function(e){return e.uid})),faqUids:null===(F=ie.serviceSettings)||void 0===F||null===(F=F.faqs)||void 0===F?void 0:F.map((function(e){return e.uid})),guessFaqUids:null==ie||null===(U=ie.serviceSettings)||void 0===U||null===(U=U.guessFaqs)||void 0===U?void 0:U.map((function(e){return e.uid})),hotFaqUids:null==ie||null===(R=ie.serviceSettings)||void 0===R||null===(R=R.hotFaqs)||void 0===R?void 0:R.map((function(e){return e.uid})),shortcutFaqUids:null==ie||null===(T=ie.serviceSettings)||void 0===T||null===(T=T.shortcutFaqs)||void 0===T?void 0:T.map((function(e){return e.uid}))}),robotSettings:o()(o()({},ie.robotSettings),{},{robotUid:null==ie||null===(Z=ie.robotSettings)||void 0===Z||null===(Z=Z.robot)||void 0===Z?void 0:Z.uid}),messageLeaveSettings:o()(o()({},ie.messageLeaveSettings),{},{worktimeUids:null==ie||null===(I=ie.messageLeaveSettings)||void 0===I||null===(I=I.worktimes)||void 0===I?void 0:I.map((function(e){return e.uid}))}),agentUids:ie.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",P),e.next=26,(0,M.W5)(P);case 26:A=e.sent,console.log("updateWorkGroup response:",A),200===A.code?(c.yw.destroy(),c.yw.success(d.formatMessage({id:"update.success"})),oe(A.data)):(c.yw.destroy(),c.yw.error(A.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=l()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("TabFaqs handleChange",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,Z.jsx)("div",{children:(0,Z.jsxs)(w.A,{form:a,layout:"vertical",onFinish:ue,submitter:{render:function(e,t){return(0,Z.jsxs)(q.Z,{children:[t,(0,Z.jsx)(S.ZP,{color:"danger",variant:"outlined",icon:(0,Z.jsx)(h.Z,{}),onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:d.formatMessage({id:"preview",defaultMessage:"Preview"})})]})}},children:[(0,Z.jsx)(b.Z,{label:d.formatMessage({id:"faq.show.quick.buttons"}),name:"showQuickFaqs",fieldProps:{onChange:ce}}),(0,Z.jsx)(x.Z,{name:"quickFaqKbUid",width:"md",label:d.formatMessage({id:"menu.kbase.select",defaultMessage:"选择知识库"}),options:null==E||null===(t=E.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return{label:I(e.name),value:e.uid}})),fieldProps:{onChange:function(e){console.log("selected kbase:",e),$(e),a.setFieldValue("quickFaqUids",[]),de(e)},allowClear:!0,placeholder:(0,Z.jsx)(y.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}}),(0,Z.jsx)(x.Z,{name:"quickFaqUids",width:"md",label:d.formatMessage({id:"menu.kbase.quickbutton"}),options:null==B||null===(n=B.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.map((function(e){return{label:I(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:(0,Z.jsx)(y.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}})]})})}},40058:function(e,t,n){n(90819),n(73193),n(89933),n(45332),n(24170),n(66916),n(72614),n(1902),n(66310),n(95490),n(55735),n(30921),n(44194),n(31549)},50796:function(e,t,n){n(90819),n(73193),n(89933),n(45332),n(24170),n(66916),n(72614),n(1902),n(66310),n(95490),n(55735),n(30921),n(44194),n(31549)},75808:function(e,t,n){var i=n(90819),o=n.n(i),s=n(89933),r=n.n(s),a=n(73193),l=n.n(a),d=n(45332),u=n.n(d),c=n(86803),g=n(24170),v=n(66916),f=n(72614),m=n(1902),p=n(66310),h=n(95490),w=n(55735),b=n(69169),x=n(48708),y=n(32350),q=n(30921),S=n(44194),k=n(11184),F=n(3849),U=n(75365),C=n(90297),j=n(31549);t.Z=function(e){var t=e.type,n=(0,q.useIntl)(),i=b.A.useForm(),s=u()(i,1)[0],a=(0,k.M)(),d=a.config,M=a.updateConfig,R=(0,p.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),T=R.currentRobot,Z=R.setCurrentRobot,I=(0,m.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),P=I.currentAgent,A=I.setCurrentAgent,K=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),V=K.currentWorkgroup,L=K.setCurrentWorkgroup,W=(0,S.useMemo)((function(){return t===w._X4?{chatType:w.xtN,chatSid:T.uid}:t===w.Njn?{chatType:w.scI,chatSid:P.uid}:t===w.aZD?{chatType:w.vPY,chatSid:V.uid}:{chatType:w.xtN,chatSid:""}}),[t,T,P,V]),B=W.chatType,_=W.chatSid;(0,S.useEffect)((function(){var e,n,i,o,r,a;if(t===w._X4)s.setFieldsValue({autoPopup:null==T||null===(e=T.serviceSettings)||void 0===e?void 0:e.autoPopup,showInvite:null==T||null===(n=T.inviteSettings)||void 0===n?void 0:n.show,inviteText:null==T||null===(i=T.inviteSettings)||void 0===i?void 0:i.text}),M(l()(l()({},d),{},{autoPopup:null==T||null===(o=T.serviceSettings)||void 0===o?void 0:o.autoPopup,inviteConfig:{show:null==T||null===(r=T.inviteSettings)||void 0===r?void 0:r.show,text:null==T||null===(a=T.inviteSettings)||void 0===a?void 0:a.text},chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_})}));else if(t===w.Njn){var u,c,g,v,f,m;s.setFieldsValue({autoPopup:null==P||null===(u=P.serviceSettings)||void 0===u?void 0:u.autoPopup,showInvite:null==P||null===(c=P.inviteSettings)||void 0===c?void 0:c.show,inviteText:null==P||null===(g=P.inviteSettings)||void 0===g?void 0:g.text}),M(l()(l()({},d),{},{autoPopup:null==P||null===(v=P.serviceSettings)||void 0===v?void 0:v.autoPopup,inviteConfig:{show:null==P||null===(f=P.inviteSettings)||void 0===f?void 0:f.show,text:null==P||null===(m=P.inviteSettings)||void 0===m?void 0:m.text},chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_})}))}else if(t===w.aZD){var p,h,b,x,y,q;s.setFieldsValue({autoPopup:null==V||null===(p=V.serviceSettings)||void 0===p?void 0:p.autoPopup,showInvite:null==V||null===(h=V.inviteSettings)||void 0===h?void 0:h.show,inviteText:null==V||null===(b=V.inviteSettings)||void 0===b?void 0:b.text}),M(l()(l()({},d),{},{autoPopup:null==V||null===(x=V.serviceSettings)||void 0===x?void 0:x.autoPopup,inviteConfig:{show:null==V||null===(y=V.inviteSettings)||void 0===y?void 0:y.show,text:null==V||null===(q=V.inviteSettings)||void 0===q?void 0:q.text},chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_})}))}}),[T,P,V,B,_]);var N=function(){var e=r()(o()().mark((function e(i){var s,r,a,d,u,m,p,h,b,x,y,q,S,k,F,U,C,j,M,R,I,K,W,B,_,N,D,E;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handlePreFormSubmit:",i),t!==w._X4){e.next=11;break}return p=l()(l()({},T),{},{serviceSettings:l()(l()({},T.serviceSettings),{},{autoPopup:i.autoPopup,welcomeFaqUids:null==T||null===(s=T.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==T||null===(r=T.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),quickFaqUids:null==T||null===(a=T.serviceSettings)||void 0===a||null===(a=a.quickFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),guessFaqUids:null==T||null===(d=T.serviceSettings)||void 0===d||null===(d=d.guessFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),hotFaqUids:null==T||null===(u=T.serviceSettings)||void 0===u||null===(u=u.hotFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),shortcutFaqUids:null==T||null===(m=T.serviceSettings)||void 0===m||null===(m=m.shortcutFaqs)||void 0===m?void 0:m.map((function(e){return e.uid}))}),inviteSettings:l()(l()({},T.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("robotObject:",p),e.next=6,(0,v.$l)(p);case 6:h=e.sent,console.log("updateRobot response:",h),200===h.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),Z(h.data)):(c.yw.destroy(),c.yw.error(h.message)),e.next=29;break;case 11:if(t!==w.Njn){e.next=21;break}return C=l()(l()({},P),{},{serviceSettings:l()(l()({},null==P?void 0:P.serviceSettings),{},{autoPopup:i.autoPopup,welcomeFaqUids:null==P||null===(b=P.serviceSettings)||void 0===b||null===(b=b.faqs)||void 0===b?void 0:b.map((function(e){return e.uid})),faqUids:null==P||null===(x=P.serviceSettings)||void 0===x||null===(x=x.faqs)||void 0===x?void 0:x.map((function(e){return e.uid})),quickFaqUids:null==P||null===(y=P.serviceSettings)||void 0===y||null===(y=y.quickFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),guessFaqUids:null==P||null===(q=P.serviceSettings)||void 0===q||null===(q=q.guessFaqs)||void 0===q?void 0:q.map((function(e){return e.uid})),hotFaqUids:null==P||null===(S=P.serviceSettings)||void 0===S||null===(S=S.hotFaqs)||void 0===S?void 0:S.map((function(e){return e.uid})),shortcutFaqUids:null==P||null===(k=P.serviceSettings)||void 0===k||null===(k=k.shortcutFaqs)||void 0===k?void 0:k.map((function(e){return e.uid}))}),robotSettings:l()(l()({},P.robotSettings),{},{robotUid:null==P||null===(F=P.robotSettings)||void 0===F||null===(F=F.robot)||void 0===F?void 0:F.uid}),messageLeaveSettings:l()(l()({},P.messageLeaveSettings),{},{worktimeUids:null==P||null===(U=P.messageLeaveSettings)||void 0===U||null===(U=U.worktimes)||void 0===U?void 0:U.map((function(e){return e.uid}))}),autoReplySettings:l()({},P.autoReplySettings),inviteSettings:l()(l()({},P.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("agentObject:",C),e.next=16,(0,g.sE)(C);case 16:j=e.sent,console.log("updateAgent response:",j),200===j.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),A(j.data)):(c.yw.destroy(),c.yw.error(j.message)),e.next=29;break;case 21:if(t!==w.aZD){e.next=29;break}return D=l()(l()({},V),{},{serviceSettings:l()(l()({},V.serviceSettings),{},{autoPopup:i.autoPopup,welcomeFaqUids:null==V||null===(M=V.serviceSettings)||void 0===M||null===(M=M.faqs)||void 0===M?void 0:M.map((function(e){return e.uid})),faqUids:null==V||null===(R=V.serviceSettings)||void 0===R||null===(R=R.faqs)||void 0===R?void 0:R.map((function(e){return e.uid})),quickFaqUids:null===(I=V.serviceSettings)||void 0===I||null===(I=I.quickFaqs)||void 0===I?void 0:I.map((function(e){return e.uid})),guessFaqUids:null==V||null===(K=V.serviceSettings)||void 0===K||null===(K=K.guessFaqs)||void 0===K?void 0:K.map((function(e){return e.uid})),hotFaqUids:null==V||null===(W=V.serviceSettings)||void 0===W||null===(W=W.hotFaqs)||void 0===W?void 0:W.map((function(e){return e.uid})),shortcutFaqUids:null==V||null===(B=V.serviceSettings)||void 0===B||null===(B=B.shortcutFaqs)||void 0===B?void 0:B.map((function(e){return e.uid}))}),robotSettings:l()(l()({},V.robotSettings),{},{robotUid:null==V||null===(_=V.robotSettings)||void 0===_||null===(_=_.robot)||void 0===_?void 0:_.uid}),messageLeaveSettings:l()(l()({},V.messageLeaveSettings),{},{worktimeUids:null==V||null===(N=V.messageLeaveSettings)||void 0===N||null===(N=N.worktimes)||void 0===N?void 0:N.map((function(e){return e.uid}))}),inviteSettings:l()(l()({},V.inviteSettings),{},{show:i.showInvite,text:i.inviteText}),agentUids:V.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",D),e.next=26,(0,f.W5)(D);case 26:E=e.sent,console.log("updateWorkGroup response:",E),200===E.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),L(E.data)):(c.yw.destroy(),c.yw.error(E.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,j.jsx)("div",{children:(0,j.jsxs)(b.A,{form:s,onFinish:N,submitter:{render:function(e,t){var i=s.getFieldValue("showInvite");return(0,j.jsxs)(F.Z,{children:[t,i&&(0,j.jsx)(U.ZP,{color:"danger",variant:"outlined",icon:(0,j.jsx)(C.Z,{}),onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showInviteDialog()},children:n.formatMessage({id:"preview",defaultMessage:"Preview"})})]})}},children:[(0,j.jsx)(x.Z,{width:"md",name:"autoPopup",label:n.formatMessage({id:"autoPopup",defaultMessage:"Auto Popup"})}),(0,j.jsx)(x.Z,{width:"md",name:"showInvite",label:n.formatMessage({id:"showInvite",defaultMessage:"Show Invite"})}),(0,j.jsx)(y.Z,{width:"md",name:"inviteText",label:n.formatMessage({id:"inviteText",defaultMessage:"Invite Text"})})]})})}},69539:function(e,t,n){n(31549)},23635:function(e,t,n){var i=n(90819),o=n.n(i),s=n(73193),r=n.n(s),a=n(89933),l=n.n(a),d=n(45332),u=n.n(d),c=n(86803),g=n(24170),v=n(72614),f=n(1902),m=n(95490),p=n(55735),h=n(65461),w=n(69169),b=n(48708),x=n(30921),y=n(44194),q=n(51990),S=n(66310),k=n(66916),F=n(76750),U=n(31549);t.Z=function(e){var t=e.type,n=(0,x.useIntl)(),i=w.A.useForm(),s=u()(i,1)[0],a=(0,F.Z)().translateString,d=(0,y.useState)(!1),C=u()(d,2),j=(C[0],C[1],(0,y.useState)("")),M=u()(j,2),R=M[0],T=M[1],Z=(0,S.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),I=Z.currentRobot,P=Z.setCurrentRobot,A=(0,f.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),K=A.currentAgent,V=A.setCurrentAgent,L=(0,m.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),W=L.currentWorkgroup,B=L.setCurrentWorkgroup;(0,y.useEffect)((function(){var e,n,i;if(t===p.Njn)s.setFieldValue("showRateBtn",null==K||null===(e=K.serviceSettings)||void 0===e?void 0:e.showRateBtn),s.setFieldValue("autoInviteRate",null==K||null===(n=K.serviceSettings)||void 0===n?void 0:n.autoInviteRate),T(a(null==K||null===(i=K.serviceSettings)||void 0===i?void 0:i.inviteRateTip));else if(t===p.aZD){var o,r,l;s.setFieldValue("showRateBtn",null==W||null===(o=W.serviceSettings)||void 0===o?void 0:o.showRateBtn),s.setFieldValue("autoInviteRate",null==W||null===(r=W.serviceSettings)||void 0===r?void 0:r.autoInviteRate),T(a(null==W||null===(l=W.serviceSettings)||void 0===l?void 0:l.inviteRateTip))}else if(t===p._X4){var d,u,c;s.setFieldValue("showRateBtn",null==I||null===(d=I.serviceSettings)||void 0===d?void 0:d.showRateBtn),s.setFieldValue("autoInviteRate",null==I||null===(u=I.serviceSettings)||void 0===u?void 0:u.autoInviteRate),T(a(null==I||null===(c=I.serviceSettings)||void 0===c?void 0:c.inviteRateTip))}}),[K,W]);var _=function(){var e=l()(o()().mark((function e(i){var s,a,l,d,u,f,m,h,w,b,x,y,q,S,F,U,C,j,M,T,Z,A,L,_,N,D,E;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onFinish:",i),t!==p._X4){e.next=11;break}return f=r()(r()({},I),{},{serviceSettings:r()(r()({},I.serviceSettings),{},{showRateBtn:i.showRateBtn,autoInviteRate:i.autoInviteRate,inviteRateTip:R,rateMsgCount:i.rateMsgCount,welcomeFaqUids:null==i?void 0:i.welcomeFaqUids,quickFaqUids:null===(s=K.serviceSettings)||void 0===s||null===(s=s.quickFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==I||null===(a=I.serviceSettings)||void 0===a||null===(a=a.faqs)||void 0===a?void 0:a.map((function(e){return e.uid})),guessFaqUids:null==I||null===(l=I.serviceSettings)||void 0===l||null===(l=l.guessFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})),hotFaqUids:null==I||null===(d=I.serviceSettings)||void 0===d||null===(d=d.hotFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),shortcutFaqUids:null==I||null===(u=I.serviceSettings)||void 0===u||null===(u=u.shortcutFaqs)||void 0===u?void 0:u.map((function(e){return e.uid}))})}),console.log("robotObject:",f),e.next=6,(0,k.$l)(f);case 6:m=e.sent,console.log("updateRobot response:",m),200===m.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),P(m.data)):(c.yw.destroy(),c.yw.error(m.message)),e.next=29;break;case 11:if(t!==p.Njn){e.next=21;break}return U=r()(r()({},K),{},{serviceSettings:r()(r()({},null==K?void 0:K.serviceSettings),{},{showRateBtn:i.showRateBtn,autoInviteRate:i.autoInviteRate,inviteRateTip:R,rateMsgCount:i.rateMsgCount,welcomeFaqUids:null==K||null===(h=K.serviceSettings)||void 0===h||null===(h=h.welcomeFaqs)||void 0===h?void 0:h.map((function(e){return e.uid})),quickFaqUids:null==K||null===(w=K.serviceSettings)||void 0===w||null===(w=w.quickFaqs)||void 0===w?void 0:w.map((function(e){return e.uid})),faqUids:null==K||null===(b=K.serviceSettings)||void 0===b||null===(b=b.faqs)||void 0===b?void 0:b.map((function(e){return e.uid})),guessFaqUids:null==K||null===(x=K.serviceSettings)||void 0===x||null===(x=x.guessFaqs)||void 0===x?void 0:x.map((function(e){return e.uid})),hotFaqUids:null==K||null===(y=K.serviceSettings)||void 0===y||null===(y=y.hotFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),shortcutFaqUids:null==K||null===(q=K.serviceSettings)||void 0===q||null===(q=q.shortcutFaqs)||void 0===q?void 0:q.map((function(e){return e.uid}))}),robotSettings:r()(r()({},K.robotSettings),{},{robotUid:null==K||null===(S=K.robotSettings)||void 0===S||null===(S=S.robot)||void 0===S?void 0:S.uid}),messageLeaveSettings:r()(r()({},K.messageLeaveSettings),{},{worktimeUids:null==K||null===(F=K.messageLeaveSettings)||void 0===F||null===(F=F.worktimes)||void 0===F?void 0:F.map((function(e){return e.uid}))}),autoReplySettings:r()({},K.autoReplySettings)}),console.log("agentObject:",U),e.next=16,(0,g.sE)(U);case 16:C=e.sent,console.log("updateAgent response:",C),200===C.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),V(C.data)):(c.yw.destroy(),c.yw.error(C.message)),e.next=29;break;case 21:if(t!==p.aZD){e.next=29;break}return D=r()(r()({},W),{},{serviceSettings:r()(r()({},W.serviceSettings),{},{showRateBtn:i.showRateBtn,autoInviteRate:i.autoInviteRate,inviteRateTip:R,rateMsgCount:i.rateMsgCount,welcomeFaqUids:null==W||null===(j=W.serviceSettings)||void 0===j||null===(j=j.welcomeFaqs)||void 0===j?void 0:j.map((function(e){return e.uid})),quickFaqUids:null===(M=W.serviceSettings)||void 0===M||null===(M=M.quickFaqs)||void 0===M?void 0:M.map((function(e){return e.uid})),faqUids:null==W||null===(T=W.serviceSettings)||void 0===T||null===(T=T.faqs)||void 0===T?void 0:T.map((function(e){return e.uid})),guessFaqUids:null==W||null===(Z=W.serviceSettings)||void 0===Z||null===(Z=Z.guessFaqs)||void 0===Z?void 0:Z.map((function(e){return e.uid})),hotFaqUids:null===(A=W.serviceSettings)||void 0===A||null===(A=A.hotFaqs)||void 0===A?void 0:A.map((function(e){return e.uid})),shortcutFaqUids:null==W||null===(L=W.serviceSettings)||void 0===L||null===(L=L.shortcutFaqs)||void 0===L?void 0:L.map((function(e){return e.uid}))}),robotSettings:r()(r()({},W.robotSettings),{},{robotUid:null==W||null===(_=W.robotSettings)||void 0===_||null===(_=_.robot)||void 0===_?void 0:_.uid}),messageLeaveSettings:r()(r()({},W.messageLeaveSettings),{},{worktimeUids:null==W||null===(N=W.messageLeaveSettings)||void 0===N||null===(N=N.worktimes)||void 0===N?void 0:N.map((function(e){return e.uid}))}),agentUids:W.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",D),e.next=26,(0,v.W5)(D);case 26:E=e.sent,console.log("updateWorkGroup response:",E),200===E.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),B(E.data)):(c.yw.destroy(),c.yw.error(E.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,U.jsx)(U.Fragment,{children:(0,U.jsxs)(w.A,{form:s,onFinish:_,style:{marginLeft:"20px"},children:[(0,U.jsx)(b.Z,{width:"md",name:"autoInviteRate",label:n.formatMessage({id:"rate.auto.invite.rate"}),tooltip:n.formatMessage({id:"rate.auto.invite.rate.tooltip"})}),(0,U.jsx)(w.A.Item,{name:"inviteRateTip",label:n.formatMessage({id:"rate.auto.invite.rate.tip"}),tooltip:n.formatMessage({id:"rate.auto.invite.rate.tip.tooltip"}),rules:[{required:!0,message:n.formatMessage({id:"rate.auto.invite.rate.tip.required"})}],children:(0,U.jsx)(q.Z,{placeholder:n.formatMessage({id:"rate.auto.invite.rate.tip.placeholder"}),value:R,toolbarKeys:(0,h.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){T(e)}})}),!1]})})}},40836:function(e,t,n){var i=n(90819),o=n.n(i),s=n(89933),r=n.n(s),a=n(73193),l=n.n(a),d=n(45332),u=n.n(d),c=n(86803),g=n(24170),v=n(66916),f=n(72614),m=n(1902),p=n(66310),h=n(95490),w=n(55735),b=n(69169),x=n(48708),y=n(32350),q=n(30921),S=n(44194),k=n(3849),F=n(75365),U=n(11184),C=n(90297),j=n(31549);t.Z=function(e){var t=e.type,n=(0,q.useIntl)(),i=b.A.useForm(),s=u()(i,1)[0],a=(0,U.M)(),d=a.config,M=a.updateConfig,R=(0,p.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),T=R.currentRobot,Z=R.setCurrentRobot,I=(0,m.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),P=I.currentAgent,A=I.setCurrentAgent,K=(0,h.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),V=K.currentWorkgroup,L=K.setCurrentWorkgroup,W=(0,S.useMemo)((function(){return t===w._X4?{chatType:w.xtN,chatSid:T.uid}:t===w.Njn?{chatType:w.scI,chatSid:P.uid}:t===w.aZD?{chatType:w.vPY,chatSid:V.uid}:{chatType:w.xtN,chatSid:""}}),[t,T,P,V]),B=W.chatType,_=W.chatSid;(0,S.useEffect)((function(){if(t===w._X4){var e,n,i=null==T||null===(e=T.serviceSettings)||void 0===e?void 0:e.showRightIframe;s.setFieldsValue({showRightIframe:i,rightIframeUrl:null==T||null===(n=T.serviceSettings)||void 0===n?void 0:n.rightIframeUrl}),M(i?l()(l()({},d),{},{chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_}),window:l()(l()({},d.window),{},{width:680})}):l()(l()({},d),{},{chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_}),window:l()(l()({},d.window),{},{width:380})}))}else if(t===w.Njn){var o,r,a=null==P||null===(o=P.serviceSettings)||void 0===o?void 0:o.showRightIframe;s.setFieldsValue({showRightIframe:a,rightIframeUrl:null==P||null===(r=P.serviceSettings)||void 0===r?void 0:r.rightIframeUrl}),M(a?l()(l()({},d),{},{chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_}),window:l()(l()({},d.window),{},{width:680})}):l()(l()({},d),{},{chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_}),window:l()(l()({},d.window),{},{width:380})}))}else if(t===w.aZD){var u,c,g=null==V||null===(u=V.serviceSettings)||void 0===u?void 0:u.showRightIframe;s.setFieldsValue({showRightIframe:g,rightIframeUrl:null==V||null===(c=V.serviceSettings)||void 0===c?void 0:c.rightIframeUrl}),M(g?l()(l()({},d),{},{chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_}),window:l()(l()({},d.window),{},{width:680})}):l()(l()({},d),{},{chatConfig:l()(l()({},d.chatConfig),{},{t:B,sid:_}),window:l()(l()({},d.window),{},{width:380})}))}}),[T,P,V,B,_]);var N=function(){var e=r()(o()().mark((function e(i){var s,r,a,d,u,m,p,h,b,x,y,q,S,k,F,U,C,j,M,R,I,K,W,B,_,N,D,E,O;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleRightSubmit:",i),t!==w._X4){e.next=11;break}return p=l()(l()({},T),{},{serviceSettings:l()(l()({},T.serviceSettings),{},{showRightIframe:i.showRightIframe,rightIframeUrl:i.rightIframeUrl,welcomeFaqUids:null==T||null===(s=T.serviceSettings)||void 0===s||null===(s=s.welcomeFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==T||null===(r=T.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),quickFaqUids:null==T||null===(a=T.serviceSettings)||void 0===a||null===(a=a.quickFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})),guessFaqUids:null==T||null===(d=T.serviceSettings)||void 0===d||null===(d=d.guessFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),hotFaqUids:null==T||null===(u=T.serviceSettings)||void 0===u||null===(u=u.hotFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),shortcutFaqUids:null==T||null===(m=T.serviceSettings)||void 0===m||null===(m=m.shortcutFaqs)||void 0===m?void 0:m.map((function(e){return e.uid}))})}),console.log("robotObject:",p),e.next=6,(0,v.$l)(p);case 6:h=e.sent,console.log("updateRobot response:",h),200===h.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),Z(h.data)):(c.yw.destroy(),c.yw.error(h.message)),e.next=29;break;case 11:if(t!==w.Njn){e.next=21;break}return C=l()(l()({},P),{},{serviceSettings:l()(l()({},null==P?void 0:P.serviceSettings),{},{showRightIframe:i.showRightIframe,rightIframeUrl:i.rightIframeUrl,welcomeFaqUids:null==P||null===(b=P.serviceSettings)||void 0===b||null===(b=b.welcomeFaqs)||void 0===b?void 0:b.map((function(e){return e.uid})),faqUids:null==P||null===(x=P.serviceSettings)||void 0===x||null===(x=x.faqs)||void 0===x?void 0:x.map((function(e){return e.uid})),quickFaqUids:null==P||null===(y=P.serviceSettings)||void 0===y||null===(y=y.quickFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),guessFaqUids:null==P||null===(q=P.serviceSettings)||void 0===q||null===(q=q.guessFaqs)||void 0===q?void 0:q.map((function(e){return e.uid})),hotFaqUids:null==P||null===(S=P.serviceSettings)||void 0===S||null===(S=S.hotFaqs)||void 0===S?void 0:S.map((function(e){return e.uid})),shortcutFaqUids:null==P||null===(k=P.serviceSettings)||void 0===k||null===(k=k.shortcutFaqs)||void 0===k?void 0:k.map((function(e){return e.uid}))}),robotSettings:l()(l()({},P.robotSettings),{},{robotUid:null==P||null===(F=P.robotSettings)||void 0===F||null===(F=F.robot)||void 0===F?void 0:F.uid}),messageLeaveSettings:l()(l()({},P.messageLeaveSettings),{},{worktimeUids:null==P||null===(U=P.messageLeaveSettings)||void 0===U||null===(U=U.worktimes)||void 0===U?void 0:U.map((function(e){return e.uid}))}),autoReplySettings:l()({},P.autoReplySettings)}),console.log("agentObject:",C),e.next=16,(0,g.sE)(C);case 16:j=e.sent,console.log("updateAgent response:",j),200===j.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),A(j.data)):(c.yw.destroy(),c.yw.error(j.message)),e.next=29;break;case 21:if(t!==w.aZD){e.next=29;break}return E=l()(l()({},V),{},{serviceSettings:l()(l()({},V.serviceSettings),{},{showRightIframe:i.showRightIframe,rightIframeUrl:i.rightIframeUrl,welcomeFaqUids:null==V||null===(M=V.serviceSettings)||void 0===M||null===(M=M.welcomeFaqs)||void 0===M?void 0:M.map((function(e){return e.uid})),faqUids:null==V||null===(R=V.serviceSettings)||void 0===R||null===(R=R.faqs)||void 0===R?void 0:R.map((function(e){return e.uid})),quickFaqUids:null==V||null===(I=V.serviceSettings)||void 0===I||null===(I=I.quickFaqs)||void 0===I?void 0:I.map((function(e){return e.uid})),guessFaqUids:null==V||null===(K=V.serviceSettings)||void 0===K||null===(K=K.guessFaqs)||void 0===K?void 0:K.map((function(e){return e.uid})),hotFaqUids:null==V||null===(W=V.serviceSettings)||void 0===W||null===(W=W.hotFaqs)||void 0===W?void 0:W.map((function(e){return e.uid})),shortcutFaqUids:null==V||null===(B=V.serviceSettings)||void 0===B||null===(B=B.shortcutFaqs)||void 0===B?void 0:B.map((function(e){return e.uid}))}),robotSettings:l()(l()({},V.robotSettings),{},{robotUid:null==V||null===(_=V.robotSettings)||void 0===_||null===(_=_.robot)||void 0===_?void 0:_.uid}),messageLeaveSettings:l()(l()({},V.messageLeaveSettings),{},{worktimeUids:null==V||null===(N=V.messageLeaveSettings)||void 0===N||null===(N=N.worktimes)||void 0===N?void 0:N.map((function(e){return e.uid}))}),agentUids:null==V||null===(D=V.agents)||void 0===D?void 0:D.map((function(e){return e.uid}))}),console.log("workgroupObject:",E),e.next=26,(0,f.W5)(E);case 26:O=e.sent,console.log("updateWorkGroup response:",O),200===O.code?(c.yw.destroy(),c.yw.success(n.formatMessage({id:"update.success"})),L(O.data)):(c.yw.destroy(),c.yw.error(O.message));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,j.jsx)("div",{children:(0,j.jsxs)(b.A,{form:s,onFinish:N,submitter:{render:function(e,t){return(0,j.jsxs)(k.Z,{children:[t,(0,j.jsx)(F.ZP,{color:"danger",variant:"outlined",icon:(0,j.jsx)(C.Z,{}),onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:n.formatMessage({id:"preview",defaultMessage:"Preview"})})]})}},children:[(0,j.jsx)(x.Z,{width:"md",name:"showRightIframe",label:n.formatMessage({id:"showRightIframe"})}),(0,j.jsx)(y.Z,{width:"md",name:"rightIframeUrl",label:n.formatMessage({id:"rightIframeUrl"}),placeholder:n.formatMessage({id:"rightIframeUrl.placeholder",defaultMessage:"请输入有效的URL地址"}),rules:[{pattern:/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([\/\w.-]*)*\/?$/,message:n.formatMessage({id:"rightIframeUrl.invalid",defaultMessage:"请输入有效的URL地址"})}]})]})})}},14238:function(e,t,n){var i=n(73193),o=n.n(i),s=n(90819),r=n.n(s),a=n(89933),l=n.n(a),d=n(45332),u=n.n(d),c=n(86803),g=n(24170),v=n(66916),f=n(72614),m=n(76750),p=n(1902),h=n(66310),w=n(95490),b=n(55735),x=n(69169),y=n(85954),q=n(84881),S=n(79907),k=n(30921),F=n(44194),U=n(51990),C=n(65461),j=n(40612),M=n(99885),R=n(27522),T=n(31549);t.Z=function(e){var t,n,i=e.type,s=x.A.useForm(),a=u()(s,1)[0],d=(0,k.useIntl)(),Z=(0,m.Z)().translateString,I=(0,F.useState)(!1),P=u()(I,2),A=P[0],K=P[1],V=(0,j.u)((function(e){return e.currentOrg})),L=(0,F.useState)(),W=u()(L,2),B=W[0],_=W[1],N=(0,F.useState)(),D=u()(N,2),E=D[0],O=D[1],X=(0,F.useState)(),z=u()(X,2),Q=z[0],$=z[1],G=(0,h.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),H=G.currentRobot,Y=G.setCurrentRobot,J=(0,p.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),ee=J.currentAgent,te=J.setCurrentAgent,ne=(0,w.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),ie=ne.currentWorkgroup,oe=ne.setCurrentWorkgroup,se=(0,F.useState)(""),re=u()(se,2),ae=re[0],le=re[1],de=(0,F.useState)(""),ue=u()(de,2),ce=ue[0],ge=ue[1],ve=(0,F.useState)(""),fe=u()(ve,2),me=fe[0],pe=fe[1],he=(0,F.useState)(""),we=u()(he,2),be=we[0],xe=we[1],ye=(0,F.useState)(""),qe=u()(ye,2),Se=qe[0],ke=qe[1],Fe=(0,F.useState)(!1),Ue=u()(Fe,2),Ce=Ue[0],je=Ue[1],Me=(0,F.useState)(""),Re=u()(Me,2),Te=Re[0],Ze=Re[1],Ie=function(){var e=l()(r()().mark((function e(){var t,n,o,s,l,u;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(d.formatMessage({id:"loading",defaultMessage:"Loading"})),t={pageNumber:0,pageSize:50,type:b.QPQ,orgUid:null==V?void 0:V.uid},e.next=4,(0,R.AP)(t);case 4:n=e.sent,console.log("getKbases response:",t,n),c.yw.destroy(),200===n.code?(O(n),i===b._X4&&null!=H&&null!==(o=H.serviceSettings)&&void 0!==o&&o.welcomeKbUid?($(H.serviceSettings.welcomeKbUid),a.setFieldValue("welcomeKbUid",H.serviceSettings.welcomeKbUid),Pe(H.serviceSettings.welcomeKbUid)):i===b.Njn&&null!=ee&&null!==(s=ee.serviceSettings)&&void 0!==s&&s.welcomeKbUid?($(ee.serviceSettings.welcomeKbUid),a.setFieldValue("welcomeKbUid",ee.serviceSettings.welcomeKbUid),Pe(ee.serviceSettings.welcomeKbUid)):i===b.aZD&&null!=ie&&null!==(l=ie.serviceSettings)&&void 0!==l&&l.welcomeKbUid?($(ie.serviceSettings.welcomeKbUid),a.setFieldValue("welcomeKbUid",ie.serviceSettings.welcomeKbUid),Pe(ie.serviceSettings.welcomeKbUid)):(null===(u=n.data)||void 0===u||null===(u=u.content)||void 0===u?void 0:u.length)>0&&($(n.data.content[0].uid),a.setFieldValue("welcomeKbUid",n.data.content[0].uid),Pe(n.data.content[0].uid))):c.yw.error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=l()(r()().mark((function e(t){var n,i;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.yw.loading(d.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:50,orgUid:null==V?void 0:V.uid,kbUid:t||Q},e.next=4,(0,M.pf)(n);case 4:i=e.sent,console.log("getFaqs response:",n,i),c.yw.destroy(),200===i.code?_(i):c.yw.error(i.message);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,F.useEffect)((function(){Ie()}),[]);var Ae=function(e){if(console.log("setFormValues:",e),le(Z(null==e?void 0:e.welcomeTip)),pe(Z(null==e?void 0:e.topTip)),xe(Z(null==e?void 0:e.agentCloseTip)),ke(Z(null==e?void 0:e.autoCloseTip)),K(null==e?void 0:e.showTopTip),je(null==e?void 0:e.showUnknownAnswer),Ze(Z(null==e?void 0:e.unknownAnswer)),a.setFieldValue("showTopTip",null==e?void 0:e.showTopTip),a.setFieldValue("autoCloseMin",null==e?void 0:e.autoCloseMin),a.setFieldValue("showLogo",null==e?void 0:e.showLogo),a.setFieldValue("showUnknownAnswer",null==e?void 0:e.showUnknownAnswer),null!=e&&e.welcomeKbUid&&(a.setFieldValue("welcomeKbUid",null==e?void 0:e.welcomeKbUid),Pe(null==e?void 0:e.welcomeKbUid)),null!=e&&e.welcomeFaqs&&(null==e?void 0:e.welcomeFaqs.length)>0){var t=e.welcomeFaqs.map((function(e){return e.uid}));console.log("从welcomeFaqs提取uid初始化:",t),a.setFieldValue("welcomeFaqUids",t)}else console.log("设置welcomeFaqUids为空数组"),a.setFieldValue("welcomeFaqUids",[]);if(i===b._X4);else if(i===b.Njn){var n;ge(Z(null==ee||null===(n=ee.messageLeaveSettings)||void 0===n?void 0:n.messageLeaveTip)),a.setFieldValue("maxThreadCount",null==ee?void 0:ee.maxThreadCount),a.setFieldValue("timeoutRemindTime",null==ee?void 0:ee.timeoutRemindTime)}else if(i===b.aZD){var o;ge(Z(null==ie||null===(o=ie.messageLeaveSettings)||void 0===o?void 0:o.messageLeaveTip))}};(0,F.useEffect)((function(){i===b._X4?null!=H&&H.serviceSettings&&(console.log("初始化机器人设置:",H.serviceSettings),Ae(H.serviceSettings)):i===b.Njn?null!=ee&&ee.serviceSettings&&(console.log("初始化客服设置:",ee.serviceSettings),Ae(ee.serviceSettings),a.setFieldValue("maxThreadCount",null==ee?void 0:ee.maxThreadCount)):i===b.aZD&&null!=ie&&ie.serviceSettings&&(console.log("初始化工作组设置:",ie.serviceSettings),Ae(ie.serviceSettings))}),[H,ee,ie]);var Ke=function(){var e=l()(r()().mark((function e(t){var n,s,a,l,u,m,p,h,w,x,y,q,S,k,F,U,C,j,M,R,T,Z,I,P,K;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("表单提交的值:",t),c.yw.loading(d.formatMessage({id:"updating"})),i!==b._X4){e.next=12;break}return m=o()(o()({},H),{},{serviceSettings:o()(o()({},H.serviceSettings),{},{topTip:me,showTopTip:A,welcomeTip:ae,autoCloseTip:Se,autoCloseMin:(null==t?void 0:t.autoCloseMin)||25,showLogo:(null==t?void 0:t.showLogo)||!0,showUnknownAnswer:Ce,unknownAnswer:Te,welcomeKbUid:null==t?void 0:t.welcomeKbUid,welcomeFaqUids:(null==t?void 0:t.welcomeFaqUids)||[],quickFaqUids:(null===(n=H.serviceSettings)||void 0===n||null===(n=n.quickFaqs)||void 0===n?void 0:n.map((function(e){return e.uid})))||[],faqUids:(null==H||null===(s=H.serviceSettings)||void 0===s||null===(s=s.faqs)||void 0===s?void 0:s.map((function(e){return e.uid})))||[],guessFaqUids:(null==H||null===(a=H.serviceSettings)||void 0===a||null===(a=a.guessFaqs)||void 0===a?void 0:a.map((function(e){return e.uid})))||[],hotFaqUids:(null==H||null===(l=H.serviceSettings)||void 0===l||null===(l=l.hotFaqs)||void 0===l?void 0:l.map((function(e){return e.uid})))||[],shortcutFaqUids:(null==H||null===(u=H.serviceSettings)||void 0===u||null===(u=u.shortcutFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})))||[]})}),console.log("提交的机器人对象:",m),e.next=7,(0,v.$l)(m);case 7:p=e.sent,console.log("updateRobot response:",p),200===p.code?(c.yw.destroy(),c.yw.success(d.formatMessage({id:"update.success"})),Y(p.data)):(c.yw.destroy(),c.yw.error(p.message)),e.next=30;break;case 12:if(i!==b.Njn){e.next=22;break}return F=o()(o()({},ee),{},{serviceSettings:o()(o()({},ee.serviceSettings),{},{topTip:me,showTopTip:A,welcomeTip:ae,agentCloseTip:be,autoCloseTip:Se,autoCloseMin:(null==t?void 0:t.autoCloseMin)||25,showLogo:(null==t?void 0:t.showLogo)||!0,showUnknownAnswer:Ce,unknownAnswer:Te,welcomeKbUid:null==t?void 0:t.welcomeKbUid,welcomeFaqUids:null==t?void 0:t.welcomeFaqUids,quickFaqUids:null===(h=ee.serviceSettings)||void 0===h||null===(h=h.quickFaqs)||void 0===h?void 0:h.map((function(e){return e.uid})),faqUids:null===(w=ee.serviceSettings)||void 0===w||null===(w=w.faqs)||void 0===w?void 0:w.map((function(e){return e.uid})),guessFaqUids:null==ee||null===(x=ee.serviceSettings)||void 0===x||null===(x=x.guessFaqs)||void 0===x?void 0:x.map((function(e){return e.uid})),hotFaqUids:null==ee||null===(y=ee.serviceSettings)||void 0===y||null===(y=y.hotFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),shortcutFaqUids:null==ee||null===(q=ee.serviceSettings)||void 0===q||null===(q=q.shortcutFaqs)||void 0===q?void 0:q.map((function(e){return e.uid}))}),messageLeaveSettings:o()(o()({},ee.messageLeaveSettings),{},{messageLeaveTip:ce,worktimeUids:null===(S=ee.messageLeaveSettings)||void 0===S||null===(S=S.worktimes)||void 0===S?void 0:S.map((function(e){return e.uid}))}),robotSettings:o()(o()({},ee.robotSettings),{},{robotUid:null===(k=ee.robotSettings)||void 0===k||null===(k=k.robot)||void 0===k?void 0:k.uid}),maxThreadCount:(null==t?void 0:t.maxThreadCount)||10,timeoutRemindTime:(null==t?void 0:t.timeoutRemindTime)||5}),console.log("agentObject:",F),e.next=17,(0,g.sE)(F);case 17:U=e.sent,console.log("updateAgent response:",U),200===U.code?(c.yw.destroy(),c.yw.success(d.formatMessage({id:"update.success"})),te(U.data)):(c.yw.destroy(),c.yw.error(U.message)),e.next=30;break;case 22:if(i!==b.aZD){e.next=30;break}return P=o()(o()({},ie),{},{serviceSettings:o()(o()({},ie.serviceSettings),{},{topTip:me,showTopTip:A,welcomeTip:ae,agentCloseTip:be,autoCloseTip:Se,autoCloseMin:(null==t?void 0:t.autoCloseMin)||25,showLogo:(null==t?void 0:t.showLogo)||!0,showUnknownAnswer:Ce,unknownAnswer:Te,welcomeKbUid:null==t?void 0:t.welcomeKbUid,welcomeFaqUids:null==t?void 0:t.welcomeFaqUids,quickFaqUids:null===(C=ie.serviceSettings)||void 0===C||null===(C=C.quickFaqs)||void 0===C?void 0:C.map((function(e){return e.uid})),faqUids:null===(j=ie.serviceSettings)||void 0===j||null===(j=j.faqs)||void 0===j?void 0:j.map((function(e){return e.uid})),guessFaqUids:null==ie||null===(M=ie.serviceSettings)||void 0===M||null===(M=M.guessFaqs)||void 0===M?void 0:M.map((function(e){return e.uid})),hotFaqUids:null==ie||null===(R=ie.serviceSettings)||void 0===R||null===(R=R.hotFaqs)||void 0===R?void 0:R.map((function(e){return e.uid})),shortcutFaqUids:null==ie||null===(T=ie.serviceSettings)||void 0===T||null===(T=T.shortcutFaqs)||void 0===T?void 0:T.map((function(e){return e.uid}))}),messageLeaveSettings:o()(o()({},ie.messageLeaveSettings),{},{messageLeaveTip:ce,worktimeUids:null===(Z=ie.messageLeaveSettings)||void 0===Z||null===(Z=Z.worktimes)||void 0===Z?void 0:Z.map((function(e){return e.uid}))}),robotSettings:o()(o()({},ie.robotSettings),{},{robotUid:null===(I=ie.robotSettings)||void 0===I||null===(I=I.robot)||void 0===I?void 0:I.uid}),agentUids:ie.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",P),e.next=27,(0,f.W5)(P);case 27:K=e.sent,console.log("updateWorkGroup response:",K),200===K.code?(c.yw.destroy(),c.yw.success(d.formatMessage({id:"update.success"})),oe(K.data)):(c.yw.destroy(),c.yw.error(K.message));case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,T.jsxs)(x.A,{form:a,onFinish:Ke,style:{marginLeft:"20px"},children:[(0,T.jsx)(y.Z,{name:"showTopTip",width:"md",label:d.formatMessage({id:"agent.settings.show.top.tip"}),fieldProps:{onChange:function(e){var t,n;if(console.log("checked = ".concat(e.target.checked,", showTopTip:").concat(null==ee||null===(t=ee.serviceSettings)||void 0===t?void 0:t.showTopTip)),K(e.target.checked),e.target.checked)if(i===b._X4)pe(Z(null==H||null===(n=H.serviceSettings)||void 0===n?void 0:n.topTip));else if(i===b.Njn){var o;pe(Z(null==ee||null===(o=ee.serviceSettings)||void 0===o?void 0:o.topTip))}else if(i===b.aZD){var s;pe(Z(null==ie||null===(s=ie.serviceSettings)||void 0===s?void 0:s.topTip))}}}}),A&&(0,T.jsx)(x.A.Item,{name:"topTip",label:d.formatMessage({id:"agent.settings.top.tip"}),rules:[{required:!0,message:d.formatMessage({id:"agent.settings.top.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:d.formatMessage({id:"agent.settings.top.tip.placeholder"}),value:me,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){pe(e)}})}),(0,T.jsx)(x.A.Item,{name:"welcomeTip",label:d.formatMessage({id:"agent.settings.welcome.tip"}),tooltip:d.formatMessage({id:"agent.settings.welcome.tip"}),rules:[{required:!0,message:d.formatMessage({id:"agent.settings.welcome.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:d.formatMessage({id:"agent.settings.welcome.tip.placeholder"}),value:ae,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){le(e)}})}),(0,T.jsx)(q.Z,{name:"welcomeKbUid",width:"md",label:d.formatMessage({id:"menu.kbase.select",defaultMessage:"选择知识库"}),options:null==E||null===(t=E.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return{label:Z(e.name),value:e.uid}})),fieldProps:{onChange:function(e){console.log("selected kbase:",e),$(e),Pe(e)},allowClear:!0,placeholder:(0,T.jsx)(k.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}}),(0,T.jsx)(q.Z,{name:"welcomeFaqUids",width:"md",label:d.formatMessage({id:"menu.kbase.faq.welcome"}),options:null==B||null===(n=B.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.map((function(e){return{label:Z(e.question),value:e.uid}})),fieldProps:{mode:"multiple",allowClear:!0,placeholder:(0,T.jsx)(k.FormattedMessage,{id:"choose",defaultMessage:"Choose"})}}),i!=b._X4&&(0,T.jsx)(x.A.Item,{name:"messageLeaveTip",label:d.formatMessage({id:"agent.settings.leave.msg"}),rules:[{required:!0,message:d.formatMessage({id:"agent.settings.leave.msg.required"})}],children:(0,T.jsx)(U.Z,{placeholder:d.formatMessage({id:"agent.settings.leave.msg.placeholder"}),value:ce,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){ge(e)}})}),i!=b._X4&&(0,T.jsx)(x.A.Item,{name:"agentCloseTip",label:d.formatMessage({id:"agent.settings.agent.close.tip"}),tooltip:d.formatMessage({id:"agent.settings.agent.close.tip.tooltip"}),rules:[{required:!0,message:d.formatMessage({id:"agent.settings.agent.close.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:d.formatMessage({id:"agent.settings.agent.close.tip.placeholder"}),value:be,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){xe(e)}})}),(0,T.jsx)(x.A.Item,{name:"autoCloseTip",label:d.formatMessage({id:"agent.settings.auto.close.tip"}),tooltip:d.formatMessage({id:"agent.settings.auto.close.tip.tooltip"}),rules:[{required:!0,message:d.formatMessage({id:"agent.settings.auto.close.tip.required"})}],children:(0,T.jsx)(U.Z,{placeholder:d.formatMessage({id:"agent.settings.auto.close.tip.placeholder"}),value:Se,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){ke(e)}})}),i===b._X4&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(y.Z,{name:"showUnknownAnswer",width:"md",label:d.formatMessage({id:"agent.settings.show.unknown.answer",defaultMessage:"启用未知问题固定回复"}),fieldProps:{onChange:function(e){var t;if(console.log("checked = ".concat(e.target.checked)),je(e.target.checked),e.target.checked)if(i===b._X4)Ze(Z(null==H||null===(t=H.serviceSettings)||void 0===t?void 0:t.unknownAnswer));else if(i===b.Njn){var n;Ze(Z(null==ee||null===(n=ee.serviceSettings)||void 0===n?void 0:n.unknownAnswer))}else if(i===b.aZD){var o;Ze(Z(null==ie||null===(o=ie.serviceSettings)||void 0===o?void 0:o.unknownAnswer))}}}}),Ce&&(0,T.jsx)(x.A.Item,{name:"unknownAnswer",label:d.formatMessage({id:"agent.settings.unknown.answer",defaultMessage:"未知问题固定回复"}),rules:[{required:!0,message:d.formatMessage({id:"agent.settings.unknown.answer.required",defaultMessage:"请输入未知问题固定回复"})}],children:(0,T.jsx)(U.Z,{placeholder:d.formatMessage({id:"agent.settings.unknown.answer.placeholder",defaultMessage:"请输入未知问题固定回复"}),value:Te,toolbarKeys:(0,C.eD)(),style:{height:"200px",width:"600px"},onChange:function(e){Ze(e)}})})]}),i===b.Njn&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("p",{children:d.formatMessage({id:"agent.settings.max.thread.tip1"})}),(0,T.jsx)("p",{children:d.formatMessage({id:"agent.settings.max.thread.tip2"})}),(0,T.jsx)("p",{children:d.formatMessage({id:"agent.settings.max.thread.tip3"})}),(0,T.jsx)(S.Z,{width:"md",name:"maxThreadCount",label:d.formatMessage({id:"agent.settings.max.thread"}),min:0}),(0,T.jsx)(S.Z,{width:"md",name:"timeoutRemindTime",label:d.formatMessage({id:"agent.settings.timeout.remind",defaultMessage:"超时提醒时间"}),tooltip:d.formatMessage({id:"agent.settings.timeout.remind.tooltip",defaultMessage:"超过设定时间未回复客户将收到提醒"}),min:1,fieldProps:{addonAfter:d.formatMessage({id:"time.minute",defaultMessage:"分钟"})}})]}),(0,T.jsx)(S.Z,{width:"md",name:"autoCloseMin",label:d.formatMessage({id:"agent.settings.auto.close.time"}),tooltip:d.formatMessage({id:"agent.settings.auto.close.time.tooltip"}),min:1}),(0,T.jsx)(y.Z,{name:"showLogo",width:"md",label:d.formatMessage({id:"agent.settings.show.logo"}),tooltip:d.formatMessage({id:"agent.settings.show.logo.tooltip"}),fieldProps:{onChange:function(e){console.log("onShowLogoChange = ".concat(e.target.checked))}},disabled:!0})]})}},98473:function(e,t,n){var i=n(76711),o=n.n(i),s=n(90819),r=n.n(s),a=n(73193),l=n.n(a),d=n(89933),u=n.n(d),c=n(45332),g=n.n(c),v=n(86803),f=n(24170),m=n(66916),p=n(72614),h=n(1902),w=n(66310),b=n(95490),x=n(55735),y=n(69169),q=n(48708),S=n(32350),k=n(79907),F=n(30921),U=n(44194),C=n(32327),j=n(71738),M=n(44781),R=n(57178),T=n(78819),Z=n(52288),I=(n(29266),n(3849),n(75365),n(62673)),P=n(38775),A=n(53530),K=(n(59304),n(54881),n(31549)),V=(C.Z.Text,j.Z.Panel,M.Z.Option),L="no_response",W="keyword_match",B="visit_count",_="page_stay",N="time_range",D=[{label:"无响应触发",value:L}];t.Z=function(e){var t=e.type,n=(0,F.useIntl)(),i=y.A.useForm(),s=g()(i,1)[0],a=(0,U.useState)([]),d=g()(a,2),c=d[0],C=d[1],j=(0,U.useState)(!1),E=g()(j,2),O=E[0],X=E[1],z=(0,U.useState)(null),Q=g()(z,2),$=(Q[0],Q[1],R.Z.useForm()),G=g()($,1)[0],H=(0,U.useState)(null),Y=g()(H,2),J=Y[0],ee=(Y[1],(0,w.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}}))),te=ee.currentRobot,ne=ee.setCurrentRobot,ie=(0,h.E)((function(e){return{currentAgent:e.currentAgent,setCurrentAgent:e.setCurrentAgent}})),oe=ie.currentAgent,se=ie.setCurrentAgent,re=(0,b.$)((function(e){return{currentWorkgroup:e.currentWorkgroup,setCurrentWorkgroup:e.setCurrentWorkgroup}})),ae=re.currentWorkgroup,le=re.setCurrentWorkgroup,de=(0,U.useMemo)((function(){return t===x._X4?{chatType:x.xtN,chatSid:te.uid}:t===x.Njn?{chatType:x.scI,chatSid:oe.uid}:t===x.aZD?{chatType:x.vPY,chatSid:ae.uid}:{chatType:x.xtN,chatSid:""}}),[t,te,oe,ae]),ue=de.chatType,ce=de.chatSid;(0,U.useEffect)((function(){if(t===x._X4){var e,n,i,o,r,a,l,d,u,c,g,v=null!=te&&null!==(e=te.serviceSettings)&&void 0!==e&&e.triggerConditions&&(null===(n=JSON.parse(null==te||null===(i=te.serviceSettings)||void 0===i?void 0:i.triggerConditions))||void 0===n?void 0:n.conditions)||[];s.setFieldsValue({autoPopup:null==te||null===(o=te.serviceSettings)||void 0===o?void 0:o.autoPopup,showInvite:null==te||null===(r=te.inviteSettings)||void 0===r?void 0:r.show,inviteText:null==te||null===(a=te.inviteSettings)||void 0===a?void 0:a.text,enableProactiveTrigger:null==te||null===(l=te.serviceSettings)||void 0===l?void 0:l.enableProactiveTrigger,noResponseTimeout:(null==te||null===(d=te.serviceSettings)||void 0===d?void 0:d.noResponseTimeout)||300,proactiveMessage:null==te||null===(u=te.serviceSettings)||void 0===u?void 0:u.proactiveMessage,maxProactiveCount:(null==te||null===(c=te.serviceSettings)||void 0===c?void 0:c.maxProactiveCount)||3,proactiveInterval:(null==te||null===(g=te.serviceSettings)||void 0===g?void 0:g.proactiveInterval)||600}),C(v)}else if(t===x.Njn){var f,m,p,h,w,b,y,q,S,k,F,U=null!=oe&&null!==(f=oe.serviceSettings)&&void 0!==f&&f.triggerConditions&&(null===(m=JSON.parse(null==oe||null===(p=oe.serviceSettings)||void 0===p?void 0:p.triggerConditions))||void 0===m?void 0:m.conditions)||[];s.setFieldsValue({autoPopup:null==oe||null===(h=oe.serviceSettings)||void 0===h?void 0:h.autoPopup,showInvite:null==oe||null===(w=oe.inviteSettings)||void 0===w?void 0:w.show,inviteText:null==oe||null===(b=oe.inviteSettings)||void 0===b?void 0:b.text,enableProactiveTrigger:null==oe||null===(y=oe.serviceSettings)||void 0===y?void 0:y.enableProactiveTrigger,noResponseTimeout:(null==oe||null===(q=oe.serviceSettings)||void 0===q?void 0:q.noResponseTimeout)||300,proactiveMessage:null==oe||null===(S=oe.serviceSettings)||void 0===S?void 0:S.proactiveMessage,maxProactiveCount:(null==oe||null===(k=oe.serviceSettings)||void 0===k?void 0:k.maxProactiveCount)||3,proactiveInterval:(null==oe||null===(F=oe.serviceSettings)||void 0===F?void 0:F.proactiveInterval)||600}),C(U)}else if(t===x.aZD){var j,M,R,T,Z,I,P,A,K,V,L,W=null!=ae&&null!==(j=ae.serviceSettings)&&void 0!==j&&j.triggerConditions&&(null===(M=JSON.parse(null==ae||null===(R=ae.serviceSettings)||void 0===R?void 0:R.triggerConditions))||void 0===M?void 0:M.conditions)||[];s.setFieldsValue({autoPopup:null==ae||null===(T=ae.serviceSettings)||void 0===T?void 0:T.autoPopup,showInvite:null==ae||null===(Z=ae.inviteSettings)||void 0===Z?void 0:Z.show,inviteText:null==ae||null===(I=ae.inviteSettings)||void 0===I?void 0:I.text,enableProactiveTrigger:null==ae||null===(P=ae.serviceSettings)||void 0===P?void 0:P.enableProactiveTrigger,noResponseTimeout:(null==ae||null===(A=ae.serviceSettings)||void 0===A?void 0:A.noResponseTimeout)||300,proactiveMessage:null==ae||null===(K=ae.serviceSettings)||void 0===K?void 0:K.proactiveMessage,maxProactiveCount:(null==ae||null===(V=ae.serviceSettings)||void 0===V?void 0:V.maxProactiveCount)||3,proactiveInterval:(null==ae||null===(L=ae.serviceSettings)||void 0===L?void 0:L.proactiveInterval)||600}),C(W)}}),[te,oe,ae,ue,ce]);var ge=function(){var e=u()(r()().mark((function e(i){var o,s,a,d,u,g,h,w,b,y,q,S,k,F,U,C,j,M,R,T,Z,I,P,A,K,V,L,W,B;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handlePreFormSubmit:",i),o=JSON.stringify({conditions:c}),t!==x._X4){e.next=12;break}return w=l()(l()({},te),{},{serviceSettings:l()(l()({},te.serviceSettings),{},{autoPopup:i.autoPopup,enableProactiveTrigger:i.enableProactiveTrigger,noResponseTimeout:i.noResponseTimeout,proactiveMessage:i.proactiveMessage,maxProactiveCount:i.maxProactiveCount,proactiveInterval:i.proactiveInterval,triggerConditions:o,welcomeFaqUids:null==te||null===(s=te.serviceSettings)||void 0===s||null===(s=s.welcomeFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==te||null===(a=te.serviceSettings)||void 0===a||null===(a=a.faqs)||void 0===a?void 0:a.map((function(e){return e.uid})),quickFaqUids:null==te||null===(d=te.serviceSettings)||void 0===d||null===(d=d.quickFaqs)||void 0===d?void 0:d.map((function(e){return e.uid})),guessFaqUids:null==te||null===(u=te.serviceSettings)||void 0===u||null===(u=u.guessFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),hotFaqUids:null==te||null===(g=te.serviceSettings)||void 0===g||null===(g=g.hotFaqs)||void 0===g?void 0:g.map((function(e){return e.uid})),shortcutFaqUids:null==te||null===(h=te.serviceSettings)||void 0===h||null===(h=h.shortcutFaqs)||void 0===h?void 0:h.map((function(e){return e.uid}))}),inviteSettings:l()(l()({},te.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("robotObject:",w),e.next=7,(0,m.$l)(w);case 7:b=e.sent,console.log("updateRobot response:",b),200===b.code?(v.yw.destroy(),v.yw.success(n.formatMessage({id:"update.success"})),ne(b.data)):(v.yw.destroy(),v.yw.error(b.message)),e.next=30;break;case 12:if(t!==x.Njn){e.next=22;break}return M=l()(l()({},oe),{},{serviceSettings:l()(l()({},null==oe?void 0:oe.serviceSettings),{},{autoPopup:i.autoPopup,enableProactiveTrigger:i.enableProactiveTrigger,noResponseTimeout:i.noResponseTimeout,proactiveMessage:i.proactiveMessage,maxProactiveCount:i.maxProactiveCount,proactiveInterval:i.proactiveInterval,triggerConditions:o,welcomeFaqUids:null==oe||null===(y=oe.serviceSettings)||void 0===y||null===(y=y.welcomeFaqs)||void 0===y?void 0:y.map((function(e){return e.uid})),faqUids:null==oe||null===(q=oe.serviceSettings)||void 0===q||null===(q=q.faqs)||void 0===q?void 0:q.map((function(e){return e.uid})),quickFaqUids:null==oe||null===(S=oe.serviceSettings)||void 0===S||null===(S=S.quickFaqs)||void 0===S?void 0:S.map((function(e){return e.uid})),guessFaqUids:null==oe||null===(k=oe.serviceSettings)||void 0===k||null===(k=k.guessFaqs)||void 0===k?void 0:k.map((function(e){return e.uid})),hotFaqUids:null==oe||null===(F=oe.serviceSettings)||void 0===F||null===(F=F.hotFaqs)||void 0===F?void 0:F.map((function(e){return e.uid})),shortcutFaqUids:null==oe||null===(U=oe.serviceSettings)||void 0===U||null===(U=U.shortcutFaqs)||void 0===U?void 0:U.map((function(e){return e.uid}))}),robotSettings:l()(l()({},oe.robotSettings),{},{robotUid:null==oe||null===(C=oe.robotSettings)||void 0===C||null===(C=C.robot)||void 0===C?void 0:C.uid}),messageLeaveSettings:l()(l()({},oe.messageLeaveSettings),{},{worktimeUids:null==oe||null===(j=oe.messageLeaveSettings)||void 0===j||null===(j=j.worktimes)||void 0===j?void 0:j.map((function(e){return e.uid}))}),autoReplySettings:l()({},oe.autoReplySettings),inviteSettings:l()(l()({},oe.inviteSettings),{},{show:i.showInvite,text:i.inviteText})}),console.log("agentObject:",M),e.next=17,(0,f.sE)(M);case 17:R=e.sent,console.log("updateAgent response:",R),200===R.code?(v.yw.destroy(),v.yw.success(n.formatMessage({id:"update.success"})),se(R.data)):(v.yw.destroy(),v.yw.error(R.message)),e.next=30;break;case 22:if(t!==x.aZD){e.next=30;break}return W=l()(l()({},ae),{},{serviceSettings:l()(l()({},ae.serviceSettings),{},{autoPopup:i.autoPopup,enableProactiveTrigger:i.enableProactiveTrigger,noResponseTimeout:i.noResponseTimeout,proactiveMessage:i.proactiveMessage,maxProactiveCount:i.maxProactiveCount,proactiveInterval:i.proactiveInterval,triggerConditions:o,welcomeFaqUids:null==ae||null===(T=ae.serviceSettings)||void 0===T||null===(T=T.welcomeFaqs)||void 0===T?void 0:T.map((function(e){return e.uid})),faqUids:null==ae||null===(Z=ae.serviceSettings)||void 0===Z||null===(Z=Z.faqs)||void 0===Z?void 0:Z.map((function(e){return e.uid})),quickFaqUids:null===(I=ae.serviceSettings)||void 0===I||null===(I=I.quickFaqs)||void 0===I?void 0:I.map((function(e){return e.uid})),guessFaqUids:null==ae||null===(P=ae.serviceSettings)||void 0===P||null===(P=P.guessFaqs)||void 0===P?void 0:P.map((function(e){return e.uid})),hotFaqUids:null==ae||null===(A=ae.serviceSettings)||void 0===A||null===(A=A.hotFaqs)||void 0===A?void 0:A.map((function(e){return e.uid})),shortcutFaqUids:null==ae||null===(K=ae.serviceSettings)||void 0===K||null===(K=K.shortcutFaqs)||void 0===K?void 0:K.map((function(e){return e.uid}))}),robotSettings:l()(l()({},ae.robotSettings),{},{robotUid:null==ae||null===(V=ae.robotSettings)||void 0===V||null===(V=V.robot)||void 0===V?void 0:V.uid}),messageLeaveSettings:l()(l()({},ae.messageLeaveSettings),{},{worktimeUids:null==ae||null===(L=ae.messageLeaveSettings)||void 0===L||null===(L=L.worktimes)||void 0===L?void 0:L.map((function(e){return e.uid}))}),inviteSettings:l()(l()({},ae.inviteSettings),{},{show:i.showInvite,text:i.inviteText}),agentUids:ae.agents.map((function(e){return e.uid}))}),console.log("workgroupObject:",W),e.next=27,(0,p.W5)(W);case 27:B=e.sent,console.log("updateWorkGroup response:",B),200===B.code?(v.yw.destroy(),v.yw.success(n.formatMessage({id:"update.success"})),le(B.data)):(v.yw.destroy(),v.yw.error(B.message));case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,K.jsxs)("div",{children:[(0,K.jsxs)(y.A,{form:s,onFinish:ge,children:[(0,K.jsxs)(I.Z,{title:"主动触发设置",children:[(0,K.jsx)(q.Z,{width:"md",name:"enableProactiveTrigger",label:"启用主动触发"}),(0,K.jsx)(y.A.Group,{children:(0,K.jsx)(S.Z,{width:"md",name:"proactiveMessage",label:"主动发送的消息内容",placeholder:"例如：您好，看起来您有一段时间没有互动了。请问还需要帮助吗？"})}),(0,K.jsx)(y.A.Group,{children:(0,K.jsx)(k.Z,{width:"xs",name:"noResponseTimeout",label:"无响应超时时间(秒)",min:1,fieldProps:{addonAfter:"秒"}})})]}),(0,K.jsx)(P.Z,{})]}),(0,K.jsx)(A.Z,{title:null!==J?"编辑触发条件":"添加触发条件",open:O,onOk:function(){G.validateFields().then((function(e){var t=e.keywords;t&&"string"==typeof t&&(t=t.split(",").map((function(e){return e.trim()})).filter((function(e){return e})));var n={type:e.type,message:e.message,timeout:e.type===L||e.type===_?e.timeout:void 0,keywords:e.type===W?t:void 0,threshold:e.type===B?e.threshold:void 0,start:e.type===N?e.start:void 0,end:e.type===N?e.end:void 0};if(null!==J){var i=o()(c);i[J]=n,C(i)}else C([].concat(o()(c),[n]));X(!1),G.resetFields()}))},onCancel:function(){return X(!1)},width:600,children:(0,K.jsxs)(R.Z,{form:G,layout:"vertical",initialValues:{type:L,timeout:300,message:"您好，需要帮助吗？"},children:[(0,K.jsx)(R.Z.Item,{name:"type",label:"触发类型",rules:[{required:!0,message:"请选择触发类型"}],children:(0,K.jsx)(M.Z,{children:D.map((function(e){return(0,K.jsx)(V,{value:e.value,children:e.label},e.value)}))})}),function(){switch(G.getFieldValue("type")){case L:return(0,K.jsx)(R.Z.Item,{name:"timeout",label:"无响应超时时间(秒)",rules:[{required:!0,message:"请输入超时时间"}],children:(0,K.jsx)(T.Z,{min:1})});case W:return(0,K.jsx)(R.Z.Item,{name:"keywords",label:"关键词列表(逗号分隔)",rules:[{required:!0,message:"请输入关键词"}],children:(0,K.jsx)(Z.Z,{placeholder:"例如: 价格, 费用, 多少钱"})});case B:return(0,K.jsx)(R.Z.Item,{name:"threshold",label:"访问次数阈值",rules:[{required:!0,message:"请输入访问次数"}],children:(0,K.jsx)(T.Z,{min:1})});case _:return(0,K.jsx)(R.Z.Item,{name:"timeout",label:"页面停留时间(秒)",rules:[{required:!0,message:"请输入停留时间"}],children:(0,K.jsx)(T.Z,{min:1})});case N:return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(R.Z.Item,{name:"start",label:"开始时间",rules:[{required:!0,message:"请输入开始时间"}],children:(0,K.jsx)(Z.Z,{placeholder:"格式: HH:mm, 例如: 09:00"})}),(0,K.jsx)(R.Z.Item,{name:"end",label:"结束时间",rules:[{required:!0,message:"请输入结束时间"}],children:(0,K.jsx)(Z.Z,{placeholder:"格式: HH:mm, 例如: 18:00"})})]});default:return null}}(),(0,K.jsx)(R.Z.Item,{name:"message",label:"触发消息",rules:[{required:!0,message:"请输入触发后发送的消息"}],children:(0,K.jsx)(Z.Z.TextArea,{rows:3,placeholder:"触发条件满足后发送给用户的消息"})})]})})]})}},79677:function(e,t,n){n(44194),n(30921),n(53038),n(79686),n(31549);var i=n(75574);i.Z.Sider,i.Z.Content},69690:function(e,t,n){n.d(t,{Z:function(){return G}});var i=n(44194),o=n(8247),s=n(30921),r=n(31549),a=function(){var e=(0,s.useIntl)();return(0,r.jsxs)("div",{style:{maxWidth:"800px"},children:[(0,r.jsx)("h2",{children:(0,r.jsx)("a",{href:"https://github.com/Bytedesk/bytedesk-web",target:"_blank",rel:"noopener noreferrer",children:e.formatMessage({id:"install.guide.github"})})}),(0,r.jsx)("h2",{children:e.formatMessage({id:"install.guide.steps"})}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:e.formatMessage({id:"install.guide.step1.title"})}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"npm install bytedesk-web\n# ".concat(e.formatMessage({id:"install.guide.step1.or"}),"\nyarn add bytedesk-web")})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:e.formatMessage({id:"install.guide.step2.title"})}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"import { BytedeskReact } from 'bytedesk-web/react';\nimport type { BytedeskConfig } from 'bytedesk-web/react';"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:e.formatMessage({id:"install.guide.step3.title"})}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const config: BytedeskConfig = {\n  placement: 'bottom-right',\n  marginBottom: 20,\n  marginSide: 20,\n  chatConfig: {\n    org: 'df_org_uid',  // ".concat(e.formatMessage({id:"install.guide.step3.org.comment"}),"\n    t: \"2\",\n    sid: 'df_rt_uid'    // ").concat(e.formatMessage({id:"install.guide.step3.sid.comment"}),"\n  }\n};")})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:e.formatMessage({id:"install.guide.step4.title"})}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const App = () => {\n  const handleInit = () => {\n    console.log('BytedeskReact initialized');\n  };\n\n  return (\n    <div>\n      <BytedeskReact {...config} onInit={handleInit} />\n      <button onClick={() => (window as any).bytedesk?.showChat()}>\n        ".concat(e.formatMessage({id:"install.guide.step4.open.chat"}),"\n      </button>\n    </div>\n  );\n};")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:e.formatMessage({id:"install.guide.step5.title"})}),(0,r.jsxs)("ul",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px",lineHeight:"1.6"},children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.showChat()"})," - ",e.formatMessage({id:"install.guide.step5.show"})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.hideChat()"})," - ",e.formatMessage({id:"install.guide.step5.hide"})]})]})]})]})},l=function(e){e.type;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(a,{})})},d=n(53038),u=function(){return(0,r.jsxs)("div",{style:{maxWidth:"800px"},children:[(0,r.jsx)("h2",{children:(0,r.jsx)("a",{href:"https://github.com/Bytedesk/bytedesk-web",target:"_blank",rel:"noopener noreferrer",children:"More Demo on -》Github"})}),(0,r.jsx)("h2",{children:"安装步骤"}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"1. 安装依赖"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"npm install bytedesk-web\n# 或\nyarn add bytedesk-web"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"2. 导入组件"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"import { BytedeskReact } from 'bytedesk-web/svelte';\nimport type { BytedeskConfig } from 'bytedesk-web/svelte';"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"3. 配置参数"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const config: BytedeskConfig = {\n  placement: 'bottom-right',\n  marginBottom: 20,\n  marginSide: 20,\n  chatConfig: {\n    org: 'df_org_uid',  // 替换为您的组织ID\n    t: \"2\",\n    sid: 'df_rt_uid'      // 替换为您的SID\n  }\n};"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"4. 使用组件"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const App = () => {\n  const handleInit = () => {\n    console.log('BytedeskReact initialized');\n  };\n\n  return (\n    <div>\n      <BytedeskReact {...config} onInit={handleInit} />\n      <button onClick={() => (window as any).bytedesk?.showChat()}>\n        打开聊天\n      </button>\n    </div>\n  );\n};"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"5. 可用方法"}),(0,r.jsxs)("ul",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px",lineHeight:"1.6"},children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.showChat()"})," - 显示聊天窗口"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.hideChat()"})," - 隐藏聊天窗口"]})]})]})]})},c=function(e){e.type;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(u,{})})},g=function(){return(0,r.jsxs)("div",{style:{maxWidth:"800px"},children:[(0,r.jsx)("h2",{children:(0,r.jsx)("a",{href:"https://github.com/Bytedesk/bytedesk-web",target:"_blank",rel:"noopener noreferrer",children:"More Demo on -》Github"})}),(0,r.jsx)("h2",{children:"安装步骤"}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"1. 安装依赖"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"npm install bytedesk-web\n# 或\nyarn add bytedesk-web"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"2. 导入组件"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"import { BytedeskReact } from 'bytedesk-web';\nimport type { BytedeskConfig } from 'bytedesk-web';"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"3. 配置参数"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const config: BytedeskConfig = {\n  placement: 'bottom-right',\n  marginBottom: 20,\n  marginSide: 20,\n  chatConfig: {\n    org: 'df_org_uid',  // 替换为您的组织ID\n    t: \"2\",\n    sid: 'df_rt_uid'      // 替换为您的SID\n  }\n};"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"4. 使用组件"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const App = () => {\n  const handleInit = () => {\n    console.log('BytedeskReact initialized');\n  };\n\n  return (\n    <div>\n      <BytedeskReact {...config} onInit={handleInit} />\n      <button onClick={() => (window as any).bytedesk?.showChat()}>\n        打开聊天\n      </button>\n    </div>\n  );\n};"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"5. 可用方法"}),(0,r.jsxs)("ul",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px",lineHeight:"1.6"},children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.showChat()"})," - 显示聊天窗口"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.hideChat()"})," - 隐藏聊天窗口"]})]})]})]})},v=function(e){e.type;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g,{})})},f=function(){return(0,r.jsxs)("div",{style:{maxWidth:"800px"},children:[(0,r.jsx)("h2",{children:(0,r.jsx)("a",{href:"https://github.com/Bytedesk/bytedesk-web",target:"_blank",rel:"noopener noreferrer",children:"More Demo on -》Github"})}),(0,r.jsx)("h2",{children:"安装步骤"}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"1. 安装依赖"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"npm install bytedesk-web\n# 或\nyarn add bytedesk-web"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"2. 导入组件"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"import { BytedeskReact } from 'bytedesk-web/vue';\nimport type { BytedeskConfig } from 'bytedesk-web/vue';"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"3. 配置参数"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const config: BytedeskConfig = {\n  placement: 'bottom-right',\n  marginBottom: 20,\n  marginSide: 20,\n  chatConfig: {\n    org: 'df_org_uid',  // 替换为您的组织ID\n    t: \"2\",\n    sid: 'df_rt_uid'      // 替换为您的SID\n  }\n};"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"4. 使用组件"}),(0,r.jsx)("pre",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px"},children:"const App = () => {\n  const handleInit = () => {\n    console.log('BytedeskReact initialized');\n  };\n\n  return (\n    <div>\n      <BytedeskReact {...config} onInit={handleInit} />\n      <button onClick={() => (window as any).bytedesk?.showChat()}>\n        打开聊天\n      </button>\n    </div>\n  );\n};"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"5. 可用方法"}),(0,r.jsxs)("ul",{style:{background:"#dddddd",padding:"15px",borderRadius:"4px",lineHeight:"1.6"},children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.showChat()"})," - 显示聊天窗口"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"(window as any).bytedesk?.hideChat()"})," - 隐藏聊天窗口"]})]})]})]})},m=function(e){e.type;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(f,{})})},p=n(73193),h=n.n(p),w=n(45332),b=n.n(w),x=n(7358),y=n(71529),q=n(3340),S=n(61107),k=n(1430),F=n(3849),U=n(75365),C=n(53530),j=n(88958),M=n(11184),R=n(69169),T=n(48708),Z=n(84881),I=n(85954),P=n(32350),A=n(62673),K=n(66310),V=n(40612),L=n(1902),W=n(95490),B=n(44521),_=n(55735),N=n(86803),D=n(76711),E=n.n(D),O=n(44435),X=n(83642),z=n(83890),Q=(0,O.Ue)()((0,X.mW)((0,X.tJ)((0,z.n)((function(e,t){return{unifiedResult:{data:{content:[]}},currentUnified:{uid:"",nickname:"",avatar:"",description:"",orgUid:""},insertUnified:function(t){e((function(e){e.unifiedResult.data.content.unshift(t)}))},updateUnified:function(t){e((function(e){var n=e.unifiedResult.data.content,i=n.findIndex((function(e){return e.uid===t.uid}));-1!==i?n[i]=t:console.warn("Unified with uid ".concat(t.uid," not found."))}))},deleteUnified:function(t){e((function(e){var n=e.unifiedResult.data.content,i=n.findIndex((function(e){return e.uid===t.uid}));-1!==i?n.splice(i,1):console.warn("Unified with uid ".concat(t.uid," not found."))}))},setUnifiedResult:function(n){var i;(e({unifiedResult:n}),""===t().currentUnified.uid)&&((null===(i=n.data)||void 0===i||null===(i=i.content)||void 0===i?void 0:i.length)>0&&e({currentUnified:n.data.content[0]}))},setCurrentUnified:function(n){var i=t().unifiedResult.data.content,o=i.findIndex((function(e){return e.uid===n.uid}));if(-1!==o){var s=[].concat(E()(i.slice(0,o)),[n],E()(i.slice(o+1))),r=h()(h()({},t().unifiedResult),{},{data:{content:s}});e({unifiedResult:r,currentUnified:n})}else console.warn("Unified with the specified uid not found."),e({currentUnified:n})},deleteCurrentUnified:function(n){var i=t().unifiedResult.data.content,o=i.findIndex((function(e){return e.uid===n}));-1!==o?e({unifiedResult:h()(h()({},t().unifiedResult),{},{data:{content:[].concat(E()(i.slice(0,o)),E()(i.slice(o+1)))}})}):console.warn("Unified not found in cache:",n),t().currentUnified.uid===n&&e({currentUnified:{uid:"",orgUid:""}})},deleteUnifiedCache:function(){return e({},!0)}}})),{name:_.jlI}))),$=function(e){var t,n,o,a,l,d,u,c,g=e.type,v=R.A.useForm(),f=b()(v,1)[0],m=(0,M.M)(),p=m.config,w=m.updateConfig,D=(0,V.u)((function(e){return e.currentOrg})),E=(0,K.V)((function(e){return e.currentRobot})),O=(0,L.E)((function(e){return e.currentAgent})),X=(0,W.$)((function(e){return e.currentWorkgroup})),z=Q((function(e){return e.currentUnified})),$=(0,i.useState)(!1),G=b()($,2),H=G[0],Y=G[1],J=(0,i.useState)(!1),ee=b()(J,2),te=ee[0],ne=ee[1],ie=(0,i.useState)("zh-cn"),oe=b()(ie,2),se=oe[0],re=oe[1],ae=(0,i.useState)("system"),le=b()(ae,2),de=le[0],ue=le[1],ce=(0,s.useIntl)(),ge=(0,i.useState)(!1),ve=b()(ge,2),fe=ve[0],me=ve[1],pe=(0,i.useState)("full"),he=b()(pe,2),we=he[0],be=he[1],xe=(0,i.useMemo)((function(){return g===_._X4?{chatType:_.xtN,chatSid:E.uid}:g===_.Njn?{chatType:_.scI,chatSid:O.uid}:g===_.aZD?{chatType:_.vPY,chatSid:X.uid}:g===_.RB4?{chatType:_.vIe,chatSid:z.uid}:{chatType:_.xtN,chatSid:""}}),[g,E,O,X]),ye=xe.chatType,qe=xe.chatSid;(0,i.useEffect)((function(){var e,t;null!=D&&D.uid&&ye&&qe&&w({chatConfig:{org:null==D?void 0:D.uid,t:ye,sid:qe},theme:{backgroundColor:null===(e=p.theme)||void 0===e?void 0:e.backgroundColor,textColor:null===(t=p.theme)||void 0===t?void 0:t.textColor}})}),[null==D?void 0:D.uid,ye,qe,null===(t=p.theme)||void 0===t?void 0:t.backgroundColor,null===(n=p.theme)||void 0===n?void 0:n.textColor]);var Se=function(e){var t,n,i=e+"?".concat(_.I3Y,"=").concat(null==D?void 0:D.uid)+"&".concat(_.ZfG,"=").concat(ye)+"&".concat(_.RI9,"=").concat(qe);(H&&(i+="&".concat(_.ErC,"=").concat(se)),te)&&(i+="&".concat(_.N1q,"=").concat(de)+"&".concat(_.spX,"=").concat(null===(t=p.theme)||void 0===t?void 0:t.backgroundColor)+"&".concat(_.cW9,"=").concat(null===(n=p.theme)||void 0===n?void 0:n.textColor));return i+"&"},ke=(0,i.useMemo)((function(){return Se((0,B.Cn)())}),[null==D?void 0:D.uid,E,O,X,H,se,te,de,null===(o=p.theme)||void 0===o?void 0:o.backgroundColor,null===(a=p.theme)||void 0===a?void 0:a.textColor]),Fe=(0,i.useMemo)((function(){return Se((0,B.Z$)())}),[null==D?void 0:D.uid,E,O,X,H,se,te,de,null===(l=p.theme)||void 0===l?void 0:l.backgroundColor,null===(d=p.theme)||void 0===d?void 0:d.textColor]),Ue=function(e){var t,n,i,o,s,r,a,l,d,u;return'\x3c!-- bytedesk.com --\x3e\n<script src="https://www.weiyuai.cn/embed/bytedesk-web.js"><\/script>\n<script>\n  const config = {\n    baseUrl: \''.concat(e.baseUrl||"https://www.weiyuai.cn/chat","',\n    placement: '").concat(e.placement||"bottom-right","',\n    autoPopup: ").concat(e.autoPopup||!1,",\n    locale: '").concat(se,"',\n    inviteConfig: {\n      show: ").concat((null===(t=e.inviteConfig)||void 0===t?void 0:t.show)||!1,",\n      text: '").concat((null===(n=e.inviteConfig)||void 0===n?void 0:n.text)||"需要帮助么","',\n    },\n    bubbleConfig: {\n      show: ").concat(null===(i=null===(o=e.bubbleConfig)||void 0===o?void 0:o.show)||void 0===i||i,",\n      icon: '").concat((null===(s=e.bubbleConfig)||void 0===s?void 0:s.icon)||"👋","',\n      title: '").concat((null===(r=e.bubbleConfig)||void 0===r?void 0:r.title)||"需要帮助么","',\n      subtitle: '").concat((null===(a=e.bubbleConfig)||void 0===a?void 0:a.subtitle)||"点击我，与我对话","'\n    },\n    theme: {\n      mode: '").concat(de,"',\n      backgroundColor: '").concat((null===(l=e.theme)||void 0===l?void 0:l.backgroundColor)||"#0066FF","',\n      textColor: '").concat((null===(d=e.theme)||void 0===d?void 0:d.textColor)||"#ffffff","'\n    },\n    window: {\n      width: '").concat((null===(u=e.window)||void 0===u?void 0:u.width)||380,"'\n    },\n    chatConfig: {\n      org: '").concat(null==D?void 0:D.uid,"',\n      t: '").concat(ye,"',\n      sid: '").concat(qe,"'\n    }\n  };\n  const bytedesk = new BytedeskWeb(config);\n  bytedesk.init();\n<\/script>")};(0,i.useEffect)((function(){var e,t;p&&(f.setFieldValue("codeFullUrl",ke),f.setFieldValue("codeFrameUrl",Fe),f.setFieldValue("buttonColor",null===(e=p.theme)||void 0===e?void 0:e.backgroundColor),f.setFieldValue("showBubble",null===(t=p.bubbleConfig)||void 0===t?void 0:t.show),f.setFieldsValue({rightPlacement:"bottom-right"===p.placement,configText:Ue(p)}))}),[p]);var Ce=function(e){be(e),me(!0)};return(0,r.jsxs)(A.Z,{title:ce.formatMessage({id:"channel.web.config.title"}),children:[(0,r.jsxs)(R.A,{form:f,submitter:!1,onValuesChange:function(e,t){var n=t.rightPlacement?{placement:"bottom-right"}:{placement:"bottom-left"};w(n),f.setFieldsValue({configText:Ue(h()(h()({},p),n))})},children:[(0,r.jsx)(T.Z,{name:"rightPlacement",label:ce.formatMessage({id:"channel.web.position"}),tooltip:ce.formatMessage({id:"channel.web.position.tooltip"}),fieldProps:{checked:"bottom-right"===p.placement}}),(0,r.jsx)(Z.Z,{name:"buttonColor",width:"md",label:ce.formatMessage({id:"channel.web.button.color"}),options:[{label:ce.formatMessage({id:"channel.web.button.color.blue"}),value:"#0066FF"},{label:ce.formatMessage({id:"channel.web.button.color.green"}),value:"#52c41a"},{label:ce.formatMessage({id:"channel.web.button.color.red"}),value:"#ff4d4f"},{label:ce.formatMessage({id:"channel.web.button.color.yellow"}),value:"#faad14"},{label:ce.formatMessage({id:"channel.web.button.color.purple"}),value:"#722ed1"}],fieldProps:{value:null===(u=p.theme)||void 0===u?void 0:u.backgroundColor,onChange:function(e){w({theme:h()(h()({},p.theme),{},{textColor:"#ffffff",backgroundColor:e})}),f.setFieldsValue({configText:Ue(h()(h()({},p),{},{theme:h()(h()({},p.theme),{},{textColor:"#ffffff",backgroundColor:e})}))})}},addonAfter:(0,r.jsx)(k.Z,{value:null===(c=p.theme)||void 0===c?void 0:c.backgroundColor,onChange:function(e){var t=e.toHexString();w({theme:h()(h()({},p.theme),{},{backgroundColor:t})}),f.setFieldsValue({buttonColor:t,configText:Ue(h()(h()({},p),{},{theme:h()(h()({},p.theme),{},{backgroundColor:t})}))})}})}),(0,r.jsx)(I.Z,{name:"showBubble",width:"xl",tooltip:ce.formatMessage({id:"channel.web.show.bubble.tooltip"}),label:ce.formatMessage({id:"channel.web.show.bubble"}),fieldProps:{onChange:function(e){var t=e.target.checked;w({bubbleConfig:h()(h()({},p.bubbleConfig),{},{show:t})}),f.setFieldsValue({configText:Ue(h()(h()({},p),{},{bubbleConfig:h()(h()({},p.bubbleConfig),{},{show:t})}))})}}}),(0,r.jsx)(I.Z,{name:"showLang",width:"xl",tooltip:ce.formatMessage({id:"channel.web.enable.multilang.tooltip"}),label:ce.formatMessage({id:"channel.web.enable.multilang"}),fieldProps:{checked:H,onChange:function(e){var t=e.target.checked;Y(t),t||re("zh-cn")}}}),H&&(0,r.jsx)(Z.Z,{name:"language",width:"md",label:ce.formatMessage({id:"channel.web.select.language"}),options:[{label:ce.formatMessage({id:"channel.web.lang.zh_cn"}),value:"zh-cn"},{label:ce.formatMessage({id:"channel.web.lang.zh_tw"}),value:"zh-tw"},{label:ce.formatMessage({id:"channel.web.lang.en"}),value:"en"}],fieldProps:{onChange:function(e){return re(e)}}}),(0,r.jsx)(I.Z,{name:"showTheme",width:"xl",tooltip:ce.formatMessage({id:"channel.web.enable.theme.tooltip"}),label:ce.formatMessage({id:"channel.web.enable.theme"}),fieldProps:{checked:te,onChange:function(e){var t=e.target.checked;ne(t),t||ue("system")}}}),te&&(0,r.jsx)(Z.Z,{name:"theme",width:"md",label:ce.formatMessage({id:"channel.web.theme.select"}),options:[{label:ce.formatMessage({id:"channel.web.theme.follow.system"}),value:"system"},{label:ce.formatMessage({id:"channel.web.theme.light"}),value:"light"},{label:ce.formatMessage({id:"channel.web.theme.dark"}),value:"dark"}],fieldProps:{value:de,onChange:ue}}),(0,r.jsx)(P.Z,{name:"configText",width:"xl",label:ce.formatMessage({id:"channel.web.code.embed"}),tooltip:ce.formatMessage({id:"channel.web.code.embed.desc"}),fieldProps:{autoSize:{minRows:15,maxRows:25},readOnly:!0}}),(0,r.jsxs)(F.Z,{direction:"horizontal",style:{width:"100%",marginTop:10,marginBottom:10},children:[(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(x.Z,{}),onClick:function(){var e=f.getFieldValue("configText");navigator.clipboard.writeText(e).then((function(){N.yw.success(ce.formatMessage({id:"channel.web.copy.success"}))})).catch((function(){N.yw.error(ce.formatMessage({id:"channel.web.copy.error"}))}))},children:ce.formatMessage({id:"channel.web.copy.code"})}),(0,r.jsx)(U.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:ce.formatMessage({id:"channel.web.show.chat"})}),(0,r.jsx)(U.ZP,{type:"primary",onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.hideChat()},children:ce.formatMessage({id:"channel.web.hide.chat"})})]}),(0,r.jsx)(P.Z,{name:"codeFullUrl",width:"xl",label:ce.formatMessage({id:"channel.web.code.fullscreen"}),tooltip:ce.formatMessage({id:"channel.web.code.fullscreen.desc"}),fieldProps:{autoSize:{minRows:2,maxRows:5},readOnly:!0}}),(0,r.jsxs)(F.Z,{direction:"horizontal",style:{width:"100%",marginBottom:10},children:[(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(x.Z,{}),onClick:function(){navigator.clipboard.writeText(ke).then((function(){N.yw.success(ce.formatMessage({id:"channel.web.fullscreen.copy.success"}))})).catch((function(){N.yw.error(ce.formatMessage({id:"channel.web.copy.error"}))}))},children:ce.formatMessage({id:"channel.web.copy.fullscreen"})}),(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(y.Z,{}),onClick:function(){window.open(ke)},children:ce.formatMessage({id:"channel.web.open.fullscreen"})}),(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(q.Z,{}),onClick:function(){return Ce("full")},children:ce.formatMessage({id:"channel.web.generate.qrcode",defaultMessage:"生成二维码"})})]}),(0,r.jsx)(P.Z,{name:"codeFrameUrl",width:"xl",label:ce.formatMessage({id:"channel.web.code.frame"}),tooltip:ce.formatMessage({id:"channel.web.code.frame.desc"}),fieldProps:{autoSize:{minRows:2,maxRows:5},readOnly:!0}}),(0,r.jsxs)(F.Z,{direction:"horizontal",style:{width:"100%"},children:[(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(x.Z,{}),onClick:function(){var e=f.getFieldValue("codeFrameUrl");navigator.clipboard.writeText(e).then((function(){N.yw.success(ce.formatMessage({id:"channel.web.frame.copy.success"}))})).catch((function(){N.yw.error(ce.formatMessage({id:"channel.web.copy.error"}))}))},children:ce.formatMessage({id:"channel.web.copy.frame"})}),(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(y.Z,{}),onClick:function(){window.open(Fe)},children:ce.formatMessage({id:"channel.web.open.frame"})}),(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(q.Z,{}),onClick:function(){return Ce("frame")},children:ce.formatMessage({id:"channel.web.generate.qrcode",defaultMessage:"生成二维码"})})]})]}),(0,r.jsx)(C.Z,{title:ce.formatMessage({id:"channel.web.qrcode.title",defaultMessage:"客服二维码"}),open:fe,onCancel:function(){return me(!1)},footer:[(0,r.jsx)(U.ZP,{onClick:function(){return me(!1)},children:ce.formatMessage({id:"common.close",defaultMessage:"关闭"})},"close"),(0,r.jsx)(U.ZP,{type:"primary",icon:(0,r.jsx)(S.Z,{}),onClick:function(){var e,t=null===(e=document.getElementById("bytedesk-qrcode-canvas"))||void 0===e?void 0:e.querySelector("canvas");if(t){var n=t.toDataURL(),i=document.createElement("a");i.download="bytedesk-".concat(we,"-qrcode.png"),i.href=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),N.yw.success(ce.formatMessage({id:"channel.web.qrcode.download.success"}))}},children:ce.formatMessage({id:"channel.web.qrcode.download",defaultMessage:"下载二维码"})},"download")],width:400,centered:!0,children:(0,r.jsxs)("div",{style:{textAlign:"center",padding:"20px 0"},id:"bytedesk-qrcode-canvas",children:[(0,r.jsx)(j.Z,{value:"full"===we?ke:Fe,size:280,style:{margin:"0 auto"},errorLevel:"H"}),(0,r.jsx)("div",{style:{marginTop:10},children:ce.formatMessage({id:"channel.web.qrcode.scan",defaultMessage:"扫描二维码咨询客服"})})]})})]})},G=function(e){var t=e.type,n=[{key:"web",label:"Web",children:(0,r.jsx)($,{type:t})},{key:"react",label:"React",children:(0,r.jsx)(l,{type:t})},{key:"vue",label:"Vue",children:(0,r.jsx)(m,{type:t})},{key:"svelte",label:"Svelte",children:(0,r.jsx)(c,{type:t})},{key:"vanilla",label:"Vanilla",children:(0,r.jsx)(v,{type:t})}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{type:t}),(0,r.jsx)(o.Z,{tabPosition:"left",items:n})]})}},75157:function(e,t,n){n(44194),n(30921),n(53038),n(79686),n(31549)},23832:function(e,t,n){n(44194);var i=n(30921),o=(n(79686),n(31549));n(53038),n(90819),n(73193),n(84176),n(89933),n(45332),n(40612),n(69842),n(55735),i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,n(72614),n(76750),n(95490);i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage,i.FormattedMessage},53038:function(e,t,n){var i=n(30921),o=n(31549);t.Z=function(e){e.type,(0,i.useIntl)();return(0,o.jsx)(o.Fragment,{})}},79686:function(e,t,n){n(55735),n(30921),n(31549)},6631:function(e,t,n){n.d(t,{G:function(){return g}});var i=n(73193),o=n.n(i),s=(n(44194),n(30348)),r=n(55735),a=n(28977),l=n.n(a),d=n(86803),u=n(44521),c=n(31549),g=function(e){var t=e.children,n=e.onSuccess,i=e.onError,a={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:r.IrL,categoryUid:"",kbUid:"",client:r.bVn},g={name:"file",accept:"image/*",action:(0,u.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(r.LA8)},data:a,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var t=l()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return a.file=e,a.fileName=t,a.fileType=e.type,console.log("beforeUpload",a),!0},onChange:function(e){if("uploading"!==e.file.status&&console.log("not uploading:",e.file),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data.fileUrl;n(t),d.yw.success("".concat(e.file.name," 上传成功"))}else i(e.file),d.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(d.yw.error("".concat(e.file.name," 上传失败")),i(e.file))}};return(0,c.jsx)(s.Z,o()(o()({},g),{},{children:t}))}},66310:function(e,t,n){n.d(t,{V:function(){return c}});var i=n(73193),o=n.n(i),s=n(76711),r=n.n(s),a=n(55735),l=n(44435),d=n(83642),u=n(83890),c=(0,l.Ue)()((0,d.mW)((0,d.tJ)((0,u.n)((function(e,t){return{robotResult:{data:{content:[]}},currentRobot:{uid:"",nickname:""},insertRobot:function(t){e((function(e){e.robotResult.data.content.unshift(t)}))},setRobotResult:function(n){e({robotResult:n});var i,o=t().currentRobot;""!==o.uid&&void 0!==o||(null===(i=n.data)||void 0===i||null===(i=i.content)||void 0===i?void 0:i.length)>0&&e({currentRobot:n.data.content[0]})},setCurrentRobot:function(n){var i=t().robotResult.data.content,s=i.findIndex((function(e){return e.uid===n.uid}));if(-1!==s){var a=[].concat(r()(i.slice(0,s)),[n],r()(i.slice(s+1))),l=o()(o()({},t().robotResult),{},{data:{content:a}});e({robotResult:l,currentRobot:n})}else console.warn("Robot with the specified uid not found."),e({currentRobot:n})},deleteCurrentRobot:function(n){var i=t().robotResult.data.content,s=i.findIndex((function(e){return e.uid===n}));-1!==s?e({robotResult:o()(o()({},t().robotResult),{},{data:{content:[].concat(r()(i.slice(0,s)),r()(i.slice(s+1)))}})}):console.warn("Robot not found in cache:",n),t().currentRobot.uid===n&&e({currentRobot:{uid:""}})},deleteRobotCache:function(){return e({},!0)}}})),{name:a.Eis})))}}]);