"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[3959],{55785:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(83910),s=r(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},i=r(54183),o=function(e,t){return s.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:a}))};var u=s.forwardRef(o)},50628:function(e,t,r){var n=r(94433),s=r(38956),a=r(44194),i=r(9953),o=r(31549),u=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],c=a.forwardRef((function(e,t){var r=e.fieldProps,a=e.unCheckedChildren,c=e.checkedChildren,l=e.proFieldProps,d=(0,s.Z)(e,u);return(0,o.jsx)(i.Z,(0,n.Z)({valueType:"switch",fieldProps:(0,n.Z)({unCheckedChildren:a,checkedChildren:c},r),ref:t,valuePropName:"checked",proFieldProps:l,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},d))}));t.Z=c},79658:function(e,t,r){r.d(t,{LE:function(){return l},W5:function(){return m},p0:function(){return p},zl:function(){return h}});var n=r(90819),s=r.n(n),a=r(73193),i=r.n(a),o=r(89933),u=r.n(o),c=r(4628);function l(e){return d.apply(this,arguments)}function d(){return(d=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/query/org",{method:"GET",params:i()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/create",{method:"POST",data:i()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/update",{method:"POST",data:i()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return k.apply(this,arguments)}function k(){return(k=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/workgroup/delete",{method:"POST",data:i()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},40132:function(e,t,r){r.r(t),r.d(t,{default:function(){return L}});var n=r(4628),s=r(21600),a=r(21850),i=r(90819),o=r.n(i),u=r(89933),c=r.n(u),l=r(45332),d=r.n(l),p=r(44194),f=r(93953),m=r(68177),g=r(30310),h=r(69533),k=r(5957),v=r(10390),b=r(90581),x=r(80556),w=r(55785),M=r(99036),y=r(50628),C=r(59005),j=r(3395),Z=r(79658),K=r(67242),P=r(43388),S=r(31549),U="df_org_uid",E=function(e){var t=e.superUser,r=void 0===t||t,s=M.A.useForm(),i=d()(s,1)[0],u=(0,p.useState)(!1),l=d()(u,2),E=l[0],R=l[1],F=(0,p.useState)(!1),A=d()(F,2),I=A[0],L=A[1],V=(0,p.useState)([]),q=d()(V,2),z=q[0],T=q[1],B=(0,p.useState)(!1),H=d()(B,2),O=H[0],W=H[1],N=((0,a.Z)().contentStyle,(0,n.useIntl)()),_=(0,p.useMemo)((function(){return z.map((function(e){return{label:e.nickname||e.uid,value:e.uid,status:e.status,connectedAgentCount:e.connectedAgentCount}}))}),[z]),G=function(){var e=c()(o()().mark((function e(){var t,r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(!0),e.prev=1,e.next=4,(0,j.sc)();case 4:t=e.sent,K.Z.debug("工单中心配置:",null==t?void 0:t.data),200===(null==t?void 0:t.code)&&null!=t&&t.data&&i.setFieldsValue({workgroupUid:null==t?void 0:t.data.workgroupUid,ticketCenterEnabled:null===(r=null==t?void 0:t.data.ticketCenterEnabled)||void 0===r||r,description:null==t?void 0:t.data.description}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("加载工单中心配置失败:",e.t0),P.yw.error(N.formatMessage({id:"super.ticket.message.loadSettingsFailed"}));case 13:return e.prev=13,R(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,9,13,16]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=c()(o()().mark((function e(){var t,n,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W(!0),e.prev=1,n={orgUid:U,pageNumber:0,pageSize:100,superUser:r},e.next=5,(0,Z.LE)(n);case 5:s=e.sent,K.Z.debug("工作组列表:",null==s?void 0:s.data,n),200===(null==s?void 0:s.code)&&null!=s&&null!==(t=s.data)&&void 0!==t&&t.content&&T(null==s?void 0:s.data.content),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("加载工作组列表失败:",e.t0),P.yw.error(N.formatMessage({id:"super.ticket.message.loadWorkgroupsFailed"}));case 14:return e.prev=14,W(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})));return function(){return e.apply(this,arguments)}}();(0,p.useEffect)((function(){G(),J()}),[]);var Q=function(){var e=c()(o()().mark((function e(){var t,r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.validateFields();case 3:return t=e.sent,L(!0),e.next=7,(0,j.k2)({workgroupUid:t.workgroupUid,ticketCenterEnabled:t.ticketCenterEnabled,description:t.description});case 7:200===(null==(r=e.sent)?void 0:r.code)?(P.yw.success(N.formatMessage({id:"super.ticket.message.saveSuccess"})),G()):P.yw.error((null==r?void 0:r.message)||N.formatMessage({id:"super.ticket.message.saveFailed"})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("保存工单中心配置失败:",e.t0),P.yw.error(N.formatMessage({id:"super.ticket.message.saveFailed"}));case 15:return e.prev=15,L(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})));return function(){return e.apply(this,arguments)}}();return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(f.Z,{spinning:E,children:(0,S.jsxs)(m.Z,{title:N.formatMessage({id:"super.ticket.title"}),extra:(0,S.jsxs)(g.Z,{children:[(0,S.jsx)(h.ZP,{icon:(0,S.jsx)(x.Z,{}),onClick:function(){G(),J()},children:N.formatMessage({id:"super.common.refresh"})}),(0,S.jsx)(h.ZP,{type:"primary",icon:(0,S.jsx)(w.Z,{}),loading:I,onClick:Q,children:N.formatMessage({id:"super.common.save"})})]}),children:[(0,S.jsx)(k.Z,{message:N.formatMessage({id:"super.common.alert.title"}),description:(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{children:N.formatMessage({id:"super.ticket.alert.desc"})}),(0,S.jsxs)("ul",{style:{marginBottom:0},children:[(0,S.jsx)("li",{children:N.formatMessage({id:"super.ticket.alert.item.assign"})}),(0,S.jsx)("li",{children:N.formatMessage({id:"super.ticket.alert.item.workgroupSource"},{orgUid:U})}),(0,S.jsx)("li",{children:N.formatMessage({id:"super.ticket.alert.item.otherSettings"})})]})]}),type:"info",showIcon:!0,style:{marginBottom:24}}),(0,S.jsxs)(M.A,{form:i,layout:"vertical",submitter:!1,initialValues:{ticketCenterEnabled:!0},children:[(0,S.jsx)(y.Z,{name:"ticketCenterEnabled",label:N.formatMessage({id:"super.common.enableConfig"}),extra:N.formatMessage({id:"super.ticket.form.ticketCenterEnabled.extra",defaultMessage:"启用则开启平台工单中心，否则关闭平台工单中心"}),fieldProps:{checkedChildren:N.formatMessage({id:"super.common.enabled"}),unCheckedChildren:N.formatMessage({id:"super.common.disabled"})}}),(0,S.jsx)(v.Z,{orientation:"left",children:N.formatMessage({id:"super.ticket.divider.workgroup"})}),(0,S.jsx)(C.Z,{name:"workgroupUid",label:N.formatMessage({id:"super.ticket.form.workgroup.label"}),rules:[{required:!0,message:N.formatMessage({id:"super.ticket.form.workgroup.required"})}],tooltip:N.formatMessage({id:"super.ticket.form.workgroup.tooltip"}),extra:(0,S.jsxs)(g.Z,{style:{marginTop:8},children:[(0,S.jsx)("span",{children:N.formatMessage({id:"super.ticket.workgroup.count"},{count:z.length})}),(0,S.jsx)(h.ZP,{type:"link",size:"small",onClick:J,loading:O,children:N.formatMessage({id:"super.common.refreshList"})})]}),placeholder:N.formatMessage({id:"super.ticket.form.workgroup.placeholder"}),options:_,fieldProps:{loading:O,showSearch:!0,optionFilterProp:"label",filterOption:function(e,t){var r;return String(null!==(r=null==t?void 0:t.label)&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())},optionItemRender:function(e){return(0,S.jsxs)(g.Z,{children:[(0,S.jsx)("span",{children:e.label}),"AVAILABLE"===e.status&&(0,S.jsx)(b.Z,{color:"green",children:N.formatMessage({id:"super.ticket.workgroup.online"})}),"number"==typeof e.connectedAgentCount&&(0,S.jsx)(b.Z,{color:"blue",children:N.formatMessage({id:"super.ticket.workgroup.agentCount"},{count:e.connectedAgentCount})})]})}}})]})]})})})},R=r(66640),F=r(56724),A=r(61436),I=r(94976),L=function(){var e=(0,n.useIntl)(),t=(0,a.Z)().contentStyle,r=[{key:"settings",label:e.formatMessage({id:"super.ticket.title",defaultMessage:"平台工单中心配置"}),children:(0,S.jsx)(E,{superUser:!0})},{key:"tickets",label:e.formatMessage({id:"ticket.list",defaultMessage:"工单列表"}),children:(0,S.jsx)(R.Z,{ticketType:I.IpQ,superUser:!0})},{key:"process",label:e.formatMessage({id:"process.list",defaultMessage:"流程列表"}),children:(0,S.jsx)(F.Z,{superUser:!0})},{key:"form",label:e.formatMessage({id:"pages.form.title",defaultMessage:"表单管理"}),children:(0,S.jsx)(A.Z,{level:I.Hxq,superUser:!0})}];return(0,S.jsx)("div",{style:t,children:(0,S.jsx)(s.Z,{defaultActiveKey:"settings",items:r})})}},8732:function(e,t,r){r.d(t,{j:function(){return d}});var n=r(73193),s=r.n(n),a=r(76711),i=r.n(a),o=r(94976),u=r(26557),c=r(26407),l=r(20744),d=(0,u.Ue)()((0,c.mW)((0,c.tJ)((0,l.n)((function(e,t){return{currentKbase:{uid:"",orgUid:""},kbaseResult:{data:{content:[]}},insertKbase:function(t){e((function(e){e.kbaseResult.data.content.unshift(t)}))},updateKbase:function(t){e((function(e){var r=e.kbaseResult.data.content,n=r.findIndex((function(e){return e.uid===t.uid}));-1!==n?r[n]=t:console.warn("Kbase with uid ".concat(t.uid," not found."))}))},setKbaseResult:function(t){var r;e({kbaseResult:t}),(null===(r=t.data)||void 0===r||null===(r=r.content)||void 0===r?void 0:r.length)>0&&e({currentKbase:t.data.content[0]})},setCurrentKbase:function(r){var n=t().kbaseResult.data.content,a=n.findIndex((function(e){return e.uid===r.uid}));if(-1!==a){var o=[].concat(i()(n.slice(0,a)),[r],i()(n.slice(a+1))),u=s()(s()({},t().kbaseResult),{},{data:{content:o}});e({kbaseResult:u,currentKbase:r})}else console.warn("Kbase with the specified uid not found."),e({currentKbase:r})},removeKbase:function(r){var n=t().kbaseResult.data.content,a=n.findIndex((function(e){return e.uid===r}));-1!==a?e({kbaseResult:s()(s()({},t().kbaseResult),{},{data:{content:[].concat(i()(n.slice(0,a)),i()(n.slice(a+1)))}})}):console.warn("Kbase not found in cache:",r),t().currentKbase.uid===r&&e({currentKbase:{uid:"",orgUid:""}})},deleteKbaseCache:function(){return e({},!0)}}})),{name:o.wKE})))}}]);