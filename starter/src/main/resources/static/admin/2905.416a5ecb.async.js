"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[2905],{31806:function(e,i,a){a.d(i,{Z:function(){return o}});var t=a(83910),s=a(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},l=a(54183),u=function(e,i){return s.createElement(l.Z,(0,t.Z)({},e,{ref:i,icon:n}))};var o=s.forwardRef(u)},58087:function(e,i,a){var t=a(83910),s=a(44194),n=a(15323),l=a(54183),u=function(e,i){return s.createElement(l.Z,(0,t.Z)({},e,{ref:i,icon:n.Z}))},o=s.forwardRef(u);i.Z=o},58791:function(e,i,a){var t=a(83910),s=a(44194),n=a(85333),l=a(54183),u=function(e,i){return s.createElement(l.Z,(0,t.Z)({},e,{ref:i,icon:n.Z}))},o=s.forwardRef(u);i.Z=o},84895:function(e,i,a){var t=a(90819),s=a.n(t),n=a(89933),l=a.n(n),u=a(45332),o=a.n(u),r=a(66441),d=a(88722),m=a(78112),g=a(66406),v=a(99036),f=(a(59005),a(86702),a(69705)),c=a(4628),p=a(44194),h=a(60224),M=a(74171),x=(a(94976),a(31549));i.Z=function(e){var i,a,t=e.messageLeaveSettings,n=e.onMessageLeaveSettingsChange,u=(0,c.useIntl)(),w=(0,d.Z)().translateString,y=v.A.useForm(),T=o()(y,1)[0],b=(null===(i=f.Z.useWatch)||void 0===i||i.call(f.Z,"messageLeaveNotify",T),null===(a=f.Z.useWatch)||void 0===a?void 0:a.call(f.Z,"messageLeaveNotifyType",T)),L=(0,M.u)((function(e){return e.currentOrg})),q=(0,p.useMemo)((function(){return null!=t?t:{}}),[t]),Z=(0,p.useMemo)((function(){var e,i;return null!==(e=null!==(i=null==q?void 0:q.draft)&&void 0!==i?i:null==q?void 0:q.live)&&void 0!==e?e:void 0}),[q]),j=((0,p.useMemo)((function(){return[{label:u.formatMessage({id:"leavemsg.notify.email",defaultMessage:"Email"}),value:"EMAIL"},{label:u.formatMessage({id:"leavemsg.notify.sms",defaultMessage:"SMS"}),value:"SMS"},{label:u.formatMessage({id:"leavemsg.notify.email_sms",defaultMessage:"Email + SMS"}),value:"EMAIL_SMS"}]}),[u]),(0,p.useRef)("")),k=(0,p.useState)(""),W=o()(k,2),E=W[0],P=W[1],S=(0,p.useCallback)((function(e){e&&0!==Object.keys(e).length&&(null==n||n(e))}),[n]);(0,p.useEffect)((function(){var e,i,a;T.setFieldsValue({messageLeaveEnabled:null===(e=null==Z?void 0:Z.messageLeaveEnabled)||void 0===e||e,messageLeaveAgentUid:null==Z?void 0:Z.messageLeaveAgentUid,messageLeaveNotify:null!==(i=null==Z?void 0:Z.messageLeaveNotify)&&void 0!==i&&i,messageLeaveNotifyType:null!==(a=null==Z?void 0:Z.messageLeaveNotifyType)&&void 0!==a?a:"EMAIL",messageLeaveNotifyEmail:null==Z?void 0:Z.messageLeaveNotifyEmail,messageLeaveNotifyMobile:null==Z?void 0:Z.messageLeaveNotifyMobile,messageLeaveForm:null==Z?void 0:Z.messageLeaveForm});var t=w(null==Z?void 0:Z.messageLeaveTip)||"";j.current!==t&&(j.current=t,P(t),T.setFieldValue("messageLeaveTip",t))}),[Z,T,w]);var C=(0,p.useCallback)((function(e){S(e)}),[S]),F=(0,p.useCallback)((function(e){j.current=e,P(e),T.setFieldValue("messageLeaveTip",e),S({messageLeaveTip:e})}),[S,T]),V=((0,p.useCallback)(function(){var e=l()(s()().mark((function e(i){var a,t,n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=L&&L.uid){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,(0,h._t)({pageNumber:0,pageSize:100,orgUid:L.uid,searchText:null!=i?i:""});case 5:if(200!==(null==(a=e.sent)?void 0:a.code)){e.next=8;break}return e.abrupt("return",(null!==(t=null==a||null===(n=a.data)||void 0===n?void 0:n.content)&&void 0!==t?t:[]).map((function(e){return{label:(null==e?void 0:e.nickname)||(null==e?void 0:e.uid),value:null==e?void 0:e.uid}})).filter((function(e){return Boolean(e.value)})));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(i){return e.apply(this,arguments)}}(),[null==L?void 0:L.uid]),!1);null!=b||null==Z||Z.messageLeaveNotifyType;return(0,x.jsxs)(v.A,{form:T,submitter:!1,style:{marginLeft:"20px"},onValuesChange:function(e){return C(e)},children:[!1,(0,x.jsx)(v.A.Item,{name:"messageLeaveTip",label:(0,x.jsxs)("span",{children:[u.formatMessage({id:"agent.settings.leave.msg"}),(0,x.jsx)(r.Z,{type:"messageLeave",keys:["messageLeaveTip"],live:null==q?void 0:q.live,draft:null==q?void 0:q.draft})]}),rules:[{required:!0,message:u.formatMessage({id:"agent.settings.leave.msg.required"})}],children:(0,x.jsx)(g.Z,{placeholder:u.formatMessage({id:"agent.settings.leave.msg.placeholder"}),value:E,toolbarKeys:(0,m.eD)(),style:{height:"150px",width:"600px"},maxLength:200,onChange:F},"messageLeaveTipEditor")}),!1,V,V,false,false]})}},64587:function(e,i,a){var t=a(45332),s=a.n(t),n=a(66441),l=a(99036),u=a(48058),o=a(60241),r=a(4628),d=a(44194),m=a(31549);i.Z=function(e){e.variant;var i,a,t=e.queueSettings,g=e.onQueueSettingsChange,v=(0,r.useIntl)(),f=l.A.useForm(),c=s()(f,1)[0],p=(0,d.useRef)(!1),h=l.A.useWatch("showEstimatedWaitTime",c),M=(0,d.useMemo)((function(){return{position:"{position}",waitTime:"{waitTime}"}}),[]),x=(0,d.useMemo)((function(){return null!=t?t:{}}),[t]),w=(0,d.useMemo)((function(){var e,i;return null!==(e=null!==(i=null==x?void 0:x.draft)&&void 0!==i?i:null==x?void 0:x.live)&&void 0!==e?e:void 0}),[null==x?void 0:x.draft,null==x?void 0:x.live]),y=(0,d.useCallback)((function(e){e&&0!==Object.keys(e).length&&(null==g||g(e))}),[g]),T=(0,d.useCallback)((function(e,i){var a=!1!==i,t=[];return!1!==e&&t.push(v.formatMessage({id:"queue.settings.tip.fragment.position",defaultMessage:"您前面还有 {position} 人排队"},M)),a&&t.push(v.formatMessage({id:"queue.settings.tip.fragment.wait",defaultMessage:"预计等待 {waitTime}"},M)),t.push(v.formatMessage({id:"queue.settings.tip.fragment.suffix",defaultMessage:"请耐心等候。"})),t.filter(Boolean).join("，")}),[v,M]),b=(0,d.useCallback)((function(e){var i=e&&"showQueuePosition"in e?e.showQueuePosition:c.getFieldValue("showQueuePosition"),a=e&&"showEstimatedWaitTime"in e?e.showEstimatedWaitTime:c.getFieldValue("showEstimatedWaitTime"),t=T(i,a);c.getFieldValue("queueTip")!==t&&(p.current=!0,c.setFieldsValue({queueTip:t}),p.current=!1,y({queueTip:t}))}),[T,y,c]);(0,d.useEffect)((function(){var e,i,a,t,s,n,l,u;p.current=!0,c.setFieldsValue({queueRobot:null!==(e=null==w?void 0:w.queueRobot)&&void 0!==e&&e,showQueuePosition:null===(i=null==w?void 0:w.showQueuePosition)||void 0===i||i,showEstimatedWaitTime:null===(a=null==w?void 0:w.showEstimatedWaitTime)||void 0===a||a,avgWaitTimePerPerson:null!==(t=null==w?void 0:w.avgWaitTimePerPerson)&&void 0!==t?t:60,maxWaiting:null!==(s=null==w?void 0:w.maxWaiting)&&void 0!==s?s:1e4,maxWaitTime:null!==(n=null==w?void 0:w.maxWaitTime)&&void 0!==n?n:86400,queueTip:null!==(l=null==w?void 0:w.queueTip)&&void 0!==l?l:"",queueReadyTip:null!==(u=null==w?void 0:w.queueReadyTip)&&void 0!==u?u:""}),p.current=!1}),[w,c]);var L=(0,d.useCallback)((function(e){p.current||(y(e),("showQueuePosition"in e||"showEstimatedWaitTime"in e)&&b(e))}),[y,b]);i=null!=h?h:null==w?void 0:w.showEstimatedWaitTime;return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(l.A,{layout:"vertical",form:c,submitter:!1,style:{marginLeft:"20px"},onValuesChange:L,children:[(0,m.jsx)(u.Z,{width:"md",name:"maxWaiting",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.max.waiting",defaultMessage:"最大等待人数"}),(0,m.jsx)(n.Z,{type:"generic",keys:["maxWaiting"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),min:1,max:1e5,fieldProps:{precision:0},tooltip:v.formatMessage({id:"queue.settings.max.waiting.tooltip",defaultMessage:"设置允许同时排队等待的最大访客数量，超过则进入留言流程"})}),(0,m.jsx)(u.Z,{width:"md",name:"maxWaitTime",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.max.wait.time",defaultMessage:"最大等待时间(秒)"}),(0,m.jsx)(n.Z,{type:"generic",keys:["maxWaitTime"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),min:1,max:604800,fieldProps:{precision:0},tooltip:v.formatMessage({id:"queue.settings.max.wait.time.tooltip",defaultMessage:"设置访客最长排队等待时间（秒），超时后将进入留言流程"}),extra:v.formatMessage({id:"queue.settings.max.wait.time.extra",defaultMessage:"当前设置：约 {hours} 小时"},{hours:Math.round((null!==(a=null==w?void 0:w.maxWaitTime)&&void 0!==a?a:86400)/3600)})}),(0,m.jsx)(u.Z,{width:"md",name:"avgWaitTimePerPerson",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.avg.wait.time.per.person",defaultMessage:"每人平均等待时长(秒)"}),(0,m.jsx)(n.Z,{type:"generic",keys:["avgWaitTimePerPerson"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),min:1,max:600,fieldProps:{precision:0},tooltip:v.formatMessage({id:"queue.settings.avg.wait.time.per.person.tooltip",defaultMessage:"用于计算预计等待时间，预计等待时间 = 前面排队人数 × 每人平均等待时长"}),extra:v.formatMessage({id:"queue.settings.avg.wait.time.per.person.extra",defaultMessage:"默认值：60 秒（1 分钟）"})}),(0,m.jsx)(o.Z,{width:"lg",name:"queueTip",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.tip",defaultMessage:"排队提示语模板"}),(0,m.jsx)(n.Z,{type:"generic",keys:["queueTip"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),fieldProps:{rows:3,maxLength:500},placeholder:v.formatMessage({id:"queue.settings.tip.placeholder",defaultMessage:"您前面还有 {position} 人排队，预计等待 {waitTime}，请耐心等候。"},{position:M.position,waitTime:M.waitTime}),tooltip:v.formatMessage({id:"queue.settings.tip.tooltip",defaultMessage:"访客排队时显示的提示信息，支持模板变量自动替换"}),extra:(0,m.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:v.formatMessage({id:"queue.settings.tip.variables",defaultMessage:"支持的模板变量：\n• '{'position'}' - 当前排队位置（前面的排队人数）\n• '{'queueSize'}' - 当前队列总人数\n• '{'waitSeconds'}' - 预计等待秒数\n• '{'waitMinutes'}' - 预计等待分钟数\n• '{'waitTime'}' - 格式化的等待时间（如\"约5分钟\"）"})})}),(0,m.jsx)(o.Z,{width:"lg",name:"queueReadyTip",label:(0,m.jsxs)("span",{children:[v.formatMessage({id:"queue.settings.ready.tip",defaultMessage:"即将接入提示语"}),(0,m.jsx)(n.Z,{type:"generic",keys:["queueReadyTip"],live:null==x?void 0:x.live,draft:null==x?void 0:x.draft})]}),fieldProps:{rows:2,maxLength:200},placeholder:v.formatMessage({id:"queue.settings.ready.tip.placeholder",defaultMessage:"客服即将为您服务，请稍候..."}),tooltip:v.formatMessage({id:"queue.settings.ready.tip.tooltip",defaultMessage:"当访客排队位置为0（即前面没有人排队，下一个就是该访客）时显示的提示信息"}),extra:v.formatMessage({id:"queue.settings.ready.tip.extra",defaultMessage:"此提示语用于替代排队位置为0时的默认提示，提升用户体验"})})]})})}},92822:function(e,i,a){a(73193),a(84176),a(45332),a(4628),a(44194),a(31549)}}]);