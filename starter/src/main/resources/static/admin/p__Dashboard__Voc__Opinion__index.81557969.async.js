"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9522],{83381:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(38404),o=r(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},i=r(5901),l=function(e,t){return o.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:a}))};var u=o.forwardRef(l)},80503:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(38404),o=r(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},i=r(5901),l=function(e,t){return o.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:a}))};var u=o.forwardRef(l)},17455:function(e,t,r){var n=r(80627),o=r(93683),a=r(68422),i=r(44194),l=r(84729),u=r(69983),s=r(31549),c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var r=e.fieldProps,d=e.children,p=e.params,f=e.proFieldProps,v=e.mode,h=e.valueEnum,m=e.request,x=e.showSearch,g=e.options,P=(0,o.Z)(e,c),y=(0,i.useContext)(l.Z);return(0,s.jsx)(u.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,a.h)(h),request:m,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:g,mode:v,showSearch:x,getPopupContainer:y.getPopupContainer},r),ref:t,proFieldProps:f},P),{},{children:d}))},f=i.forwardRef((function(e,t){var r=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,v=e.mode,h=e.valueEnum,m=e.request,x=e.options,g=(0,o.Z)(e,d),P=(0,n.Z)({options:x,mode:v||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),y=(0,i.useContext)(l.Z);return(0,s.jsx)(u.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,a.h)(h),request:m,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:y.getPopupContainer},P),ref:t,proFieldProps:f},g),{},{children:c}))})),v=i.forwardRef(p);v.SearchSelect=f,v.displayName="ProFormComponent",t.Z=v},67186:function(e,t,r){var n=r(29552),o=r(80627),a=r(93683),i=r(92032),l=r(69159),u=r(43928),s=r(21762),c=r(44194),d=r(69983),p=r(31549),f=["fieldProps","proFieldProps"],v=["fieldProps","proFieldProps"],h="text",m=function(e){var t=(0,i.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,n.Z)(t,2),a=r[0],s=r[1];return(0,p.jsx)(l.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var r,n=t.getFieldValue(e.name||[]);return(0,p.jsx)(u.Z,(0,o.Z)((0,o.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return s(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,n),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:a,children:e.children}))}})},x=function(e){var t=e.fieldProps,r=e.proFieldProps,n=(0,a.Z)(e,f);return(0,p.jsx)(d.Z,(0,o.Z)({valueType:h,fieldProps:t,filedConfig:{valueType:h},proFieldProps:r},n))};x.Password=function(e){var t=e.fieldProps,r=e.proFieldProps,i=(0,a.Z)(e,v),l=(0,c.useState)(!1),u=(0,n.Z)(l,2),f=u[0],x=u[1];return null!=t&&t.statusRender&&i.name?(0,p.jsx)(m,{name:i.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:x,children:(0,p.jsx)("div",{children:(0,p.jsx)(d.Z,(0,o.Z)({valueType:"password",fieldProps:(0,o.Z)((0,o.Z)({},(0,s.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==t||null===(r=t.onBlur)||void 0===r||r.call(t,e),x(!1)},onClick:function(e){var r;null==t||null===(r=t.onClick)||void 0===r||r.call(t,e),x(!0)}}),proFieldProps:r,filedConfig:{valueType:h}},i))})}):(0,p.jsx)(d.Z,(0,o.Z)({valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:h}},i))},x.displayName="ProFormComponent",t.Z=x},83788:function(e,t,r){var n=r(80627),o=r(93683),a=r(44194),i=r(69983),l=r(31549),u=["fieldProps","proFieldProps"],s=function(e,t){var r=e.fieldProps,a=e.proFieldProps,s=(0,o.Z)(e,u);return(0,l.jsx)(i.Z,(0,n.Z)({ref:t,valueType:"textarea",fieldProps:r,proFieldProps:a},s))};t.Z=a.forwardRef(s)},90938:function(e,t,r){var n=r(96775);t.Z=function(){var e=(0,n.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto",padding:10}}}},68659:function(e,t,r){r.r(t),r.d(t,{default:function(){return B}});var n=r(15911),o=r(90938),a=r(27353),i=r(16049),l=r(73193),u=r.n(l),s=r(90819),c=r.n(s),d=r(89933),p=r.n(d),f=r(45332),v=r.n(f),h=r(77601),m=r(38623),x=r(90883),g=r(35746),P=r(25462),y=r(44194),Z=r(2290);function w(e){return E.apply(this,arguments)}function E(){return(E=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Z.request)("/api/v1/opinion/query/org",{method:"GET",params:u()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return S.apply(this,arguments)}function S(){return(S=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Z.request)("/api/v1/opinion/create",{method:"POST",data:u()(u()({},t),{},{channel:a.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return T.apply(this,arguments)}function T(){return(T=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Z.request)("/api/v1/opinion/update",{method:"POST",data:u()(u()({},t),{},{channel:a.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return I.apply(this,arguments)}function I(){return(I=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Z.request)("/api/v1/opinion/delete",{method:"POST",data:u()(u()({},t),{},{channel:a.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return N.apply(this,arguments)}function N(){return(N=p()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w(t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=r(83381),R=r(6992),M=r(28520),D=r(7603),F=r(89622),L=r(67186),z=r(83788),q=r(17455),G=r(31549),U=function(e){var t=e.visible,r=e.mode,n=e.opinion,o=e.onClose,i=(0,D.v)().currentCategory,l=(0,M.u)().currentOrg,s="view"===r,d="edit"===r,f=function(){var e=p()(c()().mark((function e(t){var r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=u()(u()({},t),{},{categoryUid:"i18n.DEPT_ALL"===(null==i?void 0:i.uid)||null==i?void 0:i.uid,orgUid:null==l?void 0:l.uid,level:a.whQ}),!d||null==n||!n.uid){e.next=8;break}return e.next=5,k(u()({uid:n.uid},r));case 5:P.ZP.success("更新成功"),e.next=11;break;case 8:return e.next=10,b(r);case 10:P.ZP.success("创建成功");case 11:return o(!0),e.abrupt("return",!0);case 15:return e.prev=15,e.t0=e.catch(0),P.ZP.error(d?"更新失败":"创建失败"),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}();return(0,G.jsxs)(F.a,{title:function(){switch(r){case"create":return"新建意见建议";case"edit":return"编辑意见建议";case"view":return"查看意见建议";default:return"意见建议"}}(),open:t,onOpenChange:function(e){e||o()},onFinish:f,width:600,layout:"horizontal",labelCol:{span:6},wrapperCol:{span:18},initialValues:d||s?{title:null==n?void 0:n.title,content:null==n?void 0:n.content,nickname:null==n?void 0:n.nickname,type:null==n?void 0:n.type,priority:null==n?void 0:n.priority,status:null==n?void 0:n.status}:{type:"SUGGESTION",priority:"MEDIUM",status:"PENDING"},readonly:s,submitter:!s&&{submitButtonProps:{children:d?"更新":"创建"}},children:[(0,G.jsx)(L.Z,{name:"title",label:"标题",placeholder:"请输入意见建议标题",rules:[{required:!0,message:"请输入标题"},{max:100,message:"标题不能超过100个字符"}]}),(0,G.jsx)(z.Z,{name:"content",label:"内容",placeholder:"请输入具体的意见建议内容",fieldProps:{rows:4,maxLength:1e3,showCount:!0},rules:[{required:!0,message:"请输入内容"}]}),(0,G.jsx)(L.Z,{name:"nickname",label:"提出人",placeholder:"请输入提出人姓名",rules:[{required:!0,message:"请输入提出人"},{max:50,message:"提出人姓名不能超过50个字符"}]}),(0,G.jsx)(q.Z,{name:"type",label:"类型",options:[{label:"建议",value:"SUGGESTION"},{label:"改进",value:"IMPROVEMENT"},{label:"创新",value:"INNOVATION"},{label:"其他",value:"OTHER"}],rules:[{required:!0,message:"请选择类型"}]}),(0,G.jsx)(q.Z,{name:"priority",label:"优先级",options:[{label:"高优先级",value:"HIGH"},{label:"中优先级",value:"MEDIUM"},{label:"低优先级",value:"LOW"}],rules:[{required:!0,message:"请选择优先级"}]}),(0,G.jsx)(q.Z,{name:"status",label:"状态",options:[{label:"待处理",value:"PENDING"},{label:"评审中",value:"REVIEWING"},{label:"已采纳",value:"APPROVED"},{label:"已拒绝",value:"REJECTED"},{label:"已实施",value:"IMPLEMENTED"}],rules:[{required:!0,message:"请选择状态"}]})]})},V=r(10154),W=r.n(V),A=r(61476),H=function(){var e=p()(c()().mark((function e(t,r,n,o){var i,l,s,d,p,f,h=arguments;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=h.length>4&&void 0!==h[4]?h[4]:"current",l=h.length>5?h[5]:void 0,s=h.length>6?h[6]:void 0;try{d=localStorage.getItem(a.LA8),p=u()(u()({},Object.entries(n).reduce((function(e,t){var r=v()(t,2),n=r[0],o=r[1];return u()(u()({},e),{},W()({},n,o?String(o):""))}),{})),{},{accessToken:d||"",exportType:i}),"current"===i?(p.pageNumber="0",p.pageSize="20"):"all"===i?(p.pageNumber="0",p.pageSize="1000"):"range"===i&&void 0!==l&&void 0!==s&&(p.pageNumber=String(l),p.pageSize=String(s)),f="".concat((0,A.kG)(),"/api/v1/").concat(r.toLowerCase(),"/export?").concat(new URLSearchParams(p).toString()),window.open(f),P.ZP.success("导出任务已开始，请稍候下载")}catch(e){console.error("Export failed:",e),P.ZP.error("导出失败，请重试")}case 4:case"end":return e.stop()}}),e)})));return function(t,r,n,o){return e.apply(this,arguments)}}(),J=function(e){var t=e.level,r=(0,y.useRef)(),n=(0,M.u)().currentOrg,o=(0,D.v)().currentCategory,a=(0,y.useState)(!1),i=v()(a,2),l=i[0],s=i[1],d=(0,y.useState)("create"),f=v()(d,2),Z=f[0],w=f[1],E=(0,y.useState)(),b=v()(E,2),S=b[0],k=b[1],T=[{title:"标题",dataIndex:"title",width:200,search:{transform:function(e){return{title:e}}}},{title:"内容",dataIndex:"content",width:300,ellipsis:!0,search:!1},{title:"提出人",dataIndex:"nickname",width:120,search:{transform:function(e){return{nickname:e}}}},{title:"类型",dataIndex:"type",width:100,valueEnum:{SUGGESTION:{text:"建议",status:"Success"},IMPROVEMENT:{text:"改进",status:"Processing"},INNOVATION:{text:"创新",status:"Warning"},OTHER:{text:"其他",status:"Default"}},search:{transform:function(e){return{type:e}}}},{title:"优先级",dataIndex:"priority",width:100,render:function(e,t){var r={HIGH:{color:"red",text:"高"},MEDIUM:{color:"orange",text:"中"},LOW:{color:"green",text:"低"}}[t.priority];return(0,G.jsx)(m.Z,{color:null==r?void 0:r.color,children:null==r?void 0:r.text})},valueEnum:{HIGH:{text:"高优先级",status:"Error"},MEDIUM:{text:"中优先级",status:"Warning"},LOW:{text:"低优先级",status:"Success"}},search:{transform:function(e){return{priority:e}}}},{title:"状态",dataIndex:"status",width:100,render:function(e,t){var r={PENDING:{color:"orange",text:"待处理"},REVIEWING:{color:"blue",text:"评审中"},APPROVED:{color:"green",text:"已采纳"},REJECTED:{color:"red",text:"已拒绝"},IMPLEMENTED:{color:"purple",text:"已实施"}}[t.status];return(0,G.jsx)(m.Z,{color:null==r?void 0:r.color,children:null==r?void 0:r.text})},valueEnum:{PENDING:{text:"待处理",status:"Warning"},REVIEWING:{text:"评审中",status:"Processing"},APPROVED:{text:"已采纳",status:"Success"},REJECTED:{text:"已拒绝",status:"Error"},IMPLEMENTED:{text:"已实施",status:"Success"}},search:{transform:function(e){return{status:e}}}},{title:"创建时间",dataIndex:"createdAt",width:180,valueType:"dateTime",sorter:!0,search:!1},{title:"操作",valueType:"option",width:200,render:function(e,t){return[(0,G.jsx)(x.ZP,{type:"link",size:"small",onClick:function(){return F(t)},children:"查看"},"view"),(0,G.jsx)(x.ZP,{type:"link",size:"small",onClick:function(){return N(t)},children:"编辑"},"edit"),(0,G.jsx)(x.ZP,{type:"link",size:"small",danger:!0,onClick:function(){return L(t)},children:"删除"},"delete")]}}],I=function(){k(void 0),w("create"),s(!0)},N=function(e){k(e),w("edit"),s(!0)},F=function(e){k(e),w("view"),s(!0)},L=function(e){var t;g.Z.confirm({title:"确认删除",icon:(0,G.jsx)(O.Z,{}),content:'确定要删除意见建议"'.concat(e.title,'"吗？'),okText:"确认",cancelText:"取消",onOk:(t=p()(c()().mark((function t(){var n;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C({uid:e.uid});case 3:P.ZP.success("删除成功"),null===(n=r.current)||void 0===n||n.reload(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),P.ZP.error("删除失败");case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return t.apply(this,arguments)})})},z=function(){H([{key:"title",title:"标题"},{key:"content",title:"内容"},{key:"nickname",title:"提出人"},{key:"type",title:"类型"},{key:"priority",title:"优先级"},{key:"status",title:"状态"},{key:"createdAt",title:"创建时间"}],"意见建议",{orgUid:null==n?void 0:n.uid,categoryUid:"i18n.DEPT_ALL"===(null==o?void 0:o.uid)||null==o?void 0:o.uid,level:t},j)};return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(h.Z,{columns:T,actionRef:r,request:function(){var e=p()(c()().mark((function e(r,a){var i,l,s;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(u()(u()({},r),{},{orgUid:null==n?void 0:n.uid,categoryUid:"i18n.DEPT_ALL"===(null==o?void 0:o.uid)||null==o?void 0:o.uid,level:t,current:r.current||1,size:r.pageSize||20}));case 2:return s=e.sent,e.abrupt("return",{data:(null===(i=s.data)||void 0===i?void 0:i.content)||[],success:200===s.code,total:(null===(l=s.data)||void 0===l?void 0:l.totalElements)||0});case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto",defaultCollapsed:!1},dateFormatter:"string",headerTitle:"意见建议管理",toolBarRender:function(){return[(0,G.jsx)(x.ZP,{onClick:z,children:"导出"},"export"),(0,G.jsx)(x.ZP,{type:"primary",icon:(0,G.jsx)(R.Z,{}),onClick:I,children:"新建意见"},"create")]},pagination:{defaultPageSize:20,showSizeChanger:!0,showQuickJumper:!0}}),(0,G.jsx)(U,{visible:l,mode:Z,opinion:S,onClose:function(e){var t;(s(!1),k(void 0),e)&&(null===(t=r.current)||void 0===t||t.reload())}})]})},B=function(){var e=(0,o.Z)(),t=e.leftSiderStyle,r=(e.leftSiderWidth,e.contentStyle);return(0,G.jsxs)(n.Z,{style:{height:"100%"},children:[(0,G.jsx)(n.Z.Panel,{defaultSize:"20%",min:"10%",max:"40%",style:t,children:(0,G.jsx)(i.Z,{type:a.rvu,level:a.whQ,showKbase:!1})}),(0,G.jsx)(n.Z.Panel,{style:r,children:(0,G.jsx)(J,{level:a.whQ})})]})}}}]);