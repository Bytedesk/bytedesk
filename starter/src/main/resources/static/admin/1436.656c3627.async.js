"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1436],{82961:function(e,t,a){a.d(t,{dI:function(){return p},xg:function(){return f}});var s=a(90819),r=a.n(s),n=a(73193),o=a.n(n),i=a(89933),d=a.n(i),u=a(94976),l=a(4628);function f(e){return c.apply(this,arguments)}function c(){return(c=d()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/form/query/org",{method:"GET",params:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=d()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/v1/form/delete",{method:"POST",data:o()(o()({},t),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},61436:function(e,t,a){var s=a(73193),r=a.n(s),n=a(84176),o=a.n(n),i=a(90819),d=a.n(i),u=a(89933),l=a.n(u),f=a(45332),c=a.n(f),p=a(44565),g=a(27729),m=a(69533),M=a(30310),h=a(43275),x=a(44194),y=a(4628),v=a(10162),w=a(96596),S=a.n(w),T=a(1715),I=a(74171),k=a(66965),E=a(88722),A=a(82961),b=a(94976),D=a(58620),P=a(43388),j=a(67242),C=a(31549),R=["current","pageSize","prompt"];t.Z=function(e){var t=e.level,a=(e.type,e.superUser),s=void 0!==a&&a,n=(0,x.useRef)(),i=(0,y.useIntl)(),u=(0,E.Z)().translateString,f=(0,x.useState)(1),w=c()(f,2),O=w[0],U=w[1],Z=(0,x.useState)(10),B=c()(Z,2),L=B[0],N=B[1],_=(0,x.useState)([]),q=c()(_,2),z=(q[0],q[1]),H=(0,T.v)((function(e){return e.currentCategory})),Y=(0,I.u)((function(e){return e.currentOrg})),F=(0,k.w)().selectedType,G=(0,x.useState)(0),K=c()(G,2),J=(K[0],K[1]),X=(0,x.useState)({}),Q=c()(X,2),W=(Q[0],Q[1]),V=g.Z.useModal(),$=c()(V,2),ee=$[0],te=$[1],ae=function(){var e=l()(d()().mark((function e(t){var a,s;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P.yw.loading(i.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=3,(0,A.dI)(t);case 3:200===(a=e.sent).code?(P.yw.success(i.formatMessage({id:"delete.success"})),null===(s=n.current)||void 0===s||s.reload()):P.yw.error(a.message||i.formatMessage({id:"delete.error"}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){window.open((0,D.P1)(),"_blank")};(0,x.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.reload()}),[H,F]);var re=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:i.formatMessage({id:"pages.form.uid",defaultMessage:"UID"}),dataIndex:"uid",hideInSearch:!0,fixed:"left",width:180,copyable:!0,ellipsis:!0},{title:i.formatMessage({id:"pages.form.name",defaultMessage:"名称"}),dataIndex:"name",hideInSearch:!1,fixed:"left",width:200,copyable:!0,ellipsis:!0,tooltip:i.formatMessage({id:"pages.form.name.tooltip",defaultMessage:"的名称"})},{title:i.formatMessage({id:"pages.form.description",defaultMessage:"描述"}),dataIndex:"description",width:250,copyable:!0,ellipsis:!0,tooltip:i.formatMessage({id:"pages.form.description.tooltip",defaultMessage:"的功能描述"})},{title:i.formatMessage({id:"pages.form.type",defaultMessage:"类型"}),dataIndex:"type",hideInSearch:!0,width:150,ellipsis:!0,tooltip:i.formatMessage({id:"pages.form.type.tooltip",defaultMessage:"表单类型"}),valueEnum:{TICKET_INTERNAL:{text:i.formatMessage({id:"pages.form.type.ticket.internal",defaultMessage:"内部工单"})},TICKET_EXTERNAL:{text:i.formatMessage({id:"pages.form.type.ticket.external",defaultMessage:"外部工单"})},THREAD:{text:i.formatMessage({id:"pages.form.type.thread",defaultMessage:"会话表单"})},FLOW:{text:i.formatMessage({id:"pages.form.type.flow",defaultMessage:"流程表单"})},PRE_SALES_QUESTIONNAIRE:{text:i.formatMessage({id:"pages.form.type.pre.sales.questionnaire",defaultMessage:"询前问卷"})},MESSAGE_LEAVE:{text:i.formatMessage({id:"pages.form.type.message.leave",defaultMessage:"客户留言"})},COMPLAINT:{text:i.formatMessage({id:"pages.form.type.complaint",defaultMessage:"客户投诉"})},FEEDBACK:{text:i.formatMessage({id:"pages.form.type.feedback",defaultMessage:"意见反馈"})},PRODUCT_SUGGESTION:{text:i.formatMessage({id:"pages.form.type.product.suggestion",defaultMessage:"产品建议"})},BUG_REPORT:{text:i.formatMessage({id:"pages.form.type.bug.report",defaultMessage:"Bug报告"})},APPOINTMENT_TRIAL:{text:i.formatMessage({id:"pages.form.type.appointment.trial",defaultMessage:"预约试听"})}}},{title:i.formatMessage({id:"pages.form.status",defaultMessage:"状态"}),dataIndex:"status",hideInSearch:!0,width:100,tooltip:i.formatMessage({id:"pages.form.status.tooltip",defaultMessage:"表单状态"}),valueEnum:{DRAFT:{text:i.formatMessage({id:"pages.form.status.draft",defaultMessage:"草稿"}),status:"Default"},PUBLISHED:{text:i.formatMessage({id:"pages.form.status.published",defaultMessage:"已发布"}),status:"Success"},DISABLED:{text:i.formatMessage({id:"pages.form.status.disabled",defaultMessage:"已禁用"}),status:"Error"}}},{title:i.formatMessage({id:"pages.form.schema",defaultMessage:"Schema"}),dataIndex:"schema",hideInSearch:!0,width:100,tooltip:i.formatMessage({id:"pages.form.schema.tooltip",defaultMessage:"查看表单定义(schema)"}),render:function(e,t){return(null==t?void 0:t.schema)?(0,C.jsx)(m.ZP,{type:"link",onClick:function(){return function(e){var t=null==e?void 0:e.schema;t?ee.info({title:i.formatMessage({id:"form.schema.title",defaultMessage:"Schema 内容"}),width:900,okText:i.formatMessage({id:"close",defaultMessage:"关闭"}),content:(0,C.jsx)("pre",{style:{maxHeight:520,overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word",margin:0},children:t})}):P.yw.warning(i.formatMessage({id:"form.schema.empty",defaultMessage:"Schema 不能为空"}))}(t)},children:i.formatMessage({id:"view",defaultMessage:"查看"})}):(0,C.jsx)("span",{style:{color:"#999"},children:"-"})}},{title:i.formatMessage({id:"pages.form.createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",valueType:"dateTime",sorter:!0,width:160,hideInSearch:!0,tooltip:i.formatMessage({id:"pages.form.createdAt.tooltip",defaultMessage:"创建的时间"}),render:function(e,t){return t.createdAt?S()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:i.formatMessage({id:"pages.form.updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",valueType:"dateTime",sorter:!0,hideInSearch:!0,width:160,tooltip:i.formatMessage({id:"pages.form.updatedAt.tooltip",defaultMessage:"最后更新的时间"}),render:function(e,t){return t.updatedAt?S()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:i.formatMessage({id:"actions",defaultMessage:"操作"}),dataIndex:"option",valueType:"option",width:150,fixed:"right",tooltip:i.formatMessage({id:"pages.form.actions.tooltip",defaultMessage:"可进行的操作"}),render:function(e,t){return(0,C.jsxs)(M.Z,{children:[(0,C.jsx)(m.ZP,{type:"link",onClick:function(){return function(e){var t="".concat((0,D.P1)(),"?formUid=").concat(e.uid);window.open(t,"_blank")}(t)},children:i.formatMessage({id:"form.action.edit",defaultMessage:"编辑"})}),(0,C.jsx)(h.Z,{title:i.formatMessage({id:"deleteTip",defaultMessage:"删除确认"}),description:"".concat(i.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(u(t.name),"】？"),onConfirm:function(){return ae(t)},okText:i.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:i.formatMessage({id:"cancel",defaultMessage:"取消"}),children:(0,C.jsx)(m.ZP,{type:"link",danger:!0,children:i.formatMessage({id:"form.action.delete",defaultMessage:"删除"})})})]})}}],ne=function(){var e=l()(d()().mark((function e(a,n,u){var l,f,c,p,g,m,M,h,x,y,v,w;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.current,a.pageSize,a.prompt,l=o()(a,R),W({name:a.name,description:a.description}),f=a.current?a.current-1:0,c=a.pageSize||10,U(a.current||1),N(c),p="createdAt",g="desc",n&&Object.keys(n).length>0&&(m=Object.keys(n)[0],p=m,g="ascend"===n[m]?"asc":"desc"),M=r()(r()({pageNumber:f,pageSize:c,sortBy:p,sortDirection:g,level:t,orgUid:null==Y?void 0:Y.uid},s&&{superUser:s}),{},{categoryUid:(null==H?void 0:H.uid)===b.zBg?"":null==H?void 0:H.uid,type:"ALL"===F?"":F},l),e.prev=10,e.next=13,(0,A.xg)(M);case 13:if(h=e.sent,j.Z.debug("queryFormsByOrg:",h,M),200!==h.code){e.next=22;break}return w=(null==h||null===(x=h.data)||void 0===x?void 0:x.content)||[],z(w),J((null==h||null===(y=h.data)||void 0===y?void 0:y.totalElements)||0),e.abrupt("return",{data:w,success:!0,total:(null==h||null===(v=h.data)||void 0===v?void 0:v.totalElements)||0});case 22:return P.yw.error(h.message||i.formatMessage({id:"request.error"})),e.abrupt("return",{data:[],success:!1,total:0});case 24:e.next=31;break;case 26:return e.prev=26,e.t0=e.catch(10),console.error("查询失败:",e.t0),P.yw.error(i.formatMessage({id:"request.error"})),e.abrupt("return",{data:[],success:!1,total:0});case 31:case"end":return e.stop()}}),e,null,[[10,26]])})));return function(t,a,s){return e.apply(this,arguments)}}();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(p.Z,{headerTitle:i.formatMessage({id:"pages.form.title",defaultMessage:"管理"}),actionRef:n,rowKey:"uid",search:{labelWidth:"auto"},toolBarRender:function(){return[(0,C.jsx)(m.ZP,{type:"primary",icon:(0,C.jsx)(v.Z,{}),onClick:se,children:i.formatMessage({id:"form.action.open.form.editor",defaultMessage:"打开表单编辑器"})},"create")]},request:ne,columns:re,scroll:{x:"max-content"},pagination:{pageSize:L,current:O,showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," / ").concat(e," ").concat(i.formatMessage({id:"items",defaultMessage:"条"}))}},options:{setting:{listsHeight:400}},size:"small"}),te]})}},66965:function(e,t,a){a.d(t,{w:function(){return s}});var s=(0,a(26557).Ue)((function(e){return{selectedType:"",setSelectedType:function(t){return e({selectedType:t})}}}))}}]);