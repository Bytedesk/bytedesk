"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8600],{19971:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>o});var s=i(30758);const r={},t=s.createContext(r);function d(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(t.Provider,{value:n},e.children)}},29272:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"deploy/depend/artemis","title":"Artemis Message Middleware","description":"- OS: Ubuntu 22.04 LTS","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/deploy/depend/artemis.md","sourceDirName":"deploy/depend","slug":"/deploy/depend/artemis","permalink":"/docs/docs/deploy/depend/artemis","draft":false,"unlisted":false,"editUrl":"https://github.com/bytedesk/bytedesk-docs/blob/main/docs/deploy/depend/artemis.md","tags":[],"version":"current","lastUpdatedBy":"jack ning","lastUpdatedAt":1761548289000,"sidebarPosition":5,"frontMatter":{"sidebar_label":"Artemis","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Nginx","permalink":"/docs/docs/deploy/depend/nginx"},"next":{"title":"MySQL","permalink":"/docs/docs/deploy/depend/mysql"}}');var r=i(86070),t=i(19971);const d={sidebar_label:"Artemis",sidebar_position:5},o="Artemis Message Middleware",l={},a=[{value:"Overview",id:"overview",level:2},{value:"Use cases in Weiyu",id:"use-cases-in-weiyu",level:2},{value:"Real-time chat message processing",id:"real-time-chat-message-processing",level:3},{value:"Batch data processing",id:"batch-data-processing",level:3},{value:"Why Artemis",id:"why-artemis",level:2},{value:"Method 1: Deploy with Docker (recommended)",id:"method-1-deploy-with-docker-recommended",level:2},{value:"Method 2: Download and extract package",id:"method-2-download-and-extract-package",level:2},{value:"Installation",id:"installation",level:2},{value:"Deployment modes in Weiyu",id:"deployment-modes-in-weiyu",level:2},{value:"1. Embedded mode (recommended for dev/test)",id:"1-embedded-mode-recommended-for-devtest",level:3},{value:"2. Native mode (recommended for production)",id:"2-native-mode-recommended-for-production",level:3},{value:"Weiyu app configuration",id:"weiyu-app-configuration",level:2},{value:"Native mode (production)",id:"native-mode-production",level:3},{value:"Switching modes",id:"switching-modes",level:2},{value:"Optional configuration (JMS + pooling + health)",id:"optional-configuration-jms--pooling--health",level:2},{value:"Notes",id:"notes",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Comparison with other MQ systems",id:"comparison-with-other-mq-systems",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"artemis-message-middleware",children:"Artemis Message Middleware"})}),"\n",(0,r.jsx)(n.admonition,{title:"System Requirements",type:"tip",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OS: Ubuntu 22.04 LTS"}),"\n",(0,r.jsx)(n.li,{children:"Recommended server: 2 vCPU, 4 GB RAM"}),"\n"]})}),"\n",(0,r.jsx)(n.admonition,{title:"Third-party Component Note",type:"info",children:(0,r.jsxs)(n.p,{children:["The following is for reference only. For exact configuration and usage, please refer to the official Apache ActiveMQ Artemis documentation: ",(0,r.jsx)(n.a,{href:"https://activemq.apache.org/components/artemis/documentation/latest/",children:"https://activemq.apache.org/components/artemis/documentation/latest/"})]})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Apache ActiveMQ Artemis is a high-performance, asynchronous messaging system from the Apache Software Foundation. As one of the core components of the Weiyu system (built on Spring Boot 3.x), the Artemis message queue plays a critical role, mainly for real-time chat message delivery and large-scale FAQ batch imports."}),"\n",(0,r.jsx)(n.h2,{id:"use-cases-in-weiyu",children:"Use cases in Weiyu"}),"\n",(0,r.jsx)(n.h3,{id:"real-time-chat-message-processing",children:"Real-time chat message processing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Instant messaging between agents and visitors"}),"\n",(0,r.jsx)(n.li,{children:"Reliable delivery: no loss, no duplicates"}),"\n",(0,r.jsx)(n.li,{children:"High concurrency handling for massive online users"}),"\n",(0,r.jsx)(n.li,{children:"Multi-device sync across endpoints"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"batch-data-processing",children:"Batch data processing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Batch import of knowledge base articles and FAQs"}),"\n",(0,r.jsx)(n.li,{children:"Asynchronous processing for time-consuming tasks to improve response time"}),"\n",(0,r.jsx)(n.li,{children:"Queue-based scheduling for large batch jobs"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"why-artemis",children:"Why Artemis"}),"\n",(0,r.jsx)(n.p,{children:"Compared to other MQ systems, Artemis offers:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"High performance: greater throughput and lower latency"}),"\n",(0,r.jsx)(n.li,{children:"Reliability: full JMS and AMQP support for reliable delivery"}),"\n",(0,r.jsx)(n.li,{children:"Spring Boot integration: seamless with Spring Boot 3.x"}),"\n",(0,r.jsx)(n.li,{children:"Multi-protocol: JMS, AMQP, STOMP, MQTT, etc."}),"\n",(0,r.jsx)(n.li,{children:"Flexible models: point-to-point queues and pub/sub topics"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"method-1-deploy-with-docker-recommended",children:"Method 1: Deploy with Docker (recommended)"}),"\n",(0,r.jsx)(n.p,{children:"A simple, efficient, and manageable way to deploy Artemis. Example docker-compose:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'services:\n  # Artemis message middleware service\n  bytedesk-artemis:\n    image: apache/activemq-artemis:latest\n    container_name: artemis-bytedesk\n    environment:\n      - ARTEMIS_USER=admin           # admin username\n      - ARTEMIS_PASSWORD=admin       # admin password\n      - ANONYMOUS_LOGIN=false        # disable anonymous login\n      - EXTRA_ARGS=--http-host 0.0.0.0 --relax-jolokia\n    ports:\n      - "16161:61616"   # JMS\n      - "18161:8161"    # Web console\n      - "16162:61617"   # AMQP\n      - "15672:5672"    # AMQP (alt)\n      - "16163:61613"   # STOMP\n      - "11883:1883"    # MQTT\n    volumes:\n      - artemis_data:/var/lib/artemis/data\n    networks:\n      - bytedesk-network\n    restart: always\n    healthcheck:\n      test: ["CMD", "curl", "--fail", "http://localhost:8161/console/jolokia/read/org.apache.activemq.artemis:broker=\\"0.0.0.0\\""]\n      interval: 30s\n      timeout: 10s\n      retries: 5\n\nvolumes:\n  artemis_data:\n\nnetworks:\n  bytedesk-network:\n    driver: bridge\n'})}),"\n",(0,r.jsx)(n.h2,{id:"method-2-download-and-extract-package",children:"Method 2: Download and extract package"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Download: ",(0,r.jsx)(n.a,{href:"https://activemq.apache.org/components/artemis/download/",children:"https://activemq.apache.org/components/artemis/download/"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"./apache-artemis-2.37.0/bin/artemis create mybroker\n# username/password: admin/admin\n./mybroker/bin/artemis run          # foreground\n./mybroker/bin/artemis-service start # background\n./mybroker/bin/artemis stop\n./mybroker/bin/artemis-service status\n./mybroker/bin/artemis-service log\n./apache-artemis-2.37.0/bin/artemis help create\n# Modify ports if needed (broker.xml)\n# Web console: http://localhost:8161\n"})}),"\n",(0,r.jsx)(n.h2,{id:"deployment-modes-in-weiyu",children:"Deployment modes in Weiyu"}),"\n",(0,r.jsx)(n.h3,{id:"1-embedded-mode-recommended-for-devtest",children:"1. Embedded mode (recommended for dev/test)"}),"\n",(0,r.jsx)(n.p,{children:"Spring Boot starts an embedded broker automatically. No external Artemis needed."}),"\n",(0,r.jsx)(n.p,{children:"Pros:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"No extra installation"}),"\n",(0,r.jsx)(n.li,{children:"Simple configuration, ready to use"}),"\n",(0,r.jsx)(n.li,{children:"Best for development/testing"}),"\n",(0,r.jsx)(n.li,{children:"Fast to start and debug"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Cons:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Lower performance"}),"\n",(0,r.jsx)(n.li,{children:"Not suitable for production"}),"\n",(0,r.jsx)(n.li,{children:"No clustering"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Config:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"spring.artemis.mode=embedded\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-native-mode-recommended-for-production",children:"2. Native mode (recommended for production)"}),"\n",(0,r.jsx)(n.p,{children:"Connects to an external Artemis broker."}),"\n",(0,r.jsx)(n.p,{children:"Pros:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Higher performance"}),"\n",(0,r.jsx)(n.li,{children:"Supports clustering"}),"\n",(0,r.jsx)(n.li,{children:"Production-grade"}),"\n",(0,r.jsx)(n.li,{children:"Better scalability and maintainability"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Cons:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Requires separate installation/configuration"}),"\n",(0,r.jsx)(n.li,{children:"More complex"}),"\n",(0,r.jsx)(n.li,{children:"Maintain an independent service"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"weiyu-app-configuration",children:"Weiyu app configuration"}),"\n",(0,r.jsx)(n.h3,{id:"native-mode-production",children:"Native mode (production)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"spring.artemis.mode=native\nspring.artemis.broker-url=tcp://127.0.0.1:16161\nspring.artemis.user=admin\nspring.artemis.password=admin\n"})}),"\n",(0,r.jsx)(n.h2,{id:"switching-modes",children:"Switching modes"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Change ",(0,r.jsx)(n.code,{children:"spring.artemis.mode"})]}),"\n",(0,r.jsx)(n.li,{children:"Comment out current mode\u2019s configs"}),"\n",(0,r.jsx)(n.li,{children:"Enable target mode\u2019s configs"}),"\n",(0,r.jsx)(n.li,{children:"Restart the app"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"optional-configuration-jms--pooling--health",children:"Optional configuration (JMS + pooling + health)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"spring.jms.listener.auto-startup=true\nspring.jms.listener.acknowledge-mode=auto\nspring.jms.listener.concurrency=5\nspring.jms.listener.max-concurrency=50\nspring.jms.listener.receive-timeout=15000\nspring.jms.listener.max-attempts=3\nspring.jms.listener.initial-interval=2000\nspring.jms.listener.max-interval=15000\nspring.jms.listener.multiplier=2.0\nspring.jms.listener.missing-queues-fatal=false\nspring.jms.listener.connection-factory-fatal=false\n\nspring.artemis.pool.enabled=true\nspring.artemis.pool.max-connections=20\nspring.artemis.pool.min-connections=5\nspring.artemis.pool.time-between-expiration-check=10000\nspring.artemis.pool.idle-timeout=60000\nspring.artemis.pool.max-lifetime=300000\n\nspring.artemis.connection-timeout=15000\nspring.artemis.connection-ttl=30000\nspring.artemis.call-timeout=15000\nspring.artemis.call-failover-timeout=15000\nspring.artemis.retry-interval=2000\nspring.artemis.max-retry-interval=30000\nspring.artemis.reconnect-attempts=15\nspring.artemis.initial-connect-attempts=5\nspring.artemis.consumer-window-size=0\nspring.artemis.producer-window-size=0\nspring.artemis.consumer-max-rate=-1\nspring.artemis.producer-max-rate=-1\nspring.artemis.confirmation-window-size=-1\nspring.artemis.block-on-durable-send=false\nspring.artemis.block-on-non-durable-send=false\n\nmanagement.health.jms.enabled=true\nmanagement.health.artemis.enabled=true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Embedded: ConnectionFactory auto-created by Spring Boot"}),"\n",(0,r.jsx)(n.li,{children:"Native: create and configure ConnectionFactory manually"}),"\n",(0,r.jsx)(n.li,{children:"Both modes share the same JMS configs and support Actuator health checks"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.p,{children:"Connection failures:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check Artemis status (docker logs/service status)"}),"\n",(0,r.jsx)(n.li,{children:"Verify connection params (URL/user/password/network)"}),"\n",(0,r.jsx)(n.li,{children:"Inspect app logs for JMS/Artemis errors"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Performance issues:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Increase pool size, tune concurrency, and timeouts"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Message loss:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use appropriate acknowledge mode, enable DLQ, inspect console"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"High memory usage:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tune JVM, enable persistence (embedded), limit queue size"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Docker env (example excerpt):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"services:\n  bytedesk-server:\n    image: bytedesk/bytedesk-server:latest\n    environment:\n      - SPRING_ARTEMIS_MODE=native\n      - SPRING_ARTEMIS_BROKER_URL=tcp://bytedesk-artemis:61616\n      - SPRING_ARTEMIS_USER=admin\n      - SPRING_ARTEMIS_PASSWORD=admin\n    depends_on:\n      - bytedesk-artemis\n"})}),"\n",(0,r.jsx)(n.p,{children:"Web console:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["URL: ",(0,r.jsx)(n.a,{href:"http://127.0.0.1:18161/console",children:"http://127.0.0.1:18161/console"})]}),"\n",(0,r.jsx)(n.li,{children:"User: admin / Password: admin"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"comparison-with-other-mq-systems",children:"Comparison with other MQ systems"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Item"}),(0,r.jsx)(n.th,{children:"Artemis"}),(0,r.jsx)(n.th,{children:"RabbitMQ"}),(0,r.jsx)(n.th,{children:"Kafka"}),(0,r.jsx)(n.th,{children:"RocketMQ"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Positioning"}),(0,r.jsx)(n.td,{children:"General-purpose MQ"}),(0,r.jsx)(n.td,{children:"Reliability-first broker"}),(0,r.jsx)(n.td,{children:"High-throughput streaming"}),(0,r.jsx)(n.td,{children:"Financial-grade MQ"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Performance"}),(0,r.jsx)(n.td,{children:"Very high (M TPS)"}),(0,r.jsx)(n.td,{children:"Medium (10k+ TPS)"}),(0,r.jsx)(n.td,{children:"Very high (M TPS)"}),(0,r.jsx)(n.td,{children:"High (100k+ TPS)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ease of use"}),(0,r.jsx)(n.td,{children:"\u2b50\u2b50\u2b50\u2b50\u2b50"}),(0,r.jsx)(n.td,{children:"\u2b50\u2b50\u2b50\u2b50"}),(0,r.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"}),(0,r.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ops complexity"}),(0,r.jsx)(n.td,{children:"Low"}),(0,r.jsx)(n.td,{children:"Low"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"Medium"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Spring integration"}),(0,r.jsx)(n.td,{children:"Best (native)"}),(0,r.jsx)(n.td,{children:"Good"}),(0,r.jsx)(n.td,{children:"Good"}),(0,r.jsx)(n.td,{children:"Good"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Protocols"}),(0,r.jsx)(n.td,{children:"AMQP, MQTT, STOMP, OpenWire, Core"}),(0,r.jsx)(n.td,{children:"AMQP"}),(0,r.jsx)(n.td,{children:"Custom"}),(0,r.jsx)(n.td,{children:"Custom"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Resource usage"}),(0,r.jsx)(n.td,{children:"Low"}),(0,r.jsx)(n.td,{children:"Medium"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"Medium"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Deployment"}),(0,r.jsx)(n.td,{children:"Easy"}),(0,r.jsx)(n.td,{children:"Easy"}),(0,r.jsx)(n.td,{children:"Complex"}),(0,r.jsx)(n.td,{children:"Medium"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Reliability"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"High (with config)"}),(0,r.jsx)(n.td,{children:"High"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Community"}),(0,r.jsx)(n.td,{children:"Medium"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"Very high"}),(0,r.jsx)(n.td,{children:"High"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Why Weiyu chooses Artemis:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Best fit for real-time messaging in customer service"}),"\n",(0,r.jsx)(n.li,{children:"Minimal config/maintenance compared to Kafka/RocketMQ"}),"\n",(0,r.jsx)(n.li,{children:"Seamless Spring Boot 3.x integration"}),"\n",(0,r.jsx)(n.li,{children:"Multi-protocol support for diverse clients"}),"\n",(0,r.jsx)(n.li,{children:"One middleware for both real-time and batch scenarios"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"References:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Spring Boot JMS: ",(0,r.jsx)(n.a,{href:"https://docs.spring.io/spring-boot/reference/messaging/jms.html",children:"https://docs.spring.io/spring-boot/reference/messaging/jms.html"})]}),"\n",(0,r.jsxs)(n.li,{children:["Apache Artemis: ",(0,r.jsx)(n.a,{href:"https://activemq.apache.org/components/artemis/documentation/latest/index.html",children:"https://activemq.apache.org/components/artemis/documentation/latest/index.html"})]}),"\n",(0,r.jsxs)(n.li,{children:["Spring JMS Guide: ",(0,r.jsx)(n.a,{href:"https://spring.io/guides/gs/messaging-jms/",children:"https://spring.io/guides/gs/messaging-jms/"})]}),"\n",(0,r.jsxs)(n.li,{children:["Docker image: ",(0,r.jsx)(n.a,{href:"https://hub.docker.com/r/apache/activemq-artemis",children:"https://hub.docker.com/r/apache/activemq-artemis"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);