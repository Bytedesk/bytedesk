"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1181],{19971:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>i});var l=s(30758);const r={},a=l.createContext(r);function t(e){const n=l.useContext(a);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),l.createElement(a.Provider,{value:n},e.children)}},95664:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>t,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"deploy/depend/kubernetes","title":"Kubernetes","description":"\u4ee5\u4e0b\u8bf4\u660e\u4ec5\u4f9b\u53c2\u8003\uff0c\u5177\u4f53\u914d\u7f6e\u548c\u4f7f\u7528\u65b9\u6cd5\u8bf7\u53c2\u8003 Kubernetes \u5b98\u65b9\u6587\u6863\u3002Kubernetes\uff08K8s\uff09\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5bb9\u5668\u7f16\u6392\u5e73\u53f0\uff0c\u7528\u4e8e\u81ea\u52a8\u5316\u90e8\u7f72\u3001\u6269\u5c55\u548c\u7ba1\u7406\u5bb9\u5668\u5316\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u63d0\u4f9b\u4e86\u5bb9\u5668\u7f16\u6392\u3001\u81ea\u52a8\u90e8\u7f72\u3001\u81ea\u52a8\u6269\u5c55\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u529f\u80fd\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/deploy/depend/kubernetes.md","sourceDirName":"deploy/depend","slug":"/deploy/depend/kubernetes","permalink":"/docs/zh-CN/docs/deploy/depend/kubernetes","draft":false,"unlisted":false,"editUrl":"https://github.com/bytedesk/bytedesk-docs/blob/main/i18n/zh-CN/docusaurus-plugin-content-docs/current/deploy/depend/kubernetes.md","tags":[],"version":"current","lastUpdatedBy":"jack ning","lastUpdatedAt":1761805970000,"sidebarPosition":10,"frontMatter":{"sidebar_label":"Kubernetes","sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"JDK17","permalink":"/docs/zh-CN/docs/deploy/depend/jdk"},"next":{"title":"Letsencrypt","permalink":"/docs/zh-CN/docs/deploy/depend/letsencrypt"}}');var r=s(86070),a=s(19971);const t={sidebar_label:"Kubernetes",sidebar_position:10},i="Kubernetes",c={},d=[{value:"\u7cfb\u7edf\u8981\u6c42",id:"\u7cfb\u7edf\u8981\u6c42",level:2},{value:"\u6700\u4f4e\u914d\u7f6e",id:"\u6700\u4f4e\u914d\u7f6e",level:3},{value:"\u63a8\u8350\u914d\u7f6e",id:"\u63a8\u8350\u914d\u7f6e",level:3},{value:"\u76ee\u5f55",id:"\u76ee\u5f55",level:2},{value:"\u524d\u7f6e\u51c6\u5907",id:"\u524d\u7f6e\u51c6\u5907",level:2},{value:"1. \u5173\u95ed Swap",id:"1-\u5173\u95ed-swap",level:3},{value:"2. \u52a0\u8f7d\u5185\u6838\u6a21\u5757",id:"2-\u52a0\u8f7d\u5185\u6838\u6a21\u5757",level:3},{value:"3. \u914d\u7f6e\u7cfb\u7edf\u53c2\u6570",id:"3-\u914d\u7f6e\u7cfb\u7edf\u53c2\u6570",level:3},{value:"4. \u914d\u7f6e Containerd",id:"4-\u914d\u7f6e-containerd",level:3},{value:"\u5b89\u88c5 Kubernetes",id:"\u5b89\u88c5-kubernetes",level:2},{value:"1. \u5b89\u88c5\u4f9d\u8d56\u5305",id:"1-\u5b89\u88c5\u4f9d\u8d56\u5305",level:3},{value:"2. \u6dfb\u52a0 Kubernetes \u8f6f\u4ef6\u6e90",id:"2-\u6dfb\u52a0-kubernetes-\u8f6f\u4ef6\u6e90",level:3},{value:"3. \u5b89\u88c5 Kubernetes \u7ec4\u4ef6",id:"3-\u5b89\u88c5-kubernetes-\u7ec4\u4ef6",level:3},{value:"4. \u521d\u59cb\u5316 Kubernetes \u96c6\u7fa4",id:"4-\u521d\u59cb\u5316-kubernetes-\u96c6\u7fa4",level:3},{value:"5. \u5b89\u88c5\u7f51\u7edc\u63d2\u4ef6 (Calico)",id:"5-\u5b89\u88c5\u7f51\u7edc\u63d2\u4ef6-calico",level:3},{value:"6. \u79fb\u9664\u4e3b\u8282\u70b9\u6c61\u70b9(\u5355\u8282\u70b9\u96c6\u7fa4)",id:"6-\u79fb\u9664\u4e3b\u8282\u70b9\u6c61\u70b9\u5355\u8282\u70b9\u96c6\u7fa4",level:3},{value:"\u5b89\u88c5 KubeSphere",id:"\u5b89\u88c5-kubesphere",level:2},{value:"1. \u521b\u5efa\u672c\u5730\u5b58\u50a8\u7c7b",id:"1-\u521b\u5efa\u672c\u5730\u5b58\u50a8\u7c7b",level:3},{value:"2. \u4e0b\u8f7d KubeSphere \u5b89\u88c5\u5668",id:"2-\u4e0b\u8f7d-kubesphere-\u5b89\u88c5\u5668",level:3},{value:"3. \u76d1\u63a7\u5b89\u88c5\u8fdb\u5ea6",id:"3-\u76d1\u63a7\u5b89\u88c5\u8fdb\u5ea6",level:3},{value:"4. \u7b49\u5f85\u5b89\u88c5\u5b8c\u6210",id:"4-\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210",level:3},{value:"\u9a8c\u8bc1\u5b89\u88c5",id:"\u9a8c\u8bc1\u5b89\u88c5",level:2},{value:"1. \u68c0\u67e5\u8282\u70b9\u72b6\u6001",id:"1-\u68c0\u67e5\u8282\u70b9\u72b6\u6001",level:3},{value:"2. \u68c0\u67e5\u6240\u6709 Pod \u72b6\u6001",id:"2-\u68c0\u67e5\u6240\u6709-pod-\u72b6\u6001",level:3},{value:"3. \u68c0\u67e5 KubeSphere \u7ec4\u4ef6",id:"3-\u68c0\u67e5-kubesphere-\u7ec4\u4ef6",level:3},{value:"\u8bbf\u95ee\u63a7\u5236\u53f0",id:"\u8bbf\u95ee\u63a7\u5236\u53f0",level:2},{value:"\u83b7\u53d6\u8bbf\u95ee\u5730\u5740",id:"\u83b7\u53d6\u8bbf\u95ee\u5730\u5740",level:3},{value:"\u8bbf\u95ee\u65b9\u5f0f",id:"\u8bbf\u95ee\u65b9\u5f0f",level:3},{value:"\u83b7\u53d6\u8282\u70b9 IP",id:"\u83b7\u53d6\u8282\u70b9-ip",level:3},{value:"\u5e38\u7528\u547d\u4ee4",id:"\u5e38\u7528\u547d\u4ee4",level:2},{value:"Kubernetes \u57fa\u7840\u547d\u4ee4",id:"kubernetes-\u57fa\u7840\u547d\u4ee4",level:3},{value:"KubeSphere \u7ba1\u7406\u547d\u4ee4",id:"kubesphere-\u7ba1\u7406\u547d\u4ee4",level:3},{value:"\u8d44\u6e90\u7ba1\u7406\u547d\u4ee4",id:"\u8d44\u6e90\u7ba1\u7406\u547d\u4ee4",level:3},{value:"\u6545\u969c\u6392\u67e5",id:"\u6545\u969c\u6392\u67e5",level:2},{value:"1. Pod \u4e00\u76f4\u5904\u4e8e Pending \u72b6\u6001",id:"1-pod-\u4e00\u76f4\u5904\u4e8e-pending-\u72b6\u6001",level:3},{value:"2. \u955c\u50cf\u62c9\u53d6\u5931\u8d25",id:"2-\u955c\u50cf\u62c9\u53d6\u5931\u8d25",level:3},{value:"3. \u67e5\u770b\u65e5\u5fd7\u6392\u67e5\u95ee\u9898",id:"3-\u67e5\u770b\u65e5\u5fd7\u6392\u67e5\u95ee\u9898",level:3},{value:"\u5378\u8f7d",id:"\u5378\u8f7d",level:2},{value:"\u5378\u8f7d KubeSphere",id:"\u5378\u8f7d-kubesphere",level:3},{value:"\u91cd\u7f6e Kubernetes \u96c6\u7fa4",id:"\u91cd\u7f6e-kubernetes-\u96c6\u7fa4",level:3},{value:"\u53c2\u8003\u8d44\u6599",id:"\u53c2\u8003\u8d44\u6599",level:2},{value:"\u66f4\u65b0\u65e5\u5fd7",id:"\u66f4\u65b0\u65e5\u5fd7",level:2}];function o(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"kubernetes",children:"Kubernetes"})}),"\n",(0,r.jsx)(n.admonition,{title:"\u7b2c\u4e09\u65b9\u7ec4\u4ef6\u8bf4\u660e",type:"info",children:(0,r.jsxs)(n.p,{children:["\u4ee5\u4e0b\u8bf4\u660e\u4ec5\u4f9b\u53c2\u8003\uff0c\u5177\u4f53\u914d\u7f6e\u548c\u4f7f\u7528\u65b9\u6cd5\u8bf7\u53c2\u8003 ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/home/",children:"Kubernetes \u5b98\u65b9\u6587\u6863"}),"\u3002Kubernetes\uff08K8s\uff09\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5bb9\u5668\u7f16\u6392\u5e73\u53f0\uff0c\u7528\u4e8e\u81ea\u52a8\u5316\u90e8\u7f72\u3001\u6269\u5c55\u548c\u7ba1\u7406\u5bb9\u5668\u5316\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u63d0\u4f9b\u4e86\u5bb9\u5668\u7f16\u6392\u3001\u81ea\u52a8\u90e8\u7f72\u3001\u81ea\u52a8\u6269\u5c55\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u529f\u80fd\u3002"]})}),"\n",(0,r.jsx)(n.h2,{id:"\u7cfb\u7edf\u8981\u6c42",children:"\u7cfb\u7edf\u8981\u6c42"}),"\n",(0,r.jsx)(n.h3,{id:"\u6700\u4f4e\u914d\u7f6e",children:"\u6700\u4f4e\u914d\u7f6e"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u64cd\u4f5c\u7cfb\u7edf"}),"\uff1aUbuntu 20.04+ / CentOS 7+ / RHEL 7+"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CPU"}),"\uff1a2\u6838\u5fc3\u4ee5\u4e0a"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5185\u5b58"}),"\uff1a2GB\u4ee5\u4e0a"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u78c1\u76d8"}),"\uff1a20GB\u4ee5\u4e0a\u53ef\u7528\u7a7a\u95f4"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u7f51\u7edc"}),"\uff1a\u6bcf\u4e2a\u8282\u70b9\u552f\u4e00\u7684\u4e3b\u673a\u540d\u3001MAC\u5730\u5740\u548cproduct_uuid"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u63a8\u8350\u914d\u7f6e",children:"\u63a8\u8350\u914d\u7f6e"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u64cd\u4f5c\u7cfb\u7edf"}),"\uff1aUbuntu 22.04 LTS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CPU"}),"\uff1a4\u6838\u5fc3\u4ee5\u4e0a"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5185\u5b58"}),"\uff1a8GB\u4ee5\u4e0a"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u78c1\u76d8"}),"\uff1a50GB\u4ee5\u4e0aSSD"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u7f51\u7edc"}),"\uff1a\u5343\u5146\u7f51\u7edc\u8fde\u63a5"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u672c\u6587\u6863\u8bb0\u5f55\u4e86\u5728 Ubuntu 22.04 LTS \u7cfb\u7edf\u4e0a\u5b89\u88c5 Kubernetes \u548c KubeSphere \u7684\u5b8c\u6574\u8fc7\u7a0b\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u76ee\u5f55",children:"\u76ee\u5f55"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%89%8D%E7%BD%AE%E5%87%86%E5%A4%87",children:"\u524d\u7f6e\u51c6\u5907"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%AE%89%E8%A3%85-kubernetes",children:"\u5b89\u88c5 Kubernetes"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%AE%89%E8%A3%85-kubesphere",children:"\u5b89\u88c5 KubeSphere"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E9%AA%8C%E8%AF%81%E5%AE%89%E8%A3%85",children:"\u9a8c\u8bc1\u5b89\u88c5"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%8F%B0",children:"\u8bbf\u95ee\u63a7\u5236\u53f0"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4",children:"\u5e38\u7528\u547d\u4ee4"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u524d\u7f6e\u51c6\u5907",children:"\u524d\u7f6e\u51c6\u5907"}),"\n",(0,r.jsx)(n.h3,{id:"1-\u5173\u95ed-swap",children:"1. \u5173\u95ed Swap"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u4e34\u65f6\u5173\u95ed swap\nsudo swapoff -a\n\n# \u6c38\u4e45\u5173\u95ed swap\nsudo sed -i '/ swap / s/^\\(.*\\)$/#\\1/g' /etc/fstab\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-\u52a0\u8f7d\u5185\u6838\u6a21\u5757",children:"2. \u52a0\u8f7d\u5185\u6838\u6a21\u5757"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u521b\u5efa\u6a21\u5757\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\ncat <<EOF | sudo tee /etc/modules-load.d/k8s.conf\noverlay\nbr_netfilter\nEOF\n\n# \u52a0\u8f7d\u6a21\u5757\nsudo modprobe overlay\nsudo modprobe br_netfilter\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-\u914d\u7f6e\u7cfb\u7edf\u53c2\u6570",children:"3. \u914d\u7f6e\u7cfb\u7edf\u53c2\u6570"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u521b\u5efa sysctl \u914d\u7f6e\u6587\u4ef6\ncat <<EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.ipv4.ip_forward                 = 1\nEOF\n\n# \u5e94\u7528\u914d\u7f6e\nsudo sysctl --system\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-\u914d\u7f6e-containerd",children:"4. \u914d\u7f6e Containerd"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u751f\u6210\u9ed8\u8ba4\u914d\u7f6e\nsudo mkdir -p /etc/containerd\nsudo containerd config default | sudo tee /etc/containerd/config.toml\n\n# \u4fee\u6539\u914d\u7f6e\u4f7f\u7528 systemd cgroup driver\nsudo sed -i 's/SystemdCgroup = false/SystemdCgroup = true/' /etc/containerd/config.toml\n\n# \u914d\u7f6e\u955c\u50cf\u52a0\u901f(\u53ef\u9009)\nsudo sed -i 's|registry.k8s.io/pause:3.8|registry.aliyuncs.com/google_containers/pause:3.9|' /etc/containerd/config.toml\n\n# \u91cd\u542f containerd\nsudo systemctl restart containerd\nsudo systemctl enable containerd\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5b89\u88c5-kubernetes",children:"\u5b89\u88c5 Kubernetes"}),"\n",(0,r.jsx)(n.h3,{id:"1-\u5b89\u88c5\u4f9d\u8d56\u5305",children:"1. \u5b89\u88c5\u4f9d\u8d56\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo apt-get update\nsudo apt-get install -y apt-transport-https ca-certificates curl gpg\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-\u6dfb\u52a0-kubernetes-\u8f6f\u4ef6\u6e90",children:"2. \u6dfb\u52a0 Kubernetes \u8f6f\u4ef6\u6e90"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u521b\u5efa\u76ee\u5f55\nsudo mkdir -p /etc/apt/keyrings\n\n# \u4e0b\u8f7d GPG \u5bc6\u94a5\ncurl -fsSL https://pkgs.k8s.io/core:/stable:/v1.28/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg\n\n# \u6dfb\u52a0\u8f6f\u4ef6\u6e90\necho 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.28/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-\u5b89\u88c5-kubernetes-\u7ec4\u4ef6",children:"3. \u5b89\u88c5 Kubernetes \u7ec4\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u66f4\u65b0\u8f6f\u4ef6\u5305\u5217\u8868\nsudo apt-get update\n\n# \u5b89\u88c5 kubelet\u3001kubeadm \u548c kubectl\nsudo apt-get install -y kubelet kubeadm kubectl\n\n# \u9501\u5b9a\u7248\u672c\u9632\u6b62\u81ea\u52a8\u66f4\u65b0\nsudo apt-mark hold kubelet kubeadm kubectl\n\n# \u542f\u7528 kubelet\nsudo systemctl enable kubelet\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-\u521d\u59cb\u5316-kubernetes-\u96c6\u7fa4",children:"4. \u521d\u59cb\u5316 Kubernetes \u96c6\u7fa4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u521d\u59cb\u5316\u4e3b\u8282\u70b9\nsudo kubeadm init \\\n  --pod-network-cidr=192.168.0.0/16 \\\n  --image-repository=registry.aliyuncs.com/google_containers\n\n# \u914d\u7f6e kubectl\nmkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-\u5b89\u88c5\u7f51\u7edc\u63d2\u4ef6-calico",children:"5. \u5b89\u88c5\u7f51\u7edc\u63d2\u4ef6 (Calico)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u5b89\u88c5 Calico CNI\nkubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml\n\n# \u7b49\u5f85\u6240\u6709 Pod \u5c31\u7eea\nkubectl wait --for=condition=Ready pods --all -n kube-system --timeout=300s\n"})}),"\n",(0,r.jsx)(n.h3,{id:"6-\u79fb\u9664\u4e3b\u8282\u70b9\u6c61\u70b9\u5355\u8282\u70b9\u96c6\u7fa4",children:"6. \u79fb\u9664\u4e3b\u8282\u70b9\u6c61\u70b9(\u5355\u8282\u70b9\u96c6\u7fa4)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u5141\u8bb8\u5728\u4e3b\u8282\u70b9\u4e0a\u8c03\u5ea6 Pod\nkubectl taint nodes --all node-role.kubernetes.io/control-plane-\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5b89\u88c5-kubesphere",children:"\u5b89\u88c5 KubeSphere"}),"\n",(0,r.jsx)(n.h3,{id:"1-\u521b\u5efa\u672c\u5730\u5b58\u50a8\u7c7b",children:"1. \u521b\u5efa\u672c\u5730\u5b58\u50a8\u7c7b"}),"\n",(0,r.jsx)(n.p,{children:"KubeSphere \u9700\u8981\u4e00\u4e2a\u9ed8\u8ba4\u7684 StorageClass\uff0c\u8fd9\u91cc\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8e\u672c\u5730\u5b58\u50a8\u7684 StorageClass\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \u521b\u5efa local-storage.yaml\ncat > local-storage.yaml <<\'EOF\'\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: local-path-storage\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: local-path-provisioner-service-account\n  namespace: local-path-storage\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: local-path-provisioner-role\nrules:\n  - apiGroups: [""]\n    resources: ["nodes", "persistentvolumeclaims", "configmaps"]\n    verbs: ["get", "list", "watch"]\n  - apiGroups: [""]\n    resources: ["endpoints", "persistentvolumes", "pods"]\n    verbs: ["*"]\n  - apiGroups: [""]\n    resources: ["events"]\n    verbs: ["create", "patch"]\n  - apiGroups: ["storage.k8s.io"]\n    resources: ["storageclasses"]\n    verbs: ["get", "list", "watch"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: local-path-provisioner-bind\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: local-path-provisioner-role\nsubjects:\n  - kind: ServiceAccount\n    name: local-path-provisioner-service-account\n    namespace: local-path-storage\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: local-path-provisioner\n  namespace: local-path-storage\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: local-path-provisioner\n  template:\n    metadata:\n      labels:\n        app: local-path-provisioner\n    spec:\n      serviceAccountName: local-path-provisioner-service-account\n      containers:\n        - name: local-path-provisioner\n          image: rancher/local-path-provisioner:v0.0.24\n          imagePullPolicy: IfNotPresent\n          command:\n            - local-path-provisioner\n            - --debug\n            - start\n            - --config\n            - /etc/config/config.json\n          volumeMounts:\n            - name: config-volume\n              mountPath: /etc/config/\n          env:\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n      volumes:\n        - name: config-volume\n          configMap:\n            name: local-path-config\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: local-path-config\n  namespace: local-path-storage\ndata:\n  config.json: |-\n    {\n      "nodePathMap":[\n        {\n          "node":"DEFAULT_PATH_FOR_NON_LISTED_NODES",\n          "paths":["/opt/local-path-provisioner"]\n        }\n      ]\n    }\n  setup: |-\n    #!/bin/sh\n    set -eu\n    mkdir -m 0777 -p "$VOL_DIR"\n  teardown: |-\n    #!/bin/sh\n    set -eu\n    rm -rf "$VOL_DIR"\n  helperPod.yaml: |-\n    apiVersion: v1\n    kind: Pod\n    metadata:\n      name: helper-pod\n    spec:\n      containers:\n        - name: helper-pod\n          image: busybox\n          imagePullPolicy: IfNotPresent\n---\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: local-path\n  annotations:\n    storageclass.kubernetes.io/is-default-class: "true"\nprovisioner: rancher.io/local-path\nvolumeBindingMode: WaitForFirstConsumer\nreclaimPolicy: Delete\nEOF\n\n# \u5e94\u7528\u914d\u7f6e\nkubectl apply -f local-storage.yaml\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-\u4e0b\u8f7d-kubesphere-\u5b89\u88c5\u5668",children:"2. \u4e0b\u8f7d KubeSphere \u5b89\u88c5\u5668"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u4e0b\u8f7d kubesphere-installer.yaml\nkubectl apply -f https://github.com/kubesphere/ks-installer/releases/download/v3.4.1/kubesphere-installer.yaml\n\n# \u4e0b\u8f7d cluster-configuration.yaml\nkubectl apply -f https://github.com/kubesphere/ks-installer/releases/download/v3.4.1/cluster-configuration.yaml\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-\u76d1\u63a7\u5b89\u88c5\u8fdb\u5ea6",children:"3. \u76d1\u63a7\u5b89\u88c5\u8fdb\u5ea6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u5b89\u88c5\u65e5\u5fd7\nkubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l 'app in (ks-install, ks-installer)' -o jsonpath='{.items[0].metadata.name}') -f\n\n# \u67e5\u770b Pod \u72b6\u6001\nkubectl get pods --all-namespaces | grep kubesphere\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210",children:"4. \u7b49\u5f85\u5b89\u88c5\u5b8c\u6210"}),"\n",(0,r.jsx)(n.p,{children:"\u5b89\u88c5\u8fc7\u7a0b\u5927\u7ea6\u9700\u8981 15-20 \u5206\u949f\uff0c\u53d6\u51b3\u4e8e\u7f51\u7edc\u901f\u5ea6\u3002\u5b89\u88c5\u5b8c\u6210\u540e\u4f1a\u663e\u793a\u7c7b\u4f3c\u4ee5\u4e0b\u7684\u4fe1\u606f\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'**************************************************\n#####################################################\n###              Welcome to KubeSphere!           ###\n#####################################################\n\nConsole: http://ip:30880\nAccount: admin\nPassword: password\n\nNOTES\uff1a\n  1. After you log into the console, please check the\n     monitoring status of service components in\n     "Cluster Management". If any service is not\n     ready, please wait patiently until all components \n     are up and running.\n  2. Please change the default password after login.\n\n#####################################################\nhttps://kubesphere.io             2025-10-30 14:15:32\n#####################################################\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u9a8c\u8bc1\u5b89\u88c5",children:"\u9a8c\u8bc1\u5b89\u88c5"}),"\n",(0,r.jsx)(n.h3,{id:"1-\u68c0\u67e5\u8282\u70b9\u72b6\u6001",children:"1. \u68c0\u67e5\u8282\u70b9\u72b6\u6001"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get nodes\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u9884\u671f\u8f93\u51fa\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NAME                STATUS   ROLES           AGE   VERSION\nser109845944762     Ready    control-plane   45m   v1.28.15\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-\u68c0\u67e5\u6240\u6709-pod-\u72b6\u6001",children:"2. \u68c0\u67e5\u6240\u6709 Pod \u72b6\u6001"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get pods --all-namespaces\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6240\u6709 Pod \u5e94\u8be5\u5904\u4e8e ",(0,r.jsx)(n.code,{children:"Running"})," \u72b6\u6001\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"3-\u68c0\u67e5-kubesphere-\u7ec4\u4ef6",children:"3. \u68c0\u67e5 KubeSphere \u7ec4\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5 kubesphere-system \u547d\u540d\u7a7a\u95f4\nkubectl get pods -n kubesphere-system\n\n# \u68c0\u67e5 kubesphere-controls-system \u547d\u540d\u7a7a\u95f4\nkubectl get pods -n kubesphere-controls-system\n\n# \u68c0\u67e5 kubesphere-monitoring-system \u547d\u540d\u7a7a\u95f4\nkubectl get pods -n kubesphere-monitoring-system\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u8bbf\u95ee\u63a7\u5236\u53f0",children:"\u8bbf\u95ee\u63a7\u5236\u53f0"}),"\n",(0,r.jsx)(n.h3,{id:"\u83b7\u53d6\u8bbf\u95ee\u5730\u5740",children:"\u83b7\u53d6\u8bbf\u95ee\u5730\u5740"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b KubeSphere \u63a7\u5236\u53f0\u670d\u52a1\nkubectl get svc -n kubesphere-system\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u8f93\u51fa\u793a\u4f8b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NAME                    TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE\nks-apiserver            ClusterIP   10.102.219.12    <none>        80/TCP         19m\nks-console              NodePort    10.104.188.239   <none>        80:30880/TCP   19m\nks-controller-manager   ClusterIP   10.96.119.8      <none>        443/TCP        19m\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u8bbf\u95ee\u65b9\u5f0f",children:"\u8bbf\u95ee\u65b9\u5f0f"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u63a7\u5236\u53f0\u5730\u5740"}),": ",(0,r.jsx)(n.code,{children:"http://<\u8282\u70b9IP>:30880"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9ed8\u8ba4\u8d26\u53f7"}),": ",(0,r.jsx)(n.code,{children:"admin"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9ed8\u8ba4\u5bc6\u7801"}),": ",(0,r.jsx)(n.code,{children:"password"})]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,r.jsx)(n.strong,{children:"\u91cd\u8981"}),": \u9996\u6b21\u767b\u5f55\u540e\u8bf7\u7acb\u5373\u4fee\u6539\u9ed8\u8ba4\u5bc6\u7801\uff01"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u83b7\u53d6\u8282\u70b9-ip",children:"\u83b7\u53d6\u8282\u70b9 IP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get nodes -o wide\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"INTERNAL-IP"})," \u5217\u7684 IP \u5730\u5740\u8bbf\u95ee\u63a7\u5236\u53f0\u3002"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5e38\u7528\u547d\u4ee4",children:"\u5e38\u7528\u547d\u4ee4"}),"\n",(0,r.jsx)(n.h3,{id:"kubernetes-\u57fa\u7840\u547d\u4ee4",children:"Kubernetes \u57fa\u7840\u547d\u4ee4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u96c6\u7fa4\u4fe1\u606f\nkubectl cluster-info\n\n# \u67e5\u770b\u6240\u6709\u8282\u70b9\nkubectl get nodes\n\n# \u67e5\u770b\u6240\u6709\u547d\u540d\u7a7a\u95f4\nkubectl get namespaces\n\n# \u67e5\u770b\u6240\u6709 Pod\nkubectl get pods --all-namespaces\n\n# \u67e5\u770b\u7279\u5b9a\u547d\u540d\u7a7a\u95f4\u7684 Pod\nkubectl get pods -n <namespace>\n\n# \u67e5\u770b Pod \u8be6\u7ec6\u4fe1\u606f\nkubectl describe pod <pod-name> -n <namespace>\n\n# \u67e5\u770b Pod \u65e5\u5fd7\nkubectl logs <pod-name> -n <namespace>\n\n# \u8fdb\u5165 Pod\nkubectl exec -it <pod-name> -n <namespace> -- /bin/bash\n"})}),"\n",(0,r.jsx)(n.h3,{id:"kubesphere-\u7ba1\u7406\u547d\u4ee4",children:"KubeSphere \u7ba1\u7406\u547d\u4ee4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b KubeSphere \u7248\u672c\nkubectl get cm -n kubesphere-system ks-console-config -o yaml | grep version\n\n# \u91cd\u542f KubeSphere \u63a7\u5236\u53f0\nkubectl rollout restart deployment ks-console -n kubesphere-system\n\n# \u67e5\u770b KubeSphere \u5b89\u88c5\u72b6\u6001\nkubectl get cc -n kubesphere-system ks-installer -o yaml\n\n# \u67e5\u770b\u6240\u6709 KubeSphere \u76f8\u5173\u7684 Pod\nkubectl get pods --all-namespaces | grep kubesphere\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u8d44\u6e90\u7ba1\u7406\u547d\u4ee4",children:"\u8d44\u6e90\u7ba1\u7406\u547d\u4ee4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u6240\u6709 Service\nkubectl get svc --all-namespaces\n\n# \u67e5\u770b\u6240\u6709 Deployment\nkubectl get deployments --all-namespaces\n\n# \u67e5\u770b\u6240\u6709 StatefulSet\nkubectl get statefulsets --all-namespaces\n\n# \u67e5\u770b\u5b58\u50a8\u7c7b\nkubectl get storageclass\n\n# \u67e5\u770b\u6301\u4e45\u5377\nkubectl get pv\n\n# \u67e5\u770b\u6301\u4e45\u5377\u58f0\u660e\nkubectl get pvc --all-namespaces\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u6545\u969c\u6392\u67e5",children:"\u6545\u969c\u6392\u67e5"}),"\n",(0,r.jsx)(n.h3,{id:"1-pod-\u4e00\u76f4\u5904\u4e8e-pending-\u72b6\u6001",children:"1. Pod \u4e00\u76f4\u5904\u4e8e Pending \u72b6\u6001"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b Pod \u8be6\u7ec6\u4fe1\u606f\nkubectl describe pod <pod-name> -n <namespace>\n\n# \u68c0\u67e5\u662f\u5426\u6709\u8db3\u591f\u7684\u8d44\u6e90\nkubectl top nodes\nkubectl top pods -n <namespace>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-\u955c\u50cf\u62c9\u53d6\u5931\u8d25",children:"2. \u955c\u50cf\u62c9\u53d6\u5931\u8d25"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5\u955c\u50cf\u62c9\u53d6\u72b6\u6001\nkubectl get pods -n <namespace> -o wide\n\n# \u67e5\u770b Pod \u4e8b\u4ef6\nkubectl get events -n <namespace> --sort-by='.lastTimestamp'\n\n# \u624b\u52a8\u62c9\u53d6\u955c\u50cf(\u5728\u8282\u70b9\u4e0a\u6267\u884c)\nsudo crictl pull <image-name>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-\u67e5\u770b\u65e5\u5fd7\u6392\u67e5\u95ee\u9898",children:"3. \u67e5\u770b\u65e5\u5fd7\u6392\u67e5\u95ee\u9898"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b kubelet \u65e5\u5fd7\nsudo journalctl -u kubelet -f\n\n# \u67e5\u770b containerd \u65e5\u5fd7\nsudo journalctl -u containerd -f\n\n# \u67e5\u770b KubeSphere \u5b89\u88c5\u5668\u65e5\u5fd7\nkubectl logs -n kubesphere-system deployment/ks-installer -f\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5378\u8f7d",children:"\u5378\u8f7d"}),"\n",(0,r.jsx)(n.h3,{id:"\u5378\u8f7d-kubesphere",children:"\u5378\u8f7d KubeSphere"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u5220\u9664 KubeSphere\nkubectl delete -f https://github.com/kubesphere/ks-installer/releases/download/v3.4.1/kubesphere-installer.yaml\nkubectl delete -f https://github.com/kubesphere/ks-installer/releases/download/v3.4.1/cluster-configuration.yaml\n\n# \u5220\u9664 KubeSphere \u547d\u540d\u7a7a\u95f4\nkubectl delete namespace kubesphere-system\nkubectl delete namespace kubesphere-controls-system\nkubectl delete namespace kubesphere-monitoring-system\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u91cd\u7f6e-kubernetes-\u96c6\u7fa4",children:"\u91cd\u7f6e Kubernetes \u96c6\u7fa4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u91cd\u7f6e\u96c6\u7fa4\nsudo kubeadm reset -f\n\n# \u6e05\u7406\u914d\u7f6e\u6587\u4ef6\nsudo rm -rf /etc/kubernetes/\nsudo rm -rf ~/.kube/\nsudo rm -rf /etc/cni/net.d/\nsudo rm -rf /var/lib/etcd/\n\n# \u6e05\u7406 iptables\nsudo iptables -F && sudo iptables -t nat -F && sudo iptables -t mangle -F && sudo iptables -X\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u53c2\u8003\u8d44\u6599",children:"\u53c2\u8003\u8d44\u6599"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubesphere.io/zh/docs/",children:"KubeSphere \u5b98\u65b9\u6587\u6863"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.projectcalico.org/",children:"Calico \u5b98\u65b9\u6587\u6863"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/",children:"kubeadm \u5b89\u88c5\u6307\u5357"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/zh-cn/docs/setup/",children:"Kubernetes\u5b98\u65b9\u6587\u6863"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://minikube.sigs.k8s.io/docs/",children:"Minikube\u6587\u6863"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kind.sigs.k8s.io/",children:"kind\u6587\u6863"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/",children:"kubectl\u547d\u4ee4\u53c2\u8003"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u66f4\u65b0\u65e5\u5fd7",children:"\u66f4\u65b0\u65e5\u5fd7"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"2025-10-30"}),": \u5b8c\u6210\u521d\u59cb\u5b89\u88c5\uff0cKubernetes v1.28.15 + KubeSphere v3.4.1"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);