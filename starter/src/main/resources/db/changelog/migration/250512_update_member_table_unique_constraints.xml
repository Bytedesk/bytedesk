<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <!-- 查询数据库中现有的约束并添加新的约束 -->
    <changeSet id="add_new_unique_constraints_with_is_deleted_for_email" author="jackning" failOnError="false">
        <!-- 添加新的包含 is_deleted 的唯一约束 -->
        <addUniqueConstraint 
            tableName="bytedesk_team_member"
            columnNames="email, org_uid, is_deleted"
            constraintName="UK_email_org_uid_is_deleted"/>
    </changeSet>

    <changeSet id="add_new_unique_constraints_with_is_deleted_for_mobile" author="jackning" failOnError="false">
        <!-- 添加新的包含 is_deleted 的唯一约束 -->
        <addUniqueConstraint 
            tableName="bytedesk_team_member"
            columnNames="mobile, org_uid, is_deleted"
            constraintName="UK_mobile_org_uid_is_deleted"/>
    </changeSet>

</databaseChangeLog>
